Motivation: Meaningful scores to assess protein structure similarity are essential to decipher protein structure and sequence evolution. The mining of the increasing number of protein structures requires fast and accurate similarity measures with statistical significance. Whereas numerous approaches have been proposed for protein domains as a whole, the focus is progressively moving to a more local level of structure analysis for which similarity measurement still remains without any satisfactory answer. Results: We introduce a new score based on Binet–Cauchy kernel. It is normalized and bounded between 1—maximal similarity that implies exactly the same conformations for protein fragments—and À1— mirror image conformations, the unrelated conformations having a null mean score. This allows for the search of both similar and mirror conformations. In addition, such score addresses two major issue of the widely used root mean square deviation (RMSD). First, it achieves length independent statistics even for short fragments. Second, it shows better performance in the discrimination of medium range RMSD values. Being simpler and faster to compute than the RMSD, it also provides the means for large-scale mining of protein structures. Availability and implementation: The computer software implementing the score is available at http://bioserv.rpbs.univ-paris-diderot.fr/BCscore/
INTRODUCTIONWhen analyzing biological processes, similarity measures and statistical significance are one of the major means we have to establish relationships and infer models underlying observations. In the field of protein structure, the matter of quantifying similarity between two structures is a long standing objective, as it is an essential key to decipher protein sequencestructurefunction relationships and further to classify them. Protein similarity search can be performed at a global and a local level. Whole structure comparisons provide general information about protein classification and protein functions. At a more local level, fragment comparison and identification has become a key step for protein structure analysis, annotation and modeling. Fragment similarities reveal functionally important residues (), similar structural motifs may indicate function preservation in remote homologs (), and more generally, recurring fragments may be used as building blocks to the construction of de novo models of protein structures (;). Scores used to quantify the 3D similarity are essential components at both global and local levels. A considerable amount of approaches has been developed for complete protein comparisons such as SSAP (), DALI (), CE (), MAMMOTH () or TM-align () to cite some. However, progress in modeling and in the analysis of the significance of local differences in homologous proteins stresses the necessity to focus on smaller structure sizes. Yet none of the above scores used for structural alignment seems well adapted to the large-scale comparison of short protein fragments (). First, speed is of the essence for large-scale structure mining, and structural alignment may require heavy computations. Second, a crucial and difficult question remains that of the statistical significance of the scores applied to short fragments. The root mean square deviation (RMSD) () has been one of the first measures introduced. This long used criterion also has well-known flaws, among which, RMSD dependence on the alignment length, possibly large values between homologous proteins, and above all, a poor classification performance for medium range RMSD values: small RMSD values imply correct similarity, but large RMSD values can hardly be related or not to the absence of similarity. Numerous studies have attempted to overcome these limitations such as,, Maiorov and Crippen (1995) and many others since. Among these, the unitvector RMS distance (URMS) () has been reported to be rather length independent and insensitive to local structural dissimilarities for sufficiently long structures. The TM-score () has been designed to be rather insensitive to small structural deviations. It is also normalized to be length insensitive, but its design was clearly focusing on sufficiently large proteins (480 amino acids).Here, we introduce a new, fast and accurate scoring scheme for fragment mining. Contrarily to the RMSD, fragment superimposition is not required. This new measure is based on a BinetCauchy kernel (BC score). This kernel has already been applied in unrelated context, in particular to the difficult problem of clustering video sequences and to the discrimination of an individual or a group of individuals in a video sequence (). In the context of protein structure comparison, the BC score can be seen as a shape similarity score corresponding to a correlation score between fragment shapes. Hence it is normalized and its values range from 1 measuring perfect shape anti-similarity (one fragment is the mirror image of the second one) to 1 indicating perfect similarity (up to a linear deformation). The BC score has several interesting properties. In particular, it is independent to any rotation of the structures and consequently its computation does not involve a prior superimposition of the structures. It is also fast and simple to computethe score only requires the computation of 3  3 matrix determinants. Therefore, it is especially well adapted to perform large-scale protein mining and is designed to compare short protein fragments. In this article, we simply assess a new gapless approach of structure similarity and we do not study the optimal structural alignment based on the BC score. After introducing the principle of the BC kernel, we review some of its important mathematical properties. We then present a statistical analysis of the scores and we finally assess the sensitivity and specificity in the context of large-scale fragment mining with a comparison with the RMSD. We also apply the BC score to symmetry detection in proteins.
METHODS
RMSD calculation and Kabsch formulaTo introduce mathematical notations, we briefly recall well-known facts about RMSD calculation. Given two sets of aligned atoms, their superimposition consists in computing the optimal rigid body translation and rotation, which moves one set of atoms onto the second one minimizing the sum of squared Euclidean distances between them. The two sets of atom coordinates are represented by two N  3 matrices X and Y, with X ij (respectively, Y ij ) denoting the j th coordinate of the i th atom. The coordinate deviation isor using the Frobenius norm of matrices jjX  Yjj 2. The first step of the superimposition consists in centering the two structures. After this translation, we have: P j X ij  P j Y ij  0 for all i, 1 i 3. In the following, all coordinate matrices are centered. Next step is to find the rotation matrix that minimizes minMathematically, a rotation matrix is characterized by R > R  Id and detR  1, and then the RMSD is given by RMSD X,Interestingly enough, we show in this article that beside the sign of the determinant, its value itself is meaningful. We prove in the following that the det-function is a kernel function and can be used as a fast and accurate score to compare protein structures.
The CauchyBinet scoresWe call a multi-index a m-tuple of m elements from f1,. .. , Ng. Multiindices are ordered in lexicographic order: S  i 1 , i 2 ,. .. , i m  with 1 i 1 5i 2 5. .. 5i m N. The BinetCauchy identity states that for two matrices X, Y 2 R nm , with m n, we havewhere the sum is over all multi-indices of m elements. X S is the submatrix of X constructed by choosing columns of indices in S. Suppose matrices X and Y are represented by the vector of m n components indexed by S called the Grassman vector:With such a representation, the BinetCauchy theorem prove that the determinant inponent of X indexed by S is the signed volume of the parallelepiped formed/defined by the triplet S of atoms and point (0,0,0). This volume is six times the volume of tetrahedron formed by the same four vertices (). The size of the Grassman vector increases rapidly with the length of the fragment it represents (for N  20, we have N 3  1140 and 60 3  34220. The BC kernel permits to compute a scalar product
Structural BC score derived from BC kernelWe only consider the coordinates of the-carbon atoms of the protein fragments. The coordinates of the N residue fragments to be compared are stored in N  3 matrices X and Y. The coordinate matrices are centered at the origin. We propose a structural score derived from the BinetCauchy kernel. This score, we named BinetCauchy score is the cosine between the Grassman vectors of X and Y BC X, Y  detX > Y ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi ffi detX > X detY > Y p 5The calculation is possible only if the numerator is not equal to 0. This occurs when one of two matrices X or Y is not full rank, which is equivalent to state that one of the two fragments is absolutely flat. This never occurs in practice with protein fragments. A second normalization of the BC kernel can also be considered:As the geometric mean is always less than the arithmetic mean, we always have BC X, Y BC 2 X, Y. In the following, we focus on the first form of the BC score.
Mathematical properties of the BinetCauchy kernelHere, we list some simple but important properties of the BC kernels.
The BC score is rotation independent For a rotation matrixR, we have detR  1. From the definition, it is clear that BC X, YR  BC X, Y It means that it is not necessary to compute a rotation matrix to optimally superimpose the two structures and compute the score.
The BC score is a correlation coefficientBC X, Y  X > Y jjXjj:jjYjj 7The BC score is a cosine or a Pearson's correlation between the Grassman representation of X and Y. Therefore, we have 1 BC X, Y 1 8 2.4.3 The BC score is a flexible score The BC scores are maximum for identical structures. RMSD X, Y  0 ) BC X, Y  1 9 If X and Y can be exactly superimposed, then it exists a rotation matrix such that Y  XR. Because detR  1, we have BC X, Y  1. However, the reciprocal statement is not true. It is possible that BC X, Y  1 for two different fragment conformations with RMSD X, Y40. The BC score is independent to any linear transformation with a positive determinant.BC X, YA  BC X, Y  10 In particular, BC X, XA  BC X, X  1 where A is a 3  3 matrix A with detA40. Nonetheless, in large mining experiments, the BC score shows weak sensitivity to protein fragment deformations. Therefore, it can be efficiently used to search for fragments in structure databases with a certain amount of flexibility. In next paragraph, we describe a mean to control that amount of flexiblity (See mathematical details in Supplementary Materials).
Tuning flexibility with distance constraintsWe denote X i (respectively, Y i ) the coordinates of the i th (respectively, j th ) C of the fragment X (respectively, Y) of length N. The rate of deformation between the two structures is defR X, Y  max 1 i N jjX i jj  jjY i jj jjX i jj  jjY i jjThe rate of deformation compares the maximum variation of intradistances between two residues distant of l residue. It is also possible to reinforce the control over the opening of the fragment with defR 0 X, Y  max defR X, Y,It can be verified that if BC X, Y  1 and defR X, Y  0 then X can be exactly superimposed on Y and RMSD X, Y  0. The rate of deformation is used to control the admissible deformation between X and Y for a given value of BC.
BC distribution and Pareto distribution approximationThe distribution of the BC scores between two random fragments is equivalent to the distribution of the determinant of a random matrix. Except in special cases (distribution of a normal random matrices), it is difficult to derive a closed form of this distribution. Nevertheless, an accurate approximation of the tail of the distribution function is provided by the PickandsBalkemade Haan theorem (). The distribution of largest values of similarity scores, for example alignment scores, is widely used to assess the score significance for protein sequence or structure mining. The usual approach is based on extreme value distributions given by the FisherTippett Gnedenko theorem. Here, we are more interested in all the values above a given threshold and not only on the maximal value of the score. The reason is that considering only the best score, we lose a lot of information given by all the good scores. A second theorem in extreme value theory, named PickandsBalkemade Haan theorem gives the distribution of values above a given threshold called the exceedances. This theorem says that for a large class of score distribution, for a sufficiently high threshold, the distribution of the exceedances approximately follows with a good approximation a generalized Pareto distribution. To determine theoretical statistical properties of the BC scores, we generated random structures. In Shibuya (2010), a freely jointed chain model is used to assess complexity of fast RMSD searches of proteins structures. This model is random walk model where each step between two successive atoms has a fixed length and is a random vector independent from all other steps. This simple model is used to model polymers (). To have a more realistic representation of structural fragments, we generated each random fragments from a real fragment by randomly permuting its inter C intervals and reconstructing the fragment as a random walk. Hence, the inter C distances and angle distribution corresponds to real fragment structures. Depending on the selected structures and on the fragment lengths, the number of comparisons could exceed 10 7 per fragment length. For each length, 10 5 fragment comparisons have been randomly sampled and their distribution parameters have been estimated. Parameter averages and standard deviations over 10 3 samplings have been computed and appear stable relatively to the sampling process (not shown). The distribution function depends on two parameters: the scale and shape k. The fit of a generalized Pareto model to the observed BC scores has been obtained with the R package evir using a maximum likelihood method ().
DataAll computations have been performed on protein domains provided by Astral-1.75 database with 570% sequence identity (release June 2009). To derive statistics about the BC score distribution, a representativeselected subset of 64 Astral-1.75 domains have been randomly sampled consisting of 16 structures per main SCOP classes (alpha, beta, alpha/beta and alphabeta proteins). An all-against-all fragment comparison has been performed for fragment of 20, 30, 40, 50 and 60 residues, and the BC deformation scores and RMSD have been computed for each fragment pair. Finally, CASP10 target domains and models were downloaded from http://www.predictioncenter.org/casp10/. We used target/model pairs for 36 domains for which the experimental model has no missing residue, 13 free modeling and 23 template-based modeling (TBM and TMB-hard) domains. Only the models generated by servers were considered. We calculated the corresponding GDT_TS and TM-scores using the TMscore program ().25) against a representative subset of 1158 domains of Astral1.75. This subset consists in three structures per SCOP family. Only family from classes a, b, c and d (alpha, beta, alpha/beta and alphabeta proteins) are considered. BC scores and RMSD are not well correlated with a Pearson correlation equals to 0.146. The correlation is, however, stronger for low RMSDs. For instance, for RMSD 3,  0:7 and all pairs with RMSD 52 A  show a BC score over 0.6. However, the reverse is not true. Pairs of fragments with high BC scores present a large range of RMSDs from low to relatively high RMSDs (44 A  ). Remember the BC score is invariant under linear transformation, and thus a measure of the amount of fragment flexibility induced by linear or nearly linear transformations [or distorsion score-see Equation (10)] is necessary. Using a maximum deformation score of 0.4black dots ofobserves a shift of the distribution toward low RMSDs, mostly for BC scores in the medium range of values. However, this bracketing of the deformation still corresponds to rather large RMSD, even for BC scores of 0.8. Strong BC scores indicate that the global fragment shapes are conserved but can be locally distorted (case B compared with A). For instance, looking at fragments B and C, B presents a much higher BC score for an approximately equivalent RMSD. The reason is that its shape is better correlated to the query as both fragment ends can be perfectly aligned with the query terminus. Lower absolute values of the BC score imply medium to high RMSDs. They indicate a lack of shape similarity (case F) even for low RMSD values (case E). Finally, negative scores, close to 1, occur for mirror similarities, when one fragment is close to the mirror image of the second one (case G). The fragments corresponding (case G) have been superimposed by RMSD minimization and yet do not properly render the mirror symmetry. In that example, the helix part is shifted by a half helix turn relatively to the other one. When the two helix parts are superimposed, the fragments are then rotated by 90 degrees and the symmetry becomes clear (). Interestingly, the occurrences for largely negative values are much less than for positive values, indicating the mirror conformations are much less observed in protein structures. Also, the examples D, E, F and G illustrate that mediumrange RMSDs do not imply significant conformation similarity. On the contrary, the BC score more precisely characterizes global shape similarity and combined with distortion rate allows for discriminating between spurious and true fragment 3D similarity.
RESULTS
Comparison of RMSD and BC scores
Comparison of DALI and distance deviation scores versus BC scoresWe also performed large-scale comparison based on the DALI elastic similarity score (), which is a well known and used score based on distance matrices of the fragments. As shown in, relatively to the BC score, the DALI score and the RMSD tend to behave in a similar way: they are insensitive to local deformations and mostly sensitive to global one (see points A, B, G). Internal distances areinsensitive to mirror configurations as distances between residues are preserved in reflected images. Therefore, by construction the DALI score is blind to mirror transformations. Such local mirror transformations can be observed at a local level where they indicate opposed side-chain orientations, which may imply important changes for protein function. Similar resultsnot showncould be observed for the rate of deformation defR that is also a measure based on intra-distance distortions. On the contrary, the BC is sensitive to small deviations causing local mirror configurations as they change determinant signs in the BC formulation. The BC score is not changed by linear transformations. Even if real protein fragment distortions are not linear, it is less sensitive to large deviations implied by fragment stretching and bending.
BC scoring of CASP10 modelsTo further illustrate BC scoring properties, we have also investigated its behavior for comparing CASP10 models with the experimental conformations.and B show average scores between all the predicted models submitted for CASP10 and their corresponding target. Overall, the BC score is well correlated with the TM-score and GDT_TS with a Pearson correlation score of 0.93 and 0.86.depicts more in detail the relationship between the BC-score and the TM-score. For sake of clarity, the data is only plotted for all the models of 10 TBM domains. It is clear that high BC scores correlate perfectly with high TM scores (). Differences in scoring arise for medium range values. As examples, three models (labels 2, 3, 4) of target T0756d1 have a good identical TM-score (TM  0.71) but present a decreasing BC score from high (BC  0.812) to non-significant (BC  0.143). Here, the BC score is in agreement with an increasing RMSD from 3.72 to 9.40 A . The reason is that the TM-score is not penalized by locally discordant regions which in that case deteriorate the global shape of the model. In that case, poor modeling of the extremities of the two models B and C explained the higher RMSD and lower BC score. The same conclusions stand for the comparison of the GDT_TS and BC score. The BC score is a measure of global shape similarity. Localized structural discrepancies may deteriorate the scoring of a good model presenting a strong accuracy in important region of the protein. This shows that the BC score applied on complete models is not sufficient to assess the quality of a protein structural model, but its adaptation for model comparison is out of the scope of the present study. On the contrary, models with a correct global shape but with local structure mismatches can have a significant BC score with lower TM scores or GDT_TS as BC is insensitive to local deformations. Cases depicted with labels 5, 6 inpresents such a situation where the two models with an identical BC score (0.70) have a high and a medium (TM  0.74 and TM  0.46) TM-score. The two models present local differences revealed by the TM-score (illustrated in Supplementary Material).
Distribution of simulated fragments for different lengthsWe now turn to the distribution of BC scores.and Supplementaryreport the distributions obtained for random fragments obtained by a chain model, and for real fragments with no rearrangements. For random fragments (), BC score densities are almost exactly identical and independent of the fragment lengths. Considering real fragments with no rearrangements () one observes density shapes vary according to fragment length. However, the average and standard deviations remain remarkably independent on fragment length and the density tails and the exceedance probability distributions modeled by a generalized Pareto distribution also converge rapidly to a limit distribution with parameters almost independent of the fragment length (Supplementary Material). Such length independent behavior can be compared with that of the RMSD. On the exact same set, RMSD distribution () is clearly varying depending on fragment length. Another structural distanceURMSconsidering 'difference' vectors between successive-carbon instead of the position vectors of atoms has been proposed by. It shows a better length invariance property compared with RMSD. For sufficiently long structures, the URMS is length independent and rather insensitive to localstructural dissimilarities. However, probability density convergence appears in practice for structure length 480 residues, which is sufficient for comparing whole protein models but not for short fragments, for which the BC score appears much more stable.
Test casesWe further illustrate the behavior of the BC score in two different contexts.
Chitin binding domainsWe first illustrate the behavior of the BC score by mining a chitin binding motif, which is a functional motif found across plants, insects and animals.have highlighted a structural similarity between motifs in tachycitin, an invertebrate chitin binding protein (PDB:1dqc, residues 4060) and hevein, a protein of the rubber-tree (PDB 1hev, residues 1232). Using the HHsuite sequence alignment facility (), no similarity can be detected between the sequences of tachycitin and hevein. The RMSD and the BC score between the two fragments are of 3.05 A  and 0.63, respectively. The value of 0.63 is associated with a P-value of 2:10 3 , i.e. a low significance. We have performed a search for similar fragments mining the Astral-1.75 subset at 70% sequence identity, not including 1dqc nor 1hev. The search using 1hev as seed happens to be an easy case, best hits having an RMSD 51 A  and BC scores 40.97. Searching fragments similar to 1dqc is more challenging andillustrates how the BC and defR scores can perform compared with the RMSD. We discuss only the matches having a BC score value 40.63 or a RMSD 53.05 A . In all, 126 matches have an RMSD53.05 A  from the 1dqc: 4060 fragment. Their BC scores range from 0.3 to over 0.8.depicts three matches having both a low RMSD and a high BC score andtwo matches having a low RMSD and a lower BC score between 0.3 and 0.4. These matches mostly differ in their beta hairin conformation, which the BC score is able to discriminate. Conversely, 110 matches have a BC score of40.63. They include conformations having RMSD values up to 5 A  , and the additional use of the defR can be used to prune these matches.conformations of both large BC score and low RMSD values, for which the defR value is 4 0.4. They have a beta hairpin conformation similar to that of the query, but differ in their extremities. Overall, such example illustrates that the combination BC score-defR allows a fine tuning of the conformational search. Interestingly, selecting the matches having a BC40.63 and a defR 50:3 reduces the matches to only 17, among which 6red dots, 2 are overlapping have a chitin binding annotation in the Uniprot database (), and none of the matches rejected by the defR has such annotation. We have also considered using the TM-score, which depends on several parameters that are tuned to assess longer structural alignments. Not surprisingly, as is, the use of TM-score for fragment mining is inadequate and results in a lack of precision. For instance, the TM-score between the two queries 1dqc and 1hev is 0.1982. Mining of the Astral-1.75 using TM-score with this value as threshold, 837 329 fragments has been retrieved.
Mirror conformationsA second example illustrates the possibility to search for mirror conformations. Novotny and Kleywegt (2005) have shown that even though left-handed helices are rare, they occur in protein structures and are important for the stability of the protein, for ligand binding, or as part of the active site. When they do occur, they are structurally or functionally significant. We have performed the search for such left-handed helices over the collection of structures presented by, using as seed a right-handed helix fragment of Astral entry d1or4a at position 125. The lefthanded helices identified by Novotny and Kleywegt (2005) have an average BC score of 0.96, with one outlier value of 0.81 for 1h21 chain A for which the left helix had a shorter shape. Interestingly, we also find that for one protein (PDB 1bnl chain A) another region had a propensity for left-handed helix with score on the same order, although not as helical. This region, although far in the sequence, is close to that displaying the left-handed helix previously identified (). Extending the search to larger collections, we could identify 269 and 368 structures displaying such left-handed propensities in the Astral 70 and PDB 70 collections, respectively. Some of them, such as notch1 and 2 had up to three left-handed helices. Interestingly as well, the search for mirror conformations can also be performed for any shape.shows for instance the BC kernel can identify negative BC scoring fragments using as seed the three-stranded beta sheet of PDB 2zaj fragment 1740. Note the scores of the three matches depicted (d1dyka2:41-64, d2b79a1:36-59, d1uaia_:114137) are, however, on the order of 0.65 to 0.70, i.e. much less significant than those of left-handed helices. These two examples highlight that the BC score can be used to quickly mine collections of structure to search for mirror conformations, such possibility has to our knowledge no equivalent so far.
COMPUTATIONAL COSTFinally, we have compared the execution times for mining fragments of length 10 using RMSD and BC score. The BC mining is 450 times faster than the same search using RMSD. To mine the complete Astral 1.75 subset at 70% sequence identity, typical execution times are on the order of 7 s on an Intel Xeon(R) CPU E5506 at 2.13GHz using four cores.
DISCUSSION AND CONCLUSIONSIn the present study, we have introduced the BC score, a new, fast and efficient scoring approach of protein fragment similarity. We have shown that its inherent geometric properties make it possible to control the fine tuning of the level of similarity, with the limit that being invariant on linear transformation, a control over the accepted deformation rate is required. Our tests show, however, that a typical maximal value of 0.3 for the deformation rate can be used as default. Accepting it, the BC score comes with two interesting features compared with the RMSD and its derivatives. First, its size independence property has so far only been addressed for long fragments. Our results show that the BC score reaches size independence even for short size (1050 amino acids). This independence property allows for a simple estimation of a P-value based on exceedance value distribution. Second, we have also illustrated for remote homologs that the BC score makes it possible to identify fragments globally distorted, being not too sensitive to local structural changes. This results in the identification of relevant hits at larger RMSD. The generality of this behavior is, however, difficult to assess, although large-scale fragment comparisons such as that ofclearly shows the BC score is able to assign high scores to fragments with large RMSD. Finally, the BC score also defines a meaning for the lower bound limit that corresponds to mirror conformations. As illustrated for left-handed helices, this makes simple the search for particular such conformations. A major limit of the application presented here is its gapless property. In our experience, this can lead to sliding matches along a protein when performing systematic searches. Gap introduction, however, could be performed in the context of dynamics
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Fast protein fragment similarity scoring at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
F.Guyon and P.Tuff ry at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
F.Guyon and P.Tuff ry at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from programming even if the objective function derived from the BC score is not additive. These promising applications are the subject of further work. It remains that the BC score performs particularly well for gapless similarity search, and it is particularly fast compared with previously proposed scores because it does not require any superimposition, relying only on the calculation of 3  3 determinants. The weak computational cost of the BC score clearly opens the door to systematic large-scale analyses. Funding: INSERM UMR-S973 recurrent funding and the BIP:BIP project ,''Investissement d'Avenir'' ANR grant. Conflict of Interest: none declared
