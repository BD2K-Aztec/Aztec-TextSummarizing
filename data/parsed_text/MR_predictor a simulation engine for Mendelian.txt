I present MR_predictor, a simulation engine designed to guide the development and interpretation of statistical tests of caus-ality between phenotypes using genetic instruments. MR_predictor provides a framework to model either individual traits or complex scenarios where multiple phenotypes are correlated or dependent on each other. Crucially, MR_predictor can incorporate the effects of multiple biallelic loci (linked or unlinked) contributing genotypic variability to one or more simulated phenotypes. The software has a range of options for sample generation, and output files generated by MR_predictor port into commonly used analysis tools (e.g. PLINK, R), facilitating analyses germane for Mendelian Randomization studies. Benchmarks for speed and power calculations for summary statistic-based Mendelian Randomization analyses are presented and compared with analytical expectation. Availability and implementation: The simulation engine is implemented in PERL, and the associated scripts can be downloaded from github.com, and online documentation, tutorial and example datasets are available at
INTRODUCTIONThe discovery of genetic polymorphisms contributing to a wide range of human phenotypes has made causal inference between traits or disease endpoints feasible, by using these polymorphisms as instrumental variables (). The approach, dubbed Mendelian Randomization, can be conceptualized as a natural version of a randomized control trial, as alleles that elevate or lower a biomarker of interest assort randomly at meiosis. One popular application finds a researcher having selected multiple, unlinked polymorphic sites reproducibly associated to a biomarker of interest, which are then assayed for relationship to a disease endpoint (). Causal inference can be assessed using either individual genotypes or the equivalent estimated effects summarized from large-scale association studies; both approaches to inference are statistically valid if assumptions are satisfied (). As additional phenotypes and genetic associations continue to be cataloged, Monte Carlo approaches that efficiently model complex phenotypic and genotypic relationships will be useful for continued analytical and methodological progress () and addressing more complex models (). Unfortunately, existing software is optimized for genomics/genetic architecture applications, which is careful to incorporate linkage between sites as well as other population genetic features at computational expense, and does not easily handle complex relationships between multiple traits and genetic variants, simultaneously (G ). Thus, I report a Monte Carlo approach designed to generate samples of unrelated individuals presenting multiple phenotypes that also segregate genetic polymorphisms that contribute to them.
METHODSUsers begin by specifying the list of phenotypes along with associated trait parameters and covariates, pairwise correlation between intermediate traits and the impact each intermediate trait has to the outcome trait and, finally, the list of genetic variants, alleles, population frequencies and effects of each site for a given trait. This basic framework allows users to generate data from a number of models relevant for Mendelian Randomization (MR) studies. The program initializes the variance genetic component for each trait, 2 G , by generating values from the genotypephenotype relationship based on the user specification. From this, the non-genetic component, 2 E , for the mean, variance and covariance for all intermediate traits is determined. Values are selected such that each intermediate trait is distributed in the population with zero mean, unit variance ( 2 E + 2 G =1) and covariance matching the user specification. Here, I have implemented a model without interactions between genetic components, non-genetic components, or among different phenotypes/traits. After initialization, individuals are simulated with associated genotypes and phenotypes from the model by(1) simulating the contribution from 2 E for all intermediate traits from a multivariate normal distribution;(2) simulating genetic data based on specified frequencies, assuming HardyWeinberg Equilibrium;(3) incorporating the genetic effect on the phenotypes for the individual based on the simulated genotypes; an additive effect is added or *To whom correspondence should be addressed. subtracted from the phenotype for homozygotes, and dominance term added to the heteozygote class.(4) simulating additional covariates, if necessary;(5) assigning an endpoint state to the individual using contributing variables;(6) if the number of cases and controls has been specified and has not been met, accept the individual. Otherwise, reject and repeat until the total numbers have been ascertained. A binary endpoint is assigned to an individual using an approach analogous to the logit model described by, where trait or covariates contributes log-additively to the probability of the endpoint, with user-specified background rate ( 0 ) for the population prevalence. Users can also control how genetic variants relate to the endpoint, i.e. through an intermediate trait or directly on the endpoint. Simulated data are returned as pedigree, map and covariate files that are compatible with the genetic analysis package, PLINK ().
RESULTS
Benchmarking
Example: power calculationsIn MR studies, one goal is to estimate the effect of the change in a biomarker of interest to risk of a disease endpoint. Define as the causal effect of the biomarker on endpoint, and the null hypothesis that = 0. By selecting a genetic instrument that has a strong, direct, and exclusive effect on the biomarker, can be estimated via instrumental variable regression or score-based MR, generating a test statistic to evaluate if is significantly different from zero. A significant test provides support for the hypothesis that the biomarker is causally related to the endpoint of interest (based on the genetic instrument that changes the biomarker trait), and addresses issues of confounding and reverse causality owing to random assortment of alleles at meiosis. The mean of this statistic directly relates to the power to discover a causal effect between a biomarker and the endpoint. Analytic power determined for a single marker on a binary outcome has been described by, by which the simulation engine can be compared with. From there, equations that incorporate multiple genetic instrumental variables with differences in variance explained and in samples sizes at each variant can be written (see Supplementary Note). Across L total variants, for n A i cases and n U i controls and the variance of the biomarker explained by the i-th genetic instrument ( 2 i ), the log-odds causal effect of the biomarker on disease endpoint () and the total variance of the biomarker explained by the genetic instrument across all loci ( 2 ), the given test statistic under the alternative is distributed with unit variance and a mean of:Results presented indemonstrate that simulation closely matches analytical expectations (Equation 1) for a single genetic instrument, for multiple genetic instrumental variables assembled into a single score-based MR analysis () and, finally, when the effect of the instrument and/or sample sizes also vary. In all cases, the median estimates for the true, causal effect () matched closely to that which was simulated (data not shown).
Example: unweighted score statisticsI next compared the mean of the score-based MR test statistic, without weighting on the biomarker effect. If the biomarker effect is equal for all single nucleotide polymorphisms (SNPs) contributing to the score, the mean of the weighted and unweighted test is equal and matches analytical expectation (Equation 1). If the biomarker effects are unequal, the unweighted test has slightly lower mean (, row 8 versus 10), consistent with previous observations (). If selected variants were subject to winner's curse, selected weights, in some cases, may be upwardly biased.Note. IVs, number of instrumental variables (SNPs) in the score; 2 , the variance contributed to the biomarker per variant site; , the assumed effect of biomarker on the endpoint, SEM, standard error on the mean; k, thousand; n A , number of cases; n U , number of controls.In this case, the unweighted statistic has slightly better performance (3.67 if unweighted vs. 3.51 if weighted). Thus, weighting can improve the power of the test if modeled appropriately, while tests without such weighting in some case provides a degree of model robustness. Funding: The author is indebted to the Alfred P. Sloan Foundation (BR2012-087), the American Heart Association (13SDG14330006), and the W.W. Smith Charitable Trust (H1201) who provided support for the work. Conflict of interest: none declared.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
MR_predictor at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
B.F.Voight at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
