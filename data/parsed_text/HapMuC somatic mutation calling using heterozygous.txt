Motivation: Identifying somatic changes from tumor and matched normal sequences has become a standard approach in cancer research. More specifically, this requires accurate detection of somatic point mutations with low allele frequencies in impure and heterogeneous cancer samples. Although haplotype phasing information derived by using heterozygous germ line variants near candidate mutations would improve accuracy, no somatic mutation caller that uses such information is currently available. Results: We propose a Bayesian hierarchical method, termed HapMuC, in which power is increased by using available information on heterozygous germ line variants located near candidate mutations. We first constructed two generative models (the mutation model and the error model). In the generative models, we prepared candidate haplotypes, considering a heterozygous germ line variant if available, and the observed reads were realigned to the haplotypes. We then inferred the haplotype frequencies and computed the marginal likelihoods using a variational Bayesian algorithm. Finally, we derived a Bayes factor for evaluating the possibility of the existence of somatic mutations. We also demonstrated that our algorithm has superior spe-cificity and sensitivity compared with existing methods, as determined based on a simulation, the TCGA Mutation Calling Benchmark 4 data-sets and data from the COLO-829 cell line. Availability and implementation: The HapMuC source code is available from
INTRODUCTIONCancer is caused by genomic alterations. In particular, somatic point mutations play a clear role in cancer development (). Driven by the recent advancement of high-throughput DNA sequencing technologies, mutation calling from tumor and matched normal sequences is becoming a standard approach in cancer research (). The simple goal of this approach is to detect genetic alterations that are unique to the tumor sample. For this purpose, statistical approaches that allow distinction of true somatic mutations from relatively numerous germ line variants, sequencing errors and alignment errors are required. Moreover, mutation calling methods need to be sufficiently sensitive to detect targets with low allele frequencies in cancer because of low tumor contents, copy number variations and tumor heterogeneity. In particular, it is important to capture subclones demonstrating tumor heterogeneity because this is thought to be one of the main causes of therapeutic resistance and cancer recurrence (). There are mainly two approaches to detect somatic mutations using sequence data of a tumornormal pair. The first approach is to use Fisher's exact test on read counts for evaluating the differences in allele frequencies between tumor and matched normal tissue; VarScan 2 () and Genomon () are categorized in this group. By ignoring complex biological structures, this approach achieves a reasonable computational speed and robustness. The second approach is based on Bayesian modeling, which calculates the posterior probability that tumor and normal samples would have different genotypes. SomaticSniper (), jointSNVMix (), Strelka () and MuTect () are representatives of this second group. Comparative concurrent analysis of a pair of tumor and normal sequences achieved a performance superior to the previous independent type of analysis () in which tumor and normal samples were genotyped independently and results were subtracted. Here, we focused on heterozygous germ line variants located near candidate somatic mutations. In real data, we observed that somatic mutations occurred mostly on one of two normal haplotypes; however, sequencing errors occurred randomly on normal haplotypes. The data are shown in Section 3.1. Based on this observation, we propose a novel statistical method, HapMuC, which can use the information of heterozygous germ line variants near candidate mutations. First, we constructed two generative models under a Bayesian statistical framework: one represents true somatic mutations and the other regards candidate somatic mutations as errors. In our generative models, we prepared four candidate haplotypes by combining a candidate mutation and a heterozygous germ line variant, if available. The alignment probabilities of the observed reads given each candidate haplotype *To whom correspondence should be addressed  The Author 2014. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com were then computed by using profile hidden Markov models (profile HMM;). Next, we inferred the haplotype frequencies and calculated the marginal likelihoods by using a variational Bayesian algorithm (). Finally, we derived a Bayes factor (BF), which is the ratio of the marginal likelihoods of these two models, to evaluate the possibility of the presence of somatic mutations. We first demonstrated the effectiveness of HapMuC in a simulation study. Second, we also confirmed its efficiency based on a real sequence dataset obtained from breast cancer cell line samples, which forms part of the The Cancer Genome Atlas (TCGA) Mutation Calling Benchmark 4 datasets. Third, we tested HapMuC in the context of a whole genome using the TCGA datasets, and the analysis suggested that our algorithm performed better than the existing methods, including VarScan 2, SomaticSniper, Strelka and MuTect. In addition, we confirmed that the sensitivity of our algorithm was superior or comparable with the existing methods using the COLO-829 dataset with its list of validated somatic mutations (). Finally, we discuss limitations and propose future research directions for accurate mutation calling.
METHODS
Bayesian latent Dirichlet modelsWe constructed a generative model of observed reads. Suppose that x is an observed read and generated from one of four haplotypes. Let z ij be an indicator variable that is equal to 1 if the ith read x i was generated from the jth haplotype or, alternatively, is equal to 0 if x i was generated from other haplotypes. We also define z i as the ith row of Z. A likelihood of the vector of reads x is formulated by a conditional density pxjZ, where Z is a haplotype matrix whose (i, j)th element is z ij. Fixing the haplotype matrix Z, we can compute the value of the likelihood by a profile HMM (). The profile HMM formulates alignment probabilities of a read given a reference haplotype, considering mapping qualities, base qualities and homopolymer length:where X i is a hidden variable for alignment states, I i is a hidden variable for insertion states and u represents the profile HMM model parameters. Albers et al. also provided a Viterbi algorithm to infer the maximumlikelihood alignment efficiently:We used their modeling and algorithm to infer the probability of observing a short read given a reference haplotype, that is, px i jz i : z ij =1=px i jH j =px i ; ^ X i ; ^ I i jH j ; u In addition, when read-pair information is available, we approximate the likelihood by multiplying the likelihoods of the first read and the second read, as a paired-read is considered to arise from the same haplotype. The haplotype matrix is, however, usually unknown, and we regard the elements in Z as latent variables that follow a multinomial distribution with density:where p is a vector of haplotype frequencies. In this article, we also aimed to use information of a heterozygous germ line variant located near a candidate somatic mutation. Here, we focus on a candidate somatic mutation, which is located near a heterozygous germ line mutation. Therefore, around the targeted candidate mutation, there are two normal haplotypes, as shown in. We should note that because we assume that a somatic mutation occurs independently on one of two normal haplotypes, the fourth haplotype is not observed in the ideal case, i.e. 4 =0 and p= 1 ; 2 ; 3  0. However, in practice, the observed reads contain sequencing errors; thus, to achieve robust statistical inference, we added a variable " for representing haplotype error, which achieves an extension of pZjp to pZjp; ". Because tumor and normal samples have different haplotypes, it is necessary to construct statistical models of pZjp; " in tumor and normal samples, separately. The concrete modelings are shown in later sections. Because the haplotype frequencies, p, are also parameters, we built a Bayesian hierarchical structure as ppja, using Dirichlet distribution with a parameter vector a. We also assumed that the haplotype error, ", follows the beta distribution, p"jg, with parameter g. Using the probabilistic distributions described above, we define the decomposition of the joint distribution of the form: px; Z; p; "ja; g=pxjZpZjp; "ppjap"jg: 1In our case, there are two types of sequencing data: one is from a tumor sample, denoted by x T , and the other is from a matched normal sample, x N. Therefore, the haplotype matrix Z and the vector of haplotype frequencies p should be considered for each of tumor (T) and normal (N) tissue. Hence, the joint distribution is extended to pX ; Zja N ; a T ; g=px N ; Z N ; p N ; "ja N ; gpx T ; Z T ; p T ; "ja T ; gp"jg;where X =x N ; x T  and Z=Z N ; Z T ; p N ; p T ; ". We can decompose px N ; Z N ; p N ; "ja N ; g and px T ; Z T ; p T ; "ja T ; g by the same way as Equation (1). A key concept in our method involves the modelings of pZjp; " in tumor and normal tissues and is described in the following sections.
Modeling of sequencing data from a normal sampleFirst, we consider modeling of sequencing data of a normal sample. Because a normal sample contains two haplotypes, the frequencies of these haplotypes can be represented by one parameter N , and the third and fourth haplotypes can be regarded as the noise generatedwhere N N is the number of normal reads. Because the haplotype frequency of a normal sample can be represented by a scalar parameter N , p N ja N  yields the density of beta distribution.
Modeling of sequencing data from a tumor sampleAs mentioned above, as we assumed that one of two haplotypes is mutated in the tumor sample, the fourth haplotype does not exist in the ideal situation. Let the first haplotype be the mutated haplotype. The fourth haplotype is then produced by the second haplotype with error rate "; the haplotype frequencies of the second and fourth haplotypes are T2  1  " and T2  ", respectively. Therefore, we obtain pZ T jp T ; "=where N T is the number of tumor reads and p T = T1 ; T2 ; T3  0 with T1 + T2 + T3 =1. The haplotype frequencies p T = T1 ; T2 ; T3  0 then follows multinomial distribution pp T ja T , with parameter a T = T1 ; T2 ; T3  0 .
BF for finding somatic mutationsAlthough we can fit the Bayesian latent Dirichlet model to the sequencing data of tumor and matched normal samples using some statistical methods, for evaluating the possibility of a variant being a true somatic mutation, we need to define a model that can be considered as a control against the model constructed under the premise of the existence of the mutation. In a Bayesian framework, we can compare the likelihoods of these two models by the BF given bywhere p M and p E represent the models constructed under the premise of the existence of a mutation and without a mutation, respectively, and p M x N ; x T ja N ; a T ; g is the marginal likelihood defined byIf the value of the BF is significantly large, we regard the candidate mutation as likely to be a true somatic mutation, with high probability. As for the two models, p M and p E , p M is the model already described in the previous sections, which we designate a mutation model. The latter model, p E , can be constructed by replacing the haplotype frequencies in pZ T jp T ; " with those in pZ T j N ; ", i.e. only two haplotypes ideally exist, and the third and fourth haplotypes are simply errors. We designate p E as an error model. It is not an easy task to compute the marginal likelihood p M x N ; x T ja N ; a T ; g because it contains high-dimensional integrals and sums. To achieve efficient computation of the marginal likelihood, we derived a variational Bayes procedure for our proposed model.
Variational Bayes method for computing marginal likelihoodSuppose that qZ is the variational distribution that yields the decomposition qZ=qZ N qZ T q N qp T q": 2Although the variational distribution should be prepared for each of the mutation and error models, we omit the index M or E for simplifying the representation. Using the variational distribution, we obtain a lower bound of the marginal likelihood log pXja N ; a T ; g ! E q log pX; Zja N ; a T ; g qZ ; 3where E q represents the expectation under the distribution q, as defined in Equation (2). In the variational Bayes framework, a functional of q in the right side of Equation (3) is called free energy and an iterative update of q, which maximizes the free energy achieved to an estimated posterior density of Z N ; Z T ; N ; p T and ". The update formula of q in the right side of Equation (2) can be represented bywhere p beta and p Dir are the densities of beta and Dirichlet distributions, respectively, and the updated parameters can be obtained byHere, H j is the jth haplotype, and x Ni and x Ti are the ith read of normal and tumor samples, respectively. We describe the derivation of the variational procedure in Supplementary Method S1.
Inferring local normal haplotypes when there exist multiple heterozygous germ line variantsWhen multiple heterozygous germ line variants are located nearby, the number of candidate haplotypes in the normal sample is two to the power of the number of the germ line variants. We use a haplotype assembly algorithm () to infer the two normal local haplotypes from the set of possible haplotypes. The method constitutes a dynamic programming algorithm, which will find an optimal solution with respect to the minimum error correction (MEC) score. The MEC score is the number of conflicts between the reads and the two constructed haplotypes. The problem of minimizing the MEC score is Non-deterministic Polynomialtime hard (); however, the optimal algorithm is computationally practical for up to reads of length 15, where the length is the number of heterozygous germ line variants.
RESULTS
Sequence errors occur randomly on normal haplotypes in real dataWe investigated the relationships between somatic mutations and heterozygous germ line variants nearby, using exome tumor and matched normal sequences of 10 ccRCC patients (). First, we focused on orthogonally validated somatic mutations with a heterozygous germ line single nucleotide polymorphism (SNP) nearby. The somatic mutations were detected based on tumor and matched normal exome sequences, and then validated by using RNAseq and whole genome sequence data. For each true somatic mutation, we classified the reads, which overlap both the somatic mutation position and the heterozygous SNP position, into four types: (i) RR, reads that do not support either the somatic mutation or the heterozygous SNP; (ii) VR, reads that support the somatic mutation without the heterozygous SNP; (iii) RV, reads that support the heterozygous SNP without the somatic mutation; and (iv) VV, reads that support both the somatic mutation and the heterozygous SNP. As a heterozygous germ line SNP was located nearby, we observed both RR and RV reads for each somatic mutation. However, we mostly observed either VR or VV reads (). This experiment indicated that somatic mutations occur on one of normal haplotypes. Second, we investigated the behaviors of sequence errors. We collected mismatches in error loci () using the same exome data as above, and excluded potential mapping errors by using human chained self-alignments (), simple tandem repeats (), dbSNP 138 (), BLAT aligner (Kent, 2002) with human decoy sequences (37d5) () and indels located nearby (see Supplementary Method S2). For each probable sequence error position, we classified the reads, which overlap the sequence error position and the heterozygous SNP position, into four types (RR, VR, RV and VV). We observed both VR and VV reads simultaneously in most cases (), in contrast to the observations made for the somatic mutations. This observation indicates that sequence errors occur randomly on normal haplotypes.
Simulation StudyWe tested HapMuC using synthetic data. In this simulation, we used several read lengths (100, 150, 300 and 1000 bp) and compared the results between these as well as single-end reads versus paired-end reads. We generated positive and negative examples as follows:(1) Generate a random reference DNA sequence(2) Generate a heterozygous germ line variant in a random location, as well as two haplotypes (h1 and h2)(3) Generate a somatic mutation randomly, according to an empirical distribution (Supplementary), as well as two haplotypes (h3 and h4)(4) Setting parameters were as follows: tumor purity was set at 20% for positive examples and 0% for negative examples. Note that a tumor purity of 20% leads to an average allele frequency of 10%.(5) For 50 repetitions:Select a source haplotype randomly, according to the multinomial distribution (haplotype frequencies), given the parameters Select a start point of a read randomly such that the read overlaps the candidate position Select a strand direction randomly, and generate a paired-read with 1% sequence errors and an insertion size given by a normal distribution (=3  l; =l=2), where l is the read length, by referring to an empirical distribution (Supplementary). Note that we used only those examples that passed the minimum criteria for allele frequencies, read coverage, the number of variant-supporting reads and strand bias (Supplementary Method S3). Note also that the read depth is 50. As a counterpart method, we prepared a simple Fisher's exact test-based method, which uses a 2  2 base counts table. We calculated the area under curve (AUC) values () for each setting. We summarize these results in. The AUC values of the Fisher method and BFs without SNPs are comparable; however, BFs that used heterozygous germ line variants outperformed these. In addition, the number of positions, for which heterozygous germ line variants could be used, increases as the read length increases.
Real dataWe evaluated our new algorithm, HapMuC, using the wholegenome sequence data of breast cancer cell lines (HCC1954 and HCC1143), which are publicly available as a part of the TCGA Mutation Calling Benchmark 4 datasets (https://cghub. ucsc.edu/datasets/benchmark_download.html). We used the tumor samples (computationally mixed with normal) and the matched pure normal samples as evaluation datasets, whose average read coverage was $30 (Supplementary). We first detected the candidate positions that passed minimum criteria in the evaluation dataset. Then, we assumed that candidate positions were true positives if, and only if, the positions were also called on the corresponding pure dataset with an average coverage of 60. The criteria are shown in later sections. The workflow of HapMuC is given in Supplementary3.3.1 Superior performance using nearby heterozygous germ line SNPs We used the 60% tumor dataset of HCC1954 for evaluating the effect of using heterozygous germ line variants located near candidate mutations. The criteria are shown in Supplementary Method S4 and S5 for the evaluation dataset and the pure dataset, respectively. We first restricted the candidate positions so that heterozygous SNPs were located within a 100 bp distance. Second, we excluded potential mapping errors using human chained self-alignments, simple tandem repeats, dbSNP 138, BLAT aligner with human decoy sequences (37d5), and indels located nearby, in a manner similar to that described in Section 3.1 (Supplementary Method S6). We then confirmed the advantage of using the information of heterozygous germ line variants by comparing the results of HapMuC and a version of HapMuC that does not use the information of heterozygous germ line variants (). By drawing ROC curves (), the AUC value of HapMuC was 0.937, and that of the counterpart was 0.898 (). The difference in AUCs was statistically significant (P-value = 0.00124). Furthermore, the version of HapMuC. Relationships between candidate mutations and nearby heterozygous germ line variants from 10 ccRCC patients' sequence data. For each candidate mutation, we counted the reads that cover the candidate mutation and the heterozygous germ line variant (VV), and the reads that cover the candidate mutation without the heterozygous variant (VR). (A) For the orthogonally validated somatic mutations, we mostly observed the reads of a single haplotype (VV or VR). (B) However, for sequence errors, we observed the reads of both haplotypes (VV and VR) randomly that does not use heterozygous variants demonstrated superior performance compared with the simple Fisher method, suggesting that HapMuC can use information other than neighboring heterozygous germ line variants.
Alternative methods To comparethe performance of our approach in terms of mutation detection, we also ran VarScan 2, SomaticSniper, Strelka and MuTect on the same datasets. VarScan 2 is a Fisher's exact test-based method with an indel filter and a triallelic site filter, and SomaticSniper, Strelka and MuTect are Bayesian modeling-based methods. We summarized the parameters that we used for these alternative methods in Supplementary Method S7.
Performance with whole-genome dataWe used the 60% tumor datasets and the 40% tumor datasets of HCC1954 and HCC1143 to benchmark the performance of mutation detection in whole genome. For this analysis, we used the criteria in Supplementary Method S8 and S9 for the evaluation datasets and the pure datasets, respectively. We summarize the results in. Overall, the AUC values of our HapMuC algorithm were the highest under all conditions, reflecting superior sensitivity and specificity. The AUC values of the original HapMuC were slightly higher than that of a version of HapMuC that does not use the information of heterozygous germ line variants. In this analysis, HapMuC detected heterozygous germ line variants nearby in $15% of all the candidate positions. In addition, we show the ROC curves on HCC1954/n40t60 (). The runtime of HapMuC for HCC1954/n40t60 was54 h, using 48 computing nodes. The maximum memory usage of HapMuC was 0.3 GB. We report the runtime and memory usage of the other mutationcalling programs and HapMuC in Supplementary Table S2.
Most mutations called only by theFisher method were false positives We focused on single nucleotide variants (SNVs) of the HCC1954/n60t40 dataset to investigate the reasons behind HapMuC's superiority other than using heterozygous germ line variants. We excluded positions that were within a 10 000 bp distance from gap locations, in addition to the criteria in Supplementary Method S4 and S5. When we set the P-value threshold of 0.05 for the Fisher method, the specificity was 0.744 and the sensitivity was 0.719. The BF threshold of 5 for HapMuC resulted in a similar specificity (0.746) and a high sensitivity (0.974). Based on these thresholds, most of the positions called only by the simple Fisher method were found to be false positives ().
Sequence errors caused by homopolymersWe first focused on homopolymers near candidate mutations. We measured the length of homopolymers that cover candidate mutations; the stacked histograms (Supplementary) showed that the false positives generated by the Fisher method involved longer homopolymers when compared with HapMuC. The average homopolymer length of the positions that were called only by Fisher was 8.41 and that only by HapMuC was 4.79. This difference was statistically significant (t-test P52.2e-16). This is because the profile HMM realignment algorithm in HapMuC takes into account the fact that NGS mechanisms tend to increase error rates in homopolymers (). Thus, mismatches in homopolymers have smaller weights in our haplotype inference and BF. In Supplementary, we show an3.3.6 Dealing with reads with several mismatches We also investigated the number of mismatches within a 100 bp distance from candidate mutations. The stacked histograms (Supplementary) showed a trend that candidate mutations accompanying several mismatches might be false positives. The average number of mismatches near the candidate mutations that were called only by the Fisher method was 4.82, and that only by HapMuC was 1.85 (t-test P52.2e-16). This is because the reads, which contain several mismatches with relatively high base qualities, are judged not to be mapped to any of the prepared haplotypes, but are mapped to different locations in the genome during the calculation of alignment probabilities. Thus, those reads are ignored in our haplotype inference and have no impact on the BF. In Supplementary, we show a representative false positive call by the Fisher method.
Estimation of sensitivity using real dataWe used the COLO-829, malignant melanoma cell line, and COLO-829BL, a lymphoblastoid line, to evaluate the sensitivity of our method. The data were downloaded from the European Genome-Phenome Archive (accession number EGAS00000 000052), and we used the list of validated somatic SNVs (n = 497) and validated somatic indels (n = 66) (). These variants were converted to hg19 from their positions on the hg18 reference using the University of California Santa Cruz (UCSC) Genome Browser liftover utility. We called 494 SNVs, with a sensitivity of 99.4%, and 32 indels, with a sensitivity of 48.5%. In both cases, the sensitivity was comparable with or higher than that of the counterpart methods (Supplementary Method S10).
DISCUSSIONIn this article, we addressed the problem of accurately detecting somatic mutations in cancer by using tumor and matched normal NGS sequences. Based on 10 ccRCC patients' data, we observed that true somatic mutations mostly occurred on one of two normal haplotypes; however, sequencing errors occurred randomly on normal haplotypes. Based on this observation, we developed a novel Bayesian statistical method, HapMuC, which can use the information of heterozygous germ line variants located near candidate mutations. In our simulation study, we demonstrated that our algorithm has superior performance compared with a simple Fisher method when a candidate mutation occurs near a heterozygous germ line variant. We also tested our algorithm on several read lengths (100, 150, 300 and 1000 bp) as well as single-end reads and paired-end reads; HapMuC achieved higher AUC values with longer reads and paired reads by using additional information. For calculating the likelihood of read pairs, we approximated it by multiplying the alignment likelihoods of the first and second read, which assumes that read pairs are generated independently given the haplotype. However, we should modify our modeling for read pairs, considering their insertion size distribution, as a read-pair usually comes from a fragment. We also confirmed the advantages of using heterozygous germ line variants based on breast cancer cell line samples, which are publicly available as a part of the TCGA Mutation Calling Benchmark 4 datasets. In this experiment, we excluded potential alignment artifacts by using some genomic annotations, a BLAT filter with human decoy sequence (37d5) and an indel filter because mapping errors can confuse the haplotype inference of our algorithm. However, detecting and eliminating alignment errors appropriately remains a problem. Additionally, we evaluated our algorithm in the context of a whole genome using the TCGA Mutation Calling Benchmark 4 datasets. We compared the results of HapMuC with those of the simple Fisher method, Bayesian methods, which includes Strelka, MuTect and SomaticSniper, and VarScan 2, which is based on Fisher's exact test but which uses some filters. For both SNVs and indels, our method shows higher AUC values than the alternative methods. During subsequent manual inspection using Integrative Genomics Viewer (IGV) (), we confirmed that HapMuC succeeded in using contextual information, such as mismatches and homopolymers, near candidate mutations. Although several filtering approaches have been proposed, to date, no somatic mutation caller that integrates the contextual information into its score has been available. Furthermore, the analysis using the COLO-829 dataset with the list of validated somatic mutations (
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
HapMuC at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
N.Usuyama et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
N.Usuyama et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from showed that our algorithm has sensitivity better than or comparable with that of the existing methods. For future studies, we intend to incorporate further information into our algorithm. First, sequence strand bias, which is suggested as a false-positive filter by SomaticSniper, VarScan 2, MuTect and so on, could be considered. We can integrate the information of strand bias into HapMuC's score by extending our generative model. Second, we may consider the distance to the effective 3 0 end, which is suggested as an additional filter by SomaticSniper. We can achieve this by modifying the profile HMM alignment algorithm to consider the distances from the edges of reads. In addition, when sequencing data of other samples are available, we can infer background error rates and use these as prior information. A recent statistical approach, called EBCall (Shiraishi et al., 2013), has succeeded in achieving outstanding performance using pooled normal samples. MuTect also uses a simple false-positive filter, which checks whether candidate mutations exist in other normal samples. In terms of statistical modeling, if we could modify the mutation model and the error model as a nested model-pair, we can use a variable selection approach, such as lasso, for detecting somatic mutations.
