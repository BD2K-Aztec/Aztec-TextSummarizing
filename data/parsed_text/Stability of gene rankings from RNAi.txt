Motivation: Genome-wide RNA interference (RNAi) experiments are becoming a widely used approach for identifying intracellular molecular pathways of specific functions. However, detecting all relevant genes involved in a biological process is challenging, because typically only few samples per gene knock-down are available and readouts tend to be very noisy. We investigate the reliability of top scoring hit lists obtained from RNAi screens, compare the performance of different ranking methods, and propose a new ranking method to improve the reproducibility of gene selection. Results: The performance of different ranking methods is assessed by the size of the stable sets they produce, i.e. the subsets of genes which are estimated to be re-selected with high probability in independent validation experiments. Using stability selection, we also define a new ranking method, called stability ranking, to improve the stability of any given base ranking method. Ranking methods based on mean, median, t-test and rank-sum test, and their stability-augmented counterparts are compared in simulation studies and on three microscopy image RNAi datasets. We find that the rank-sum test offers the most favorable trade-off between ranking stability and accuracy and that stability ranking improves the reproducibility of all and the accuracy of several ranking methods. Availability: Stability ranking is freely available as the R/Bioconductor package staRank at
INTRODUCTIONGenome-wide gene silencing experiments are important in many fields of biology and medicine as they provide a first overview of which genes might play a role for a specific experimental condition. Many screens have been performed to study signaling in model organisms like Drosophila melanogaster (). In infection biology, viruses such as Influenza and HIV () as well as bacteria, including Salmonella, Bartonella and Shigella (To whom correspondence should be addressed), have been analyzed to identify the key host genes involved in pathogen entry into the cell. In cancer research, RNA interference (RNAi) screens have been used to study dysregulated signaling pathways and to identify novel drug targets (). In such high-throughput experiments one faces the problem of detecting the typically few relevant variables from a large, highdimensional, noisy dataset. We focus here on data from microscopy image-based RNAi screens (), where genes are knocked down individually by post-transciptional gene silencing. Small interfering RNAs (siRNAs) of 22 base pairs are introduced into a cell, where they induce cleavage and degradation of a target messenger RNA, complementary to the siRNA and thus to the eventual depletion of the respective protein (). A typical setup for such a microscopy image-based screen consists of several 384-well plates, where each well contains cells with exactly one gene knocked down. There are different strategies for the knock-down, two of which will be covered by different datasets we analyze in Section 4.2. The first is to take replicates of the same biological experiment, meaning that for each gene, the same siRNA knock-down is performed several times. The second strategy uses biologically different experiments per gene. Here, each well for the same gene contains a different type of siRNA targeting the gene (). A third approach is to pool these different siRNAs in one well, each of them in lower concentration (). This strategy adresses two main problems of siRNAs. The first is inefficient knock-down of a gene, for example due to inefficient siRNA binding. Secondly, an siRNA can have so called off-target effects, arising from limited binding specificity or other often unknown pharmacological effects (). After transfection with siRNAs, the cells are put in the experimental condition to be studied and subsequently they are imaged. The images are processed by an image segmentation and analysis software and the final experimental readout consists of one or more phenotypic measures retrieved from fluorescence signals of stained proteins. In most cases, the goal of a first genome-wide screen is to prioritize genes to select a set of top scoring 'hits' for which a secondary validation experiment is performed. For a 1D readout the usual procedure is to rank the genes by their mean or median readout across replicates. However, to account for the variation among replicates genes can also be ranked according to a test
Stability rankingstatistic. For example, redundant siRNA activity analysis (RSA) is a ranking method specifically designed for RNAi screens. It ranks all individual siRNAs by readout and then assigns a p-value to each gene based on the rank distribution of all siRNAs targeting it using a hyper-geometric model (). After ranking, a threshold is chosen to distinguish between hit and non-hit genes. This threshold can be a fold-change, deviation from the mean, or simply the fraction of top k ranking genes. The number of genes in the final subset will usually be restricted by the capacity of the re-screen and typically contains at most on the order of a few hundred genes. Selecting the optimal genes is a difficult problem, because many data points lie very close to each other and, at the same time, they are subject to considerable noise. Rather than defining hits, we focus here on the gene ranking itself, because (i) we did not find any evidence for two separate groups in the data (such as a bimodal readout distribution), and (ii) in practice, the top k genes will be selected based on available resources. Thus, we assume that each gene has an individual effect and that readout values are drawn from a continuous distribution. A general problem with rankings is that reproducibility is strongly affected by small perturbations of the data and that different ranking criteria can lead to very different results (). Since the screens are expensive and time consuming, in a whole-genome setting, only a few samples per gene are available. The analysis is further complicated by high levels of noise resulting, among other factors, from the uncertainty in quantifying image-based readouts and from the above mentioned off-target effects. Thus, the reliability of such gene rankings is a major concern directly affecting the chances of validating primary hits in follow-up experiments. Gene rankings have been considered in the context of identifying differentially expressed genes from microarray data. To quantify the robustness of a ranking, resampling or subsampling methods are often used (). For example, to benchmark different statistical tests for their reproducibility in detecting differentially expressed genes, () use a subsampling approach. () apply a jackknife procedure to investigate the number of replicates per gene in a microarray experiment that are needed to obtain stable results. The R package 'Gene Selector' () implements several ranking statistics and provides a bootstrap procedure to estimate the robustness of the ranking result. Another way of generating more stable results is learning the optimal ranking statistic for a given dataset based on resampling (). The probabilities obtained in this manner can also inform the variable selection procedure. For example, () have used bootstrapped p-values from t-tests to select genes more robustly. Hall anddiscuss the consistency of boostrap estimators for rankings. They also model the variability of rankings which they find to be lower at the extremes (). Stability selection is a more general variable selection method based on subsampling to estimate selection probabilities of variables (). For this approach, an upper bound on the expected number of false positives has been derived under certain assumptions. Rank aggregation has also been proposed to improve ranking stability. The 'Gene Selector' package provides aggregation of rankings by, for example, rank averaging or rank product. () propose a genetic algorithm to find an aggregated ranking that minimizes the distance to the individual rankings.Their results are quite stable, but a drawback of this method is that it is computationally very expensive and practical only for very small lists of genes. In the presence of multivariate data, the hit selection problem can also be addressed by multivariate approaches like support vector machines () or other classification methods [see () and () for examples]. However, since we have 1D readouts we only consider univariate methods for the rankings. In this article, we compare different ranking methods to identify those that produce the most stable gene lists. We analyze mean, median, t-test and rank-sum test, and quantify their reproducibility. The notion of stable sets, as defined in stability selection, is used to assesses the stability of a ranking. However, a ranking should not only be stable but also as accurate as possible. A constant ranking obtained, for example, by sorting genes alphabetically would be perfectly stable, but estimate biological effects very poorly. Finding an optimal trade-off between accuracy and reproducibility is a major goal when selecting hits in RNAi screening. We introduce stability ranking to improve the stability of any given base ranking method, while maintaining and sometimes improving its level of accuracy, and compare it to rank averaging. The performance of rankings is tested on simulated data and on real data from three image-based RNAi screens.
STABILITY RANKINGLet G be a set of p genes. For each gene knock-down, an experimental response is measured, called readout. We want to prioritize the genes with significantly altered readouts. For each gene g  G, there are n measurements g 1 ,...,g n , which could either be replicates or correspond to individual siRNAs. Let rk(g) be the true rank of a gene g, S k ={g | rk(g) k} the set of genes that are ranked below a certain cutoff k, and N k ={g | rk(g) > k} the set of genes with ranks above the cutoff. Then the goal is to infer the set of true top k genes, S k , from few noisy observations. As discussed above, we do not optimize the cutoff parameter k, but rather aim at inferring S k for all k {1,...,p}. We follow the stability selection approach () and let I  2 {1,...,n} be the random variable for data samples of size n that are drawn with replacement from the set of replicates. For a given ranking method and a fixed cutoff k, the probability for a gene g  G to be in the selected setSset setS k (I) is denoted byand estimated from a finite sample}, where 1 is the indicator function, which equals 1 if the argument is true and 0 otherwise, and S k (i j ) the set of selected genes based on subsample i j. We regard those genes as stable that are selected with high probability. Formally, for a threshold   (0,1), we define the stable gene setS set setS stableWe fix  = 0.9 throughout the article since the choice of this parameter is not critical, as long as it is not set to very low values (see Supplementary. Illustration of stability selection for a specific ranking cutoff k. The cardinality of the stable set at this cutoff provides an estimate for the number of top k genes, that are expected to be among the top k again, when repeating the experiment under the same conditions computing the stable sets for all k {1,...,p} and then ranking the genes by the order in which they enter the stable set:The cardinality of the stable set provides an estimate of the number of hits that can be expected to be validated with probability  when considering the top k * genes in the ranking. By validation we mean here that a gene is again among the top k * genes when repeating the experiment under the same conditions. For noisy datasets, k * can become much larger than the stable set size (). Stability ranking is implemented in the R/Bioconductor package staRank. We apply this procedure to several ranking statistics, including mean and median as well as two statistical tests which account for the variation per gene, namely the t-test as a parametric and the rank-sum test as a non-parametric test. The tests are performed as one sided, two-sample tests comparing the replicates of one gene to the total dataset. For datasets generated by different siRNAs per gene, we also apply RSA ranking (). We analyze the stability and accuracy of the original ranking methods and investigate the improvement due to stability ranking in a simulation study.
SIMULATION STUDYIn the absence of evidence for multiple modes in the readout distributions of the RNAi screens we analyzed, in our simulations, we draw knock-down effects for all genes from a unimodal distribution and add individual random noise to it. We simulate datasets from a variety of models. Each model generates datasets of size pn, where p is the number of genes and n the number of replicates. For each gene, its true effect  and its observed readouts g i are drawn in a hierarchical fashion from normal distributions as follows:Each model is characterized by the variance among gene effects, s 2 , and the shape  and rate  of the gamma distribution from which the gene-wise variances among replicates are drawn. The gamma distribution has mean m = / and variance v = / 2. We estimated the parameters s, m and v from the effect and replicate distributions observed in the Drosophila genome-wideRNAi screen described below (). We then varied the parameters around these estimates, which resulted in 24 different models (Supplementaryand Supplementary Tables S1 and S2). Each model was used to generate datasets of cardinality n = 2, 3, 4 and 10. To assess reproducibility and accuracy, 300 pairs of datasets are drawn from each model. For each dataset, the different base ranking methods, their stability ranking and their average ranking are computed. Accuracy is assessed by comparing the top k genes from an estimated ranking rk to the true hits S k , whereas the reproducibility of a ranking is defined as the overlap in top k gene sets between the two rankings rk 1 and rk 2 estimated from paired datasets (),Both quality measures take values in, where 1 indicates complete agreement among top k gene sets and hence perfect accuracy or reproducibility. The final quantities we report are averages across the pairs of datasets (reproducibility) or across all datasets (accuracy), for the top k/p = 1% or 10% genes.
RESULTS AND DISCUSSION
Simulation resultsUsing the model described in the previous section, we ran simulations for p = 1000 genes and assessed accuracy and reproducibility of the top 10 (1%) genes, because in practice, usually only a small fraction of hits can be selected for follow-up experiments. In, reproducibility and accuracy are compared between the original, average and stability rankings for all models. Models with a filled shape showed a significant difference between the two ranking methods (baseline versus stability ranking and aggregated versus stability ranking) at the 0.1% level in a paired t-test after BenjaminiHochberg correction for multiple testing. For mean and median ranking, we observe an increase in reproducibility for a large group of models, when using stability ranking (and B). Remarkably, stability ranking also increases the accuracy of the ranking (and G). Similarly, for the rank-sum test, reproducibility is improved using stability ranking, although the effect is not as strong, while maintaining the same level of accuracy (and H). The same behavior can be observed for the RSA rankings (and J). By contrast, the t-test shows no difference between the two ranking versions, but accuracy is overall very low (and I). The poor performance might be due to unreliable estimation of the variance from only two to five observations. Thus, non-parametric ranking statistics are preferable for this type of data. Direct comparison of the stability rankings based on mean, median and rank-sum test reveals superior accuracy and reproducibility of the rank-sum test (Supplementary Figs S3 and S4). In general, the performance increases with the width of the effects distribution (see Supplementary Tables S1 and S2, and Supplementaryfor top 10%). A direct comparison of stability ranking and rank averaging shows similar performance (T) with a slight advantage of stability ranking. For all of the four competitive methods, the stability ranking was significantly better in reproducibility for many more models than the average ranking (43 versus 9 for mean, 36 versus 12 for median, 41 versusThe colors represent the parameters that were used for the mean effect distribution. The different shapes represent the different gamma distributions for the gene variances and the symbol size indicates the number of replicates used. For models that have a filled shape, the two ranking methods (baseline versus stability ranking) showed a significant difference at the 1% level in a paired t-test after BenjaminiHochberg correction for multiple testing 7 for rank sum and 29 versus 17 for RSA). The accuracy was similar for both aggregated methods, again with a slight advantage for stability ranking (12 versus 0 for mean, 11 versus 0 for median and 2 versus 0 for rank sum).shows reproducibility and accuracy for one specific model, defined by the parameters s = 1.69, m = 9, v = 61.8 and n = 10. Interestingly, at the very top of the ranking the t-test outperforms the other methods in terms of reproducibility, but at the same time it has the lowest accuracy. The t-test base and stability rankings are almost indistinguishable, whereas for the other methods there is a large difference between the two. Especially for the top-ranked genes, stability ranking improves reproducibility by >10%. For median and mean, this also holds true in terms of accuracy up to the top 25% of the ranking. The most accurate ranking is produced by the rank-sum test, slightly outperforming its stability ranking version. Similar effects can be observed for most of the models. In summary, the rank-sum test offers a good trade-off between accuracy and reproducibility of the ranking. Stability ranking, which can be applied on top of any given ranking method, improves or at least equalizes both accuracy and reproducibility of all ranking methods investigated here. The improvement is the largest if the base ranker does not account for gene-wise variation, such as mean and median ranking, but even the reproducibility of the rank-sum test ranking can be improved and, on average, it is larger then using average ranking.
Application to RNAi datasetsWe apply stability ranking to three RNAi screens, of which one uses four replicates per siRNA, whereas the other two use three to four siRNAs per gene. The first is a whole-genome screen of D.melanogaster cells, which was performed to study signaling of the Notch receptor (). It consists of 4 identical replicates on 12 000 genes each. For each knocked down gene, Notch signaling activity was measured based on the ratio of signal to background fluorescence measurements. We refer to it as the Notch screen. The second dataset comprises a screen of 7000 human druggable genes (). In this experiment, HeLa cells were infected with Salmonella bacteria to study their entry mechanism. For this the infection rate per knock-down is used. This screen was performed using three different siRNAs targeting the same gene. The third dataset is similar to the previous one but wasHere we used all 14 837 genes for which 4 siRNA values were available. We call these screens the druggable (SalD) and the genome-wide (SalGW) Salmonella screen, respectively. For a more detailed description of the datasets, see Datasets section in the Supplementary Material. For all datasets, median, mean, t-test and rank-sum test were used to calculate base and stability rankings. Since they use different siRNAs per gene, for the Salmonella screens, RSA ranking was also performed. The rankings were directed toward down regulation of the Notch receptor and decrease in infection, respectively. In all screens, the rank-sum test produces the most stable rankings, followed by RSA ranking (). The t-test has initially the lowest stability. This changes throughout the ranking, but since the top part is the most relevant one, this method appears impractical. As expected, the stability of the Notch screen, which uses replicates, is much higher than for the Salmonella screens, which use different siRNAs per gene.summarizes the stable set sizes for the top 1% and top 10% resulting from the rank-sum rankings for each of the datasets (for the other methods see Supplementary Tables S3S6). To compare the reproducibility of rankings on the real data, we employed a bootstrap analysis () and resampled the data for each gene with replacement. For each bootstrap run, we used as many values per gene as the original dataset had.shows the bootstrapped reproducibility values of the Notch screen for the top 20% of median, t-test and rank-sum test rankings. Overall the reproducibility is very high for most rankings. In particular, the first two ranks show perfect reproducibility for the stability median and stability rank sum. Generally, the stability median rankings and both rank-sum test versions are 10% more reproducible than the base median rankings. Above the top 1% the original version is slightly more reproducible. The t-test again fails to recover a stable ranking. For all screens, subsets of genes had been selected, which were followed up on with validation experiments. Selection of genes was based on a combination of the outcome of the primary screen as well as biological expert knowledge. For the rank-sum test,. Comparison of the base and stability version of the rank-sum test rankingsummarizes how many of the stable top 1% and top 10% genes were selected for re-screening and how many of these were finally validated (see Supplementary Tables S3S6 for the other rankings). However, assessing the significance of these results is difficult for two reasons. Firstly, the sets of re-screened genes do not represent i.i.d. random samples, because they are biased by the way they were selected. Secondly, the re-screening experiments were not carried out under the same experimental conditions and therefore may lead to different conclusions. In case of the Notch screen, the primary in vitro screen was validated in vivo. In case of Salmonella, screens were validated using different or only partially overlapping siRNA libraries as compared with the primary screens. For the Notch screen, a total of 233 down regulating genes were re-screened, whereas for Salmonella, 164-infection decreasing genes of the drugable and 119 infection-decreasing genes of the genome-wide screen were chosen for validation. Overall, most of the stable top 1% genes were re-screened. For the Notch screen the stable top 10% genes contained almost all of the re-screened genes, whereas for the other experiments this fraction is reduced to 50%. Validation rates vary considerably but tend to be the higher the more stable a screen is. Comparing the top 1% and top 10% of the rank-sum test ranking and its stability counterpart we find that for the base ranker always a few more genes had been chosen for re-screening. Yet, in five out of six cases validation rates were higher when using stability ranking (). The rank-sum test and t-test rankings showed the highest overlaps between base and stability ranking, but for the less similar rankings, the stability rankings had also higher validation rates in most of the cases (Supplementary Tables S7S10).
J.Siebourg et al.
B A
Stability ranking
CONCLUSIONWe have applied the concept of stability selection to gene rankings to generate more reproducible ordered hit lists for data generated from phenotypic RNAi experiments. We have shown that the robustness of different ranking methods can be very different and that the stable set size can be used as a measure of reproducibility. Since imagebased RNAi screening data tend to be very noisy and sparse, the use of stability ranking can improve stability, especially in the top part of the rankings which is of main interest. In the present study, the ranksum test ranking and its stability ranking version have resulted in the most reproducible hit lists. Stability ranking is very flexible and can be applied to any gene ranking method. It does not only improve ranking statistics that ignore the gene-wise variance, such as mean or median, but it also improved the reproducibility of a statistic like the rank-sum test. Thus, irrespective of the chosen ranking statistic, it appears beneficial to complement the selection of top scoring genes with stable genes to increase validation rates in secondary screens. In principle, the stable sets could also hint at a reasonable cutoffs for hit selection. Analyzing the growth curve of the stable sets for the datasets used in the present study, no such cutoff was be found, but this may be investigated further in future work on different datasets. Funding: SystemsX.ch, the Swiss initiative in systems biology, under IPhdand RTD(InfectX), evaluated by the Swiss National Science Foundation. Conflict of Interest: none declared.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
