Motivation: High-accuracy de novo assembly of the short sequencing reads from RNA-Seq technology is very challenging. We introduce a de novo assembly algorithm, EBARDenovo, which stands for Extension, Bridging And Repeat-sensing Denovo. This algorithm uses an efficient chimera-detection function to abrogate the effect of aberrant chimeric reads in RNA-Seq data. Results: EBARDenovo resolves the complications of RNA-Seq assembly arising from sequencing errors, repetitive sequences and aberrant chimeric amplicons. In a series of assembly experiments, our algorithm is the most accurate among the examined programs, including de Bruijn graph assemblers, Trinity and Oases. Availability and implementation: EBARDenovo is available at http:// ebardenovo.sourceforge.net/. This software package (with patent pending) is free of charge for academic use only.
INTRODUCTIONRNA-Seq technology has revolutionized transcriptomic studies in recent years. In comparison with microarrays, this highthroughput sequencing technology allows the detection of novel transcripts. It also has a wider dynamic range in detecting transcript abundance than tiling arrays (), serial analysis of gene expression () and cap analysis of gene expression (). RNA-Seq is especially important for studying organisms without reference genomes. With reference genomes, accurate reads can be identified and mapped to the reference for accurate and sensitive quantification of even lowly expressed transcripts. However, for organisms without reference genomes, the short reads from RNA-Seq have to be assembled into contigs representing the transcripts before the expression level can be determined from the read coverage. In this case, sequencing errors may cause mis-assembly, create artificial contigs and consequently produce inaccurate interpretation of transcript abundance (). De novo assembly of short reads faces computational challenges from classical sequencing problems such as sequence repeats, homologous genes and artificial chimeric reads () (). Most de novo RNA-Seq assemblers, including Trans-Abyss (), Oases () and Trinity (), are de Bruijn graph based methods. In de Bruijn graphs, reads are either represented as k-mer nodes or as k-mer edges, and Eulerian paths between end nodes are examined for assembling sequences (). Both sequence repeats and artificial chimeric reads will cause erroneous k-mer nodes. Most of de Bruijn genome assemblers, such as Velvet () and ALLPATHS (), filter out low-frequency k-mer nodes to improve accuracy, as low-frequency k-mer nodes are more likely to be sequencing artifacts. However, de novo assembly of RNA-Seq data is more difficult because the abundance of RNA transcripts varies significantly (). Although de Bruijnbased algorithms have been successfully used to construct many transcriptomes using RNA-Seq data, it has always been difficult to keep the assembly both accurate and sensitive. Low-frequency k-mer nodes are important for discovering low-abundance transcripts. For sensitive detection of novel transcripts, RNA-Seq assemblers usually do not eliminate low-frequency k-mer nodes. Unfortunately, retaining low-frequency k-mer nodes would reduce assembly accuracy. In this study, we introduce an efficient algorithm for RNA-Seq assembly, with special emphasize on detecting chimeric reads and *To whom correspondence should be addressed. assembly errors. We showed that our new de novo assembly algorithm, designated EBARDenovo, has enhanced accuracy, while it still maintains high sensitivity in determining transcript abundance.
METHODS
Key principles of EBARDenovoThe new algorithm, EBARDenovo, which stands for Extension, Bridging And Repeat-sensing Denovo, applies a bi-directional expansion method using paired-end RNA-Seq data to guide the transcriptome assembly (). In this algorithm, the construction of a contig begins with a seed read. Searches are done to find proper neighboring reads at both ends of the seed. Two reads that come from the same paired-end sequencing reads are defined as read mates of each other. To avoid potentially ambiguous assembly created by repeat sequences, a proper extension must satisfy one of two conditions (): i) a read mate can be found inside the contig that is currently being constructed; or ii) a read mate can be found in a neighboring (usually overlapping) contig. To ensure both conditions are satisfied for a contig extension, a chimera-detection test is performed on the paired candidates (). Assuming there is a chimeric read R c composed of two fragments from transcripts T A and T B , the correct assembly should always have higher read coverage than the contig containing the chimeric reads. In this case, the backtracking from the other end of chimeric read R c will find a set of correct reads from transcript T B , and the alignment of these reads is compared with the nucleotide bases of the current contig to determine whether the program can correctly expand the contig or cause a translocation of the two segments.(a) The presence of common sub-sequences (repetitive sequences, homologous sequences) among transcripts causes reads to merge by mistake and produce mis-assembly (i). By using paired-end reads, the opportunity for mis-assembly is reduced. (b) Aberrant chimeric amplicons composed of disjointed regions of one or more transcripts can cause erroneous assembly of reads into artificial contigs within the temporary contig, the foreseeable read will be used as seed read and extended backward to see whether the extension can reach the temporary contig (). The insert sizes of paired-end RNA-Seq can be very different even within the same dataset. To avoid the assembly quality being affected by the varying insert sizes, the insert sizes are not evaluated in EBARDenovo.
EBARDenovo: the proposed algorithm and key operationsThe repeat-sensing operation also uses foreseeable reads to identify repetitive sequences naturally occurring in transcripts and resolve the issue of multiple expansions (). A contig is split when multiple expansions occur, and the extension operation is then executed if there are no other foreseeable reads to indicate possible bridging (). If the extension operation fails owing to sequencing errors, the algorithm will go back toThese unaligned reads can be merged into the contig in upcoming operations of extension, bridging or repeat sensing. (b) In the extension operation, candidate reads are selected from the read pool according to a short indexing key. (c) In the bridging operation, foreseeable reads may match the expanding end of a contig. (d) In the repeat-sensing operation, if there are possible expansions for a contig, it is backtracked along each expanding possibility. The contig will be split if there are more than two possible expansions. (e) In the extension operation, when a non-foreseeable read is met, EBARDenovo attempts to align reads from the mate of the non-foreseeable read in the opposite direction of the extension the bridging operation (). The extension and bridging operations are alternated until the contigs are no longer extendable. At the end, all the aligned reads are paired. The entire procedure of EBARDenovo is illustrated in.
The verification of assembly accuracy using GMAPThe accuracy of assemblers was verified using GMAP () program. GMAP aligns the contigs with a reference genome to check the correctness of contigs. The Arabidopsis thaliana genome was downloaded from the TAIR database (http://www.arabidopsis.org/). The Mus musculus (mouse) and Homo sapiens (human) genomes were downloaded from the UCSC Genome database (http://hgdownload.cse.ucsc. edu). GMAP classifies mapping results into four classes: unique mapping (U), multiple mapping (M), translocated mapping (T) and no mapping (N). The no-mapping results were seen as contamination of the RNA samples. The error rates of assembly results were estimated by the ratio of translocated mappings T/ (U  M  T). The RPKM values for genes were computed with the software CLC Genomics Workbench 5.1 by mapping the sequencing reads to the transcriptome databases. RPKM is defined as () the total number of reads the number of mapped reads  gene length  10 9
Output of EBARDenovo for transcriptome analysisTo easily examine the assembly results, detect potential single nucleotide polymorphisms (SNPs) and calculate expression levels of assembled contigs, EBARDenovo offers four types of output information for each reconstructed sequence, including (i) the sequences, (ii) the aligned reads in each contig, (iii) the alignment of used pairs and (iv) the plot of sequence coverage (Supplementary). EBARDenovo also outputs the general information of contigs, the SNPs and the locations of small overlaps among reads in the same contig. The users can visualize the variants of the transcripts. In the past, users relied on supplemental mapping tools, e.g. Bowtie (), to map reads to a contig and to estimate the abundance, whereas EBARDenovo alone can produce sufficient information for advanced analyses such as the identification of RNA editing sites () and gene fusion candidates (). We expect that EBARDenovo can enhance the experience of RNA-Seq analysis.
Software implementationEBARDenovo is implemented in C# with the .NET Framework. The executable program can be run on 64 bit operating systems such as Windows, Linux and Mac OS. On Linux or Mac OS, Mono framework (http://www.mono-project.com/) needs to be installed to run the program. EBARDenovo program and the user manual can be downloaded from http://ebardenovo.sourceforge.net/. It is also available as Supplementary Software.
RESULTS AND DISCUSSION
RNA-Seq datasets and tested de novo assembly algorithmsWe tested our algorithm against two de Bruijn graphbased assemblers, Trinity and Oases, using six RNA-Seq datasets (listed in) from three model organisms: A.thaliana, M.musculus (mouse) and H.sapiens (human). We used four sizes of k-mers (21, 25, 29 and 33 bp) to run the Oases assembly. The assemblies with k-mers of 29 and 33 bp were used to produce the merging results known as Oases-M assemblies. Trinity only provides a fixed size of k-mer (25 bp). By default, EBARDenovo directly searches for candidate reads by an indexing key (15 bp). The detail assembly results are listed in Supplementary Table S1. The assembly results were verified with the transcriptome and genome databases TAIR () (for A.thaliana) and NCBI Reference Sequences (RefSeq) (for mouse and human) using the mapping tool on CLC Genomics Workbench and GMAP (). We showed the comparison of mapped transcripts by different algorithms in Supplementary. Moreover, we checked the intersection of mapped transcripts between different assemblies in Supplementary. It is obvious that many transcripts can be successfully reconstructed by only one assembler in each dataset.
EBARDenovo produced most accurate assemblies for RNA-Seq datasetsTo calculate accuracy of different assembly results, we mapped assembled contigs to their reference genomes using GMAP programs to detect translocation caused by potential mis-assembly. If a contig is mapped to different gene models in a chromosome or even different chromosomes, it is counted as an artificial translocation event. If a correct assembly of a natural gene fusion occurs, it will also be counted as a translocation event in the GMAP test. However, we assumed such natural fusion genes to be rare. We also recorded events of a whole contig mapped to multiple locations of the reference genome (multiple mapping) but did not count them as translocation errors because such events were detected even when reference transcripts were used in our GMAP test. It is obvious that EBARDenovo generated the least number of translocations among three programs in all the six experiments (). In the A.thaliana datasets, the number of erroneous contigs by EBARDenovo is less than one-fifth of those by Trinity. In the mouse and human datasets, Trinity produces two to three times more erroneous contigs than EBARDenovo. The assembly results by Oases with a smaller k-mer (21 bp) produced more translocation than with a bigger k-mer (25 bp). The merging assembly by Oases will accumulate errors from the assemblies with different k-mers. The detail results of GMAP test are listed in Supplementary Table S2. The high accuracy of the proposed algorithm implies more stringent trimming of inaccurate contigs, which results in the reduction of contig length. For this reason, we checked the correctness of contigs at comparable lengths. We divided the contigs by their lengths into three groups (600$799, 800$999 and 1000$1199 bp). We evaluated the accuracy of each contig group for the three assemblers using the GMAP. Supplementaryshows the results. In all the contig groups for all six datasets, EBARDenovo always produces the most accurate results.
The comparison of assembly coverage at different expression levels by different assemblersTo evaluate the performance of different assemblers on the reconstruction of full-length transcripts, EBARDenovo and the other two assemblers were compared using three RNA-Seq datasets: SRX112186 (A.thaliana), SRX118647 (mouse) and SRX135562 (human). The expression quantiles were calculated using the RNA-Seq Analysis tool in the CLC package. The completion of transcript reconstruction was estimated by comparing contigs with reference cDNA sequences from TAIR () and RefSeq (). Transcripts with higher coverage generally can be reconstructed much closer to full length, by merging contigs generated from different k-mers, Oases-M, therefore, produced a more completed reconstruction than other tools (), but paid a high price in accuracy (). Artificial translocations generated by Oases-M were much greater than those generated by the programs using only a fixed k-mer. In addition, performance of Oases clearly dropped for highly expressed transcripts. In contrast, EBARDenovo gave the best performance on transcripts with high expression.
CONCLUSIONSEBARDenovo is designed for accurate assembly of paired-end RNA-Seq data. It consumes less memory space than Trinity and Oases, whereas its speed is between that of Trinity and Oases (). More importantly, in our experiments, the contigs produced by EBARDenovo have much higher accuracy than those by both Trinity and Oases. The detection of aberrant chimeric reads is the key factor for high accuracy of EBARDenovo. Accurately generating full-length transcripts and lowexpression transcripts are important goals for the assembly of RNA-Seq data. There are chimeric transcripts created by natural gene fusion or sequence recombination. Methods such as EricScript have been developed to identify these naturally occurring chimeric sequences (). Nonetheless, there are also aberrant chimeric reads, which are artifacts from sequencing processes. Chimeric read detection methods, such as ChimeraScan () and UCHIME (), require reference genomes and are therefore not applicable in de novo assembly. The de Bruijn graph assemblers, such as Velvet (), do not use active chimera-detection functions, but instead, remove low-coverage reads (occurrence 2) as potential aberrant chimeras. This rule makes the Velvet algorithm less suitable for RNA-Seq data, as the abundance of transcripts vary greatly. The other de Bruijn graph assemblers, such Oases and Trinity, relax the rule of eliminating low-coverage contigs to allow the assembly of rare reads (occurrence  1) (). However, the preservation of potential aberrant chimeric reads may produce artificial translocations of transcripts in the final assembly. In the past years, de Bruijn graph methods had showed its advantage for full-length assemblies, but chimeric k-mer nodes limited the capability of modern de Bruijn graph algorithms to generate accurate low-coverage assemblies. Moreover, using shorter k-mer in de Bruijn graph assembler algorithms produces more mis-assemblies (), whereas EBARDenovo can maintain high accuracy of assembly evenThe results were from the assemblies of the A.thaliana test data (in). bThe maximal memory of running Trinity was the memory usage of the GraphFromFasta process at the stage of Chrysalis. The default Jellyfish process of the Inchworm stage usually consumes more memory (10$100 G) for good performance. cAll the programs were run on VMware Virtual machines. The host machine is an i7-3820 PC with 32G RAM. Trinity and Oases were run on Ubuntu 10.04, and EBARDenvo was run on Windows 7. Both virtual machines are equipped with same memory space (24 G) and same CPU cores (2:2). with a short key length (Supplementary). In conclusion, the EBARDenovo algorithm is a promising new approach to identify transcripts from RNA-Seq analysis.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
EBARDenovo algorithm consists of three key operations: extension, bridging and repeat sensing. These operations are applied to both the right-end and the left-end expansions such that the selected sub-optimal reads are added in these operations. Before starting the three assembly operations, EBARDenovo defines the first few base pairs (the default is 15 bp) of each read as its indexing keys. The reads are also sorted according to their abundance, and the most abundant read is selected as the first seed for the extension, followed by the second most abundant reads and so on. To start the extension operation of assembly, the 2nd to the nth bp (the default is from 2nd to 16th bp corresponding to a 15mer) will be used as the query key to search against the indexing keys of all reads. If no matching key is found, a query key will be generated from the 3rd to the 17th bp and so on. If a matching key is found, the reads containing this key will be aligned to the seed read at the error detection area (Supplementary Fig. S4). Error detection area is the overlapping region between the seed and the matching read, but excluding the key index region. At this step, all perfectly matched reads will be merged to extend the seed to a longer contig. If no perfect candidate is available, the reads with fewest mismatches will be used. However,410% mismatch in the error detection area is not tolerated. In the bridging operation, EBARDenovo uses paired-end information to constrain the search space. By using 'foreseeable reads' to confirm correct assembly, reads with as small as 15 bp overlaps can be constructed into reliable contigs. A read is 'foreseeable' if one of its paired-end sequenced mates is already in the contig (Fig. 3a). If a foreseeable read is already aligned in the contig, the extension of an assembled contig is continued (Fig. 3a). The extension at this stage is only one-way, either left to right or right to left. This is because bi-directional extension of a chimeric seed read would probably generate a chimeric contig, and there is insufficient information to detect chimeric reads at this stage. In the case that the foreseeable read is not Fig. 2. The key principles in EBARDenovo for achieving high accuracy. (a) The outline of EBARDenovo algorithm. Candidate reads are iteratively added at both ends with three operations: extension, bridging and repeat sensing. (b) The two conditions for the alignment of an adjacent pair of reads (R a and R b ) or (L a and L b ). (i) the paired mate (L b or R a ) is inside the current contig. (ii) The paired mate (R b ) is found in neighboring (usually overlapping) contigs. (c) Dynamic chimera detection. The aligned reads from the backtracking process are compared with the consensus sequence (T A ) to detect potential chimeric junctions
Highly accurate de novo assembly of RNA-Seq at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
H.-T.Chu et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
