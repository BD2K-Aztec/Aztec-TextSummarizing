Motivation: Transcriptional regulatory network inference methods have been studied for years. Most of them rely on complex mathematical and algorithmic concepts, making them hard to adapt, re-implement or integrate with other methods. To address this problem , we introduce a novel method based on a minimal statistical model for observing transcriptional regulatory interactions in noisy expression data, which is conceptually simple, easy to implement and integrate in any statistical software environment and equally well performing as existing methods. Results: We developed a method to infer regulatory interactions based on a model where transcription factors (TFs) and their targets are both differentially expressed in a gene-specific, critical sample contrast, as measured by repeated two-way t-tests. Benchmarking on standard Escherichia coli and yeast reference datasets showed that this method performs equally well as the best existing methods. Analysis of the predicted interactions suggested that it works best to infer context-specific TF-target interactions which only co-express locally. We confirmed this hypothesis on a dataset of 41000 normal human tissue samples, where we found that our method predicts highly tissue-specific and functionally relevant interactions, whereas a global co-expression method only associates general TFs to non-specific biological processes. Availability: A software tool called TwixTrix is available from http:// twixtrix.googlecode.com.
INTRODUCTIONTranscriptional regulatory networks, which emerge from the combinatorial regulation of the expression of all genes in an organism by a limited number of transcription factors (TFs), control the cellular response to internal and external perturbations. At present, direct experimental mapping of complete transcriptional regulatory networks remains infeasible, particularly in higher organisms, especially since the structure of these networks is itself condition-dependent (). A lot of attention has therefore been devoted to computationally reconstruct transcriptional regulatory networks from compendia of genome-wide gene expression measurements in diverse conditions, time points, cell types or genotypic backgrounds (). However, despite many years of research, it still remains a question which computational methods are most suited to tackle this problem. Moreover, regulatory network inference remains a task firmly in the hands of specialists, and network inference algorithms are still not routinely included in standard statistical software packages, unlike for instance differential expression testing or co-expression analysis. At least in part this is due to the fact that most network reconstruction methods depend on non-trivial mathematical concepts such as mutual information (), differential equations (), biophysical models (), Bayesian networks (), ensemble methods () or machine learning (Huynh). While these complex mathematical models are well justified in theory, current gene expression datasets have high levels of noise and are lacking in resolution, making these models prone to over-fitting. Furthermore, the resulting algorithms are difficult if not impossible to re-implement, as they often depend on poorly documented parameter choices and heuristic techniques, for instance to improve convergence rates or avoid local optima. In order to address these problems, we propose a novel method which is based on a minimal statistical model. The model assumes that TFs and their targets are both differentially expressed in a gene-specific sample contrast, but it makes no assumption on any functional relationship, be it linear or non-linear, between the gene expression profiles of TFs and their targets. It should thus be ideally suited to infer regulatory interactions from noisy, low-resolution gene expression maps. First, the method identifies for each gene its 'critical contrast', the separation of samples into two sets across which that gene is most significantly differentially expressed (as determined by two-way t-tests). Second, the method takes a list of TFs or other regulatory proteins and calculates their differential expression in the critical contrast of each possible target gene (again determined by two-way t-tests). The predicted network is the list of TF-gene associations, ranked by these t-test P-values, either considered as a weighted network or cutoff at a desired significance threshold. *To whom correspondence should be addressed.The idea to use t-tests to predict regulatory interactions was first proposed by. Here, we systematically evaluate the performance of this double two-way t-test procedure using benchmark expression data () and networks of known transcriptional regulatory interactions () in Escherichia coli and yeast, following standard evaluation protocols established by the DREAM community (). We found that double two-way t-testing performs as well as the best current methods, especially in yeast. Next, we compared the top-ranked predictions of each method and found that the t-test procedure identifies a considerably different set of interactions than the other methods. In particular, whereas the top-ranked predictions of the other methods tend to exhibit high levels of global co-expression between the TFs and their predicted targets, interactions found by the t-test procedure tend to only co-express locally and involve TFs that are only expressed under certain experimental conditions. We therefore hypothesized that the double two-way t-test method is particularly useful to predict context-specific networks in multi-cellular organisms. To test this hypothesis, we applied it to a global gene expression compendium containing 41000 samples from normal human tissues (). Although due to a lack of knowledge in human, a systematic evaluation of the predicted network is impossible, manual analysis of the top-ranked TFs showed that the functional enrichment of their predicted targets is indeed highly consistent with known cell-type specific modes of action for these TFs.
METHODS
Critical contrast determinationThe first step of the double two-way t-test procedure consists of determining the critical contrast for each gene in a gene expression data matrix. The differential expression of a gene g in a partition C 1 ; C 2  of the set of samples in two distinct sets can be determined by the ordinary t-statistic,where 1 and 2 are the means of the expression values of gene g in C 1 and C 2 , respectively, and similarly, 1 and 2 and n 1 and n 2 denote the standard deviations and the numbers of conditions in C 1 and C 2 , respectively. The critical contrast of g is defined as the partition C 1 ; C 2  with highest value of t. An ordered partition is defined as a partition where all expression values in C 1 are smaller than all expression values in C 2 , i.e. maxC 1  minC 2 . For any non-ordered partition, we can create an ordered one with the same n 1 and n 2 by repeatedly swapping maxC 1  and minC 2 . It is not hard to see that the t-statistic for this ordered partition must be higher than for the original non-ordered partition. Hence, the critical contrast can be determined by taking the maximum over all ordered partitions, of which there are only K  1 per gene, where K is the total number of samples in the dataset. A minimal number of samples on each side of the partition can be set, although the factor ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi n 1  n 2 =n 1 n 2 p in Equation (1) ensures that the critical contrast will automatically be balanced (see Supplementary Material for details).
Scoring of regulatory interactionsGiven a list of candidate TFs or other regulators and a critical contrast for all possible target genes, we define the interaction score t f;g between a TF f and target gene g as the t-statistic of f in the critical contrast of g. The higher t f;g , the more confident we are about the predicted regulatory interaction f ! g. A confidence P-value can be computed from t f;g using a Student's t-distribution with K  2 degrees of freedom, where K is the total number of samples in the dataset.
Moderated t-statistics and background correctionSome transformations of the interaction score t f;g are worthwile to consider. First, because for each gene g, the differential expression of a relatively large number of TFs is tested in the same critical contrast C 1 ; C 2 , while we expect only few of these TFs to have signifcantly high differential expression, moderated t-statistics can be used () to provide a more stable inference in datasets with a limited number of samples. Second, to make the interaction scores better comparable between genes with potentially very different critical contrasts, we can apply a background correction defined aswhere t f;g is the ordinary or moderated t-statistic interaction score, and g and g are the mean and standard deviation of t f;g over all TFs f for a given gene g, respectively. Finally, we can also compute the t-statistic of a target gene g in the critical contrast of TF f and define a symmetric score Z sym f;g  Z f;g  Z g;f .
Algorithm implementationA software tool called TwixTrix is available from our web site, providing two implementations of the double two-way t-test procedure. The first implementation (in R) uses the Limma package () to calculate moderated t-statistics and background corrected interaction scores and is recommended for datasets with a small number of samples. The second implementation (in R or Matlab) encodes the critical contrast determination and interaction scoring using ordinary t-statistics purely as matrix operations. It is ultra-fast and recommended for datasets with a large number of samples.
Comparison with other network inference methodsWe downloaded the latest versions of Inferelator (), CLR (), LeMoNe () and GENIE3 (Huynh) from their respective homepages and ran them with default settings. For LeMoNe and Inferelator, which are module network inference algorithms, we assigned each gene to a singleton module to obtain a TF-gene regulatory network. As a baseline, we also reconstructed networks based on the), from which we selected 1033 samples measuring gene expression in 67 diverse tissues under normal conditions. We reconstructed networks using a list of 941 candidate TFs from TcoF () and 12 568 differentially expressed genes (SD40.5).
RESULTS AND DISCUSSION
Benchmarking on E. coli and yeast datasetsTo benchmark the double two-way t-test procedure, we analysed its performance on standard E. coli and yeast datasets, by calculating recall versus precision curves based on the top 3000 predicted interactions (see 'Methods' for details). Inand 2, we compared different versions of double two-way t-test interaction scores, namely the t-statistic t f;g of a TF f in the critical contrast of a gene g, the background corrected score Z f;g () for the ordinary t-statistic and one for the moderated t-statistic and a symmetrized background corrected score for the ordinary t-statistic (cf. Section 2.3). Although the symmetrized version works slightly better in yeast, this is not the case in E. coli. In order not to overfit for a specific dataset, we choose the unsymmetric background corrected score for the ordinary t-statistic (cf. Equation(2)) as the default score, because it performs well in both datasets and is conceptually the simplest and fastest to compute. All results reported in the remainder of this article refer to this interaction score. Next, we compared the double two-way t-test procedure against six other methods on the E. coli and yeast datasets, again calculating recall versus precision curves based on the top 3000 predicted interactions by each method (). As has been observed before (), overall performance in yeast compared with E. coli is lower for all methods. This may be due to more complex regulatory mechanisms in eukaryotes versus prokaryotes, a less accurate reference network against which performance is measured or, most likely, a combination of these two. Most importantly, neither of the algorithms is better than all the others in both organisms (cf.). TwixTrix, our implementation of the double two-way t-test algorithm, performs equally good as the much more complicated algorithms, especially in yeast where it is ranked second best. Also noteworthy is the fact that in E. coli, but not in yeast, regulatory interaction prediction based on the Pearson correlation between TFs and putative target genes also performs similarly well as the other methods. This suggests that, generally speaking, TFs and their targets tend to be globally co-expressed in prokaryotes and the real challenge is to predict regulatory networks in eukaryotes.
TwixTrix identifies context-specific interactionsAn important recent insight has been that different network inference strategies identify different aspects of a regulatory system. Understanding how a method differs from others has therefore become more important than simple recallprecision measurements, with the eventual goal to build meta-networks which integrate predictions from diverse computational methods (). Here, we focused on characterizing TwixTrix-predicted interactions in yeast, where it is most successful relative to the other methods. The corresponding figures for E. coli can be found in the Supplementary Material. First, we compared the overall similarity of interactions predicted by each method. The overlap (measured as the number of common interactions among the top 500 predicted interactions) ranges from 31 to 232 common interactions. TwixTrix shares between 31 (with Spearman correlation) and 144 (with LeMoNe) interactions with the other methods. Using the number of non-overlapping interactions as a distance measure, the relative similarities between each of the seven network inference methods is visualized in. As expected, the networks based on Pearson and Spearman correlation are most similar. GENIE3 () and LeMoNe () both use decision trees to assign regulators to target genes and consequently predict similar networks as well. TwixTrix, CLR and Inferelator each occupy a more unique position in the network inference landscape. Since TwixTrix is based on differential expression testing, we hypothesized that it tends to identify TF-target interactions which do not necessarily co-express under all conditions.shows the distribution of Pearson correlations between TFs and their predicted targets for the top 500 interactions in yeast for each method. Interactions predicted by TwixTrix indeed have significantly lower Pearson correlations than interactions predicted by the other methods. GENIE3, Inferelator and LeMoNe, which perform less well in yeast than TwixTrix and CLR, are especially biased towards inferring interactions which co-express under most conditions in the dataset. A simple example illustrates the difference between contextspecific and global interactions. MET32 is a TF involved in the regulation of methionine (an amino acid) biosynthesis. It has 30 predicted targets in the top 500 network of TwixTrix, of which 9 are known targets, which are strongly enriched for amino acidbiosynthesis genes (hypergeometric P510 12 after multiple testing correction). The interactions predicted for MET32 are among the highest scoring by the double two-way t-test, yet their global Pearson correlation is only 0.64 on average. As shown in, MET32 and its targets are only expressed under amino acid starvation and nitrogen depletion, resulting in a strong signal upon differential expression testing despite weak global correlation. The opposite situation happens for HAP4, a transcriptional activator and global regulator of respiratory gene expression. HAP4 has 14 predicted targets in the top 500 network of TwixTrix, of which 11 are known targets, which are strongly enriched for cell death and oxidative phosphorylation (hypergeometric P510 10 after multiple testing correction). Despite a higher global co-expression between HAP4 and its predicted targets (average Pearson correlation 0.73), the t-test scores are relatively low (only two predicted interactions in the top 100). In contrast, for GENIE3, Inferelator and LeMoNe, which all favour highly co-expressed interactions (cf.), the HAP4 predictions are all among the highest scoring true positive interactions (respectively four, seven and four true positives in the top 10 predictions).shows that HAP4 and its targets are all highly expressed under YPD stationary phase and heat shock conditions, while they are under expressed in glucose conditions. This results in a strong global, but weaker conditionspecific signal.
Tissue-specific network inference from a human gene expression atlasWhile the ability to detect context-specific interactions in yeast is important, the dataset consisted of samples for altogether 10 different experimental conditions (), making the distinction between condition-specific and global interactions somewhat arbitrary. In contrast, global gene expression maps in mammalian systems can consist of hundreds of different cell and tissue types, developmental stages or disease states (). To test TwixTrix in such a setting, we applied it to a large dataset of 41000 samples from 67 normal human tissues (see 'Methods' for details). Because there exists no comprehensive reference database against which an inferred transcriptional regulatory network can be validated in human, we manually analysed the topranking TFs and computed the functional enrichment of their targets in the top 10 000 TwixTrix interactions (). In all cases, the TFs are expressed only in a very small set of samples from specific tissues, which are highly consistent with the most enriched Gene Ontology (GO) term among their targets. This supports the hypothesis that double two-way t-testing is indeed well suited to predict tissue-specific gene regulatory networks. As expected, the different characteristics observed in yeast between TwixTrix and the other, more globally oriented methods become much more pronounced in the human dataset.shows the expression profiles across all samples for two representative TFs from. GCM1 is a TF necessary for placental development. It and its predicted targets (see highresolution heatmap in Supplementary Material) are highly expressed in placental samples (, top). Likewise, TBX5, a TF with a role in heart development, and its predicted targets (see high-resolution heatmap in Supplementary Material) are highly expressed in samples from the heart (, bottom). For both TFs, we took a representative high-scoring target and created a scatter plot of their respective expression levels (, blue and red points). These TF-target relations have a welldefined tissue-specific off/on behaviour. These highly tissuespecific co-expression signals result in very significant t-test scores. However, because of the noisy low-level expression in all the other samples, such a signal cannot be detected by global co-expression methods. In contrast,shows the expression profiles across all samples for two representative high-scoring TFs in the CLR network. Both have a characteristic profile that fluctuates across different tissue types. BBX (, top) is a TF necessary for cell cycle progression from G1 to S phase and ZNF24 (, bottom) is a TF involved in promoting the cell cycle in the developing central nervous system.NANOG Nanog is a core factor that is required for the maintenance of embryonic stem (ES) cell pluripotency and self-renewal ().Human universal reference and kidney samples 41 34 12 Response to wounding 5.15E4 Context, samples in critical contrast; N, number of targets in top 10 000 predictions; M, number of targets with GO annotation; m, number of targets annotated with most significant GO term; Enriched GO term, most significantly enriched GO term; P-value, hypergeometric enrichment P-value after correction for multiple testing.For both of them, their CLR-predicted target sets (see high-resolution heatmaps in Supplementary Material), though highly coexpressed across most samples, are only enriched for non-specific functional categories such as regulation of gene expression or metabolic process. A scatter plot of TF-target expression levels for a representative target for both TFs confirms that they show a high linear correlation across most samples (, green and black points). CLR predictions thus clearly represent general processes which are globally co-expressed and not confined to a single tissue or cell type. GENIE3, Inferelator and LeMoNe could not be applied with reasonable runtime on the complete human dataset. We therefore reduced the size of the dataset by averaging samples from the same tissue type. Results on this reduced dataset confirmed that all methods except TwixTrix give highest rank to globally co-expressed TF-target pairs involved in general cellular processes, although the relation between the expression of TFs and their predicted targets tends to be more non-linear for GENIE3 and LeMoNe than for CLR and Inferelator (see Supplementary Material for details, including a runtime comparison between all algorithms). As a particular example of non-tissue-specific interactions, GENIE3 and LeMoNe predict 35 and 36 targets, respectively, among their top 200 predictions for the TF FOXM1, which are strongly enriched for M phase (P510 14 ) and mitotic cell cycle (P510 15 ), respectively. FOXM1 is a transcriptional activator involved in cell proliferation which is indeed known to regulate the expression of several cell cycle genes.
CONCLUSIONReconstructing transcriptional regulatory networks from genome-wide gene expression data remains an important bioinformatics challenge. Although diverse mathematical and computational methods have been proposed to address this problem, they have not been as successful as might originally have been expected. A possible reason is that current gene expression datasets are too noisy and lack the resolution for adequately fitting complex mathematical models. Here, we analysed a method which, rather than adding to the complexity of network inference methods, uses a minimal statistical model for associating TFs to putative target genes without assuming any linear or non-linear functional relationship between their expression profiles. The method is based on a double two-way t-test which assesses the differential expression of a TF in the critical sample contrast of all genes. Essentially, this results in a local co-expression measure which appears well suited to capture context-specific transcriptional activity, at the expense of giving less weight to globally co-expressed TF-target pairs. In bacteria, much of the cellular response to perturbations is controlled at transcriptional level only, such that many TF-target pairs are co-expressed under all experimental conditions. Here, the double two-way t-test therefore does not improve upon existing methods. In yeast however, there is evidence of known transcriptional interactions which only co-express under specific conditions. The t-test procedure prioritizes such interactions and indeed performs better in yeast than E. coli, relative to the existing methods. Taking this one step further, we hypothesize that the double two-way t-test method for inferring regulatory interactions will be particularly useful to analyse global gene expression maps in multi-cellular organisms which combine data from hundreds of different samples. Indeed, we confirmed that our method predicts highly tissue-specific and functionally relevant interactions from a dataset of 41000 normal human tissue samples, whereas global co-expression methods only associate general TFs to non-specific biological processes. In view of the time it takes to experimentally generate large expression compendia, judging a network inference method by its running time is perhaps not very relevant. Nevertheless, we note that, depending on hardware details, the t-test procedure took not more than a few seconds to analyse the human dataset, while the other methods needed from a few hours upto several days. Having a fast method is clearly beneficial, e.g. to easily compare results from different normalizations of the data, or from different subsets of a large data compendium, e.g. from normal versus disease states, cell lines versus tissue samples, etc. In summary, we believe that the double two-way t-test method provides a useful addition to existing network inference methods, whose primary strength lies in prioritizing context-specific regulatory interactions from global gene expression maps which integrate data from hundreds to thousands of samples from diverse experimental treatments, cell types, tissues, developmental stages or individuals. Confilict of Interest: none declared.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.Qi and T.Michoel at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Context-specific transcriptional regulatory network interface at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
