Motivation: Traditionally, microarrays were almost exclusively used for the genome-wide analysis of differential gene expression. But nowadays , their scope of application has been extended to various gen-omic features, such as microRNAs (miRNAs), proteins and DNA methylation (DNAm). Most available methods for the visualization of these datasets are focused on individual platforms and are not capable of integratively visualizing multiple microarray datasets from cross-platform studies. Above all, there is a demand for methods that can visualize genomic features that are not directly linked to protein-coding genes, such as regulatory RNAs (e.g. miRNAs) and epigenetic alterations (e.g. DNAm), in a pathway-centred manner. Results: We present a novel pathway-based visualization method that is especially suitable for the visualization of high-throughput datasets from multiple different microarray platforms that were used for the analysis of diverse genomic features in the same set of biological samples. The proposed methodology includes concepts for linking DNAm and miRNA expression datasets to canonical signalling and metabolic pathways. We further point out strategies for displaying data from multiple proteins and protein modifications corresponding to the same gene. Ultimately, we show how data from four distinct platform types (messenger RNA, miRNA, protein and DNAm arrays) can be integratively visualized in the context of canonical pathways. Availability: The described method is implemented as part of the InCroMAP application that is freely available at www.cogsys.cs.uni-tuebingen.de/software/InCroMAP.
INTRODUCTIONThe first generation of microarray platforms was developed as a high-throughput technique for profiling the transcriptome of diverse biological systems (i.e. cells, organs or organisms) under various experimental conditions (). To date, a plethora of different microarray platforms are readily available. These include gene-centred platforms that rely on current genome annotations and unbiased tiling arrays that interrogate large non-repetitive regions of the genome. Diverse types of platforms have been specifically designed for the interrogation of different genomic features, ranging from messenger RNA (mRNA) or microRNA (miRNA) transcripts, through proteins or protein modifications, to relevant functional elements, such as exons, single-nucleotide polymorphisms or promoters (). In addition to arrays serving for the quantification of global gene expression on the RNA or protein level, also epigenetic modifications, such as DNA methylation (DNAm), can be monitored on a genome-wide level using microarray technology (). Microarray datasets are typically not only inspected on the level of individual genes, but rather differential gene expression in the context of groups of functionally related genes. For instance, the overrepresentation of genes related to the same biological process or involved in the same pathway is investigated by using statistical tests (e.g. Fisher test or hypergeometric test) or gene set enrichment analysis (). Traditional overrepresentation analysis methods require fixed sets of up-or downregulated genes that are usually defined with fold-change and/or P-value cut-offs. Modern gene set enrichment analysis-like methods, in contrast, do not require cut-offs to detect sets of functionally related genes showing a trend towards differential gene expression (). As a result of pathway enrichment, a list of significant pathways that contain genes with strong differential expression is returned. To obtain more details about this result (e.g. which genes are up-or downregulated within a pathway), suitable visualization methods are required. Several tools exist for the visual inspection of datasets from individual platforms (see, for some examples). As the first microarrays were mostly limited to mRNA transcripts, the majority of these visualization tools are still focused on mRNA datasets. However, the current inventory of publicly available tools, which are capable of integrating and jointly visualizing data from multiple microarray platforms, is still limited. Although for genomic features, which are not directly linked to genes (such as DNAm or single-nucleotide polymorphism data), region-based visualization methods [e.g. the UCSC genome browser (are commonly used, data from gene-centred genomic features (mRNAs, proteins,. . .) are often visualized using network-based visualization methods [e.g. Cytoscape () or KEGG Atlas (. Although the former approach may provide more detailed information about individual genes or genomic loci, conclusions about higher order mechanisms can often be more easily drawn from a pathway-based view of the data. Thus, we propose to first focus on pathways relevant to the studied phenomenon, which can be identified using enrichment analysis methods. Subsequently, network hubs or key regulators can be inspected in more detail using complementary region-based visualization methods. Here, we introduce a method for integrated pathway-centred visualization of datasets, generated from the same biological samples using different microarray platforms, which monitor complementary genomic and epigenomic features. In recent years, diverse tools were developed, which are specialized in pathway analysis (e.g. Ingenuity) or pathway visualization. Some of these tools offer visualizing experimental data in a pathway [e.g. KegArray (), Pathline (), GenMAPP () or MGV (. For this purpose, the experimental data are typically mapped to a colour gradient and displayed in the background colour of the pathway nodes. GenMAPP or MGV even have capabilities to display multiple colours in a single node (e.g. for the visualization of time-series experiments). MGV goes one step further and offers additional features to put profile plots or heatmaps inside nodes. However, all of these tools are not able to handle data from genomic features that have no direct reference to the genes in a pathway (e.g. miRNAs or genomic regions). Furthermore, none of these tools offers viable solutions that are tailored for the integration of multiple datasets obtained from heterogeneous microarray platforms.
METHODSBefore visualization, the microarray datasets of interest have to be preprocessed and annotated using platform-specific workflows (). These workflows usually involve (i) the quality control of the raw data (, (2) the data normalization to correct for background noise and experimental variation () and (iii) the mapping of probes to genes or genomic regions. After these preprocessing steps, the microarray data have to be exported in tabular format. These tables have to contain the following two types of columns: (i) annotation columns, containing probe or probeset IDs (e.g. Affymetrix IDs) and database IDs of the corresponding genes (e.g. Ensembl or Entrez IDs) and (ii) data columns containing either fold-changes or P-values resulting from basic statistical analysis of the microarray data. The pathway data are automatically imported from the Kyoto Encyclopedia of Genes and Genomes (KEGG) (). In the KEGG PATHWAY database, each pathway map is available for download as a document in the KEGG Markup Language (KGML) which is internally converted into a graph structure by InCroMAP. To overcome limitations of the KGML format, one can create an overlay graph that shows the original KEGG pathway image in the background, which may provide the user with additional information about cellular structure and compartmentalization. Relevant pathways can be deduced by a gene set enrichment analysis or simply by manually choosing any pathway to visualize. After importing the data, the KEGG pathway nodes, which correspond to genes or gene families, can be overlaid with fold-changes measured on mRNA or protein expression level. Furthermore, DNAm changes observed in the proximal promoter regions can be visualized. In the final step, additional nodes corresponding to miRNAs can be added to the pathway and coloured according to the expression changes measured in the underlying experiment. Seefor an illustration of all the aforementioned visualization steps.
Pathway visualizationThe basic prerequisite for generating a pathway-based visualization is visualizing the pathway itself. For this purpose, we are using KEGGtranslator (see), which performs a basic conversion of the KEGG KGML documents to GraphML. In short, KEGGtranslator converts all KGML entries to nodes and all relations to edges. Compounds are depicted by small circular nodes, genes or proteins are rectangular-shaped nodes and group nodes are used to illustrate complexes or families. The original layout, given in the KGML document, is used to position all nodes. Then, all nodes are annotated with diverse identifiers [e.g. Entrez Gene identifiers (, descriptions and further information. The resulting document provides the basis for the subsequently generated visualizations. At least for some pathways, the KGML document available at KEGG does not contain all information that is depicted in the corresponding pathway map. Thus, an overlay graph can be generated which contains the original pathway map as a static transparent image in the background of the interactive graph plot (). By using the given x and y coordinates together with height and width of each interactive node, it is possible to match each node exactly on the background pathway picture. However, to allow a clear distinction between the actual pathway in the foreground and the pathway background picture, the background picture should be brightened by at least 70%. Owing to this optional feature, additional information on cellular structure (e.g. schematic drawings of receptors involved in cell signalling) can be maintained.
Visualization of mRNA expression dataAs mRNA expression data are typically available for the whole genome and thus also for the majority of nodes in a particular KEGG pathway, these data are displayed in the background colour of the nodes. As input, our method requires preprocessed mRNA datasets with annotation columns (e.g. gene identifiers) and data columns, which are referred to as observations. In this context, observations can be any statistical significance (e.g. P-values) or comparative measure (e.g. fold-changes or log-ratios). Next, these data have to be broken down to a single value for each pathway node, which then determines the colour of the node. As single nodes can represent multiple genes in KEGG, the intensities measured by probes, corresponding to the same node, have to be summarized. To this end, either the mean or median is calculated across these probes, or the probe with the strongest or most significant signal (i.e. min P-value or max jfold-changej) is decisive for colouring the node. Among others, the InCroMAP application provides all of these summarization methods. To visualize fold-changes or log-ratios in the context of pathways, a colour gradient ranging from blue through white to red is used to illustrate down-and upregulation. Non-differentially expressed genes are shown in white, and pathway nodes for which no mRNA data are available are displayed in grey. If desired, P-values can be shown instead of fold-changes. For this purpose, we decided to map the negative logarithm of the P-values to a colour gradient, which leads to a more intuitive illustration of the observed significances. Seefor an example of visualized mRNA data.
Visualization of protein expression dataVisualization of protein datasets is performed by adding small boxes below pathway nodes and changing the colour of the boxes according to the corresponding protein expression data. As state-of-the-art experimental techniques (e.g. reverse-phase protein arrays, quantitative mass spectrometry) facilitate the distinction between different protein modifications (e.g. phosphorylated or acetylated forms of proteins), multiple measurements may correspond to the same gene (). In this particular case, the expression change observed for each individual protein form is represented as a separate box below the corresponding node. Each of these boxes is then labelled according to the respective protein form and coloured based on the underlying expression data, as described previously for mRNA datasets. We require protein datasets to be annotated with database identifiers referring to proteins or genes (e.g. Entrez Gene IDs), which allows us to perform a straightforward mapping to pathway nodes. For protein modification datasets, we further require a column, determining the actual modification for every protein.
Visualization of DNAm dataDNAm microarrays are similar to tiling arrays and contain many probes that can be assigned to a single gene. But visualizing the signal levels of all probes assigned to a certain gene in one pathway node would clutter the picture and reduce the clarity of it. For DNAm in gene promoters, it is most important to know whether there are methylation changes and whether the promoter is rather hyper-or hypomethylated. The methylation details can then be inspected manually later (e.g. the InCroMAP application provides a detailed XY plot of the DNAm if one clicks on a pathway node, see). Therefore, the DNAm status, observed in the proximal promoter of a gene, is summarized and graphically represented by adding boxes to the left side of the pathway nodes. These boxes are drawn on a white background and contain a grey bar that stretches from the middle to the left, in the case of hypomethylation, and from the middle to the right to indicate hypermethylation. Instead of discriminating between hyperand hypomethylation, one can simply visualize the amount of differential methylation. In this case, the grey bar would stretch from the left border of the box to the right border. The length of the grey bar is proportional to a summary value reflecting the DNAm status of the promoter of a certain gene. This value is by default computed from the probes in a region ranging from 2000 bp upstream of the transcription start site to 500 bp downstream. For mRNA expression arrays, the summarization of probes corresponding to the same transcript is usually achieved by the median polishing algorithm (see), which effectively alleviates the influence of outlier probes. However, this algorithm is only applicable under the assumption that ideally the probe intensities are evenly distributed along transcripts. This assumption does not hold true for the DNAm of promoter regions, as the probe intensities are not expected to be evenly distributed along the region. Furthermore, outlier probes, corresponding to DNAm peaks, are mostly not because of probe-specific effects, but rather reflect a local change in the DNAm pattern, which may be biologically meaningful. A method to overcome this issue is the detection and visualization of maximum peaks within the DNAm data. For peak detection, Nimblegen proposed two algorithms that are called 'windowed threshold detection' and 'second derivative peak detection'. A detailed description of these methods can be found in the user's guide of Nimblegen's SignalMap software (see NimbleGen). In addition to those sophisticated peak detection methods, one can also approximate peaks by using simple methods, such as picking the probe with maximum differential methylation (i.e. max jfold-changej). As an alternative to visualizing peaks derived from the probe-level fold-changes, one can also use a statistical approach to estimate theThe visualization of miRNA data by adding small triangles, representing miRNAs, and connecting them to their mRNA targets. The colour of the miRNA nodes refers to the corresponding fold-changes differential methylation in a promoter region. For this purpose, we propose to divide the promoter region r into segments b 1 ,. .. , b n , each containing a fixed number of probes. For each segment, a statistical test (e.g. ordinary or moderated t-test) can be used to detect differential methylation between two experimental groups. An overall significance value s can then be computed from the P-values P(b 1 ,. .. , P(b n ) using the formulaThis binning approach has the advantage of being sensitive to local changes in DNAm, as promoter segments with significant changes in DNAm are highly weighted. Conversely, segments for which slight changes were observed only contribute marginally to the overall significance score. InCroMAP, by default, approximates the peak by selecting the probe with maximum differential methylation. It further supports other options, such as the given formula s to process P-values and simple options that include mean, median, minimum and maximum. If multiple genes are associated to one node, all probes are pooled together and the summarization method is applied. By default, this will lead to a visual representation of the maximum peak contained in any gene that is represented by a node. The purpose of this visualization technique is giving researchers a hint if and how many methylation changes are present in a gene promoter. For more details, the genomic location of individual peaks can be visualized in a DNAm profile plot (see). To this end, the fold-changes observed for the probes covering the promoter region of a certain gene are plotted along their genomic coordinates. This depiction is particularly useful for comparing the DNAm profiles and peaks found for different observations (i.e. sample groups). To relate the DNAm data to data from gene-centred microarrays (e.g. mRNA expression arrays), each probe needs to be mapped to a gene. Thus, we require annotation columns containing the chromosome and the genomic position of each probe to facilitate the mapping from probes to genes.
Visualization of miRNA expression dataVisualizing miRNA datasets in the context of KEGG pathways is not straightforward, as these pathways do not contain miRNAs a priori. Therefore, to incorporate the data into a pathway, a connection must be established between the miRNAs and the protein-coding genes in the pathway. A simple approach for putting miRNAs in context would be inspecting the gene locus of the miRNAs. This approach already led to some valuable results, for example, the detection of a strong co-regulation within the genomic DLK1 locus (). But this approach is not suitable for linking the miRNAs with genes in a pathway. First, genes from neighbouring loci are not generally co-regulated. Second, a pathway shows, for example, how a signal is processed within a certain organism. The genes in a pathway are usually functionally related or represent regulatory relationships. Hence, when adding new nodes to a pathway, the relation should also be made based on functional or regulatory relationships. As the common mechanism of miRNAs involves the binding to complementary mRNA transcripts (), we propose to link miRNAs to their known target mRNAs. These target mRNAs can be obtained from diverse databases, which contain experimentally verified targets [e.g. miRecords (), miRTarBase (), TarBase (or predicted miRNA targets (reviewed in). We used a union of the three aforementioned experimentally verified miRNA target databases for the figures in this publication.shows a strong upregulation and Smc3 is downregulated. Smaller boxes below nodes show the protein and protein modification expression. For example, we visualized three different forms of TRP53: a phosphorylation at the serine 15 (S15) site, which shows almost no expression change, a modification of the S9 site, which is upregulated, and the basic protein itself, which is also upregulated. The grey boxes on the left of the nodes represent the maximum DNAm fold-change peak. A bar to the left indicates hypomethylation and a bar to the right hypermethylation. In our example, Ttk shows a strong hypermethylation. All aforementioned genes are highlighted in yellow. miRNAs are added as small triangles to the pathway and are connected with a grey edge to their mRNA targets. The colour of the miRNA nodes reflects the fold-change, as described for the mRNA nodes
IMPLEMENTATION AND AVAILABILITYThe described methods are implemented in InCroMAP, a tool for integrated analysis of cross-platform microarray and Pathway data. InCroMAP is a Java TM application that provides an interactive, user-friendly and easy-to-use graphical user interface and is freely available under the LGPL version 3 license from www.cogsys.cs.uni-tuebingen.de/software/InCroMAP. The application can import all aforementioned data types, is able to automatically download and layout KEGG pathways and apply all described visualization methods on those pathways. The resulting graphs can be exported as JPG, GIF, TGF, GML or GraphML. Furthermore, many options are provided that control, for example, the mapping of expression values to a continuous colour gradient and allow for customization of the generated cross-platform pathway visualizations.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Visualization of cross-platform microarray data at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
C.Wrzodek et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from Based on a map containing all connections between miRNAs and their target mRNAs, the miRNAs monitored in a specific experiment can be added to a pathway of interest as small triangular nodes, which have outgoing edges to the pathway nodes corresponding to their target mRNAs. The triangular miRNA nodes are coloured according to their expression, as described previously for mRNA datasets. This leads to an integrated visualization of a pathway, overlaid with miRNA and mRNA expression data, and extended with putative miRNAmRNA interactions. Figure 1f shows an example result of the described procedure. 3 RESULTS AND DISCUSSION In this work, we present a novel methodology for the combined visualization of DNAm data and mRNA, (phospho-) protein and miRNA expression data in the context of canonical pathways. This methodology involves strategies for mapping the data from heterogeneous platform types to a common functional element, namely, a gene, embedded into a pathway which regulates higher order cellular functions or processes. Furthermore, we propose visualization techniques that are particularly suited for displaying quantitative data from diverse genomic features in an integrated graph plot, which represents a metabolic or signalling pathway of interest. However, generating a joint visualization of epigenomics, transcriptomics and proteomics data is challenging, as each data type has its own characteristics. For proteomics data, we propose to map basic and modified proteins to their common source gene and draw each protein form as a separate box below the pathway node representing the source gene. Using this kind of visualization, one can, for instance, determine the activation state of a protein by comparing the colour (i.e. expression state) of the box corresponding to the basic form with the one that corresponds to the phosphorylated form. In brief, for most mRNA expression datasets, it is sufficient to annotate the probesets with appropriate gene identifiers to link the data with the pathways of interest. For miRNA datasets, this linkage is complicated by the fact that miRNAs are normally not contained in pathways. miRNAs are known to have a regulatory function by binding to complementary mRNA transcripts (Bartel, 2004). These interactions are documented in public databases, which we use to extract interactions between miRNAs and their target mRNAs. Using this information, one can add the miRNAs to the pathways and connect them to the existing nodes by inserting edges to the corresponding targets. The probe design of DNAm microarrays is typically not genecentred, but is region based. Thus, in contrast to gene-centred arrays, the probes are not organized in probesets, which were designed specifically for the same gene. Instead, these arrays cover specific genomic regions of interest, for instance gene promoters. The connection to protein coding genes is usually established by defining a region around the transcription start site of a gene and assigning all probes in this region to the gene. However, the visualization of every probe would vastly reduce the clarity of the visualization; therefore, a summary method is required. For DNAm changes, calculating a mean is often inappropriate because small peaks in a promoter region can already have a large influence on gene regulation. One of the summarization methods we consider advisable is the detection and visualization of maximum peaks, as it is sensitive to local changes in DNAm. Alternatively, if the data are properly normalized and smoothed (i.e. probe specific effects are alleviated), one can also take the probe with maximum differential methylation to approximate the peak. Nevertheless, every summarization method has its limitations. The maximum peak methods are definitely less robust against probe-specific effects, and the results may be inconclusive as a single positive peak may suggest hypermethylation of a region, while the majority of the promoter is clearly hypomethylated. On the other hand, if mean probe-level fold-changes are computed across larger regions, there is a higher chance that localized differential methylation is erased. An example for a KEGG pathway with visualized mRNA, miRNA, protein and DNAm data can be seen in Figure 3. The visualization of multiple heterogenous datatypes cannot be performed with either a loss of information or a loss of clarity. As these integrated pathway visualizations should provide an overview, rather than a detailed listing of all possible information, we tried to keep the clarity and summarize information wherever possible. At first glance, it always seems to be desirable putting as much information as possible into the pathway. For example, it would be possible to create small XY plots of promoter regions for every gene and add these pictures as small icons below each node. Other possibilities include the creation of heatmaps or visualization of multiple timepoints with various colours in a single node. But, especially if multiple datasets are visualized together in a pathway, it is important to summarize things and to not overload the whole picture. The main purpose of a pathway-based visualization is not to replace all other analysis and visualization methods, but rather giving a general overview that helps researchers to further analyse their data.
CONCLUSION Pathway enrichment analysis is a common microarray data analysis tool to discover pathways, whose genes show significant expression changes. In most applications, these enrichments are endpoints in analysis workflows. There are some methods or applications that can show pictures of significantly altered pathways, and a few applications can even change node shapes or colours according to a single expression dataset. However, not only the amount of available microarray datasets is growing rapidly but also the number of available platforms. At present, microarray platforms exist for profiling diverse genomic features, as for instance mRNAs, miRNAs, proteins and promoter regions. However, the current repertoire of analysis and especially visualization methods that are specifically designed for the analysis of cross-platform datasets is still limited. Here, we present a pathway-based cross-platform microarray visualization method that can, for example, be used to inspect relevant pathways detected by pathway enrichment analyses. Especially the visualization of DNAm and miRNA datasets is a feature that cannot be found in other visualization approaches. By integratively visualizing all datatypes, it helps researchers to discover potential relationships across multiple layers of gene regulation. For example, the hypomethylation of a promoter may cause the upregulation of a miRNA, which may in turn downregulate the corresponding target mRNA, whereupon a connected pathway protein could change its expression or activation state. Such complex cascades of effects, which involve multiple levels of gene regulation, can be deduced from the pathway images generated by the here presented visualization method.
C.Wrzodek et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
