Motivations: Recent progress in ancient DNA sequencing technologies and protocols has lead to the sequencing of whole ancient bacterial genomes, as illustrated by the recent sequence of the Yersinia pestis strain that caused the Black Death pandemic. However, sequencing ancient genomes raises specific problems, because of the decay and fragmentation of ancient DNA among others, making the scaffolding of ancient contigs challenging. Results: We show that computational paleogenomics methods aimed at reconstructing the organization of ancestral genomes from the comparison of extant genomes can be adapted to correct, order and orient ancient bacterial contigs. We describe the method FPSAC (fast phylo-genetic scaffolding of ancient contigs) and apply it on a set of 2134 ancient contigs assembled from the recently sequenced Black Death agent genome. We obtain a unique scaffold for the whole chromosome of this ancient genome that allows to gain precise insights into the structural evolution of the Yersinia clade. Availability and Implementation: Code, data and results are available at
INTRODUCTIONPalaeomicrobiology aims at analyzing ancient microorganisms, especially pathogens obtained from the remains of infected hosts (). Aside of an historical interest in characterizing precisely past infectious diseases (), understanding the evolution of pathogens and their relation with their hosts is of primary interest for modern microbiology (). Initially based on polymerase chain reaction techniques, ancient DNA (aDNA) sequencing benefited from advances in sequencing technologies and the development of new protocols, that lead to breakthroughs, such as the sequencing of whole molecules from the Yersinia pestis strain that caused the Black Death pandemic, including a plasmid () and the main chromosome (extracted 410 million short single reads (average length of 53 nt) from the dental pulp of an individual infected by the Black Death pathogen, using the genome of an extant Y.pestis strain (CO92) as a bait. They were assembled, using Velvet (), into 4130 000 contigs, including 2134 contigs of length !500 nt from the main chromosome of the Black Death agent. This first sequencing of the chromosome of an extinct prokaryote helped to clarify the causes of the Black Death pandemic (). However, the 2134 larger contigs cover only 85% of the expected length of the ancestral chromosome and their organization along this ancestral chromosome is still unknown, keeping out of reach a detailed genome-scale study of the evolution of the structural organization of Yersinia genomes, whose impact on pathogenicity is still an open question (). Current scaffolding methodologies can hardly be applied to fully assemble and finish an ancient bacterial genome from a dataset such as the one described by, aside of short molecules like plasmids (). These methods, aimed at ordering and orienting the contigs, and estimating the lengths of inter-contig gaps, rely on data such as mate-pair libraries with mixed insert sizes (), genome maps () or comparison with one or several closely related genomes (). Owing to the decay and fragmentation of aDNA molecules [whose length depends on many factors, but that can be as short as 300 nt (, reads from ancient genomes are expected to be short, and genome maps or mate-pair libraries with long inserts are not available. This leaves the comparative approach as the only possibility. The usual setting of the comparative approach involves the comparison of the contigs with one, or a few, closely related genomes sequences or maps (). For an ancestral genome, comparison with a single reference genome, either a descendant or an outgroup, is likely to predict derived syntenic features as ancestral (), which is a problem for genomes such as the Y.pestis genomes that contains many repeats and are highly rearranged (). There exists only one scaffolding method that allows to compare with several related genomes while using a phylogenetic tree (), but it is not designed to scaffold an ancient genome. We address this specific *To whom correspondence should be addressed problem here and describe a phylogenetic approach to scaffold ancient bacterial contigs that adapts existing methods initially designed to predict ancestral genome features from the comparison of extant genomes. The design of predictive methods to reconstruct ancestral genomic features is a relatively ancient field of computational genomics, dating back to methods such as Fitch's algorithm for reconstructing ancestral genomic sequences (). Advances in computational paleogenomics include improved methods for reconstructing ancestral genome sequence (), gene content () and gene order. The latter ones have been used for reconstructing ancestral genomes organization of bacteria (), animals (), plants (), yeasts () or protists (). Recent developments provide exact and fast algorithms that handle repeats as well as diverse types of genome rearrangements and chromosome structures (). We describe here how to adapt and integrate some of these methods to process ancient bacterial contigs. We apply our method to the Black Death agent genome, using the genomes of eleven closely related descendants and outgroups from the Y.pestis and Yersinia pseudotuberculosis clades, whose phylogeny is given in: we correct, order and orient the ancient contigs of the of the medieval Black Death agent chromosome into a single scaffold and estimate the inter-contigs DNA sequences, and we describe a preliminary analysis of this reconstructed ancestral genome.
METHODS AND ALGORITHMSWe are given a set of contig sequences for an ancestral genome A, together with a set of related extant sequenced genomes, descendants and outgroups of A, organized into a phylogenetic tree T. Our scaffolding method FPSAC relates to a generic scheme for reconstructing ancestral genome organization (), and is composed of four phases:(1) Computing homologous families. A homologous family is composed of at least one contig segment (ancestral marker) and several non-overlapping extant genomes segments (extant markers), that pairwise align, with high similarity, along their whole length. Each homologous family is assigned a multiplicity bounding the number of occurrences (copy number) of ancestral marker(s) from this family in the ancestral genome A.(2) Computing putative ancestral adjacencies. An ancestral adjacency is composed of two ancestral markers that are believed to have been contiguous in A. We predict them using a Dollo parsimony principle that takes advantage of the internal position of A in the considered phylogenetic tree. All adjacencies are weighted according to their phylogenetic conservation, defining a weighted adjacency graph.(3) Scaffolding from ancestral adjacencies. If the set of all ancestral adjacencies is not compatible with a multichromsomal circular chromosomal structure that respects the multiplicity constraints of homologous families, we compute a maximum weight subset of adjacencies that is compatible with such a circular chromosomal structure. Next, as adjacencies alone can define several contig orders, due to repeated ancestral markers forming tangles in the adjacency graph, conserved intervals spanning repeats are used to clear the ambiguities, in a way similar to the use of mate-pairs to scaffold extant genomes.(4) Estimating inter-markers gap lengths and sequences. For each ancestral adjacency, the length of the ancestral gap between the two involved markers is estimated from the length of the gap between the corresponding extant adjacencies (extant gaps). The sequences of the extant gaps whose length agrees with the estimated ancestral gap length are aligned into a multiple sequence alignment that is used to reconstruct a putative ancestral gap sequence.
Computing homologous markers familiesWe map the ancient contigs onto the extant genomes. Every significant hit (defined here by a length of at least 100 nt with 95% of identity) indicates two homologous sequences, one located on a contig and one located on an extant genome. Owing to rearrangements and repeats, some contigs do not align over their whole length to every extant genome, indicating potential evolutionary breakpoints. To detect families of homologous segments, we apply an iterative segmentation procedure, which produces contig and extant genome segments such that (1) contig segments align over their whole length to extant genomes segments and (2) pairs of extant genome segments do not overlap (i.e. either they have the same coordinates, or they are completely disjoint). From a set of pairwise contigs/genomes alignments, we cut the contigs and the corresponding extant genome segments if either (1) or (2) is not satisfied. Assume first that (1) is violated: there is a segment a, b from a contig of length ' that aligns to an extant genome, with a41 or b5' or both. We assume that a41; the other case is treated symmetrically. The contig is cut into two segments, with coordinates 1, a  1 and a, ' and the corresponding genome segments are cut accordingly. All others alignments of segments from this contig overlapping coordinate a are also cut into two subsegments at this position in the same way as previously mentioned. We iteratively apply this procedure until (1) is verified for all pairwise alignments, thus defining a new set of pairwise contigs/genomes alignments. Next, assume that (2) is violated: two different contigs have segments aligning to two overlapping regions of an extant genome, say a, c and b, d, with a5b5c5d. In this case, the two contigs are cut into two segments so that the four resulting segments align to genome segments with coordinates a, b, b, c (for two of them) and c, d (see). After iteratively applying this procedure until (2) is satisfied, it is possible that (1) is violated again. To make the procedure converge, we remove short alignments (below the length threshold used to define significant hits) and repeat the two procedures until (1) and (2) are both satisfied. Then all aligned sequences naturally cluster into sets of highly similar ancient and extant sequences forming homologous families.
Multiplicity of homologous familiesNext, we assign to each homologous family a multiplicity that is the expected number of occurrences of the ancestral marker of the family in the ancestral genome. The multiplicity of a family is computed from the number of occurrences of the extant markers in the extant genomes (the family profile) to minimize the number of evolutionary gain/loss along the branches of the considered phylogenetic tree. It is computed by a linear time dynamic programming algorithm
Computing ancestral adjacenciesTo account for the orientation of markers in predicted ancestral syntenic features (adjacencies and intervals), we decompose each marker (ancestral or extant) into two marker extremities, its head and its tail, a standard approach in genome rearrangement studies (). Adjacencies are then defined in terms of marker extremities instead of markers, and are computed following a Dollo parsimony principle described in Chauve and Tannier (2008): two ancestral marker extremities form an ancestral adjacency if they are contiguous (no other marker is between them in the chromosome) in at least two extant genomes whose evolutionary path in T contains A. Adjacencies are weighted according to their patterns of phylogenetic conservation as described in[see also Chauve and. The weighted adjacency graph is defined as follows: its vertices are the markers extremities and its edges are the weighted adjacencies.
Computing ancestral scaffoldsAn ancestral scaffold is a linear or circular order of ancestral markers. The set of ancestral adjacencies might not translate into an unambiguous set of ancestral scaffolds for two reasons: (1) there might not exist a set of circular or linear markers orders that contain all adjacencies and respect the multiplicity of each marker, and (2) even if ancestral adjacencies can be organized in ancestral scaffolds, several sets of scaffolds can exist because of marker multiplicities (). To address point (1), we compute a maximum weight subset of ancestral adjacencies such that every marker extremity belongs to a number of adjacencies that is at most the multiplicity of the marker family (): for an ancestral marker of multiplicity m, each of its extremities can belong to at most m ancestral adjacencies. Such a selected subset of ancestral adjacencies, that is computed in polynomial time, is compatible with an order of the markers into a set of linear and/or circular scaffolds which respects the copy number constraint given by the ancestral marker multiplicities. It is important to note that, although bacterial genomes can be composed of several circular molecules (chromosomes and plasmids), the algorithm we use does not control the resulting chromosomal structure (in terms of the number of scaffolds and of their linearity/circularity). The problem of computing a maximum weight subset of adjacencies that can be realized into a constrained chromosomal structure is NP-hard, as it includes the Maximum Weight Path Cover Problem ().do not belong to a repeat spanning interval are discarded, resulting in a more fragmented, but unambiguous, set of scaffolds.
Estimating inter-contig gaps lengths and sequencesAn ancestral gap in an ancestral scaffold is the sequence located between two consecutive ancestral markers (say X and Y). For each ancestral gap, we consider the extant genomes in which occurrences of X and Y are consecutive (no extant marker is between them) and in the same respective orientations as in the ancestor, thus defining an extant gap X  Y. We define a conserved extant gap as an extant gap whose length is equal in two extant genomes whose evolutionary path in T contains A, following a Dollo criterion. The lengths of conserved extant gaps X  Y define a length interval for the ancetsral gap X  Y. If there is no conserved extant gap, the ancestral gap length interval is defined by the minimum and maximum extant gap lengths between X and Y. We align all sequences of extant gaps between markers X and Y whose length is in this interval into a multiple sequence alignment. A parsimonious estimation of each ancestral gap sequence is computed from the corresponding alignment of extant gap sequences using the classical Fitch algorithm ().
RESULTSWe describe here the result of our method FPSAC applied to the dataset described in, followed by a preliminary analysis of the resulting scaffolded chromosome.
DataThe input data are the 2134 larger assembled contigs (500 nt and above) described in, and the DNA sequences of the fully assembled chromosomes of four Y.pseudotuberculosis genomes and seven Y.pestis genomes, of which five are believed to descend from the Y.pestis strain that was involved in the Black Death pandemic ().
Contig segmentation and homologous familiesThe sequences of the 2134 contigs were mapped to the full genome sequences of the 11 selected extant genomes using Megablast () with default parameters. As already noted by, 29 contigs did not map on the Yersinia genomes, leaving 2105 ancestral contigs to analyze. The segmentation step resulted in 2616 homologous families. Almost all families have multiplicity 1, but 21 of them have multiplicity greater than 1, and among them, 20 have multiplicity 2 or 3, which indicates that most repeated parts of the genomes were not present in the larger contigs. We removed the last family, which corresponded to the 5S ribosomal protein family, because of its combined short length (133 nt) and high multiplicity (8). The amount of DNA encoded by the ancestral markers, when multiplicity is accounted for, is 3 846 616 nt of ancestral DNA, whereas the initial contigs encode 4 013 159 nt.
Comparative scaffoldingWe detected 2634 putative ancestral adjacencies. Only 6 adjacencies of these 2634 putative ancestral adjacencies needed to be discarded to obtain a maximum weight subset of adjacencies compatible with a set of linear/circular scaffolds. There were 29 conserved repeat spanning intervals, and 2 of them needed to be discarded to extract a maximum weight subset that defined an unambiguous set of three large linear scaffolds, in which all contigs are represented. There are six possibilities for joining these three scaffolds into one circular scaffold. Extant adjacencies between markers located at the scaffolds extremities were computed and defined an order and orientation for the three scaffolds: two adjacencies between scaffold extremities were supported by all outgroup species, whereas no adjacency between scaffold extremities was supported by ingroup species, and the last adjacency was supported by one outgroup (Y.pestis Microtus) and involved a marker absent from all Y.pseudotuberculosis genomes.Here is a toy example where we have markers 1,. .. , 7, drawn with bold segments, and adjacencies between their extremities, drawn with thin lines. Assume every marker has multiplicity 1 except marker 2, which has multiplicity 2. Then every marker extremity has as many adjacencies as its multiplicity predicts. But there are two possible circular orderings of these markers according to these adjacencies: 1,2,3,4,5,2,6,7, or 1,2,5,4,3,2,6,7. Suppose we have in addition repeat spanning intervals 1.2.3 and 5.2.6, then only the first ordering is compatible with them
Gap lengths and sequences
Assessing accuracy with simulationsTo assess the validity and accuracy of FPSAC, we simulated 50 datasets as follows (full details of the simulation and results are given in Supplementary Material). First, for each dataset, one of the current extant genomes was randomly chosen as the ancestral genome and it was allowed to evolve along the Yersinia phylogeny by performing up to X random inversions along each branch, with X 2 f10, 20, 30, 40, 50g; note these numbers are all greater than the estimated rearrangement numbers for the real data, thus resulting in 11 simulated extant genomes expected to be more scrambled than the real data. Next, 2134 contigs were selected along the genome following the length distribution of the real contigs, and 10 pairs were used to create chimeric contigs. Finally, the FPSAC pipeline was applied on the resulting 50 dataset (ancient contigs and extant genomes) with the same parameters than on the real Yersinia data. We obtained on average 2808.42 families, 130.64 having a multiplicity 41. The scaffolding resulted into a single scaffold except in five cases (average number of scaffolds of 1.18); there were few adjacencies (two in total over the fifty data sets) and repeat spanning intervals (three in total) that needed to be discarded. To assess the accuracy of the contig order implied by the scaffolds, we looked at occurrences of the non-chimeric contigs in the reconstructed sequence (including the reconstructed gaps) and at the length of the gaps between these occurrences. We found that 99.47% of the initial contigs appear in the reconstructed sequence with at least 95% of identity over 95% of their length, and that 98.66% of the gaps between consecutive contigs were reconstructed with the exact length in the reconstructed sequence. Regarding chimeric contigs, 99.14% of them were detected as chimeric. These high accuracy numbers are consistent with previous simulations on the reconstruction of ancestral gene orders from randomly rearranged extant genomes (), although here we can also observe a high accuracy in the reconstructed gap lengths, which was not considered in previous simulations.
Analysis of the reconstructed ancestorThe pipeline described previously resulted in an ancestral genome sequence of length 4.6 Mb showing that roughly 775 kb were added to the ancestral marker sequences by the gap sequences estimation step. In the resulting scaffold, each occurrence of an ancestral marker corresponds to one or several segments of the initial contigs. The ordering of these segments is mostly compatible with the initial contigs. We found only one chimeric contig (see), split into two non-adjacent markers in the ancestral genome organization. Also four contig segments were found to be duplicated: a large part (4500 nt) of each is probably present in more than one occurrence in the ancestral genome, whereas the initial assembly predicted only one occurrence. Finally, 63 contigs have a sequence that is found, up to small variations, inside another contig, whereas their number of extant occurrences suggest they have multiplicity 1, so we believe they are redundant. An alternative explanation is that they are derived mutations of the ancient genome, which, in such a case, would not be ancestral to current strains. Regarding the six discarded adjacencies, two of them point toward a possible large-scale inversion. Both, the selected adjacencies and intervals, as well as the discarded ones, have similar phylogenetic support. So this alternative structure cannot be ruled out as non-ancestral, which raises the question of the possible coexistence of different genome architectures among the Y.pestis infecting the host individual whose remains were used for sequencing. We also took advantage of the availability of a full chromosome sequence for the main chromosome of the Black Death agent to analyze its structure and evolution at the wholegenome scale. We first analyzed insertion sequence (IS) elements that have been suspected to be involved into the high rearrangement rate of Y.pestis genomes (). We mapped extant IS to the reconstructed ancestral chromosome (see Supplementary Material). This resulted in 92 ancestral gaps and markers containing IS. We confirmed this comparative annotation with an automatic annotation of the reconstructed chromosome sequence. We could also observe that a large proportion of these IS (at least 58) were already present in the last common ancestor of all Y.pestis strains, whereas they are almost completely absent from the genomes of the considered Y.pseudotuberculosis, thus providing more evidence that the Y.pestis speciation from its Y.pseudotuberculosis ancestor was characterized by a burst of IS insertion ().We also analyzed the genome rearrangements between the reconstructed ancestral sequence and the extant genome sequences by sampling inversion scenarios between the ancestral genome and the extant genomes using the software DCJ2HP (MiklosMiklos and). There are 89 inversions between the Y.pseudotuberculosis strains and the medieval genome, and 922 inversions when compared with the (evolutionarily closer) Y.pestis strains, showing a clear acceleration of evolutionary rearrangement following the Black Death Y.pestis divergence (see Supplementary Material). As noticed by, we can also observe that inversion breakpoints are not randomly distributed and used (): highly used ones are concentrated in one-third of the chromosome, around its probable replication origin. The positions of the inversion breakpoints are also highly correlated with IS, as remarked earlier (): 76 of the 118 mapped breakpoints are close (51000 nt distant) to some predicted IS, whereas this number drops to 39 for uniformly sampled random coordinates (P-value 510 3 ). Rearrangements are numerous in all Y.pestis branches, strongly suggesting that they could be driven by the IS.
DISCUSSION
Contig segmentation and marker multiplicitiesAligning contigs to extant genomes and using these alignments to segment contigs might at first seem counterintuitive, as it increases the fragmentation of the initial assembly. However, it allows us to take advantage of the available fully assembled extant genomes to identify potential chimeric contigs and to extract potential repeated sequences from the contigs, which would have been collapsed into a single contig, a welldocumented issue with assembling from short reads (). Our approach follows a recent suggestion byto rely on shorter contigs of higher quality (here in terms of mapping to related genomes). This phase benefited from the high sequence conservation in the Y.pestis clade that allowed us to rely on high similarity pairwise alignments as input of the segmentation phase. Less conserved data would likely require more involved methods to compute a segmentation into non-overlapping homologous families (). Finally, the possibility to infer the multiplicity of contig segments from the alignment on extant genomes, using comparative genomics methods designed to study the evolution of gene families, offers an elegant alternative, specific to aDNA assembly, however, to current copy number estimation methods that rely on the depth of coverage, which can be uneven when sequencing highly fragmented aDNA.
Estimating ancestral gap sequencesThe key idea is that conserved adjacencies are also likely to define conserved gaps. In the data processed, we can observe that for most ancestral gaps, a strict Dollo parsimony criterion identifies conserved gaps. Moreover, again benefiting from the high sequence conservation of the Y.pestis genomes, we could estimate most of the ancestral gap sequences from the multiple alignments of the corresponding extant gaps using a standard ancestral character reconstruction method. If greater sequence variation was observed, more powerful methods designed to infer ancestral DNA from a multiple alignment would be appropriate (). In a future work, we aim to use the reconstructed gap sequences as a template to exactly assemble these gaps from the sequenced reads. However, optimally mapping aDNA reads onto extant DNA requires specific protocols that have recently been developed for eukaryotic aDNA, but still needs to be established for bacterial aDNA ().
Scaffolding and comparative genomicsThe FPSAC method follows principles similar to most existing scaffolding methods designed for extant genomes. It relies on extracting a genome structure from a graph (the adjacency graph), whose vertices are sequence elements and edges indicate connectivity between pairs of vertices. In most scaffolding algorithms, edges of this graph are defined by mate-pair reads, whereas we rely on adjacencies and intervals that are conserved under a Dollo parsimony criterion. The main difference we can observe is the low number of tangles in the graph we obtained compared with the usual large number observed in graphs based on matepairs, in part because of the absence of repeated sequences in the analyzed contigs. It is interesting to observe that, despite the fact that Y.pestis genomes are highly rearranged, FPSAC was able to capture a clear signal regarding the organization of markers along the ancestral chromosome. Also important is the use of recently developed polynomial time exact algorithms to extract a consistent set of adjacencies while accounting for the multiplicity of repeated segments () and to assess the compatibility of repeat spanning intervals with a given adjacency graph ().
Applicability to other datasetsWe applied FPSAC to a dataset with specific characteristics. The assembled ancestral contigs were obtained using a libraryenrichment approach and are assumed to belong to the genome of an internal node of a phylogeny, whose leaves are sequenced and assembled. Moreover, the clade of interest contains high sequence conservation and highly rearranged genomes. We address the impact of these different points below and discuss the applicability of FPSAC to a wider range of datasets. In the case where descendants of the ancient genome of interest are not available, either due to lineage extinction or because they have not been sequenced, other comparative methods can be used, that do not rely on a Dollo parsimony principle. Contig correction: (a) the contig is cut during the segmentation procedure, but not joined during the marker ordering; (b) the contig is found to have two occurrences in the marker ordering; (c) two contigs contain the same DNA sequence and this sequence is predicted to have only one occurrence in the marker ordering (). So the only important requirement to use FPSAC is the availability of the genome sequences of at least two related genomes whose evolutionary path contains the ancestor of interest. From there, the performances of the scaffolding obtained with FPSAC will depend both on the level of sequence conservation of both sequence identity and synteny in the considered related genomes. Diverged extant genomes might result in difficulty to obtain homologous families, which adequately span the initial set of ancient contigs, as well as computing their multiplicities. High rearrangement rates might result in wrong adjacencies because of convergent evolution. Useful indicators to assess the results obtained with FPSAC are thus both the coverage of contigs and extant genomes by ancestral markers and in the number of discarded adjacencies during the scaffolding phase. The method we describe can be applied as is even if some of the chosen closely related extant genomes are not fully assembled. The impact of unassembled extant genomes is likely to be more fragmented scaffolding than what we observed on the Black Death agent dataset because of undetected ancestral adjacencies or repeat spanning intervals. Finally, if the initial ancient contigs originate from a mixture of microbial backgrounds, for example if they result from de novo assembly of reads obtained through shotgun sequencing, then FPSAC can be used to assemble contigs subsets that have been identified, through comparison with extant genomes sequences, as belonging to well identified clades and satisfy the requirements described previously. However, even this initial step is currently a challenge, for example because of repeated sequences belonging, up to variations, to several genomes (). The problem of applying a method such as FPSAC to a whole set of contigs originating from a mixture of genomes, that is, for scaffolding an ancient metagenome, is an important research avenue.
CONCLUSIONTechnological sequencing advances can now provide sequences from whole ancient bacterial genomes, which promises to be an invaluable source of knowledge for understanding pathogen evolution. However, assembling ancient bacterial genomes poses specific issues, in particular because of high fragmentation in numerous contigs. In parallel, computational paleogenomics by comparative methods has grown tremendously, and computational methods can now provide ancestral genome sequences accounting for substitutions or small indels, ancestral gene content or ancestral genome organizations, at the level of full chromosomes, but, until now, were never combined to scaffold and estimate the sequence of an ancient bacterial chromosome. In the present work, we described a general method to combine both sequencing and computational reconstruction, and illustrated its potential on a real dataset.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
A.Rajaraman et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Relaxing the constraints on the chromosomal structure leads to a tractable problem (Manuch et al., 2012); moreover, if the resulting adjacencies can be realized into a set of linear segments, then this defines an optimal solution to the Maximum Weight Path Cover Problem, and so, an optimal set of scaffolds. To address point (2), we rely on conserved intervals that span markers with multiplicity41 (see Fig. 2 for an illustration of this principle). More precisely, we define a repeat cluster as a maximal connected subgraph of the adjacency graph induced by extremities of ancestral markers with multiplicity 41. A repeat spanning interval of R in a given genome G is a sequence of markers in G of the form a x 1. .. x k b such that the multiplicity of a and b is 1 and the x i 's all belong to the repeat cluster R. A repeat spanning interval is conserved if it appears, up to a complete reversal, in two genomes whose evolutionary path in T contains A. Identifying all conserved repeat spanning intervals can be done in time linear in the total size of all repeat clusters. Next, repeat spanning intervals are weighted using the same method as ancestral adjacencies, and for each repeat cluster R, we greedily select repeat spanning intervals that are both compatible with the adjacencies selected during the previous step, which contain markers of R, and satisfy the multiplicity constraints of the markers of R (Chauve et al., 2013). Provided all repeats are spanned by enough conserved intervals, this results into an unambiguous scaffolding that includes all ancestral markers, including repeated ones. Otherwise, this means that the evolutionary signal present in the considered extant genomes is not sufficient to resolve repeats in the ancestral genome, in which case, adjacencies composed of two repeats that Fig. 1. Illustration of the segmentation procedure to obtain homologous families of markers. For this example, we consider two contigs C1 and C2 and their alignments on two genomes G1 and G2. Part C of C1 and C2 aligns to the same positions in both genomes, including two different positions on G1. Parts A and B of C1 align at two different positions of G2. So the segmentation produces four families, with non-overlapping ancestral markers A, B, C and D. For these four segments, properties (1) and (2) are satisfied, whereas both were violated for C1 and C2. The family containing segment C contains two ancestral segments, two extant segments from G1 and one from G2. According to the number of occurrences in other genomes, this family may have a multiplicity 41.
Scaffolding of ancient contigs at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
