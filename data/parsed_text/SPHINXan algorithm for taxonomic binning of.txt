Motivation: Compared with composition-based binning algorithms, the binning accuracy and specificity of alignment-based binning algorithms is significantly higher. However, being alignment-based, the latter class of algorithms require enormous amount of time and computing resources for binning huge metagenomic datasets. The motivation was to develop a binning approach that can analyze metagenomic datasets as rapidly as composition-based approaches, but nevertheless has the accuracy and specificity of alignment-based algorithms. This article describes a hybrid binning approach (SPHINX) that achieves high binning efficiency by utilizing the principles of both 'composition'-and 'alignment'-based binning algorithms. Results: Validation results with simulated sequence datasets indicate that SPHINX is able to analyze metagenomic sequences as rapidly as composition-based algorithms. Furthermore, the binning efficiency (in terms of accuracy and specificity of assignments) of SPHINX is observed to be comparable with results obtained using alignment-based algorithms. Availability: A web server for the SPHINX algorithm is available at
INTRODUCTIONThe enormous microbial diversity prevalent in natural ecosystems represents a rich resource for discovery of hitherto unknown microbes and the novel genes/proteins they encompass. Estimates reveal that 99% of these microbes cannot be easily cultured in the laboratory (). The rapidly growing field of metagenomics directly investigates this microbial diversity by obtaining and sequencing the entire genomic content present in any given environmental sample (). Since majority of these organisms in environmental samples belong to hitherto unknown taxonomic groups, one of the biggest challenges for computational biologists is not only just to catalog the known organisms, but also to identify * To whom correspondence should be addressed. and characterize new organisms belonging to known or unknown taxonomic groups. These organisms could belong to an entirely new species or genus or family or order or class or even a new phylum. Researchers typically catalog taxonomic diversity (a process referred to as 'binning') by using computational methods that identify the taxonomic affiliation of all the sequences obtained from a given environmental sample. Sequences sharing the same taxonomic label are subsequently grouped (binned) together. Accurate binning of metagenomic sequences is a crucial step in any metagenomics project since wrongly binned sequences will affect/hinder in the downstream analysis of many subsequent steps, such as sequence assembly, gene prediction and functional annotation, etc. Existing binning algorithms assign a sequence to a particular taxon/clade if 'features' of the sequence are 'similar' to sequence(s) belonging to that taxon/clade. The extent to which these 'features' are 'similar' determines not only the accuracy, but also the specificity of assignment (the taxonomic level at which the sequence is assigned). Besides, binning methods are challenged by sequences generated by current sequencing technologies, such as 454 () and Illumina. The short lengths of sequences (35100 bp) produced using these sequencing technologies make it difficult to identify 'features' which are similar between sequences from closely related organisms and are distinct from those from distant organisms. One class of 'features' used by binning algorithms is based on the similarity of the 'compositional' characteristics of the query and the target sequences. A few examples of 'compositionbased' binning algorithms published in recent years include Phylopythia (), TACOA () and PhymmBL (). Phylopythia () utilizes support vector machines and uses oligonucleotide frequencies as training features to initially build organism/clade-specific classifiers. These classifiers are subsequently used for assigning a query sequence to an organism/clade whose genome(s) is/are most similar to the query (with respect to oligonucleotide usage). However, SVM-based classifiers used by Phylopythia are not robust enough to predict the taxonomic labels of 'short' query sequences having lengths <1000 bp. As a result, in addition to most of the 'short' sequences remaining unclassified, this method has a high misclassification rate. Another composition-based binning algorithm, namely TACOA, also uses oligonucleotide frequencies as features for building organism-specific models (). Based on the GC content of a genome, TACOA builds a genome model, represented in the form of a vector. The elements of these vectors contain the ratio
SPHINXof observed and the expected frequencies of all possible nucleotide oligomers (of kmer sizes 4 and 5). TACOA employs a modified k-nearest neighbor (k-NN) approach during the prediction phase, wherein the vector corresponding to the query sequence is scored not only against the neighboring vectors of the highest scoring model, but also against the complete set of (precomputed) genome models. The final assignment of a query sequence to a taxa/clade is based on the pattern of the obtained scores. Although TACOA outperforms Phylopythia, majority of the 'short' query sequences are assigned at non-specific taxonomic levels such as super-kingdom by this method (). Thus, this method has limited utility since it prevents end-users from assessing the taxonomic diversity of samples at finer taxonomic levels. For example, sequences from two samples may be very similar at a higher taxonomic level, e.g. phylum, but may have sequences belonging to two entirely different classes within that phylum. The recently published Phymm binning algorithm () computes variable length oligonucleotide frequencies and generates interpolated Markov models (IMMs) for each genome. Subsequently, it scores a given query sequence against all precomputed organism-specific models, and assigns the query to an organism that corresponds to the highest scoring model. Phymm assigns all query sequences at the taxonomic level of strain, irrespective of the value of the obtained (highest) score. The end-users then need to interpret the score and appropriately reduce individual query assignments to corresponding higher taxonomic levels. However, the absence of a linear correlation between the score and the correct taxonomic level of the predicted assignment makes this task difficult. In principle, reducing the taxonomic level of all predicted assignments to higher taxonomic levels (such as phylum or super-kingdom) would result in high accuracy. However, the utility of assignments at such non-specific taxonomic levels is limited. The other class of binning algorithms uses 'sequence similarity' as a 'feature' to assign a query sequence to an organism/clade (). These algorithms, referred to as 'alignmentbased' binning algorithms, follow a two-phase approach. In the first phase, an alignment algorithm such as BLAST (), is used for comparing each query sequence in a given metagenomic sample with all target sequences present in a reference database. Subsequently, in the second phase, the pattern and quality of the generated BLAST hits are analyzed, and information from this analysis is utilized for finally assigning each query sequence to an organism/clade. Given the robustness of the existing alignment algorithms (BLAST), alignment-based binning algorithms are observed to have greater binning accuracy and specificity as compared with existing composition-based methods. However, the first phase of alignment-based binning algorithms represents a major bottleneck since enormous amount of time and computing resources are needed for generating alignments of each of the sequences in a given metagenome with sequences present in the existing reference database, such as nr (presently containing more than 9 million sequences). Thus, one of the challenges is to develop binning approaches whose performance efficiency in terms of taxonomic assignments is not only comparable with that of alignment-based approaches, but also have improved efficiency in terms of computational time required for taxonomic assignment. In this article, we present SPHINX, a hybrid binning approach that aims at reducing the overall time taken by alignment-based binning approaches by approximately an order of magnitude. The approach is termed as 'hybrid' since it utilizes both 'compositional' and 'similarity' features of the query sequence during the binning process. Binning of sequences by SPHINX involves three steps. In the first step, 'compositional' features of the query sequence are utilized to identify a small subset of sequences (in the reference database), which are similar in composition to the query sequence. The second step uses BLAST to perform a 'similarity' search of the query sequence against this small subset of database sequences. In the final step, the output of these BLAST searches is analyzed, and the query is assigned to a taxon/clade with which 'significant' hits were obtained.
METHODS
Clustering reference database sequencesClustering sequences present in the reference database based on the compositional characteristics is the only preprocessing step in SPHINX. For this purpose, ffn files (which contain only protein-coding gene sequences) corresponding to 952 completely sequenced prokaryotic genomes were downloaded from NCBI (ftp://ftp.ncbi.nih.gov/genomes/Bacteria/). Frequencies of all possible tetra-nucleotides in each coding sequence were computed and stored as a 256-dimensional vector. Tetra-nucleotides were used since previous observations had demonstrated that tetra-nucleotide frequencies carry an inherent taxonomic signal (). Using k-means clustering approach (), more than 1.9 million vectors corresponding to the coding sequences were clustered. The Manhattan distance (L 1 norm) between individual vectors was used as the similarity criterion for clustering. Once the clustering process was completed, individual cluster centroids were computed and stored. Subsequently, coding sequences tagged to each cluster were translated into protein sequences (using the appropriate genetic code). These translated sequences resulting from each cluster were stored as separate databases. A schematic workflow depicting the preprocessing steps (described above) is given in Supplementary.
Steps for taxonomic assignmentThe following three steps were followed by SPHINX for identifying the taxon/clade to which a query sequence belongs. A schematic workflow depicting these three steps is given in Supplementary.
Step areduction of search spaceA vector representing the frequencies of all 256 tetra-nucleotides in the query sequence was generated. The distance of this query vector to each 'cluster centroid' was computed and the cluster having the least distance to the query vector was identified.
Step bidentification of similar sequence from the reduced spaceA BLASTx search of the query sequence was performed against all translated sequences present in the identified cluster.
Step ctaxonomic assignment of sequencesAlignment parameters (bit-score, alignment length, identities and positives), organism name and the alignment subsequences from each hit were parsed from the BLASTx output obtained in Step b. Using an approach similar to SOrt-ITEMS (), each query sequence was finally assigned to a taxon/clade based on the quality of alignment and the degree of orthology observed between the query and the hit sequences.
Validation of the SPHINX approach on simulated metagenomic datasetsThe performance of binning methods is usually validated using a 'leave one (species) out' strategy, wherein sequences belonging to only a single speciesPage: 24 2230
M.H.Mohammed et al.are removed from the reference database. Subsequently, test sequences derived from the removed species are queried against this modified database. This strategy is intended to simulate a scenario of only one 'unknown' (new) species being present in the metagenomic sample. However, in this study, a 'leave one clade out' strategy was adopted, wherein sequences belonging to an entire clade (genus, family, order, class and phylum) were removed from the reference database. Subsequently, test sequences originating from genomes belonging to the removed clades were queried against this modified database. This strategy was adopted to closely mimic sequences derived from a real metagenomic scenario, wherein majority of sequences belong to entirely hitherto unknown (new) clades at various taxonomic levels.
Generation of a simulated reference databaseFor creating a simulated database scenario, coding sequences corresponding to 300 randomly selected genomes (out of 952) were removed before creating clusters for the reference database. Tracing the taxonomic lineage of these 300 genomes revealed the complete removal of certain clades (species, genera, families, orders, classes and phyla) from the reference database. Supplementarylists the 300 genomes that were not considered while clustering the reference database.
Test datasets used for validation Validationof the SPHINX approach was performed using 1 40 000 test sequences of varying lengths. These test sequences were generated using MetaSim (). Supplementarylists the genomes from which these test sequences were derived. To mimic a typical metagenomic scenario, 1 32 000 (94.2%) of these test sequences were derived from genomes belonging to those clades that were removed while creating the reference database. Based on the lengths of the read sequences, these test sequences were divided into four validation datasets, termed as Sanger dataset, 454-400 dataset, 454-250 dataset, 454-100 dataset, each containing 35 000 sequences. Test sequences constituting these four datasets simulated the typical sequence lengths and errors models obtained from the four commonly used sequencing technologies, namely, Sanger (read length centered around 800 bp), 454-GSFLX-Titanium (400 bp), 454-GS-FLX-Standard (250 bp) and Roche-454GS20 (100 bp), respectively. Taxonomic assignments of sequences in all four datasets were carried out following the steps described in Section 2.2.
Categorization of taxonomic assignmentsTaxonomic assignments obtained with SPHINX were categorized as 'correct/incorrect' using the following approach. Taxonomic assignment of query sequences to either the taxa corresponding to their source organism, or to taxa that lie in the path between the root to the taxa corresponding to the source organism of the query sequence were categorized as 'correct'. Assignments of sequences to taxa that did not lie in the path from the root to the taxon corresponding to the respective source organism of the query sequence were categorized as 'wrong'. For example, query sequences from Burkholderia ambifaria AMMD, which were not assigned to any of the taxa mentioned below were categorized as 'wrong': root; cellular organisms; Bacteria; Proteobacteria; Betaproteobacteria; Burkholderiales; Burkholderiaceae; Burkholderia; Burkholderia cepacia complex; Burkholderia ambifaria; Burkholderia ambifaria AMMD. To evaluate the performance of SPHINX in terms of specificity of assignments, the percentage of query sequences 'correctly' assigned at the taxonomic levels of phylum or below were considered as 'specific' assignments. A binning algorithm with high specificity is expected to assign more number of sequences at 'specific' levels.
Comparison with other methodsThe results obtained with SPHINX were compared with those obtained with two alignment-based methods, namely SOrt-ITEMS () and MEGAN (). Results were also compared with those obtained with a compositionbased method, namely TACOA (). All three programs were run with default parameters. In order to accurately compare the effect of database clustering on binning time and binning efficiency, results of SOrt-ITEMS and MEGAN were obtained by performing similarity searches against the same (translated) ffn database (used for validating SPHINX), but in an unclustered format. Similarly, taxonomic assignments were obtained with TACOA using a modified database containing only those genomes that were present in the databases used by SPHINX, SOrt-ITEMS and MEGAN during their validation process. For various assignment categories, the overlap between the sequence assignments by SPHINX, SOrt-ITEMS, MEGAN and TACOA were analyzed.
Validation of the SPHINX approach on a real metagenomic datasetThe performance of SPHINX was validated on sequences belonging to the hyper-saline saltern metagenome (). This relatively small metagenomic dataset (with only 35 446 sequences) was chosen since it enabled a quick comparison of taxonomic assignment patterns obtained using various binning methods. Results obtained with this dataset, would also indicate the suitability of SPHINX for use with much bigger metagenomic datasets. Taxonomic assignments for the 35 446 sequences constituting this dataset were first obtained using SPHINX. A database (in clustered format) consisting of coding sequences belonging to completely sequenced prokaryotic genomes was used during the binning process. Taxonomic assignments of all sequences were also obtained using SOrt-ITEMS and MEGAN. Assignments obtained by all three methods were then compared at the level of phylum, class and order. For this purpose, assignments obtained at or below the desired taxonomic level of comparison were first collapsed to that level and subsequently enumerated.
Testing of the SPHINX approach on mouse gut metagenomic sequencesThe performance of SPHINX was tested on the metagenome datasets corresponding to the gut from lean and obese mice, which were previously analyzed by. In contrast to the hyper-saline saltern metagenome, the two datasets of the mouse gut metagenome represented a typical metagenomic dataset in terms of sheer volume and taxonomic complexity. Analysis of such a huge and complex dataset would help in evaluating the performance of SPHINX in a real-world data scale-up scenario. The two datasets (hereafter referred to as lean and obese dataset), consisting of 10 57 022 and 6 87 244 sequences from the lean and the obese mouse gut, respectively, were analyzed using SPHINX. Taxonomic assignments by SPHINX for both datasets were compared at the level of phylum, class, order and family in the following manner. All assignments obtained at or below the desired taxonomic level of comparison were first collapsed to that level and subsequently enumerated. For each desired taxonomic level, a 22 contingency matrix (for that taxon) was then generated using the approach described by. The cumulative number of assignments obtained for that taxa in both datasets and the total number of assignments at or below that taxonomic level in both datasets were used for generating the matrix. A chi-square test was subsequently performed on this contingency matrix. Based on the results of the test, taxa (having more than 1000 assigned sequences) showing a statistically significant difference were identified.
Assessing
SPHINXimpact/contribution of non-coding regions on binning efficiency of SPHINX, a simulated database was created in the following manner. All completely sequenced genomes from NCBI were downloaded, and each genome was dissected into 1 kb fragments. Using the same steps described in Section 2.1, these fragments were clustered using k-means approach, followed by computation of cluster centroids and finally storing of translated sequences belonging to each cluster into separate databases. For the purpose of comparing the results of this approach with other methods, sequence fragments obtained from the same 300 randomly selected genomes were not considered while clustering and subsequently creating the database. The performance of SPHINX was evaluated with this simulated database variant.
RESULTSThe summarized binning results obtained with SPHINX, SOrtITEMS, MEGAN and TACOA (for all four validation datasets) are given in Supplementary Table 3. A graphical representation of these results is illustrated in. As mentioned previously, these results were generated using the ffn database in clustered (SPHINX) and unclustered formats (SOrt-ITEMS, MEGAN and TACOA). The results of SPHINX, SOrt-ITEMS and MEGAN obtained with ffn database are referred to as results with 'SPHINX-FFN', 'SOrt-ITEMS-FFN' and 'MEGAN-FFN', respectively. Results of SPHINX obtained using a reference database containing both coding and non-coding regions are referred to as results with 'SPHINX-FNA'.
Impact of database clustering on binning time and binning efficiencySupplementaryshows a comparison of results obtained with SPHINX, SOrt-ITEMS, MEGAN and TACOA. These results are discussed below.
Correct assignmentsAs expected, the percentage of correct assignments (by all four methods) shows a progressive increase as the length of the query sequence increases from 100 to 800 bp (). The percentage of correct assignments by SPHINX-FFN is slightly less (by 210%) as compared with SOrt-ITEMS-FFN for all the datasets. This indicates that the 'reduced search-space' (database clustering) strategy used by SPHINX does not have a significant impact on binning accuracy. At the same time, this reduced search space strategy of SPHINX helps in achieving a 15-to 20-fold reduction in the overall time taken for binning (). Furthermore, it is also observed that the number of sequences correctly classified by SPHINX-FFN is 1.21.9 times higher as compared with that by MEGAN-FFN. This is expected, since MEGAN uses only a single alignment parameter (bit-score) to judge the quality of hits in BLASTx outputs and subsequently assigns sequences using the least common ancestor (LCA) approach. Adopting this approach was earlier shown to be associated with a high misclassification rate, especially in a metagenomic scenario, wherein majority of sequences originate from hitherto unknown organisms/taxonomic clades (). Though the percentage of correct assignments by SPHINX-FFN is seen to be comparable with a composition-based binning method like TACOA, it is observed that a majority of the correct assignments (8590%) by TACOA are at the level of super-kingdom. The assignments made at such non-specific levels have limited utility.
Specific assignments Asin the case of correct assignments, the percentage of correct assignments at specific levels (i.e. assignments at the taxonomic level of phylum or below) increases with increasing length of the query sequences (). It is seen that SPHINX-FFN, SOrt-ITEMS-FFN and MEGAN-FFN assign 7680% of the correct assignments at specific levels, indicating that the reduced space strategy does not significantly affect the binning specificity. The only exception to this pattern is observed in the 454-100 dataset, where SPHINX-FFN is able to assign 64% of correctly assigned sequences at specific levels. On the other hand, it is observed that <14% of query sequences are assigned by TACOA at specific taxonomic levels. This demonstrates (and confirms) the high binning specificity of alignment-based binning approaches.gives a breakup of specific assignments by all four methods at various taxonomic levels, namely, phylum, class, order, family, genus and below. These results indicate that, in most datasets, SPHINX assigns a relatively higher percentage of sequences at phylum level as compared with that by SOrtITEMS, MEGAN and TACOA. No clear pattern can be established between the results of SPHINX, MEGAN and TACOA at the class level. However, it is observed that SPHINX assigns a relatively lower percentage of sequences at class level compared with SOrtITEMS. Though it is observed that SPHINX and SOrt-ITEMS do not assign any sequences at order level, very few sequences (0.44%) are assigned by MEGAN and TACOA at this level. Furthermore, the percentage of sequences assigned by SPHINX at family level is consistently higher than that by MEGAN and TACOA at this level. Furthermore, the percentage of sequences assigned by SPHINX at family level is consistently higher than that by MEGAN and TACOA. However, the percentage of sequences assigned by SPHINX at this level is relatively lower (0.47%) than that by SOrtITEMS. At the taxonomic level of genus and below, it is seen that the percentage of assignments by SPHINX is comparable with that by SOrt-ITEMS and MEGAN. However, SPHINX assigns a significantly higher percentage of sequences at this level as compared with TACOA (in all four datasets). In addition to the above observations, the percentage of assignments by SPHINX at non-specific levels (above the level of phylum) is observed to be consistently lower than that by SOrtITEMS and MEGAN (in three out of four datasets) and TACOA (in all four datasets). This further indicates that the reduced search space approach of SPHINX does not impact the specificity of assignments.
Page: 26 2230
M.H.Mohammed et al.
Wrong assignmentsOnly 512% of query sequences are incorrectly assigned by SPHINX-FFN (). This is comparable with the percentage of sequences (410%) incorrectly assigned by SOrt-ITEMS-FFN. This further indicates that the reduced space strategy adopted by SPHINX does not significantly affect the accuracy of binning. In comparison, a much higher percentage of sequences are misclassified by TACOA (2231%) and MEGAN (2335%)., the percentage of query sequences categorized as unassigned increases with decreasing length of the query sequences. Though, the number of unassigned sequences is slightly higher for SPHINX-FFN as compared with SOrt-ITEMS-FFN and MEGAN-FFN in the cases of 454-250, 454-400 and Sanger datasets, it is interesting to note that in the case of 454-100 validation dataset, the number of sequences categorized as 'unassigned' by SPHINX-FFN is significantly lower than that of SOrt-ITEMS-FFN and MEGAN-FFN. The number of sequences categorized as unassigned by TACOA is significantly lower than other binning methods. However, as observed above, the assignments made by TACOA are of limited utility, since most of these assignments are at super-kingdom level.
Unassigned As seen from
Pattern of overlap between sequence assignments by all four binning methodsVenn diagrams depicting the overlap between the sequence assignments by SPHINX, SOrt-ITEMS, MEGAN and TACOA (for various assignment categories) are given in Supplementary. Except for the 454-100 dataset, the pattern of overlap for correctly assigned sequences indicates that assignments by SPHINX and MEGAN form a subset of the assignments by SOrt-ITEMS. For the 454-100 dataset, the correctly assigned sequences by SOrt-ITEMS and MEGAN form a subset of the correct assignments by SPHINX. Furthermore, the correct assignments by TACOA are seen to have a partial overlap with the correct assignments by other three methods. However, all the additional sequences correctly classified by TACOA (in comparison with the other three methods) are observed to be classified at nonspecific taxonomic levels. The overlap between the non-specific sequence assignments by all four methods also indicates that a high proportion of correct assignments by TACOA are classified at non-specific levels. For all datasets, a clear pattern of overlap is observed between the assignments at 'specific levels' by all four methods (Supplementary). SOrt-ITEMS is seen to have the highest set of specific assignments. The specific assignments of SPHINX, MEGAN and TACOA are seen to form progressively smaller subsets within the set of specific sequences of SOrt-ITEMS. In contrast, for the wrong assignments category, the set of sequences misclassified by SPHINX and SOrt-ITEMS are seen to form small subsets within the set of sequences misclassified by MEGAN and TACOA. The pattern of overlap seen for the set of unassigned sequences by all four methods (Supplementary) indicates the following. For the 454-100 dataset, the set of unassigned sequences by SPHINX and TACOA are seen to form a subset of the unassigned sequences by SOrt-ITEMS. In contrast, for the other three datasets, sequences categorized as 'unassigned' by SOrt-ITEMS, MEGAN and TACOA are observed to form progressively smaller subsets within the set of sequences categorized by SPHINX as 'unassigned'.
Impact of non-coding regions on binning efficiencyThe results obtained with both variants of SPHINX (FFN and the FNA variants) are graphically illustrated in. SupplementarySanger dataset. While assignment categories are given on the x-axis, the scale on the y-axis denotes the percentage of sequences assigned. (Database-variant FFN contains coding sequences from completely sequenced genomes. Database-variant FNA contains both coding and noncoding sequences from completely sequenced genomes). coding and non-coding regions), results in a noticeably higher percentage of correct assignments (54%) as compared with the SPHINX-FFN variant (37%). This is probably due to the fact that some of the assigned query sequences in the 454-100 dataset may have originated partially/entirely from non-coding regions. However, as the length of the query sequences increases, it is observed that the difference between the percentage of correct assignments by both variants of SPHINX becomes smaller. For both variants of SPHINX (except for the 454-100 dataset), it is observed that the percentage of specific assignments out of the correctly assigned sequences ranges between 69% and 80%. Furthermore, the difference between the percentage of wrong assignments by both variants of SPHINX ranges between 0.33% and 2.25%. This indicates that for datasets containing sequences having lengths 250 bp, the inclusion of the non-coding regions in the reference database does not significantly alter the accuracy and specificity of binning. It is also seen that the inclusion of the noncoding regions in the database increases the overall time taken for binning by three to four times (). The increase in time for FFN datasets is due to the added volume of the non-coding sequences in the database. Based on the above observations, it can be concluded that it is optimal to use the SPHINX-FNA variant only in cases of datasets containing short sequences. It is also important to note that the binning time of both variants of SPHINX increases linearly with increase in the size of the datasets (Supplementary).
Validation results of SPHINX for hyper-saline saltern metagenomic datasetA comparison of the total numbers and the cumulative percentage of sequences (in the hyper-saline saltern metagenomic dataset) assigned at phylum, class and order levels by SPHINX-FFN, SOrt-ITEMS-FFN and MEGAN-FFN is shown in. Results inindicate that SPHINX is able to assign 48.6% of the sequences in the hyper-saline saltern metagenomic dataset. This is roughly similar to the percentage of sequences assigned by SOrt-ITEMS-FFN (49.9%) and MEGAN-FFN (50.5%). For SPHINX, it is also observed that 15 773 (i.e. 91.6%) of the assigned sequences (17 227) are at taxonomic levels of phylum or below. A similar pattern is also seen for SOrt-ITEMS (93.8%) and MEGAN (89.7%). Furthermore, it is observed that a majority (98.399.64%) of assignments (by all three alignment-based methods) are to microbial species belonging to two orders, namely Halobacteriales and Sphingobacteriales. This observation is in conformance with earlier reports which indicated the over abundance of these two orders in hyper-saline environments (). Further, all three methods show a similar pattern of taxonomic assignments at all taxonomic levels (). These observations reaffirm that the 'reduced search-space' strategy used by SPHINX does not have a significant impact on binning accuracy and specificity. The binning efficiency of SPHINX is further highlighted by the fact that SPHINX takes only 88 min to analyze this dataset, as compared with >30 h taken by SOrt-ITEMS and MEGAN. For all the three methods, the execution time indicated above includes the time taken for the BLASTx comparisons.
Testing of SPHINX approach on mouse gut datasetsSupplementaryshows the summarized results obtained with SPHINX for the lean and obese mouse gut datasets. SPHINX is). Besides, in both datasets, an examination of the BLAST hits revealed that alignments obtained for approximately two-thirds of the assigned sequences were of poor quality. Consequently, these sequences were assigned by SPHINX at the taxonomic level of phylum. In contrast, only 0.2% of sequences generated BLAST hits with alignments having identity values of >90% and were subsequently assigned at the level of genus or below. These observations indicate that the majority of sequences in the mouse gut metagenome have originated from genomes of hitherto unknown organisms.provides a qualitative analysis of the cumulative assignments obtained at the taxonomic level of phylum. Qualitative analysis of cumulative assignments at other
M.H.Mohammed et al.
SPHINXsuch diverged genomes will generate BLAST hits having extremely weak alignment parameters, they are assigned by SPHINX either at higher taxonomic levels (phylum or above) or are categorized as unassigned. Similar to the pattern observed at the level of phylum, while a significantly higher proportion of sequences of the lean dataset are assigned by SPHINX to class Bacteroidia (belonging to phylum Bacteroidetes), the classes Clostridia and Bacilli are present in significantly higher proportion in the obese dataset. Many sequences from both the lean and obese datasets are assigned to classes Gammaproteobacteria, Deltaproteobacteria and Chlorobia. However, differences in the relative proportion of sequences assigned to the latter classes in both datasets are not statistically significant. Assignments at the levels of order and family also show assignment patterns similar to those seen at the level of class. The obese dataset is characterized by the conspicuous absence of many orders/families which are present in the lean dataset (SupplementaryD). It is to be noted that all inferences mentioned above were based on similarity searches against a clustered sequence database created using genomic fragments from 952 completely sequenced prokaryotic genomes (available in the NCBI database at the time of analysis). Though the overall pattern of taxonomic assignments confirm to those obtained in earlier studies (), these results are expected to improve as sequence information of more and more genomes becomes available.
DISCUSSIONCurrent alignment-based binning methods depend on exhaustive database searches. Performing such exhaustive database searches for millions of sequences (present in typical metagenomic samples) would take enormous amounts of time. This hinders research groups having modest computational resources from using similarity-based binning methods. The hybrid approachSPHINX presented in this article addresses this issue by adopting a 'reduced search-space' approach. Using this approach, SPHINX achieves a 15-to 20-fold reduction in the time taken for binning, compared with other binning approaches which depend on exhaustive database searches (). On a single desktop with modest specifications (Intel Xeon quad core, 4 GB RAM), SPHINX-FNA takes just about 88 h for binning 1.6 million sequences of the mouse gut metagenome. Binning the same set of sequences using SPHINX-FFN would have further reduced the time to an estimated 2024 h without significant loss in accuracy and specificity. In contrast, exhaustive search approaches (against the same database) would require an estimated 6 weeks for completing the same task. Furthermore, validation results of SPHINX obtained with simulated datasets indicate that the binning efficiency of SPHINX matches those obtained with alignment-based binning algorithms, which depend on the output of exhaustive database searches (e.g. SOrt-ITEMS). An examination of the results obtained for the same set of sequences with different variants of databases indicate highest binning efficiency (in terms of accuracy and specificity) with the SPHINX-FNA database variant since it contains fragments originating from both coding and non-coding regions (including fragments spanning both these regions) of completely sequenced genomes. However, results of SPHINX obtained with a databasevariant devoid of fragments spanning coding and non-coding regions (referred to as SPHINX-C-NC in Supplementary) indicate that using such a database variant results in an increase in taxonomic assignments at non-specific levels, as well as, an increase in the percentage of wrong assignments (as compared with the SPHINXFNA variant). These results show that the most optimal results are obtained using the SPHINX-FNA database variant. Since our observations with clustered and non-clustered variants of the FFN database indicate no significant loss in binning efficiency using a reduced search-space strategy, it will be beneficial to adopt the latter strategy even for the nr database (which is more comprehensive in terms of having sequences even from partially characterized genomes in addition to sequences from completely sequenced genomes). This will help in significantly reducing the overall time taken by alignment-based binning approaches. The quality of reference database clusters is an important factor that determines the binning specificity and accuracy of the SPHINX algorithm. Though this study adopted the k-means clustering approach, in principle, any other clustering method that can efficiently segregate DNA sequences (of varying oligonucleotide composition) in feature vector space can be applied to the current workflow of SPHINX. The k-means clustering approach adopted in the present study takes only about 4 h on a simple desktop to cluster approximately 1.9 million vectors corresponding to coding sequences of 952 prokaryotic genomes. This includes the time taken for generating all the vectors, as well as, for obtaining the vectors corresponding to the cluster centroids. The quality of the clustered reference database is also dependent on the kmer size. A typical metagenomic sequence (obtained using existing sequencing technologies) has a length <8001000 bp. For such short sequences, the taxonomic discrimination capability achieved using lower kmer sizes is expected to be poor. On the other hand, the frequencies of various oligonucleotides obtained using large kmer sizes will be extremely low and statistically insignificant. A kmer size of 4 was used in the current study since an earlier study had demonstrated that tetra-nucleotide frequencies carry an inherent taxonomic signal (). However, using kmer size of 4 limits the applicability of the current method for obtaining reliable taxonomic assignments for very short sequences, especially those obtained from sequencing technologies such as Solexa and Illumina. The binning efficiency of SPHINX also depends on the taxonomic coverage of the clustered reference database. The clustered database used in the current study contained sequences originating from 952 completely sequenced prokaryotic genomes. As more and more genomes are being sequenced, updating the clustered database with sequences from these genomes will help in improving the quality of taxonomic assignments. Updating the clustered reference database with sequences from these new genomes takes only a few minutes, since the process only involves mapping the new sequences to existing cluster centroids, and subsequently recomputing the cluster centroids. The clustered reference database used in the current study contained sequences originating from prokaryotic genomes. In principle, this database can be constructed using sequences from other taxonomic domains, such as viruses or eukaryotes. However, given that the information content in sequences originating from non-coding regions (which form major portions of eukaryotic genomes) does not conform to known patterns of taxonomic hierarchy, extending the SPHINX approach to such sequences will be a challenging task. It is also difficult to bin sequences
M.H.Mohammed et al.originating from repetitive stretches (characteristic of eukaryotic genomes) at specific taxonomic levels. This is due to the following reason. Sequences originating from repetitive stretches will generate hits with multiple sequences originating from taxa belonging to diverse taxonomic clades. Since, it is difficult to identify the exact genome from which the query sequence has originated, such sequences can be assigned only at high (non-specific) taxonomic levels. An additional challenge will be to taxonomically characterize metagenomic fragments containing overlapping reading frames, known to be prevalent in viral and eukaryotic genomes. In spite of the high accuracy and specificity of alignment-based approaches, the percentage of metagenomic sequences classified (by these approaches) either as 'unassigned' or at non-specific taxonomic levels is still very high. This is due to the fact that many of these sequences either do not generate alignments or generate poor quality alignments with sequences in existing reference databases. This is typical of sequences originating from organisms belonging to novel (hitherto unknown) taxonomic clades. It will be desirable if alignment-based approaches are complemented with methods that facilitates meaningful grouping of such sequences.
CONCLUSIONAlignment-based binning algorithms are observed to have greater binning accuracy and specificity as compared with existing composition-based methods. In this article, we demonstrate that adopting a reduced search space strategy enables one to drastically reduce the overall time taken for alignment-based binning approaches, with no significant loss of binning efficiency. This indicates the immense applicability of the proposed algorithm in rapidly mapping the taxonomic diversity of large metagenomic samples with high accuracy and specificity.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
The efficiency of alignment-based binning algorithms is expected to differ, when test sequences are queried against a reference database which contains sequences originating from not only coding regions but also sequences from the non-coding regions of known genomes. In order to study the
sequences are assigned to the class Actinobacteria, 1936 sequences to class Alphaproteobacteria, 1926 sequences to class Betaproteobacteria and approximately 600700 sequences each to classes Chloroflexi, Spirochaetes and Methanomicrobia. In contrast, none of the sequences in the obese dataset are assigned to any of these classes. This observation could either be due to the complete absence of organisms belonging to these classes in the obese dataset or due to the presence of hitherto unknown organisms belonging to these classes, the genomes of which have significantly diverged from the known organisms within these classes. Since sequences from
