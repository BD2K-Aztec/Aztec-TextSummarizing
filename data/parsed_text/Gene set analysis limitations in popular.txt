Motivation: Gene set analysis is the analysis of a set of genes that collectively contribute to a biological process. Most popular gene set analysis methods are based on empirical P-value that requires large number of permutations. Despite numerous gene set analysis methods developed in the past decade, the most popular methods still suffer from serious limitations. Results: We present a gene set analysis method (mGSZ) based on Gene Set Z-scoring function (GSZ) and asymptotic P-values. Asymptotic P-value calculation requires fewer permutations, and thus speeds up the gene set analysis process. We compare the GSZ-scoring function with seven popular gene set scoring functions and show that GSZ stands out as the best scoring function. In addition , we show improved performance of the GSA method when the max-mean statistics is replaced by the GSZ scoring function. We demonstrate the importance of both gene and sample permutations by showing the consequences in the absence of one or the other. A comparison of asymptotic and empirical methods of P-value estimation demonstrates a clear advantage of asymptotic P-value over empirical P-value. We show that mGSZ outperforms the state-of-the-art methods based on two different evaluations. We compared mGSZ results with permutation and rotation tests and show that rotation does not improve our asymptotic P-values. We also propose well-known asymptotic distribution models for three of the compared methods. Availability and implementation: mGSZ is available as R package from cran.r-project.org. Contact: pashupati.mishra@helsinki.fi Supplementary information: Available at
INTRODUCTIONInferring biological pathways from high-throughput gene expression datasets that are altered in a biological or a medical test is one of the major challenges in biosciences. The analysis of gene sets instead of individual genes results in significant reduction of noise and dimension and in greater biological interpretability. Furthermore, it enhances the statistical power of tests of association of phenotype with genetic variants by pooling signals of a set of genes linked to the same biological process. Annotation libraries like Gene Ontology (), KEGG pathways () and MIPS functional Categories () are some of the popular sources for gene sets. Several methods have been developed for gene set analysis. According to Goeman and B  uhlmann, 2007, gene set analysis methods can be categorized into two major categories, competitive and self-contained. Competitive methods focus on distinguishing the most significant gene sets among a dataset of gene sets (; T  or  onen et al., 2009;), whereas selfcontained methods focus on analysis of gene sets irrespective of other genes in the dataset (). In this article, we focus on competitive gene set analysis methods. Recent research has addressed gene set analysis problems in datasets with fewer replicates and more than two sample groups (). However, the fundamental problems in P-value calculation for gene set scores remain unaddressed. Most of the methods are still based on empirical P-value that requires a large number of permutations or rotations to be calculated accurately. In this article, we first evaluate various gene set scoring functions for their optimality and then propose improvements to empirical P-value calculation. We start with a rigorous assessment and evaluation of popular gene set analysis methods: Gene Set Analysis (GSA) (), Gene Set Z-score (GSZ) (T  or  onen et al., 2009), Allez (), methods based on KolmogorovSmirnov (KS) () and weighted KolmogorovSmirnov (wKS) (), and methods based on Wilcoxon Rank Sum (WRS) (), sum of scores (SUM) () and sum of squared scores (SS) () based on empirical P-value obtained from hundred thousand sample permutations. The selection of the methods was based on earlier comparisons (). We then test whether empirical null distribution (gene set scores from permuted data) obtained from the compared methods can be modeled by suitable asymptotic distribution models. We point out major limitations in some of the methods and propose improvements on scoring functions, permutation models and P-value estimation. We show that the efficiency of GSA can be significantly improved by replacing the *To whom correspondence should be addressed yThe authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. max-mean statistics with the GSZ scoring function and by implementing asymptotic P-value. Similarly, the performance of Allez can be significantly improved by implementing sample permutation and asymptotic P-value estimation. The improved versions of GSA and Allez are called mGSA and mAllez, respectively. We show that GSZ outperforms all the compared methods including the improved ones in our evaluation. We propose an asymptotic method of P-value estimation for GSZ, mGSA, mAllez and SUM. Asymptotic P-value estimation requires fewer permutations and significantly speeds up the gene set analysis process. Similar work that proposes asymptotic method for P-value calculation was done by. Our method is different in that it requires fewer permutations.proposed fully parametric gene set analysis methods based on normal approximation of the gene set scores (gene independence assumption). However, mGSZ is semi-parametric in the sense that we approximated the empirical null distributions of gene set scores with well-known asymptotic distribution models for asymptotic P-value estimation. The implementation resulted in significant improvement in efficiency of the methods. For gene set analysis methods with no known asymptotic model, we implement an improved version of P-value calculation based on Phipson and Smyth, 2010. P-value estimation in permutation-based gene set analysis methods uses either genes or samples or both as sampling unit. Despite its popularity, gene permutation can lead to flawed biological conclusion because of correlation among genes (Goeman and B  uhlmann,). For the competitive gene set analysis methods, however, we show that it is crucial to consider the results from gene permutation. Similar to, we show that the absence of gene permutation in competitive gene set analysis results in type I error. We argue in favor of using both gene and sample as sampling unit in competitive gene set analysis methods as proposed by Efron and,and T  or  onen et al. (2009). Once significant gene sets are reported, it is useful to evaluate a gene set in more detail to see the behavior of the gene set. This can be done by visualizing the gene set score profile across the gene list as shown in the original GSEA article (). In our opinion, it is even more relevant to compare gene set scores from original and permuted data. Original data correspond to differential gene expression test scores calculated from gene expression data with correct sample labels, and permuted data correspond to differential gene expression test scores calculated from gene expression data with permuted sample labels. Therefore, we represent an improvement on the visualization where we show the gene set scores from original data and a summary (e.g. percentiles) of the gene set scores from permuted data. This allows visualization of separation between gene set scores from original and permuted data. We compared mGSZ with program packages of GSA (), Allez () and CAMERA (). We show that mGSZ clearly outperforms the other methods. ROAST () is a state-of-the-art self-contained gene set analysis method. Even though in principle self-contained methods cannot be compared with competitive methods, we compared mGSZ with ROAST to point out the differences in gene set analysis results from the two different approaches.proposed rotation test for estimation of P-values for gene set analysis of datasets with very small sample size. We show that asymptotic P-values estimated from permutation test were equally good as that of rotation test with a dataset consisting of only three replicates in each group. Finally, we present a R statistical package 'mGSZ' that implements mGSZ and the other compared methods.
METHODSIn this section, we describe (i) Gene set scoring functions of the compared gene set analysis methods, (ii) Permutation model used in this work, (iii) Asymptotic method for P-value calculation, (iv) Series expansion for P-value calculation with EVD and GEVD models, (v) Evaluation tests for gene set scoring functions based on applicability of asymptotic P-value estimation, (vi) Evaluation tests for gene set scores based on empirical P-values, (vii) Comparison of mGSZ with state-of-the-art program packages, (viii) Evaluation of mGSZ with gene expression dataset with small sample size and (ix) Biological datasets used for the evaluation tests.
Gene set analysis methods
TheGene Set Z-score GSZ is a gene set scoring function that combines features from overrepresentation and shifted expression-based approaches. This is done by using a hypergeometric enrichment score that is weighted with the differential expression test scores (T  or  onen et al., 2009). GSZ takes as an input a gene list ordered based on differential gene expression test scores and classification of genes as member (MG) and non-member (NG) genes of gene sets (Supplementary). Given an ordered gene list, a threshold is placed in between every consecutive pair of genes. GSZ score is then calculated for every subset of the ordered gene list taken at each of the threshold positions (Supplementary). Let M denote the total number of genes in the ordered gene list and X i ; i=1; ::::; M denote the differential gene expression test scores for i th gene in the list. Let T i denote the threshold position at i th gene in the list and S N be a subset of top N genes of the list taken at T N. Then, GSZ uses the following function to calculate the difference between the sum of differential gene expression test scores for MG and NG genes of the analyzed gene set within the subset,The calculation is repeated for each threshold position, T i and the largest absolute value is selected as the GSZ score of the analyzed gene set based on upregulated member genes. The ordered gene list is then inverted and the whole process is repeated analogously starting from the most downregulated genes for the GSZ score of the analyzed gene set based on the downregulated member genes. The largest absolute value of the GSZ scores based on upregulated and downregulated member genes is selected as the GSZ score for the analyzed gene set. The difference calculated in Equation 1 is unstable due to the biases caused by differences in gene set sizes, subset sizes and variances of the gene set scores in different subsets. GSZ method solves this problem by Z-score normalization (),) and the size of the subset, N. For the calculation of prior variance, k, we use the medians of the variance estimates over the ordered gene list obtained with the analyzed gene set and a gene set of size 10 (Supplementary Section S7). GSZ is similar to the scoring function proposed by Efron and. Efron andproposed a max-mean statistics, where the analyzed gene set is divided into two parts at X = 0 (positive regulation and negative regulation). This corresponds to GSZ when the threshold N is placed at X N = 0 (Supplementary Section S8). The scoring function proposed bycalculates the mean value (X) of the differential expression test scores for all the genes in the analyzed gene set followed by normalization. The calculation of the mean and variance estimates for X is practically the same equations as Equations 3 and 4 with the only difference caused by the absence of N. Thus, GSZ is identical to the scoring function proposed byif calculated using the whole gene list. GSZ is identical to mGSZ with the addition of asymptotic P-values. For simplicity, we use the notation 'mGSZ' in the following text.
Modified methods Threeof the methods in our evaluation were modified versions of GSZ (T  or  onen et al., 2009), GSA (Efron and) and Allez (). The modifications wereGSZ: implementation of asymptotic P-value, GSA: replacement of max-mean statistics with GSZ statistics and implementation of asymptotic P-value and Allez: addition of sample permutation for asymptotic P-value calculation. We call the modified methods mGSZ, mGSA and mAllez, respectively.
Reference methodsWe also included methods based on WRS, SUM, sum of squared scores (SS), KS and wKS scoring functions. WRS statistics is the sum of ranks of member genes of the analyzed gene set in the whole gene list. SUM statistics is the simple sum of the differential gene expression test scores of the member genes of the analyzed gene set with background subtraction. SS statistics is simply the squared version of SUM.
Series expansion P-values for EVD and GEVD are based onextraction which makes it difficult to calculate extremely small P-values. We solved this problem by deriving series expansions on the logarithm of a P-value for EVD and GEVD. Log P-values for EVD and GEVD are calculated as:where, x=z  = 8 z is absolute mGSZ or mGSA score value for the analyzed gene set, and , and a are the location, scale and shape parameters, respectively, for GEVD. Expressions on the right hand side of Equations 5 and 7 are readily evaluated by ordinary numerical software for relatively small absolute values of x. However, already for values of the order of jxj % 30 the outer exponentials become so small that the results are distorted by rounding errors. To achieve more precise results, we derived the following expansions of F(x) and G(x) (Supplementary Section S2):G s x if x ! 5 and 1+ax40:The prespecification of the threshold was based on the number of terms picked from the series expansion and the amount of error allowed. The number of terms used in our analysis is four, and for F(x) this means that the approximation error is at most of the order 1:78  10 15 .
Datasets
TF deletion and overexpression data
P53 cancer data Proteinp53 is a tumor suppressor protein that prevents development of cancer cells. The p53 dataset consists of 33 samples with mutated p53 gene and 17 samples with wild type p53 gene ().
Gender dataGender data consist of mRNA expression profiles from lymphoblastoid cell lines derived from 15 males and 17 females ().
Leukemia data Leukemia dataset consists of gene expressionprofiles of cells from 24 acute lymphoid leukemia patients and 24 acute myeloid leukemia patients ().and overexpression data were verified using p53 and gender data. Forty gene sets strongly relevant to protein p53 and 10 gene sets strongly relevant to gender were selected and considered as relevant gene sets (Supplementary Tables S4 and S5). Gene sets reported by each of the methods were ranked based on empirical P-values calculated with 100 000 sample permutations. Subset of top gene sets (50 in p53 data and 20 in gender data) was taken. Relevant gene sets in the subset were labeled as 1 and irrelevant gene sets were labeled as 0. The cumulative sum was calculated for the subset. False-positive signal test. The performance of the compared methods was further analyzed with real biological data but with null gene sets. The null gene sets were generated by randomly choosing the member genes while keeping the gene set sizes intact. The idea was to test if some of the methods have a tendency to create false-positive results when gene sets have no biological signal.
Evaluation tests
Stabilityof gene set scores. GSZ scoring function is similar to KSbased scoring functions in that it calculates scores running across an ordered gene list. This allows us to compare mGSZ with KS and wKS based on the gene set score profile across an ordered gene list. Gene set score profiles of the top ranked gene set reported by wKS were calculated for original as well as 1000 sample permuted data with all the three methods. Instead of 1000 gene set score profiles, we plotted seven percentiles of gene set score profiles from permuted data.
Comparison of mGSZ with program packagesThe main objective of this comparison was to test the performance of mGSZ as compared with some of the state-of-the-art gene set analysis methods. We also included mGSA and mAllez in the comparison to show the improved performance as compared with their original versions, GSA () and Allez (). The comparison was based on three tests: (i) Evaluation of top gene sets, (ii) Falsepositive signal test and (iii) P-value test where we compare the log P-values reported by each of the compared methods.
Evaluation of mGSZ on dataset with small sample sizeHere, we tested the applicability of mGSZ to gene expression datasets with few replicates in each sample group. Gene set analysis methods based on empirical P-values are not suitable for datasets with few sample replicates (e.g. three), because the minimum obtainable P-value by empirical method is restricted by the small number of permutations that can be obtained from fewer sample replicates. Unlike permutation, number of rotations is not dependent on sample size (). For this evaluation, we developed two versions of mGSZ: one that implements permutation for generating empirical null distribution and the other that implements rotation for the same. In both cases, P-value was estimated asymptotically by fitting suitable asymptotic model to the empirical null distribution. We refer the two versions of mGSZ as mGSZpermutation and mGSZrotation, respectively. The only difference between the two versions is the number of permutations/rotations that can be generated for the empirical null distribution. Both mGSZpermutation and mGSZrotation were implemented on a simulated gene expression datasets. For the simulated gene expression datasets, we generated data on 20 000 genes and six samples. The first three samples are the control group and the second three samples are the treatment group. Each consecutive non-overlapping block of 20 genes was considered to be a gene set with the total of 1000 gene sets. Each gene expression value was generated as i.i.d. N(0,1). Then, the constant 1.0 was added to the first 10 genes in the every 10th gene set starting from 1st until 490th gene set. Thus, we generated 50 positive gene sets in the simulated dataset. The comparison of the results was based on evaluation of the top gene sets and P-value test, where we compare the log P-values reported by each of the methods.is based on approximate ranks. We use ties when the difference between methods is insignificant. Smaller ranks across the column denote good performance of a method, whereas bigger ranks denote the opposite. Stability test was relevant only to mGSZ, KS and wKS because the scoring functions of the other methods do not calculate running scores. mGSA leads mGSZ in the detection of TF activity with negligible difference. KS-based method showed surprisingly good empirical P-values leaving mGSZ as second best performer. However, KS lags behind in the other tests. Overall, mGSZ outperforms the other methods ().
RESULTS
Summary of the results
Asymptotic approximation of empirical null distributionWe tested four distribution modelsEVD, GEVD, NORM and GAMMAwith gene set scores from mGSZ of which EVD and GEVD turned out to be the optimal models based on the optimality criterion (Section 2.5.1) (). GAMMA and NORM did not pass the optimality criterion (Section 2.5.1) (). The same distribution models were tested with mGSA data and surprisingly, while EVD, GEVD and GAMMA turned out to be the optimal models, NORM did not pass the optimality criterion (Section 2.5.1) (). NORM was the best fitting model for SUM and mAllez data (Section 2.5.1) (). In case of mGSZ and mGSA, we selected the models that produced P-values with maximum cor and minimum mse with the reference of truth in both the whole data and the subset. In case ofmGSZ and mGSA, EV was selected as the model for asymptotic P-value calculation (),whereas NORM was the model of choice for asymptotic P-value calculation for mAllez and SUM (). Similar results were observed from the analysis with gender data (Supplementary Section S5).
P-value estimation methods: asymptotic and empiricalThe results were highly in favor of asymptotic P-values for mGSZ, mGSA, mAllez and SUM with higher correlation and lower mean squared error, as compared with the empirical P-values (). As shown in, asymptotic P-values (EV) calculated against 500 permutations have very low mse and very high cor when compared with empirical P-values calculated against 100 000 permutations. This implies that 500 permutations are enough for asymptotic P-values.
Evaluation of gene set scoring functions3.4.1 Detection of TF activity mGSZ and mGSA were the top ranking methods in identifying correct TF activity (). Analysis of five quantiles of AUC scores across the experiments in TF dataset showed that mGSZ and mGSA had the highest AUC score in the lowest quantile (0 quantile) ().
Detection of relevant gene setsTest on p53 cancer data. Top 50 gene sets reported by each of the compared methods were analyzed as described in section 2.5.3 (). mGSZ was the top ranking method, with SS being the closest competitor (). Test on gender data. Top 20 gene sets reported by each of the compared methods were analyzed as described in section 2.5.3. The results were similar to that of p53 data ().() with the compared methods. Leukemia data are signal rich data and hence suitable to test methods that are sensitive to high signals. Surprisingly, SS identified 485% of the null gene sets as significant (). SUM is the second-worst performing method in this test (). In addition to the leukemia data, we also performed the analysis on randomized p53 dataset with Gene Ontology genesets (). Even though mGSZ, mGSA, wKS and KS are more conservative, the difference to the other methods is significantly smaller (Supplementary Section S10).
False-positive signal analysis
Stability of gene set scores Stabilityof the gene set scores from mGSZ, KS and wKS was compared using p53 cancer data as described in Section 2.5.3. The stability plot for mGSZ, based on permuted data shows that the middle part of the seven percentiles of the gene set score profiles of the permuted data stay quite stable across gene list positions (). The minimum percentile shows smaller deviation from zero than the maximum percentile (). This indicates that gene set scores coming from overrepresentation show stronger signal than those coming from underrepresentation. The maximum of thegene set scores from original data comes quite early in the gene list, pointing that gene set members occur near the top of the ordered gene list (). Notice that the separation between gene set score profile from original data and permuted data is quite clear across different threshold positions (). The importance of our visualization is more highlighted when we analyze the behavior of wKS and KS with the same gene expression dataset and the same gene set. For wKS the gene set score profile from permuted data shows strange behavior with Sshaped profile () and for KS the middle area shows strong variation (). The separation between gene set score profile from permuted data and original data is weak in both wKS and KS (). This comparison is based on the strongest gene set reported by wKS. Stability plot for mGSZ, wKS and KS based on gender data is discussed in Supplementary Section S6.
Comparison of mGSZ, mGSA and mAllez with program packagesWe summarize the results of the comparison of mGSZ, mGSA and mAllez with program packages in. The notation used inis same as in the. The results are described in detail in Supplementary Section S11. Two datasets (p53 and gender) were used for all evaluation tests except for false-positive signal analysis. For false-positive signal analysis, leukemia dataset was used for similar reason as mentioned in Section 2.5.3. CAMERA showed the best results in false-positive signal analysis. However, in the remaining two evaluation tests, mGSZ outperformed the other methods.
Evaluation of mGSZ on dataset with small sample sizeNo significant difference was observed between log P-values reported by mGSZrotation and mGSZpermutation with the simulated dataset (Supplementary Section S12, Supplementaryand b). We also evaluated the top gene sets reported by the two methods in both the simulated datasets, and the results were similar (Supplementary Section S12, Supplementary Figs 17a and b).demonstrates the effects of the use of gene or/and sample permutation methods in competitive gene set analysis methods. The table is the summary of the results from false-positive signal analysis of the compared gene set scoring functions (Section 3.4.3,) and comparison of mAllez with program package of Allez based on detection of relevant gene sets (Section 3.5,). The methods implementing only sample permutation. Visualization of scoring function profiles for mGSZ, wKS and KS for gene set 'p53hypoxiaPathway' in p53 data. Figures also show seven percentiles (0, 10, 25, 50, 75, 90 and 100) of gene set score profiles obtained from the permuted data. Notice the clear separation of the gene set score profiles from original data with that of permuted data and stability of gene set score profiles from permuted data in case of GSZ-scoreNotes: Numbers indicate approximate rank of the methods based on the test results. *Sign indicates that a test is not applicable to a particular method. report high false-positive signal (). Note the ranks of mAllez and Allez based on detection of relevant gene sets in. The improved performance of mAllez as compared with Allez is clearly due to the addition of sample permutation (). Interestingly, GSA that explicitly implements both gene and sample permutations, ranks lower than mGSZ and mGSA (). This suggests that implicit implementation of gene permutation is at least as good as explicit implementation.
Evaluation of permutation methods
DISCUSSIONGene set analysis methods aim to identify a priori defined gene sets associated with biological pathways that are altered in a biological or medical test. Despite the decade long research into the field, some of the most popular gene set analysis methods still suffer from serious limitations that need to be addressed and rectified. In this work, we have accessed and evaluated popular gene set analysis methods, pointed out limitations in the scoring functions, permutation methods and P-value calculation methods and proposed improvements. mGSZ and mGSA are the best performers in detection of TF activity in TF data (Section 3.4.1). However, in case of p53 and gender data, mGSZ detected the highest number of relevant gene sets, closely followed by SS (Section 3.4.2). Overall, mGSZ stands out as the best performer in detection of relevant gene sets. Note that the evaluation tests, detection of TF activity in TF data and relevant gene sets in p53 and gender data were based on empirical P-values estimated with 100 000 permutations. Only the gene set scoring functions were varied in the compared methods. So, the variations in results were direct consequences of the gene set scoring functions. Despite the good performance in detection of relevant gene sets with p53, gender and TF data, SS as well as SUM had significantly high type 1 error with randomized leukemia dataset (Section 3.4.3). SS and SUM are the only methods in our comparison that lack gene permutation. Because of that the methods do not compare the member and non-member genes of the analyzed gene set and thus lose the essence of competitive GSA. Note that self-contained gene set analysis methods do not require gene permutations as they calculate gene set scores with no reference to genes other than member genes of the analyzed gene sets. The remaining six methods have gene permutation included implicitly in their scoring functions and take into consideration the results from gene permutations implicitly. This clearly points to the importance of considering results from gene permutation in competitive gene set analysis methods (Section 3.7,EVD and GEVD turned out to be the best fitting models for mGSZ data which is quite natural considering that the mGSZ score is the highest absolute value in a profile. For mGSA, EVD, GEVD and GAMMA turned out to be the best fitting models. In case of mAllez and SUM, NORM was the best fitting model. Asymptotic P-values calculated for mGSZ, mGSA, mAllez and SUM scores with the best fitting models with 500 sample permutations were more accurate than empirical P-values calculated with 2000 sample permutations, clearly demonstrating the superiority of asymptotic P-value over empirical P-value (Section 3.3). Surprisingly, despite the poor performance on the other tests, empirical P-value estimation method for KS with 500 sample permutations shows exceptionally high accuracy (Section 3.3). Comparison of mGSZ with the state-of-the-art gene set analysis methods showed the best overall performance of mGSZ. mGSZ is the best method among the compared methods based on the results from the detection of relevant gene sets from p53 and gender datasets and comparison of resolution of the Pvalues assigned to the top gene sets from p53 and gender datasets (Section 3.5). The comparison of mGSZ with ROAST was included to illustrate the differences between self-contained and competitive methods with a suitable dataset. In a signal rich dataset like leukemia, self-contained methods like ROAST fail to provide biologically conclusive results. Randomization of gene sets in leukemia dataset randomizes the member genes of the gene sets. However, as 79.9% of the individual genes are differentially expressed in the leukemia data (), ROAST identifies a significantly large number of null gene sets as significant. This effect is not seen in competitive methods as competitive methods compare the member genes with non,WRS Present Present implicitly Low SS Present Absent High SUM Present Absent High wKS Present Present implicitly Low KS Present Present implicitly Low Allez Absent Present  Ranked as worstGSA Present Present  Ranked lower than mGSZ and mGSAmember genes of the analyzed gene sets, and thus the results remain stable in datasets with varying level of biological signals. Interestingly, both mGSA and mAllez rank higher than GSA and Allez in detection of the relevant gene sets in p53 and gender dataset. Higher rank of mGSA as compared with GSA suggests that replacement of max-mean statistics in GSA with GSZ scoring function and implicit implementation of gene permutation improved the performance of the method. Note that GSA implements gene permutation explicitly. Whereas, higher rank of mAllez as compared with Allez suggests that implementation of sample permutation in addition to gene permutation in Allez improved the performance of the method, once again highlighting the importance of implementing both gene and sample permutations in competitive gene set analysis (Section 3.7,). Negligible difference was observed between the asymptotic P-values reported by mGSZ with rotation test and mGSZ with permutation test (Section 3.6) with simulated gene expression dataset with three replicates in each sample group. In addition, both the methods identified same number of positive gene sets in the simulated dataset. The results suggest that mGSZ with permutation test is applicable to gene expression datasets with sample size as small as three. Improved visualization of scoring function profiles of a gene set (the most significant gene set reported by wKS) in the case of mGSZ, KS and wKS revealed a major pitfall in KS based methods, not seen in the original visualization used by(Section 3.4.4). Based on the results of our evaluation, we therefore propose:(i) use of GSZ scoring function instead of max-mean statistics in GSA (), (ii) implementation of both gene and sample permutation in competitive gene set analysis methods and (iii) use of asymptotic P-values for the methods based on GSZ, mGSA, mAllez and SUM. These improvements are implemented in our R package, mGSZ. mGSZ takes about 10 min for a gene set data with 522 gene sets and p53 data with 500 permutations in Mac book Pro 10.7.5.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
P.Mishra et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.1.4 Program packages We compared mGSZ, mGSA and mAllez with R package programs of GSA (Efron and Tibshirani, 2006), Allez (Newton et al., 2007), CAMERA (Wu and Smyth, 2012) and ROAST (Wu et al., 2010). 2.2 Permutation Gene permutation involves permutation of the genes, whereas sample permutation involves permutation of the class labels. GSZ scoring function uses estimates of mean and standard deviation that takes into account the deviation in the gene expression data in both member and non-member genes. This feature of GSZ scoring function allows to compare the gene set scores calculated from the actual gene expression data with the gene set scores calculated from gene-wise permutations of the gene expression data implicitly without the need of separate runs of genewise permutations of the gene expression data. All the reference methods but SUM and SS implement gene permutation implicitly in their scoring functions. All the evaluations except detection of transcription factor (TF) activity in this article are based on sample permutation. 2.3 P-value calculation The minimal obtainable P-value by empirical method and its resolution is directly proportional to the number of permutations. Permutation-based gene set analysis involves small P-values that require a large number of permutations to be calculated accurately. This is often computationally infeasible. An alternative way to calculate small P-values accurately without the need of a large number of permutations is to fit a suitable asymptotic distribution model to the empirical null distribution of gene set scores from permuted data with fewer permutations, estimate parameters of the fitted asymptotic model and use the estimated parameters to calculate P-values from the assumed cumulative distribution function. Asymptotic P-value calculation in this work is based on Gaussian distribution (NORM), Gamma distribution (GAMMA), Extreme value type I distribution (EVD) (Supplementary Section S1) and General extreme value distribution (GEVD) (Supplementary Section S1). Asymptotic distribution models were fitted on the empirical null distribution using distribution fitting methods in R packages, MASS (Venables and Ripley, 2002) and ismev (Heffernan and Stephenson, 2012). We used NORM for modeling gene set scores from SUM and mAllez because sums of normally distributed values should be normally distributed. We used GAMMA for modeling gene set scores data with skewed distribution, for example, SS. EVD and GEVD were used to model gene set score data composed of extreme values, for example, mGSZ and mGSA.
Gene set analysis at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
False-positive signal analysis Leukemia 1 1 1 1 7 8 1 1 P 5 3 1 1 1 1 1 1 1 1 Stability of the scoring functions over gene list P53, gender 1 * * * * * 3 2 Notes: First row indicates either presence (Yes) or absence (No) of asymptotic models for the methods, whereas in the rest of the rows, numbers indicate approximate rank of the methods based on the test results. *Sign indicates that a test is not applicable to a particular method.
