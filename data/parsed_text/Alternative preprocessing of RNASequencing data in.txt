Motivation: The Cancer Genome Atlas (TCGA) RNA-Sequencing data are used widely for research. TCGA provides 'Level 3' data, which have been processed using a pipeline specific to that resource. However, we have found using experimentally derived data that this pipeline produces gene-expression values that vary considerably across biological replicates. In addition, some RNA-Sequencing analysis tools require integer-based read counts, which are not provided with the Level 3 data. As an alternative, we have reprocessed the data for 9264 tumor and 741 normal samples across 24 cancer types using the Rsubread package. We have also collated corresponding clinical data for these samples. We provide these data as a community resource. Results: We compared TCGA samples processed using either pipeline and found that the Rsubread pipeline produced fewer zero-expression genes and more consistent expression levels across replicate samples than the TCGA pipeline. Additionally, we used a genomic-signature approach to estimate HER2 (ERBB2) activation status for 662 breast-tumor samples and found that the Rsubread data resulted in stronger predictions of HER2 pathway activity. Finally, we used data from both pipelines to classify 575 lung cancer samples based on histological type. This analysis identified various non-coding RNA that may influence lung-cancer histology. Availability and implementation: The RNA-Sequencing and clinical data can be downloaded from Gene Expression Omnibus (accession number GSE62944). Scripts and code that were used to process and analyze the data are available from https://github.com/srp33/TCGA_RNASeq_Clinical.
IntroductionThe Cancer Genome Atlas Research Network has profiled thousands of human tumors to discover various types of molecular-level aberrations that occur within tumors. Researchers have used these data to derive new insights about tumorigenesis and to validate and inform experimental findings (The Cancer Genome Atlas Research(RNA-Seq) data, which have been aligned to the reference genome using MapSplice (), quantified at the gene and transcript levels using RSEM () and standardized using upper-quartile normalization (). However, the use of these data comes with some caveats. First, some analytic tools designed specifically for RNA-Seq datafor example, DESeq2 ()require the user to input integer-based read counts, yet Level 3 read counts are represented as non-integer numbers. Second, the upper-quartile normalization method scales gene counts by the upper-quartile value of the non-zero distribution; however, when a sample has a relatively high number of zero counts or genes with extremely high read counts, the value distributions may vary considerably across samples (). Third, when researchers seek to compare the TCGA Level 3 data against clinical covariates and outcomes, additional processing steps are necessary to match RNA-Seq identifiers to the clinical data. Users without computational training may face difficulty performing these steps, and scientists may duplicate each other's efforts. The TCGA consortium also provides the RNA-Seq data in raw form. Thus it is possible for researchers to reprocess the data using alternative computational pipelines. We obtained raw sequencing data for 9264 tumor samples and 741 normal samples across 24 cancer types () and reprocessed the data using the Subread algorithm (), which shows high concordance with other existing methods regarding assignment of reads to genes but takes a relatively short time for processing (SEQC/MAQC-III). RNA transcripts often span multiple exon-exon junctions, making it challenging for aligners to map reads that are smaller than the transcript length. Rsubread's 'vote-and-seed' readmapping technique addresses this problem by breaking the reads into relatively small segments, mapping the segments to the reference genome and identifying locations where adjacent segments map to different exons. This approach has been shown to be more accurate in mapping junction reads than other aligners, including MapSplice (). The Rsubread package, which implements the Subread algorithm, is convenient for this task because: (i) it can be applied to both single-and paired-end reads; (ii) it is considerably faster and requires less computer memory than many other methods and (iii) it requires no external software packages for processing, whereas many other packages require a series of steps that span multiple packages. We used the featureCounts function within the Rsubread package to summarize the data to integer-based, gene-level read counts, and we calculated two types of normalized value: fragments per kilobase of exon per million reads mapped (FPKM) and transcripts per million (TPM) (). In this pipeline, the FPKM and TPM values are calculated using the total number of mapped reads and the total number of non-overlapping exonic basepairs. Both FPKM and TPM methods account for the length of genomic features. FPKM corrects for the number of reads that have been sequenced, and TPM accounts for the average number of mapped bases per read. FPKM values are used widely, whereas TPM values have been shown to meet the invariant average criterion and thus may be more comparable across samples (). Importantly, FPKM and TPM are calculated using only data from an individual RNA-Seq sample; thus adding new samples to the dataset will not require changes to the existing expression values; such an approach is crucial for precision-medicine applications and for integrating data across technology platforms (). Furthermore, because we have provided raw counts, it is possible for others to normalize the data using other methods with relative ease. We have made these data publicly available along with all clinical variables provided by TCGA for these samples. We have also aligned the RNA-Seq sample identifiers with the clinical identifiers.A total of 9264 tumor samples across 24 cancer types are included in the database.
Methods
HER2 gene-expression profiling dataBefore analyzing TCGA data, we generated an experimental dataset that represented the effects of HER2 (ERBB2) overexpression in breast cancer cells. Using human mammary epithelial cells (HMECs), we produced five replicates, in which the HER2 protein had been experimentally activated, and 12 control green fluorescent protein (GFP) replicates. We used recombinant adenovirus to overexpress HER2 (Vector Biolabs) and GFP in the HMECs. The HMECs were grown in serum-free WIT-P media (Stemgent) and were starved of growth factors for 36 h prior to infection. HER2-expressing or GFP-expressing adenovirus (MOI 500) were added to HMEC cells in conditioned media and incubated with the cells for 18 h. Cells were washed with phosphate buffered saline, scraped into RNAlater (Ambion), and RNA was extracted from pelleted cells using an RNeasy kit (Qiagen) with DNase. To ensure that components were being expressed, we created lysates of HER2-adenovirus-vector and GFP-adenovirus-vector infected HMEC cells and analyzed these lysates for expression of HER2-pathway protein components by sodium dodecyl sulphatepolyacrylamide gel electrophoresis/Western blot. HER2 overexpression and activity was confirmed by Western blotting for HER2 and for activated HER2 (phospho-Tyr1173-HER2, Supplementary). cDNA libraries were prepared from the extracted RNA using the Illumina Stranded TruSeq protocol and then sequenced with the Illumina HiSeq 2000 sequencing platform with six samples per lane. Single-end reads of 101 base pairs were generated. This dataset is available on Gene Expression Omnibus via accession number GSE62820.
TCGA data acquisitionWe downloaded TCGA Level 3 data via the Synapse portal for 12 cancer types (https://www.synapse.org/#!Synapse:syn1695324). This included 3468 samples that had been preprocessed using TCGA's standard pipeline. To reprocess TCGA data with Rsubread, we downloaded FASTQ formatted files for all available TCGA tumor samples via the National Cancer Institute's Cancer Genomics Hub (). This included a total of 9264 tumor samples across 24 cancer types (). Some patient samples were sequenced multiple times; in these cases, we included each replicate. We downloaded TCGA clinical data in 'Biotab' format on May 20, 2015 from the TCGA data portal (https://tcga-data.nci.nih.gov/ tcga/dataAccessMatrix.htm) and extracted all reported clinical variables from the nationwidechildrens.org_clinical_patient_.txt files. In these files, 12-character patient identifiers were used, whereas the RNA-Seq sample identifiers were longer. To make it easier to integrate these two data sources, we converted the short IDs to full IDs by matching the 'bcr_patient_barcode' values in the clinical files. For patients who had multiple RNA-Seq replicates, we provide multiple columns in the clinical data file. We set values as 'NA' when no information was reported in the clinical files for a given patient. If there were multiple sequences available for a tumor sample, we duplicated the clinical variables available for that sample. In total, we included 548 clinical variables.
Data processing and normalizationFor our HER2 expression-profiling data, we calculated gene-level values using the same steps that the TCGA consortium uses to produce 'Level 3' values. The reference data, Perl scripts and parameters used in this pipeline are described here: https://cghub.ucsc.edu/docs/ tcga/UNC_mRNAseq_summary.pdf. In some cases, the software versions specified in the above document were unable to handle single-end reads. In these cases, we used the latest versions of these software tools that were able to handle single-end reads. Below we list these versions: @BULLET MapSplice v 12_07 () @BULLET RSEM v1.2.12 () @BULLET UBU v1.2 (https://github.com/mozack/ubu/) @BULLET Picard-tools v1.82 (http://picard.sourceforge.net) @BULLET BedTools v2.17.0 () For our HER2 data and for the samples from TCGA, we used the Rsubread package (version v1.14.2;) to align the reads and to produce gene-level summarized values. We used the UCSC hg19 reference for alignment and the corresponding gene annotation format file available from http://support.illumina.com/ sequencing/sequencing_software/igenome.html. Within this pipeline, we obtained integer-based gene counts using the featureCounts function in the Rsubread package (). We used the limma (version 3.20.9;) and edgeR (version v3.6.8;) packages to calculate FPKM values () and a custom script to convert FPKM to TPM values (). We used R version 3.1.0 and Bioconductor version 2.14 (; R Core Team, 2014; http://www.R-project. org/). When evaluating pre-normalized gene counts, we used the 'expected_count' column in the '.genes.results' files generated by RSEM, and Rsubread's raw, integer-based gene counts. All processed TCGA data can be accessed on Gene Expression Omnibus via accession number GSE62944. This includes integer-based gene counts and FPKM and TPM values as well as clinical data.
Statistical proceduresWhen comparing gene-expression values between groups in this study, we calculated the standardized mean difference using Hedges' formula (). We used the coefficient of variation (CV) to assess variability. We used the Random Forests classification algorithm implemented in the caret package (). The data-processing pipelines and analysis scripts that we used for this manuscript are available from https://github.com/srp33/ TCGA_RNASeq_Clinical.
Results
Evaluation of biological replicatesOur initial goal was to generate a gene-expression signature representing HER2 activation and to use that signature to identify breast tumors in TCGA where the HER2 pathway was active. For consistency with TCGA, we initially processed the RNA-Seq signature data using the same pipeline used by the TCGA consortium (see Materials and Methods). However, upon examining these data, we observed inconsistencies across our biological replicates. For example, as illustrated in, we found that some replicates exhibited considerably different patterns of expression for genes that showed the greatest differences in expression between HER2-active cells and GFP controls. Concerned that such inconsistencies could reduce the effectiveness of our signature-based predictions, we examined the data further and explored the Rsubread pipeline as an alternative. We hypothesized that the inconsistencies we observed in our biological replicates may have resulted from differences in the total number of mapped reads, from genes expressed at extremely high levels or from differences in the number of zero-count genes per sample. Others have described these factors as potential limitations of the upper-quartile normalization step used in the TCGA Level 3 processing pipeline (). Accordingly, we reprocessed the data using Rsubread and performed various analyses to understand the effects of these variables for data processed using either pipeline. In addition, we performed various analyses to compare the performance of the two datasets in various biomedical research contexts (Supplementary).
Raw gene count analysisInitially, we compared raw (non-normalized) gene counts between the TCGA Level 3 and Rsubread processing pipelines for our HER2 (n  5) and control (n  12) replicates. The TCGA Level 3 pipeline produces expected counts as floating point (non-integer) numbers, whereas Rsubread produces integer-based gene counts, which represent the number of mapped reads per gene. For both pipelines, the HER2 gene counts were significantly overexpressed in HER2 activated cells relative to control samples (Supplementary). However, the difference in expression between HER2-activated cells and controls was greater for the Rsubread data (standardized mean difference for TCGA: 10.0; Rsubread: 23.8). To explore these differences further, we compared the total number of mapped reads per sample between the two pipelines. For HER2-activated samples, the total number of mapped reads was much more variable for the TCGA Level 3 data than for the Rsubread data (). Two of the HER2-activated samplesthe same samples (2 and 4) that showed visual differences inhad a considerably smaller number of total mapped reads when the TCGA pipeline was used. Upon plotting the empirical cumulative distribution of the total mapped reads per sample (and Supplementary), we observed that the same HER2-activated samples showed different overall expression patterns, due to a relatively high number of genes with zero read counts. These observations suggest that Rsubread is less sensitive to differences in library size and that it more consistently identifies genes expressed at extremely low levels.
Normalized gene expression analysisWe observed similar findings for the normalized values produced using either pipeline. The empirical cumulative distribution of total normalized expression was more consistent for the Rsubread data (FPKM and TPM) than for the TCGA Level 3 data (Supplementary).). In addition, across all genes for the control and HER2-activatedthe HER2 samples, and samples 2 and 4 (see) had a considerably lower number of mapped reads. In contrast, the number of mapped reads for Rsubread was consistent across the samplesAlternative preprocessing of RNA-Seq datareplicates, the coefficients of variation were smaller for the Rsubread processed data than for the TCGA Level 3 data (Supplementary). These observations remained consistent, even if we excluded the two HER2 replicates that showed different gene-count distributions in the TCGA Level 3 data (Supplementary), these values were less consistent for a given gene. These findings suggest that the alignment, count estimation and/ or upper-quartile normalization steps used in the Level 3 pipeline lead to variability across the replicates and that the Rsubread FPKM and TPM values are more consistent across replicates. Having observed these patterns in our replicates, we processed 9264 RNA-Seq samples from TCGA using the Rsubread package. We performed various comparative analyses using the samples that overlapped with the Level 3 data that had been distributed via the Pan Cancer 12 project (The Cancer Genome Atlas Research). We limited our comparative analyses to the genes (n  19 584) and samples (n  3380) that overlapped between these datasets. Across all samples, the number of zero-count genes was significantly higher in the TCGA Level 3 data than in the Rsubread data, (t-test P value < 0.001; Level 3 median  2742.5; Rsubread TPM  1910.0; see Supplementary). In addition, we calculated Pearson's correlation coefficients between replicates for the 13 patients that were common between TCGA PANCAN12 and our Rsubread TPM data (Supplementary Table S3 and). Across the replicates, the Pearson's correlation coefficients were higher for the Rsubread processed replicates (median  0.86) than for the TCGA Level 3 replicates (median  0.79).
Downstream analysesNext, we used a sparse binary factor regression method () to derive a gene-expression signature that would predict whether the HER2 pathway was active in a given TCGA breasttumor sample. This technique results in a probabilistic estimate for each tumor sample that indicates whether the pathway is active. We applied this approach to data from both processing pipelines and compared the estimates of HER2 pathway activity between tumor samples that had been confirmed via immunohistochemistry to be HER2 positive (n  149) or negative (n  513). For both data-processing pipelines, the probabilistic estimates of HER2 pathway activity were significantly higher for HER2-positive versus HER2-negative samples (see Supplementaryand). However, the predictions for the Rsubread data were less variable than for the TCGA Level 3 data (see Supplementary), and the standardized mean difference between the groups was greater for the Rsubread data (TCGA Level 3: 0.44; Rsubread FPKM: 0.52; Rsubread TPM: 0.59). This finding was robust to the exclusion of HER2 samples 2 and 4 (Supplementary). Thus, using an empirical approach to estimate HER2 pathway activity, the Rsubread data resulted in more reliable and consistent conclusions when validated against traditional methods. As an additional test, we examined how well we could distinguish between lung adenocarcinoma (LUAD) and lung squamous cell carcinoma (LUSC) samples in TCGA. This classification is clinically important to guide personalized therapy based on the molecular subtypes (The Cancer Genome Atlas Research). We used the Random Forests classification algorithm () to identify gene-expression patterns that differ between these cancer types, and we performed 10-fold cross-validation to estimate how accurately tumors of either cancer type could be identified. For this analysis, we used TCGA Level 3 data and Rsubread normalized (TPM) data for 575 tumor samples that overlapped between these datasets. We used receiver operating characteristic (ROC) curves to assess classification accuracy and the balance between sensitivity and specificity in making these predictions. With the area under ROC curves (AUC) as a comparison metric and a probability threshold of 0.5, both datasets resulted in highly accurate predictions of lung-cancer histological type (AUC  0.999 for Rsubread; AUC  0.985 for TCGA Level 3); however, the TCGA Level 3 data resulted in 28 (out of 575) incorrect predictions, whereas the Rsubread data resulted in only 9 incorrect predictions (). Using the TCGA Level 3 data,suggested that a subset of the LUSC samples were 'discordant' with the remaining LUSC samples and exhibited 'LUAD-like' properties. Our Random Forests predictions for the Level 3 data led to similar conclusions. In contrast, when we use the Rsubread data, the 'LUSC Discordant' samples are classified mostly as 'LUSC'. One difference between the two datasets is that the TCGA Level 3 data contain values for 20 217 genes (after excluding genes that have zero variance across all samples), whereas the Rsubread data contain values for 22 833 genes. Accordingly, we repeated the Random Forests classification analysis and limited each dataset so that it included only the 19 453 genes that overlap between the two datasets. With this approach, both datasets resulted in virtually identical results: most 'LUSC Discordant' samples were classified as 'LUAD'. We examined the genes present in the Rsubread data but not in the TCGA Level 3 data and found various genes that show strong and consistent expression similarity between 'LUSC Discordant' and LUSC samples (Supplementary). Expression patterns for these genes are consistent and strong enough that they alter the Random Forests classification results for the 'LUSC Discordant' samples. Although these samples do exhibit expression patterns characteristic of LUAD. Empirical cumulative distribution of total mapped reads using raw gene counts. In all cases, the cumulative distributions were more consistent for Rsubread than for the TCGA pipeline produced gene counts data. The aberrantly expressed samples in the TCGA data are the same samples (GFP sample 4, HER2 samples 2 and 4) that showed visually different expression patterns in the heat maps (see). GFP samples (n  12) are represented in blue and HER2 samples (n  5) are represented in brown color for many genes, this analysis indicates that these samples should not necessarily be classified as LUAD tumors. We observed this difference because the Rsubread data were processed using relatively recent gene definitions; thus researchers who work with these data may have a more complete picture of tumor biology.
DiscussionTo our knowledge, this compendium of RNA-Seq tumor data is the largest compiled to date. It includes 9264 tumor samples and 741 normal samples across 24 cancer types. These data offer an alternative to the lone pipeline used by the TCGA consortium. In contrast to the TCGA data portal, which provides the RNA-Seq data in individual files for each sample, we have compiled the Rsubread tumor data into aggregate data files; thus it will be easier for researchers to analyze the data and compare across cancer types. We have matched these data to clinical variables to ease the process of examining relationships between these variables and gene-expression levels. Different RNA-Seq processing pipelines differ considerably in accuracy for quantifying gene-level expression values (). However, our goal was not to perform an exhaustive benchmark comparison across the many tools available for processing RNA-Seq data, although others have shown that Rsubread performs quite well in such benchmarks at quantifying gene-expression levels (SEQC/MAQC-III). Rather our goals were to provide a new community resource and to provide evidence that this alternative dataset is of high quality and performs better in various downstream analyses than the standard TCGA data. We have demonstrated that Rsubread produces more consistent values across biological replicates, and we have provided evidence that our data lead to more biologically relevant conclusions. Tens of thousands of hours of computational processing time were necessary to compile this dataset. Thus we also hope to prevent the need for other scientists to invest similar resources. Our dataset will be most useful to researchers who wish to compare gene-level expression values across samples. Researchers who wish to work with transcript-or exon-level values or who wish to identify splice junctions may find the TCGA Level 3 data useful for this purpose. Various Web-based portals exist for visualizing and analyzing TCGA data. These include cBioPortal for Cancer Genomics () and the UCSC Cancer Genomics Browser (). Our data could be incorporated into these portals as an additional option for users who wish to analyze raw gene counts or to use the FPKM and TPM values that we provide. We plan to update the data as more cancer types and tumor samples become available. We used open-source software to align and normalize the data and have made our processing code publicly available. In addition, we used single-sample normalization techniques to process the data. Thus, one can add new samples as they become available without affecting the existing data. However, we emphasize that it may still be necessary for researchers to correct for intersample variation when comparing data across batches and cancer types.Conflict of Interest: none declared.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.Rahman et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
