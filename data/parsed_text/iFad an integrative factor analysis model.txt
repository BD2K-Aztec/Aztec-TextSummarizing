Motivation: Pathway-based drug discovery considers the therapeutic effects of compounds in the global physiological environment. This approach has been gaining popularity in recent years because the target pathways and mechanism of action for many compounds are still unknown, and there are also some unexpected off-target effects. Therefore, the inference of drug-pathway associations is a crucial step to fully realize the potential of system-based pharmacological research. Transcriptome data offer valuable information on drug-pathway targets because the pathway activities may be reflected through gene expression levels. Hence, it is of great interest to jointly analyze the drug sensitivity and gene expression data from the same set of samples to investigate the gene-pathwayâ€“drug-pathway associations. Results: We have developed iFad, a Bayesian sparse factor analysis model to jointly analyze the paired gene expression and drug sensitivity datasets measured across the same panel of samples. The model enables direct incorporation of prior knowledge regarding gene-pathway and/or drug-pathway associations to aid the discovery of new association relationships. We use a collapsed Gibbs sampling algorithm for inference. Satisfactory performance of the proposed model was found for both simulated datasets and real data collected on the NCI-60 cell lines. Our results suggest that iFad is a promising approach for the identification of drug targets. This model also provides a general statistical framework for pathway-based integrative analysis of other types of-omics data. Availability: The R package 'iFad' and real NCI-60 dataset used are available at
INTRODUCTIONIdentification of drug targets, the gene products that bind to specific therapeutic molecules, is essential for understanding drugs' action mechanism and possible side effects, and for maximizing treatment efficacy and minimizing drug toxicity. Traditional pharmaceutical research and development process is deeply rooted in the 'one target-one drug' mindset, which tries to interfere the pathological process through blocking an important molecular player (e.g. a specific enzyme) using a compound. Unfortunately, most drug candidates identified through high-throughput screening based on this philosophy have failed due to either poor efficacy or serious side effects (). High hope has been placed on using systems biology for drug discovery through the application of novel computational methods to high-throughput genomics and proteomics data. In contrast to the traditional 'one target-one drug' perspective that ignores the intricate interaction among genes/proteins, systems biology approaches consider the drug effects in the global physiological environment. They may be more effective in drug discoveries because it has become apparent that most common diseases result from system-level malfunctions rather than problems with individual genes (). In practice, drug combination or polypharmacy is more commonly used in recent years to modulate multiple drug targets. Existing computational methods for drug-target identification can be generally categorized into three classes. The first class of methods uses the classical gene expression profiling strategies to infer drug targets. For example, drug targets can be identified by comparing the mRNA responses in human cell lines induced by drugs with unknown mechanisms with a set of well understood drugs. The connectivity map project () used a non-parametric rank-based pattern matching strategy based on the KolmogorovSmirnov statistic, which requires extensive data mining procedures. Another study () proposed a bi-clustering method, named iterative signature algorithm (ISA), to search for 'co-modules' representing genedrug associations. The second class of methods aims to integrate various types of biological data, including knowledge about bioactive molecules and their protein targets (e.g. sequences, structures and molecular mechanisms) along with the phenotypic effects of drug treatment, to deduce the probability of two proteins being bound by the same ligand (). Drug docking studies have also been incorporated to measure the binding probabilities based on 3D structural complementarities (). One disadvantage of these methods is that they only evaluate the likelihood of presumed drug-target pairs and make no inference of unknown drug targets.proposed a probabilistic network to calculate the probability of two drugs sharing the same target by comparing their clinical side effects. However, this method provides limited information on the drug action mechanisms.
Ma and ZhaoThe third class of methods analyzes the global patterns of drugprotein interactions (). It is known that established genedrug binary associations form a dense network that exhibits local clustering of similar drug types. Such networks can enhance our understanding of the physiological effects of various drugs in terms of the molecular pathways and disease categories involved. However, these 'guiltby-association' methods are too coarse-grained to make quantitative inference about the effect of drugs at the system level. In this article, we develop a coherent statistical framework to jointly analyze drug sensitivity and gene expression patterns from the same set of cell lines to infer the target pathways of drugs. Much information on these two types of data has been accumulated in the literature (), and if appropriately analyzed, these data may be informative for inferring drug targets. We adopt a latent factor analysis approach, where each latent factor corresponds to the activity of a specific pathway. Note that factor analysis models have been proposed for the reconstruction of gene regulatory networks and the inference of transcription factor activity profiles (). A previous review article () compared the performance of five different factor analysis algorithms. However, these models were developed for the analysis of a single data type, i.e. gene expression data. In contrast, our proposed Bayesian sparse factor analysis model, iFad (integrative factor analysis for drug-pathway association inference), is the first effort to bring together two distinct data types in a unified framework to identify drug-target pathways. We propose and implement a modified collapsed Gibbs sampling algorithm for model inference. Our approach can also easily incorporate known pathway information to infer the 'many-to-many' correspondence between the two types of data. Some unique features of our model are (1) joint analysis of distinct data types; (2) a Bayesian framework to integrate prior pathway knowledge and (3) explicit consideration of the sparse nature of the drug-target pathways. Both simulation studies and applications to real NCI-60 datasets show that iFad is a promising approach for drug-target inference. The rest of the article is organized as follows. We detail the modeling assumptions and statistical inferential procedure in Section 2. Simulations and real data analysis are described in Section 3. We conclude the article in Section 4.
METHODS
Model descriptionThis section describes the statistical framework of our proposed Bayesian sparse factor analysis model, iFad and statistical inference of the model parameters. As discussed above, iFad aims to analyze paired gene expression data and drug sensitivity data generated from the same set of samples. We denote the gene expression dataset by matrix Y 1 , with dimension G 1 by J, where G 1 is the number of genes and J is the sample size. The drug sensitivity dataset is denoted by matrix Y 2 , with dimension G 2 by J, where G 2 is the number of drugs. Drug sensitivity is usually quantified as the 'GI 50 ' values, concentrations required to inhibit growth by 50% (). Matrices Y 1 and Y 2 are normalized (scaled to mean 0 and SD 1 for each gene/drug) before analysis. iFad links the two matrices through the activity levels of K biological pathways (e.g. KEGG pathways), which are latent factors in our model.The rationale here is that pathway activities influence both gene expression levels and the sensitivity to drugs targeting these in these pathways. We assume that there is some prior knowledge about the gene-pathway and drug-pathway association relationships, represented by two binary matrices L 1 and L 2 , with dimensions G 1 by K and G 2 by K, respectively, where L 1=1 (or L 2=1) indicates that the gth gene (or drug) is known to be associated with the kth pathway. This information can be retrieved from various pathway databases with different degrees of sensitivity and specificity (). iFad assumes that both matrices Y 1 and Y 2 are related to the common underlying pathway activity matrix X (with dimension K by J) through the following linear models:Matrices W 1 and W 2 are the factor loading matrices describing the regulatory direction (positive or negative) and strength of the pathway activities on the gene expression levels Y 1 and drug sensitivity Y 2. The latent factor activity matrix X is shared between the two feature spaces, namely gene expression data and drug sensitivity data. Each entry in matrix X is assumed to follow a standard normal distribution. 1 and 2 represent the noise term added to gene expression or drug sensitivity, with mean 0 and diagonal covariance matrices 1 and 2. The precision  g1 (for the g 1 th gene) and  g 2 (for the g 2 th drug) are modeled using a Gamma prior with shape parameters  1 ,  2 and rate parameters  1 ,  2. In order to use the prior knowledge on the gene-pathway and drugpathway associations (matrices L 1 and L 2 ), we use the spike-and-slab mixture prior () for the factor loading matrices W 1 and W 2. Although there exist other forms of sparsity-inducing priors (), the spike-and-slab prior has the advantage of easy incorporation of prior information on the connectivity structure of the loading matrix. For both W 1 and W 2 , we put the following prior on each entry:where  0 is the unit point mass at zero (the Dirac delta function) and  g,k denotes the prior probability that W g,k is non-zero. If W g,k is non-zero, it is assumed to follow a normal distribution with mean 0 and precision  w. The precision  w can be either set to a constant or assumed to follow a Gamma prior with parameter ( w ,  w ). Usually, an auxiliary indicator variable Z g,k is used to enable the calculation of posterior probabilities (ashave very similar formats except the subscript, we just listed the general formula here):In this way, prior link matrices L 1 and L 2 are used to induce the sparsity structure of the factor loading matrices W 1 and W 2 in a flexible way, with the strength of guidance tuned conveniently by user-specified parameters  0 and  1. Under this setting, we can derive the prior probability of different components of the model, as well as the complete joint posterior probability (see Supplementary Materials for details). It is worth noting that during the simulation studies in Section 3.1, both matrices Z 1 and Z 2 are unknown and are the target of inference. In contrast, for real data analysis (the NCI-60 dataset) in Section 3.2, since prior information about gene-pathway association structure is available and fairly accurate, the major interest lies in the inference of matrix Z 2 , the drug-pathway association relationships.
Inference algorithmThere are many parameters to estimate for iFad. Gibbs sampling is a widely used technique to approximate the joint distribution through resampling. However, standard Gibbs sampler may have poor mixing due todependence between matrices W and Z makes. Therefore, we used a modified collapsed Gibbs sampling algorithm for model inference as outlined below. Detailed derivations of the posterior conditional distributions are provided in Supplementary Materials. At the end of each sampling iteration, we add a local permutation step (to address the problem of labelswitching, which is also described in Supplementary Materials. We have implemented the above algorithm as the R package 'iFad', which is publicly available on CRAN.
RESULTSWe first tested the performance of iFad using simulated datasets, and then applied the method to real NCI-60 datasets to infer unknown drug-pathway associations.
Simulation studyIn order to assess the performance of our proposed model, we first simulated a series of datasets to investigate the effects of different model parameter settings, as well as the various dataset properties, including sample size and noise level, among other factors.Different Gamma parameters represent different prior belief regarding the distribution of the standard deviation for the noise term/the factor loadings.shows the histogram of 10 000 standard deviation values randomly generated from the Gamma density with four parameter combinations tested (only the values smaller than 3 are plotted here). We first simulated two sets of data to compare the eight combinations of parameter settings, with each dataset consisting of four matrices Y 1 , Y 2 ,  1 and  2 , as shown in. For both datasets, we used  g = 1,  g = 0.01 and  w = 1. For Gibbs sampling, we set the number of iteration to 30 000, with the first half discarded as burn-in period (this was chosen based on the MCMC (Markov chain Monte Carlo) trace plot). To reduce the effect of auto-correlation between adjacent iterations and the data storage burden, we only recorded the Gibbs sampling results every other 10th iteration. We ran five independent chains for Set 1 and three independent chains for Set 2, to check the consistency among multiple independent runs. We used the Area Under Curve (AUC) statistic [area under the receiver-operating characteristic curve (ROC) curve] to assess the inference performance of iFad. For the retained Gibbs samples after the burn-in period, we calculate the mean of each entry of matrices Z 1 and Z 2 , and the ROC curve and AUC values by choosing different cutoffs and comparing the results with the true matrices Z 1 and Z 2. The 'ROCR' package was used for this analysis. For general factor analysis models, there is a scale identifiability problem associated with the loading matrix W and factor matrix X, as after integrating out the latent factors, the complete density of the observed data matrix Y is a normal distribution with covariance matrix W x W + (). In order to avoid this issue, for data simulation, we set matrix x to the identity matrix. We then tested eight combinations of Gamma parameters) on two simulated datasets (as described in). We then asked how the result would be affected if  0 and  1 used for inference are different from that used in simulation. Hence, we chose  0 =  1 = 0.2 for matrix L 1 ,  0 = 0.15,  1 = 0.05 for matrix L 2 and tested the inference algorithm again on dataset 2,which is denoted as 'Set 3'. The results are shown in. The red lines are the proportion of entries in matrix Z that have the same value with matrix L, representing the accuracy of prior knowledge. Comparing the AUC of eight parameter settings, it can be seen that  w = 1 usually gives more consistent result among independent chains than putting a Gamma prior on  w. Nevertheless, it is obvious that  g and  g are the major factors here. Parameter setting 6 ( g = 1,  g = 0.01 and  w = 1) gives best result in this comparison and is used for the remaining analysis in this article. For matrix L 2 in Set 3,  0 = 0.35 during simulation but 0.15 during the Gibbs sampling. We checked the overlap of the inferred non-zero entries of matrix L 2 between Sets 2 and 3 (by using cutoff 0.5 to dichotomize the posterior mean for each entry). For all the eight parameter settings, the non-zero entries inferred using  0 = 0.15 are almost always a subset of those inferred using  0 = 0.35 (as shown in Supplementary).
Data simulation for model parameter selection
Ma and Zhao
Data simulation with various patterns for model performance evaluationAfter determining the appropriate model parameters, we explored how different dataset properties (e.g. sample size, confidence in the prior link matrix L, density of matrix L/Z and noise level) may influence the performance and robustness of the iFad model. Therefore, we simulated five other groups)/SNR = K/SNR. Three independent chains were run for each dataset in Groups 14, with total iteration = 30 000 and the first half as burn-in. Gibbs samples were recorded every 10th iteration. AUC results are shown in. For Group 5, the chain usually converges slower with sample size increasing, so we tried total iteration = 10 000 (burn-in = 8000), 60 000 (burn-in = 40 000) and 100 000 (burn-in = 70 000). The AUC is plotted in.From these five groups of comparisons, it can be observed that((2) iFad performs best when the density of matrices L and Z is around 0.10.3 (Group 2, Sets 2 and 3); too sparse (Group 2, Set 1) or too dense (Group 2, Sets 4 and 5) connectivity structure can hamper the inference result.(3) Imbalanced dimension of the two datasets does not influence the inference result of iFad. All datasets in Group 3 achieved very good AUC statistics.(4) The SNR has an important effect. A large SNR is desired for iFad to perform well (compare Group 4, Sets 13 with Sets 46).(5) When sample size J is smaller than the total number of latent factors K, iFad cannot make accurate inference no matter how long the chain is run (Group 5, Set 1). Nevertheless, J = 30 seems to be adequate for datasets with K = 10 and G 1 = G 2 = 50 (Group 5, Set 2). Increasing sample size can improve the performance of iFad (compare Sets 3 and 4 with Set 2) but requires more iterations of the Gibbs sampling.
Application of iFad: analysis of NCI-60 datasets for drug-pathway association discoveryWe then applied iFad to the joint analysis of gene expression and drug sensitivity profiles of the NCI-60 cell lines. The NCI-60 project represents a comprehensive resource for various types of 'Omics' characterization of 60 human cancer cell lines with nine different tissue types, including RNA expression, DNA fingerprinting, DNA methylation, sequence mutation, as well as treatment response to >100 000 compounds. The gene expression and drug sensitivity data were downloaded from the CellMiner database (), with URL http://discover.nci.nih.gov/cellminer. We used 'RNA: Affy HG-U133 (A,B)' (44 000 probeset 2-chip set, Guanine Cytosine Robust Multi-Array Analysis (GCRMA) normalization) and 'Drug: A4463' for analysis.
Gene data preprocessingWe only used the HG-U133A chip and converted probe expression to gene expression by taking the average of the probes mapped to the same gene, resulting in a total of 12 980 genes measured across 59 cell lines (expression data of the cell line 'LC:NCI_H23' was unavailable). The expression data were then standardized so that for each gene, mean = 0 and SD = 1 across the 59 cell lines. As we are mainly interested in the analysis of drug response-related genes, we only kept genes that are included in either of the following two lists: first, 766 cancer-related genes (); second, 8919 genes from the Integrated Druggable Genome Database Project (), downloaded from http://www.sophicalliance.com/. After this filtering, 6958 genes were retained.
Drug data preprocessingThe drug data are thelog10(GI 50 ) values of Sulforhodamine assay for 4463 molecules (also known as the standard agents) that have known 2D structure and have been tested at-least two times. Higher values equate to higher sensitivity of cell lines. The data are also scaled so that mean = 0 and SD = 1 for each drug. Among these 4463 molecules, we only kept the 101 drugs annotated in the CancerResource database (). Little information is available about the targets or mechanisms of action for the other drugs.
Pathway association informationGene-pathway and drugpathway association data were retrieved from the KEGG MEDICUS database (). The link is http://www.genome.jp/ kegg/catalog/pathway_dd.html. We compiled a list of 58 pathways that are either known to be related to cancer or have drug targets. Among the 6958 genes selected in Section 3.2.1, 1863 genes are covered by these 58 pathways and constitute the final list of genes in our real data analysis. Therefore, matrix L 1 is a binary one with dimension 1863  58, and the dimension of matrix L 2 is 101  58. Our research objective here is to infer unknown drug-pathway associations to help better understand the mechanism of action of less well-studied compounds. We treated the pathway activity levels as latent factors in the iFad model, the gene expression data as matrix Y 1 and drug sensitivity as matrix Y 2. We compiled a list of 58 pathways (Supplementary), 1863 genes and 101 drugs for analysis, as described earlier. Gene expression data are available for 59 cell lines, representing nine different cancer types (Supplementary). Since there are only two cell lines from prostate cancer, we excluded this panel, with eight cancer types remaining for study. iFad was applied to each type, respectively,instead of using all 57 cell lines altogether, in order to avoid potential problems arising from severe cell type heterogeneity (we checked for several well-known genedrug correlations and found that the correlation coefficient is usually much more significant when calculated using cell lines of the same type, rather than all the 57 cell lines). For the NCI-60 analysis, the total iteration was set to 100 000 and burn-in = 70 000. For model parameters, we set  0 =  1 = 0 for matrix  1 , because of high confidence in the gene-pathway association information from KEGG. For matrix  2 , we set  1 = 0 and tried  0 = 0.05, 0.1, 0.15, 0.2, 0.25, in order to infer unknown drug-pathway associations for various densities of matrix Z 2. Based on prior knowledge from the KEGG database, matrix L 1 has a density of 3.95%, whereas L 2 has a density of 0.51%.shows the distribution of the number of genes/drugs associated with each pathway for matrix L 1 /L 2. We compared the distribution of the posterior means of the entries of matrix Z 2 , inferred using different values of  0 , as shown in the histograms of Supplementaryand the quantile plots in Supplementary. As expected, with  0 increasing, the distribution of the posterior mean of Z 2 shifts to the right. For  0 = 0.05, the number of newly inferred non-zero entries in matrix Z 2 is shown inbased on various cutoffs. We took a further look at the results obtained from cutoff = 0.3, because the posterior means of non-zero entries of matrix Z 2 can reach around 0.5 (for more details, see Supplementary) at this cutoff.shows the association pattern in the heatmap. It can be seen that the drug-pathway interaction pattern exhibits strong cell type specificity, demonstrating the importance of conductingshows the total number of drug-pathway associations in barplots. Generally speaking, the cell lines of 'non-small cell lung cancer' and 'melanoma' discovered more novel drug-pathway associations, whereas 'leukemia', central nervous system ('CNS') and 'breast cancer' cell lines inferred fewer new associations. One possible explanation is the difference in sample size: there are nine cell lines for 'non-small cell lung cancer' and 'melanoma', but only six cell lines for 'leukemia', 'CNS' and 'breast cancer'. We then checked whether the newly inferred drug-pathway associations are supported by biological knowledge, based on the CancerResource database () and PubMed. We chose the CancerResource database as a reference because of its comprehensiveness: it integrates drug-target information from several well-known databases, including CTD (), PharmGKB (), TTD (), DrugBank (), as well as its own literature mining. It is worth noting that the current catalog of drug-target information is still far from complete, and the absence of specific drug-pathway associations in one database does not exclude the possibility that the interaction actually exists. Herein, we checked the inferred drug-pathway interactions using cutoff = 0.9 (with the complete list provided in Supplementary) and found that many of these associations can be validated by the CancerResource database (). For the unconfirmed associations, we checked the database CTD and found several additional validations. For example, among the 'colon cancer' cell line panel, drug 'daunorubicin' is associated with pathway'endometrial cancer' with a posterior probability of 0.9547. This association is not documented in the CancerResource database, but can be confirmed by CTD. Although some drug-pathway associations are significant in more than one cell line panels (e.g. 'doxorubicin' acts on the 'thyroid cancer pathway' in both renal and ovarian cancer cell lines), most associations are still context-specific, for instance, 'chlorambucil' is associated with 'melanoma pathway' mainly in melanoma cell lines, with a high posterior probability of 0.947. In contrast, this probability is much smaller in the other cell line panels (). We further investigated the loading matrices W 1 and W 2 for the 'melanoma pathway'. Since there may be sign-flip during the Gibbs sampling iterations, we calculated the posterior mean of the absolute value for each entry of matrices W 1 and W 2 after the burn-in period.shows the heatmap of the estimated loadings of factor 'melanoma pathway' on its associated 63 genes (the left part) andon the 101 drugs (the right part). It can be clearly observed that when the analysis is applied to the ME panel, the factor 'melanoma pathway' has significant loadings on several drugs; however, these drug-pathway associations are much less evident when the analysis was performed on the other cell line types.
Ma and Zhao
DISCUSSIONDrug-target identification is one important problem in translational bioinformatics, as well as a crucial step in the early stage of drug discovery and development. Although there exist many different high-throughput technologies for molecular phenotype profiling, how to perform knowledge-based, informative data integration
Ma and Zhaoremains a major challenge. In this article, we have proposed a Bayesian sparse factor analysis model, iFad, for the joint analysis of gene expression and drug sensitivity profiles measured on the same set of cell lines. The aim is to identify the target biological pathways for drugs with unclear mechanism of action. This model allows natural incorporation of prior knowledge about the connectivity structure of biological pathways (e.g. KEGG pathway), and simultaneously relates the underlying pathway activity to both gene expression levels and drug response. Due to this sparsity formulation, the sample size needed to achieve satisfactory inference result can be much smaller than the number of features in either dataset. We demonstrate the performance of iFad first using simulation and then on the NCI-60 datasets. Real data analysis shows that our method is able to identify many cancer typespecific drug-pathway associations. One direction of great interest for future study is how to speed up the computation process, since MCMC methods are usually time-consuming when applied to high-dimensional inference. Joint modeling of expression profiles and drug-related data represent an increasingly important and popular trend in the future. Besides the bi-clustering method ISA mentioned in Section 1 (), another seminal work in this field () used Bayesian networks to model the genedrug dependency, also on the NCI-60 data. Due to computational constraints of Bayesian network models, extensive feature selection was performed before the network inference. A more recent work () developed a linear regression model that integrates genotype and gene expression data generated under drug-free conditions of yeast segregants to predict the response to various drugs. From a statistical point of view, joint analysis of paired datasets can be achieved using a number of techniques, such as canonical correlation, bipartite graph inference, model-based clustering, etc. With the availability of more and more types of highthroughput datasets from the same panel of samples, novel statistical methods are in great need for knowledge-guided combined analysis. Funding: National Institutes of Health (GM59507 to H.Z.) and NIH R21-GM084008 to Ning Sun.
Conflict of Interest:None declared.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
