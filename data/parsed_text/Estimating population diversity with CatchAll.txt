Motivation: The massive data produced by next-generation sequencing require advanced statistical tools. We address estimating the total diversity or species richness in a population. To date, only relatively simple methods have been implemented in available software. There is a need for software employing modern, computationally intensive statistical analyses including error, goodness-of-fit and robustness assessments. Results: We present CatchAll, a fast, easy-to-use, platform-independent program that computes maximum likelihood estimates for finite-mixture models, weighted linear regression-based analyses and coverage-based non-parametric methods, along with outlier diagnostics. Given sample 'frequency count' data, CatchAll computes 12 different diversity estimates and applies a model-selection algorithm. CatchAll also derives discounted diversity estimates to adjust for possibly uncertain low-frequency counts. It is accompanied by an Excel-based graphics program. Availability: Free executable downloads for Linux, Windows and Mac OS, with manual and source code, at www.northeastern.edu/catchall.
INTRODUCTIONThe field of microbial ecology is bursting with data from nextgeneration sequencing, but analysis remains a challenge. Estimating the diversity of a microbial community is especially important. To model this statistically, assume that the population can be divided into a finite number of classes. The simplest definition of diversity is the number of classes C. A sample drawn from such a population will typically have repeated observations of the various classes: some may be observed once only, others twice and so on, while many classes may not appear in the sample at all. The 'frequency count' data is {(i,f (i)),i  1} where f (i) is the number of sample classes of size i. For example, the dataset {(1,10),(2,4),(3,2),(7,1)} has 10 'singletons', four 'doubletons', ... and one class occurring seven times in the sample. For bacterial and phage diversity, the counts are derived from the frequencies of 16S rRNA genes and contig spectra. * To whom correspondence should be addressed.Statistical estimation of diversity, from frequency count data goes back to 1943 (), but so far only coverage-based non-parametric methods have been implemented in widely available software, because they do not require numerical optimization. We improve upon previous methods by (i) implementing parametric finite-mixture models and a new weighted linear regression approach in addition to existing non-parametric methods; (ii) providing a way to statistically discount large numbers of potentially artifactual rare species; and (iii) applying our analyses to highly diverse phage metagenomes.
METHODSWe introduce CatchAll version 3.0. [A preliminary version, lacking key capabilities presented here, was discussed in (The program computes 12 different diversity estimates with standard errors and goodnessof-fit assessments, at every level of outlier deletion. It proposes a best overall parametric estimate along with a ranked set of alternatives. For cases where low-frequency counts may be erroneous, CatchAll computes a discounted estimate by adjusting the highest diversity component of the selected mixture model. CatchAll is fast, platform-independent, computationally robust, and has both batch and GUI interfaces. An associated Excel spreadsheet automatically produces graphical displays. CatchAll computes three types of analyses.(i) Finite mixture models (). A convex combination of distributions is fitted to the observed count data, yielding a diversity estimate, standard error and goodness-of-fit statistics. Five models are computed: order 0  Poisson; orders 14  mixtures of 14 geometric distributions. Maximum likelihood estimation is done via a nested double expectationmaximization (EM) algorithm. (ii) Weighted linear regression model (). We fit a linear regression model to (i,r(i) := (i+1)f (i+1)/f (i)). The ratio r is a linear function of i under the Poisson and negative binomial models, and can be robust to departures from these. Inherent heteroscedasticity requires weighted regression. (iii) Coverage-based estimates (). These are based on non-parametric adjustments to the sample coverage  the proportion of the population represented in the sample. CatchAll computes Good-Turing and Chao1 as lower bounds; the Abundance-Based Coverage Estimator (ACE) and its high-diversity variant ACE1; and Chao-Bunge, which is optimal under the negative binomial model. Exceptionally abundant classes tend to generate high sample frequencies, which can lead to poor model fit or unstable estimates. As a check, we delete every point above some maximum frequency ; we then compute every analysis at every . For the parametric models, a selection algorithm combines  2 goodness-of-fit tests, AIC and other criteria, to select an optimal model and cutoff : essentially the 'best' selected model admits the largest  while maintaining acceptable AIC-and  2-based goodness-of-fit. For the
J.Bunge et al.WLRM, we select between log-transformed and untransformed versions, and choose maximum feasible . For the non-parametric methods, either ACE or ACE1 is chosen according to the coefficient of variation of the data based on published criteria, at   10. (See user manual for full details.) The best selected analyses, along with close alternatives, and analyses computed at maximum , are presented in the GUI and in a 'Best Models Analysis' file. Complete information is given in 'Analysis' and 'Fits' files. Our selection algorithms provide choices within families of models (parametric, weighted linear regression, coverage-based non-parametric), but do not address choice between families. The user may regard the selected results for the parametric, weighted linear regression and non-parametric methods ('Best', 'WLRM', and 'NonP 2' in) as comparable grosso modo, although their underlying statistical assumptions differ considerably. The final choice of method is at the discretion of the user. In some cases, the sample low-frequency counts may be questionable; for instance, when the counts are based on potentially erroneous DNA sequence matching (). In order to statistically reduce the importance of the low-abundance species in such cases, the best fitted mixture model is computed and its highest diversity component, i.e. the component of the mixture model representing a smoothed version of a proportion of the lowest frequency counts, is deleted. This yields a discounted total diversity estimate (), which is reported in the GUI and the Best Models Analysis file.
EXAMPLEPhage diversity analyses represent a new level of population diversity beyond what is encountered in other areas of microbial ecology. We illustrate the application of CatchAll to a contig spectrum from a swine fecal metagenome (). The contig spectrum was generated using Circonspect via the CAMERA pipeline (). The complete dataset is. CatchAll output (slightly abbreviated here) as displayed in the GUI screen or equivalently in the 'Best Models Analysis' file is shown in. This analysis took 309s in GUI mode on a 3 GHz/8 MB RAM 64 bit notebook PC. Computation time depends on the complexity (in particular, the smoothness) of the frequency count data not the original sample size, because the original sequence data are reduced to frequency counts before analysis. In this case, the best fitted parametric model and its first two alternatives (2a and 2b) are the same, and the third alternative (2c) is very close. The various analyses agree approximately at optimal , with Chao1 serving as a lower bound, while some anomalies are seen at max , as expected; in particular, ACE and ACE1 should only be used for   10, the value of Non-P  max is displayed only for comparative purposes. CatchAll selects the the log-transformed version of the weighted linear regression model at  = 5, still agreeing with the other analyses albeit with a larger SE. This demonstrates the robustness of the WLRM, since it is theoretically optimal for data with lower diversity than our phage example. The best discounted model steps down from a three-to a twocomponent mixture, and reduces the estimated total diversity by 97.4%, from 67 792 (SE 8656) to 1727 (SE 221). At present, there is no formal statistical hypothesis test to select the original versusObs, observed number of species; Est Div, estimated total diversity; SE, standard error; Lwr CB, Upr CB, lower and upper 95% confidence bounds (respectively). Best, 2a, 2b, 2c, top four selected parametric models; WLRM, weighted linear regression model; NonP 1, Chao1; NonP 2, ACE or ACE1 as selected; Parm  max , WLRM  max , Non-P  max , given models at max . See program manual for details. the discounted models, so the choice depends on the investigator's level of confidence in the low-frequency counts. This is a topic of current research.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
