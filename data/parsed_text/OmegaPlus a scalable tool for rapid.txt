Recent advances in sequencing technologies have led to the rapid accumulation of molecular sequence data. Analyzing whole-genome data (as obtained from next-generation sequencers) from intra-species samples allows to detect signatures of positive selection along the genome and therefore identify potentially advantageous genes in the course of the evolution of a population. We introduce OmegaPlus, an open-source tool for rapid detection of selective sweeps in whole-genome data based on linkage disequilibrium. The tool is up to two orders of magnitude faster than existing programs for this purpose and also exhibits up to two orders of magnitude smaller memory requirements. Availability: OmegaPlus is available under GNU GPL at http://www. exelixis-lab.org/software.html.
INTRODUCTIONStatistical tests that rely on selective sweep theory (Maynard) can localize targets of recent and strong positive selection by analyzing single-nucleotide polymorphism (SNP) patterns in intra-species multiple sequence alignments. Nextgeneration sequencing technologies allow for the rapid and cheap extraction of data to assess whole-genome variation in single-species populations. However, applying such statistical tests to wholegenome data is challenging because of increased execution times and memory requirements. Several studies in the last decade have focused on detecting positive selection in genomes from natural populations of individuals. Kim anddeveloped a composite maximum likelihood (ML) framework to detect selective sweeps using the empirical mutation frequencies of polymorphic sites (site frequency spectrum). This approach was later adapted byfor populations that have experienced past demographic changes. Kim andproposed the  statistic to accurately localize selective sweeps and developed a ML framework that uses linkage-disequilibrium (LD) information. In this work, we introduce OmegaPlus, a high-performance implementation of the  statistic. To the best of our knowledge, * To whom correspondence should be addressed.OmegaPlus represents the first scalable  statistic implementation that can be applied to whole-genome data. Previous implementations were not suitable for whole-genome analyses: the implementation byis only suitable for analyses of sub-genomic regions, whereas the implementation byhas excessive memory requirements even for moderate datasets.
THE LD PATTERN OF SELECTIVE SWEEPSThe LD is used to capture the non-random association of alleles or states at different alignment positions. Selective sweep theory predicts a pattern of excessive LD in each of the two alignment regions that flank a recently fixed beneficial mutation. This genomic pattern can be detected by using the  statistic. Assume a genomic region with S SNPs that is split into a left subregion L and a right sub-region R with l and S l SNPs, respectively. The  statistic is computed as follows:where r 2 ij is one common measure of LD that represents the correlation coefficient between sites i and j. Candidate regions for positive selection are characterized by high  statistic values since the average LD is high within the L and R sub-regions but not across the beneficial mutation (see Section 1 in the Supplementary Material).
FEATURESOmegaPlus is an open-source C code for Windows and Linux platforms. We provide a sequential version (OmegaPlus) for Windows and Linux, as well as two parallel versions for Linux that exploit fine-grain (OmegaPlus-F) and coarse-grain (OmegaPlus-C) parallelism (see Sections 26 in the Supplementary Material).
Computational workflowOmegaPlus calculates the  statistic at N distinct positions in the alignment. For each position P, 1P N , let k L and k R be the number of SNPs to the left and to the right of P, respectively, which are contained within a user-defined genomic region G. Thus, a number of k L and k R regions are located to the left and right side of P, each containing a different number of SNPs. The  statistic is computed for all k L k R pairs of sub-regions and the pair for which  statistic has the highest value is reported.
OmegaPlusTo accelerate  statistic calculations, a 2D matrix M , M l,m = li<jm r 2 ij , is calculated for each region G. Thereafter, all sums in Equation (1) are retrieved from M. This avoids redundant calculations and keeps the memory requirements proportional to k 2 , where k is the total number of SNPs in G.
Input/outputOmegaPlus is a command line tool that only requires five input arguments for a typical run: an alignment file (-input), the number P of positions at which the  statistic will be calculated (-grid), a minimum (-minwin) and maximum (-maxwin) size for the L and R sub-regions, and a name for the specific run (-name). Additional command line flags, such as the number of threads (-threads) for the parallel versions, are described in the manual. Binary data (derived/ancestral states) in ms () or MaCS () format and DNA data in FASTA format can be analyzed. For ms and MaCS files, the length of the alignment (-length) also needs to be provided by the user. The program generates three text files: an information file, a warning file and a report file. The information file contains details about program execution, such as the command line and the run time. The warning file reports conflicting SNP positions (SNPs which refer to the same alignment positions) when binary data are analyzed. Finally, the report file provides the highest  statistic value for each position P. A detailed description of the input and output options is provided in the manual.We calculated the  statistic at 10 000 equidistant positions, assuming that the maximum length of the L and R sub-regions to the left and right of a beneficial mutation is 100 000 bp. Thus, a selective sweep may affect at most 200 000 bp in total. The minimum length of L and R is set to 1000 bp. A few entries of the report file are shown below. Each row denotes an alignment position P and the OmegaPlus score. In this example, there is a peak at position 1 079 493.
USAGE EXAMPLE
1.640796 1079493 48.282642 1081734 2.086421The alignment comprised 37 sequences and 22 422 827 sites (339 710 SNPs). To analyze such an alignment, OmegaPlus used less than 2% of the available 4 GBs of main memory. Note that a peak memory requirement of 20.8% was recorded for some seconds to temporarily store the alignment in memory, discard non-polymorphic sites, and compress the remaining SNPs. Using both physical cores on the laptop and hyper-threading (two more virtual cores), the fine-grain version of OmegaPlus required 15 min. Assuming that a selective sweep only affects at most 60 000 bp (-maxwin 30 000) instead of 100 000, the analysis only takes 5 min.
PERFORMANCEAn accuracy evaluation of the  statistic and comparison to SweepFinder () has been presented in. To provide a performance comparison, we generated a simulated dataset with 500 sequences and 70 000 SNPs using Hudson's ms (see Section 5 in the Supplementary Material), and employed a 12-core AMD Opteron CPU running at 2.2 GHz. OmegaPlus analyzed this dataset in 71.8 s occupying 75.8 MBs of main memory, whereas SweepFinder required 783.2 s and 2.7 MBs of main memory. Note, however, that SweepFinder employs the site frequency spectrum and not the  statistic. The  statistic implementation by, which attempts to process the entire alignment at once, required more than 2 days and allocated 30 GBs of main memory. To evaluate the parallel implementations, we generated a dataset with 1000 sequences and 500 000 alignment sites. For this dataset size, fine-grain parallelism scales better on DNA data. Coarse-grain parallelism exhibits similar behavior on both data types and scales better on binary data (see Section 6 in the Supplementary Material).
CONCLUSIONWe presented OmegaPlus to accurately identify selective sweeps in whole-genome data using the  statistic. We intend to further improve the memory requirements as well as to support additional file formats and methods to calculate LD. We also plan to set up a web-server. User support is provided via the OmegaPlus Google group http://groups.google.com/group/omegaplus.
The Author(s) 2012. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
