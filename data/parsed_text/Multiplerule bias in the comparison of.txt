Motivation: There is growing discussion in the bioinformatics community concerning overoptimism of reported results. Two approaches contributing to overoptimism in classification are (i) the reporting of results on datasets for which a proposed classification rule performs well and (ii) the comparison of multiple classification rules on a single dataset that purports to show the advantage of a certain rule. Results: This article provides a careful probabilistic analysis of the second issue and the 'multiple-rule bias', resulting from choosing a classification rule having minimum estimated error on the dataset. It quantifies this bias corresponding to estimating the expected true error of the classification rule possessing minimum estimated error and it characterizes the bias from estimating the true comparative advantage of the chosen classification rule relative to the others by the estimated comparative advantage on the dataset. The analysis is applied to both synthetic and real data using a number of classification rules and error estimators. Availability: We have implemented in C code the synthetic data distribution model, classification rules, feature selection routines and error estimation methods. The code for multiple-rule analysis is implemented in MATLAB. The source code is available at
INTRODUCTIONThree recent articles in Bioiformatics have lamented the difficulty in establishing performance advantages for proposed classification rules (). Two statistically grounded sources of overoptimism have been highlighted. One considers applying a classification rule to numerous datasets and then reporting only the results on the dataset for which the designed classifier possesses the lowest estimated error. The optimistic bias from this kind of dataset picking is quantitatively analyzed in, where it is termed * To whom correspondence should be addressed. 'reporting bias' and where this bias is characterized as a function of the number of considered datasets. A second kind of overoptimism concerns the comparison of a collection of classification rules by applying the classification rules to a dataset and comparing them according to the estimated errors of the designed classifiers. This kind of bias, which we will call 'multiple-rule bias', has been considered in Boulesteix and Strobl (2009) by applying a battery of classification rules to colon cancer and prostate cancer datasets and then examining the effects of choosing classification rules having minimum cross-validation error estimates. Whereas the thrust ofis to compare the sources of multiple-rule bias in classification rules, namely, gene selection, parameter selection and classifier function construction, our interest is in studying multiple-rule bias as a function of the number of rules being considered. In particular, we are interested in the joint distribution, as a function of the number of compared rules, between the minimum estimated error among a collection of classification rules and the true error for the classification rule having minimum estimated error, as well as certain moments associated with this joint distribution. Although different with regard to distributional specifics, this approach is analogous to the approach taken in, where the joint distribution involved the minimum estimated error of the designed classifier over a collection of datasets and the true error of the designed classifier on the population corresponding to the dataset resulting in minimum estimated error. This is a natural way to proceed because any bias ultimately results from inaccuracy in error estimation, so that the behavior of the joint distribution of interest and its moments are consequent to the joint distribution of the error estimator and the true error. Owing to the methodology in, it would have been impossible for them to study this joint distribution because they never concern themselves with true errors, only crossvalidation estimates. Hence, when they compare a minimal error to a baseline error to arrive at a measure of optimistic bias, they are comparing cross-validation estimates. In characterizing multiple-rule bias, we begin with a more general framework than the one just described; rather than simply considering multiple classification rules, we consider multiple classifier rule models, so that there are not only multiple classification rules, but also multiple error estimation rules being employed. We define a classifier rule model as a pair (,), where is a classification rule, including feature selection if feature selection is employed, and is an error estimation rule (). The scenario in the preceding paragraph results where there is only a single error estimation rule.Page: 1676 16751683
M.R.Yousefi et al.
SYSTEMS AND METHODSWe consider r classification rules, 1 ,, 2 ,...,, r , and s error estimation rules, 1 ,, 2 ,...,, s , on a feature-label distribution F. These are combined to form m = rs classifier rule models:Given a random sample S n of size n drawn from F, the classification rules yield r designed classifiers:,2,...,r. The true error of  i is given by  i true = P( i (X) = Y ), where (X,Y ) is a feature-label pair. For j = 1,2,...,s, j provides an error estimate,  i,j est , for  i. Since the classification rules are not identical, neither are the distributions of  1 true , 2 true ,..., r true nor are the distributions of  i,1 est , i,2 est ,..., i,s est. All true-error and estimated-error distributions are functions of the random sample S n. Since all classification rules operate on the same sample, the true errors can be highly correlated, as will be the estimated errors. Without loss of generality, we assume the classifier models are enumerated so thatThe minimum estimated error isLetting i min and j min denote the classifier number and error estimator number, respectively, for which the error estimate is minimum, we have. Suppose a researcher wishes to select the best performing of r classification rules on a feature-label distribution F and proceeds by taking a random sample from F, designing a classifier for each classification rule, and estimating the errors of the designed classifiers. If F is known, then the true error of each designed classifier can be evaluated, the classifier with minimum true error can be chosen, and the classification rule leading to that classifier be declared ' best'. The truly best classification rule has the minimum expected error across all samples from F, so that what is happening is that a single observation of  i true is being used as an estimate for E Sn. On the other hand, if F is unknown as is used in practice, then the errors of the designed classifiers are estimated from sample data and the classification rule leading to the classifier,  i min , with minimum estimated error is chosen as 'best'. We are assuming that the researcher tries s error estimators and selects the one with lowest error estimate. In this case, a single observation of  min est is being used to estimate E Sn, the basic performance measure for i min. At issue is the goodness of this estimation. This involves the distribution of the deviation =  min est E Sn, which is marginal to the joint distribution of ( min est , i min true ). A key performance measure derived from the deviation distribution is the bias of  min est as an estimator ofEstimation is optimistic if Bias(m,n) < 0. This can happen even if none of the error estimation rules are optimistically biased, that is, even if E Sn,...,r and j = 1,2,...,s. Indeed, even if this is so, owing to estimation-rule variance, on any given sample it may be that  min est < 1 true. For instance, if among 1 ,, 2 ,...,, s there is an error estimation rule, such as leave-one-out cross-validation, that is slightly (pessimistically) biased and possesses large variance, then we should expect that E Snand Bias(m,n) < 0. In the way we have set up the general problem, not only can optimistic bias result from considering multiple estimated errors among classifiers but also from applying multiple error estimates for each classifier. From the generic arguments made thus far, we can state two properties concerning the bias. First, as the number m of classifier models grows, the minimum of Equation (1) is taken over more estimated errors, thereby increasing  1 true  min est and |Bias(m,n)|=E Sn. Second, as the sample size n is increased, under the typical condition that the variance of the error estimator decreases with increasing sample size, E Snincreases and |Bias(m,n)| decreases. Bias is only one factor in estimating E Snerror for  min est as an estimator of E SnEven should the bias be small, the estimation will not be accurate if the deviation variance is large. As discussed thus far, the classification rules are fixed; however, since our interest is in the number of classification rules (and error estimators), not any particular rule or estimator, we assume there is a total of R classification rules from which we randomly choose r. This corresponds to a situation where a researcher selects r from among a large collection (R) of potential classification rules and applies s error estimators to each selected rule. Given r, there are R r possible collections of classification rules to be combined with s error estimators to form R r possible collections of classifier rule models of size m. Hence, the number m of classifier rule models increments according to s,2s,...,Rs. We denote the collection of classifier models of size m by m. To get the distribution of errors, one needs to generate independent samples from the same feature-label distribution and apply the procedure shown in. The previously discussed performance measures must be adjusted to take model randomization into account. Given a sample S n , for a realization of m we find an expected deviation according to Equation (2), but now we have a random process generating the realizations so we have to take the expectation over that process to obtain the expected bias,where the subscript indicates the average over m. A similar averaging arises with the deviation variance to yield Var Av (m,n) = E m [Var Sn]. The RMS now takes the formHaving discussed the performance measures relating to estimatingby  min est , we now consider the comparative advantage of the classification rule i min. Its true comparative advantage with respect to the other considered classification rules isIts estimated comparative advantage is given byPage: 1677 16751683
Multiple-rule biasbe the error estimator chosen by a researcher for the sake of consistency). The expectation, E Sn, of this distribution gives the mean estimated comparative advantage of i min with respect to the collection. A key bias to be considered is C bias = E Sn
Simulation designWe use a general model based on multivariate Gaussian distributions with a blocked covariance structure that conforms to various observations made in microarray expression-based studies (). A battery of distribution models can be constructed by changing model parameters to generate different synthetic data samples. We also consider four real datasets.
Synthetic dataIn microarray studies, assuming a blocked covariance matrix is a way of modeling groups of interacting genes where there is negligible interaction between the groups. It has been used in genomic classification to model genes collected into distinct pathways, each pathway being represented by a block (can be different, and that has the following block structure:where  is a l l matrix, with 1 on the diagonal and  off the diagonal. In the block-based covariance structure, the markers are divided into equalsize blocks of size l. Markers of different blocks are uncorrelated, while all the markers in the same block are correlated to each other with correlation coefficient . A consequence of having unequal variances and subclasses in the classconditional distributions is to introduce non-linearities in the decision boundaries for the model, where less global markers and larger difference in the variances lead to a more non-linear decision boundary. Because the global markers and the heterogeneous markers possess the same structure, we can assume the same mean vectors { 0 , 1 } for both groups,}, as we did for the covariance matrices. Furthermore, we use the same structure for  0 and  1 in the form of m 0 (1,1,...,1) and,...,1), respectively, where m 0 and m 1 are scalars (). Similar to the global markers, there are two types of non-markers: highvariance and low-variance non-markers. The D hv features belonging to the former group are uncorrelated and their distributions are described by pN(m 0 , 2 0 )+(1p)N(m 1 , 2 1 ), where m 0 , m 1 ,  2 0 and  2 1 take values equal to the means and variances of the markers, respectively, and p is a random value uniformly distributed over. The D lv remaining features are uncorrelated low-variance non-markers, each having a Gaussian distribution with parameters (m 0 , 2 0 ). A typical microarray experiment usually contains tens of thousands of probes (genes) but a small number of sample points, typically less than 200. We choose the total number of features to be D = 20 000 and the number of sample points to be 60 and 120. Two variance settings are considered: equal variances { 2the blocked covariance matrix, we choose block size l = 5 and correlation coefficient  = 0.8, giving relatively tight correlation within a block, which would be expected for a pathway. We do not choose model parameters in accordance with the Bayes errors or the estimated errors; rather, we choose them in accordance with achievable true errors seen in real problems.shows the parameters of the distribution models used in this study. Seefor more details about the choice of parameters.
Real dataThis study uses four real datasets from microarray experiments consisting of more than 150 arrays: pediatric acute lymphoblastic leukemia (ALL) (), multiple myeloma (), hepatocellular carcinoma (HCC) () and drugs and toxicants response on rats dataset (). We use n = 60 sample points for training. The remaining sample points are held-out for computing the true error. To the extent possible, we try to maintain the original labeling and follow the data preparation directions used in the papers reporting these datasets.shows a summary of the four real datasets. Full descriptions are presented in the Supplementary Materials.
Page: 1678 16751683
M.R.Yousefi et al.
Classification schemesSix classification rules are considered: 3-nearest neighbors (3NN), linear discriminant analysis (LDA), diagonal LDA (DLDA), nearest-mean classifier (NMC), linear support vector machine (L-SVM) and radial basis function SVM (RBF-SVM). Two different feature selection methods are considered: t-test and t-test followed by sequential forward search (t-test + SFS). Onestage feature selection uses the t-test and five features are selected. For two-stage feature selection, the number of features is reduced to 500 in the first stage (t-test) and then to 5 by SFS. Three cross-validation error estimation methods are considered: 5-fold, 10-fold and leave-one-out (LOO). Combining six classification rules with two feature selection methods results in R = 12 classification rules from which we randomly choose r = 1,2,...,R and design the classifiers on one sample. Note that with three error estimators, there is a maximum of 36 different classifier rule models.lists the classification rules, feature selection methods and error estimation procedures utilized. To illustrate the definitions, let us suppose we are only considering two classification rules, LDA and 3NN, without feature selection and two error estimators, LOO and CV5 (5-fold cross-validation). LDA is based on the discriminant for the optimal classifier in a Gaussian model (Gaussian classconditional densities) with common covariance matrix by plugging the sample means and pooled sample covariance matrix obtained from the data into the discriminant. Assuming equally likely classes, LDA assigns x to class 1 if and only ifwhere  x u is the sample mean for class u, u = 0,1, and is the pooled sample covariance matrix. While derived under the Gaussian assumption with common covariance matrix, LDA can provide good results when these assumptions are mildly violated. For the 3NN rule, the designed classifier is defined to be 0 or 1 at x according to which is the majority among the labels of the 3 points closest to x. In k-fold cross-validation, the given sample S n is randomly partitioned into k folds (subsets) S (i) , for i = 1,2,...,k. Each fold is left out of the design process, a (surrogate) classifier,  n,i , is designed on S n S (i) , the error of  n,i is estimated as the counting error  n,i makes on S (i) , and the crossvalidation estimate is the average error committed on all folds. If there is feature selection, then it must be redone for every fold because it is part of the classification rule. In leave-one-out cross-validation, each fold consists of a single point. Owing to computational requirements, k-fold cross-validation, k < n, usually involves a random selection of partitions. In general, the bias of cross-validation is typically slightly pessimistic, provided that the number of folds is not too small. The problem with cross-validation is that it tends to be inaccurate for small samples because, for these, it has large variance (Braga) and is poorly correlated with the true error (). For all error estimators, there is variation resulting from the sampling process. For randomized cross-validation, a second variance contribution, referred to as 'internal variance', arises from the random selection of the partitions (see). The latter does not apply to LOO because only a single set of folds is possible. Relative to the definitions in the Section 2, if we let 1 be LDA, 2 be 3NN, 1 be LOO and 2 be CV5, then there are four classifier rule models:
ImplementationThe raw output of the synthetic data simulation consists of the true and estimated error pairs resulting from applying the 36 different classification schemes on 10 000 independent random samples drawn from the aforementioned four different distribution models. We approximate the expected true error by taking the average of true errors of each classification rule over the samples. We generate all R r possible collections of classification rules of size r, each associated with s error estimation rules, resulting in R r collections of classifier rule models of size m. For each collection, we find the true and estimated error pairs from the raw output data. Then, for each sample, we find the classifier model (including the classification and error estimation rules) in the collection that gives the minimum estimated error. We record the estimated error, its corresponding true error and the classification and error estimation rules. Given the collection, m , we compute and A est for each sample. Then, we approximate E Snand A true | m , by taking the average over all the samples. Finally, weby taking the average over the generated collections. Real data simulations differ somewhat from the synthetic data in the way that the true and estimated errors are computed. For the synthetic data, we generate 10 000 pairs of samples (training set of size 60 or 120 and test set of size 5000) from the assumed distribution model. But for a real dataset, we randomly pick 60 sample points for training (classifier design and error estimation). The remaining held-out sample points are used to calculate the true error. We repeat this process 10 000 times.
RESULTS AND DISCUSSIONThe full set of results appears in the Supplementary Material. In the article, we provide representative examples for each issue. We consider two cases regarding the error estimators: multiple error estimators and a single error estimator. For multiple error estimators, s = 3, we consider all three error estimators at once, and m = 3,6,...,36. For a single error estimator, s = 1, we have three difference cases, depending on which error estimator is used, and m = 1,2,...,12 for each error estimator. For s = 3, keep in mind that the simulations are incremented in steps of three, 3,6,...,36, because each classification rule is evaluated with all three error estimators, as would be the case in practice if an investigator were to consider three error estimators. For a single error estimator, we show LOO in the article and leave the others to the Supplementary Material.
Joint distributionsFor the synthetic data, the joint distributions are estimated with a bivariate Gaussian-kernel density estimation method. The first set of results (Supplementary Figures s1s16) show joint distributions between the minimum estimated errors and their corresponding true errors,  min est and  i min true , for multiple and single error estimators, different sample sizes and variances. Each plot includes the regression line and a small circle showing the pair of sample means. As m increases, the distributions tend to be more circular (indicating less correlation) and also more compact (indicating smaller variance). Furthermore, as m increases, the distributions Page: 1679 16751683i min true with respect to the collection size m, for all classifier rule models for m = 6,21,36 (left column) and for single LOO error estimation for m = 2,7,12 (right column). The real dataset is multiple myeloma by. The white line shows the regression line and the circle indicates the sample mean of the joint distribution. move to the left, thereby demonstrating greater bias. Note the smaller variation for sample size 120. For the real data, the joint distributions are again estimated with a bivariate Gaussian-kernel density estimation method. Supplementary Figures s25s40 show the joint distribution of ( min est , i min true ) for multiple and single error estimators, and for different real datasets.shows the distributions and regression lines for the myeloma data: the left column is for multiple error estimators and shows m = 6,21,36; the right column is for the single error estimator LOO and shows m = 2,7,12. Similar to the synthetic data, as m increases, the distributions tend to be more circular, have smaller variances and move to the left. What is most striking is the absence of regression between  min est and  i min true. This lack of regression is consistent with what has been observed in other settings when cross-validation is used to estimate the true error ().
Multiple-rule bias
Moments and comparative performanceFor the synthetic data and the multiple error estimator case,shows: (a) the expected bias, Bias Av ; (b) the expected variance,Var Av ; (c) the expected RMS, RMS Av ; and (d) the expected comparative performance bias, C bias. Note thatdoes not graph m = s because the comparative advantages are not defined when r = 1. The same applies for analogous subfigures in the rest of the article. For increasing m, the bias and RMS get worse, but even with m = 3, the RMS is about 0.1 for sample size 60. For this sample size and m = 36, the comparative-performance bias has reached 0.1.shows corresponding results for a single error estimator, LOO. These too are especially alarming for n = 60. Note that the RMS, actually, has a temporary small dip at m = 2, which is a result of steep decline in variance between m = 1 and m = 2. For the real data, Figures 5 and 6 show corresponding results to Figures 3 and 4, respectively (ignore for the moment the 'average' curves, which will soon be discussed). Note the widely different behaviors between the different datasets. Since we are using the full dataset as an empirical distribution to serve as an approximation of the underlying feature-label distribution and are sampling from the empirical distribution, the different biases result from different behaviors of the error estimators on the different distributions. In practice, given a single sample dataset, one would have no idea of what kind of biases and RMS deviations to expect. This uncertainty exemplifies the standard conundrum faced when one lacks prior information regarding the feature-label distribution. In our case, the problem is that error estimator performance is heavily dependent on the underlying feature-label distribution.
Page: 1680 16751683
M.R.Yousefi et al.: resulted from the distributions of  min est and  i min true on the synthetic data for single LOO error estimation, with respect to the collection size m.
Averaging over different populationsThe problem of multiple-rule bias is exacerbated if one combines it with applying the multiple rules across multiple datasets () and then minimizes over both the classifier models and datasets; however, using multiple datasets can mitigate multiple-rule bias if performances are averaged over the datasets. In this case, each dataset is a sample from a feature-label distribution F k , k = 1,2,...,K, and our concern is with average performance over the K feature-label distributions. Assuming multiple error estimators, there are m classification rules being considered over the K feature-label distributions. Our interest is now withwhere  i,j,k est is the estimated error of classifier  i and the error estimation rule j on the dataset from feature-label distribution F k. The bias takes the formwhere  i min ,k true is the true error of classifier  i min on the dataset from feature-label distribution F k .The 'average' curves inand 6 illustrate the effects of averaging. They show less estimation bias, less variance, smaller RMS and less comparative-performance bias when averaging is employed, as opposed to using the datasets individually. The situation is similar, albeit a bit more complicated, than the argument infor averaging results over a large number of datasets. Here, the averaging is done to mitigate multiple-rule bias. It is possible to obtain theoretical results regarding the effect of averaging on the bias of Equation (10). In particular, if all error estimators are unbiased, then we prove in the Appendix A that lim K B(m,n,K) = 0. If one looks closely at the proof, it is clear that the unbiasedness assumption can be relaxed in each of the lemmas. In the first lemma, which shows that B(m,n,K)  0, we need only assume that none of the error estimators is pessimistically biased. In the second lemma, which shows that lim K B(m,n,K)  0, unbiasedness can be relaxed to weaker conditions regarding the expectations of the terms making up the minimum in Equation (9); however, these conditions are rather arcane and do not add much practical insight. Moreover, we are interested in close-to-unbiased error estimators, specifically, the cross-validation estimators, so that we can expect |B(m,n,K)| to diminish with averaging, even if the limit of B(m,n,K) does not actually converge to 0.
Concluding remarksFrom a practical standpoint, the results obtained in the present paper quantitatively demonstrate the large degree of overoptimism that results from comparing classifier rule models via their performances on a small dataset owing to the inaccuracy of error estimation on Page: 1681 16751683
Multiple-rule bias: resulted from the distributions of  min est and  i min true on the real data for single LOO error estimation, with respect to the collection size m. small samples. As the array of simulations show, optimistic bias accrues rapidly with even a small number of models being compared. We have observed from both simulations and theoretical analysis that the problem can be mitigated by averaging performances across a family of datasets; indeed, this is the recommendation that we put forth. The downside is that averaging eliminates the possibility of comparing classification rule performances on a single population. In fact, the latter possibility has been precluded at the outset by the experimental design: too small of a sample to obtain accurate error estimates. If there is only a single small sample, then the multiplerule bias precludes any conclusions whatsoever, whereas at least if a collection of datasets are employed, then one may be able to make a conclusion relative to the collection of populations (depending on the accuracy of the error estimator). Even with averaging, we must offer a word of caution. While the proposition we have proven regarding the convergence of B(m,n,K) is promising, like most distributionfree results it leaves open the rate of convergence, which in practice determines the number of datasets one must utilize to reduce the bias to some predetermined level. This leads us to some final comments. The concerns expressed regarding the difficulty of establishing performance advantages for proposed classification rules () reflect fundamental epistemological issues confronting bioinformatics as it addresses the high-throughput environment with limited sample sizes and limited statistical knowledge of how to deal with this new world (). The problem addressed in this article arises from the bias and variance, and therefore the RMS, of error estimators. Very little is known about the performance of common error estimators, in particular, cross-validation. To take a salient example: LOO. Prior to 2009, all that was known about LOO for LDA and Gaussian class-conditional distributions were asymptotic expressions for the expectation and variance of the estimator in one dimension (). In 2009, the distribution of the LOO estimator was discovered in this model for an arbitrary dimension m without assuming a common variance for m = 1 and assuming a common covariance matrix with m > 1 (). Still, none of these results treated the joint distribution of the estimated and true errors, nor, in particular, the RMS. In 2010, the joint distribution was found exactly for m = 1 without assuming a common variance and an approximation was found for m > 1 assuming a common covariance matrix (). Besides the joint distribution via complete enumeration () and the correlation (Braga) for multinomial discrimination, there are no other analytic results regarding the joint behavior of LOO with the true error. This dearth of results is striking considering that LOO was first proposed in 1968 (), it has been used extensively, and the variance problems of LOO have been known from at least 1978 (). As for more complicated cross-validation estimators that require random resampling, essentially nothing is known. If lamentations regarding the lack of performance characterization in bioinformatics are to be abated, then much greater knowledge regarding error estimation must be discovered.
APPENDIX AWe prove that if all error estimators are unbiased, then,...,K is a random sample taken from the distribution F k for k = 1,2,...,K. Also, we can rewrite Equation (9) aswhere i = 1,2,...,r and j = 1,2,...,s. Owing to the unbiasedness of the error estimators,. Referring to Equations (10) and (A.1), we have B(m,n,K)where the relations in the third and sixth lines result from Jensen's inequality and unbiasedness of the error estimators, respectively.
Lemma A.2. If all error estimators are unbiased, thenOwing to the unbiasedness of the error estimators,Without loss of generality, we assume T 1  T 2  ...  T r. To avoid cumbersome notation, we will further assume that T 1 < T 2 (with some adaptation, the proof goes through without this assumption). Let 2 = T 2 T 1 andPage: 1683 16751683
Multiple-rule biasAgain referring to Equation (10) and recognizing thatSince  and  are arbitrary positive numbers, this implies that for any >0, there exists K  such that K  K  implies lim K B(m,n,K)  0, which is precisely what we want to prove. Combining Lemmas A.1 and A.2, we have proven that lim K B(m,n,K) = 0 under the assumption that all the error estimators are unbiased.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
r 1  i =i min  i,j min est , (7) where we use the error estimator associated with the pair (i min ,j min ) for which the minimum estimated error is obtained (assuming that this would
