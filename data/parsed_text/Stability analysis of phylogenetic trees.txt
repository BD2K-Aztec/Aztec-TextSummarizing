Motivation: Phylogenetics, or reconstructing the evolutionary relationships of organisms, is critical for understanding evolution. A large number of heuristic algorithms for phylogenetics have been developed , some of which enable estimates of trees with tens of thousands of taxa. Such trees may not be robust, as small changes in the input data can cause major differences in the optimal topology. Tools that can assess the quality and stability of phylogenetic tree estimates and identify the most reliable parts of the tree are needed. Results: We define measures that assess the stability of trees, sub-trees and individual taxa with respect to changes in the input sequences. Our measures consider changes at the finest granularity in the input data (i.e. individual nucleotides). We demonstrate the effectiveness of our measures on large published datasets. Our measures are computationally feasible for phylogenetic datasets consisting of tens of thousands of taxa. Availability: This software is available at http://bioinformatics.
INTRODUCTIONPhylogenetics, or reconstructing the evolutionary history of organisms, is important for many areas of biological research. Rapid increases in the amount of available sequence data and computational advances have enabled construction of phylogenetic trees with tens of thousands of species (e.g.). However, it often is difficult to assess the quality and reliability of large phylogenetic trees. An ideal method for assessing tree quality should be computationally tractable for extremely large datasets, quantify the confidence in relationships within the tree and compare the quality of the best tree to alternate trees. In this article, we describe a novel method for computing the stability of phylogenetic trees. We say that a tree is stable if its topology is largely robust to small changes in the input data used to infer the tree. Conversely, unstable trees may be subject to major structural changes with only a few alterations in the input data. Often the quality of trees is determined using nodal support measures, such as non-parametric bootstrapping (), jackknifing (), relative support () or Bayesian posterior probabilities (). These methods assess a large number of trees that represent a range of possible solutions. Perhaps, the most commonly used method is the non-parametric bootstrapping (). This method builds a collection of trees from pseudoreplicate datasets obtained by sampling with replacement from the original dataset. Because the phylogenetic analysis has to be repeated for each bootstrap replicate, it can be computationally expensive for large datasets; bootstrap analysis of tens of thousands of sequences can take years of processing time (). Also, the bootstrap methods consider only a few of the possible alterations in the input data. The Bremer support or decay index () measures, for all groups in the tree, the minimum number of additional parsimony steps needed to find a tree without that group. This is similar to a stability measure. However, it does not examine how similar the alternate suboptimal topologies are to the original tree. Several recent methods () seek to identify 'rogue taxa' (), or taxa that cannot be placed reliably anywhere in the tree. The issue of stability of phylogenetic trees has been proposed in the past (). In other areas of research, 'what-if' analyses have been discussed under the name of 'post-optimality analysis' or 'sensitivity analysis' (see). In this article, we describe a framework of phylogenetic stability measures based on sensitivity and post-optimality analysis. Our methods measure stability of trees with respect to the input data, allowing the data from each taxon to be modified independently. Our framework provides a measure of the minimum change in the input sequences that are required to alter significantly the topology of a given phylogenetic tree. Thus, they assess if and how much a particular tree relies on the accuracy of a small number of character states. The more changes in input data required to alter a tree significantly, the more stable the tree is. Further, nodal measures developed within this framework can be computed quickly. We demonstrate that our stability measures provide a new computationally feasible perspective on the quality of large phylogenetic trees. The main contributions of this work are as follows:(1) We present an original framework for assessing the stability of phylogenetic trees and define several measures of stability. These measures capture information about stability of trees relative to changes in the input data.(2) We apply our stability measures to published datasets. In these examples, we identify unstable subtrees and discuss why they are unstable. *To whom correspondence should be addressed.Background and preliminary information is presented in Section 2. We then formally define the notions of stability and discuss their relevance in Section 3. In Section 4, we discuss how data obtained from stability measures can be used to analyse subtrees. The computational challenges for computing stability and our solutions to them are described in Section 5. We present experimental results in Section 6 and finally conclude in Section 7.
BACKGROUNDIn this section, we present the basic definitions necessary to understand this study. We first describe the notation for sequences and trees (Section 2.1) followed by commonly used optimality criteria for trees (Section 2.2). Finally we present the framework for our stability measures (Section 2.3).
Sequences and treesThe goal of phylogenetics is to infer evolutionary relationships for a set of taxa. Each taxon is typically represented using a sequence, and the phylogenetic tree describes the evolutionary relationship between different sequences. Let S  fs 1 , s 2 ,. .. , s n g be the set of sequences on which the phylogenetic tree, denoted by T, is built. Each leaf node of T corresponds to a sequence in S. For example, S shown incan be used to construct a parsimony-based tree T a shown in. To reconstruct a phylogenetic tree, the input sequences are aligned with each other in a multiple sequence alignment such that each column in the alignment represents a homologous character. In this article, we assume that a multiple sequence alignment and a phylogenetic tree corresponding to this alignment are available.
Tree measuresPhylogenetic trees are generally inferred based on an optimality criterion. Two commonly used criteria are maximum parsimony and maximum likelihood. The parsimony score is the minimum number of character changes implied by a tree given a multiple sequence alignment. A smaller parsimony score indicates a better tree. Parsimonybased methods count the total number of substitutions in the tree by summing the substitutions between sequences of every pair of adjacent nodes. Sequences for internal nodes may be reconstructed using algorithms such as the Sankoff algorithm ().
Framework for confidence measuresOur framework for measuring the stability of tree requires computing two types of functions:(1) A function "() that measures the amount of change made to the input sequences(2) A function () that measures the amount of change in the resulting tree It is possible to compute either function using a variety of metrics. In the analysis performed in this article, we use the edit distance and the RobinsonFoulds (RF) distance (), as "() and (), respectively. An edit operation on a sequence replaces an existing character with a new one, inserts a new character or deletes an existing one. The edit distance between two sequences is the number of edit operations needed to convert one of the sequences to the other. We denote the edit distance between two sequences s a and s b by "(s a ,s b ) or " a,b. In this article, we use an edit distance based on changing individual sites, which mimics the effects of errors that may emerge from modern sequencing techniques. Note that we could have defined an edit distance based on removing and replicating entire columns in the sequence alignment. This would be a special case of editing each sequence independently. For the tree distance, let T be a rooted tree defined on a set of sequences S. Now, for every internal node n, there exists a set of leaf nodes. These leaf nodes compose a clade. Let  T be the set of all clades in T. The RF distance between two trees T 1 and T 2 is the number of clades they do not have in common  T1   T2  [  T2   T1 . For example, in, the RF distance between T a and T b is two. Note that trees do not need to be rooted for the stability measures. However, we assume they are rooted as it enables efficient computation of ancestral sequences. Again, a large number of measures can be used for either of the functions. For example, we can use a likelihood model to measure the distances between sequences, and a weighted RF for the tree distance. However, to emphasize stability, rather than the specific measures we choose for these functions, we use two commonly used and intuitive measures.
STABILITYWe define the stability measures for a tree in Section 3.1. In Section 3.2, we define stability measures that work at a node
Tree measuresWe define two measures that capture the stability of the entire dataset. First, we define a measure that captures the minimum change in input (sequences) necessary to cause a major change in the output (tree topology). To define this, a threshold of similarity in tree topology (R) must be defined to identify when the tree topology has changed significantly.Definition 1. Let T 1 and S 1  fs 1 , s 2 ,. .. , s n g be a phylogenetic tree and its set of taxa sequences (s i ), respectively. Let S 2  fs 0 1 , s 0 2 ,. .. , s 0 n g be the set of sequences where s 0 i for each i 2 f1. .. ng is obtained by editing s i. Let ES 1 , S 2  be the total number of edit operations necessary to transform S 1 to S 2 : ES 1 , S 2   AE i "s i , s 0 i . Let T 2 be the optimal phylogenetic tree for S 2 under the same evolutionary model as T 1. Given a tree distance threshold R, we define the edit distance stability (EDS) of S 1 , T 1 , R as the minimum value of ES 1 , S 2  necessary such that T 1 , T 2  ! R. Formally:This measure captures exactly the amount of sequence editing it takes to make the given tree 'unstable' with respect to an edit distance threshold. Thus, it provides a guarantee on the amount changes in the data that will not significantly change the tree. For example, the tree T a inhas an edit distance stability of zero with respect to a tree threshold of one because T b is an alternate tree with same parsimony score. However, this is a very low threshold. With a threshold of two, the stability is higher because it requires more editing to make a larger change in the tree. We now define a measure that captures the maximum change in the tree possible if we are allowed to edit the input sequences by a specified amount. To define this, a threshold of editing (E) must be defined to limit the number of changes in the sequences.Definition 2. Let T 1 and S 1  fs 1 , s 2 ,. .. , s n g be a phylogenetic tree and its set of taxa sequences (s i ), respectively. Let ES 1 , S 2  be the total number of edit operations necessary to transform S 1 to S 2. Let T 2 be the optimal phylogenetic tree for S 2 under the same evolutionary model as T 1. Given an edit distance threshold E, we define the tree distance stability (T DS) of S 1 , T 1 , E as the maximum value of T 1 , T 2  necessary such that ES 1 , S 2  E. Formally:This measure captures exactly the maximum change in the tree possible given a threshold to editing. For example, the tree T a inhas a tree distance stability of one with respect to an edit distance threshold of zero because T b is an alternate tree with same parsimony score. Both of these measures provide explicit guarantees on the stability of the given combination of sequences, model and tree. They also pose challenging optimization problems due to the vast search space of trees. We believe these to be at least as hard as reconstructing a tree.
Node stability measuresThe edit distance and tree distance stability defined in Section 3.1 describe the stability of a given phylogenetic tree from two points of view. However, computing these measures is non-trivial due to the number of combinations of possible edits and resulting trees. Moreover, these definitions fail to capture the overall stability of subtrees and taxa. For example, Definitions 1 and 2 cannot distinguish between T a and T b in. Next, we define two confidence measures that address these problems. These measures focus on modifying individual taxa. As we discuss in Section 4, we also extend the notion to internal nodes by using reconstructed sequences and treating them as taxa. Thus, we use the terms node and taxon interchangeably to define our measures. We compute these measures by comparing (see) each node x and make it a sibling of every other node y that is not a descendant of x. For each pair, we compute: (i) how much editing is required to make x the nearest node, in terms of edit distance, to y; (ii) the distance of the tree from the original tree. In this article, we use the term move to refer editing the sequence of the node x so that it becomes the node with the sequence closest to that of y. Topologically, x is moved to a location sister to y. This moving is commonly referred to as Subtree Pruning and Regrafting (SPR). Trees obtained through this move are within one SPR distance of the original tree. While editing a sequence to make it closer to another one affects the alignment, we assume that the effect is small. Similarly, we assume moving a node does not affect the entire tree. Section 5.1 discusses these assumptions in detail. To compute ancestral sequences, we assume all trees are rooted. Next, we define a measure that captures the minimum amount of editing necessary to any one sequence in the input sequences to transform the output tree significantly. Definition 3. Let T 1 and S 1  fs 1 , s 2 ,. .. , s 2n1 g be a phylogenetic tree and its set of sequences, including the taxa and the inferred ancestral sequences, (s i ), respectively. Let T 2 be the phylogenetic tree formed by removing x  s i from its original location in T 1 and moving it to the sibling position of another node y  s j 2 T 1 by updating s i. Let us denote the updated sequence s i with s 0 i to make this move. We define the minimum edit per tree distance (s) to be the minimum edit distance between s i and s 0 i such that T 1 , T 2  ! R. Formally:This measure (Definition 3) is similar to the original measure in Definition 1. The key difference is that changes in the input are now restricted to one taxon. This provides an explicit guarantee for how different one of the original sequences must be for the tree to change more than a given RF threshold within one subtree prune and regrafting (SPR) distance. We now define a measure that captures the maximum change in the phylogenetic tree possible when editing is allowed on only one taxon. Definition 4. Let T 1 and S 1  fs 1 , s 2 ,. .. , s 2n1 g be a phylogenetic tree and its set of sequences, including taxa and inferred ancestral sequences, (s i ), respectively. Let T 2 be the phylogenetic tree formed by removing x  s i from its original location in T 1 and moving it to the sibling position close to another node y  s j 2 T 1 by updating s i. Let us denote the updated sequence s i with s 0 i to make this move. We define maximum tree distance per edit as the maximum value of T 1 ,The maximum RF distance per edit distance provides an explicit guarantee on how far a node may move in the input tree within one SPR distance given a tolerance for errors. Thus, this measure highlights the sequences that are more easily moved and therefore need closer inspection. Because the sequence length varies greatly in large-scale analyses, this measure can easily be adjusted to accommodate a percentage of the sequence length rather than the actual sequence. Definition 5. Let T 1 and S 1  fs 1 , s 2 ,. .. , s 2n1 g be a phylogenetic tree and its set of sequences, including taxa and inferred ancestral sequences, (s i ), respectively. Let x be a node in T 1 such that its sequence, reconstructed or given, is s i. Let T 2 be the phylogenetic tree formed by removing x  s i from its original location and moving it to the sibling position of another node y  s j 2 T 1 by updating s i. Let us denote the updated sequence s i with s 0 i to make this move. We say that a node is considered movable if "s i , s 0 i  E and T 1 , T 2  ! R. Definition 5 describes the nodes in the given tree that can be moved by editing sequences. Given thresholds for both RF and edit distance, the number of movable nodes summarizes the stability of the tree. If this number is high, it means that a large number of taxa could potentially be placed in a different part of the tree. In this case, the given tree is not stable. Next, we examine a small example in detail and discuss how these measures may be used.
Application and examplesWe demonstrate the newly defined measures using the example inand 2. We also compare these measures with the bootstrap support and parsimony scores. We first consider a set of sequences () in S 1 for which two equally parsimonious trees may be constructed: T a and T b (using DNAPARS/PHYLIP 3.6 (). RAxML () identifies T b as the maximum likelihood tree. Because the two trees have the same parsimony score, the parsimony objective cannot differentiate between these two trees. Also, both trees have the same maximum parsimony and bootstrap scores. The stability measures described above suggest that T b is more stable than T a. This is because editing up to two positions affects T a , but it does not T b. The same threshold of editing allows for more of change in T a than T b. This does not necessarily mean that T b is right and T a is wrong, but it suggests that T b is more robust to potential errors or changes in the data. r also provides an explicit guarantee that the maximum change that can be caused by editing up to three nucleotides in T b is RF  2 within 1 SPR distance. Thus, the stability measures elucidate the parts of the tree that are the least stable (leaves C and D) and the overall stability of different trees. Importantly, this is done by evaluating the underlying primary data (the sequence alignment). An important advantage of the measures introduced in Section 3.2 is that they can be used to rank the nodes. We can also create a ranking of nodes at each edit distance using r, e.g. ranking in a ascending order of instability for E  6 in T a : 4  E, 3  fC, Gg, 2  fD, B, Ag, 1  F. Such a ranking can help prioritize areas in the tree that need further phylogenetic research. An important question arising at this point is how high a value of " or is too high? To address this question, we propose statistical methods for assessing the stability of clades in the next section. We also discuss this question in Section 7.
ANALYSIS OF SUBTREESUnlike the leaf level taxa, moving an internal node of the tree moves the entire clade under it. In this section, we describe how we analysed subtrees, or internal nodes, to evaluate their stability using sequences of the taxa under them. We analyse internal nodes by looking at the leaf nodes underneath them and counting the number of movable nodes. We use a normal approximation to the binomial distribution to compute a z-score for each subtree in the following fashion.Let N be the total number of leaf nodes and let K be the number of movable leaf nodes in the tree. The probability of any given leaf node being movable is K N , and the expected number of movable nodes in a subtree of size n is Kn N. The standard deviation, using the approximation, is ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi ffi n: Kn N :1  Kn N  q . Finally, the z-score for a subtree with k movable nodes, derived using the approximation, is defined as. Note that the scores of the related internal nodes are correlated as a parent summarizes its children's scores. For instance, the number and/ or ratio of movable sequences underneath an internal node indicates the weakness (or strength) of the clade. To use this information further, we sort the internal nodes in a descending order of their z-score. This ranking identifies the least stable subtrees. We also checked the correlation of z-score with the average sequence length, i.e. whether the relatively longer sequences were more stable. Overall, we observed little correlation with the exception of extremely long or short sequences. We also computed the correlation between z-score and the presence of particular taxonomic families (or any taxonomic group) or genes in the underlying sequence alignment. Let the number of taxa in the tree be N. For each taxonomic family F i , the number of nodes in the tree classified as that family are M i. Let the number of nodes classified with family F i in a given subtree x, with n taxa, be m i. We compute the probability of observing at least m i members from family F i using the hypergeometric distribution as follows:We report the negative logarithm of this probability as the enrichment of family in that subtree. Thus, the larger the final number, the more the subtree is enriched with that family. For each subtree, we determine the family that maximizes this function. We report this as the enrichment score for the subtree.
COMPUTATIONAL ASPECTSIn this section, we first discuss basic assumptions made to make the computation possible (Section 5.1). We then describe the computational challenges posed by the internal nodes (Section 5.2). Finally, we discuss the overall complexity of the algorithm used to compute these measures and in Section 5.3.
Editing sequences and moving taxaWe make two assumptions to make the computation of our measures feasible:(i) Modifying a small number of characters of a single node (which may represent changing one or more sequences in a multiple-sequence alignment, see Section 5.2), in a tree with a large number of nodes and taxa, does not significantly affect the other alignment positions.(ii) Moving a single node (which may represent one or more taxa in a subtree) is unlikely to alter the topology of the rest of the tree significantly.In the absence of these assumptions, we would have to estimate both sequence alignment and the tree after every small modification of a single sequence. Also, both sequence alignment and phylogeny inference are computationally expensive (NP-hard) problems, and the recomputation is not feasible for the large data sets we consider here.
Edit distance for cladesTo determine the smallest number of edit operations needed to move a given node (leaves or internal) from its position in the tree to the sibling position of another node, we determine a sequence corresponding to each of the internal nodes. In our implementation, we used a parsimony reconstruction algorithm to infer ancestral sequences (). However, this can be replaced by any methods to reconstruct ancestral sequences. It is straightforward to compute the edit distance given a multiple sequence alignment by simply counting the number of positions in alignment where the two sequences have different symbols. However, when considering moving a sequence from one part of the tree to a position sister to a target node (internal or leaf), we must ensure that we move it close to the target sequence while minimizing the editing we have to do. We compute the minimum editing required to move a sequence x to the sibling position of node y exactly as follows: For each node of the tree, we pre-compute the edit distance between the sequence of that node and its nodes that are close to it in the tree. We store the smallest edit distance for each node. This number for y is an upper bound to the distance allowed between x and y to move x next to y. We obtain the minimum editing required for this move by subtracting this value from the original edit distance between the sequences of x and y. This heuristic can be replaced by finding out exactly how close x has to be to y at an additional computational cost. Moreover, under some models of character evolution, two nodes do not need to have relatively similar sequences to be neighbors. While computing the edit distance is relatively simple for moving a single sequence, it is non-trivial for moving a set of sequences representing a clade. We compute this distance by maintaining at each node a count of each character at each position. When computing the edit distance from a sequence to this clade, we use this information to count the exact number of nucleotides that are different. Thus, we count the exact number of sequences we need to change in leaves, to move an internal node.
Computing node stability measures and complexityWe compute the node stability measures by traversing the entire tree. We select each node as a putative moveable node x, and compare it with every other node y in the tree. For every pair of nodes x, y we compute the edit distance required to make x the nearest neighbor of y and the RF distance between the trees before and after this move. We maintain an array each for values of s (for x), r (for x) for all thresholds from 0 to 1000. After comparing x to every other node, this information is stored in a file.For a tree with n nodes, tree height d and alignment length L, the time complexity of the above algorithm is On 2 d  L. This is because we consider O(n) nodes for moving. If we are considering an internal node for a move, we need to compute the frequency of each nucleotide at each position leading to O(nL) time. For each node (leaf or internal), we perform O(n) comparisons to all possible nodes for moving. Each comparison involves comparing sequences in O(L) time and finding out the common ancestor of the two nodes for computing the RF distance in O(d) time. Thus, the time complexity of our algorithm is On 2 d  L. The space complexity is O(Ln) as the memory usage is completely dominated by storing the sequence at every node. This can be reduced by pre-computing all distance comparisons in an offline fashion.
RESULTSImplementation details: We have implemented our algorithm using Java. We were able to compute all the taxa stability measures on the datasets described in this article in 572 h. This includes a dataset with 455 000 taxa. Further, this computation can be easily parallelized. Datasets: In our experiments, we used three datasets that represent the variation found in current large-scale molecular phylogenetic studies.(1) The Mammals dataset is a phylogeny of 169 species of mammals published in (). The length of the alignment is 35 603. The sequence length varies from 3893 to 32 201 with an average length of 29 373 and a standard deviation of 3669.(2) The Saxifragales data is a phylogeny of 950 plant species (D. Soltis et al., submitted for publication). The length of the alignment is 48 465 positions. The sequence length ranges from 227 to 26 863 with an average length of 2511 and a standard deviation of 3298.(3) The Plants dataset is a phylogeny of 55 473 plant species (). The length of the alignment is 9853 positions. The sequence length ranges from 197 to 9135 with an average length of 1641 and a standard deviation of 1410.
Mammals datasetIn contrast to the other datasets, the Mammals dataset is highly stable (). There is not a single move (R  1) possible for an edit distance of up to 530 nucleotides. Even if we place an extremely high limit of E  1000, the biggest move possible is RF  5. Thus, the stability measures provide an explicit guarantee that there is no move possible for E  500 and any values of R within 1 SPR distance. This also demonstrates the power of building phylogenies from large densely sampled datasets. We tested our approach on randomly selected subsets of mammals with 80 taxa, and we still found no signs of instability.
SaxifragalesThe Saxifragales dataset contains data from many closely related species. It is very sparse, with nearly 95% missing data in the matrix. In contrast to the mammal data set, it displays much instability (). With an edit distance of 100, it is possible to move nearly two-thirds of the taxa to an RF distance of 3 (). Much larger changes in the tree topology, however, require a far greater edit distance. Therefore, this dataset demonstrates much local instability, where it is easy to make many small changes, in the midst of some robust phylogenetic structure, where large phylogenetic changes may be difficult.
Plants datasetWe found high levels of instability in the 55 473 species plant tree (). Editing only 50 nucleotides is sufficient to move as many as 10 000 taxa using any of our RF distance thresholds.shows that the number of movable nodes increases sharply for all values of R up to 20. Although we found evidence of instability throughout the tree, for an edit distance threshold of 20, the most unstable taxon was Ulex europaeus, which can be moved sister to Lupinus nootkatensis, causing a change in the topology with RF distance of 61. This illustrates that very small changes in the underlying sequence data can lead to large changes in the tree topology. Both species, like many of the most unstable species, are part of an extremely large plant family, meaning that it is within a subtree containing many closely related species. Thus, although a RF distance of 61 represents a major change in tree topology, it is still only moving species within the same family. We can account for the distance of evolutionary relationship in our measures of stability by computing a RF distance that is weighted by the branch lengths. This would down-weight topology changes among closely related taxa relative to changes among more distantly related taxa. As discussed previously in Section 4, we checked if the subtrees with a large ratio of movable taxa are enriched for specific taxonomic families. We found that nodes with some of the highest ranked subtrees were enriched in extremely large families. Out of 20 internal nodes ranked by our algorithm, 11 were enriched in Asteraceae, 4 in Poaceae and 2 in Orchidaceae. These are all among the five largest plant families. We also checked to see if the 11 nodes enriched in Asteraceae were descendants of a deep node enriched in Asteraceae. We found that the least common ancestor to all these nodes is very close to the root, far above the most recent common ancestor of the Asteraceae.shows that subtrees enriched in families tend to be at either end of the Z-score spectrum, i.e. they are usually very stable or very unstable.further illustrates the lack of stability of this tree. This figure plots the average and maximum RF distance against E. It also shows that on average, each taxon can be moved to an RF distance of 20 with as few as 100 nucleotides changed. With little to no editing, some taxa can be moved to an RF distance of 40 or more. Also,plots the minimum edit distance required against R. It shows that it is easy to perform moves with very large RF distance with very little editing. The unstable nature of this tree may be due to the presence of many taxa with little nucleotide data and the gappy multiple sequence alignment. We also checked if the reason for unstability is the large number of taxa. We randomly selected 10 subsets each of size 3000, 7000, 12 500 and 25 000. In each of these, we found a very high number of unstable taxa for similarly small thresholds. Thus, simply reducing the taxon sampling will not necessarily create a more stable tree.
DISCUSSIONWe have presented a novel framework to evaluate the stability of phylogenetic trees. These measures may be used to assess the stability of individual sequences, clades or entire trees. They provide information that may be used to direct further phylogenetic research and also suggest alternate plaubile topologies. Thus, the stability measures presented in this article may be used to improve quality of phylogenetic analyses and the performance of iterative algorithms. Our experiments demonstrate that our stability measures can be easily computed for the largest published empirical datasets. It is important to note that the success of these measures is dependent on the choice of editing and tree distance measures used. While we have used edit and RF distance measures, any set of measures can be used. We can easily replace the edit distance with a distance estimated using the General Time Reversible model (Tavare,Tavare, 1986) or the RF distance with a weighted RF distance. In our current search strategy, SPR or tree bisection and reconnection (TBR) distance measures may not be useful. Criteria for the selection of E and R strongly depends on the choice of distance functions. This is a complex issue, but we briefly suggest how this problem may be approached. A simple approach could be to use percentages of average or current sequence length and tree height for determining E and R respectively. Alternatively, it is possible to rank the nodes in the order of their stability with respect to a E or R. Finally, it is possible to compute the statistical properties of sequence length and move distances to determine outliers with respect to mean and 23 standard deviations for range. Our analyses on published large datasets identified strengths and weaknesses of these phylogenetic hypotheses. Our measures found that the Plants and Saxifragales datasets were highly unstable. Both include many closely related species, and both contain taxa with short sequences and with much missing data. It is therefore not surprising that small changes in the sequences can lead to large tree rearrangements. Our measures also recognized the stability in the Mammals dataset, which has far fewer taxa and much more sequence data. It is important to note that the stability measures discussed here complement, rather than replace, existing measures of phylogenetic support. As a sanity check, we performed a limited comparison to a method that identifies rogue taxa running RogueNaRoK (). While there was some overlap between the unstable taxa and the rogue taxa, the rankings were not obviously correlated. We do not pursue a detailed comparison with the measures of rogue taxa identification as their objectives are different from stability. The intent of the stability measures is not to invalidate a tree or a method, but to provide explicit guarantees on situations where a specific tree on a give dataset will not be unstable. The placement of any subtrees and taxa identified as unstable should be interpreted with caution. The ranked list of unstable nodes should help prioritize areas of the tree that need further study or data.(b)
Future workOur framework allows for definition of stability measures beyond those presented in this article. Especially, other forms of editing such as removal or addition of taxa may be informative for stability. In the future, we will examine the stability measures to guide the construction and iterative improvement of trees. A preliminary analysis of the tree distance measures presented in Section 3.1 suggests computational intractability. In the future, we will explore the computational complexity and approximations to these measures. An important assumption we made is that the global sequence alignment is stable enough such that changing one sequence to move it closer to a different sequence is not going to affect everyone else in the alignment. Similarly, we also assumed that the remaining tree is stable. Both of these assumptions were made to avoid intractability. In the future, we will try to assess the impact this can have on our results and when is it safe to make this assumption. We will also incorporate online methods to update the alignment and the tree.
Published by Oxford University Press 2012. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
S.Sheikh et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Stability analysis of phylogenetic trees at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
