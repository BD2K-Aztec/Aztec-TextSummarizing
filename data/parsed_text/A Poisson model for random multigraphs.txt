Motivation: Biological networks are often modeled by random graphs. A better modeling vehicle is a multigraph where each pair of nodes is connected by a Poisson number of edges. In the current model, the mean number of edges equals the product of two propensities, one for each node. In this context it is possible to construct a simple and effective algorithm for rapid maximum likelihood estimation of all propensities. Given estimated propensities, it is then possible to test statistically for functionally connected nodes that show an excess of observed edges over expected edges. The model extends readily to directed multigraphs. Here, propensities are replaced by outgoing and incoming propensities. Results: The theory is applied to real data on neuronal connections, interacting genes in radiation hybrids, interacting proteins in a literature curated database, and letter and word pairs in seven Shaskespearean plays. Availability: All data used are fully available online from their respective sites. Source code and software is available from
INTRODUCTIONRandom graph theory has proved vital in modeling the internet and constructing biological and social networks. In the original formulation of the theory by), there are three key assumptions: (a) a graph exhibits at most one edge between any two nodes; (b) the formation of a given edge is independent of the formation of other edges; and (c) all edges form with the same probability. There is a general agreement that this simple model is too rigid to capture many real-world networks (). The surveys () summarize some of the elaborations and applications of two generations of scholars, with emphasis on power laws, phase transitions and scale-free networks. In the current article, we study a multigraph * To whom correspondence should be addressed. extension of the ErdsRnyi model appropriate for very large networks. Our model specifically relaxes assumptions (a) and (c). With appropriate alternative assumptions in place, we derive and illustrate a novel maximum likelihood algorithm for estimation of the model parameters. With these parameters in hand, we are then able to find statistically significant connections between pairs of nodes. In practice many graphs are derived from multigraphs. To simplify analysis, the multiple edges between two nodes of a multigraph are collapsed to a single edge. The movie star example in reference () is typical. In the movie star graph, two actors are connected by an edge when they appear in the same movie. Some actor pairs will appear in a movie mostly by chance. Other actor pairs will be connected by multiple edges because they are intrinsically linked. Classic pairs such as Abbot and Costello, Loy and Powell, and Lewis and Martin come to mind. The well-studied neural network of Caernorhabditis elegans is a prime biological example. Here neuron pairs are connected by multiple synapses. Because collapsing edges wastes information, it is better to tackle the multiplicity issue directly. Thus, we will deal with random multigraphs. For our purposes, these exclude loops and fractional edge weights. Instead of a Bernoulli number of edges between any two nodes as in the Erds and Rnyi model, we postulate a Poisson number of edges. This choice can be viewed as unnecessarily restrictive, but it is worth recalling that a Poisson distribution can approximate a binomial or normal distribution. Furthermore, the Poisson assumption allows an arbitrary mean number of edges. In relaxing assumption (c) above, we want to introduce as few parameters as possible but still capture the capacity of some nodes to serve as hubs. Thus, we assign to each node i a propensity p i to form edges. The random number of edges X ij between nodes i and j is then taken to be Poisson distributed with mean p i p j. Node pairs with high propensities will have many edges, pairs with low propensities will have few edges, and pairs with one high and one low propensity will have intermediate numbers of edges. Later, we will show that these choices promote simple and rapid estimation of the propensities. Another virtue of the model is that it generalizes to directed graphs where arcs replace edges. For directed graphs, we postulate an outgoing propensity p i and an incoming propensity q i for each node i. The number of arcs X ij from i to j is taken to be Poisson distributed with mean p i q j. In the directed version of the model, the two random variables X ij and X ji are distinguished. In accord with assumption (b), the random counts X ij in either model are taken to be independent.
Random multigraphsProtein and gene networks can involve tens of thousands of nodes. Estimation of propensities under the Poisson multigraph model for such networks is consequently problematic. Standard algorithms for parameter estimation such as least squares, Newton's method and Fisher scoring require computing, storing and inverting large Hessian matrices. Such actions are not really options in high-dimensional problems. One of the biggest challenges in the present article is crafting an alternative estimation algorithm that remains viable in high dimensions. Fortunately, the MM (minorize maximize) principle () allows one to design a simple iterative algorithm for the random multigraph model. Large matrices are avoided and convergence is reasonably fast. In the appendix, we prove that the new MM algorithm converges to the global maximum of the likelihood. Another strength of the model is that it permits assessment of statistical significance. In other words, it helps distinguish random connectivity from functional connectivity. The basic idea is very simple. Every edge count X ij is Poisson distributed with a parameterized mean. If we substitute estimated propensities for theoretical propensities, then we can estimate the mean and therefore approximate the tail probability p = Pr(X ij  x ij ) associated with the observed number of edges x ij between two nodes i and j. The smaller this probability, the less likely these edges occur entirely by chance. For instance, in the movie star example, the actor pair Abbot and Costello would be flagged as significant in any representative dataset of their era. In less obvious examples, discerning functionally connected pairs is more challenging. In the appendix (Supplementary Material), we show how to approximate very low P-values under the Poisson distribution. To test the model, we analyze five real datasets. Three of these are biological and involve undirected graphs. The first is the neural network of C.elegans () already mentioned. The second is a network obtained by subjecting a panel of radiation hybrids to gene expression measurements (). In the network two genes are connected by an edge if a marker significantly regulates the expression levels of both genes in the clones of the panel. Our third biological example involves interacting proteins taken from the curated Human Protein Reference Database (). For directed graphs, we turn to literary analysis of a subset of Shakespeare's plays. Here, we look at letter pairs and word pairs. Every time the first letter of a pair precedes the second letter of a pair in a word, we introduce an arc between them. Likewise, every time the first word of a pair precedes the second word of a pair in a sentence, we introduce an arc between them. Other applications such as monitoring internet traffic come immediately to mind but will not be treated here. Let us stress the exploratory nature of the Poisson multigraph model. Its purpose is to probe large datasets for hidden structure. Identifying hub nodes and node pairs with excess edges are primary goals. The fact that the model is at best, a cartoon does not eliminate these possibilities. For example, even if we do not take the P-values generated by the model seriously, they can still serve to rank important node pairs for further investigation and experimentation. Computational biology is full of compromises between realistic models and computational feasibility. Before tackling these specific examples, we will briefly review the MM principle and lay out the details of the model. Once this foundation is in place, we show how a simple inequality drives the optimization process. The MM principle is designed to steadily increase the log-likelihood of the model given the data. This ascent property is the key to understanding how the algorithm operates.
BACKGROUND ON THE MM ALGORITHMAs we have already emphasized, the MM algorithm is a principle for creating algorithms rather than a single algorithm. There are two versions of the MM principle, one for iterative minimization and another for iterative maximization. Here, we deal only with the maximization version. Let L(p) be the objective function we seek to maximize. An MM algorithm involves minorizing L(p) by a surrogate function g(p | p n ) anchored at the current iterate p n of a search. Minorization is defined by the two propertiesIn other words, the surface p  g(p | p n ) lies below the surface p  L(p) and is tangent to it at the point p = p n. Construction of the surrogate function g(p | p n ) constitutes the first M of the MM algorithm. In the second M of the algorithm, we maximize the surrogate function g(p | p n ) rather than L(p). If p n+1 denotes the maximum point of g(p | p n ), then this action forces the ascent propertyand(2) and the choice of p n+1. The ascent property is the source of the MM algorithm's numerical stability. Strictly speaking, it depends only on increasing g(p | p n ), not on maximizing g(p | p n ). The celebrated EM algorithm () is a special case of the MM algorithm (). The EM algorithm always relies on some notion of missing data. Discerning the missing data in a statistical problem is sometimes easy and sometimes hard. In our Poisson graph model, it is unclear what constitutes the missing data. In contrast, derivation of a reliable MM algorithm is straightforward but ad hoc. Readers wanting a more systematic derivation are apt to be disappointed. In our defense, it is possible to codify several successful strategies for constructing surrogate functions ().
Page: 2006 20042011
J.M.O.Ranola et al.likelihood estimation, we employ the majorizationwith the superscript n indicating iteration. Observe that equality prevails when p = p n. This majorization leads to the minorizationMaximization of g(p | p n ) can be accomplished by settingis straightforward to implement and maps positive parameters to positive parameters. When edges are sparse, the range of summation in j =i x ij can be limited to those nodes j with x ij > 0. Observe that these sums need only be computed once. The partial sums j =i p n j = j p n j p n i require updating the full sum j p n j once per iteration. A similar MM algorithm can be derived for a Poisson model of arc formation in a directed multigraph. We now postulate a donor propensity p i and a recipient propensity q j for arcs extending from node i to node j. If the number of such arcs X ij is Poisson distributed with mean p i q j , then under independence we have the log-likelihoodWith directed arcs, the observed numbers x ij and x ji may differ. The minorizationnow yields the MM updatesAgain these are computationally simple to implement and map positive parameters to positive parameters. It is important to observe that the loglikelihood L(p,q) is invariant under the rescaling cp i and c 1 q j for a positive constant c and all i and j. This fact suggests that we fix one propensity and omit its update. To derive a reasonable starting value in the undirected multigraph model, we maximize L(p) under the assumption that all p i coincide. This gives the initial valuesThe same conclusion can be reached by equating theoretical and sample means. In the directed multigraph model, we maximize L(p,q) subject to the restriction that all p i and q j coincide. Now we haveNote that the fixed parameter is determined by this initialization.. In this graph, node size is proportional to a node's estimated propensity. Also, the darker the edge, the more significant the connection; red lines highlight the most significant connections. Edges between this cluster and the rest of the network were removed for clarity.
RESULTS
Caernorhabditis elegans neural networkThe neural network of C.elegans is a classic dataset first studied byand later by Watts and Strogatz (1998). In their paper, White et al. were able to obtain high-resolution electron microscopic images. This allowed them to identify all the synapses, map all the connections and to work out the entire neuronal network of the worm. To use all known connections in our analysis, we add as edges the electric junctions and neuromuscular junctions observed by. For consistency, we disregard the directionality of the chemical synapses. In our opinion, the flexibility of the model in accepting different definitions of edges should be viewed as a strength. We declare a connection between two neurons i and j to be functionally significant when Pr(X ij  x ij )  10 6 .in the Appendix (Supplementary Material) depicts the network. As recorded in, many of the most significant connections extend between motor neurons. The model also captures the bilateral symmetry between the right and left sides of the worm. Thus, the connections between the pairs RIPR-IL2VR and RIPL-IL2VL and between OLLL-AVEL and OLLR-AVER are all significant. Note that an L or an R at the end of a neuron's name signifies the left and right side, respectively. The right neuron PDER appears twice on the top 50 list and its left counterpart PDEL is missing, but both have the same number of significant edges overall. Although these dual connections are highlighted as about equally significant in our analysis, the corresponding propensity estimates show a left right imbalance. The cause of these slight departures from bilateral symmetry is obscure. In any event, the model is subtle enough to distinguish between high edge counts and significant edge counts. Thus, even though one pair of nodes may have more edges than another pair, it does not necessarily imply that the first pair is more significantly connected than the second pair.To the right of each pair appear the observed number of edges, the expected number of edges and minus the log base 10 P-value.
Random multigraphs
Radiation hybrid gene networkRadiation hybrids were originally devised as a tool for gene mapping () at the chromosome level. The detailed physical maps they ultimately provided () served as a scaffolding for sequencing the entire human genome. To construct radiation hybrids, one irradiates cells from a donor species. This fragments the chromosomes and kills the vast majority of cells. A few donor cells are rescued by fusing them with cells of a recipient species. Some of the fragments, say 10%, get translocated or inserted into the chromosomes of the recipient species. The hybrid cells have no particular growth advantage over the more numerous unfused recipient cells. However, if cells from the recipient cell line lack an enzyme such as hypoxanthine phosphoribosyl transferase (HPRT) or thymidine kinase (TK), both the unfused and the hybrid cells can be grown in a selective medium that eliminates the unfused recipient cells. This selection process leaves a few hybrid cells, and each of the hybrid cells serves as a progenitor of a clone of identical cells. Each clone contains a random subset of the genome of the donor species. The presence or absence of a particular short region can be assayed by testing for a donor marker in that region. A given donor marker is present in a given clone in 0, 1 or 2 copies. It turns out that one can exploit radiation hybrids to map QTLs (quantitative trait loci). We measured the log intensities of 232 626 aCGH (array comparative genomic hybridization) markers and 20 145 gene expression levels in each of 99 mousehamster radiation hybrids (). In this case, a mouse served as the donor and a hamster as the recipient. We then regressed the mouse gene expression levels on the mouse copy numbers recorded for each of the mouse markers. Altogether this amounts to about 510 9 separate linear regressions. We constructed a multigraph from the data by analogy with the moviestar example, with genes corresponding to actors and markers to movies. An edge is added between two genes if both genes showed statistically significant dependence on the marker at the level P  10 9. This strict P-value cutoff was chosen to produce an easily visualized graph. Because the aCGH markers densely cover the mouse genome, a quasi-peak finding algorithm was used to delete the excess edges occurring under a common linkage peak.in the Appendix (Supplementary Material) depicts the full network. Here, node size is proportional to estimated propensity and edge darkness is proportional to significance. Red edges are the most significant. Even with a very stringent significance level and elimination of edges by peak finding, there are still 729 169 significant connections.shows an interesting subnetwork with highly significant edges, genes (nodes) of large propensity, and genes with related functions. The Dishevelled 1 (Dvl1) member of this subnetwork is part of the wingless/Int (Wnt) signaling pathway. The Wnt pathway has a reciprocal signaling relationship with the hedgehog pathway, which requires oxysterols for optimal function (). The Wnt hedgehog connection is important in stem cell renewal. Interestingly, oxysterol binding protein-like 3 (Osbpl3) is a member of the subnetwork as well as Dvl1. Furthermore, the subnetwork contains two membrane-associated proteins: mucolipin 3 (Mcoln3), a cation channel protein () and aquaporin 2 (Aqp2), a water channel protein (). An emerging theme in cancer research is the notion of evolving genetic networks (). Networks constructed using the Poisson multigraph model can robustly identify unexpected connections with known oncogene pathways such as the Wnt pathway. These connections may ultimately suggest novel therapeutic strategies.To the right of each protein is the observed number of connections, the number of significant connections using P-value of 10 6 , and the estimated propensity.
Protein interactions via literature curationWith the advent of high-throughput experimentation, an enormous mass of information on protein interactions has accumulated. Because there was initially no universal format for presenting interactions, many of the early discoveries were useful only to the originating labs. This bottleneck forced coordination and eventually the construction of unified databases with fixed formats combining all of the published information. A notable example of this process of curation is the Human Protein Reference Database (). We downloaded Release 7 of the database and analyzed it with the random multigraph model. Several interesting features of the data emerge under a P-value cutoff of 10 6. For instance, the protein with the most observed edges, TP53, turns out to be different from the protein with the most significant edges, Stat3. In fact, none of the top five proteins ranked by the most observed edges are in the top five proteins ranked by the most significant edge counts. Thus, the hub nodes of the raw data differ sharply from the hub nodes of the processed data. The two most extreme cases, YWHAG and CREBBP, have no significant edge counts despite being ranked fourth and fifth based on observed edges (Tables 2 and 3). One should be cautious in interpreting such results because molecular experiments are hypothesis driven and generate very biased data. The value of looking for significance is that it turns up hidden structure, not that it calls into question known structure. When we cluster proteins by significant edge counts, the TP53 protein is especially interesting. Consider the small component containing TP53 shown in. We analyzed this cluster using the BiNGO addition to Cytoscape (). BiNGO computes the probability that x or more genes in a given set of genes shares the same GO (gene ontology) category. Altogether we found 30 significant GO categories with P < 10 6 ; most ofTo the right of each protein is the observed number of connections, the number of significant connections, and the estimated propensity.
Random multigraphs
Word pairs and letter pairsIdentifying frequently used word pairs in literary texts can be useful in problems of literary attribution and in the identification of word fossils. Vocabulary richness and frequencies of sets of words have been studied in many different literary contexts using a variety of methods, including, for example, Bayesian analysis and machine learning to determine authorship of the Federalist papers (), and likelihood ratio tests to study the Pearl poems (). Recent investigations of long texts () have called into question Zipf's law (), which postulates that the frequency of any word is inversely proportional to its rank in usage. Here, we apply the Poisson model of graph connectivity to study pairs of words used consecutively in a set of Shakespeare's plays. Our version of word pair analysis begins by scanning a literary work and creating a dictionary of words found in the text. An arc is drawn between two consecutive words, from the first word to the second word of the text, provided the words are not separated by a punctuation mark. The number of arcs between an ordered pair of words is counted and stored in a square matrix with dimensions equal to the number of unique words in the text. We chose seven of Shakespeare's plays,Measure and Titus Andronicus, concatenated them, and analyzed them as a whole. Contractions such as 'o'er' and 'ta'en' were replaced by the corresponding full words, 'over' and 'taken', respectively. We retained in our analysis word pairs constituting character names.We calculated the observed frequency of each word pair. Based on the directed random multigraph model described in Section 3, we estimated the outgoing and incoming propensities for each word along with expected frequencies and P-values for each word pair.lists the most connected word pairs in the text ranked by their P-values. This set is dominated by phrases that are commonly used in the language of the day, such as 'I am' and 'my lord', and by character names, such as 'Lady Macbeth' and 'Second Lord', in each play. One can identify several word pairs whose members almost never occur separately by examining the ratio x ij /( p i  q j ) of observed to expected word pair frequencies.lists several examples ranked by this index. These word pair fossils are dominated by a few phrases still in common use such as 'pell mell' and 'tick tack' as well as various Latin and Italian phrases, such as 'et tu Brute', and other strange phrases specific to the context of particular plays, such as 'boarish fangs' and 'rustic revelry'. In addition, we studied pairs of letters encountered consecutively in the combined text of the Shakespearean plays.depicts the letter pair connections using a very stringent P-value of 10 19 for display purposes.
CONCLUSIONSMultigraphs are inherently more informative than ordinary graphs, and random multigraphs offer rich possibilities for modeling biological, social and communication networks. Our applications are meant to be illustrative rather than exhaustive. Graphical models will surely grow in importance as research laboratories and corporations gather ever larger datasets and hire ever more computer scientists and statisticians to mine them. The Poisson model has many advantages. It is flexible enough to capture hub nodes and functional connectivity, generalizes to directed graphs, and sustains an MM estimation algorithm capable of handling enormous numbers of nodes. It is also very quick computationally as measured by total iterations and total time until convergence. A glance atof the Appendix (Supplementary Material) suggests that 2030 iterations suffice for convergence. To thrive, data mining must balance model realism with model computability. In our opinion, the Poisson model achieves this end. Of course, other distributions for edge counts could be tried, for instance the binomial or the negative binomial, but they would be even less well motivated and less adapted to fast estimation. It is natural to place our advances in the larger context of applied random graph theory. For instance, early on social scientists married latent variable models and random networks (). Stochastic blockmodels assign nodes either deterministically or stochastically to latent classes (; Nowicki and Snijders, 2001;). Alternatively, a latent distance model sets up a social space and estimates the distances between node pairs in this space (). It is possible to combine features of both latent class and latent distance models in a single eigenmodel (). The 'attract and introduce' model is another helpful elaboration (). None of these models focuses on multigraphs. Furthermore, most classical applications involve networks of modest size. However, under the stimulus of large internet datasets, the field of random networks is in rapid flux. Going forward it will be a challenge to turn the rising flood of data into useful information. Importing more of the social science contributions into biological research may pay substantial dividends. In practice, most large networks contain an excess of weak interactions. The radiation hybrid data are typical in this regard. To sift through the data, it is helpful to focus on hub nodes and strong interactions. The Poisson multigraph model provides a rigorous way of doing so. The model's flexibility in allowing different sorts of edges is appealing if not taken to extremes. When confidence in edge assignment varies widely across edge definitions, a weighted graph model might be a better modeling device than a multigraph model. However, converting a multigraph to a weighted graph has its own problems. For instance, there is more than one way to make the conversion. An even bigger disadvantage of weighted graph models is their tendency to ignore the stochastic nature of node formation. This is a hindrance in assessing functional connections and suggests an opportunity for more nuanced modeling. To be competitive with Poisson multigraphs, a good stochastic model for weighted graphs should support fast estimation of parameters. One substitute for Poisson randomness is to condition on the degree of each node (). Within these constraints, one can randomize edge placement. This perspective lends itself to permutation testing but not to parameter estimation (). Unfortunately, the computational cost of generating the required permutations limits the chances for approximating very small P-values and hence ranking connections by P-values. The random multigraph model raises as many questions as it answers. How closely is it tied to the Poisson distribution? How closely is it tied to the propensity parameterization of edge means?
Page: 2011 20042011
Random multigraphsCan predictors be incorporated that determine propensities? More importantly, what applications would benefit from this sort of modeling? We are content to raise these issues, with the hope that other computational and mathematical scientists can be enlisted over time to resolve them and related problems beyond our current understanding.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
METHODS Consider a random multigraph with m nodes labeled 1,2,...,m. A random number of edges X ij connects every pair of nodes {i,j}. We assume that the X ij are independent Poisson random variables with means  ij. As a plausible model for ranking nodes, we take  ij = p i p j , where p i and p j are non-negative propensities. The log-likelihood of the observed edge counts x ij = x ji amounts to L(p) = {i,j} (x ij ln  ij  ij ln x ij !) = {i,j} [x ij (ln p i +ln p j )p i p j ln x ij !]. Inspection of L(p) shows that the parameters are separated except for the products p i p j. To achieve full separation of parameters in maximum
