Motivation: Pathway analysis tools are a powerful strategy to analyze 'omics' data in the field of systems biology. From a metabolic perspective , several pathway definitions can be found in the literature, each one appropriate for a particular study. Recently, a novel pathway concept termed carbon flux paths (CFPs) was introduced and bench-marked against existing approaches, showing a clear advantage for finding linear pathways from a given source to target metabolite. CFPs are simple paths in a metaboliteâ€“metabolite graph that satisfy typical constraints in stoichiometric models: mass balancing and thermodynamics (irreversibility). In addition, CFPs guarantee carbon exchange in each of their intermediate steps, but not between the source and the target metabolites and consequently false positive solutions may arise. These pathways often lack biological interest, particularly when studying biosynthetic or degradation routes of a me-tabolite. To overcome this issue, we amend the formulation in CFP, so as to account for atomic fate information. This approach is termed atomic CFP (aCFP). Results: By means of a side-by-side comparison in a medium scale metabolic network in Escherichia Coli, we show that aCFP provides more biologically relevant pathways than CFP, because canonical pathways are more easily recovered, which reflects the benefits of removing false positives. In addition, we demonstrate that aCFP can be successfully applied to genome-scale metabolic networks. As the quality of genome-scale atomic reconstruction is improved, methods such as the one presented here will undoubtedly be of value to interpret 'omics' data.
INTRODUCTIONSystems biology aims at modeling a wide assortment of biological phenomena from a holistic molecular perspective (). Analysis of high-throughput 'omics' data is typically intricate and requires sophisticated techniques assisting their interpretation and understanding. For this purpose, pathway analysis tools constitute a powerful strategy, as there is strong experimental evidence supporting the view that many cellular processes are organized into pathways (). In particular, biochemistry textbooks detail a wide list of well-known (canonical) metabolic pathways, which can now be computationally accessed from different databases and analyzed in different scenarios (). The outbreak of genome-scale metabolic networks has evidenced that it is not possible to represent all the metabolic phenotypes using a small set of canonical pathways. Intending to increase the number and diversity of pathways, a number of mathematical pathway definitions can be found in the literature (). For each scenario under study, selecting the appropriate definition is crucial so as to obtain relevant insights (). Defining a pathway concept representing too many biological mechanisms may be counterproductive due to the underlying computational demand. In this light, two sides of the same coin are the pathway definitions based on graph theory () and elementary flux modes (EFMs) (). Although the former is calculated based on classical graph theory (), the latter requires less efficient algebraic techniques (). However, EFMs fulfill additional biological constraints, e.g. mass balance, leading to more biologically relevant results. It is worth mentioning that, in addition to EFMs, we can find in the literature similar pathway definitions, such as generating flux modes () or extreme pathways (). Furthermore, additional examples of metabolic pathway definitions based on graph theory can also be found (). Recently, carbon flux paths (CFPs) () were introduced so as to account for the advantages of both definitions. This approach searches for paths in a graph of metabolites, where arcs represent an effective carbon exchange in at least one enzyme-catalyzed reaction. In addition, as in the case of EFMs, additional biophysical constraints are imposed, namely mass balance and thermodynamic restrictions. CFPs approach is an effective tool to determine linear pathways from a given source to a target metabolite, as it overcomes combinatorial issues found in EFMs approach. CFPs also take advantage of the inherent versatility of Integer Linear Programming (ILP) to integrate gene expression and protein abundance data as well as metabolomics data (). Despite the potential and versatility of CFPs, there is still room for improvement. In particular, while the underlying graph of metabolites guarantees carbon exchange in each step of the path, this is not always achieved between the source and target metabolites and false-positive solutions may arise. As discussed in, these solutions lack biological significance, especially when studying biosynthetic or degradation mechanisms. *To whom correspondence should be addressed.In order to overcome this issue, the CFP formulation is here extended to ensure that a fixed number of carbon atoms from the source reach the target metabolite, in line with Pitkanen. To do so, we integrate atomic tracing data for reactions into the model. In other words, for a biochemical reaction we require precise information indicating in which position in a product each carbon atom from a substrate ends. This information is growing day by day and is currently available in different reconstructions. These reconstructions can be manually curated () or computed by automatic methods (). The use of in silico (automatically) generated databases entails sacrificing accuracy, but increases the number of reactions that can be considered. Based on this information, we show that the atomic extension of CFP presented here (aCFP) provides more biologically relevant pathways than the original CFP definition.

METHODSFor a metabolic network under consideration, we denote R and C the set of reactions and compounds, respectively. We define S cr as the stoichiometric coefficient associated with metabolite c in reaction r. The constraints corresponding to the metabolic fluxes (v r ) remain as in. Metabolites are divided into two sets: internal (I) and external (E). For metabolites in I, steady-state condition is applied, namely Equation (1). Metabolites in E are not necessarily balanced, but consumption is only allowed to the subset of metabolites in the growth media (E m ), see Equation (2). We also include the binary variable z r , being equal to one if reaction r is active and zero otherwise. This relationship is represented in Equation (3) where N is a large scalar representing the maximum flux value. Finally, note that each reversible reaction is split into two irreversible reactions where B  {(,)j reaction and reaction are the reverse of each other}. Equation (4) prevents a solution with a reversible reaction activated in both directions. X r2R S cr v r  0, 8c 2 I 1We briefly introduce a subset of the path constraints included in. As we shall see below, constraints removed from the previous formulation are not required when atomic tracing data is incorporated into the model. We have binary variable u ij , being equal to one if the arc linking the metabolites i and j is present in the obtained pathway and zero otherwise. Note here that we only include in the graph arcs between those metabolites exchanging carbon atom(s) in at least one reaction in R. Equation (5) ensures that one arc leaves the source () and one arc reaches the target () metabolites. Similarly, Equation (6) guarantees that no arcs reach and leave and. This equation is not applied when looking for a cyclic pathway, namely . Equation (7) prevents revisiting a metabolite so branched solutions are not allowed in the calculatedik 1, 8k 2 C 7 In, we forced carbon exchange between intermediate metabolites in the path, however, carbon flux between and was not ensured. We overcome this issue by going one level of complexity further, namely modeling the fate of carbon atoms. The information describing the movement of a carbon atom is represented by atom mapping matrices (AMM) (). These matrices have been manually annotated for medium scale metabolic networks comprising hundreds of reactions (). There are also algorithms calculating the fate of an atom within a reaction in genome-scale metabolic networks (). However, further research is required to improve the accuracy of these algorithms. Below we show how to extend CFPs so as to assure effective carbon exchange between and by including carbon fate information into the model. Note how a graph of metabolites exchanging carbon atoms () is less informative than a graph where nodes are carbon atoms (). We describe below this carbon atom graph. Let us define A as the set of carbon atoms in the metabolic network under study and A c the set containing all the carbon atoms of a particular metabolite c.includes the sets described above for the Pyruvate kinase (PYK) reaction except for adenosine triphosphate (ATP) and adenine dinucleotide phosphate (ADP). In, d ijr was defined to be equal to one if at least one carbon atom from metabolite i reaches metabolite j in reaction r. Similarly to d ijr , we introduce here the coefficient e lmr , being equal to one if carbon atom l reaches m in reaction r and zero otherwise. Both coefficients are closely related, in particular, if l2A i , m2A j and e lmr  1 then d ijr  1, whereas the opposite is not always true. Therefore, if 9 r 2 R / e lmr  1, we define an arc between l and m. In analogy with u ij , we introduce the binary variable w lm , which is equal to one if the atomic arc connecting carbon atoms l and m is active in the obtained path and zero otherwise. Equation(8) ensures that the number of incoming arcs is equal to the number of outgoing arcs for each carbon atom in A except for those belonging to the source and target metabolites, i.e. and. Equation(8) encompasses original formulation in, where this constraint was applied in the metabolic graph. In addition, we relate u ij and w lm through Equation (9). In essence, this constraint ensures that if w lm is active in the path and l2A i and m2A j , then u ij is also in the path. Notice that Equation (9) links in one equality constraint the carbon atom level with the metabolite level. Q fixes the number of atoms reaching the target from the source metabolite, in consequence Q is an integer40. The activation of a metabolic arc (u ij ) implies the activation of Q of its underlying atomic arcs (w lm ). Therefore, with Equations (5)(9), we guarantee in each intermediate metabolic step that Q carbons from the source are transported.Integer programing allows us to enumerate a predefined number of paths (K) in an ascending length order by including Equation (12), where U k ij is equal to u ij in the kth solution. Here we enumerate paths at the metabolic level (u ij ) rather than at the atomic level (w lm ). In particular, note how a particular metabolic path may comprise many underlying atomic pathways. For example, inthere are three atomic pathways between Phosphoenolpyruvic acid (PEP) and Pyruvate (PYR), but only one metabolic path. A deeper discussion highlighting the differences can be found in Section 3. Aiming at obtaining each metabolic pathway only once, we enumerate them at the metabolic level, namely by means of u ij .Summarizing, Equations (1)(12) form the atomic extension to the CFP approach, namely aCFP.
RESULTS
Recovering canonical pathways with aCFPAs for appraising the performance of the methodology introduced here, we perform a side-by-side comparison between aCFP and CFP. For completeness, we included the results coming from a pure atomic graph, i.e. path resulting from the carbon graph (). We referred to this last group as atomic paths (AP) approach. In order to analyze the performance of AP approach, we modified Equation (12) to enumerate at the atomic level rather than at the metabolic level; i.e. based on w lm instead of u ij. We used the imPS1485 model, which constitutes one of the more extensive metabolic networks including manually curated AMMs (). In particular, this network involves several metabolic pathways in Escherichia coli, comprising 317 reactions and 270 metabolites after including exchanges and splitting reversible reactions. To build the metabolite graph for CFP as defined in, we used AMMs in, as highlighted in methods section (l2A i , m2A j and e lmr  1 then d ijr  1). Results shown below were obtained using the general growth media defined in the imPS1485 model. The performance of aCFP was evaluated in the light of 18 canonical metabolic pathways. These pathways are a subset of the 40 pathways used in the validation of the CFP approach (), particularly those included in the imPS1485 metabolic model. Two reasons led us to discard a canonical pathway from the original set of 40 pathways: (i) absence of some of its intermediate metabolites and/or reactions in the imPS1485 model; (ii) inability to flow in steady state. In order to maximize the number of pathways considered, we performed some slight modifications. For instance, some reactions are lumped in imPS1485 and, in consequence, some intermediate steps of the canonical pathway must be lumped so as to match with the corresponding pathway in imPS1485. So, 18 is the maximum number we can consider given the limitations in imPS1485. The full set of pathways can be found in the Supplementary Material. Overall, each one of these 18 pathways is defined by a sequence of several metabolites, so we assume that the pathway is recovered when the calculated solution and the canonical pathway are the same in terms of this sequence of intermediate metabolites. Note also that the set of constraints is particularized for each canonical pathway, defined by a distinct pair of source/ target metabolites, i.e. and. As discussed in the Section 2, ILP allows us to enumerate pathways in increasing length order. It is typical that solutions with the same length exist; these will be enumerated in an arbitrary order depending on several factors, e.g. ILP solver, the computer, the order of the constraints. Therefore, the side-byside comparison should be carried out in terms other than based on the position in which the canonical pathway is recovered (here by position we mean the solution at which the pathway is found, e.g. position 10 means that the pathway is found at the 10th solution). In particular, we perform the side-by-side comparison using a position interval in which the solutions of equal length to the canonical pathway are computed. For that we introduce p  and p  , which represent the position of the first and last computed solution with equal length to the canonical pathway. The reader should note here that the lower the values of p  and p  and the narrower the interval [p  , p  ], the better the method is at recovering canonical pathways. For the sake of clarity, we represent p  and p  by means of a bar graph. In addition, the position in which the canonical pathway was recovered is represented with a dot. Note that if p  is equal to p  , the bar is reduced to a point which must correspond to that in which the canonical pathway under request was recovered, i.e. indicated with a dot. We include three bars per pathway, namely one per approach: aCFP white bar, CFP dark gray bar and AP light gray bar. When recovering pathways with aCFP we impose that, at least, half of the carbon atoms from the source reach the target when the source has more carbons than the target or vice versa when the target has more carbons, except in the case of the pentose phosphate pathway in which only two carbons from the source reaches the target by means of the canonical pathway. Finally, this comparison is carried out for each of the 18 pathways and is presented in.For example, taking the pathway inas an example, note that aCFP recovers the corresponding canonical solution, namely the Glyoxylate cycle, between the third and the fifth solutions. In other words, under aCFP there are only (5  3  1)  3 pathway solutions with the same length as the Glyoxylate cycle pathway. In particular, under the simulated computational conditions, this cycle was recovered as the third solution (black dot). CFP approach will recover it within the intervals third to seventh, being recovered in the fifth solution. Finally, AP needs 26 solutions before recovering the Glyoxylate cycle, obtaining pathways of the same length between the 21st and the 40th solutions. First, we analyze the differences between aCFP and CFP. Both approaches show a similar behavior, however the white bars for aCFP are always equal or better than the dark gray bars for CFP. In particular, M and R pathways are always recovered earlier via aCFP, whereas in P and Q pathways aCFP outperforms CFP in most cases. This confirms that including the AMM information into CFP helps in calculating the canonical solutions faster. In contrast, significant differences arise when enumerating paths at the atomic level rather than at the metabolic level. It is clear that AP needs more solutions to assure that the canonical pathway is recovered. Aiming at understanding the mechanisms leading to the differences in, we now examine the first solutions obtained by CFP and aCFP, respectively, when recovering the arginine biosynthesis pathway (and B), corresponding to the pathway M in. In particular, we highlight the mechanisms captured by aCFP and overlooked by CFP. As discussed above, CFP guarantees effective carbon exchange between its constituents but not between the source and the target metabolites. This is illustrated in, where it can be observed that no carbon atom from L-Glu (source) reaches L-Arg (target). Inwe present the first pathway obtained by the aCFP approach, which is precisely the canonical pathway. This pathway conserves three atoms from the source to the target metabolite. It should be pointed out that mappings frommay involve errors, i.e. inthe third carbon of L-Glu is being decarboxylated which usually takes place at the first carbon. Note, however, that developing an error-free atomic fate database goes beyond the scope of this article.shows six atomic paths for the same metabolic solution, namely the glycogen biosynthesis (). However, most applications in systems biology demand information regarding the active metabolites and enzymes. Therefore, enumerating solutions as done by aCFP prevents redundancy without loss of relevant information. Summarizing, we have shown here that extending CFP to prevent solutions with no carbon flux between the source and target metabolites facilitates the recovery of canonical pathways. We expect the differences between aCFP and other approaches to increase with the size of the metabolic network under study and when all the carbon fates are included. However, several questions arise as to the feasibility of applying aCFP to genome-scale metabolic networks. In the next section, we shall inquire if extending the scope of aCFP to large metabolic networks is computationally feasible.
Genome-scale metabolic networkWe considered here the E. Coli genome-scale metabolic reconstruction presented in. We adopted this network on account of the recent publication of its computationally generated atomic fate reconstruction ().Unfortunately, these in silico methods still require further research so as to provide a completely error-free atomic reconstruction. However, the data in Ravikirthi et al., 2011 can be used for testing the computation times of aCFP in genomescale networks, which are not severely affected by atomic mapping errors. In addition, in order to reduce the impact of errors in the comparison between aCFP and CFP, the carbon graphs for both approaches were defined based on the same set of AMMs, keeping in mind that if l2A i , m2A j and e lmr  1 then d ijr  1. Summarizing, this metabolic network comprises a total of 1972 metabolites and 3234 reactions (after the splitting of reversible reactions) leading to a system of aCFP equations with around 75 000 constraints to be satisfied by 35 000 variables.compares the accumulated computational time required by aCFP and CFP to calculate 1000 paths between glucose (D-Glc) and Pyruvate (Pyr). These pathways were calculated in a regular laptop (Intel Core i5-2.53 GHz and 4GB of RAM) using the IBM ILOG CPLEX 12.5 solver, which reduces the problem to 13 834 constraints and 12 660 variables through automatic algebraic manipulation/substitution. Particularly,shows that aCFP calculated 1000 paths in $4 h, on average one path every 15 s. Although aCFP turned out to be around two and five times slower than CFP when Q  1 and Q  3, respectively, it is clear that this result shows that aCFP can be applied in genome-scale networks as the computational time required is not excessive. For the same biological question, i.e. pathways from D-Glc to Pyr in E. coli genome-scale metabolic network,represents the number of solutions of a particular length using aCFP (Q  1 and Q  3) and CFP, respectively. Note that as we are enumerating pathways in ascending length order, the computation of solutions of a particular length implies the previous computation of shorter solutions. Differences are clear. For example, we found 411 paths of length 12 with CFP, 67 with aCFP when Q  1 and only 28 when Q  3. These differences increase as pathway lengths increase, e.g. CFP was unable to enumerate all paths of length 13 within the first 1000 solutions, while aCFP computed all solutions of length 19 for Q  3. After a general inspection of, we can conclude that the number of feasible pathways is dramatically reduced after including atomic mapping information. In particular, the pathways calculated by CFP but neglected by aCFP are, precisely, those not guaranteeing carbon exchange between the source and the target metabolites. It is important to note that such pathways are not biologically relevant. We also emphasize the importance of Q, which determines both the quality and quantity of feasible pathways. We found that as Q increases, the number of feasible pathways is also considerably reduced. Overall, we can conclude that aCFP improves on CFP in terms of the ability to generate relevant pathways as the network size increases.
DISCUSSIONPathway analysis tools are a powerful strategy to study metabolic processes in the context of 'omics' data. We recently introduced a novel pathway concept termed CFPs, which was benchmarked with existing approaches, finding a clear progress over the state of the art (). CFPs approach has been shown to be particularly effective to determine linear pathways from a given source to a target metabolite. In other works, we illustrate the versatility of CFPs approach for different applications. In the first work we extract key pathways based on gene and protein expression data that underlies the acetate overflow issue in E. coli cell cultures. In the second work, based on CFPs, we interpret metabolomics data in different neurological disorders (). Despite the potential of CFPs, improvements are still possible. In particular, while the underlying graph of metabolites guarantees carbon exchange in each intermediate step of the path, this is not always achieved between the source and target metabolites and false-positive solutions may arise. These pathways often lack biological interest, particularly when studying biosynthetic or degradation routes of a metabolite. To overcome this issue, we amend the formulation in, so as to account for atomic fate information. This approach was termed aCFP. In Section 3, by means of a side-by-side comparison in a medium scale metabolic network, we show that aCFP provides more biologically relevant pathways than CFP, because canonical pathways are more easily recovered, which reflects the removal of false positives. Note here that CFP represents a state-of-the-art approach and it is challenging to obtain a notable improvement over a high-quality approach. In particular, in our 18 canonical pathway analysis, CFP (and aCFP) recovered the solution in 12 cases. Consequently for these 12 pathways CFP cannot be outperformed by any other approach. Nevertheless, in those six cases in which CFP did not recover the canonical pathway in the first solution, aCFP improved the results obtained by CFP in four out of the six cases, some of them significantly (e.g. arginine biosynthesis pathway). The limited size of the metabolic network considered in Section 3.1 makes it difficult to obtain large differences between aCFP and CFP. However, in Section 3.2 we used a large-sized genome-scale metabolic network and found remarkable differences between aCFP and CFP in finding pathways between glucose and pyruvate, as observed in. Results in Section 3.2 also demonstrate that aCFP can be successfully applied to genome-scale metabolic networks. However, the performance of aCFP is intimately tied to the quality of the atomic reconstruction under consideration. Although there are high-quality manually curated mediumscale atomic reconstructions, genome-scale atomic models generated by means of in silico methods still require further research so as to provide atomic reconstructions free from errors. Thiswork will be also valuable for those conducting and modeling isotope labeling experiments, the most quantitative technology to infer reaction fluxes (). There are other biological mechanisms demanding pathways assuring exchange of different atoms, e.g. reactive oxygen species (ROS) in different applications in health (); nitrogen assimilation in bacteria (). aCFP can be easily adapted so as to guarantee any atom exchange, simply by introducing the atomic reconstructions into the model presented here. Overall, combining CFP with high-quality atomic reconstructions further improves the accuracy of predicted pathways. Therefore, as high-quality atomic reconstructions become available, aCFP substitutes the CFP approach, as 'omics' experimental information can be integrated in a similar manner and we expect to obtain more reliable results. With the increasing amount of 'omics' data, tools such as the one presented here will be essential to obtain relevant insights from them.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.Pey et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Atomic trace data and carbon flux paths at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
