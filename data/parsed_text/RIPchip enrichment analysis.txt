Motivation: RIP-chip is a high-throughput method to identify mRNAs that are targeted by RNA-binding proteins. The protein of interest is immunoprecipitated, and the identity and relative amount of mRNA associated with it is measured on microarrays. Even if a variety of methods is available to analyse microarray data, e.g. to detect differentially regulated genes, the additional experimental steps in RIP-chip require specialized methods. Here, we focus on two aspects of RIP-chip data: First, the efficiency of the immunoprecipitation step performed in the RIP-chip protocol varies in between different experiments introducing bias not existing in standard microarray experiments. This requires an additional normalization step to compare different samples and even technical replicates. Second, in contrast to standard differential gene expression experiments, the distribution of measurements is not normal. We exploit this fact to define a set of biologically relevant genes in a statistically meaningful way. Results: Here, we propose two methods to analyse RIP-chip data: We model the measurement distribution as a gaussian mixture distribution , which allows us to compute false discovery rates (FDRs) for any cutoff. Thus, cutoffs can be chosen for any desired FDR. Furthermore, we use principal component analysis to determine the normalization factors necessary to remove immunoprecipitation bias. Both methods are evaluated on a large RIP-chip dataset measuring targets of Ago2, the major component of the microRNA guided RNA-induced silencing complex (RISC). Using published HITS-CLIP experiments performed with the same cell line as used for RIP-chip, we show that the mixture modelling approach is a necessary step to remove background, which computed FDRs are valid, and that the additional normalization is a necessary step to make experiments comparable.
INTRODUCTIONGene expression is a highly complex process that is controlled on multiple levels by various proteins and RNAs. Various experimental protocols have been established to measure expression levels of mRNAs or proteins, targets of transcription factors or post-transcriptional regulators and many other parameters of gene expression in a genome-wide manner. Each step of such a high-throughput experiment may introduce systematic errors (bias) or random variation (noise) into the generated data, and specialized methods are necessary to deal with particular kind of bias and noise and to answer specific questions using highthroughput data. The most widely used high-throughput experiments are based on microarrays or next-generation sequencing (NGS) and are designed to measure the amount of all mRNAs in one or multiple conditions (). Based on the raw intensities from a microarray experiment or the sequencing reads from an NGS experiment, several analytical steps are taken, including normalization, summarization and statistical evaluation (). There is a vast amount of literature describing various methods fulfilling these steps to identify differentially regulated genes (). Chromatin immunoprecipitation followed by microarray analysis or NGS (ChIP-chip/ChIP-seq) can determine the targets of DNA-binding proteins and has successfully been applied to a wide range of transcription factors and cell types (). In addition to the above-mentioned analysis methods necessary for microarray and NGS data, it has been recognized that additional methods are necessary to successfully determine target sites on the genome, and thus a variety of methods is described in the literature (). In recent years, it has become apparent that transcriptional regulation is only one part of the machinery carrying out gene regulation. RNA-binding proteins (RBPs) and RNA-binding ribonucleoproteins (RNPs) play important roles and are responsible for splicing, RNA editing, regulation of translation and RNA degradation (). These processes are highly regulated by sequencespecific binding of RBPs or RNPs to the mRNA. MicroRNAs are small 2024 nt long RNA molecules, which have emerged in recent years as important post-transcriptional regulators involved in all known multicellular organisms. They play important roles in development, tumorigenesis and viral infection. They act by guiding the RNA-induced silencing complex (RISC) to mRNAs by binding to their 3 0 untranslated region (3 0-UTR) in a sequence-specific manner, which leads to inhibition of translation or RNA degradation (). A powerful experimental high-throughput technique to detect targets of RBPs or ribonucleoproteins, such as RISC, is based on immunoprecipitation (IP) of the RBP or RNP with associated *To whom correspondence should be addressed. mRNAs followed by microarray or NGS measurement (RIP-chip/RIP-seq) (). Targets of the RBP/RNP are enriched in the RIP experiment in comparison with a control measurement using an unspecific antibody or total RNA. Novel techniques including HITS-CLIP, iCLIP and PAR-CLIP also include cross-linking of the protein to the mRNA followed by digestion of the unprotected mRNA to determine the precise location of the target site (). The main question in a RIP-chip experiment is to determine the set of target genes of the immunoprecipitated protein. A basic answer is a sorted list of enrichment values that can be computed for each gene by dividing the intensity value in the IP fraction microarray by the intensity in the control microarray. This is very similar to standard differential gene expression (DE) experiments: Here, differentially regulated genes can be determined by a sorted list of fold changes computed for each gene by dividing the intensity in condition A by the intensity in condition B. Consequently, RIP-chip data are often analysed using standard methods borrowed from the DE setup such as fold changes (), t statistics () or moderated t statistics (). However, as indicated above, additional experimental steps may introduce additional bias: In contrast to log fold change distributions of DE experiments, log enrichment distributions of RIP-chip experiments are not normal but typically have heavier right tails (, see also). This is an indication that RIP-chip is able to separate true targets from the background very efficiently. Here, we exploit these skewed distributions to estimate the biological significance of genes. This is different from the statistical significance usually computed for DE experiments, where P-values are related to the reproducibility of the measurements and not to biological relevance. The above-mentioned question about the set of target genes in a RIP-chip experiment only considers a single condition, in contrast to a DE experiment. However, especially for RISC-IP experiments, an additional question is to determine differential microRNA targets between two or several conditions. For instance, if these conditions are control and transfected microRNA (), differential targets would be targets of the transfected microRNA, and if there are uninfected and virusinfected cells, differential targets would include targets of viral microRNAs (). The answer to this question can be given by genes that are more enriched in condition A than in condition B, either by choosing two cut-offs on the corresponding enrichment values (i.e. at least x fold enriched in A and at most y fold enriched in B) (), by computing differential enrichment values as the ratio of the two enrichment values () or by a mixture of both approaches (). All answers to this question necessarily have to compare enrichment values (i.e. ratios of intensities) of the conditions. However, IP efficiencies may vary between independent experiments, and it is important to account for this bias when comparing enrichment values. Obviously, the same problem exists for the summarization of replicate measurements (see Figs 1 and 4). Here, we develop a suite of methods to properly analyse RIP-chip datasets, which take care of the unique properties of such data introduced by the IP: First, we use a Gaussian mixture model approach to find statistically meaningful cut-offs for enrichment values. We show that this approach can be used to filter unexpressed genes, that it allows to compute false discovery rates (FDRs) for sets of biological significant genes and that it is in fact a necessary step to make experiments comparable with each other. We also address the problem of differing IP efficiencies by introducing a principal component analysis (PCA)-based method to normalize enrichment distributions in a data-dependent manner. We use publicly available HITS-CLIP data measured for the same cell lines () as standard-of-truth for evaluation and show that the proposed methods provide significant improvements for the analysis of RIP-chip data.
METHODS
Data processingThe RIP-chip data for this article has been taken from our study of herpes viral RISC-IP experiments (). After the publication of the original study, additional replicates have been measured, and all chips including the new ones have been processed as described (). Briefly, RNA from Ago2-IPs and either BrdU-IPs or total RNA have been measured on Affymetrix GeneST arrays, and all raw data have been normalized using robust multi-array average (RMA) (The distributions of the enrichment values are shown. Although the intensity distributions of the various microarrays are properly normalized using RMA (see Supplementary), the enrichment distributions are significantly different from each other. This is a consequence of differing IP efficiencies and must be accounted for when analysing the respective data data of. We also repeated the same analysis using PAR-CLIP data for Jijoye that has been measured and analysed as described inin the laboratory of Markus Landthaler at the MDC Berlin (will be published elsewhere).
Mixture model fittingGaussian mixture models for sets of log enrichment values are fitted using the Mclust package in R (). Z-scores for each gene can then be computed using the background distribution:Here, e(g) is the log 2 enrichment of gene g, bg and bg are the mean and standard deviation of the background component of the gaussian mixture model (which we always take as the component with the smaller mean). The FDR for a cut-off c is defined as the expected fraction of background genes g b with e(g b )4c among all genes g with e(g)4c: FDR c    1  cdf bg c   gje g  4c   : jBGj 2 cdf bg is the cumulative distribution function of the background component of the mixture model and BG j jthe expected number of background genes (estimated by the mixture model). This is mathematically equivalent the Benjamini-Hochberg multiple testing correction () for the one-sided P-values derived from the z-scores in Equation (1) multiplied with the expected fraction of background genes. For the running window approach (see Section 3.1), we first selected a window of w genes with the smallest Ago2-IP intensities and fitted the mixture model (first window). Then we removed the s genes with smallest Ago2-IP intensities and added the next s smallest still unselected genes and again fitted a mixture model. This step was repeated until the window reached the top Ago2-IP intensities. For the analyses, we chose w  1000 and s  20. We use two metrics to evaluate the fit of background and target distributions:bg and t are the background and target components of the mixture model, respectively, E is the set of log 2 enrichment values used to fit the mixture model and ksp E,  E   is the P-value of the Kolmogorov Smirnov test comparing the distribution of E with the distribution of negated enrichment valuesE. Thus, the distance score d(bg, t) measures the distance of the background and target distributions with respect to the width of the background distribution, whereas the asymetry score skew(E) measures the skewness of the distribution without the need to fit a mixture model.
PCAPCA is performed using the function prcomp in R. When there are k experiments/replicates and, therefore, k log 2 enrichment values per gene, PCA is applied to the k-dimensional space of genes. The first principal component is the direction of the greatest variance, and is used to compute the summary enrichment value ^ e g   of gene g by taking the dot product of the replicate measurement z-scores z 1 g  ,. .. , z k g   and the direction of the first principal component PC1:The geometrical interpretation of this weighted average of the replicate enrichment values is that the dot product does an orthogonal projection of the k dimensional point g onto the first principal component and measures the distance to the origin. It is not necessary to centre the points before PCA, as we perform PCA on the z-scores derived from the mixture modelling approach, the point cloud is naturally centred at the means of the background distributions, and centring at the overall mean may not be appropriate. Also, we perform PCA only on targets (as defined by an FDR of 1%). This is necessary because if the number of background genes is much higher than the number of target genes, stochasticity in the background could mask the effects in the target genes to some extent. Differential targets will deviate from this vector in a specific direction: e.g. if we have two replicates of two conditions A and B and, therefore, an enrichment vector z a1 , z a2 , z b1 , z b2 , any gene that is target specifically in A has greater enrichment in A than in B: z a1 and z a2 is greater than z b1 and z b2. Thus, if there are enough differential targets, the second principal component will point into the direction of the deviations of their enrichment vectors. Therefore, the summarized differential enrichment value ^ e d g   can be computed similarly to the overall summary enrichment value in Equation 5 by taking the dot product of the z-score vector z 1 g  ,. .. , z k g   and the direction of the second principal component PC2:Both the enrichment value ^ e g   and the differential enrichment value ^ e d g   incorporate a linear normalization that removes bias owing to differing IP efficiencies.
RESULTS
Select relevant genesThe first step in our analysis of RIP-chip data is the filtering of unexpressed genes. On modern microarrays, such as the Affymetrix GeneST arrays, used for our data, probesets against all known human genes are available. Even if virtually all probesets have non-zero intensities, we can expect that only a fraction of all genes is expressed in a specific condition. We noticed that the asymmetry of the log enrichment distribution is not observable over the whole range of IP intensities (seeand Supplementary). For low intensity genes, the distribution indeed looks normal, which is expected for a set of genes that is not or almost not expressed. Therefore, we used a running window approach for fitting the mixture model (see Section 2) and evaluated each window with respect to the distance of the two components of the fitted model and the extent of asymmetry (see). At intensity values %5, a significant increase in both scores was observable. We chose to use all genes above an intensity cut-off where d(bg,t)41 and skew(E)42, i.e. where the means of the two mixture components are at least one standard deviation away from each other, and where the asymmetry becomes significant with P-value 0.01. We performed this running window approach for all previously published RIP-chip experiments fromand for two additional replicates of the control cell line DG75-eGFP and the Epstein-Barr Virus (EBV)-infected cell line Jijoye, respectively. For the additional DG75-eGFP replicates, the microarrays showed poor RNA quality and applying our running window approach to these bad quality experiments indeed did not yield a mixture model (see). Thus, we can apply our method also for filtering poor quality experiments RIP-chip enrichment analysis from a dataset, and we excluded the two additional DG75-eGFP replicates from further analyses accordingly. We also noticed that the background distribution is not the same over the whole spectrum of intensity values. Therefore, we computed z-scores for each gene using mean and standard deviations obtained from the running window approach. This is very similar to well-known non-linear normalization techniques (), with the difference that the model for normalization is not fitted to all data but only to the background.
Determining microRNA targetsComputing z-scores from the raw enrichment values based on the fitted background distribution can be interpreted as a subtraction of this background. The background here does not consist of the unexpressed genes, but of the expressed but not targeted genes. This background subtraction step can have a great effect: For the four Jijoye RIP-chip replicates, we observe that without subtraction, it seems that the IPs of replicates three and four were more efficient than of the other two replicates, as there are more genes enriched 42-fold, for instance (seeand b). However, after background subtraction, replicates one and two show a larger fraction of enriched genes. Obviously, if an IP was more efficient than another, its induced ranking of genes will better predict a gold standard of microRNA targets. HITS-CLIP is an experimental technique that is able to identify target sites of microRNAs with high confidence (). Thus, using the publicly available HITS-CLIP data for Jijoye (), we can construct a gold standard by taking all genes as true targets that have at least n HITS-CLIP target sites. Independent on the choice of n, replicates one and two induce rankings that are in better agreement with HITS-CLIP data (seefor n  1), and thus, background subtraction is a necessary step. We also repeated this analysis using in-house, unpublished PAR-CLIP data for Jijoye ($14.000 sites on $5500 genes, will be published elsewhere) leading to the same conclusions (data not shown). Furthermore, we propose that the fitted background distribution allows to compute valid FDRs for microRNA targets. For a cut-off c, the FDR is defined as the expected fraction of non-target genes. Obviously, a non-target gene should contain less HITS-CLIP target sites than target genes on average. If we compute the average number of HITS-CLIP target sites per gene for the set of targets defined by cut-off c on the RIP-chip data, the dependence on the corresponding FDR should thus be linear with a negative slope: For instance, if the FDR is twice as high, we expect twice as many non-target genes. Therefore, the average number of HITS-CLIP target sites per gene should decrease by a factor that is dependent on the true average number of HITS-CLIP targets sites per target gene and non-target gene. For all four replicates, the plot of the FDR against the fraction of HITS-CLIP target sites per gene is roughly a straight line (see Supplementary), and even if the enrichment/z-score distributions are different, the slopes and intercepts of linear fits to all four plots are very similar to each other (see Supplementary). This also allows us to estimate the average number of HITS-CLIP target sites per target gene and non-target gene by taking the value of the linear fit at FDR  0% and FDR  100%, respectively. Based on the RIP-chip data as a reference, we can estimate that HITS-CLIP produces %0.8 target sites per expressed target gene and %0.2 target sites per non-target gene (see Supplementary).
Taking replicates into accountAs indicated above, IP efficiencies between replicate experiments may be very different from each other. These differences introduce bias into such a dataset, and no RIP-chip study known to us has properly accounted for that. Our mixture model approach also cannot remove this bias from RIP-chip data. The problem becomes obvious when we visually inspect scatterplots across replicate enrichment values/z-scores. For replicates one and two of our Jijoye RIP-chip data, the main cloud of target genes roughly scatters around the main diagonal in, whereas for the comparison of replicates one and three, the diagonal is far away from the main cloud (). The canonical way for summarizing replicates is to take the unweighted mean of the enrichment values/z-scores. This can geometrically be interpreted as an orthogonal. In b and c, the distance and asymmetry scores are plotted for all windows for replicate one and three of the DG75-eGFP experiment. Starting from intensity values of %5, the distribution seems to be a mixture of two normal distributions. In contrast to the first replicate, the third does not show the expected behaviour of the mixture of a background and target distribution, which was a consequence of poor RNA quality in this experimentprojection onto the diagonal vector d  (0.25, 0.25, 0.25, 0.25) and measuring the distance of the projected point to the origin. Thus, all four-dimensional points lying on any hyperplane orthogonal to d would get the same summary value. Such a hyperplane would not cut the main cloud of target genes in the scatter plot of replicates one and three orthogonally, which is only a consequence of different IP efficiencies. However, the first principal component of this point cloud defines such orthogonal hyperplanes, and we use the components of the corresponding rotation vector to compute a weighted mean accounting for all linear effects of differing IP efficiencies. We can evaluate this additional step again by using the HITS-CLIP data as reference. We consider the differences between each normalized summary value and the corresponding un-normalized value. The difference for HITS-CLIP sites containing genes is statistically significantly greater than for other genes (P510 14 , KolmogorovSmirnov test, see), and the more HITS-CLIP targets sites are found for a gene, the more pronounced is its positive change.
Determining differential microRNA targetsTo find differential microRNA targets, experiments of different conditions must be compared, i.e. genes must be identified, which are more enriched in one condition in comparison with the other. Obviously, a similar problem as in the summarization of replicates plays a role: How can we account for differing IP efficiencies if we compare four replicates of the EBV-infected cell line Jijoye to the two replicates of the control cell line DG75-eGFP? We can extend our method for summarizing replicates to the differential problem: The first principal component corresponds to the direction of greatest variance, which is the direction of common targets under the assumption that there are enough common targets (both are B cell lines). Differential microRNA targets exclusive to Jijoye should have positive enrichment values in the Jijoye RIP-chip replicates and smaller values in DG75-eGFP. These targets induce variance into the corresponding direction of the six-dimensional space such that the second principal component corresponds to the IP efficiency normalized direction of differential targets (see). To compare the PC2 normalized differential enrichment values to the un-normalized differential enrichment (i.e. subtract the enrichment mean of DG75-eGFP from the mean of Jijoye), we exploit the fact that microRNAs are able to downregulate expression of target mRNAs (), and that mRNA levels were measured as well in the RIP-chip experiment: x fold downregulated genes get consistently andthat the IPs of replicates three and four were more efficient based on the number of genes enriched42-fold (see corresponding inset). After background subtraction, however, replicates one and two show a larger fraction of enriched genes. Replicates one and two have significantly better correspondence to the HITS-CLIP experiment performed in Jijoye, which shows the need for background subtractionFig. 4. Differing IP efficiencies require normalization before computing summary values. In contrast to replicates one and two of the Jijoye RIP-chip experiments, where IP efficiencies are very similar (a), replicate three is different (b). Normalizing replicates using the first principal component (PC1) significantly improves the summary z-score with respect to HITS-CLIP data as reference: The difference of the normalized score to the un-normalized score is significantly greater for genes with HITS-CLIP target sites (coloured distributions) in comparison with all differences (black distribution). The improvement is even more pronounced for genes with multiple HITS-CLIP target sites (c) RIP-chip enrichment analysis significantly higher scores after normalization as compared with all other genes, independent on the choice of x (see). Thus, after normalization, significantly more RIP-chip targets are downregulated than without normalization (independent on the particular threshold used to define RIP-chip targets and downregulated genes).
DISCUSSIONA similar approach to our Gaussian mixture modelling (GMM) has already been used in (); however, GMM was applied to summarized enrichment values, and log odds ratios (LOD scores) were computed as the ratio of the two scaled mixture components. LOD scores were then used in two different ways: First, they were directly subjected to gene set enrichment analysis (), where they have no advantage over directly using enrichment values (as the weighted KolmogorovSmirnov statistic used for gene set enrichment analysis is non-parametric and only sensitive to the ranking of the genes). Second, the authors used a cut-off of LOD 40 to define a set of targets. However, choosing a cut-off based on the LOD is still arbitrary and not statistically meaningful in contrast to our FDRs. If we used the LOD to define a cut-off, we would get FDRs ranging from 5 to 15% in our experimental dataset. We could show that our refined mixture modelling approach has several advantages: First, it allows us to filter unexpressed genes. When comparing two conditions (e.g. virus infected cells expressing viral microRNAs versus non-infected cells), expression of a gene targeted by cellular microRNAs below the detection limit of the microarray in one, but not the other cell line, would result in the misinterpretation of this to be a target of the viral microRNAs. Second, for experiments with poor IP efficiency, we observed extremely poor distance and asymmetry scores over the whole intensity range and could remove these bad replicates from further analyses. Third, it helps to compare experiments with each other (see) and finally, we can compute valid FDRs. Furthermore, the comparison of the RIP-chip FDRs to HITS-CLIP data revealed important properties of both the RIP-chip and HITS-CLIP techniques: Both are designed to identify microRNA targets, and, naturally, they agree significantly (P52.2  10 16 , KolmogorovSmirnov test), a fact that is also reflected in the negative slope of the linear fit to the FDR against sites per gene plot. However, the agreement is not perfect, and we estimate an average number of %0.8 HITS-CLIP target sites per RIP-chip target gene and of %0.2 per RIP-chip non-target gene. Even if HITS-CLIP target sites may be erroneous, and the CLIP techniques may implicate additional bias (), we expect that not all of the %0.2 sites per background gene are true errors: Such inconsistencies may be due to differing experimental steps (e.g. different antibodies used for IP) or due to differences the Jijoye cell cultures have accumulated in the two laboratories since the cell line has been established. Also, as HITS-CLIP does not control for target mRNA abundance, it may find several weak sites on highly expressed genes that are biologically irrelevant (i.e. not contributing significantly to regulation of its expression). Such a gene should not be enriched in a RIP-chip experiment and could explain many cases of HITS-CLIP sites on background genes. Thus, even if CLIP techniques have several advantages (e.g. they are able to identify target sites instead of target genes), RIP-chip is still a useful complementary method. The second, novel method introduced in this article is to use principal components to normalize for different IP efficiencies. Evaluation using HITS-CLIP data or the differential expression of target genes shows that the normalization improves results significantly. The normalization proposed can only account for linear bias between experiments. This very lenient normalization appears to be sufficient, as affine offsets are already removed by the mixture model approach, and non-linear effects are not recognizable in a visual inspection. Our proposed methods do not include a way to compute statistical significance, e.g. like a t-test for standard DE experiment. However, this can be accomplished in a straight-forward way, as all available tests could directly be used after our linear normalization has been applied to a dataset.. Differing IP efficiencies require normalization before computing differential targets. The second principal component in a is able to discover the experimental structure. Its loadings can be used as weights to compute a differential enrichment value that is normalized for different IP efficiencies, in contrast to the standard way of subtracting the mean log enrichment in DG75-eGFP from the mean log enrichment in Jijoye (corresponding to weights indicated in red). The difference distribution of the normalized differential enrichment values and the un-normalized ones is shown in b. Differential targets are expected to be downregulated, and indeed, the difference is significantly greater than background for downregulated genes. As illustrated in c, this effect is more pronounced the higher the downregulation is F.Erhard et al.
CONCLUSIONIn this article, we presented methods we developed to analyse RIP-chip data. In comparison with standard DE experiments, the additional IP step introduces special requirements for the data analyis. First, we use GMM to determine biologically significant target genes; second, we use a linear normalization technique based on PCA to remove bias introduced by the IP. The evaluation of both methods using independent data showed a significant improvement in comparison with standard approaches: The background of not enriched genes can be removed, valid FDRs can be calculated and the comparability of both replicates and differential experiments is improved.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
F.Erhard et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
