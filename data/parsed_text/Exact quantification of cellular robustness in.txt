Motivation: Robustness, the ability of biological networks to uphold their functionality in spite of perturbations, is a key characteristic of all living systems. Although several theoretical approaches have been developed to formalize robustness, it still eludes an exact quantification. Here, we present a rigorous and quantitative approach for the structural robustness of metabolic networks by measuring their ability to tolerate random reaction (or gene) knockouts. Results: In analogy to reliability theory, based on an explicit consideration of all possible knockout sets, we exactly quantify the probability of failure for a given network function (e.g. growth). This measure can be computed if the network's minimal cut sets (MSCs) are known. We show that even in genome-scale metabolic networks the probability of (network) failure can be reliably estimated from MSCs with lowest cardinalities. We demonstrate the applicability of our theory by analyzing the structural robustness of multiple Enterobacteriaceae and Blattibacteriaceae and show a dramatically low structural robustness for the latter. We find that structural robustness develops from the ability to proliferate in multiple growth environments consistent with experimentally found knowledge. Conclusion: The probability of (network) failure provides thus a reliable and easily computable measure of structural robustness and redundancy in (genome-scale) metabolic networks.
IntroductionA major characteristic of biological systems is their 'robustness', i.e. the ability to perform normally under the presence of perturbations (). Despite its fundamental importance, robustness is hard to quantify and a comprehensive, quantitative understanding of robustness has yet to be developed (). The problem is augmented by the fact that robustness is an extremely general concept which obstructs efforts for an exact definition (). Clearly, robustness arises as a consequence of the interactions between the components in a system. It therefore requires a network-based approach for its analysis (). In the following, we study a key aspect of cellular robustness, namely structural robustness in metabolic networks (), which is a measure of the apparent redundancy in metabolic networks. Redundancy is one reason why specific (network) functions may persist in spite of changes in the networks' topologies. Metabolic networks are particularly suitable to study structural robustness as their topologies are either well known or can be reliably reconstructed by well-established protocols (). An unbiased way to characterize all topologically feasible flux distributions in a metabolic network can be achieved in terms of elementary flux modes (EFMs) (). EFMs are steady-state pathways that use a minimal set of reactions (enzymes) in the appropriate thermodynamic directions. Biologically, they can be interpreted as simple, indivisible functional building blocks, which represent all feasible metabolic capabilities of the organism. Thus, EFMs are likely candidates to be used in a definition of structural robustness. In fact,were the first to define structural robustness by counting the number of EFMs in different situations. An alternative approach to EFMs is minimal cut sets (MCSs) (). These are minimal sets of reaction (enzyme) knockouts that completely disable a particular network functionality. MCSs are intimately connected to EFMs. Any network function can be represented by a set of EFMs. Thus, MCSs can equivalently be defined as the minimal set of reaction knockouts that prevent a set of target EFMs from carrying a steadystate flux. An MCS is therefore a so-called minimal hitting set of the target EFMs (). If the EFMs or the MCSs are known, the respective other can be calculated. Mathematically, this relationship is known as duality (). While EFMs describe the possibilities to achieve a particular function, MCSs describe the effort it takes to remove that function from the network. Thus, the size distribution of the MCSs provides a measure for the structural fragility of a network (). One major disadvantage for both measures, the EFM-based structural robustness measure as well as the MCS-based structural fragility measure, is that they presuppose the availability of the complete set of EFMs and MCSs, respectively. This is a computationally intractable problem in genome-scale metabolic models (GSMMs). Here, we present a novel method that overcomes the computational limitations and allows one for the first time to estimate the structural robustness even in GSMMs. We use MCSs to calculate the exact (structural) probability of failure (PoF) of a network. This puts the estimation of structural robustness on a theoretically sound fundament.
TheoryWe consider a metabolic network made up of m (internal) metabolites and r reactions. The network contains n EFMs. We use the support representation E  suppe to uniquely characterize an EFM, e. E is the set of all (reaction) indices i for which the EFM vector e carries any flux, i.e. suppe  fije i 6  0g; with 1 i r. We collect all EFMs in the set E  fE 1 ;. .. ; E n g. If we delete d reactions, several EFMs will get disabled. We represent a set of d deleted reactions by a cut set (CS) C d of cardinality d. C d contains the set of (reaction) indices that get deleted. A CS C d disables all EFMs involving any of the d deleted reactions. To study the impact of a deletion strategy, C d , on the network, we collect all EFMs not affected by C d in the set of the remaining EFMs,The complement of E C d is denoted by H C d and contains all EFMs that are disabled by C d : H C d  E n E C d. A minimal (irreducible) set of reaction (enzyme) deletions that completely disables a given set of target EFMs, T, is called an MCS, M (). For any target set T we collect all l MCSs in the set of MCSs, M  fM 1 ;. .. ; M l g. Finally, we collect all 1 i b  r d ! possible CSs C d i of cardinality d in the set of CSs, C d  fC d 1 ;. .. ; C d b g.
Structural robustness: RdFor a given number d of deletions, Behre et al. (2008) defined the network's structural robustness Rd as the average ratio of the number of remaining EFMs to the total number of EFMs over all possible combinations of exactly d knockouts, i.e.We show in the Supplementary material that the network's structural robustness only depends on the cardinality of the network's EFMs and can easily be calculated for any number of deletions d byThus, network structural robustness is merely determined by the EFMs' length.
PoF: F(d)For a given number of deletions, d, we define the network's PoF, F(d), as the ratio of the number of CSs that disable a particular network objective, obj, to the total number of all possible combinations of exactly d knockouts, i.e. F obj d : jC d obj j jC d j :CSs that disable a particular objective (i.e. the elements of C d obj ) are either MCSs or supersets of MCSs disabling 'obj'. We show in the Supplementary material that the PoF can be calculated bywhere M J  [ j2J M j and J is a (multi)-index over all power sets of the indices f1;. .. ; lg of the set M of MCSs blocking 'obj'. Note that the definition of the PoF requires specification of an objective, that can be the operation of the whole system or of a particular function. A typical cellular function is the production of biomass (BM). Thus, F BM d measures the probability that the deletion of d reactions is lethal. In what follows we will drop the index for the objective and implicitly assume that the production of BM is targeted, unless stated otherwise.
Exact quantification of cellular robustness2.3 Overall structural robustness R and overall PoF (OPoF) F Both Rd and F(d) are defined for a specific number of reaction deletions. Following, we define the overall structural robustness, R, if at most (all) r reactions are knocked out, as the weighted sum of all possible Rd (),Analogous to the structural robustness we define the OPoF, F asHowever, their choice is difficult to interpret in terms of a probability distribution. That is why we opted for an appropriately selected probability distribution function for the calculation of F. w F d may be naturally modeled by a binomial distribution,which estimates the number of loss-of-function mutations with exactly d reaction deletions assuming a constant (reaction) mutation rate p. In typical metabolic networks, the number of reactions r is large and the mutation rate is small. We therefore approximate the binomial distribution with the simpler Poisson distribution, w F d : k d expk=d!;with k  rp. Rd; R; Fd and F all range between 0 and 1. However, while R  1 indicates a totally robust network, F  1 denotes the reverse, a completely fragile network.
Implementation and computationThe computation of the structural robustness Rd according to Equation (2) is straight forward as long as the complete set of EFMs is known. The computation of the PoF is computationally more demanding as the number of summands in the sum of Equation (4) explodes combinatorially. In the following, we will outline countermeasures to estimate the PoF even in GSMMs.. Aerobic growth for Enterobacteriaceae was simulated on minimal medium with glucose or melibiose as sole carbon source and for Blattibacteriaceae with full medium (for media compositions see Supplementary). All reactions that could not carry a steady state flux under any circumstances for the given growth media were removed from the original models. m and r refer to the (remaining) number of internal metabolites and reactions, respectively, for fully consistent models (represented by the respective internal stoichiometric matrix, S). n and n BM refer to the total number and the number of BM producing EFMs in the respective models. An EFM analysis was not applicable (n/a) for GSMMs.Algorithm 1 implements Equation (4) by calculating the total number of CSs for given deletions d in a recursive way. The number of reactions in the model, as well as all mcs with a cardinality up to the current number of reaction deletions are needed for the calculation. The algorithm calculates the number of all possible CSs for a single MCS by the function CHOOSE, which computes the binomial coefficient for r  combCd d  combCd ! , where combCd is the number of deletions resulting from the combination of MCSs. In order to avoid the consideration of a CS multiple times those CSs that have already been calculated by other MCS, indicated by their index, are subtracted. This is done by creating an intermediate CS by a logical OR operation and then following the inclusionexclusion principal () in a recursive procedure. Algorithm 1 was implemented as multi-threaded C program which is available at https://github.com/mpgerstl/networkRobustnessToolbox.
ResultsIn the following analysis, we used k  0:5, unless stated otherwise.
F reliably identifies structural fragilityWe used a medium-scale metabolic model (MSMM) that describes the core metabolism of Escherichia coli (seefor an overview of the topological properties of the models used) to study the influence of the carbon source on the structural robustness and the PoF (see). In all cases, a complete EFM and MCS analysis was feasible. We found that both measures indicated a strong impact of the carbon sources although with opposing trends. The OPoF was lowest for growth on glucose and highest for growth on acetate. We observed that in all three growth environments the PoFs F(d) could be well approximated (coefficient of determination, R 2 > 0:999) by a1  bexpcd with three free parameters a, b and c (see Supplementary). R however ranked growth on acetate to be most robust and growth on glucose or glycerol similarly robust but far behind growth on acetate. According to Equation (2) this implied that for acetate EFMs were on average shorter then for glucose (see Supplementary). Finally, the simple ratio between the number of BM producing EFMs and the total number of EFMs revealed yet another ranking with the highest ratio for growth on glycerol and the lowest ratio for growth on acetate (see Supplementary). Comparing the different measures, we found that only the OPoF scored the (lack of) structural robustness in E. coli consistently to previous analysis ().
R and F can be calculated exactly in MSMMsJudged by the number of EFMs, the three growth models significantly differed in size (see). Yet all structural robustnessvalues were calculated within few seconds for any number of reaction deletions. As the number of summands in Equation (4) grew excessively for high number of reaction deletions, d, the calculation of F(d) was more demanding. We found an exponential increase in the number of recursions for Algorithm 1 (see). Our optimized implementation scaled consistently better than that and allowed us to evaluate F(d) in the largest model, EColi_core  glc, up to d  9 in < 10 min using 10 threads on an Intel
R and F are determined by the first few deletionsWe analyzed the contribution of higher-order deletions to the overall structural robustness and OPoF, respectively. In the best case higher-order terms Rd and F(d) vanish for d > d 0 causing no error in the sums of Equations (5) and (6). In the worst case higher-order. Structural robustness and PoF in a core metabolic model of E. coli growing on minimal media (see Supplementary) and three different carbon sources (glc, glucose; gly, glycerol; ac, acetate)We used all EFMs for the calculation of R and all synthetic lethals of groups of up to d 0  9 reactions for the estimation ofExact quantification of cellular robustnessterms maximally contribute to the sums. Thus, the maximum error e is easily calculated by setting Rd  Fd  1 for all terms d > d 0 ,where the last sum represents the cumulative distribution function of w i d with i 2 fF; Rg. We found that the resulting maximum error dropped quickly with d 0 even in huge GSMMs (see). For instance, for k 1 the e drops below 10 4 if all MCSs up to cardinality six are known. Thus, we conclude that for practical means the overall structural robustness R and the OPoF F can be approximated by the first few terms in their respective sumsFor fixed k the OPoF F depends only on the d 0 smallest MCS and consistently converges toward its true value with increasing MCS cardinality. In the E. coli example used above (see), all MCSs up to cardinality 4 were sufficient to estimate F within an error of 0.02 percentage points. However, a similar argument for the overall structural robustness R is not available. The knowledge of the d 0 shortest EFMs does not allow one to accurately estimate R. Supplementaryillustrates the error in the overall structural robustness as function of the d 0 shortest EFMs for the E. coli model used above. In that case, >55% of all EFMs were required to get within a 10% error margin.
For small k, F is well approximated in GSMMsAccording to Equation (11), the OPoF could be estimated if all low cardinality MCSs were known. Recently, von Kamp andshowed that it is in fact possible to enumerate the smallest MCSs in GSMMs. In the following, we used their approach to calculate low cardinality MCSs. We calculated all lethal MCSs up to a cardinality of 4 in GSMMs of three E. coli strains growing on minimal medium and glucose or melibiose as the sole carbon source and estimated the OPoF (see). The models represented E. coli K-12 MG1655 (iJO1366), the pathogenic enterohemorrhagic E. coli O157:H7 Sakai (iECs_1301) and the Shigella flexneri 2a 2457T (iS_1188). Comparing the three organisms against each other revealed that growth on glucose is more failsafe than growth on the alternative carbon source melibiose. In fact, growth on glucose (and glucose 1phosphate) was found to be more robust than on any other single, nitrogen-free carbon source (see Supplementary). The two E. coli were similarly robust (with a small advantage for E. coli K-12 MG1655), while the S. flexneri was most fragile. Although the difference in the OPoF was small, it is indicative as the difference in F for any two models is larger than e4. We observed the same trend not only for F but also for F(d) for all tested cardinalities d 4, as well. The GSMMs were also found to be more robust than the E. coli core model. Again, in all models, F(d) could be nicely approximated by a1  bexpcd (see Supplementary). Finally, we calculated all synthetic lethal reactions in groups of up to d 0  6 reaction deletions and evaluated the OPoF in the GSMMs of the endosymbiotic Blattabacterium cuenoti Bge (iCG238  full) and B. cuenoti Pam (iCG230  full), see, for full growth media containing all nutrients that were possibly taken up, see Supplementary Table S1 for detailed media compositions. Both strains were found to be extremely fragile with OPoFs > 26% and a maximal inaccuracy of 1  10 4 percentage points. Any three reaction deletions almost certainly killed these two strains (with a small chance of survival of <5%).
Genecentric PoFs showed same behavior as reactioncentric PoFsFor simplicity so far we analyzed structural robustness from a reactioncentric (RC) viewpoint. However, it is possible to change from an RC to a genecentric (GC) viewpoint while retaining our formalism for the PoF calculation. PoF only requires the calculation of MCSs. These can be calculated in an RC model as well as in a GC model provided that a genereaction mapping is available as Boolean function of the genes (as it is typically the case). GC MCSs consider the effect of gene knock-outs on reactions based on the evaluation of the provided Boolean rules. If the complete set of EFMs is known, GC MCSs can be calculated using an established integer programming procedure (). In GSMMs, where the complete set of EFMs is unavailable, the dual systems approach (von) can beThe OPoF was estimated by considering all synthetic lethals of groups of up to d 0  4 reactions and k  0:5. All values are listed in %The OPoF was estimated by considering all synthetic lethals of groups of up to d 0  6 reactions and k  0:5. All values are listed in %For the GSMMs the OPoFs were estimated by considering all synthetic lethals of groups of up to d 0  4 reactions and k  0:5. For these settings the estimation error was < 0.02 percentage points. All values are listed in % adopted to compute GC MCSs. The common dual approach calculates RC MCSs (ordered by ascending cardinality) by iteratively solving a mixed integer linear program (MILP) (). In order to obtain a GC MCS instead of an RC MCS the genereaction association has to be integrated into the MILP, which can be achieved by means of the so-called indicator constraints. These concepts are provided by modern MILP solvers, which allow for the Boolean coupling of reactions and their associated genes. We evaluated GC PoFs for models listed inand compared them against the corresponding RC PoFs (see). We found comparable (O)PoF values except for the MSMM of E. coli, where we observed larger differences. Yet the absolute ranking of the organisms with respect to structural robustness remained unchanged no matter if the GC or RC PoF was used.
DiscussionHere, we developed a new general measure to quantify the structural robustness (or fragility) of metabolic networks based on the (O)PoF. Both, PoF F(d) as well as OPoF F are based on MCSs and share analogies with the previously defined structural robustness measures R(d) and R which rely on EFMs (). In contrast to R, the OPoF remains computationally feasible even in GSMMs for two reasons: (i) the OPoF can be well estimated from the shortest MCSs with up to d 0 reaction cuts; and (ii) these d 0 shortest MCSs can be calculated with a MILP even in GSMMs (von). Previously, it was shown that MCSs in the (primal) network are EFMs in a network dual to the original network (). Thus, finding the shortest EFMs in this dual network is equivalent to finding the low cardinality MCSs in the primal GSMM (von). A high performance computing infrastructure is not required for this task. Thus, the OPoF is in principle an easily computable measure. However, due to the combinatorial explosion of the number of summands in F(d), see Equation (4), the evaluation is practically limited to low cardinalities. This does not cause practical problems for the OPoF F as the impact of high-cardinality MCSs on F quickly decreases (see). The slope of this decrease depends on the selected probability density that models the number of deletions that occur per mutation. Here, we used a Poisson distribution which is typically used for the study of rare events, like mutations (, and references therein). We were able to show that up to k 1 our analysis is computationally feasible on standard computer infrastructure. This is sufficient for the study of naturally occurring mutations. For instance, in E. coli a mutation rate of about 10 3 per genome and generation was found (), which is far below our limit of k 1, as we can assume that not all mutations lead to a loss of function of metabolic enzymes. All our conclusions remained valid (data not shown) if we used other probability densities like a binomial distribution or the one used by, see Equation (7). Previously, MCSs were already used to compute a so-called fragility coefficient which characterized the sensitivity of a metabolic network to deletions (). Fragility was defined for each reaction as the inverse of the average cardinality of all MCSs that were supported by that reaction. Upon averaging the reaction-specific fragility over all reactions one obtained a measure for the overall network fragility. In contrast to the here introduced concept of the OPoF, network fragility lacks a rigorous probabilistic definition and more importantly requires the complete set of MCSs for its calculation. Network fragility is therefore not applicable to GSMMs. A clear difference between the PoF and structural robustness is that the former is function oriented while the latter characterizes the network. F is calculated with respect to some particular function that fails. Typically, networks perform multiple functions at the same time, which may be differentially robust. Thus, the OPoF is not only a topological property but also a property of the associated function. For instance, it is interesting to ask (and scope of further analysis) whether two essential functions like cellular energy production and BM production are similarly robust. R on the other hand characterizes the network topology by essentially measuring the proportion of short EFMs in a network. This definition is independent of any functions performed by the network. R counterintuitively identified growth on acetate to be more robust than growth on glucose which indicates that the length of EFMs may not be an appropriate proxy for structural robustness. Even if we selected only those EFMs that support a particular target function (like BM production), and calculated R for the reduced set of EFMs, we had misidentified growth on acetate as the most robust growth environment as growth supporting EFMs on acetate were on average 'shorter' than on glucose (see Supplementary). For better understanding we illustrated this effect in a toy network in Supplementary. Thus, we propose to use the complement of the OPoF: R new  1  F as a new measure for structural robustness in metabolic networks. PoFs can be calculated equally well on the basis of reaction deletions as well as on the basis of gene deletions. Some reactions in an organism are not associated with a gene (e.g. non-catalyzed reactions, reactions with unknown annotations) and can therefore not be knocked out. Other reactions are catalyzed by several different enzymes and are therefore more difficult to knock-out. However, our analysis indicates that the question if an organism or a growth condition is more robust than another can be identically answered in both approaches. It was criticized that structural robustness (as defined by) lacks the ability to identify critical enzymes, such as knot enzymes (). This is true for the OPoF as well. For instance, according to our measure, network A inwas correctly identified to be more robust than network B. The cause for the lack of structural robustness is not apparent from the numerical value of the OPoF.proposed to solve this dilemma by considering the number of independent (i.e. non-overlapping) EFMs, which are not available in GSMMs. However, by measuring the specific PoF f R d for each individual reaction (enzyme) R we are at least able to identify critical enzymes. For this purpose, we define the (reaction) specific PoF f R dto be the ratio between all specific CSs, c d R , that are supported by reaction R and the number of all possible CSs, C d (and similarly for f R ). By ranking reactions according to their impact on the network we are able to identify critical reactions which may be useful drug targets. We calculated OPoFs in MSMMs and GSMMs of multiple Enterobacteriaceae growing on minimal media to illustrate our concept. Among these, the ordinary lab strain E. coli K-12 MG1655 growing on glucose was found to be most robust. This was consistently observed in MSMMs and GSMMs in agreement with expectations (). Moreover, catabolite repression mechanisms support this observation of glucose as a preferential growth source. Escherichia coli K-12 MG1655 was also found to be more robust than the pathogenic E. coli O157:H7 Sakai, and the least Exact quantification of cellular robustnessrobust S. flexneri 2a 2457T. While the difference between K-12 MG1655 and O157:H7 Sakai was small (but larger than the possible error), S. flexneri was clearly set apart. Due to its adaption to a specific growth niche, S. flexneri has lost many catabolic pathways for various nutrient sources (). It was demonstrated computationally as well as experimentally that the number of growth-supporting conditions is larger for E. coli K-12 MG1655 than for E. coli O157:H7 Sakai than for S. flexneri 2a 2457T (). In contrast we here investigated the OPoF as a measure of structural robustness for these organisms in a single growth condition. Yet we found the same ranking as obtained from counting the number of growth-supporting conditions. Structural robustness is thought to come about from the need to survive in multiple environments. Many of these adaptations occur through rewiring of existing enzymes (), thus increasing the connectivity in the network, andas a byproductalso introducing many alternative routes. These topological alternatives can be exploited for other growth sources as well and were mirrored in our analysis in low OPoFs. The two strains of the highly specialized endosymbiont B. cuenoti, which for millions of years have lived in the relatively constant environment provided by specialized cells of cockroaches (), were found to be extremely sensitive to loss-of-function mutations (). This was confirmed by an extremely high OPoF of >26%. B. cuenoti was more than three times less robust than E. coli. It is known that B. cuenoti grows only on an extremely limited palette of metabolic substrates (), which results in their low structural robustness as documented here. Consistent with our findings above on S. flexneri this lack of structural robustness is thought to be shaped by massive gene loss (). A characteristic difference between B. cuenoti Pam and Bge is a defunct TCA cycle in the former due to the absence of the first three enzymatic steps (). This fact was mirrored in a lower structural robustness of B. cuenoti Pam compared with Bge. Thus, we conclude that the OPoF is indeed an appropriate measure to correctly assess the structural robustness of cells.Here, we analyzed the structural robustness of multiple organisms in several growth environments. Consistent with previous findings our results confirm that structural robustness is correlated with the ability to utilize multiple carbon sources (). They concluded that structural robustness is not a trait selected by evolution but a byproduct of environmental flexibility. However, very recentlyshowed that structural redundancy also impacts a cell factory's ability to produce a product of interest in the presence of perturbations. Based on predictions from GSMMs, they argue that pathway diversification leads to robust production capabilities under large perturbations. For instance, we show in Supplementary Table S5 two strain designs with different OPoFs but identical production/growth characteristics. Thus, calculating the OPoF will identify promising designs for cell factories. Interestingly, we found that the raise in F(d) with increasing d was well approximated by an exponential function in all investigated models and independent of the investigated organism. Whether this is an expression of some general topological properties of metabolic networks or a coincidence will be scope of further work.
ConclusionWe developed a consistent theory of cellular redundancy based on a rigorous probabilistic definition of failure in metabolic networks. The new measure, called OPoF, allows quantification of the structural robustness of biochemical reaction networks with respect to certain functionalities. OPoF can be reliably estimatedeven in GSMMsfrom low cardinality MSCs. In contrast to other measures, the OPoF quantifies structural robustness and fragility of cellular metabolism concurrent with current biological paradigms and experimental findings. More specifically we showed that the number of growth-supporting nutrients indirectly correlates with the organisms' OPoF. As the OPoF is easily computable, we expect that it will be useful in increasing our understanding of key properties of metabolic networks.
A
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.P.Gerstl et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
