Motivation: The accurate measurement of the lipidome permits insights into physiological and pathological processes. Of the present high-throughput technologies, LC-MS especially bears potential of monitoring quantitative changes in hundreds of lipids simultaneously. In order to extract valuable information from huge amount of mass spectrometry data, the aid of automated, reliable, highly sensitive and specific analysis algorithms is indispensable. Results: We present here a novel approach for the quantitation of lipids in LC-MS data. The new algorithm obtains its analytical power by two major innovations: (i) a 3D algorithm that confines the peak borders in m/z and time direction and (ii) the use of the theoretical isotopic distribution of an analyte as selection/exclusion criterion. The algorithm is integrated in the Lipid Data Analyzer (LDA) application which additionally provides standardization, a statistics module for results analysis, a batch mode for unattended analysis of several runs and a 3D viewer for the manual verification. The statistics module offers sample grouping, tests between sample groups and export functionalities, where the results are visualized by heat maps and bar charts. The presented algorithm has been applied to data from a controlled experiment and to biological data, containing analytes distributed over an intensity range of 10 6. Our approach shows improved sensitivity and an extremely high positive predictive value compared with existing methods. Consequently, the novel algorithm, integrated in a user-friendly application, is a valuable improvement in the high-throughput analysis of the lipidome. Implementation and availability: The Java application is freely available for non-commercial users at
INTRODUCTIONAdvances in lipidomics technologies utilizing mass spectrometry have led to a rapid increase in the number, size and rate at which datasets are generated. LC-MS especially bears the potential for monitoring quantitative changes in hundreds of lipids simultaneously. In order to deal with the acquired data automated and reliable software tools are required. Currently available lipidomics MS-quantitation tools can be classified in two groups, each extracting 2D subsets of MS data: one group () requires m/z profiles or m/z spectra; and the other group () extracts chromatograms for quantitation. A representative of the first group is LIMSA which can analyse m/z spectra only (). It utilizes an additional program (SECD) to extract the m/z spectra. The user has to define manually a trapezoid in the m/z-time map of the LC-MS data containing the lipid series of interest (a collection of lipids having the same amount of C atoms). This extracted m/z spectra serve as input for the LIMSA algorithm. In contrast, mzMine2 (), a program from the second group, provides several algorithms to automatically extract chromatograms for processing. Both programs select the peaks for an analyte based on the exact m/z value. However, an LC-MS peak is a 3D object, whereupon each of its data points is characterized by retention time, m/z ratio and intensity. Consequently, all of the available tools lose information from a whole dimension (in the first group by the m/z profile extraction and the other group by the chromatogram extraction), and thus decrease the ability to clearly distinguish between closely overlapping peaks (). Furthermore, overlapping peaks occur frequently in lipidomic data due to the particular nature of lipids. The chemical structures of lipids can differ just by one double bond, resulting in a mass difference of 2 Da between the analytes. Thus, the base peak (+0 isotope) of the analyte has almost the same mass as the second isotopic peak (+2 isotope) of the analyte with one additional double bond. Furthermore, elution times are usually very close due to the physicochemical similarity of the analytes. In this article, we present a novel algorithm that addresses the difficulties specific to lipidomics MS-data quantitation by two novel approaches: (i) exact peak border confinement and (ii) accounting for the theoretical isotopic distribution for peak selection. The novel border confinement increases the ability to detect overlaps and reduces their effects. The theoretical isotopic distribution isShows the 3D view at the top of the picture and the 2D chromatogram view at the bottom. In the 3D view, the isotopic peaks (+0, +1 and +2) of TG56:6 and TG56:7, plus the +0 peak of TG56:5 are depicted, whereupon the peaks stained in red correspond to the quantified peaks of TG56:6. The 2D view shows the extracted chromatogram at the m/z value of TG56:6. In the chromatogram the overlapping +2 isotopic peak of TG56:7 is not distinguishable from the main peak of 56:6; resulting in one peak. (B) Shows the zoomed 3D view of the overlap of the +2 peak of TG56:7 with the +0 peak of TG56:6. In 3D the two peaks are clearly discernable. The red stained part of the overlapping peaks indicates the part that has been used for the quantitation of TG56:6. used as an exclusion and selection criterion and as such increases specificity. These two principles allow accurate and highly specific peak identification, which is required for the unattended highthroughput analysis of lipids. To assess the performance of the new algorithm, we (i) conducted a controlled experiment to test the accuracy of the quantitation and (ii) applied the algorithm to biological data to test its sensitivity and positive predictive value.
Lipid Data Analyzer
SYSTEM AND METHODSThe Lipid Data Analyzer (LDA) software is a stand-alone, platformindependent Java application, using Java3D (https://java3d.dev.java.net) for visualization.
Theoretical isotopic distributionThe theoretical isotopic distribution is calculated for each mass shift with the aid of probability theory, so that the probability for an isotopic mass peak is the sum of the mutual combinations of atomic isotopes, which result in the +x mass shift:For the theoretical isotopic distribution, the reference values are then determined based on the measured base peak according to the formula (Supplementary Section 1):
Controlled experimentThe controlled experiment consisted of five mixtures (prepared as triplicates) of the analytes TG54:0, TG54:1, TG54:2 and TG54:3, and TG48:0 as reference value, which was present at the same concentration (5 M). In the first mix, the analytes were present at the same concentration (2 M) to test the ionization efficiencies of the analytes, while in mix 25 the analytes were mixed at different concentrations to test the quantitation at different intensities. The relative concentrations of the analytes were: TG54:3 : TG54:2 = 2:1; TG54:2 : TG54:1 = 5:1; TG54:1 : TG54:0 = 10:1. Mixes 25 correspond to a dilution series with the following ratios: mix2 : mix3 = 2 : 1; mix2 : mix4 = 5 : 1; mix2 : mix5 = 10 : 1. Data were acquired by MS (more details about sample preparation and MS can be found in Supplementary Section 2) and analysed with LDA, LIMSA and mzMine2. The standard parameters of LIMSA and mzMine2 were inappropriate for high-resolution MS data (too few analytes were identified), and thus the parameters were adapted accordingly (Supplementary Section 3). The analytes showed ammonium and ammonium-acetonitrile adducts, and the sum of both adducts was taken as the quantitative measure. The analysis with LDA was performed in an automated way relying only on the m/z value. In contrast, LIMSA required manual extraction of the profiles for the automated quantitation, and mzMine2 information on retention time. Following that, the ratios of the dilution series were calculated and the average deviation from the expected ratio was taken as quality parameter:Page: 574 572577
J.Hartler et al.
Biological experimentFor the biological data, three groups of C57BL male mice (n = 3 each) aged 12 weeks were maintained on a regular light-dark cycle (14 h light, 10 h dark) and fed on either standard laboratory chow diet (4.5% w/w crude fat) or high fat diet (34% w/w crude fat). For fasted samples, mice fed on chow diet were fasted over night for 16 h. The aim was to characterize the TG species of lipid droplets (LD) isolated from primary hepatocytes of mice subjected to the different feeding regimes. Primary hepatocytes were isolated by collagenase digestion according to Riccaltonwith some modifications (Supplementary Section 4). Primary hepatocytes were lysed by nitrogen cavitation and LDs were isolated by ultra centrifugation. Lipids were extracted according to. The sample was split into two parts, since LDs contain mainly TG () and the chromatographic separation and peak shape would be very poor for TGs without dilution, whereas other lipids would be hardly detectable in a diluted sample. One part of the extract was diluted 1 : 66 and served for the analysis of TGs, and the other fraction remained undiluted for the analysis of phospholipids and sphingomyelin. The extracts were dissolved in CHCl 3 /MeOH (1:1, v/v) and acquired by LC-MS as described in Supplementary Section 2. First, the peaks were manually verified (visualization with the implemented 3D viewer). A peak was considered valid if it occurs at the expected retention time (each additional double bond in a molecular species lowers the retention time by about 0.51.5 min). Subsequently, TG data were automatically analysed by LDA and mzMine2 and the results were compared. While LDA performs the automated quantitation based on the m/z value of the analyte only, mzMine2 requires additionally information about the retention time (cf. controlled experiment). The data from undiluted samples were analysed with LDA only to show the applicability to molecule classes other than TG.
ALGORITHM IMPLEMENTATION
3D algorithmThe novel algorithm for accurate peak confinement works on the basis of several chromatogram and profile extractions, in which the chromatogram/profile extraction is based on an adapted version () of the ASAPRatio algorithm () with a changed peak border detection method. This new method detects peak borders based on abrupt changes in the gradient of a peak curve (see Section 5 and SFig. 1 in the Supplementary Material). The chromatogram and profiles are used to determine four peak border points. An ellipse through these border points is fitted, forming the border for the peak (Supplementary Section 6). Raw intensities inside the ellipse are used to calculate the area of the peak. This approach minimizes the effect of potential overlaps and does not contain smoothing artefacts, since it works on raw intensities.shows two overlapping peaks which cannot be separated by the conventional 2D methods. In, these two peaks are depicted from a top-view on the m/z map and the novel 3D algorithm is illustrated schematically. First, the algorithm extracts a chromatogram with a broad m/z range and identifies the time point at the peak summit. Second, at the time point of the summit, an m/z profile with a narrow time range is extracted. The algorithm determines the peak summit again and detects the two border points of the profile peak, which already form points for the ellipse fit in m/z direction. Then, two chromatograms are extracted; the first one uses the two profile border points as m/z range for the extraction; the second one uses a very narrow range around the m/z value of the profile peak summit. Now, in both chromatograms peak borderThe bigger ellipse represents the peak to be quantified; the smaller one is the overlapping one. First, a standard chromatogram 'A' with a broad m/z range 'a' is extracted (no overlap distinguishable). Second, at the time point with the highest intensity an m/z-profile 'B' with a narrow range 'b' is extracted. Third, the m/z borders and the m/z value with the highest intensity are used to extract chromatogram 'C' with range 'c' (uses borders found in 'B') and 'D' with narrow range 'd'. 'C' and 'D' are used to identify borders in the time range. Now four border points of the peak are determined (dots on the borders of the bigger ellipse) and an ellipse is fitted through them. The ellipse is used as the peak border. Just intensities inside the ellipse contribute to the total peak intensity. points are detected, which can be used for the ellipse fit in the time direction. In general, the border points of the chromatogram with the smaller m/z range are used for the ellipse. However, the chromatogram with the narrow m/z range could possibly cut just a small part of the overlapping peak, resulting in an undetectable change of the gradient in the curve, whereas the extracted broader chromatogram detects the change. Hence, the broader chromatogram returns a much smaller time range than the narrower one. In this case, the border points of the broad chromatogram are taken for the ellipse fit. The ellipse is then fitted with the two border points in m/z direction and the two border points in time direction (blue points in), and only intensities within this ellipse contribute to the final peak area.
Theoretical isotopic distributionDue to the nature of lipids, there is in general more than one candidate peak available for a distinct m/z value. In order to select the correct peak, LDA takes the theoretical isotopic distribution into account, which is used as a selection/exclusion criterion. First, Page: 575 572577
Lipid Data Analyzerthe algorithm checks whether the peak belongs to another isotopic distribution (exclusion). Second, it checks whether the isotopic peaks related to the analyte match (in a certain range) its theoretically calculated values (selection). If both criteria are fulfilled the peak is accepted. In contrast with the other existing algorithms, the LDA has no deisotoping step; every isotopic peak is quantified separately and the sum is taken as the quantitative measure.
Robust standardizationIn addition to the novel algorithm the software features a statistics section with standardization. Three different standardization methods are provided: (i) correction based on a single standard; (ii) a median method; (iii) standardization on an internally developed methodology. The normalization on a single standard is trivial: each standard forms a reference value. The median method uses the median of the standards in a sample as a reference. The third method has been developed to provide a very robust method of standardization because suppression effects are quite common in MS. First, statistics from each standard are calculated (median and coefficient of variation). Second, the 'most robust' standard is selected by a two-step procedure. In the first step, standards are selected only if they are found at least 90% of the most often found standard. The best standard is then the one with the highest intensity which is within 5% of the standard with the best coefficient of variation. If there is none within the 5%, the one with the best coefficient of variation is taken. Third, applicable standards are selected for each experiment by a generous outlier removal. A standard is an outlier only if it is less than half of the lower quartile value or if it is higher than the double of the upper quartile value. Fourth, a 'global reference area' is defined, which is the 'most robust' standard area of an experiment whose value is closest to the mean value of the 'most robust' standard. Fifth, for each experiment a reference ratio between each applicable standard for the experiment and the experiment chosen in the previous step is calculated.The reference for the experiment is then the 'global reference' times the mean of the single standard ratios (a comparison of the standard median method and the new method can be found in Supplementary Section 7):
EXPERIMENTAL VALIDATIONIn order to test the accuracy of the algorithm, we conducted a controlled experiment (see Section 2) and compared the results of LDA, mzMine2 () and LIMSA (). First, samples were prepared containing all analytes at the same concentration to test the ionization efficiency. LDA and mzMine2 showed nearly the same intensities for TG54:0-2, but TG54:3 and the standard TG48:0 showed smaller intensities than expected (Supplementary). TG54:3 and TG48:0 eluted exactly at the same retention times (25.926.1min) in all of the samples (Supplementary), and suppressed each other. Consequently, we did not use TG48:0 as a standard, since it would have skewed the results. Second, we compared analytes over a dilution series (mix 25), from which we calculated a ratio relative to the areas found in mix 3 (and for more details see Supplementary). In this experiment, the suppression effects on TG54:3 could just be noticed at mix2, because here the intensity of TG54:3 was highest. In 8 of 12 possible ratios, the LDA was closer to the ideal ratio than mzMine2, and in 10 out of 12 ratios than LIMSA. The average deviation from the ideal ratio was 9.7% for LDA, 10.5% for mzMine2 and 36.3% for LIMSA. The LDA performed just slightly better (0.8%) than mzMine2 in this experiment, since the peaks in the controlled experiment were quite well separated, and no overlap occurred. However, the intention of this experiment was just to show the accuracy of the results. Nevertheless, the areas of the LDA could be taken for further analysis without manual review, whereas for mzMine2 manual selection of the correct hit from a list of ambiguous peaks was necessary in 25 of the 150 possible cases. The performance of the algorithms on biological data was assessed without LIMSA, because of the unsatisfactory results of the controlled experiment. The comparison with mzMine2 was conducted solely based on TG data, since it allowed for a more objective manual identification of a correct peak due to the regular distribution of TG peaks. For this data, LDA showed higher sensitivity (86.1%  93.3%) and a significantly improved positive predictive value (89.4%  99.1%) compared with mzMine2 (and for more details see Supplementary), which is extremely important for automated high-throughput analysis. Regarding sensitivity, LDA correctly identified 678 (93.3%) of the 727 possible peaks, whereas mzMine2 identified 626 peaks (85.4%). However, 168 of the mzMine2 identifications returned more than one candidate peak (ambiguous identifications), and for LDA only 21. Nineteen of those 21 peaks were located in the peak-tail belonging to the analyte with <5% intensity of the mainpeak, or a peak appearing with two summits was considered as two possible identifications. The remaining two peaks would not be viable for analysis and a manual decision would have been necessary. Regarding positive predictive value, 678 (99.1%) of the 684 reported LDA identifications were correct, while 626 (89.4%) of the 700 mzMine2 hits were true positives, with the same amount of ambiguous identifications as in the sensitivity evaluation. This high positive predictive value demonstrates the extremely high reliability of the algorithm over a large intensity range, since the intensity ratio between highest and lowest valid identifications is almost 10 6. The data from the undiluted extract were used to demonstrate the general applicability of the software to samples containing minor amounts of phospholipids, i.e. phosphatidyl choline (PC), phosphatidyl ethanolamine (PE) and sphingomyelin (SM), in the presence of bulk TG. Even though the average intensity of a PC peak is around 5% and an average SM peak is around 1% of the intensity of an average TG peak (Supplementary), the positive predictive values attained were 97.2% for PC, 93.4% for PE, 97.3% for SM and respective sensitivities were 92.5% for PC, 84.0% for PE and 85.7% for SM (Supplementary).
SOFTWARE DESCRIPTIONThe application supports mzXML () as raw data format. In addition, the Thermo RAW format and the Waters MassLynx raw data format are supported via the freely available software ReAdW and massWolf (), which can be directly integrated in the program. Before quantitation, the mzXML files are translated into an internal indexed chrom file format, which provides rapid access to the data (especially useful for data visualization). The molecules to be identified are defined in a Microsoft Excel file, containing, for each analyte, the name and the molecular formula and the mass. The m/z must be entered manually, since it is possible to define several adducts or modifications for one lipid. The quantitation itself can be performed in batch mode. The calculation of the theoretical isotopic distribution is based on the list of chemical elements and the probabilities of their isotopes provided in an extendable XML file. The software features a statistics section with normalization, grouping, visualization and export functionalities. The data can be normalized on 'internal standards', which are added before the MS data acquisition and should compensate instrument-specific). The values are normalized on the total TG content. Changes of single molecules are detected at glance with the heat map (A). The bar charts (B) allow a more detailed comparison (here TG 56:111 is depicted; the values are normalized on the total content of TG56). The heat map cells provide direct links to the 3D-chromatogramm viewer (). In Supplementary Material, a detailed list of the lipid assignments can be found invariations, as well as on 'external standards', which are added before sample preparation and should compensate losses throughout sample preparation. The standardization procedures are described at Section 3.3. The results can be displayed in heat maps and/or bar charts (), in which several display options are available (normalization on standards, base peak, total class content, content of a specific group, etc.), and an overview of the content of the total classes. The results can be exported into Microsoft Excel or tabdelimited format, and the heat maps and bar charts in PNG or SVG format. In the LDA, we implemented a sophisticated 3D viewer for the manual verification of the results (), because the extracted profiles/chromatograms are the result of data processing procedures and provide a constrained view on the data. The 3D viewer offers adjustable m/z display ranges and resolution levels. Furthermore, hits can be deleted, added or corrected with several available quantitation methods (3D method, standard ASAPRatio method, the method described in, and the method described in Section 5 and SFig. 1 in the Supplementary Data).
DISCUSSIONThe LDA proved to be a powerful and reliable tool for highthroughput analysis of the lipidome using LC-MS. In a controlled experiment, we showed that the results are more accurate than with other available tools (average deviation from the ideal ratio was 9.7% for LDA, 10.5% for mzMine2 and 36.3% for LIMSA). Moreover on biological data, the novel algorithm proved its real strength: the sensitivity increased from 86.1 to 93.3% and the positive predictive value from 89.4 to 99.1%
Lipid Data Analyzercompared with mzMine2. The high positive predictive value is particularly important for an automated analysis with minimal human intervention. Moreover, we demonstrated the applicability of LDA to low abundant lipid species in lipid droplets, like phospholipids and sphingomyelin. Although intensities measured were close to noise levels, our algorithm still achieved good to excellent positive predictive values. Although the experimental data in this study was generated on an FT-MS instrument, the application is not limited to high-resolution data. The parameters for the 3D algorithm have already been adapted for QTOF and low-resolution QTRAP. LDA is not limited to the analysis of lipids, but can be extended to other singly charged analytes by providing the respective molecule definition file. Support for multiple charged molecules like peptides would require the extraction of more chromatograms for the theoretical isotopic distribution as selection/exclusion criterion (see Section 3.2). For example, when the algorithm checks whether or not the peak belongs to another isotopic distribution, a chromatogram at m/z (analyte)  mass (neutron) is extracted. To check a doubly charged molecule a chromatogram at m/z (analyte)  (mass (neutron))/2 is required and so on. The smoothing of a chromatogram is quite time consuming, thus a pre-screening method that works on the raw data are expected to analyse multiply charged molecules in a rapid manner.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [12:56 22/1/2011 Bioinformatics-btq699.tex]
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
