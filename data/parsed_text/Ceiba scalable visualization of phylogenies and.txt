Phylogenetic trees with hundreds of thousands of leaves are now being inferred from sequence data, posing significant challenges for visualization and exploratory analysis. Image data supplying valuable context for species in trees (and cues for exploring them) are becoming increasingly available in biodiversity databases and elsewhere but have rarely been built into tree visualization software in a scalable way. Ceiba lets the user explore large trees and inspect image collection arrays (sets of 'homologous' images) comprising mixtures of 2D and 3D image objects. Ceiba exploits recent improvements in graphics hardware, OpenGL toolkits and many standard high-performance computer graphics strategies, such as texture compression, level of detail control, culling, animations and image caching. Its tree layouts can be tuned by user-provided phylogenetic definitions of subtrees. The code has been extensively tested on phylogenies of up to 55 000 leaves and images. Availability and implementation: A manual, datasets, source code (distributed under GPL) and binaries for OS X are available at http://sourceforge.net/projects/ceiba. Contact:
INTRODUCTIONInformation visualization can foster exploratory analysis of large and complex datasets. Phylogenetic tree visualization has been an active area of research in the past decade (), with competing programs offering significantly different features, user interfaces and scalability (; one website lists 113 programs: http://bioinfo. unice.fr/biodiv/Tree_editors.html; see Supplementary). In recent years, scalability has assumed greater importance, as phylogenetic trees have markedly increased in size. Trees with 1000 leaves are now fairly common (e.g.), and attempts to build trees with 10 00050 000 or more leaves () signal the increasing demand for large trees in comprehensive comparative studies in ecology, evolution and other domains (). Phylogenetic trees are often annotated with low complexity data, such as discrete traits (e.g. nucleotides), but many biological features, such as morphological traits, are of much higher complexity, and are commonly visualized as 2D images or 3D models reconstructed from CT scans (e.g.). Although some tree visualization programs allow imbedded images (e.g.; see Supplementary), image processing capabilities have not been prominently featured in their development, and some basic challenges to their integration into phylogenies remain. For example, in conventional 2D tree layouts, images often either occlude one another or must be greatly reduced in size to avoid this. Scalable integration of image data with tree visualization could foster exploration of comparative patterns in at least two ways: first, by using these data themselves as cues to aid navigation and exploration at large tree scales, and second, to embed these complex data types in an interactive phylogenetic framework that highlights the evolutionary links between the images. The latter may come from large databases of whole organism images, such as Encyclopedia of Life (http://eol.org), databases of specific traits, such as MorphBank (http://www.morphbank.net), of 3D models derived from CT scans, such as Digimorph (http://www.digimorph.org). a homologous trait. To provide phylogenetic context deeper in the tree, sample images from the image collections of the leaves are displayed in image boxes rendered at internal nodes of the hierarchy. This provides cues to the content of subtrees that can encompass a large subset of leaves (). Thus, compared with other programs that allow imbedded images, Ceiba offers two advantages: (i) rendering automatically collated image collection summaries at internal nodes, and (ii) imbedding of images at leaves in a 3D visualization that naturally lessens the impacts of image occlusion. Although a few programs are scalable to the same degree and can incorporate images (e.g. Archaeopteryx: http://www.phylosoft.org/ archaeopteryx/;and Supplementary), Ceiba uses a number of techniques to integrate this scalability with imbedded images. Many of these take advantage of the hierarchical decomposition of the tree to avoid expensive layout computation and rendering operations (of both trees and images) until they are needed. Culling is used extensively, and an optional image caching strategy is implemented in which recently visited but no longer visible images are freed from memory.
RESULTSScalability of Ceiba was evaluated in depth on two large trees included in the software distribution (839 and 55 473 leaves). To evaluate what a user would experience in a lengthy interactive session, the program was run in 'tour' mode, an animation that visits every subtree, rendering all image collections in turn. Performance with 2D images was tested by spoofing the program into fetching a single reference 1.25 MB image file for every leaf. A tour of the default decomposition of the 55 473 taxon tree ofvisited all 2580 subtrees containing 55 473 2D images with no apparent degradation of graphics performance, and with memory requirements (image caching enabled) never exceeding 0.6 GB of RAM. A 3D surface model with 330 000 polygons was attached to each of the leaves in the 839 taxon tree, and a comparable tour could be completed by allowing some degradation in the smoothness of the animation.
METHODS Ceiba originated in the Paloverde tree visualization code (Sanderson, 2006), but Ceiba's new layout schema combines a much more scalable hierarchical decomposition of large trees with code re-engineered to integrate image data. Ceiba 'layouts' are of two kinds. The first specifies how the input tree is decomposed into a hierarchy of subtrees, determined automatically or by user-supplied phylogenetic definitions of subtrees. The second concerns the visual appearance of these subtrees, how they relate to each other when rendered and their integration with image data. Subtrees can be rendered either as conventional 2D trees like layouts available in other software, or as 3D objects that look like botanical 'trees'. Subtrees are combined in two visual layout schemes. In the '3D' scheme, all subtrees are displayed as 3D objects. Navigation is effected by selecting subtrees and recursively zooming into this defined 3D space. In the 'fan' scheme, the root subtree is rendered as a 3D tree, but all descendant subtrees are rendered as 2D semicircular trees (keeping with a botanical metaphor; these are rendered to look something like the planar leaves of a fan palm). Navigation to subtrees in this scheme uses a different metaphor: selecting subtrees maximizes a subtree's fan, displaying it in the same plane as its parent subtree fan, allowing a user to see several hierarchical levels at once. A collection of 2D digital images and/or 3D surface models can be associated with any leaf in the tree. Arranged in a 'homology array', images at the same spatial position in different leaves can thus represent
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Ceiba at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
