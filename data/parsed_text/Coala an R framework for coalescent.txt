Simulation programs based on the coalescent efficiently generate genetic data according to a given model of evolution. We present coala, an R package for calling coalescent simulators with a unified syntax. It can execute simulations with several programs, calculate additional summary statistics and combine multiple simulations to create biologically more realistic data. Availability and implementation: The package is publicly available on CRAN and on https://github. com/statgenlmu/coala under the conditions of the MIT license.
IntroductionCoalescent simulators rapidly simulate the evolution of genetic sequences. They are routinely used in population genetics to approximate analytically intractable quantities, to verify theoretical predictions and to validate the performance of data analysis methods (). The underlying idea to trace the ancestry of the sequences backwards in time was first implemented in the program ms (). Since then the size and complexity of data sets has increased, and many extensions and modifications of the original algorithm were proposed to cope with the new challenges. For example, the program msHOT () supports recombination hotspots, MaCS (), fastsimcoal () and scrm () focus on the efficient simulation of long sequences, and msms () and cosi2 () account for selection. The total number of published simulators is more extensive, andcreated an online database to help researchers select an appropriate program. Currently, these simulators lack standardized in-and output formats and usually only support the calculation of a small number of summary statistics. To calculate additional statistics, researchers usually have to convert the simulated data into different formats. This process is error-prone and even small mistakes can lead to wrong conclusions or irreproducible results. To simplify this process we present coala, an R package for calling coalescent simulators from within R. It provides a unified interface for specifying coalescent models in R (R Core), automatically selects a suitable simulator, transparently conducts the simulations, parses the results and calculates additional statistics from the output.
ImplementationThe primary design goal of coala is extensibility. It uses a modular system based on R6 classes (https://cran.r-project.org/web/packages/ R6) to integrate different simulators and summary statistics. Documentation for writing extensions is provided within the R package. To set up a simulation study, the user creates a coala object called 'coalescent model' containing the demographic model and parameters to be used in the simulations as well as the specification which summary statistics shall be calculated from the simulated sequences. Parameters are variable values for quantities like times, rates or population sizes. Their values are either set when simulating the model later or are randomly sampled from a prior distribution. Optionally, parameters can be transformed using arbitrary R expressions including exponential and logarithmic functions. This design simplifies the execution of simulation-based analysis techniques such as ABC () or Jaatha (). An example ABC analysis using the abc package () is included in the package's documentation. Coala aims to work in a fully reproducible and transparent fashion. It displays the simulation commands that will be executed for a given model to allow the user to verify them. Additionally, it records all executed commands and ensures that all components respect R's, the package is optimized for computational efficiency by using a buffering system combined with meta programming techniques for generating the simulation commands. The number of calls to the coalescent simulators is automatically minimized and computationally expensive parts are implemented in C  (). Independent simulations can be distributed on multiple CPU cores.
FeaturesAlthough coala relies on existing programs for conducting the coalescent simulations, it can combine multiple programs to provide features not present in any of the applications. The current version of coala supports to call ms for standard neutral models, msms for models that contain selection and scrm for simulating long sequences. All three programs can be combined with seq-gen () to simulate finite sites mutation models. Furthermore, coala automatically splits complex models into smaller parts that are supported by one of the coalescent simulators. It simulates the parts separately and combines the results. This can be used to simulate models that consist of genetic regions of different length or that have variable parameters between the regions. Finally, it can simulate unphased data by randomly mixing the phased haplotypes returned by the coalescent simulators and transcriptomic data by removing introns from the sequences. Coala has support for calculating classical population genetic summary statistics like the nucleotide diversity p (), TajimaIN D () and various kinds of frequency spectra. Additionally, the current version focuses on summary statistics that were developed for detecting selective sweeps. For instance, it utilizes the rehh package () to calculate the EHH (), IES and iHS () statistics and the program OmegaPlus () for the x statistic (). It can also return a basic SNP matrix, the ancestral trees in Newick format and the unmodified output of the simulators.
ConclusionWe have created an R package that simplifies the simulation of data according to evolutionary models. It allows researchers to conduct and process coalescent simulations in an easy, reliable and reproducible way. Different simulators can be called using a unified R syntax and a variety of summary statistics can be calculated from the results. We hope that coala will facilitate the use of more realistic models by allowing for variable mutation and recombination rates and finite sites mutation models. Although might not always be necessary to use sophisticated simulation models, the easy availability of these features facilitates testing whether they are important for a particular application.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
P.R.Staab and D.Metzler at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
