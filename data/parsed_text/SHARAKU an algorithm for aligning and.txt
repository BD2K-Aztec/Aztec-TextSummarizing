Motivation: Deep sequencing of the transcripts of regulatory non-coding RNA generates footprints of post-transcriptional processes. After obtaining sequence reads, the short reads are mapped to a reference genome, and specific mapping patterns can be detected called read mapping profiles, which are distinct from random non-functional degradation patterns. These patterns reflect the maturation processes that lead to the production of shorter RNA sequences. Recent next-generation sequencing studies have revealed not only the typical maturation process of miRNAs but also the various processing mechanisms of small RNAs derived from tRNAs and snoRNAs. Results: We developed an algorithm termed SHARAKU to align two read mapping profiles of next-generation sequencing outputs for non-coding RNAs. In contrast with previous work, SHARAKU incorporates the primary and secondary sequence structures into an alignment of read mapping profiles to allow for the detection of common processing patterns. Using a benchmark simulated dataset, SHARAKU exhibited superior performance to previous methods for correctly clustering the read mapping profiles with respect to 5 0-end processing and 3 0-end processing from degradation patterns and in detecting similar processing patterns in deriving the shorter RNAs. Further, using experimental data of small RNA sequencing for the common marmoset brain, SHARAKU succeeded in identifying the significant clusters of read mapping profiles for similar processing patterns of small derived RNA families expressed in the brain. Availability and Implementation: The source code of our program SHARAKU is available at http:// www.dna.bio.keio.ac.jp/sharaku/, and the simulated dataset used in this work is available at the same link. Accession code: The sequence data from the whole RNA transcripts in the hippocampus of the left brain used in this work is available from the DNA DataBank of Japan (DDBJ) Sequence Read Archive (DRA) under the accession number DRA004502.
IntroductionSince high-throughput sequencing allows for deep sequencing with high sensitivity, RNA sequencing with a next-generation sequencer (RNA-seq) can detect not only the complete expression patterns of transcribed RNAs but also fragments derived due to the splicing, maturation processing, or non-functional degradation of the RNAs. RNA-seq studies targeting microRNAs (miRNAs) have revealed the existence of many different RNA fragments derived from small RNA species other than microRNA, providing further proof that derived RNA fragments are not simply random degradation products but are rather stable entities, which might have functional activity (). The evidence accumulating about shorter sequences or fragments derived from non-coding RNAs indicates that post-transcriptional processes are relatively common mechanisms to derive functional smaller molecules from various RNA families such as tRNAs and snoRNAs. For example, the so-called tRNA-derived RNA fragments (tRFs) are derived from processing at the 5 0 or 3 0-end of mature or precursor tRNAs (). These sequences constitute a class of short RNAs that are the second most abundant type of RNA after miRNAs. Since the discovery of small RNAs derived from tRNAs, a variety of names have been used to refer to similar entities, such as tRNA-derived RNA fragments (tRFs) (), stress-induced small RNAs (tiRNAs) () and tRNA-derived small RNAs (tsRNAs) (). Their uniform start and stop sites of cleavage in tRNA, together with their nonrandom size property, strongly suggest that tRFs are derived from tRNA cleavage in a specific and regulated manner (). In addition, several studies have identified a class of small fragments derived from snoRNAs (called sdRNAs), some of which may regulate splicing or translation (). The biological roles of such sno-derived RNA and tRNA-derived small RNAs have primarily been investigated in cancer cells (). tRNA-derived fragments participate in several types of biological processes, including as signal molecules in a stress-induced response and as regulators of gene expression. sdRNAs can function as miRNAs, regulators of alternative splicing, and tumor suppressors and oncogenes. The reads for such short derived RNAs are relatively abundant, i.e. greater than background levels, in small RNA-seq datasets. Chen and Heard (2013) pointed out that 'these reads are precisely mapped to specific regions of primary or secondary structures, and might contain special motifs or base biases, reflecting the involvement of special enzymes involved in their generation'. Hence, mapping a large amount of sequence reads onto a reference sequence can reveal specific forms of mapping patterns for the maturation process or random patterns for non-functional degradations (see(a)). These mapping patterns of RNA-seq short reads constitute the socalled read mapping profiles (see(b)) ().also pointed out that the non-specific degradation products include RNA fragments that are rapidly digested by the surveillance machinery from RNA molecules, which are defective in processing, folding and functions. Thus, it is crucial to reliably distinguish the true shorter RNAs from their non-functional degradation products to clearly identify derived and functional small RNAs and fragments. Therefore, the aim of the present study was to develop a computational tool for the comprehensive analysis and rapid identification of the post-transcriptional processing patterns of non-coding RNAs based on high-throughput RNA-seq data. The algorithm developed in this study was designed to capture specific forms of read mapping patterns mapped to specific regions of primary or secondary structures reflecting the functional activities of enzymes, and to distinguish them from non-functional degradation products. There are only a few existing tools () to analyze such read mapping profiles of RNA-seq data and detect footprints of the post-transcriptional processes or degradations of RNAs. FlaiMapper () predicts and annotates non-coding RNA-derived fragments by determining the start and stop positions from read mapping profiles. FlaiMapper can predict miRNA boundaries with high accuracy. deepBlockAlign (), which our present study takes quite a similar approach to, is an alignment-based method for alignments of read mapping profiles to find non-coding derived RNAs that share similar post-transcriptional processing. ALPS () is also alignment-based, but is not designed for the purpose of identification of short derived RNA fragments. BlockClust () computes a similarity score between read mapping profiles to detect similar processing patterns and cluster read mapping profiles. BlockClust includes a high-dimensional feature representation to encode read mapping profiles and calculates the similarity scores based on a graph kernel. Therefore, BlockClust does not rely on alignment-based techniques and is not designed for the purpose of calculating the alignment of read profiles. However, all of these methods are computed based only on the information of read mapping profiles and do not take the RNA sequence and secondary structure information into account. Further, those methods did not address the reliable distinguishability of processing patterns from the random degradation. Constructing an alignment for a pair of biological sequences such as DNA, RNA and protein sequences is a fundamental and robust method of sequence analysis (). The pairwise alignment of biological sequences is achieved according to insertions, deletions and match operations so that the two sequences are aligned with the same column length. The similarity score of an alignment is calculated according to the predefined scores for insertions, deletions and matches. Similarly, one can define the alignment between a pair of read mapping profiles (see(c)).An alignment of two read mapping profiles for SNORD14 and SNORD21 output by SHARAKU, using the small RNA-seq data for the common marmoset brain with the annotations of RNA sequence alignment and the predicted secondary structure. The solid line represents the read coverages of SNORD14, and the dashed line represents the read coverages of SNORD21. (d) Schematic illustration of the necessity of incorporating the primary and secondary structures of RNA sequences into an alignmentIn previous work with the deepBlockAlign algorithm (), the alignment program was designed to compare and align any read mapping profiles regardless of the RNA family to which they belong. The alignment program was also applied to the comparison of read mapping profiles of the same RNA gene across different samples that might be expected to induce different read mapping profiles (). This method is effective for the differential processing analysis of read mapping profiles of each non-coding RNA gene. In contrast with previous work, our primary goal was to detect specific forms among similar read mapping patterns mapped to specific regions of primary or secondary structures reflecting the functional activities of enzymes by alignments of read mapping profiles, and to distinguish these from non-functional degradation products. We developed a new read mapping profile alignment program named SHARAKU, which incorporates the primary and secondary structures of RNA sequences into an alignment of read mapping profiles. This is accomplished in combination with DAFS, a program for the simultaneous aligning and folding of RNA sequences (). As a result, the most advanced feature of SHARAKU is that it simultaneously aligns the read mapping profiles and RNA sequences with the folding RNA secondary structures. Since each type of derived RNA fragments is cleaved from its precursor with a specific context of primary sequence and secondary structure, we can expect that the simultaneous alignment of read mapping profiles with the primary and secondary structures contributes to precise identifications of the type of derived RNAs. Thus, application of SHARAKU to the mixture of different RNA families would enable the accurate clustering of read mapping profiles with respect to 5 0-end processing or 3 0-end processing of each RNA family, and facilitate the detection of common processing patterns shared among different RNA families (see(d)). Note that SHARAKU was not designed for classification of RNA sequences into different RNA families. Further, SHARAKU produces an alignment of read mapping profiles at the nucleotidelevel resolution, as(c) displays. In contrast, deepBlockAlign uses blockbuster () to generate block groups and aligns any read mapping profiles at the level of individual blocks and block groups, including those in unannotated regions or unknown RNA genes. On the other hand, the current version of SHARAKU can only be applied to the annotated non-coding RNA regions. Several previous studies () have explored the similarities and evolutionary relationships between snoRNAs and miRNA precursors. These similarity features represent molecules involved in the same processing pathways with a similar set of processing enzymes and the same RNAi targets. These similarity features are often confirmed based on the conservation of their primary and secondary structures, such as structural characteristics of typical H/ACA or C/D boxes. We hypothesized that in addition to sequence structure conservation, determining the similarity among read mapping profiles might help to identify the functional or processing similarities between snoRNAs and miRNA precursors.
MethodsWhen read mapping profiles for a pair of non-coding RNAs are obtained, SHARAKU fundamentally aligns two read mapping profiles by inserting gaps so that the sum of the differences of coverages at all positions between the two profiles is minimized. Simultaneously, SHARAKU takes information on the sequence and secondary structures of RNAs into account when aligning read mapping profiles by integration with DAFS, which calculates reliable structural alignments that maximize the expected accuracy of a predicted common secondary structure and its sequence alignment. The algorithm can be efficiently implemented by using dynamic programming. Second, SHARAKU calculates a similarity score (correlation coefficient) between two read mapping profiles based on the alignment. Third, SHARAKU produces a similarity score matrix for all pairs of read mapping profiles of non-coding RNAs in the target reference genome. Subsequently, the agglomerative hierarchical clustering is constructed based on the similarity score matrix.
Construction of read mapping profilesLet R  fA; C; G; Ug denotes the four nucleotides and R  denotes the set of all finite RNA sequences consisting of bases in R. A set of sequence reads generated by RNA-seq data for noncoding RNAs are mapped against the reference genome using standard mapping tools such as BWA () (i.e. alignment programs) for a huge number of short reads. The read coverage, i.e. the number (count) of mapped reads, at each position in an annotated RNA gene-coding region is calculated from the output of the mapping tool in BAM format. In an RNA gene-coding region, the read coverage c i at each position i is normalized so that every normalized value of read coverage is between 0 and 1. For an RNA sequence, denoted a  a 1 ;. .. ; a m , of an annotated RNA genecoding sequence, we refer to the sequence of normalized coverages, c a  c a 1 ;. .. ; c a m , as the read mapping profile of the RNA sequence (see(a)). Note that SHARAKU only deals with the read mapping profile within the annotated RNA-gene sequence and calculates the secondary structure within the annotated RNA-gene sequence.
Alignment algorithm for a pair of read mapping profilesLet a  a 1 ;. .. ; a m and b  b 1 ;. .. ; b n denote a pair of RNA sequences, c a  c a 1 ;. .. ; c a m and c b  c b 1 ;. .. ; c b n denote the normalized read mapping profiles. The optimal alignment of a pair of two normalized read mapping profiles c a and c b is calculated by the following recursive formula to minimize the sum of the differences of coverages at all positions. The mismatch score at a position of an alignment between c a and c b is simply defined as the absolute difference of the two coverage values c a i and c b j. To define the gap score, first, the coverage value at a gap inserted between j and j  1 is defined as c x j  c x j1 =2 (i.e. the average of c x j and c x j1 ). Second, the gap score between position i of c a and the gap inserted between j and j  1 of c b is defined as the absolute difference of c a i and c b j  c b j1 =2.r gapi; 0  jc a i  c b 1 j r gapi; n  jc a i  c b n j l gap0; j  jc a 1  c b j j l gapm; j  jc a m  c b j jIn order to avoid an unnecessary number of gaps inserted, which could cause artificial alignments, the number of gaps inserted into the alignment is restricted by the predefined parameter c. This can be implemented by dynamic programming to control the number of inserted gaps.
Alignment of read mapping profilesincorporating sequence structures binary-valued triangular matrix x  x ij  i < j , where x ij 1  if and only if bases a i and a j form a base pair. Let A s a; b denote a set of all possible structural alignments of a and b, that is, simultaneous alignment of RNA sequences and their secondary structures. We write h  x; y; t, which means that a structural alignment h 2 A s a; b consists of an alignment t 2 Aa; b, and two secondary structures x 2 Sa and y 2 Sb. First, in DAFS, a gain function Gh; b h of a structural alignment b h  b x; b y; b t with regard to the correct structural alignment h  x; y; t is defined as the weighted sum of gain functions G ss x; b x and G ss y; b y of the respective secondary structures and a gain function G aln t; b t of the alignment: Gh; b h  afG ss x; b x  G ss y; b yg  G aln t; b twhere a > 0 is a parameter that controls the weight of the secondary structures and the sequence alignment. Intuitively, the gain function Gv; b v can be regarded as a kind of 'accuracy' that represents the weighted sum of the number of true positive predictions and true negative predictions in b v, which is correlated to balanced accuracy measures such as Matthews correlation coefficient (MCC) and F-measure. In the case of the gain function G ss x; b x for the secondary structure, a true prediction in b x is a pair of bases a i and a j such that b x ij  x ij. In the case of G aln t; b t for the sequence alignment, a true prediction in b t is a pair of bases a i and b k such that b t ik  t ik. Second, when we calculate a structural alignment for a pair of RNA sequences, their correct structural alignment is unknown. In such case, we compute the expectation of a gain function under the distribution over all possible structural alignments of the pair of RNA sequences. The expectation E hja;b Gh; b h of the gain function Gh; b h under a given probability distribution over the space A s a; b of structural alignments is maximized to find a structural alignment b h:where Phja; b is a probability distribution of the RNA structural alignments. To reduce the computational complexity of Equation (2), the probability distribution Phja; b of the structural alignments is factorized as follows by assuming the independence of the structures and alignment: Phja; b % PxjaPyjbPtja; b;where Pxja and Pyjb are the probability distributions of RNA secondary structures over Sa and Sb, respectively, and Ptja; b is a probability distribution of alignments over Aa; b. The expected gain function (2) can then be approximated as follows:where p a ij denotes a base-pairing posterior probability, p a::b ik denotes an alignment-matching posterior probability, r and s 0 r; s 1 are balancing parameters between true positives and true negatives, and C is a constant independent of b h (see Sato et al., 2012 and its Supplementary Material for the derivation). In order to incorporate the DAFS framework of the simultaneous aligning and folding of RNA sequences into the alignment of read mapping profiles on the basis of the MEA principle, we need to define the expectation of the gain function for alignments of read mapping profiles. First, we define the partition function () for alignments of read mapping profiles. The partition function is equal to the alignment kernel K(a, b) () that measures the similarity between two sequences a and b by summing the scores obtained from all possible alignments with the gaps of the sequences. The partition functionwhere two variables rg and lg are used for controlling the number of inserted gaps. The 'backward' algorithm to compute Bi; j; rg; lg can also be defined in a similar manner. Now, we can define a posterior probability of positions i and j to be aligned in the alignments of read mapping profiles:where A ssrmp a; b; c a ; c b  denotes the set of all possible alignments between a pair of read mapping profiles c a and c b , taking the primary and secondary sequence structures between a pair of RNA sequences a and b into account, and w rmp 0 w rmp 1 is a parameter that controls the weight of the read mapping profile alignment and the sequence alignment. The 'optimal' alignment b h can be obtained by maximizing the expected gain function E hja;b;c a ;c b Gh; b h on the basis of the MEA principle. Further, the maximization of the expected gain function can be efficiently implemented using the techniques such as 'dual decomposition', 'subgradient optimization' and 'dynamic programming' (seefor more details).
Similarity score calculation between read mapping profilesThe similarity score Smc a ; c b  is exactly equal to the normalized inner product (cosine coefficient) of two gap-inserted read mapping profiles in the alignment b h. Therefore, Smc a ; c b  represents the correlation coefficient between two read mapping profiles c a and c b based on the alignment b h.
Results
DatasetsIn order to evaluate the performance of our method, we generated simulated read data in the form of typical next-generation sequencing output (based on an Illumina-type of short sequence reads). To evaluate the clustering ability to detect similar processing patterns, the labeled data of various classes of different processing patterns are required, such as 5 0-end processing, 3 0-end processing and nonprocessing. However, comprehensive annotations of such labels for all small non-coding RNAs are not available in existing real data such as the sequence read archive. The only exception is the miRNA family, for which the mature miRNA annotations are accessible in the NCBI Reference Sequence Database. First, we obtained the small RNA annotation and sequence data for miRNAs (24 genes), snoRNAs (37 genes) and tRNAs (41 genes) with a length less than 120 nt from the Ensembl genome browser for the mouse genome (GRCm38). Second, according to the results of previous studies that analyzed and identified the existence of various types of small RNA-derived fragments (), we determined the start or end sites of derived fragments that simulated 5 0end processing or 3 0-end processing in snoRNAs and tRNAs to be within a few bases from the 5 0-end or 3 0-end, respectively. Further, we set the length of the derived fragments to 20 nt for snoRNAs and to 30 nt for tRNAs. For miRNAs, we used the annotations for mature miRNAs in the NCBI Reference Sequence Database. Third, we generated 88 324 simulated sequence reads that contain the fulllength transcripts of snoRNAs and tRNAs (that is, the complete sequence reads exactly identical to the annotated snoRNA and tRNA sequences), mature miRNAs and their derived fragments. In addition, the set of 'degradation reads' was artificially constructed from the simulated complete reads of snoRNAs and tRNAs. In general, there are three major classes of RNA-degrading enzymes (): endonucleases that cut RNA internally, 5 0 exonucleases that hydrolyze RNA from the 5 0-end and 3 0 exonucleases that degrade RNA from the 3 0-end. In our study, we only considered the degradation of RNA from the 3 0-end, which is more reflective of non-functional degradation for unstable RNAs. Thus, the set of degradation reads was obtained by eliminating 4060% of the nucleotides from the 3 0-end in order to simulate the degradation process. The degradation reads constituted 20% of the set of simulated complete reads. In total, the simulated read dataset consisted of the complete reads of snoRNAs and tRNAs, the derived fragment reads for 5 0-end processing of miRNAs, snoRNAs and tRNAs, the derived fragment reads for 3 0-end processing of miRNAs, snoRNAs and tRNAs, and the degradation reads. Each of the 102 small RNAs SHARAKU i373 used for the simulated data was labeled according to one of the above-mentioned classes as follows:(that displays all read mapping profiles obtained by mapping the simulated read data to the 102 annotated small RNA sequences.) To demonstrate the practical usefulness of SHARAKU, we used a real dataset obtained from an RNA-seq experiment of the hippocampus of the left brain of a 2-year-old male common marmoset that was being bred at the Central Institute for Experimental Animals (CIEA). The total RNA was extracted and was subject to removal of rRNA and 5 0 Cap, and then the cDNA library of small RNA was prepared using the TruSeq Small RNA Sample Prep Kit (Illumina). The small RNA transcripts were sequenced with the next-generation sequencer MiSeq (Illumina) for a sequence read length of 270 bp, which enabled generating the complete sequences of most small RNA families. The short reads were subject to cutting adapters and quality filtering. The qualified reads were then mapped to the common marmoset (Callithrix jacchus) draft genome caljac3.2 () by BWA (). The tRNA annotation was predicted by tRNAscan-SE (). In total, the annotation and sequence data for 619 non-coding small RNAs were obtained (194 miRNAs, 316 snoRNAs, 109 tRNAs) from the Ensembl genome browser (Ensembl 73 version; 'Callithrix_jacchus.C_jacchus3.2.1.73.gtf' file) for the common marmoset genome (C_jacchus3.2.1).
Validation of clustering accuracy with the simulated datasetWe validated the clustering performance based on our alignment method for all pairs of read mapping profiles using the simulated dataset. First, the similarity score matrix for all pairs of read mapping profiles was calculated by SHARAKU. We used empirically determined parameters: b  3:0; w rmp  1:0; w ss  4:0; r  0:0; s  0:2. Second, the (agglomerative) hierarchical clustering method with group averaging was applied based on the similarity matrix. The agglomerative method of hierarchical clustering hclust implemented in the R-package was used for subsequent analysis. We evaluated how well each processing pattern and RNA family in the simulated dataset was separated into a distinct cluster according to the hierarchical clustering. Furthermore, we compared the clustering performance based on SHARAKU with that of the alignmentbased method deepBlockAlign () using the default parameters. As the input to deepBlockAlign, the output of blockbuster executed on the input of the simulated dataset was given together with the sequence annotation information. In the case of the simulated dataset, this does not affect the result of performance evaluation, because the sequence reads (except for shorter derived RNAs) in the simulated dataset are identical to the complete RNA sequences annotated in the Ensembl genome browser, so that every block that is output by blockbuster with the input of the simulated dataset is identical to one of the annotated RNA sequences. Note that since another alignment-based scoring system ALPS () was not publicly available, we did not compare the performance with ALPS. In the validation experiment using the simulated read dataset, the simulated reads were mapped to the mouse genome (GRCm38) by BWA () with the default parameters, except that-a bwtsw was set as the bwa index. From the output in BAM format, the normalized read mapping profiles for non-coding RNAs were obtained and fed to the alignment programs. We evaluated the overall quality of the clustering tree using the receiver operating characteristic (ROC) analysis proposed in (). (Note that we can obtain different resultant clusters from a clustering tree depending on a distance threshold to cut the branches.) Given a distance threshold, the number of true positives (TP) was defined as the number of read mapping profile pairs that have the same class label and are correctly assigned to the same resultant cluster. In the same manner, the numbers of false positives (FP), true negatives (TN) and false negatives (FN) are defined by counting the pairs from different class labels but the same resultant cluster, the pairs from different class labels and different resultant clusters, and the pairs from the same class label but different resultant clusters, respectively. The ROC analysis was performed by plotting the true positive rates TP/(TP  FN) versus the false positive rates FP/(TN  FP) for different distance thresholds. The quality of the clustering was measured by the area under the ROC curve (AUC).shows the results of AUC scores obtained with the three methods, and(left) shows the ROC curves generated by SHARAKU and deepBlockAlign. The AUC scores to indicate the clustering abilities of three methods were calculated for the dataset of all read mapping profiles (the mixture of read mapping profiles of miRNAs, snoRNAs and tRNAs) and for the dataset of read mapping profiles of each family, tRNA, snoRNA and miRNA. For the dataset of all read mapping profiles, SHARAKU achieved an almost perfect AUC score, and hence an almost perfect clustering result, and exhibited higher accuracy than deepBlockAlign. SHARAKU also succeeded in completely discriminating the degradation pattern from post-transcriptional processing such as 5 0 or 3 0-end processing. The alignment obtained by SHARAKU without considering the primary and secondary sequence structures ('SHARAKU without DAFS') presented lower AUC scores, which implied that incorporation of the sequence structure information is required to achieve highthe dataset of read mapping profiles of each family, both SHARAKU and deepBlockAlign achieved an AUC score of 1.0, which indicates a perfect clustering result. This result, together with that obtained for all read mapping profiles, clearly indicates that the alignment incorporating the secondary structures is indispensable for the accurate clustering of read mapping profiles generated from the mixture of different RNA families.(right) shows an alignment produced by SHARAKU for a pair of RNAs (Mir92-1 and SNORD63) in the simulated dataset that could be successfully separated into two different clusters by SHARAKU, but were clustered together by deepBlockAlign, thereby highlighting the importance of taking the secondary structures into account for alignments of read mapping profiles. (More alignments are also shown in Supplemental Figs S2 and S3.)shows the computational times required by the three methods for each simulated dataset.indicates that SHARAKU needs a large amount of additional computational time compared with deepBlockAlign and SHARAKU without DAFS to simultaneously align the read mapping profiles and RNA sequences and calculate the secondary structures.
Clustering a real dataset of RNA transcripts in the marmoset brainA total of 33.8 million (M) sequence reads with a length of 270 bp for small non-coding RNAs was generated using an Illumina MiSeq sequencer. After quality filtering, 30.5 M reads were mapped to the common marmoset (Callithrix jacchus) draft genome caljac-3.2 using BWA. From the output in BAM format, the normalized read mapping profiles for 619 non-coding RNAs were obtained and fed to the alignment programs. The dendrogram of clustering tree of hierarchical clustering based on the SHARAKU alignments of read mapping profiles of the 619 non-coding RNAs is shown in. Most of the read mapping profiles were clustered and well separated into five major clusters, representing (1) 3 0-end processing of miRNAs (containing 80 miRNAs); (2) 5 0-end processing of snoRNAs and tRNAs (containing 25 snoRNAs, 62 tRNAs and 5 miRNAs); (3) non-processing and non-degradation of snoRNAs and tRNAs (containing 210 snoRNAs, 10 tRNAs and 1 miRNA); (4) degradation of snoRNAs and tRNAs (containing 42 snoRNAs, 20 tRNAs and 1 miRNA); and (5) 5 0-end processing of miRNAs (containing 81 miRNAs and 2 tRNAs). In addition, the read mapping profiles representing 3 0-end processing of snoRNAs and tRNAs (containing 26 snoRNAs, 3 tRNAs and 3miRNAs) were scattered into four different clusters (6-1), (6-2), (6-3) and (6-4). These 4 clusters could be defined as the complement of the clusters (3) and (4), which might provide a clear interpretation. A representative read mapping profile in each cluster is shown below the clustering tree. Interestingly, 60% of the tRNAs were processed for deriving shorter fragments mostly at the 5 0-ends, whereas 80% of the snoRNAs were non-processed. A few other interesting small clusters were obtained and will be discussed below. In addition to confirming the utility of the new algorithm, this experiment revealed the post-transcriptional processing and the expression patterns of small derived RNAs in the marmoset brain. To the best of our knowledge, this represents the first identification of the processing patterns of derived RNAs expressed in the brain. The result of hierarchical clustering based on the deepBlockAlign alignments is shown in Supplemental.
Verification of small derived RNA transcripts by northern blottingIn order to verify that a derived RNA fragment predicted by the clustering method based on SHARAKU is truly derived and expressed and not an experimental artifact, we performed northern blotting analysis with a sample of the marmoset spleen. A small RNA-seq analysis for the total RNAs extracted from the marmoset spleen was executed and northern blotting for Leu-CAA-tRNA was performed. The read mapping profile of this Leu-CAA-tRNA belonged to a cluster representing 5 0-end processing of tRNAs in the hierarchical clustering tree generated by SHARAKU.shows the read mapping profile for Leu-CAA-tRNA obtained from the RNA-seq reads (left), as well as the northern blots for Leu-CAAtRNA (lenght: 105 nt) and the derived fragment (expected length: 35 nt) from the tRNA (right). The results clearly proved the actual presence of the derived RNA fragment.
DiscussionSeveral previous studies () have explored the similarities and evolutionary relationships between snoRNAs and miRNA precursors. As a result, various relationships between snoRNAs and miRNAs have been identified, from 'snoRNAs with miRNA features' to 'dual function snomiRNAs' and 'miRNAs with snoRNA features'. These similarity features represent molecules involved in the same processing pathways with a similar set of processing enzymes and the same RNAi targets. These similarity features are often confirmed based on the conservation of their primary and secondary structures, such as structural characteristics of typical H/ACA or C/D boxes. We hypothesized that in addition to sequence structure conservation, determining the similarity among read mapping profiles might helpwere added to the hybridization chamber and incubated with the blots. The membrane was then exposed to a phosphoimager and scanned. The largest band appearing at a distance just short of the 100-nt marker indicates the expression of the origin tRNA from which the short fragment RNA was derived SHARAKU i375 to identify the functional or processing similarities between snoRNAs and miRNA precursors. An interesting small cluster in the clustering tree shown in(highlighted with an arrow and asterisk) consisted of a mixture of snoRNAs, miRNAs and tRNAs. In particular, we found that the snoRNA 'HBII-52' and the miRNA 'let-7a' have quite similar features in their secondary structures and read mapping profiles, indicating a similar processing mechanism to produce the derived shorter fragments at 3 0-ends.shows these features. Indeed, small derived RNAs from HBII-52 were previously reported to resemble miRNAs (). Another interesting cluster is cluster (6) of the 5 0-end processing of miRNAs. The cluster contained two tRNAs. 'Pro-TGG-tRNA' has the typical miRNA-like secondary structure and miRNA/ miRNA* duplex, shown in. Supporting this result, previous work has indicated possible cross-talk between tRNA-derived RNA fragments and the canonical pathway of miRNAs (). Thus, the alignments and clustering of read mapping profiles using SHARAKU can give insight into revealing the common processing patterns in different families of non-coding RNAs and their derived fragments, which could help to clarify the processing pathways and biological functions of derived RNA fragments. One of the merits of SHARAKU is to calculate the optimal alignment based on not only the pattern of read mapping profiles, but also primary and secondary structures of RNA sequences. Since each type of derived RNA fragments is cleaved from its precursor with a specific context of primary sequence and secondary structure, we can expect that the simultaneous alignment of read mapping profiles with the primary and secondary structures contributes to precise identifications of the type of derived RNAs. To combine the pattern of read mapping profiles and the primary and secondary structures of RNAs, a Sankoff-type algorithm is required to be implemented. We implemented SHARAKU with DAFS framework, which enabled to efficiently combine the pattern of read mapping profiles and the primary and secondary structures of RNAs by the dual decomposition technique. In the present study, we have only dealt with annotated noncoding RNAs. However, SHARAKU can also be applied to the alignment and clustering of novel and unannotated regions by employing tools such as blockbuster () in order to determine the expressed block regions on the reference genome that are obtained from RNA-seq reads. As non-functional degradation products, we only considered the degradation of RNA from the 3 0-end in the simulated dataset. Therefore, performance evaluations of SHARAKU to determine the tolerance for the other two classes of RNA-degradations, endonucleases and 5 0 exonucleases, are required. These issues will be addressed in our future work.) and annotations with lines indicating the predicted locations of deriving fragments for a snoRNA 'HBII-52' and a miRNA 'let-7a' found in the clusters. The line for miRNA secondary structure indicate the predicted locations of the mature miRNA. The secondary structures predicted by RNAfold and annotations, with lines indicating the locations of derived fragments for a tRNA 'Pro-TGG-tRNA' and an miRNA 'let-7b' found in the cluster of the 5 0-end processing of miRNAs. The line for miRNA secondary structure indicates the predicted locations of the mature miRNA i376 M.Tsuchiya et al.
ConclusionWith the aim of offering computational tools for comprehensively analyzing the post-transcriptional processing patterns of non-coding RNAs and detecting their common processing patterns, based on RNA-seq, we developed a new algorithm called SHARAKU to align two read mapping profiles of next-generation sequencing data for non-coding RNAs. SHARAKU incorporates the primary and secondary structures of RNA sequences into an alignment of read mapping profiles by combining with DAFS, which constructs reliable structural alignments that maximize the expected accuracy of a predicted common secondary structure and its sequence alignment. SHARAKU could simultaneously align the read mapping profiles and RNA sequences with information of the folded RNA secondary structures. In an experiment using a simulated dataset, SHARAKU achieved an almost perfect clustering result, and exhibited higher accuracy than deepBlockAlign. In an experiment with real data of small RNA sequencing for the common marmoset brain, SHARAKU succeeded in identifying the five major clusters plus four scattered clusters representing typical processing patterns. This method also revealed some interesting clusters consisting of mixtures of several RNA families that predicted common processing patterns among different RNA families. These results demonstrate that SHARAKU can be an indispensable tool for analyses of the processing patterns and functions of regulatory non-coding RNAs with deep-sequencing data.
V C The Author 2016. Published by Oxford University Press. i369 This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com Bioinformatics, 32, 2016, i369i377 doi: 10.1093/bioinformatics/btw273 ISMB 2016 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.Tsuchiya et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Previously, we developed DAFS (Sato et al., 2012), an algorithm that simultaneously aligns and folds RNA sequences on the basis of maximizing the expected accuracy (MEA) of a predicted common secondary structure and its alignment. That is, DAFS calculates the maximization of the expected accuracy over all possible structural alignments of a pair of RNA sequences. Then, DAFS finds one optimal structural alignment, i.e. the most accurate structural alignment with the most plausible secondary structure of each input RNA sequence. Here, we combine the alignment algorithm for read mapping profiles with DAFS according to the same MEA principle in order to incorporate the primary and secondary sequence structures into the alignment of read mapping profiles. For an RNA sequence a  a 1 a 2    a m 2 R  , let jaj denote the number of bases appearing in a, which is called the length of a. Given two RNA sequences a; b 2 R  , let Aa; b denote the set of all possible alignments of a and b, that is, RNA sequence alignments without considering the secondary structures. Let Sa and Sb denote the set of all possible secondary structures of a and the set of all possible secondary structures of b, respectively. An alignment t 2 Aa; b is represented as a jaj  jbj binary-valued matrix t  t ik , where t ik  1 if and only if the base a i is aligned (matched) with b k. A secondary structure x 2 Sa is represented as a jaj  jaj
