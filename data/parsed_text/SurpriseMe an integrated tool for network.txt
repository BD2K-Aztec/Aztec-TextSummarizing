Detecting communities and densely connected groups may contribute to unravel the underlying relationships among the units present in diverse biological networks (e.g. interactomes, coexpression networks, ecological networks). We recently showed that communities can be precisely characterized by maximizing Surprise, a global network parameter. Here, we present SurpriseMe, a tool that integrates the outputs of seven of the best algorithms available to estimate the maximum Surprise value. SurpriseMe also generates distance matrices that allow visualizing the relationships among the solutions generated by the algorithms. We show that the communities present in small-and medium-sized networks, with up to 10 000 nodes, can be easily characterized: on standard PC computers, these analyses take less than an hour. Also, four of the algorithms may rapidly analyze networks with up to 100 000 nodes, given enough memory resources. Because of its performance and simplicity, SurpriseMe is a reference tool for community structure characterization. Availability and implementation: SurpriseMe is implemented in Perl and C/Cþþ. It compiles and runs on any UNIX-based operating system, including Linux and Mac OS/X, using standard libraries. The source code is freely and publicly available under the GPL 3.0 license at
INTRODUCTIONComplex networks are extensively used for representing interactions among elements of a system. This approach is particularly useful in biology; analyzing networks provides relevant information in fields such as genetics (), ecology (), neuroscience (), systems biology (Barabasi) or proteomics (), among others. An interesting property of these networks is the fact that related units of the network tend to create tightly knit groups, usually known as communities. By unraveling the close relationships among certain units, community structure characterization improves our understanding of the system as a whole. Recently, many strategies have been devised to detect the optimal division of a network into communities. However, none of them alone is able to achieve high-quality solutions in all kinds of networks (; Aldecoa and MarnMarn, 2013a, b). In recent works, we demonstrated that Surprise (S) () is an effective measure to evaluate the quality of a partition of a network into communities (Aldecoa and MarnMarn, 2011, 2013a, b). Given such a partition, S calculates the unlikeliness of finding the observed number of intra-community links in a totally random network, according to a cumulative hypergeometric distribution:Here, F is the maximum possible number of links of the network, n is the actual number of links, M is the maximum possible number of intra-community links and p is the actual number of links within communities. In several complex benchmarks, composed of networks with very different structures, it was shown that the partition of maximum S corresponds to the real community structure, with a minimal/null degree of error (, b). We also showed that S outperforms modularity (Q;), the most commonly used criterion to define communities, in all benchmarks (). Although a simple algorithm to maximize S has not yet been devised, we found that choosing among the output of seven high-quality algorithms, the one that provided the maximum S value solved the structure of all networks tested. These algorithms are called CPM (), Infomap (), RB (), RN (), RNSC (), SCluster (Aldecoa and MarnMarn, 2010) and UVCluster (). The particular performances of each algorithm are detailed in Aldecoa and MarnMarn (2013a, b). Here, we present SurpriseMe, a tool integrating those seven algorithms. SurpriseMe accelerates the research process by simply accepting a network as input, internally running all the algorithms and outputting their solutions and their Surprise values. SurpriseMe also calculates distances among the solutions provided by the algorithms, allowing understanding of how congruent they are ().names of two connected nodes, separated by a tab or space character. From this text file, the software automatically generates the required input formats and runs the algorithms (either all or a subset chosen by the user). Finally, the algorithm that generates the maximum S value is established. For Infomap, RN and RNSC, the unique partitions generated are evaluated, while for RB, CPM, UVCluster and SCluster, which provide several alternative partitions, the ones with the highest S value are considered. SurpriseMe also compares the solutions of each algorithm, using either the Variation of Information (VI) () or the [1  NMI] value, where NMI stands for Normalized Mutual Information (). In both cases, the greater the value, the more two partitions are different (see Aldecoa and MarnMarn, 2012, 2013a, b). The program also estimates the distances to two additional solutions called One (all units of the network are in one community) and Singles (each node belongs to a different community). The distances to these two solutions provide further clues of the behavior of the algorithms (Aldecoa and MarnMarn, 2013b). All distances are saved into two distance matrix files (for VI and for 1  NMI) that can be directly imported into MEGA5 (), a popular free software that allows easily visualizing the hierarchical relationships among the different solutions (see Aldecoa and MarnMarn, 2013b).
MATERIALS AND METHODS
SurpriseMe features
PerformanceThe algorithms involved are substantially complex. With n being the number of nodes and m the number of links, here we provide their computational complexities (time/space): for CPM and RB, O(n log n)/ O(n  m); for Infomap, O(m)/O(n  m); for RN, O(m^1.3)/O(n^2); for RNSC, O(n^2)/O(n  m); for UVCLUSTER, O(n^2 log n)/O(n^2); and for SCLUSTER, O(n log n)/O(n^2). Therefore, the current version of SurpriseMe is most useful for networks of small to medium size, typically up to 10 000 nodes. We found that very small networks [e.g., those in a typical Girvan and Newman's benchmark (2002), with 128 nodes] are analyzed almost instantaneously. We also tested the software in two more complex standard benchmarks. The first had networks with a Relaxed Caveman (RC) configuration () with 10% rewiring, meaning that well-defined communities are present (see Aldecoa and MarnMarn, 2013a). The second was a set of ErdosErdos-RenyiRenyi (ER) random graphs (Erdo 00 s and Renyi), essentially without community structure. This last benchmark provides an estimate of the maximum time and resources required. In both cases, we found that networks with up to 10 000 nodes are analyzed by the seven algorithms in less than an hour using a conventional desktop PC, consuming less than 1 GB of memory. However, larger networks require more powerful hardware. With all the programs, a RC network of 50 000 nodes requires about 140 h of analysis and 60 GB of memory. In those cases, it may be advisable to switch off the most time-and resource-consuming programs (RN, SCluster and UVCluster), given that the four remnant programs generally provide very good solutions and are complementary (i.e., they work optimally in different network structures; Aldecoa and MarnMarn 2013a, b). Thus, their combination will still generate either very high or maximum S values. The resources required for a network of 50 000 nodes are then reduced to 40 min and 14 GB of memory (RC structure) or 8 h and 39 GB of memory (ER configuration). For a RC network of 100 000 nodes, we have determined that the four fastest algorithms take 3 h and 30 GB of memory in RC networks and 21 h and 66 GB of memory in ER networks.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
SUMMARY Only few researchers have the time and skills to select, download, compile and run multiple community detection algorithms. SurpriseMe allows very simply running a set of state-of-the-art algorithms and determining the one that generates the best Surprise value, i.e. the best partition of the network. It also provides the user with distance matrices (with VI, 1  NMI values) that help to compare the solutions of the algorithms. Simple to use, it only needs as input a file containing the network to analyze. The well-established power of this type of analysis, together with the simplicity of its use, makes SurpriseMe an excellent tool for characterizing the community structure of complex networks. Funding: Study supported by grant BFU2011-30063 (Spanish government). Conflict of Interest: none declared.
R.Aldecoa and I.Marn at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
