Motivation: RNA sequencing (RNA-Seq) is a powerful new technology for mapping and quantifying transcriptomes using ultra high-throughput next-generation sequencing technologies. Using deep sequencing, gene expression levels of all transcripts including novel ones can be quantified digitally. Although extremely promising, the massive amounts of data generated by RNA-Seq, substantial biases and uncertainty in short read alignment pose challenges for data analysis. In particular, large base-specific variation and between-base dependence make simple approaches, such as those that use averaging to normalize RNA-Seq data and quantify gene expressions, ineffective. Results: In this study, we propose a Poisson mixed-effects (POME) model to characterize base-level read coverage within each transcript. The underlying expression level is included as a key parameter in this model. Since the proposed model is capable of incorporating base-specific variation as well as between-base dependence that affect read coverage profile throughout the transcript, it can lead to improved quantification of the true underlying expression level. Availability and implementation: POME can be freely downloaded at
INTRODUCTIONThe transcriptome is the complete set of transcripts in a cell under any given developmental stage or physiological condition. Comprehensively cataloging all the components in the transcriptome is a grand challenge in the post-genome era. In the past decade, microarray technology has played a prominent role in advancing our understanding of transcriptome complexity by allowing scientists to simultaneously monitor the expression of almost all the genes in the genome (). Despite its overwhelming success, microarray technology has its limitations. For example, designing probes on the chip requires knowledge of * To whom correspondence should be addressed. the genome sequence and annotation; hence, novel transcripts will be missed. Additionally, cross-hybridization, background signal and saturation result in a reduction of microarray's dynamic range and accuracy. A recently developed sequencing-based technology for measuring gene expression, termed RNA-Seq, has the potential to overcome these limitations (). The ultra-high-throughput next-generation sequencing technologies capable of producing millions of sequence reads dramatically increase the throughput in DNA sequencing compared with conventional Sanger technology and at a much lower cost. An array of studies has been published that successfully apply these new sequencing technologies to measure mRNA expression levels in cells from various species (). Since Illumina's platforms have been widely adopted in RNA-Seq experiments, we focused on short read RNA-Seq data generated from the Illumina platform in this study. In RNA-Seq experiments using the aforementioned sequencing technologies, RNA molecules are first converted to a library of cDNA fragments with adaptors attached to both ends. Each molecule, often after amplification, is then sequenced using one of the next-generation sequencing technologies. Following sequencing, the resulting reads are aligned to known transcripts or de novo assembled together to produce a genome-scale transcriptional profile. A fundamental question in RNA-Seq data analysis is to derive expression level from raw sequencing output data. This is the basis of almost all further investigation such as detecting differentially expressed genes, alternative splicing events, etc. Sophisticated and tailor-made data analysis methods are needed to fully realize the power of the new sequencing technologies. A natural idea is to use the total number of reads mapped inside each transcript, or region of interest (ROI), to represent the expression level.proposed to use the number of reads per kilobase of a transcript per million mapped reads (RPKM) as the transcript's expression level. The RPKM method is easy to implement and takes into consideration the transcript length and the total number of uniquely mapped reads. However, the RPKM method is oversimplified, as it ignores the variability of read coverage within an ROI demonstrated by real RNA-Seq data. MorePage: 64 6368
M.Hu et al.sophisticated methods are required to account for the complexity and uncertainties associated with read mapping and read depth within an ROI. In that regard, model-based methods can potentially improve upon the RPKM method by explicitly modeling the varying sequencing read coverage within an ROI. A number of models have been proposed in the literature, such as Poisson model (), generalized Poisson model () and negative binomial model (). However, these models are not sophisticated enough to capture all the variability demonstrated in the observed RNA-Seq data. For example, they do not consider variation in sequencing read coverage within an ROI resulted from local genomic feature and fluctuation in the baselevel PCR amplification rate. To accommodate this type of variation,proposed to use Poisson distribution with varying intensity rate to model read counts covering different positions in an ROI and developed a method called mseq to quantify its expression level. The mseq method utilizes neighborhood sequence information and can better explain base-level read counts variation in RNA-Seq data. Despite improvement over other existing methods, the mseq method assumes that the observed base-level read counts are stochastically independent with each other in an ROI. Analyzing real data indicated that this assumption is not valid in a substantial proportion of the ROIs. We found that in highly expressed transcripts, between-base or spatial dependence is not negligible (see Section 3). Ignoring this dependence may lead to less accurate estimation of the true expression levels. The presence of location-specific variation along with betweenlocation correlation is an outstanding characteristic of many spatial data generated in geostatistics, spatial epidemiology and image processing, and has been studied in the literature of spatial statistics (). Typically, Poisson mixed-effects (POME) models are used to analyze such spatial count data. In this study, in order to model base-specific read coverage while accounting for their dependency simultaneously, we apply the spatial POME model to characterize transcript level RNA-Seq data.
METHODS
POME modelLet Y jk represent the number of reads whose mapping starts at the j-th base of a specified transcript in the k-th sample. Here j = 1,...,n, n is the length of the transcript, and k = 1,...,m, m is the number of samples. The definition of Y jk is the same as in mseq (). Further let  k represent the expression index of the transcript in the k-th sample, which is of primary interest. Our goal is to build a statistical model to capture the base-specific variation and between-base correlation in Y jk. This idea is motivated by the model-based expression index (MBEI) model proposed by Li and Wong (2001) to model probe-level microarray gene expression data. In order to avoid over-fitting using a complex model, we propose the following POME model for Y jk :In addition to the fixed effect  k , which is the expression index that is of primary interest, there are two random effect terms in this model: U jk 's and V jk 's. As in spatial statistics, V jk 's are assumed to be independent and identically distributed as N(0, 2 v ), and used to account for unstructured variability, which may be attributed to some latent factors for over-dispersion; U jk 's are used to represent the correlation between the read counts of different base pairs. Like in spatial statistics, there are various ways to specify this correlation structure. In POME, we chose the intrinsic conditional autoregressive (ICAR) structure (). The ICAR structure specifies between-base correlation using a Gaussian Markov random field. Originally, the ICAR structure was proposed for image processing and was later used for disease mapping in spatial epidemiology (). For a fixed base j, first we define its neighborhood, denoted by j as the collection of the two bases j 1 and j +1 that are adjacent to base j. Other definitions of neighborhood are possible, for example, bases that are not immediately adjacent to base j can be included in j (). Second, we define a weight matrix W = (w ij ) as follows. For 1  i, j  n, w ii = 0; w ij = 1 if i  j; and w ij = 0 otherwise. Let U (j)k denote the collection of U ik 's with i = j. The conditional distribution of U jk given U (j)k is assumed to be:The ICAR structure induces correlation between different bases. Another option for the correlation structure is the joint structure (). The joint structure assumes that in the k-th sample, U jk 's follow the multivariate Gaussian distribution N(0, 2 u ), where = ( ij ) is the correlation matrix of U jk 's and  ij =  d ij , 0 <<1, d ij is the distance or the number of base pairs between the i-th base and the j-th base, i.e. d ij =|ij|. When the ICAR structure in POME is replaced by the joint structure, the resulting model is referred to as the joint model. The discussion about the pros and cons of the joint versus ICAR structure can be found in the disease mapping literature (). We choose the ICAR structure in POME, because read coverage for some transcripts may be sparse and the excessive zero counts pose a challenge for the joint model. POME is flexible in that covariates or deterministic patterns that affect  k can be incorporated into the POME model in a straightforward fashion. In the literature on disease mapping, Markov chain Monte Carlo (MCMC) techniques () are the predominant methods used for fitting the POME model and performing subsequent statistical inference, following. In the literature on image processing, however, maximum likelihood methods are also used for model fitting and inference; seefor example. The preference for Bayesian computational methods is due to the fact that the random effects U jk 's and V jk 's are not directly observable; and it takes high-dimensional integration to integrate them out, which can be computationally challenging. In this study, following the tradition in disease mapping, we use Bayesian computational methods when applying the POME model for transcript level RNA-Seq data analysis.
Model implementationThe MCMC methods are employed to carry out the fitting of the POME model and subsequent statistical inference. We start from assigning appropriate priors for the model parameters. The marginal distributions of the random effects U jk and V jk are N(0, 2 u ) and N(0, 2 v ), respectively. Following the approach by, we define the total precision as  = ( 2 u + 2 v ) 1 , and specify a Gamma prior for it, which is   (a,b).represent the proportion of base-specific variation in the total variation. We assign a Beta prior Beta(c,d) to p. If the joint structure is assumed for U jk 's, there is another parameter  determining the extent of between-bases correlation. We assign another Beta prior Beta(e,f ) to . A non-informative prior I(0,+) is assigned for  k. As the default, we specify c = d = e = f = 1 so that the priors for p and  are uniform distributions on. The total precision  = ( 2 u + 2 v ) 1 plays a crucial role in the model and the final result is sensitive to the prior assigned to . We adopt an empirical Bayesian method to further specify a and b in the prior (a,b) for  by setting a = 1 and b = max 1km1km 1km k (Section 1 in Supplementary Material). It is straightforward to derive the joint posterior distribution involving all the fixed and random effects or parameters (Section 2 in SupplementaryPage: 65 6368
POME model for RNA-SeqMaterial), and we use Gibbs sampler to iteratively sample parameters from the conditional posterior distributions. Since we use the conjugate priors, the conditional posterior distributions for  k and  are Gamma distributions, which are easy to sample from. The conditional posterior distributions for random effects U jk 's and V jk 's are rather complicated and not in closed forms. Since both are log-concave functions, we use the adaptive rejection sampling (ARS) method () to draw samples from them. For the other parameters, p and , their conditional posterior distributions are nearly log-concave. We use the adaptive rejection Metropolis-Hasting sampling (ARMS) technique () to draw samples from these complicated distributions. One important issue in using ARS and ARMS is to assign appropriate ranges for the parameters. In ARS, we use the intervalfor random effects U jk 's and V jk 's. For the parameters p and , we use their natural rangein ARMS. In addition, to make the fixed parameter  k identifiable, we impose the following two constrains on the random effects in each iteration of the Gibbs sampler:When fitting the POME model, we ran 10 000 MCMC iterations for each transcript. The first 9000 samplers were dropped as the burn-in stage, and then every 10th sample in the last 1000 samplers were used to calculate the posterior means.
RESULTS
Data descriptionTo evaluate the performance of POME, we choose a published real RNA-Seq data, obtained from 12 prostate cancer cell lines and tissues (). More details about the samples can be found in the Supplementary Table S1. A brief description of the reads mapping procedure used byis provided in Section 3 in the Supplementary Material. We choose this dataset because these samples were profiled using two types of sequencing instruments with different technologies: Illumina Genome Analyzer using sequencing by synthesis technology and Helicos HeliScope using single-molecule sequencing technology. The Helicos technology represents a new wave of next-generation sequencing technologies in which samples were profiled directly without the polymerase chain reaction (PCR) step, thus eliminating the overrepresentation or underrepresentation biases introduced by the copying process of PCR, a necessary step in Illumina sequencing technology. Given this, we use the expression measure obtained from Helicos as the gold standard when evaluating expression measures reported by different algorithms analyzing RNA-Seq data generated by the Illumina platform. Transcript-level expression measures from Helicos and mapped Illumina reads information are kindly provided by the Chinnaiyan Lab. The details of the involved data processing procedures can be found in. We plotted log 2 mean versus log 2 variance of the Illumina read coverage of these transcripts in all 12 cell lines (Supplementary). We observed that the variance of read count is much larger than the mean, indicating the presence of substantial over-dispersion, especially for highly expressed transcripts. This is consistent with the observation of. Furthermore, we explored the top 500 most highly expressed transcripts according to the gold standard Helicos measures, of which 439 also satisfied the minimum read coverage criterion in the Illumina platform (> 0.3 RPKM noise level used in thestudy) and minimum effective length criterion (with more than 100 non-zero y jk 's). When examining these transcripts in the LnCaP_0 sample (Supplementary), we found that the median of the lag one autocorrelations between baselevel read counts of these transcripts is 0.11, the third quartile is 0.18 and the maximum correlation is 0.57. We checked on other samples and observed similar patterns. These findings indicate that dependence between read counts of adjacent base pairs is real and needs to be considered.
Simulation study
Simulated data from the joint POME modelWe conducted a simulation study to compare the performance of the POME method against the commonly used methods in quantifying transcript-level gene expression: RPKM (), mseq () and GPseq (). We simulated the read coverage profiles from the spatial POME model with the joint correlation structure, i.e. the joint model which is different from POME. To make our simulation study more realistic, we first used the joint model to fit observed read count data in the 439 transcripts of high expression levels. We then sampled putative sequencing coverage profiles for these transcripts from the joint model. The proportion of base-specific variation in the total variation p was drawn randomly from a uniform distribution defined on the interval (0.1, 0.9). The simulation was repeated 100 times. For each dataset, we applied RPKM, mseq, GPseq and POME, and calculated the mean square errors (MSEs) of the four resulting estimates of expression index . For all 439 transcripts, the POME method achieved the smallest MSE (1.2024, standard error 0.0379). The MSEs reported by RPKM, mseq and GPseq were much larger: 65.4605 (standard error 4.2217), 87.1559 (standard error 23.3511) and 16.0718 (standard error 0.0692), respectively. The RPKM method overestimated the true expression level when data showed strong over-dispersion. On the other hand, mseq used 40 bp in the neighborhood of each nucleotide as local sequence features that affect the base-level read coverage rate, which may have caused it to over fit the data. Although GPseq is capable of modeling both over-dispersion and underdispersion patterns in the data, it does not take into account the spatial dependence between adjacent base pairs that may result in less accurate estimates.
Simulated data from the generalized Poisson modelNext we conducted another simulation study with a different simulation strategy. We simulated the read coverage data from the generalized Poisson distribution GP(, ). We again used the 439 highly expressed transcripts in the previous simulation study, and fitted a generalized Poisson model using GPseq () to obtain the empirical estimatesestimates estimates andand and in each transcript. We then simulated the read coverage profiles from GP(  ,  ) for all 439 transcripts. We applied the RPKM method, mseq and the POME method to estimate , separately. We did not apply GPseq in this simulation study since the data were simulated from the generalized Poisson distribution. The simulation was repeated 100 times, and the MSEs of the three resulting estimates of  were calculated.The results were similar to what we have obtained in the previous simulation study. Although the data were simulated from generalized Poisson distribution with over-dispersion, POME nevertheless was able to provide more accurate estimate of  through explicitly modeling the position-specific variation.
M.Hu et al.
Real data analysisWe next analyzed real RNA-Seq data in the 12 prostate cancer samples. Since highly expressed transcripts often display high level of over-dispersion, we selected the 5000 most highly expressed transcripts according to Helicos measures in each sample and removed those that show extreme low read coverage in Illumina [<0.3 RPKM noise level as in the. The numbers of corresponding transcripts measured by Illumina sequencing were listed in. We applied RPKM (), mseq (), GPseq () and POME as before. For mseq, we used 40 bp in the neighborhood of each nucleotide, and used the top 500 highly expressed transcripts as the training dataset. To avoid complication of missing data due to unmappable regions or dubious annotation, we removed all positions with zero coverage from each transcript in the data pre-processing step. We used Helicos measure as the gold standard and compared the Spearman's rank correlation coefficients between the Helicos measure and the estimates of transcript-level gene expression generated by the four tested methods, respectively.shows the overall performances of the four tested methods. POME achieved the highest Spearman's correlation coefficients in 10 of the 12 samples except for sample 'aT34N' and sample 'VCaP', where GPseq and RPKM were the best, respectively. To further investigate the differences between POME and the other three competing methods, we focused on a subset of transcripts with high over-dispersion and high spatial dependence. The magnitudes of over-dispersion and spatial dependence were measured by variation-to-mean ratio (also called 'Fano factor') and lag one autocorrelation between base-level reads count, respectively. In each sample, around 1500 transcripts were selectedwith both above-median over-dispersion and above-median spatial dependence. The numbers of selected transcripts in each sample were listed in. We again compared the Spearman's rank correlation coefficients between the Helicos measure and the estimates of transcript-level gene expression generated by the four tested methods, respectively.shows the overall performances of the four tested methods in the selected subset of transcripts with high over-dispersion and high spatial dependence. The POME method achieved the highest Spearman's correlation coefficients in all 12 samples. Based on the real data results above, we believe that POME provides more accurate quantification of transcript-level expression than the other three competing methods, especially for transcripts with high over-dispersion level and high spatial dependence. We next repeated the above analyses using the Pearson's correlation coefficients and obtained similar results. The POME method achieved the highest Pearson's correlation coefficients in 7 of 12 samples using highly expressed transcripts (Supplementary). Using a subset of transcripts with high over-dispersion and high spatial dependence, the POME method achieved the highest Pearson's correlation coefficients in 9 of 12 samples (Supplementary). To understand the differences between POME and the other three competing methods (RPKM, mseq and GPseq), we zoomed in on those transcripts for which the tested methods gave dramatically different expression measures. In the discussion below, sample LnCaP_0 was used as an illustrative example. To be specific, we first transferred the estimated transcript-level expression values and the Helicos measures (gold standard) into ranks, since we used Spearman's rank correlation coefficient to measure the performance of a tested method. Next we calculated the rank differences between POME and other three competing methods, and selected the top 10 transcripts with the largest rank differences. We used the ranks provided by the Helicos measure as the gold standard and assumed that the better method provides a closer rank to the Helicos rank. The selected transcripts were listed in Supplementary Table S4 inPage: 67 6368
POME model for RNA-Seqwhich we also reported the variance-to-mean ratio and the lag one autocorrelation for each transcript. First we looked at the 10 transcripts with the largest rank differences between POME and RPKM. We found that POME outperformed RPKM in all 10 transcripts. The RPKM method overestimated the expression levels of these 10 highly overdispersed transcripts. In contrast, the two random effect terms in the POME model were able to account for extra variability, which contributed to POME's improved accuracy. For the 10 transcripts with the largest rank differences between POME and GPseq, POME outperformed GPseq in 8 of the 10 transcripts. All these 10 transcripts are extremely highly overdispersed (variance-to-mean ratios are >10). GPseq was not able to accommodate such huge variability by the two parameters of the assumed generalized Poisson model and in most cases underestimated the expression level. For the 10 transcripts with the largest rank differences between POME and mseq, POME outperformed mseq in 8 of the 10 transcripts. POME produced more accurate estimates than mseq when the data showed high spatial dependence, since POME explicitly incorporated the spatial dependence while mseq assumed spatial independence between reads counts covering different base pairs.
DISCUSSIONIn microarray data analysis, it is now widely accepted that estimates of the expression levels based on parametric models such as the model-based expression index (MBEI) () are more accurate in reflecting the underlying expression levels than summary statistics of raw intensity values. Inspired by the success of model-based methods in microarray data analysis, in this study, we strived to develop a model-based method for analyzing RNA-Seq data. When exploring the properties of base-level sequencing depth in RNA-Seq data, we found substantial variation in sequencing depth within most transcripts, especially for those that are highly expressed. We also found that a large proportion of transcripts (25%)shows over-dispersion in base-level sequencing depth (Supplementary), which is consistent with what has been reported in the literature (). Additionally, we found that base-level sequencing depth displays substantial dependence between base pairs that are close to each other. This type of dependence resembles spatial correlation between neighboring areas considered in spatial statistics research (), and to the best of our knowledge, has not yet been reported in the literature on RNA-Seq data analysis. Based on these observations, we believe that spatial models that can incorporate correlations such as POME have advantages over existing models in characterizing base-level RNA-Seq data. In this study, we used POME to estimate the expression level of an individual transcript. Two types of random effects are introduced to characterize two types of variation in read counts, which are between adjacent base pairs (i.e. spatial correlation) and specific to each base pair (i.e. non-spatial variation), respectively. Analyses of both simulated and real RNA-Seq data demonstrate that the expression indices estimated by POME reflect the underlying expression levels more accurately compared with existing methods. We believe that the improvement of estimation accuracy of POME comes from modeling the dependence between the read counts of base pairs adjacent to each other. The POME model can also be used for differential gene expression analysis by incorporating biological or experimental conditions or other covariates. We will pursue research in these directions in the future. POME model assumes over-dispersion in the observed count data which is the case for a large proportion of transcripts in RNA-Seq data, especially those highly expressed. For this reason, we focused on highly expressed transcripts in this study. From our experience, about one-quarter of all transcripts belong to this category. For these transcripts, our analysis on simulated as well as real data demonstrated that POME offers more accurate expression measure than other methods that we compared. We have also performed small-scale tests on transcripts with medium level expression, and found POME again outperforms RPKM, mseq and GPseq methods (data not shown). For lowly expressed transcripts, we do not recommend to use POME for inference because observed data may be under-dispersed. Like many other model-based methods, the POME method is more computationally intensive than read enumeration methods. For a 100 bp transcript without replicate, it takes 23 s for POME to complete 10 000 MCMC iterations on a Dell PowerEdge 1950 computing node (2.83 GHz CPU processors and 8 GB RAM). The computation time increases almost linearly with the length of transcripts. However, since model fitting of individual transcript is independent of each other and thus can be performed simultaneously, the computational intensity of the POME method can be much mitigated by parallel computing. The power of modern cluster computers will also help in this regard. After all, we believe that accuracy in statistical inference outweighs computation cost as long as the latter is affordable. Although we only applied the POME method to RNA-Seq data obtained from the Illumina platform in this study, we believe it can also be applied to RNA-Seq data collected from other sequencing platforms such as SOLiD with little or no modification, because these data possess similar data structures.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
