Motivation: Cellular processes are controlled, directly or indirectly, by the binding of hundreds of different DNA binding factors (DBFs) to the genome. One key to deeper understanding of the cell is discovering where, when and how strongly these DBFs bind to the DNA sequence. Direct measurement of DBF binding sites (BSs; e.g. through ChIP-Chip or ChIP-Seq experiments) is expensive, noisy and not available for every DBF in every cell type. Naive and most existing computational approaches to detecting which DBFs bind in a set of genomic regions of interest often perform poorly, due to the high false discovery rates and restrictive requirements for prior knowledge. Results: We develop SparScape, a penalized Bayesian method for identifying DBFs active in the considered regions and predicting a joint probabilistic binding landscape. Using a sparsity-inducing penaliza-tion, SparScape is able to select a small subset of DBFs with enriched BSs in a set of DNA sequences from a much larger candidate set. This substantially reduces the false positives in prediction of BSs. Analysis of ChIP-Seq data in mouse embryonic stem cells and simulated data show that SparScape dramatically outperforms the naive motif scanning method and the comparable computational approaches in terms of DBF identification and BS prediction. Availability and implementation: SparScape is implemented in Cþþ with OpenMP (optional at compilation) and is freely available at 'www. stat.ucla.edu/*zhou/Software.html' for academic use.
INTRODUCTIONMany complex processes in the cell, particularly gene regulation, are controlled by the binding of various factors to the DNA sequence. A key to understanding these processes is determining where each of these DNA binding factors (DBFs), including transcription factors (TFs), nucleosomes, RNA and other proteins and protein complexes, binds in the genome in a certain cell type and set of conditions. This collection of binding sites (BSs) for all DBFs over regions of interest is sometimes called a binding landscape. More formally, we define a binding landscape as the base pairspecific probability of binding for each of a library of DBFs over a set of genomic regions. Considering DBFs one at a time leads to many false positives, both in determining which DBFs have significantly enriched BSs in a set of genomic regions and in predicting the exact locations of BSs, and results in a limited view of the processes controlled by these DBFs. This has motivated recent work on jointly predicting binding landscapes for a set of DBFs. Currently, joint landscapes at single base pair resolution for all DBFs have only been predicted in lower eukaryotes such as yeast with fewer DBFs and much smaller genomes (). In higher eukaryotes, predictions have been limited to a (usually small) pre-selected set of DBFs known to bind the regions of interest (). Of these methods, only that ofdoes not require the DBF concentrations as prior knowledge, something made possible by considering at most two DBFs at a time, and onlyused ChIP-Seq data as a source of direct information. See, Teif and Rippe (2010) andfor recent examples of alternate approaches to answering related questions. Owing to computational limits, it is impossible to predict a joint base pairspecific binding landscape for all DBFs with unknown concentrations over the entire genome in higher eukaryotes with large genomes and many DBFs. We are thus limited to exploring a subset of the genome. One motivating type of genomic subset is a set of regions known to be co-bound by a small group of DBFs based on ChIP-Seq data. In such a genomic subset, we do not expect most DBFs to have a significant number of BSs. Thus, the false positive BSs in a predicted binding landscape can be substantially reduced if only the DBFs with significantly enriched binding in the regions of interest are considered. However, it is limiting to require the complete set of DBFs enriched in the considered regions to be known a priori as is done in existing work on similar questions in higher eukaryotes. In this article, we develop a method that offers a principled way to select an, often small, subset of DBFs active in the regions of interest and to reduce the false-positive signal in the predicted probabilistic binding landscape, eliminating the need for prior knowledge of the set of enriched DBFs or DBF concentrations. In the motivating genomic subset, our method allows for the discovery of unknown cofactors that commonly bind near the DBFs with ChIP data (ChIP DBFs). The predicted joint binding landscape provides a global and quantitative view of the binding pattern among the DBFs. This is an initial step to the study of combinatorial regulatory logic among multiple DBFs. *To whom correspondence should be addressed.
MODEL AND ESTIMATION
Overview of SparScapeOur method, SparScape, proceeds in two stages. First, from a candidate set we select the DBFs with significant binding in the considered regions. Second, we do a refined prediction of the binding landscape considering only the selected DBFs. See Supplementaryfor a schematic illustration of the method. SparScape takes as input the previously estimated binding motifs for a set of candidate DBFs, the sequence of a set of genomic regions of interest and genome-wide binding data (e.g. ChIP-Seq) for any of the candidate DBFs if available. The set of regions could be the whole genome when examining small genomes. We consider nucleosome binding because nucleosome occupancy blocks the binding of many other DBFs, and recent studies have demonstrated the utility of nucleosome models in protein binding landscapes (). We model nucleosome binding preferences by a position-specific Markov model proposed by. Details are provided in Supplementary Methods Section S1.1. The binding of nonnucleosome DBFs is modeled by position-specific weight matrices (PWMs). The background is modeled by a fifth-order Markov chain estimated from a large set of sampled or simulated regions similar to the regions of interest. We model ChIP data as a set of binary windows, where a window of base pairs around the center of a ChIP peak is called a ChIP window for that DBF. In this work, we use ChIP windows of 50 bp on either side of a ChIP-Seq peak. Our method estimates the probability that a BS for a DBF with ChIP data is entirely within one of its own ChIP windows. This is in the same spirit as the use of DNase I sensitivity measures to create an informative prior distribution for TF binding (), though SparScape can exploit binding data for any of the candidate DBFs or the nucleosome. Moreover, ChIP windows are included as part of a generative probabilistic model with parameters related to the accuracy and sensitivity of ChIP peaks, resulting in a more principled and flexible utilization of ChIP data. Estimating concentrations is a unique feature of SparScape. This makes it impossible to exactly calculate the binding landscape through forwardbackward summation. Instead, we explore the posterior distribution through a penalized iterative sampling approach, simultaneously selecting DBFs, estimating model parameters and predicting the binding landscape. Note that concentration here is not related to the physical concentration of the DBF, but rather summarizes the enrichment of BSs in the considered regions and gives the probability of a BS beginning at any location in the sequence. One could use physical concentration measures such as gene expression to build an informative prior on the concentration vector, but we have not explored this possibility. Jointly estimating the concentrations introduces a risk of excessive false positives, especially for DBFs with less informative motifs where we expect non-functional matches to occur frequently in the genome. To avoid this, we use a penalty on the predicted site counts in each iteration, penalizing in proportion to the expected number of false-positive sites estimated with control regions given the current parameter values. Intuitively, this removes the expected false-positive sites from the sampled sites. The level of penalization is controlled by a tuning parameter, chosen in the first stage through 10-fold cross-validation. With a proper level of penalization, concentrations of many DBFs will be estimated as exactly zero, achieving the goal of DBF selection. The final binding landscape, considering only the selected DBFs, is predicted in the second stage. When selection and prediction are completed, SparScape reports a binding landscape, which gives the probability of binding at each base pair by each selected DBF, and the estimated parameter values, including the concentrations for the DBFs. It also reports the binding configuration and the parameter values sampled at each iteration, allowing, for example, construction of credible intervals for the parameters and examination of high-order interactions between binding at different sites.
The SparScape modelConsider the sequence S of a set of genomic regions with total length jSj, and the set of ChIP windows D in these regions for all ChIP DBFs. Let K be the number of candidate DBFs, and  denote the set of binding model parameters for all K DBFs, including the nucleosome, and the background model. Under the standard steric hindrance constraint, we define a binding configuration as a partition of the sequence S into unbound background sites and BSs for the K DBFs. Denote a configuration by A  a 1 , a 2 ,. .. , a jAj , where a i is the index of one of the K  1 models and represents a subsequence of base pairs bound by a DBF (or is a single unbound base pair) in the current configuration. More specifically, it represents a single unbound site covering L 0  1 bp when a i  0, a nucleosome covering L 1  147 bp when a i  1, and a non-nucleosome DBF from the candidate library covering L k bp when a i  k 2 f2,. .. , Kg, where L k is the length of the motif for the k th DBF.illustrates an example configuration. Let be the probability that a BS for a ChIP DBF is entirely within one of its ChIP windows and be the probability that an unbound base pair is not covered by any of the ChIP windows. Write   , . Denote by T   0 ,. .. , K  the probabilities of initiating a background site (k  0) and other DBF sites (k  1,. .. , K) at a given location P k k  1, k ! 0   . This can be thought of as a vector of local concentrations (local to the regions considered). We wish to jointly estimate the binding configuration A, the concentrations T and the ChIP parameters . Given binding configuration A, we consider the sequence S and the ChIP windows D as independent sources of information. We further assume independent priors on T and . Under these model assumptions, the joint posterior distribution is P, T, AjS, D,  / PS, D, Aj, , T, T  PSjA, PDjA, PAjTT, 1 where PS, D, A , , T j is the complete-data likelihood, regarding A as missing data. The posterior distribution of A gives the predicted binding landscape. Our primary goal is to select the DBFs with motif models in  that have a significant number of BSs in S and predict the likely binding configurations.We achieve this by assigning a statistical weight based on Equation (1) to every binding configuration and searching the space of possible configurations through Monte Carlo sampling. Note that different DBFs can bind to the same base pairs in different configurations, and thus, our sampling approach allows relatively large posterior binding probabilities for multiple DBFs for the same base pair if BSs do overlap. The first part of the statistical weight is the ratio between the likelihood of the sequence given a configuration A and the likelihood given the null configuration A 0 where no DBFs are bound. Let S j be the base at position j and S Starti:Endi be the subsequence in S from the first to last base pairs covered by element a i in the A. Define the single-element sequence likelihood ratio as follows:for a i  k 2 f1,. .. , Kg, where k is the parameter (e.g. PWM) for the kth binding model. See Supplementary Methods Section S1.2 for the detailed formulation. By definition H 0 1. The second part of the statistical weight is the ratio between the likelihood of the ChIP windows given a configuration A and the likelihood given the null configuration A 0. The background window is defined as the set of base pairs not covered by any of these windows. Thus, if we have M ChIP DBFs, we will have M  1 sets or types of windows, where windows of type 0 are the background windows. Let d Starti:Endi be the type of the window covering the element a i. When a i indicates a ChIP DBF, we definewhere ! k, j j 6  k is proportional to the total length of all windows of type j and P j6 k ! k, j  1. For background sites (a i  k  0), is replaced by in (3) and (4). The model for a DBF without ChIP-Seq data is identical to that for background sites. Seefor an illustration and SupplementaryNote that when a i  k  0, i.e. the ith element is an unbound base pair, by definition we have L0, '  1 for all '. The product of L over a i defines the complete-date likelihood ratio,
Sparsity through penalizationThe total number of candidate DBFs K is often large. We seek DBF selection because we expect that BSs for a large majority of candidate DBFs are not enriched in the considered genomic regions. Considering DBFs that are not truly enriched when predicting the final landscape increases false positive predictions, sometimes dramatically. One way to achieve DBF selection is to estimate many concentrations k as exactly zero, as k is the probability of initiating a BS for DBF k. It can be seen from(6) that the log-likelihood for T given A is P K k0 C k log k , where C k is the number of BSs of DBF k in A. If we take the conjugate Dirichlet prior on T with prior counts k 40, for k  0,. .. , K, the conditional posterior distribution for T is a Dirichlet distribution DirC 0  0 ,. .. , C K  K . A sample from this distribution always has positive components, based on which we cannot construct a sparse estimation of T. Thus, we run our algorithm in the selection stage for a burn-in period with k  1, and then set k  0. If C k  k  0 at some iteration, then the conditional posterior distribution has a point mass at k  0. This allows us to achieve sparsity in the sense that some k  0 with a positive probability. DBFs that hit k  0 at any sampling iteration are selected out. Unfortunately, for many DBFs we expect relatively strong non-functional motif matches to occur randomly, leading to a non-negligible number of false positive predicted sites such that k almost never hits zero. We counteract this false positive signal with penalty terms on the parameters T and , leading to a penalized complete-data log-likelihood of the form log PS, D, Aj, ,(b)where F k ! 0 is the expected count of false positive BSs for DBF k, ! 0 is a tuning parameter and  denotes the penalty for . Given the current concentrations, F k is estimated empirically from a set of control sequences, possibly simulated, with no (known) true sites (Supplementary Methods Section S1.4). Seefor a schematic of the penalty count and net site count calculation. We did not penalize the nucleosome concentration ( 1 ) in the results presented here, but SparScape supports such penalization. Together with the prior distribution , T, we obtain a penalized posterior distribution. To understand this penalized posterior, consider sampling from the conditional distributions taking the penalties into account. The conditional sampling from Aj, T, S, D,  is not affected by the penalization and can be implemented by forward summation and backward sampling (). See Supplementary Methods Section S1.5 for details. Consider penalized sampling from , TjA, S, D, . Let n k  C k for k  0, 1 and n k  C k  F k   for k ! 2, where x   max0, x. We think of n k as the net site count after discounting for false positives F k. Then the penalized completedata log-likelihood for the concentrations T is P K k0 n k log k. If the penalty F k ! C k for some iteration, then the net site count n k  0 and the conditional posterior distribution of T (with k  0) has a point mass at k  0. Thereafter, we drop DBF k from further consideration. See Supplementary Methods Section S1.6 for more details about this conditional sampling step.shows penalized and unpenalized sample paths for the concentrations of a true and a false DBF in a simulated dataset, with more examples in Supplementary.demonstrates that moderate penalization can eliminate a false-positive DBF even when its concentration would otherwise stabilize around a highly inflated value. While k may hit zero for some false-positive DBFs even with  0, as shown in these figures, there are many cases where DBF selection is achieved by using a non-zero penalty 40. Setting the prior counts k  0 is mainly for mathematical rigor so that k may hit zero exactly, as any positive value of k will never give k  0 in any sampling iteration. In addition, this choice also avoids the use of a threshold value on the estimated k for DBF selection, which would be necessary if k were positive. Penalization on the parameters in  is similar. The conditional posterior distributions for and given A are beta distributions. The counts in both are related to the site counts inside and outside the relevant set of ChIP windows. We penalize the counts for these beta distributions in the same manner as described above. Suppose we have sampled C k sites for DBF k and C in k is the count of these sites within a ChIP window of type k. Then the net site count n in k  n k C in k =C k  for the inside count, and likewise for the outside count (Supplementary Methods Section S1.7). The penalty parameter controls the level of penalization on sampled site counts in each iteration of our algorithm. We developed a method for choosing similar to the work by Fu and Zhou (2013) via 10-fold cross-validation, with details in Supplementary Methods Section S1.8. The DBFs with a nonzero concentration in at least 5 out of 10 training sets for the chosen are regarded as selected DBFs.
Landscape predictionAfter enriched DBFs are selected, the binding landscape is predicted considering only the selected DBFs with prior counts k  1. Recall that a final run of our iterative sampling algorithm is necessary because with unknown concentrations calculating binding probabilities exactly through forward-backward summation is impossible. For an outline of the full algorithm, see Supplementary Methods Section S1.9. In the DBF selection stage we penalize the BS counts to encourage sparsity in concentration estimation. Overall, the penalty biases DBF concentration estimates downward and biases the predicted binding landscape toward higher specificity and lower sensitivity. One can increase the sensitivity of BS prediction in the final stage by not penalizing. One may also consider reestimating PWMs, using previously published PWMs as prior information. This can increase sensitivity but may result in minor modes with some concentrations highly inflated. In such cases the landscape prediction with penalized site counts and fixed PWMs must be used despite the downward bias.
RESULTS
Applications to mouse embryonic stem cell and simulated dataWe investigate two mouse datasets derived from multiple TF loci (MTL) regions defined in. In that article, 12 TFs known to play a key role in maintenance of embryonic stem cells (ESCs) were studied with ChIP-Seq experiments. These 12 TFs are Stat3, Nanog, Klf4, Pou5f1/Oct4, Esrrb, Sox2, cMyc, Smad1, nMyc, E2f1, Tcfcp2l1 and Zfx. Two main clusters of BSs were found, one centered around Oct4 (Nanog, Sox2, Oct4, Smad1, Stat3) and the other around cMyc (cMyc, nMyc, E2f1,Fig. 2. Sample paths for the concentration of a DBF in the selection stage in a simulated dataset for a penalized run (  0:2) and an unpenalized run (  0). The dotted vertical line indicates the iteration at which the prior counts ( k ) were reduced from 1 to 0. (a) A DBF with no true sites. With no penalty (  0), the concentration estimate is massively inflated. Twenty percent penalization pushed the concentration estimate to zero and eliminated this false positive DBF. (b) The sample path for a DBF with true BSs, illustrating the fact that concentration estimates for true positive DBFs are generally stable under non-excessive penalization TRANSFAC database (). We use SparScape to nominate novel possible co-factors that act in concert with these known core TFs in mouse ESCs. Two simulated datasets, each composed of 1000 simulated regions, were designed to mimic, respectively, the two mouse datasets, with a detailed description in Supplementary Methods Section S1.10. To evaluate performance across a range of sample sizes, for both the mouse and simulated data, the entire Oct4 group was analyzed together, but the cMyc group was randomly divided into subsets of 100 regions. DBFs were selected using only the first random subset and binding landscapes were predicted over all subsets with the selected tuning parameters and DBFs. The most comparable method with available software is COMPETE (). COMPETE requires a fixed concentration vector and a pre-selected set of DBFs as input. We chose the concentration vector following the tuning procedure outlined in their article. Since the primary source of information for both SparScape and COMPETE is the sequence, we also compared against a naive approach considering the raw binding score at each locus. This raw score is the ratio of the PWM score over the background model score for a given w-mer (2).
Comparing DBF selectionBoth COMPETE and the raw score method use only sequence information and do not use ChIP data like SparScape. To make a fair comparison, we first show that SparScape outperforms COMPETE and the raw score method when we ignore the available ChIP data and only use the sequence data. This illustrates the value of penalization and joint concentration estimation in SparScape. When the ChIP data are used, SparScape outperforms the competitors more dramatically. To select DBFs using COMPETE, we ranked the DBFs by the total predicted binding probabilities over all base pairs and chose rank cutoffs for comparison with other methods. For the raw score method, when considered separately by locus, the number of scores for a DBF that exceed a chosen threshold (we used 1000 and 2000) approximately follows a Poisson distribution when there are no true sites. An expected false-positive count of scores over this threshold was estimated from control regions and used as the rate parameter of the Poisson distribution to find a P-value for the hypothesis that the DBF had no true sites in the examined regions. We considered three approaches to controlling for multiple comparisons. Our most conservative method was the ranking method where we ranked all the DBFs by their P-values and considered only the top N, where N is the number of DBFs selected by SparScape. The next most conservative approach was the use of the standard Bonferroni multiple testing adjustment to control the family-wise error rate at 5%. The least conservative approach was controlling the false discovery rate (FDR) at 5%.summarizes DBF selection results for the three methods. Even in the best case for the alternate methods, SparScape provides more powerful and more accurate DBF selection, in the large (Oct4 group) and small (cMyc group) datasets and in the real and simulated data, using ChIP data or not. To achieve similar sensitivity for the factors we know are enriched, the other methods nominate between 4 and 10 times as many possible co-factors, fewer of which are plausible compared with those nominated by SparScape. SparScape also did a better job selecting the DBFs around which the examined regions were built, selecting three of the five members of the Oct4 group and all four members of the cMyc group. When choosing the same number of DBFs selected by SparScape, COMPETE or the raw score method selected at best one member of the Oct4 or cMyc groups in the respective sets of MTL regions. When regions are analyzed to select target DBFs for lab-based follow-up experiments, it is of critical importance to reduce the number of false leads suggested by computational analysis. A major reduction in false positives in selecting DBFs is a key advantage of our new method. The substantial improvement over COMPETE highlights the critical roles of penalizing false positive counts and estimating concentrations in SparScape. The joint DBF selection is a key factor in the improved performance achieved by SparScape. To demonstrate this point, we compared against an individual selection approach under the same framework of SparSpace but considering one candidate DBF at a time with the nucleosome. We applied this individual approach to the cMyc group mouse data with ChIP windows and ran SparScape 10 times for each DBF with the same as chosen in our joint run on that dataset. This individual approach selected 112 DBFs, 97 of them in all 10 runs, including 9 of the 12 ChIP DBFs. As expected, this result is close to that of the raw score method (with FDR control). As shown in, the joint run selected only 11 total DBFs including 5 ChIP DBFs. This highlights the huge reduction in the false positives for DBF selection that results from considering all the DBFs together. In the Oct4 regions, SparScape selected Zfp219, Egr1/Krox24, Sp1 and Nr6a1/GCNF besides the ChIP DBFs. All four have been identified in the literature as having some association withNote: (A) Simulated data and control. (B) Mouse data and sampled control. In (A), T/N represents T true DBFs out of N DBFs selected. In (B), T/N represents T ChIP DBFs out of N DBFs selected. For COMPETE, the number of DBFs to select from the ranked list was chosen to match that of SparScape (the Rank row) or the raw score method (the Bonf and FDR rows). The Rank row gives ranked results for the raw score method and COMPETE that match the number selected by SSNC. The Bonf row gives selection results using a Bonferroni-corrected P-value threshold of 0.05. The FDR row gives selection results using an FDR of 5%. CV indicates that the DBFs were selected via cross-validation by SparScape. differentiation, ESCs or being key regulators in maintenance of pluripotency. Zfp219 and Sp1 have been identified as members of protein interaction networks for pluripotency with Oct4 and Nanog in mouse ESCs (). Zfp281 has also been identified as a Nanog interacting protein required for proper cell differentiation (). The binding motifs for Zfp219 and Zfp281 are similar, so it is possible we are picking up sites for both TFs. Sp1 was also found to be a significant co-factor in this same dataset by. The Egr and Sox families have been shown to interact in Schwann cells (). Nr6a1 is required to suppress Oct4 and recruit co-factors to affect DNA methylation and histone modifications in the Oct4 promoter during differentiation (). In the cMyc group, we proposed six co-factors, Atf5, Erf, Rfxap, Nrf1, Sp1 and Zbtb7b/cKrox/ThPok. Atf4 (with a nearly identical motif as Atf5) has been identified in a co-expression and regulation network centered around cMyc (). Erf is key in cell differentiation mediated by cMyc repression (). Nrf1 has been shown to interact with cMyc in regulating apoptosis and implicated as a key actor in pluripotency maintenance (). Sp1 interacts with cMyc (). Zbtb7b directs the CD4 and CD8 T cell differentiation, while related TFs such as Miz-1 are known to cooperate with cMyc (). Taken together, we see that SparScape was able to select DBFs known to bind in the regions of interest and nominate a small group of likely co-factors for both the Oct4 and cMyc groups. This can provide investigators with a higher return on experimental validation and follow-up studies.
The binding landscape and concentrationIn the second stage, we predict the binding landscape and estimate concentrations for the DBFs selected in the first stage. The concentration estimates for the selected DBFs (SS in) in the mouse and simulated Oct4 group regions are shown in. For the simulated dataset, the ratio between an estimated concentration and the true value ranged from 0.71 to 1.46 for the non-nucleosome DBFs in the penalized run (  0:2), while the concentrations were generally overestimated without penalization (  0) (). Particularly, the unpenalized estimate for Nanog does not appear in the figure, as it was massively overestimated, indicating an enormous number of false positive predicted BSs. This is a general danger of jointly estimating the concentrations that can be avoided with proper penalization. This also explains, at least partially, why the estimated nucleosome concentration was lower in the unpenalized run than in the penalized run. With  0, many nucleosome BSs were crowded out by the false positive sites for Nanog and other DBFs due to the competing nature between DBF binding in our model.. The posterior binding probabilities summarized there can be used directly in further analyses, but we demonstrate the effectiveness of our method by choosing a posterior probability cutoff for predicting sites. A summary of results for SparScape and raw score predictions in the simulated datasets is given in. COMPETE results are not included in the table because the highest sensitivity achieved (50:1) was so low that the results are not comparable in this format. We only present results for the DBFs with true sites, ignoring in the FDR calculations the large number of false-positive DBFs selected by the raw score method and those selected by SparScape. For each category of DBFs, we chose the raw score cutoff that gave a similar sensitivity to that achieved by our method at the given posterior probability cutoff and compared the FDRs. SparScape reduces the FDR compared with the raw score method for every category of DBFs across both datasets, achieving a reduction of 2163% in the Oct4 group data and 1333% in the cMyc group. In the Oct4 simulation, we achieved an overall sensitivity of 0.74 with an FDR of 0.23 as compared with an FDR of 0.42 for the raw score method with similar sensitivity. In the cMyc simulation, we achieved a sensitivity of 0.7 and an FDR of 0.3, compared with an FDR of 0.4 for the raw score method. The raw score method performed relatively better on the DBFs with no ChIP data because those DBFs have, on average, stronger and more informative motifs. Moreover, SparScape uses ChIP data in a principled way, which led to more substantial improvement over the raw score method on the ChIP DBFs. Both methods predicted nucleosome sites with an FDR slightly below and above 50%, respectively, across a range of sensitivities. See Supplementaryfor more results with a wide range of posterior probability cutoffs. For the mouse datasets, true BSs are not annotated, and therefore, we compared different methods based on the numbers of, for the selected ChIP DBFs, SparScape predicted a high percentage of BSs in a corresponding ChIP window for different cutoffs on the posterior binding probabilities. For example, in the Oct4 group data, we predicted 3173103 BSs in a matching ChIP window for the eight selected ChIP DBFs, with only 956 sites outside. Since the performance of the raw score method and COMPETE in DBF selection was unsatisfactory, we report their results on the sites predicted for all 12 ChIP DBFs (). One clearly sees a much higher percentage of BSs predicted outside ChIP windows. In the most sensitive cases, SparScape predicted 7797% of sites for ChIP DBFs within a corresponding ChIP window despite not restricting site prediction to within ChIP windows, while only 2530% of sites predicted by the raw score method and 20% of sites predicted by COMPETE fell within a corresponding ChIP window. This suggests that a high percentage (470%) of the BSs predicted by COMPETE and the raw score method are false positives, demonstrating that for the questions we consider, our method is more sensitive and vastly more specific than the alternatives. Although the joint estimation of DBF concentrations and binding landscape requires computationally expensive iterative sampling, SparScape is reasonably fast. SparScape is implemented in C with OpenMP, so runs most quickly on boards with more CPUs. We tested computation time with 10 independent runs on a subset of the cMyc mouse data consisted of just 452 000 bp in 100 regions with the 11 selected DBFs () in addition to the nucleosome. A total of 1250 iterations took on average 37 min (with minimal variation) on a MacBook Pro running OS X 10.6.8 with 2.53 GHz Intel core 2 duo processors and 4 GB of RAM.
Concentrations for Mouse ESCs: Estimates and Credible Intervals
Concentration
Application to gene promotersSparScape is not designed to carry out DBF selection on entire chromosomes or the whole genome. The enrichment of BSs for any DBF other than the nucleosome is too thin and selection results may be too sparse or inconsistent. For prediction of a binding landscape over an entire chromosome or genome, we recommend running SparScape on the entire DBF library without selection and with a non-zero but small value of to prevent concentration inflation of DBFs with low-information or GCrich motifs. SparScape can, however, select DBFs effectively on data less specialized than co-bound regions such as the Oct4 and cMyc groups explored above. We demonstrate this by randomly sampling 2000 mouse genes and running SparScape on the upstream 1000 bp of these genes, using upstream 4001  5000 bp as the control regions. The candidate library consisted of all 203 DBFs in our library with unique PWMs. We ran 10-fold cross-validation to select  0, and selected 45 DBFs with  0 and 41 with  0:05 (the value used in the Oct4 and the cMyc mouse data). This represents 22% of the DBFs considered, a very reasonable number to be enriched in a random sample of 10% of gene promoters from the mouse genome. Supplementaryshows the DBFs chosen with these two values of ranked by posterior mean concentration. One indication that SparScape selected truly enriched proteins is the presence of TATA box binding protein in both lists (ranked ninth with the selected  0), since the TATA box is known to be close to the transcription start site.
DISCUSSIONGenerating a base-pairspecific binding landscape for all known DBFs over the entire genome of higher organisms with large genomes, without prior knowledge of DBF concentrations, is currently prohibitively computationally expensive. When one then considers only certain genomic regions, it is expected that a large proportion of DBFs will not have true BSs, and performance suffers if all DBFs are considered. Requiring prior knowledge of the set of DBFs active in the regions of interest and their concentrations introduces the need for (often ad hoc) userdependent prior or iterative analysis or a need for additional experimental data. We contribute a new method, SparScape, that eliminates the need for this prior information and takes advantage of binding data where available while outperforming alternate methods. One of the key features of our method is theNote: Non-Nuc is all considered DBFs except for the nucleosome. ChIP is the set of DBFs for which ChIP data were available. No ChIP is the set of DBFs for which ChIP data were not available. In the cMyc group simulation, there were 10 small datasets. Combined results are reported here but the predictions were made separately in each set. PP stands for posterior probability cutoff.inclusion of penalization in Bayesian inference based on the expected false positive site counts. This significantly reduces false positive results both in DBF selection and in BS prediction. A similar idea has been used in the contrast motif finder (). The unsatisfactory performance of COMPETE for the problems we investigate suggests that tuning prior DBF concentrations when they are not given is difficult in practice and using an improper vector of concentrations can be risky for joint prediction of landscapes. Moreover, both SparScape and the raw score method select DBFs by comparing against some control regions, but COMPETE does not have this critical component. We want to stress that our comparison against COMPETE is mostly for demonstration purpose as the method is not targeted at DBF selection or predicting sparse binding landscapes. As demonstrated by the results in this article, with the default method for choosing the level of penalization, a standard usage of SparScape usually works well. But in fact, SparScape is highly flexible. A user could independently choose less stringent DBF selection by setting a smaller penalty value and perform a single selection run, instead of 10-fold cross-validation. This option is particularly useful when the goal is to predict sites for all DBFs that could at all plausibly have BSs in the considered regions. The default choice in the final post-selection landscape prediction is to predict with the same penalty chosen in the selection stage and with fixed PWMs. A user may choose to make the predicted landscape less sparse by running the final prediction with no penalty, reestimated PWMs or both. Our modeling framework can easily be extended to include other types of information. Some measure of absolute binding affinity, as opposed to the relative binding affinity information in a normalized PWM, is available from protein binding microarrays () and could be included as energy models (). Further work integrating ChIP peak strength in the scoring of binding in ChIP windows could be fruitful, especially for nucleosomes. Other location-specific information on DBF binding to the sequence could also be used. We plan further work using SparScape's joint binding landscape to predict gene expression and offer insights into the underlying regulatory network.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.Levinson and Q.Zhou at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Sparse binding landscapes at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
