Motivation: Despite the widespread popularity of genome-wide association studies (GWAS) for genetic mapping of complex traits, most existing GWAS methodologies are still limited to the use of static phenotypes measured at a single time point. In this work, we propose a new method for association mapping that considers dynamic phenotypes measured at a sequence of time points. Our approach relies on the use of Time-Varying Group Sparse Additive Models (TV-GroupSpAM) for high-dimensional, functional regression. Results: This new model detects a sparse set of genomic loci that are associated with trait dynamics , and demonstrates increased statistical power over existing methods. We evaluate our method via experiments on synthetic data and perform a proof-of-concept analysis for detecting single nucleotide polymorphisms associated with two phenotypes used to assess asthma severity: forced vital capacity, a sensitive measure of airway obstruction and bronchodilator response, which measures lung response to bronchodilator drugs. Availability and Implementation: Source code for TV-GroupSpAM freely available for download at
IntroductionThe goal of genome-wide association studies (GWAS) is to analyze a large set of genetic markers that span the entire genome in order to identify loci that are associated with a phenotype of interest. Over the past decade, GWAS has been used to successfully identify genetic variants that are associated with numerous diseases and complex traits, ranging from breast cancer to blood pressure (). However, a significant challenge in performing GWAS is that the studies are often vastly under-powered due to the high dimensionality of the feature set relative to the small number of human samples available. Traditional GWAS methodologies test each variant independently for association with the phenotype, and use a stringent significance threshold to adjust for multiple hypothesis testing (). Although this approach works well for traits that depend on strong effects from a few loci, it is less suitable for complex, polygenic traits that are influenced by weak effects from many different genetic variants. More recently, a significant body of work has emerged on penalized regression approaches for GWAS that capture the joint effects of all markers (). The majority of these methods model the phenotype as a weighted sum of the genotype values at each locus, and use a regularization penalty such as the ' 1 norm to identify a sparse set of single nucleotide polymorphisms (SNPs) that are predictive of the trait. Although this technique helps to reduce overfitting and detect fewer spurious SNP-trait associations, the lack of statistical power to identify true associations persists. Here we aim to further boost the statistical power of GWAS by proposing a new model that leverages dynamic trait data, in which a particular trait is measured in each individual repeatedly over time, as depicted in. Such datasets are often generated by longitudinal studies that follow participants over the course of months, years, or even decades. Though broadly available, dynamic trait datasets are frequently underutilized by practitioners who ignore the temporal information. We believe that leveraging time-sequential trait measurements in GWAS can lead to greater statistical power for association mapping. To illustrate this concept, consider the hypothetical patterns of SNP influence on the phenotype shown in. As in traditional GWAS, an association between a SNP and the phenotype exists if the three SNP genotypes (which we denote AA, Aa and aa) have differential effects on the trait. In the first example, the effects of the three SNP genotypes only differ in the t 2 0:5; 1 time interval. A static method that uses data from an arbitrarily chosen time point or simply treats the time series as i.i.d. samples could easily miss this association, whereas a dynamic method that considers the entire dataset would detect it. The second example shows a SNP in which the difference between the effects of the three genotypes is small but consistent over time. Although this signal could be too weak to be interpreted as a significant association in the static case, it gets much stronger once evidence from the entire time series is considered. The longitudinal data setting is challenging because traits are measured at irregularly spaced time points over subject-specific intervals. One approach that has been proposed for performing GWAS of dynamic traits, called functional GWAS, or fGWAS (), constructs a separate model to estimate the smooth, time-varying influence of each SNP on the phenotype. Once the mean effects have been estimated for each genotype at each time point, a hypothesis test is performed to determine whether the SNP has any additive or dominant effect on the trait. Although the use of dynamic trait data gives fGWAS more statistical power than a standard hypothesis test on static data, the principal drawback of this method is that it is inappropriate for modeling complex traits that arise from interactions between genetic effects at different loci. A related approach extends the fGWAS framework to model multiple SNPs at once using a Bayesian group lasso framework (). Although this approach seems promising, it is severely limited by its very slow MCMC inference procedure. There are a number of other methods that have been developed for dynamic trait GWAS, including, and Li and Sillanp a a (2013). However, the majority of them either perform single-locus analysis (as in fGWAS) or fail to learn an explicit, interpretable representation of the dynamic effects of the genetic variants at each locus. The notable exception to this is fGWAS with Bayesian group lasso, which we directly compare to our approach in a later section. In this work, we introduce a new penalized multivariate regression approach for GWAS of dynamic quantitative traits, in which the phenotype is modeled as a sum of nonparametric, time-varying SNP effects. We call this Time-Varying Group Sparse Additive Models, or TV-GroupSpAM. Our method is based on GroupSpAM (), a non-parametric regression model with a groupstructured penalty over the input features, which we extend to capture the dynamic effects of SNPs. This model has three major advantages over existing approaches: (i) we leverage dynamic trait data; (ii) we model the contribution of each SNP to the phenotype as a smooth function of time, and explicitly learn these influence patterns; (iii) we model the combined effects of multiple SNPs on the phenotype and select a sparse subset that participate in the model, thereby identifying meaningful SNP-trait associations. We show that TV-GroupSpAM exhibits desirable empirical advantages over baseline methods on both simulated and real datasets.
ApproachIn this section, we first introduce a time-varying additive model for dynamic complex traits that captures the underlying patterns of genetic effects. We then apply a group sparse regularization scheme to this model in order to impose bias useful for discovering a sparse set of markers that influence the phenotype in a longitudinal setting. Finally, we provide an efficient algorithm for parameter estimation, and thereby association mapping, under our model. Notation. Let X ij 2 f0; 1; 2g : i  1;. .. ; n ; j  1;. .. ; p denote the genotype of individual i at SNP locus j, where n and p denote the number of individuals and SNPs, respectively. Let Y is 2 R : i  1;. .. ; n ; s  1;. .. ; m denote the phenotype value of individual i at the sth time point. Note that the exact time readings for different individuals at their sth time point may be different, i.e. the measurements are not necessarily time-aligned. We therefore introduce an explicit time variable T is 2 R  to capture the time reading for individual i at the sth time point, and define Y is YT is  as a stochastic process that captures the trait values at each time point. In what follows, we will useTwo synthetic examples of time-dependent patterns of SNP influence on the trait that would be difficult to detect with a static model uppercase letters X, Y, T to denote random variables and lowercase letters x, y, t to denote their instantiated values.
Time-varying additive modelWe consider the following time-varying additive model with scalar input variables X 1 ;. .. ; X p and functional response variable Y(T): YT  f 0 T  X p j1 f j T; X j   xTHere Y(T), which represents the trait value at time T, is decomposed into three terms: f 0 T is an intercept term that represents the non-genetic influence on the phenotype at time T; f j T; X j  represents the genetic effect of marker j with genotype X j at time T; xT is the noise term that models the random fluctuation of the underlying process. Since X j is a categorical variable, each bivariate component function f j can be represented more simply as a set of three univariate functions of time, given by f j  ff 0 j ; f 1 j ; f 2 j g. We can subsequently define f j T;g. Next we simplify our notation by expanding each X j into a set of three binary indicator variables such that X g j  1 () X j  g. This allows us to rewrite the model in the following form.Note that the indicator variable X g j selects a single function among the set ff 0 j ; f 1 j ; f 2 j g for each SNP. In the data setting, since each observation is subject to measurement error, we assume Y is  Y i T is   is where is $ N 0; r 2 . It follows from the model defined in (2) that the observed phenotypic values satisfyj t is  x g ij  xt is   isfor subjects i  1;. .. ; n and measurements s  1;. .. ; m. In the remainder of this article, we assume that the residual errors e is  xt is   is are i.i.d. across both subjects and measurements, though an alternative approach would be to impose an autocorrelation structure on xT to capture the temporal pattern of the underlying longitudinal process (; Li and Sillanp a a, 2013). In the model specified above, our only assumption about the genetic effects ff 0 j ; f 1 j ; f 2 j : j  1;. .. ; pg is that they are smooth functions of time. A well-established approach to estimate nonparametric functions in additive models () is to minimize the expected squared error loss:where the expectation is calculated with respect to the distributions over SNP genotypes X 1 ;. .. ; X p , time T, and phenotypic value Y. In the sample setting, this translates to minimizingsubject to a set of smoothness constraints. We go into detail about how to estimate the parameters of this model in Section 2.3.
Group sparse regularizationIn a typical genome-wide association study, though a large number of markers are assayed, it is believed that only a small subset of them have a real effect on the trait of interest. This assumption motivates us to impose sparsity at the level of the SNPs X 1 ;. .. ; X p in the time-varying additive model of (2), such that the effects of many of these variables are zero. To achieve this, we apply a groupsparsity-inducing penalty that leads to shrinkage on the estimated effect of each locus as a whole, including the component functions for all genotypes and their values at all time points. Specifically, we employ a group norm penalty over the component functions in which each group consists of the three functions ff 0 j ; f 1 j ; f 2 j g that correspond to a particular marker X j. To construct this group penalty, we use the ' 1;2 norm first introduced in the context of the group lasso (). The new empirical objective function for our model is given byand is again subject to a set of smoothness constraints. Here k > 0 is a tunable regularization parameter that controls the amount of sparsity in the model, and the squared ' 2 norm over f g j is defined asThe penalty term in (6) induces sparsity at the level of groups by encouraging each set of functions ff 0 j ; f 1 j ; f 2 j g to be set exactly to zero, which implies that the corresponding marker X j has no effect whatsoever on the phenotype at any time point. In what follows, we will refer to the model defined by the objective function in (6) as a Time-Varying Group Sparse Additive Model (TV-GroupSpAM). This model is based on both the Group Sparse Additive Model of, in which a group sparse regularization penalty is applied to a standard additive model, and the Time-Varying Additive Model of, in which an unpenalized additive model is used to regress a functional response on scalar covariates.
Optimization algorithmTo estimate the parameters of the TV-GroupSpAM model, we use a block coordinate descent algorithm in which we optimize the objective with respect to a particular group of functions at once while all remaining functions are kept fixed. Before presenting a complete algorithm for the regularized model, we first describe how to estimate the simpler, unpenalized model introduced in Section 2.1. Given the loss function of (4), some algebra shows that the optimal solution for f g j satisfies the following conditional expectation for each genetic marker j  1;. .. ; p and each genotype value g 2 f0; 1; 2g.It has been well established in the statistics literature that a scatterplot smoother matrix can be viewed as a natural estimate of the conditional expected value (). To evaluate (8) in the sample setting, we therefore replace the conditional expectation operator E  j T; X j  g by left multiplication with an n-by-n smoother matrix S g j  fS g j a; bg, which is defined as S g j a; b / K h jt a  t b j if x a j  g and x b j  g S g j a; b  0 otherwise where (a, b) is a pair of data points, each corresponding to a particular individual i and time point s, and K h is a smoothing kernel function with bandwidth h. An alternative way to think about S g j is as the element-wise product of a smoother matrix for T, in which entry (a, b) is proportional to K h jt a  t b j, and an indicator matrix for X j  g, in which entry (a, b) is given by Ifx a j  x b j  gg. This makes intuitive sense because we want to estimate a smooth function over time for each genotype value of each SNP. Thus, to learn each function f g j for a particular SNP j and a particular genotype g, we only want to consider data points for which the genotype at SNP j is g and we want to smooth over time. The empirical estimate of f g j will be a vector b f g j 2 R nm whose entries correspond to smoothed estimates of the effect of marker j with genotype g on the phenotype at each of the observed time points. Note that the entries of this vector corresponding to samples with genotype 6  g for SNP j will be set to zero because the function is not applicable to those samples. In practice, we drop these dummy entries at the end to obtain our final function estimates. We calculate these estimates using the empirical formula for (8),where y is the vector of concatenated trait values for each sample, and x k is the corresponding vector of genotypes at SNP k for each sample. Here a sample is a measurement for a specific individual i at a specific time point s. Cycling though SNPs and genotypes and applying the update rule of (9) leads to a variant of the well-known backfitting algorithm. We refer the readers to Hastie andfor details about smoothing and backfitting. Finally, in order to optimize the penalized objective given in (6), we adapt the block coordinate descent and thresholding algorithms fromto our setting. The complete optimization routine is shown in Algorithm 1. After smoothing the partial residual at each iteration, we perform a thresholding step by estimating the group norm b w j and using it to determine whether the group of functions b f j should be set to zero. If not, we re-estimate the function values by iteratively solving a fixed point equation. We note that Step 9 of our algorithm runs more efficiently than the corresponding step of the thresholding algorithm presented in Yin et al.(2012) because we do not need to perform a matrix inversion on each iteration. This property results from the fact that within a particular group of function estimates, each one covers a disjoint set of observations, which simplifies the update equation.
Simulation studyIn order to illustrate the utility of our method, we perform several experiments on synthetic data. We generate data according to the following procedure. First we construct a set of realistic genotypes X ij by randomly subsampling individuals and SNPs from the real asthma dataset that we analyze in the next section. Next we independently sample time points T is $ Unif0; 1 and measurement errors is $ N 0; 1. We select a subset of SNPs that will have nonzero contribution to the phenotype by placing their functions in an active set A ff 1 ;. .. ; f p g. We then construct the active functions by sampling their values from a diverse set of predefined influence patterns that exhibit a variety of trait penetrance models (including additive, multiplicative, dominant, and recessive) and interact differently with time (including some static patterns for balance). All functions not in the active set, including the intercept term, are defined such that f t  0 8 t. Finally, we generate phenotype values y is according to the model defined in (3). To test the robustness of our model, we generate data according to two slightly different variants of (3). In the first setting, we uphold our original assumption that the residual errors are completely uncorrelated by independently generating x is $ N 0; r 2 . In the second setting, we invalidate this assumption and introduce strong correlation among the errors across time by jointly generating x i1 ;. .. ; x im  $ N 0; R. In all of our experiments, we fix the number of samples at n  100 and the number of time points at m  10. Then, to evaluate our approach in a broad range of settings, we vary the total number of SNPs over p 2 f50; 100; 200; 500; 1000; 2000; 5000g, which covers both the p n and p> n cases, and vary the size of the active set over jAj 2 f5; 10; 20g. We compare our method against several baselines, including single-marker hypothesis testing (using the Wald test), group lasso (where each group consists of the 3 genotype indicators for one SNP), fGWAS, and BGL-fGWAS. We used several software packages to run these methods: the PLINK toolkit () for the Wald test, the SLEP Matlab package () for lasso and group lasso, and the fGWAS2 R package () for fGWAS and BGL-fGWAS. To run the static data methods (hypothesis test and group lasso), we summarize the phenotype values by averaging across time. To evaluate performance, we calculate the maximum power attained by each method at a fixed false discovery rate. In order to'g 5: for j  1;. .. ; p do 6: compute partial residual:calculate this metric, we first generate a ranked list of the top jAj SNPs identified by each method. For the Wald test and fGWAS, this is given by the SNPs with the smallest p-values. For the penalized regression methods, we test a series of values of the regularization parameter, k, and select the one that yields approximately the desired number of SNPs. We then rank these SNPs according to their fitted model weights or norms. Given this list, we select a cutoff point that yields the largest set of SNPs such that FDR is below 0.2, and we calculate the power at this threshold. The results of our experiments are shown in. Our results indicate that TV-GroupSpAM far outperforms all of the baseline methods in every setting. In many cases, the three dynamic methods are able to detect at least twice as many true associations as the static methods. This underscores the value of leveraging longitudinal data to boost statistical power. The results show that TV-GroupSpAM outperforms fGWAS even when the residual errors are correlated, despite the fact that our model assumes independent errors while fGWAS does not. These results demonstrate that TV-GroupSpAM performs well under many different conditions and is robust to noise.
Genome-wide association study of asthmaNext we use TV-GroupSpAM to perform a genome-wide association analysis of asthma traits. We look for associations between SNPs and two quantitative phenotypes frequently used to assess asthma severity: the forced vital capacity (FVC), a sensitive measure of airway obstruction, and bronchodilator response (BDR), which measures lung response to bronchodilator drugs. For this analysis, we use data from the CAMP longitudinal study of childhood asthma (Childhood Asthma Management Program Research) with n  552 subjects genotyped at p  510 540 SNPs from across all 22 autosomal chromosomes. After preprocessing, in which we removed subjects with missing data and SNPs with minor allele frequency below 0.05, we were left with n  465 and p  509 299.
Average Precision-Recall CurvesWaldTest GroupLasso fGWAS BGLfGWAS TvGroupSpam. Comparison of precision-recall curves of TV-GroupSpAM to baseline methods shows that our approach has an average AUCPR of 0.87 60.01, which is much higher than the most competitive baseline, BGL-fGWAS, which has an average AUCPR 0.59 6 0
.02In order to control for non-genetic effects, we incorporated several static covariates into our model, including: sex, race, the age of onset of asthma, the clinic where the patient's traits were measured, and the treatment or control group to which the patient was assigned in the clinical trial associated with the CAMP study. For computational efficiency, we first used our approach to filter out a relatively small set of SNPs to include in the final analysis for each phenotype. To do this, we split the dataset into 100 subsets, each containing $5000 SNPs, and ran TV-GroupSpAM separately on each set. We regulated the model sparsity by using a binary search procedure to identify a value of k that selected between 90 and 110 SNPs from each subset, following the example of. This yielded a filtered set of 10 118 SNPs for the FVC model and 9621 SNPs for the BDR model.shows the model weight (an indicator of significance) of every SNP that was selected in the filtering step for each phenotype. Next we fit a new global model for each trait using only these selected SNPs, and chose a value of k that yielded approximately 50 SNPs with nonzero effect on the phenotype (yielding 48 for FVC and 51 for BDR). Finally, we refit the model on just these selected SNPs with no regularization penalty, and use the estimated group functional norms to determine the effect size of each SNP. The complete sets of selected SNPs identified for each trait are listed in Supplementary Tables S1 and S2. Note that the FVC effect sizes are much higher in magnitude than the BDR effect sizes because the FVC phenotype is measured in different units than the BDR phenotype. In order to analyze the validity of our results, we identified all genes located within 500 Kb of each SNP and then determined whether any of the genetic loci or nearby genes are known to be associated with asthma or asthma-related functions in the existing literature. Because asthma is a disease characterized by inflammation and constriction of the airways of the lungs, we specifically searched for genes that have been linked to lung function or inflammatory response. Furthermore, since asthma is partly driven by a series of interactions between vascular endothelial cells and leukocytes (), we also searched for genes involved in functions of the vascular system or the immune system, particularly those in pathways involving T-helper 2 (Th2) cells, which play a central role in the pathogenesis of asthma (). We list a curated subset of the SNPs selected in the FVC and BDR models in Tables 1 and 2, along with the nearby genes that can be linked to asthma. Our model was able to identify several genetic loci that have a well-established connection to asthma. For example, SNP rs6116189 on chromosome 20 is located near the ADAM33 gene, which has been implicated in asthma by several independent studies (). In addition, SNP rs1450118 on chromosome 3 is located near IL1RAP, a gene that produces the Interleukin 1 receptor accessory protein and plays an important role in asthma (). Finally, the locus on chromosome 7 at 139.3 Mb is particularly interesting because it was selected in both the FVC and BDR models. This SNP is located near the TBXAS1 gene, which has been linked to asthma (). We plot some examples of the estimated time-varying effects of SNPs selected in our FVC and BDR models in. Finally, in order to evaluate the sensitivity of TV-GroupSpAM to noise in the data, we returned to the two filtered sets of $10 000 SNPs each and reran the final selection step on multiple 90% subsamples of the data, then analyzed the stability of the set of selected SNPs. Because the stability naturally varies with the total number of SNPs being selected, we ran our algorithm on each subsample for a fixed set of k values such that the fraction of selected SNPs ranged from 0.5% to nearly 100%. We then calculated the average stability for a particular value of k as the average pairwise overlap among the selected SNPs divided by the average number of SNPs selected across all subsamples. We plot the stability as a function of the average percentage of SNPs selected in, with the shaded region showing the standard deviation. These results indicate that the stability of the FVC model when selecting 0.47% of SNPs (48 out of 10 118) is 32% and the stability of the BDR model when selecting 0.53% of SNPs (51 out of 9621) is 39%.. Manhattan plots of the model weights for each SNP that was selected in the FVC model (left) and BDR model (right) during the filtering stageshows that our approach runs much faster than both fGWAS and BGLfGWAS. We were unable to run fGWAS for p > 1000 or BGL-fGWAS for p > 200 due to time constraints
DiscussionIn this work, we propose a new approach to GWAS that bridges the gap between existing penalized regression methods, such as the lasso and group lasso, and dynamic trait methods, such as fGWAS. Our approach uses penalized regression to identify a sparse set of SNPs that jointly influence a dynamic trait. This is a challenging task for several reasons: first, we must contend with high-dimensional data, which necessitates that we regularize the model to perform variable selection; second, we do not know the true underlying model by which each SNP acts on the phenotype, and therefore we must avoid making parametric assumptions about these patterns; third, we assume that SNP effects vary smoothly over time, which means that we cannot apply a standard multi-task regression model that treats the time series as a set of unordered traits. Although TV-GroupSpAM achieves significantly better performance on synthetic data than existing methods, there are still certain challenging aspects of genome-wide association mapping that are not addressed by this approach. One of these is the task of rare variant detection. Although our method is robust to detecting spurious effects from rare variants, we are also not able to detect true effects from rare variants with high power. This is due to the lack of data available for the aa genotype in SNPs with very low minor allelegrowth factor b1; has pro-inflammatory as well as anti-inflammatory properties, and has been linked to asthma and airway remodeling () CYP2A6, CYP2A7, RAB4B, MIA, EGLNDgenes located in a known COPD locus (A time-varying group sparse additive model for GWASfrequency; because we estimate a separate effect function for each SNP genotype, we are unable to accurately estimate f aa when there are very few data points corresponding to this genotype. Modifying TV-GroupSpAM to more accurately detect the effects of rare variants would be an interesting direction for future work.
FundingThis work was supported by the National Institutes of Health
M.Marchetti-Bowick et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
