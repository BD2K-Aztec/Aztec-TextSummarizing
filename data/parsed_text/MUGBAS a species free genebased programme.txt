Genome Wide Association Studies between molecular markers and phenotypes are now routinely run in model and non-model species. However, tools to estimate the probability of association of functional units (e.g. genes) containing multiple markers are not developed for species other than humans. Here we introduce MUGBAS (MUlti species Gene-Based Association Suite), software that estimates the P-value of a gene using information on annotation, single marker GWA results and genotype. The software is species and annotation independent, fast, highly parallelized and ready for high-density marker studies. Availability and implementation: https://bitbucket.org/capemaster/mugbas Contact:
IntroductionWith the availability of high-density SNP panels, Genome Wide Association Studies (GWAS) have become a standard for dissecting the architecture of complex traits (). This is true for humans, and other species. The underlying idea of GWAS is simple: find marker-trait associations exploiting the linkage disequilibrium (LD) that exists between causative mutations which we ignoreand flanking markers of known chromosomal position. A number of well established approaches can be used in a standard GWAS (). These generally use many thousand and sometimes millions of markers. Statistical thresholds are set considering multiple comparisons and may exclude a number of moderate or small effects actually associated with the traits investigated. Reducing the number of tests while maintaining all the information provided by high-density panels would be a clear advantage. In addition, once significant signals are detected, different strategies are used to tag the candidate causative genes. Sometimes, all genes lying in the significant SNP(s) flanking region are included in further analyses, sometimes only the gene closest to the signal is further investigated. These choices are arbitrary, may end up in choosing the wrong genes or in including a large number of false candidate genes. Methods have recently been proposed to overcome these limitations using a priori knowledge. The 'candidate pathway' analysis (), and 'gene-based' association strategies () restrict GWA studies to known genes or gene subsets, resizing the multiple testing problem and increasing the power of the analyses. Bioinformatics pipelines are generally developed for the analysis of human and model organisms, and are often not suited to the analysis of other species. This is the case of the VEGAS software (), developed for gene-based analyses in humans. In fact, this PLINK-based software expects data from 22 autosomes and pre-calculated LD values available for human HapMap phase 2 data. Here, we introduce MUGBAS, a software based on VEGAS that uses GWAS data and a given annotation (typically genes but any region is suitable) to estimate gene-based and region-based association P-values. The suite is species and annotation free, ready to analyze high-density data from any diploid species.
MethodsMUGBAS is a suite of scripts built in Bash, R and Python. The suite requires several pre-requisites (such as GNU Parallel, bedtools and a few R libraries) that can be easily fulfilled in a Linux/Unix/Mac environment with a few command lines. Further information on how to meet these requirements is detailed in the online repository. MUGBAS can be invoked launching the Bash wrapper that checks dependencies and stores user choices. Required input files are: MAP/PED files in PLINK format with genotype data from at least 200 individuals for a proper LD calculation, an annotation file in BED format (chromosome, start position, end position, name and user custom fields) of the desired genome feature (e.g. a gene or a genomic region) and the GWAS results file with mandatory headers 'SNPNAME' and 'PVALUE'. Multiple association results can be tested at the same time, if provided in separate files in the same directory. A trial dataset is downloadable along with the software release. Please note that for simplicity we provide a gene annotation, but any BED file with any desired feature can be used. The program starts the analysis assigning SNPs to the feature of the given annotation using bedtools (). This step is customizable by user defined boundaries (up-and downstream) to catch regulatory regions in LD with the current gene/ region. To speed up the analysis, the program subsamples 200 individuals from the input dataset. Two levels of parallelization are implemented: one for the LD and one for the 'gene-wise' or 'regionwise' P-value calculation. The latter is particularly useful when more than one GWA results is analysed from the same dataset. Briefly, MUGBAS first splits the LD estimation in n cores (as defined by the user) using the R packages foreach / doParallel (, b) and then distributes traits across cores using GNU Parallel () and foreach / doParallel. Since LD calculation is a slow process, VEGAS benefits of HapMap phase 2 data to speed up the process, while preserving the option for a user defined (human) population using PLINK. To expand these analyses to any species, in MUGBAS LD is estimated with the r2fast() function of the GenABEL package (), while the gene-wise P-value is calculated as in VEGAS. Briefly, the gene-wise test statistic is the sum of the n upper tail one degree of freedom chi-square values of a SNP subset (where n is the number of SNP mapping in the given gene). In the case of perfect linkage equilibrium, the gene-wise P-value would be the one-tailed P-value of a chi-square distribution with n degrees of freedom. Otherwise P-values have to be calculated by simulation and weighted by LD values (). Following gene/region P-value estimation, a False Discovery Rate (FDR) q-value statistics is calculated with the base R function p.adjust(). Results are stored and enriched with 'Manhattan' and 'underground' plots of the 'gene-wise' P-value and the q-value, respectively, integrating in the suite publicly available code (http://get tinggeneticsdone.blogspot.com.br/2011/04/annotated-manhattanplots-and-qq-plots.html).
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Results and discussion Gene-and region-based GWAS are now widely used and accepted in genomic research (Mooney et al., 2014). However, non model-species suffer for the lack of specific tools to permit these approaches and facilitate post GWAS investigation. MUGBAS provides researchers dealing with species other than human a set of robust and widely used statistics to conveniently jump from associated markers to the desired functional units. MUGBAS output is gene/region-oriented and provides useful information on: (i) the location of the analyzed feature, the 'Best SNP' genomic coordinates and original P-value; (ii) the gene or region statistics (P-value, number of simulations and q-value); (iii) the custom annotation of that particular entry; (iv) the position of the SNP with respect to the feature and (v) the chosen boundaries. All these information are useful to track the effect of highly significant markers that map into the region of interest and effectively pinpoint the most probable location to focus on with data mining approaches (i.e.pathway analysis). Benchmarks with medium-density (50K markers) and highdensity (800K markers) panels showed good scalability of MUGBAS distributed in 10 mid-performance cores (Intel Xeon X5675 @ 3.07 GHz). Computational performances for a complete analysis ranged from 8 minutes (medium-density with one trait) to 280 min (high density with three traits). RAM usage peak (16 Gb) was reached for the three traits/high density analysis, while for low density panels RAM had its maximum at 2.5 Gb. Further details are available in the repository.
