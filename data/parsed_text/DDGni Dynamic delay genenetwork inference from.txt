Motivation: Inferring gene-regulatory networks is very crucial in decoding various complex mechanisms in biological systems. Synthesis of a fully functional transcriptional factor/protein from DNA involves series of reactions, leading to a delay in gene regulation. The complexity increases with the dynamic delay induced by other small molecules involved in gene regulation, and noisy cellular environment. The dynamic delay in gene regulation is quite evident in high-temporal live cell lineage-imaging data. Although a number of gene-network-inference methods are proposed, most of them ignore the associated dynamic time delay. Results: Here, we propose DDGni (dynamic delay gene-network inference), a novel gene-network-inference algorithm based on the gapped local alignment of gene-expression profiles. The local alignment can detect short-term gene regulations, that are usually overlooked by traditional correlation and mutual Information based methods. DDGni uses 'gaps' to handle the dynamic delay and non-uniform sampling frequency in high-temporal data, like live cell imaging data. Our algorithm is evaluated on synthetic and yeast cell cycle data, and Caenorhabditis elegans live cell imaging data against other prominent methods. The area under the curve of our method is significantly higher when compared to other methods on all three datasets. Availability: The program, datasets and supplementary files are available at http://www.jjwanglab.org/DDGni/.
INTRODUCTIONBiological systems involve collaborations at various levels, from the atomic interactions to more complex ecosystems. Network formulation will enable a better understanding of such complex systems. In particular, the interplay between genes and the networks they constitute are of great interest to many biologists. Gene networks can help us to comprehend the cause, prognosis and to prioritize drug targets of various diseases (). The spatial and temporal dynamics in gene-expression patterns can reveal regulatory pathways (networks) and thereby help us to understand various underlying mechanisms (). Recent advances in live cell imaging techniques have enabled continuous documentation of cell divisions and quantitative measurement of gene expressions for each cell throughout embryogenesis (). Inferring regulatory networks from such data will help to decode various regulatory mechanisms involved in tissue differentiation and embryonic development. Reconstruction of gene-regulatory networks (GRN) accurately from high-temporal data is fundamental but still remains a challenge. Gene regulations are not spontaneous (); various processes are involved in producing fully functional and measurable concentrations of transcriptional factors/ proteins. Each process takes time, leading to the delay in gene regulation (). Furthermore, cellular mRNA and protein concentrations are substantially influenced by noisy cellular environment and other small molecules involved in gene regulation (). These fluctuations (noise) can lead to the dynamic increase or decrease in delay, during transcriptional regulation as illustrated in(). The dynamic delay in gene regulation is quite evident in high-temporal live cell lineage-imaging data (). Quite a number of gene-network-inference methods are proposed. However, their performance varies on different datasets with respective limitations. For instance, correlation based methods perform better in predicting linear relationships whereas, information theoretic (Mutual Information, MI) based methods are better for non-linear relationships. Network topology is also critical, as some methods are more suitable for ErdosRenyi random topology and others for standard small world scale free networks (). Most of the methods perform better on steady state data as compared to temporal data (), due to the fluctuations in magnitude and the delay in gene expression. Current GRN-inference methods mainly focus on transcriptional events. However, most of them ignore the associated dynamic time delay. Cross-correlation-based methods can identify *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com delayed correlations. Nonetheless, to find the maximal delayed correlation, one needs to compute correlations for all the N-1 possible delays between a regulator and its target, where N is the number of time points in the gene-expression data (); this makes it computationally expensive for hightemporal data. Moreover, it cannot be applied for identification of non-linear relationships. On the other hand, although the timedelayed MI based methods can predict non-linear relationships, yet there is a need to compute MI for all the N-1 possible delays. MI assumes long sampling intervals and statistical independence between time points (). However, this assumption is not valid for continuous live-cell-imaging data () as the expression at time t is dependent on its previous time stamp and it is imperative to consider such dependencies. Time Delay-ARACNE () is a three-step information-theoretic-based method. Starting with the geneexpression change-point analysis, it is followed by network construction and then pruning. However, being an information theoretic method, it inherits limitations such as statistical independence between time points and long sampling intervals (). GeneReg () is a regression-based method similar to Ordinary Differential Equations (ODEs). It uses a linear model with time delay and regulation coefficient as its parameters. This assumes a constant delay between the regulator and its target. In reality however, the delay is dynamic and is influenced by other small molecules involved in gene regulation and noisy cell environment (). Recently, Dynamic Time Wrapping (DTW) based similarity measures are also used to infer time delay gene networks (). DTW measures the similarity between two time series by allowing one of the series (query) to expanse or compress at each time point rather than point to point comparison such that the similarity is maximized. One of the key limitations of DTW is that, it is a global measure, i.e. DTW assumes that the two time series overlap on the edges and expanses one of the series to the length of other series to compute their similarity. However, in reality the gene expression is dynamic and the regulations are active only for a subset of time (). This phenomenon is clearly observed in developmental and disease-prognosis networks (pathways) (). Thus in time-series geneexpression analysis, it is very important to detect local expression similarities to understand the underlying molecular dynamics in biological networks (). All these limitations of current methods advocates the need of new gene-network-inference methods, that are least influenced by the dynamic expression delays and the number of time points. Here we present a new network inference method based on the gapped local alignment of gene-expression profiles. Gapped local alignment was originally used to align two nucleotide or protein sequences and to find the best matched subsequences (). Gaps induced in the alignment signify the insertions and deletions, and alignment score reflects the similarity between the two aligned sequences. Here, we employ gapped local alignment to infer dynamic delay GRN. The rationale behind the algorithm is that, if a gene X is regulating gene Y, the expression pattern of the target gene Y is stimulated by the expression pattern of its regulator X, i.e. they share similar expression pattern with varying expression delay. A regulatory relationship is often a local phenomenon due to the dynamic nature of gene regulation (e.g. different co-factor binding).and c shows the example local expression correlations (shaded). By identifying such common local patterns between a regulator and its target, we can reveal the relationships between them.(d) shows positive regulation between the genes pal-1 and elt-1 in the C lineage of Caenorhabditis elegans (). It can be observed that the delay is not constant throughout the expression, i.e. D1 6  D2 (). Insertion of gaps in the alignment will incorporate dummy time points that can account for the variability in delay. Instead of mapping the expression values one to one, we stretch the expression values of one gene over other by inserting gaps, such that the similarity between the two expression patterns (regulator and its target) is maximized. A detailed description of the algorithm is given in the Methods section.
METHODS
Gapped local alignment of expression profilesHere, we employed dynamic programming approach to align two expression patterns with varying delay and number of time points. Consider the expression patterns of two genes A and B with x and y number of time points, respectively:First, a similarity matrix S of the order x  y is computed. We compute the similarity s(i, j) as an exponential function of the distance between time points a i and b j .s i, j    e d ai, bj   1 where is the measure of steepness and d(a i ,b j ) is the distance between time points a i and b j. A value of  1.7 is used in this study (discussed in Supplementary Material). Euclidean distance is the most commonly used distance metric. However, it is heavily influenced by the magnitude of the difference between the data points. We are more interested in the trend of expression than the change in magnitude. Thus we capture the expression trend at a i and b j with respect to their neighboring data points as shown below (Supplementary Material):The underlying rationale, i.e. a regulator and its target share a similar expression trend irrespective of huge variations in the magnitude. Distance between the two expression trends, d(a i , b j ) is computed as shown below: da i , b j   ta i   tb j  : 4Next, an alignment matrix M of the order (x  1)  (y  1) is computed. An extra row and column are added to allow gaps of any length in either of the expression patterns (). Typically, an un-gaped alignment approximately requires n 2 computations, where n is the average length of the time series. If we consider gap insertions, the computational complexity increases exponentially. Thus, we adopted the dynamic programing approach to reduce the number of computations to compute the gapped alignment. The value of the (i, j)-th element in the alignment matrix M is computed from its adjacent cells in three possible ways (positions) (), a diagonal position (i  1) and (j  1) with no gaps, or from(i  1) and j with a gap inserted in series A, or from i and (j  1) with a gap inserted in series B.M i, j is the score for position i in series A and position j in series B, s 0 (i, j ) is the normalized similarity between time positions a i and b j (section 2.2), and p is the gap penalty. In the current study, a gap penalty of 0.3 is used (discussed in Supplementary Material). However, it is recommend that different gap penalties be used, based on the diversity of gene-expression patterns. At each step, the direction (path) of the highest score is recorded. Once the alignment matrix is completely filled, we compute the alignment by joining all the recorded paths starting from the maximum element in the matrix, as illustrated in. Alignment score N is computed as:where, Max(M) is the maximum element in the alignment matrix M and L is the alignment length. Multiple alignments are possible if there is more than one path from the maximum element in the alignment matrix M.
Minimizing the effect of shift and scaleIn the current context of gene-network inference, we are more interested in the expression trend of a gene than the actual change in its magnitude.shows the model-expression patterns of two genes with similar local trend, but high noise with different scale and shift makes it difficult to understand the trend similarity. Thus, the expression patterns are normalized prior to the alignment by subtracting the mean and dividing by the maximum:where, T i is the i-th element, T is the mean and T max is the maximum value of the time series T. This constrains the expression patterns between 1 and 1 with a unit variance and zero mean. The trend is more obvious after normalization as shown in. In a similarity matrix high similarity between any two time points might force the less similar neighboring points to align. To minimize this, we normalize the similarity matrix as follows:where, s(i, j) is the (i, j)-th element in the similarity matrix, si, j is the average and m(i, j) is the maximum of the i-th row and j-th column of the similarity matrix S. By doing so, influence of the high similarity between the time points i and j is restricted to i-th row and j-th column.
Aligning inhibitors to targetsThe expression patterns of inhibitor and its target are inverted on the time axis with respect to each other as shown in. To comprehend such relationships we flip the expression pattern of inhibitor by an inverse operation before aligning it to its target (shown in green,). For every gene pair, we perform both direct and inverted alignments and the mode of regulation is inferred based on the high-scoring significant alignment.
Inferring regulatortarget relationshipsWe infer a regulatory relationship between any two genes, if they share a common expression trend. As gene regulations are dynamic and vary with time, the observed correlations can be local with varying delay. From, we can observe a clear mutual trend between the gene pal-1 (regulator) and its target elt-1 (whose regulatory relationship is well established). Such common patterns can be identified by high (gapped local) alignment scores. The direction of regulation is inferred based on the onset time of gene expressions i.e., the gene with an early onset time is predicted as regulator and vice versa. Inpal-1 is expressed first, and hence is predicted as the regulator of elt-1.
Significance of the alignmentSimple alignment score is not a clear indicator of a significant alignment as the expression pattern of a gene can be randomly aligned to the expression patterns of other genes. Conventionally, a P-value is calculated from the distribution of alignment scores to access the significance of an alignment (). The distribution of gapped-local-alignment scores follows an extreme value distribution (). The probability density function for the generalized extreme value distribution with location parameter m, scale parameter and shape parameter k 6  0 is of the form:To calculate the P-value, 100 000 random background alignment scores are computed by shuffling the normalized expression levels at random points (). The parameters m, and k are estimated based on these 100 000 random alignment scores. A P-value for a given alignment score is thus computed based on the estimated parameters. The P-value is expected to be as small as possible for a significant alignment. The R package 'evir' for extreme value distribution to estimate the parameters and to compute the P-value is used.
Multiple regulatorsWe use the window or the interval of regulation to predict collective gene regulators i.e. multiple regulators regulating their target at the same time. If a gene is collectively regulated by more than one gene at a time, they share a common window of regulation (aligned expression patterns) irrespective of their magnitudes.shows model-expression patterns of genes a and c collectively regulating b, in the same window/interval (w1  w2). All the regulators that share a common regulatory window with respect to a target gene are can be inferred to be its collective regulators. Alternatively, a gene can also be regulated by multiple regulators at different time points (windows) as shown in. These relationships are relatively easier to infer as they have distinct regulatory windows (w1 6  w2). Since DDGni (Dynamic delay gene-network inference) builds a global network, at this level it is difficult to distinguish the regulators acting at different time points. However, DDGni also provides a separate complete alignment file with alignment coordinates. The order of multiple regulations can be inferred based on the order of aligned coordinates i.e. earlier the alignment earlier is its regulation. This facilitates a better understanding of the underlying network dynamics.
RESULTSThe merit of the current method DDGni is to infer the dynamic time delayed GRN. Conventionally, multifactorial DREAM data is used to evaluate the performance of various GRNinference methods. As the DREAM data is a steady-state data and does not include any time delay in the gene-expression patterns, it is thus rendered incompatible to illustrate the merits of DDGni on this dataset. Therefore, it was considered imperative to simulate data that incorporates time delay in the gene expressions in order to highlight the application of DDGni in handling dynamic time delay. Furthermore, to draw parallels with the already existing methods, TimeDelay-ARACNE (), an information theoretic method, is also evaluated on the same simulated data. The results support the potential of DDGni in inferring time delayed GRNs (section 3.1). Furthermore to demonstrate the applicability on steady-state data, DDGni is also evaluated on multifactorial DREAM 4 data (with no time delay), against three more prominent network inference methods: Maximal information coefficient (MIC) (), ARACNE () and GENIE3 (). GeneNetWeaver () is used to generate the DREAM 4 multifactorial data. The performance of all four methods is quite comparable as shown in Supplementary Table S1. To assess the practical application of DDGni, we used the cellcycle time-course data from Yeast () and real time embryonic gene-expression data from C.elegans (), as discussed in section 3.2 and 3.3 respectively. The performance of DDGni is evaluated against TDARACNE and DTW. The AUC () values show a substantially increased performance of DDGni as compared to TD-ARACNE and DTW.
Simulated gene-expression datasetWe generated synthetic gene networks with different topologies, sizes and most importantly varying time delay as follows.If the number of genes with more than one regulator is 520%, we re-generate the network (). Each gene G is initialized (100 time points) with numbers infollowing uniform random distribution. For each target gene T, the expression values are computed as a function of its regulator R:where T is the target gene, R is the regulator, i is the uniformly distributed regulatory coefficient, e i is the noise, d is the dynamic delay, d in is the initial delay and d d is the dynamic delay factor responsible for increase or decrease in the initial delay. Dynamic delay (d) is updated at every time point (i) according to the dynamic delay factor (d d ). The value of d d is based on a random number n, d d  1 if (n5x), 0 if (x n y) and 1 if (y5n). To minimize the large fluctuations in delay we used x  0.1 and y  0.9. DDGni, TD-ARACNE and DTW are evaluated on 100 synthetic networks with dynamic delay (see Supplementary Material). The current problem boils down to a simple binary classification problem, i.e. to classify a gene pair as interacting (regulatory relationship) or non-interacting (no regulatory relationship). Conventionally, area under the receiver-operating characteristic (ROC) curve is used to evaluate the performance of binary classifiers with respect to its discrimination threshold (). ROC is a function of true positive rate (tpr) and false positive rate (fpr) (). Alignment score is the discrimination factor here. The advantage of using AUC is that, we need not optimize a discrimination threshold.shows the range of AUC values of DDGni, TD-ARACNE and DTW, observed over the 100 simulated networks. The AUC values of DDGni are higher when compared to the other two (and). This suggests the ability of DDGni to handle the dynamic delay embedded in the high-temporal gene-expression profiles. Performance evaluation at different noise levels suggests the robustness of DDGni (discussed in Supplementary Material).
Cell cycle time-course data from YeastNext, we evaluated our method on a well-established network of eight transcriptional factors in Yeast. The cell cycle time-course gene-expression data is downloaded from GEO (GSE8799). The dataset consist of two replicates with 15 time points each. We merged both the replicates to get 30 time points. We selected eight TFs (YOX1, STB1, HCM1, WHI5, YHP1, ACE2, SWI5 and ASH1) that are extensively studied (). The regulatory relationships among these eight TFs are obtained from literature, YEASTRACT () and STRING ().shows the time delayed regulatory relationship between SWI5:ASH-1 () and YOX1:YHP1 (). The AUC values reported inshow a substantial increase in the performance of DDGni when compared to other methods.
Embryonic gene-expression data from Caenorhabditis elegansRecent studies have measured the gene expression in C.elegans embryo using live cell imaging techniques (). Diverse cell lineages and tissue types are the consequence of different cell fates and thus help comprehend underlying molecularshows the time delayed regulatory relationship between HND-1:HLH-1 () and PAL-1:ELT-1 () in the C lineage of C.elegans.
Interpolation of gene expression valuesThe expression values of 127 genes are measured independently (one reporter gene per embryo) by quantifying the fluorescent reporter expression driven by their promoter sequences. Ideally, a cell should have the same cell-cycle length across all experiments. However, due to specific experimental conditions the cell-cycle lengths might vary across different embryos. This may be also due to non-uniform and irregular sampling that are common while tracking embryonic development ().shows the differences in the cell division times for two genes (experiments) end-1 and pha-4 in the E lineage of C.elegans (cell division events are marked by a solid black line). It can be observed that pha-4 cell cycle lengths are shorter when compared to that of end-1. These differences should be handled before proceeding to their alignment. Interpolation technique is used to fit the pha-4 curve to end-1. B-splines are already used successfully on similar gene-expression data (). The red dotted regions inare the interpolations of pha-4 expression.
Benchmark dataTo evaluate our method on real time embryonic gene-expression data, we manually curated a benchmark dataset from the available literature for which the embryonic gene expression data is available (Supplementary). The AUC values reported insuggest an enhanced performance of DDGni as compared to TDARACNE and DTW. The AUC of ROC curve can suggest the overall performance of a program without needing to consider the specific cutoffs. However, TD-ARACNE is a binary classifier, i.e. it outputs 1 or 0 corresponding to the presence or absence of a regulatory edge, respectively. Thus, we also evaluated the performance in terms of F-score () (Supplementary). Computational (time) complexity and running time of respective methods are reported in Supplementary Table S7. The overall tradeoff between AUC and runtime of DDGni is quite acceptable.
Evaluationon a well-established network For a better illustration of the merits of DDGni, we demonstrate the performance of our method in comparison to TD-ARACNE on a well-established network in C.elegans. Expression of end1, end-3, elt-7, pha-4, ges-1 and elt-2 genes are specific to the E lineage of C.elegans and are important for the gut development.shows the networks inferred by DDGni (), TDARACNE () and DTW (); solid lines are the true relationships that are also predicted by the respective methods, dotted lines are the true relationships that are not predicted and dashed lines are the predictions that are not true (not reported in literature). From, we observe that predictions by DDGni overlap more with the true relationships when compared to TD-ARACNE and DTW.
CONCLUSIONAlthough, several methods are proposed to infer regulatory networks from temporal data, their performance is not satisfactory, especially with the dynamic delay associated to the gene regulation. High complexity and limitations of the existing methods in handling varying time delay, advocates the need of effective gene network inference methods that are least influenced by expression delays and number of time points. In this study, weproposed a simple and elegant network inference method based on gapped local alignment of gene expression profiles. By identifying common local patterns between a regulator and its target, we can reveal the regulatory relationship between them. In short, we span the expression values (time points) of the target gene over the expression values of its potential regulator by inserting gaps such that the similarity between the two expression patterns is maximized. The novelty of our method is the use of 'gaps' to handle the dynamic delay in gene regulation and uniformly sampled time points which is quite common in long time series such as cell-lineage data. The order of multiple regulations can be inferred based on the order of aligned coordinates, i.e. earlier the alignment earlier is its regulation. The proposed method is computationally less complex and exercise dynamic programming. We evaluated our performance against prominent network inference methods like TD-ARACNE, DTW, MIC, ARACNE and GENIE3. The AUC values for both real time and simulated time series gene-expression data evince an improved performance by our proposed method in handling the dynamic delay during transcriptional regulation and the evaluation on steady state DERAM4 data suggests the on-par performance of DDGni with other prominent methods. DDGni is highly suitable for real temporal data with high sampling frequency where delay dynamics is obvious. It is also applicable to short time-series data as suggested by its performance on the yeast cell-cycle data. In addition to the above, its on-par performance on static data advocates a more general applicability. However, as any other pure expression driven method it suffers from spurious relationships, i.e. identified correlations (delayed-similarity) do not represent true causal relationships. This problem can be solved by using ChIP-Seq binding data (). However, in this article only expression data is used for network construction. Funding: Research Grants Council, Hong Kong SAR, China (grant number 781511M); National Natural Science Foundation of China, China (grant number 91229105). Conflict of interest: None declared.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
H.K.Yalamanchili et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Dynamic delay gene network inference at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
