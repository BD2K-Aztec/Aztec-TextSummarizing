Motivation: Ribosome profiling is a useful technique for studying translational dynamics and quantifying protein synthesis. Applications of this technique have shown that ribosomes are not uniformly distributed along mRNA transcripts. Understanding how each transcript-specific distribution arises is important for unraveling the translation mechanism. Results: Here, we apply kernel smoothing to construct predictive features and build a sparse model to predict the shape of ribosome footprint profiles from transcript sequences alone. Our results on Saccharomyces cerevisiae data show that the marginal ribosome densities can be predicted with high accuracy. The proposed novel method has a wide range of applications, including inferring isoform-specific ribosome footprints, designing transcripts with fast translation speeds and discovering unknown modulation during translation. Availability and implementation: A software package called riboShape is freely available at https://sourceforge.net/projects/riboshape
IntroductionGene expression is a fundamental biological process consisting of two parts: transcription of mRNAs from DNAs and translation of proteins from mRNAs. Studying the genome-wide dynamics of both processes is crucial for understanding how cells function and respond to various environmental conditions, thereby giving rise to the impressive complexity of living organisms. Due to technological challenges, translation has not been studied as extensively as transcription, but recent advances in experimental protocol and sequencing technology are providing an unprecedented opportunity to examine the translation process at base-pair resolution. Ribosome profiling () applies either translation inhibitors or a flash-freeze protocol to immobilize the ribosomes 'walking' along the transcript, and the ribosome-occupied regions (each of length 2830 nucleotides) can then be extracted and sequenced, providing detailed positional information about ribosomes. Such snapshots of ribosome footprints enable quantitative monitoring and analysis of translational dynamics, making ribosome profiling an important technique for studying protein synthesis. In particular, it has been shown that protein abundance correlates better with ribosome densities than with mRNA abundance (). Various factors may influence the translation mechanism. It has been proposed that the differential usage of synonymous codons, also known as the codon usage bias, is driven by evolutionary forces to facilitate translation speed (). This hypothesis is supported by the finding that transcripts with wobble base-pairing encounter slower elongation (), and also by the analysis of tRNA-adaptation index (tAI) (). Another hypothesis associates the mRNA secondary structure with translation efficiency, in particular near initiation sites (). Studies have found that initiation is the rate-limiting factor of translation and that ribosome densities tend to be higher near initiation sites in Saccharomyces cerevisiae (). Also, positively charged residues on nascent peptides have been found to influence the footprint abundance (). We refer the reader tofor a review of the major findings from utilizing ribosome profiling. Although the debate surrounding the main determinant of translational dynamics remains open, the above-mentioned hypotheses have one thing in common; that is, the transcript sequence context plays an important role in governing the efficiency of translation. Hence, investigating how transcript-specific distributions arise and to what extent they depend on the transcript sequence is essential to
i183This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.comBioinformatics, 32, 2016, i183i191 doi: 10.1093/bioinformatics/btw253 ISMB 2016 understanding the translation mechanism. Motivated by this observation and the fact that ribosome footprint profiles are generally not uniformly distributed, we consider here the statistical problem of predicting marginal densities of ribosome footprints from the transcript sequence information alone. We first apply wavelet analysis to decouple global shapes from local patterns of ribosome marginal densities. Then, by building sparse models to predict the marginal densities projected onto the subspace corresponding to each scale and using asymmetric kernel smoothing, we identify the codon features that best associate with a given scale and estimate the extent to which they influence the ribosome densities. Results on S. cerevisiae ribosome footprints show that the sequence content is highly predictive of the marginal densities at steady state. The ability to predict the marginal densities based solely on transcript sequences has many potential applications. For example, it can be used to guide the design of transcripts with optimal translation speeds in synthetic biology; comparing the steady-state prediction with profiles under various conditions may help to uncover unknown post-transcriptional regulation factors; and the predicted marginal density can serve as a prior in probabilistically mapping reads in the inference of isoform-specific ribosome footprints. This paper is organized as follows. In Section 2, we describe our proposed method, which consists of the 'A' site (decoding site where the aminoacyl tRNA arrives) identification, wavelet decomposition, kernel smoothing and sparse regression model. In Section 3, we test the performance of our method on ribosome profiling data of S. cerevisiae. We then conclude with a discussion of our findings.
Methods
Ribosome footprint alignment and the 'A' site identificationThe first step of ribosome profiling is immobilizing the ribosomes on transcripts, which can be accomplished by the application of cycloheximide (CHX), proposed by. Then, by nuclease digestion, the fragments of the transcript protected by the ribosomes are retained. After converting these footprints into DNA molecules for deep sequencing, one can measure the abundance of footprints at each position along a transcript. We considered four publicly available datasets of ribosome profiling footprints of S. cerevisiae treated with CHX, available at the NCBI Gene Expression Omnibus under accession GSE13750, GSE52119, GSE34438 and GSE55400, and published in the recent literature (). We analyzed the ribosome footprints of wild type S. cerevisiae under normal conditions to study the steady-state behavior. The footprint reads were first processed to remove the adapters and trim the poly-A tails, according to published protocols (). The reads were then mapped to the yeast genome, available at the Saccharomyces Genome Database. Reads with alignment against sequences of RNA genes (rRNAs, tRNAs, snRNAs, snoRNAs and ncRNAs) of S. cerevisiae were filtered out, and the remaining reads were aligned against the ORF genomic sequences or the ORF coding sequences. There are three active ribosomal sites: the A (arrival), P (polypeptide) and E (exit) sites, where aminoacyl tRNA arrives for decoding, the polypeptide is created and the uncharged tRNA exits, respectively (). We considered reads of length 28, 29 and 30 nucleotides, and focused on the A sites of these ribosome footprints. For a 28-nucleotide footprint read, the A site typically starts at the 16th nucleotide downstream of the 5 0 end of the read (). If that position does not correspond to the first nucleotide of a codon, then, as illustrated in, the start position of the A site was adjusted so that it is at either the 15th or the 17th nucleotide, depending on the amount of shift. We applied the same procedure for 29-nucleotide reads. For 30-nucleotide reads, the A site was inferred to start at the 16th, the 17th, or the 18th nucleotide downstream of the 5 0 end. Marginal probability density functions of the footprints were obtained by normalizing the histograms of the inferred A site footprint counts along each transcript.shows an example of the marginal density function of CHX-treated ribosome footprints. We also considered the ribosome footprints obtained using the flash-freeze protocol without CHX pre-treatment (). These footprints are publicly available at the NCBI Gene Expression Omnibus under accession GSE53313.
Wavelet decompositionWavelet transformation has been widely used for analyzing signals. Its time-frequency localization () and multiresolution capability () have proved extremely useful for applications of denoising (), density estimation (), data compression (), and so on. More recently, it has been applied to genetic association analyses in high-throughput sequencing assays (). In ribosome footprint profiles, there may be noise in sequencing and alignment, as well as insufficient sampling due to low sequencing depth. To extract reliable signals for downstream analysis, we adopt wavelet decomposition to build a multiresolution reconstruction of ribosome marginal densities. Let p t denote the marginal density of ribosomes along a given transcript t, such that p t x represents the probability that the A-site of a randomly sampled ribosome is at position x (in units of codons). We can decompose this function aswhere u m;n x  2 m=2 u2 m x  n and w m;n x  2 m=2 w2 m x  n, with ux and wx corresponding to a scaling function and its associated wavelet, respectively (). The coefficients a t j0;k and b t j;k are uniquely determined by inner products hp t x; u j0;k xi and hp t x; w j;k xi, respectively. The spans of u m;n and w m;n form a multiresolution approximation of L 2 R aswhere V m  spanfu m;n g n2Z ; W m  spanfw m;n g n2Z and V m W m  V m1 .shows the use of wavelet analysis to build a multiresolution reconstruction, in which global shapes are decoupled from local patterns. In what follows, we use p S t to denote the projection of p t onto subspace S.summarizes the reproducibility of. Inferring the A site of a 28-nucleotide ribosome footprint read. The start position (shown in red) of the A site is inferred to be at the 15th, the 16th or the 17th nucleotide downstream of the 5 0 end of the read, depending on the amount of shift i184 T.-Y.ribosome footprint profiles by examining the Pearson correlation coefficients between replicates projected onto different subspaces V m. These results indicate that wavelet decomposition is important for denoising.
Kernel smoothing on sequence contextThe marginal density at a given position may depend not only on the codon at that position, but also on neighboring codons. Furthermore, the extent of influence may decay as the physical distance from the position increases. We apply kernel smoothing () to capture these effects. First, we represent each transcript as a collection of binary strings, a well-used method for coding categorical variables in regression (). Label the 64 codon types by C  f1;. .. ; 64g. Given a transcript t with ' t codons, we define a length-' t binary strings c t j for each j 2 C, where the character at position x is defined as c t j x  1; if the xth codon of transcript tis codon type j 2 C; 0; otherwise:(Note that, for each position x 2 f1;. .. ; ' t g, there is exactly one codon type j 2 C such that c t j x  1; all other strings will have a 0 at position x. Next, we apply kernel smoothing to each string aswhere Kx; x 0  is a suitably chosen kernel. Intuitively, if the ribosome marginal density is affected by sequence context, then a region with a cluster of slow translating codons is likely to become congested with ribosomes. By smoothing c t j with a kernel, we incorporate the distribution of neighboring codons into our model.illustrates the method we propose, in which the black spikes represent the decomposed codon sequences and the red curves are the kernel smoothed estimates with a symmetric Gaussian kernel, kx; x i   f N x; x i ; r, where f N x; l; r where a and b are the shape and scale parameters, respectively, and Cr   1 0 t r1 e t dt is the gamma function. It can be shown that the peak of this density function is located at h  a  1b, and the standard deviation is r  b ffiffi ffi a p. We define a modified gamma distribution f SRG , parameterized by h and r, by applying a horizontal shift(codons)In what follows, we set the h parameter of f SG and f SRG to 5, because a ribosome occupies 910 codons and there are about 5 codons downstream. Applications of these asymmetric kernels f SRG and f SG are depicted as blue and green curves inrespectively.
Sparse regression modelWe relate the ribosome marginal density to the transcript sequence context by building a sparse model. In (2), we applyWe relate these sequence features to the ribosome marginal density projected onto subspace S, by formulating a sparse regression problem:where b  b 1 ;. .. ; b 64BQ  denote regression coefficients. The firsth i 2 of the objective function represents the residual sum of squares, whereas the second part kkbk 1 promotes a sparse solution. The sparsity of the solution depends on the value of the regularization parameter k. This type of linear estimation, known as LASSO (), avoids overfitting the data especially in scenarios where the number of predictors is much larger than the number of observations. It also provides an interpretation of the importance of each predictor, i.e., the variables that correspond to zeros in the solution b b are not significant to the model. Our goal is to find a significant bandwidth r b. By training the sparse regression model with kernel smoothed codon feature strings ~ c t j;r b ;fq with various bandwidths, and selecting the regularization parameter k with cross validation to minimize mean squared error (MSE), the nonzero terms in the regression coefficientsprovide insight into the extent to which sequence context affects the ribosome marginal density.
ResultsAfter the filtering step described in Section 2.1, we grouped genes according to their length into 5 bins: 250 codons, 251500 codons, 501750 codons, 7511000 codons and !1000 codons. We then decomposed each ribosome footprint profile using wavelet analysis with Daubechies-8 basis and eight scales, as illustrated in.For comparison, we also considered a model with the symmetric kernel f N with the same set of bandwidths, as well as a model with no kernel smoothing. We trained the regression model using 9n/10 randomly chosen genes, where n is the number of genes in the corresponding bin, and chose the regularization parameter in (3) via five-fold cross-validation using the training data. Then the model was tested on the genes that were left out, and the process was repeated until every gene has been tested. Results of CHX-treated footprints in various spaces are summarized in. The average performance is presented in terms of the Pearson correlation coefficient between the predicted and the true ribosome marginal densities. Notice that our method using asymmetric kernels achieved high accuracy in subspaces V 0 through V 4. This suggests that the global shape of transcript-specific ribosome footprint profile is well captured by our proposed kernelsmoothed codon sequences. The performance in the subspace V k decreases as k increases. This is partly due to noise in the read alignment or the sequencing noise inherent in ribosome profiling. Thus, wavelet analysis is useful for studying the limit of the ribosome profiling technique and focusing on the reliable signals. The results from using non-smoothed codon sequences were the least accurate, supporting that the neighboring codons or interference play an important role in ribosome footprint distributions. Using asymmetric kernel smoothing produced more accurate results than using a symmetric kernel. The same trend also holds for flash-freeze ribosome profiles (). The performance of our method on CHX-treated ribosome profiles was better than that on the flash-freeze profiles. This may be due to the large amplitude of ramps near the 5 0 end in CHX-treated profiles (). These ramps contribute significantly to global shapes, and can be well captured by asymmetric kernel smoothing. In general, our method with asymmetric kernels was able to predict the global shape of transcript-specific ribosome density with high accuracy. However, for the flash-freeze data, the correlation in the subspace V 0 was relatively poor for the genes shorter than 250 codons. This is because the global shape of their profiles in this subspace was rather flat for the flash-freeze data. If the mean squared error is used as the performance measure, the results for shorter genes are not so much worse than that for longer genes. As an example,shows the ribosome density of YBR212W in various subspaces and the corresponding predictions for both CHX-treated and flash-freeze profiles.shows heatmaps of the regression coefficients for transcripts of length 250 codons in the space V 3. This result shows that CGA (arginine), CCG (proline) and CGG (arginine) have a strong influence on the global shape of ribosome occupancy in flash-freeze data, while CGA and CGG seem to have the dominant effect in CHX-treated data. This may be related to wobble base pairing, which has been found to be associated with slow elongation (). In particular, high ribosome occupancy has been observed on wobble-paired proline CCG (G-U base pairing) and arginine CGA (I-A pairing) by. Furthermore, CGA is one of the codons with the most prolonged elongation rates, consistent with Lareau et al. To examine further how the distribution of codons may affect the shape of ribosome footprint profiles, we carried out a slidingwindow analysis for each transcript, using a window size of 20 codons. For each transcript, we first identified all windows for which the average ribosome density was larger than twice the transcript-wide average ribosome density, and then considered those windows for codon enrichment analysis. For each selected window, let x  x 1 ; x 2 ;. .. ; x 64  denote the observed codon distribution, where x i is the number of codons of type i within the window. We compared this observed codon distribution with the expected. Accuracy of the prediction of marginal densities for CHX-treated and flash-freeze ribosome footprint data. NS, SK and ASK respectively denote using no kernel smoothing, using symmetric kernel (f N ), and using asymmetric kernels (f SG ; f SRG ). The Pearson correlation coefficient between the prediction and the measured ribosome density was averaged over genes. The results are listed for different spaces S and various gene lengths. The prediction achieves high accuracy in the global shape spaces, e.g. V 0 and V 1. As the scale increases, i.e., as the index m of V m increases, prediction becomes more difficult. Length Method CHX: Subspace S Flash-freeze: Subspace S(codons)Prediction of ribosome footprint profile shapes from transcript sequences i187 distribution g  g 1 ; g 2 ;. .. ; g 64 , where g i denotes the expected number of codons of type i within the window, assuming sampling 20 codons without replacement according to the codon distribution in the entire transcript. Note that g follows a multivariate hypergeometric distribution. We performed a paired t-test on x and g over the selected windows and identified the codons enriched in high ribosomeoccupancy regions. We then compared the P-values from the enrichment analysis with the frequencies of the regression coefficients being nonzero, as illustrated in. The scatter plot for flash-freeze data () shows that all of the significantly enriched codons were selected frequently by the regression model. Codons that were selected frequently but not significantly enriched in high density regions might have been selected for prediction in low ribosomal density regions. For example, it has been observed previously () that GGG and GTT are some of the codons with the least footprint abundance. For the CHX-treated data, there were a few codons enriched significantly but not selected frequently (); this could be due to technical biases in the data, discussed in Section 4.
DiscussionOur results on S. cerevisiae data, especially the CHX-treated footprints, show that the global shape of transcript-specific ribosomeIn particular, they show that codons CGA, CCG and CGG strongly influence the global shape of ribosome occupancy in flash-freeze data, while CGA and CGG seem to have the dominant effect in CHX-treated data i188 T.-Y.Liu et al. density can be predicted with high accuracy. This suggests that the ribosome distribution along a transcript indeed depends on the sequence context. In particular, we find a few codons that dominate the global shape; these codons influence the ribosome density not only at the site where they appear, but also their neighboring positions. There are several possible reasons why applying kernel smoothing to codon sequences helps in predicting the shape of transcriptspecific ribosome occupancy profile. One possible reason is the interference among ribosomes. Another possible explanation is that the physical footprint of each ribosome spans multiple codons (910 codons). Lastly, it has been shown () that positively charged amino acids on nascent peptides significantly slow down ribosomes downstream from where the residues are encoded. Among all the methods compared, the asymmetric kernel smoothing performed the best. This could be due to the directional movement of ribosomes and the aforementioned effect of positively charged amino acids on downstream elongation speeds. Also, 5 0 ramps can be better predicted using asymmetric kernels, which partly explains why the prediction accuracy for CHX-treated ribosome profiles was slightly better than that for flash-freeze profiles. There are other factors not incorporated into our current model that could also help to explain ribosome distributions, e.g. mRNA secondary structure. Notice that in the results for CHX-treated ribosome footprints, we achieved better performance in shorter genes. When applying a sliding window to genes with a prediction correlation coefficient below 0.3 and of length 10011500 codons, we observed that the correlation was lower near the 5 0 end. Furthermore, when computing differences between the observed ribosome densities and the predicted densities from these poorly predicted genes, we noticed a weak positive correlation (r  0.0446) between the differences and the likelihood of double stranded conformations, i.e., the PARS (parallel analysis of RNA structure) scores of secondary structure defined byin a genome-wide measurement. Although many potential factors including mRNA secondary structure, codon usage bias, tRNAadaption index, etc.are not explicitly incorporated into our model, most of these factors depend on the sequence context. This may be one of the reasons why considering transcript sequences alone enables reasonably accurate prediction of ribosome footprint profile shapes. It is possible that some of the features learned by our predictive model are due to technical biases in the data. Library construction is a possible source of bias due to technical artifacts. Artieri and Fraser (2014) found three types of nucleotide biases by comparing mRNA fragments (unprotected by ribosomes) with ribosome footprints to identify shared biases. These include an enrichment of adenine at the 5 0 and 3 0 ends, and a depletion of cytosine at the fourth nucleotide position in both the mRNA and ribosome footprint reads. However, we note that the flash-freeze ribosome footprint data () we analyzed were generated using a comprehensive set of adapter sequences to avoid the biases discussed in Artieri and Fraser (2014). Furthermore, the flash-freeze protocol avoids the ribosome run-off phenomenon that can occur in CHX pre-treatment. Different models have been proposed in the literature to estimate elongation rates.developed a continuous-time, discrete-state Markov model to simulate translational dynamics, in which initiation and elongation rates were inferred using the cell volume, ribosome abundance and tRNA abundance. These elongation rates were codon dependent but not position dependent. The model proposed bywas based on flow conservation, and it assumed that the occurrences of the same codon within an mRNA transcript have the same dwell time, and hence the same elongation rate. Our results suggest that these models should take the codon position into account. In other words, the elongation rate at a particular position along a transcript not only depends on the codon at that position but also the neighboring codons and how the neighboring codons are ordered.Part of the results presented in this paper is based on combining four publicly available datasets. This overcomes the difficulty of sparse sampling that other work may encounter, e.g.. Although our study is limited to the steady-state distribution of ribosomes, it examines the extent to which the sequence context influences ribosome distributions under normal conditions. One of the important applications of our method is to examine the positions where the steady-state prediction is significantly different from the actual measurements. These positions may lead to important findings of unknown factors that regulate translation. For example, our proposed method can be applied to cells grown under various environmental conditions, or to ribosome profiles obtained by different inhibitors, e.g. harringtonine (), anisomycin (). Another application is the inference of isoform-specific ribosome footprints. It is known that many human genes have more than one isoform, and these isoforms contribute to the complexity of phenotypes (). Studying the translation of specific isoforms requires correctly assigning ribosome footprints to them. However, since the footprints of ribosomes are short (2830 nucleotides), identifying the correct isoform becomes challenging. Our method provides a likelihood function for ribosome location, and can facilitate sequence alignment when more than one alignment exists. Synthetic biology is another active research area () that can benefit from our work: the ability to predict and compare the ribosome densities along different transcripts under various environmental conditions can facilitate the search for sequences with optimal translational properties and reduce the number of experimental trials necessary to build and test the sequences.
A B
FundingThis research is supported in part by an NSF CAREER Grant DBI-0846015, a Packard Fellowship for Science and Engineering and a Math+X Research Grant from the Simons Foundation.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
r ffiffiffiffi 2p p exp xl 2 2r 2 : Since the flow of ribosomes is directional, a cluster of slow translating codons should have a larger impact on upstream ribosomes than on downstream ribosomes. To take this directionality into account, we therefore employ an asymmetric kernel. An example of asymmetric kernels is the probability density function of the gamma distribution,
