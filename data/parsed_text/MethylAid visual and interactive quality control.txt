The Illumina 450k array is a frequently used platform for large-scale genome-wide DNA methylation studies, i.e. epigenome-wide association studies. Currently, quality control of 450k data can be performed with Illumina's GenomeStudio and is part of a limited number 450k analysis pipelines. However, GenomeStudio cannot handle large-scale studies, and existing pipelines provide limited options for quality control and neither support interactive exploration by the user. To aid the detection of bad-quality samples in large-scale genome-wide DNA methylation studies as flexible and transparent as possible, we have developed MethylAid; a visual and interactive Web application using RStudio's shiny package. Bad-quality samples are detected using sample-dependent and sample-independent quality control probes present on the array and user-adjustable thresholds. In-depth exploration of bad-quality samples can be performed using several interactive diagnostic plots. Furthermore, plots can be annotated with user-provided metadata, for example, to identify outlying batches. Our new tool makes quality assessment of 450k array data interactive, flexible and efficient and is, therefore, expected to be useful for both data analysts and core facilities. Availability and implementation: MethylAid is implemented as an R/Bioconductor package (www.bioconductor.org/packages/3.0/bioc /html/MethylAid.html). A demo application is available from shiny. bioexp.nl/MethylAid. Contact: m.van_iterson@lumc.nl
INTRODUCTIONBecause the introduction of the Illumina 450k Human Methylation BeadChip (), it has become the standard for large-scale genome-wide DNA methylation studies, i.e. epigenome-wide association studies (EWAS;). The array measures 482,421 CpG dinucleotides, covering 99% of genes (RefSeq;) and a broad range of genomic annotations. The principle of the array is that the methylation level of individual CpG dinucleotides is inferred using quantitative 'genotyping' of bisulfite-converted genomic DNA, a chemical reaction that converts unmethylated Cs into Ts, whereas methylated Cs are protected. To monitor the quality of Illumina 450k data, the array contains 10 different types of quality control probes to evaluate the performance of both samples and specific steps in the process. The most frequently used type of quality control probe is the negative control that represents the background signal level. These are used to determine whether a signal significantly exceeds the background signal (represented as a so-called detection P 0.01 or 0.05). However, current tools do not allow researchers to use the valuable information provided by the other control probes. The Illumina software GenomeStudio visualizes all quality control probes but is limited to small studies (typically 5100), while tools developed to handle large studies primarily focus on data processing and analysis and mostly limited their use of the control probe information to the calculation of the detection P-values. Moreover, neither have the possibility for interactive exploration by the user. MethylAid was developed to address these limitations.
INTERACTIVE WEB APPLICATIONThe R package MethylAid identifies poorly performing samples that are to be removed before processing (i.e. background, dyebias and probe correction) and further analysis of the data. MethylAid takes raw intensity data (idat files) as input, summarizes the data and launches a shiny-based () interactive Web application. The Web application produces multiple interactive diagnostic plots on the basis of the quality control probes present on the 450k array that facilitate the detection of bad-quality samples irrespective of sample size. Five interactive diagnostic plots are available in separate tabpanels to determine bad-quality samples using user-adjustable thresholds (although defaults are provided): a sample median Methylated versus Unmethylated signal intensity plot, a plot showing the efficiency of the bisulfite conversion, plots showing the overall quality of the arrays using sample-dependent and sample-independent control probes (non-polymorphic quality control probes and hybridization quality control probes) and a plot based on the negative quality control probes representing per sample fraction of probes above background. To facilitate the detection of bad-quality samples plots are rotated 45 like a MA-plot used to visualize expression array data (). In addition to the five interactive diagnostic plots, in-depth analysis of all quality control probe (sub)types on the 450k array is supported. In addition, metadata can be used to pinpoint outlying batches and single samples can be selected, which are *To whom correspondence should be addressed.subsequently highlighted across all other plots. For all plots, multiple views are available, including a sampleplot (as provided in GenomeStudio), a scatterplot or a boxplot. Each plot can be downloaded separately.

EXAMPLEThis example shows how to summarize a small set of idat files. The minfiData package provides such a set. The package contains 450k DNA methylation data on six samples across two groups. Because MethylAid uses internally the minfi () function read.450k.exp, target information should be provided in a similar way. library(minfiData) baseDir 5-system.file("extdata", package = "minfiData") targets 5-read.450k.sheet(baseDir) library(MethylAid) sdata 5-summarize(targets) visualize(sdata) ##this will launch the web applicationThe function summarize performs the summarization of the control probes present on the array. The output produced by summarize should be passed on to the function visualize, which in turn will launch the interactive Web application. MethylAid was specifically designed for quality control of large set of DNA methylation data. Summarization can be performed in batches to overcome memory problems by providing the batchSize option to the summarize function. To prevent excessively long run-times, summarization can be performed in parallel using various computing resources facilitated by the BiocParallel () package. For example, performing summarization on an 8-core machine can be requested by specifying MulticoreParam(workers = 8). The BiocParallel also allows parallelization on a cluster of computers using different job schedulers. For example, using the appropriate configuration file a BatchJobsParam-object can be constructed and passed to the summarize function. library(BiocParallel) BPPARAM 5-BatchJobsParam(workers = 10, conffile = "SGE_config_file.R") sdata 5-summarize(targets, batchSize = 50,The script folder of the package contains example files for parallel summarization on a cluster computer using the Sun Grid Engine job scheduler. For more information on how to set up a configuration file for other job schedulers, see R package BatchJobs ().
CONCLUSIONMethylAid provides complete insight in the quality of each sample in a large-scale EWAS and gives the user full control on the selection of bad-quality samples that should be excluded from downstream analyses. Quality assessment of 450k array data is made interactive, flexible and efficient. Therefore, MethylAid is expected to be useful for both data analysts and core facilities.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.van Iterson et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
MethylAid at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
