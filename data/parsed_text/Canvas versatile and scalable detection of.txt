Motivation: Versatile and efficient variant calling tools are needed to analyze large scale sequenc-ing datasets. In particular, identification of copy number changes remains a challenging task due to their complexity, susceptibility to sequencing biases, variation in coverage data and dependence on genome-wide sample properties, such as tumor polyploidy or polyclonality in cancer samples. Results: We have developed a new tool, Canvas, for identification of copy number changes from diverse sequencing experiments including whole-genome matched tumor-normal and single-sample normal re-sequencing, as well as whole-exome matched and unmatched tumor-normal studies. In addition to variant calling, Canvas infers genome-wide parameters such as cancer ploidy, purity and heterogeneity. It provides fast and easy-to-run workflows that can scale to thousands of samples and can be easily incorporated into variant calling pipelines. Availability and Implementation: Canvas is distributed under an open source license and can be downloaded from https://github.com/Illumina/canvas.
IntroductionThe increased throughput of sequencing studies has created high demand for versatile and scalable tools to detect somatic and germline copy number changes. Increasingly complex experimental designs require accurate characterization not only of individual copy number variants (CNVs), but also of global genome and sample properties, such as ploidy, normal contamination and polyclonality (frequently present in cancer samples,). The interaction of these factors creates an array of different somatic genome architectures that confounds optimization of CNV calling algorithms given an often limited availability of training data. While a number of methods for CNV identification have been introduced, most of them harbor shortcomings when it comes to scalability and throughput. First, many tools rely on external segmentation software that complicates workflow management and version control. Second, model parameters to infer global genome and sample properties are often hard-coded and difficult to optimize for individual projects. Finally, many tools require the user to provide pre-specified sample-specific parameter values that might not be known prior to CNV detection. For example, TITAN () and FREEC (), while inferring heterogeneity and normal contamination respectively, require genome-wide ploidy values as an input, which incorporates a manual step in the variant calling workflow and complicates automation. We have developed a new tool for CNV calling, Canvas, to address the aforementioned limitations of existing solutions. It fully implements all steps of the variant calling workflow and requires only aligned sequence data and related reference genome files as input. Canvas offers inference of global tumor genome and sample characteristics, including ploidy, contamination and heterogeneity,
Method
OutlineThe Canvas workflow comprises five distinct modules designed to (i) process aligned read data and calculate coverage bins, (ii) perform outlier removal and normalization of coverage estimates, (iii) identify segments of uniform copy number, (iv) calculate minor allele frequencies (MAF) and (v) assign copy number/allelic states and infer genome-wide parameters. Separate workflows exist for somatic, germline and exome sequencing data. The latter workflow can be run either with or without a matched normal control sample and requires a manifest file with locations of targeted regions. The somatic workflow includes logic to cope with normalization of FFPE samples. Detailed step-by-step explanations can be found in Supplementary Methods.
Implementation and performanceCanvas is implemented in C# programming language and can be run on Linux system using mono or on Windows under the .NET framework. A full per-chromosome parallelization is available for all time-consuming modules. An average Canvas runtime for the tumor/normal workflow on 80/40 coverage matched sample pair using a Linux node with 32 CPUs is 40 min (70 min when fragmentbased GC-content normalization is invoked); with a peak RAM consumption of under 6 GB.
ResultsBoth simulated and real data was used to assess Canvas performance in each workflow category and to enable comparison with alternative CNV calling tools. The selection of third-party methods was based on the principle that they either showed superior performance in the previous benchmarks (as in the case of FREEC,) or that they offered inference of a number of different genome-wide parameters, like THetA (). We did not aim to perform a comprehensive evaluation of CNV callers, as this was covered elsewhere (). What follows is an overview of the test data generation strategies and performance results. Supplementary Results provide full details of simulation and evaluation strategies.
Simulation dataA haplotype mixing workflow was used to generate simulation data for both germline and somatic workflows. Briefly, aligned reads were split into haplotypes inferred from phasing of the Platinum Genomes (PG) family (http://www.platinumgenomes.org). These reads along with manually curated CNV calls from previously sequenced genomes at Illumina were used to create truth sets. The simulation also included parameters to generate tumors of different purity and polyclonality levels.
Cell linesFor evaluating somatic CNV calling, breast carcinoma cell lines HCC2218 and HCC1187 were sequenced to 80 coverage on HiSeq2000 along with matching normal lymphoblastoid cell lines (sequenced to an average of 40). Exome samples of the same cell lines were prepared using Nextera Rapid Capture Exome reagent kit, and sequenced on a HiSeq 2500. Read titration with normal lymphoblastoid samples was used to approximate different purity levels. A truth set for these cell lines was created by comparison with karyotype data () and by manual inspection of coverage, allele ratios and read mappings. To benchmark the germline workflow, a reference CNV call set for NA12878 individual from the PG family was created by selecting the pedigree-consistent set of deletion calls made using a range of structural variant calling tools (Supplementary Results, Section S1.2).
Evaluation strategy and resultsWe have focused on exploring concordance between expected and observed copy numbers to calculate accuracy, precision and recall. Tables 1 and 2 show average performance metrics for somatic and germline workflows respectively, while Supplementaryshows similar performance figures for the exome workflow. When considering all of the metrics, Canvas attained the highest levels of accuracy among tools used in the comparison for both germline and somatic workflows and across real and simulated datasets. Similar observations were made for the exome workflow, where Canvas outperformed EXCAVATOR () and ADTEx () when considering original HCC cell lines and the purity titration series (Supplementary Results, Tables S6 and S7). Canvas also showed the fastest runtime for whole genome somatic and germline workflows, completing on average 2. 3 times faster than a runner-up tool (Supplementary Results,). To conclude, Canvas is a versatile tool for CNV identification with superior performance across a range of whole-genome and exome sequencing experiments and fast runtime.data for HCC2218 and HCC1187 is being shared in accordance with the terms of a licensing agreement with UT Southwestern, the owners of the cell lines.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
