Motivation: Gene expression profiling has shown great potential in outcome prediction for different types of cancers. Nevertheless, small sample size remains a bottleneck in obtaining robust and accurate classifiers. Traditional supervised learning techniques can only work with labeled data. Consequently, a large number of microarray data that do not have sufficient follow-up information are disregarded. To fully leverage all of the precious data in public databases, we turned to a semi-supervised learning technique, low density separation (LDS). Results: Using a clinically important question of predicting recurrence risk in colorectal cancer patients, we demonstrated that (i) semi-supervised classification improved prediction accuracy as compared with the state of the art supervised method SVM, (ii) performance gain increased with the number of unlabeled samples, (iii) unlabeled data from different institutes could be employed after appropriate processing and (iv) the LDS method is robust with regard to the number of input features. To test the general applicability of this semi-supervised method, we further applied LDS on human breast cancer datasets and also observed superior performance. Our results demonstrated great potential of semi-supervised learning in gene expression-based outcome prediction for cancer patients.
INTRODUCTIONA major challenge in clinical cancer research is the prediction of prognosis at the time of tumor discovery. Accurate outcome prediction can help guide the selection of appropriate therapy for each individual patient. For example, if patients can be accurately assigned to a 'low-risk' or a 'high-risk' subgroup based on whether the disease would relapse within a certain amount of time after tumor resection, adjuvant chemotherapy (CTX) can be administered to high-risk patients, while low-risk patients might forgo this toxic treatment. Microarray-based gene expression profiling has showed great potential in outcome prediction for different types of cancers (To whom correspondence should be addressed.2002;). Nevertheless, small sample size remains a bottleneck in obtaining robust and accurate prediction models (). The number of samples in microarray-based cancer studies is usually small because microarray experiments are time consuming, expensive and limited by sample availability. For outcome prediction, sample size is further reduced significantly by the availability of follow-up data for the analyzed samples. In fact, in publicly available gene expression databases such as the Gene Expression Omnibus (GEO), only a small fraction of human-tumor gene expression datasets provide clinical follow-up data. Gene-expression data-based outcome prediction usually relies on traditional supervised learning techniques, in which only labeled data (i.e. data from samples with clinical follow-up) can be used for learning, while unlabeled data (i.e. data from samples without clinical follow-up) are disregarded. Recent studies in machine learning suggest that unlabeled data, when used in conjunction with limited amount of labeled data, can produce considerable improvement in learning accuracy, a technique called semi-supervised learning (). Indeed, semisupervised learning has proved to be effective in solving different biological problems including protein classification (), peptide identification in shotgun proteomics (), prediction of transcription factorgene interaction () and gene expression-based cancer subtype discovery (). Because semi-supervised learning is able to use a large number of unlabeled microarray data in conjunction with some labeled data, we hypothesize that this technique can be used to improve gene expression-based classification of human cancer. Different algorithms for semi-supervised classification have been proposed (), and many successful algorithms directly or indirectly rely on the assumption that the decision boundary should not cross high density regions but lie in low density regions (usually called 'cluster assumption'). This can be illustrated by comparing the well-known support vector machines (SVM) to its semi-supervised extension, Transductive SVM (TSVM) (). The goal of a standard SVM is to maximize the margin around the decision boundary of the labeled data to enable robust classification. In a TSVM, in addition to the original goal of SVM, unlabeled data are used to guide the boundary away from dense regions by finding a hyperplane that is far away from the unlabeled data points. Finding the exact TSVM solution is NP-hard. Therefore, several approximation algorithms have beenproposed (). In this article, we aimed to develop and evaluate semi-supervised classifiers for human cancers based on one of the most successful semi-supervised classification method, low density separation (LDS) (). We started with the prediction of relapse-free survival for Stage I through III colorectal cancer (CRC) patients based on gene expression profiles of primary tumors. Colorectal carcinoma is the third most commonly occurring noncutaneous carcinoma and the second leading cause of cancerrelated deaths in the USA. Although clinical trials have showed clear benefit of adjuvant CTX for Stage III patients, 4044% of Stage III patients enrolled in 'surgery-only' groups did not recur in 5 years even without adjuvant treatment. On the other hand, while clinical trials have failed to show the benefit of adjuvant CTX when applied to unselected Stage II patients, some studies suggest that a subset of high-risk Stage II patients may benefit from adjuvant therapy. Moreover, although the standard treatment for Stage I patients requires no adjuvant treatment after surgery, about 10% of Stage I cancer will recur (). Therefore, an accurate and reliable method that identifies high-risk Stages I and II patients and low-risk Stage III patients could improve the selection of individualized therapy. Using five CRC gene expression datasets from the GEO database, we demonstrated that, (i) Semi-supervised classification improved prediction accuracy as compared with the state of the art supervised method SVM, (ii) performance gain increased with the number of unlabeled samples, (iii) unlabeled data from different institutes could be employed after appropriate processing and (iv) the LDS method is robust with regard to the number of input features. To test the general applicability of the semi-supervised method, we further applied it on human breast cancer datasets and demonstrated superior accuracy as compared with SVM.
METHODS
Gene expression datasetsFive CRC gene expression datasets were downloaded from the GEO database (). Stage IV samples were excluded from this study. Overlapping samples in GSE17536 and GSE14333 were removed from GSE14333. Remaining samples were assigned to the 'recurrence' group if recurrence was observed within 5 years of follow-up and the 'nonrecurrence' group if recurrence was not observed within 5 years of follow-up. Samples with insufficient or no clinical follow-up data were assigned to the 'unlabeled' group. Distribution of samples in these three groups is listed infor each dataset. In this study, part or all of labeled samples from GSE17536 in combination with varied numbers of unlabeled samples were used for training, whereas the labeled samples from GSE14333 were used for independent validation. Two breast cancer gene expression datasets were downloaded from GEO and the samples were classified into the 'recurrence' and 'non-recurrence' groups as described above (). Semi-supervised classifiers were built based on GSE2034 through randomly removing labels from different proportions of samples and then tested on the independent GSE2990 dataset. All CRC datasets were generated on the Affymetrix U133 plus 2.0 array, whereas the three breast cancer datasets were generated on the Affymetrix U133A array. Cel files for the datasets were processed using MAS5 followed by quantile normalization. Training and validation datasets were processed separately to ensure the independency of the validation datasets. For training datasets, probe sets were first ranked based on average gene expression value and the bottom 30% with the lowest values were eliminated to rule out genes that were likely to be unexpressed. Remaining probe sets were ranked based on coefficient of variance and the bottom 30% were eliminated to remove genes with very low variation. To make expression level comparable across genes, expression values for each gene were standardized using a z-score transformation.
Low density separation approachThe LDS algorithm is based on the cluster assumption. It implements two effective procedures to place the decision boundary in low density regions between clusters. First, it derives graph-based distances that emphasize low density regions. Second, it uses a gradient descent approach to optimize the TSVM objective function in order to find a decision boundary that avoids high density regions. By combining these two procedures, LDS achieves clearly superior accuracy compared to the supervised method SVM and other state of the art semi-supervised methods on several test datasets (). More details of the LDS algorithm can be found in the original article ().
Evaluation of LDS and SVM predictionsA Matlab implementation available from http://olivier.chapelle.cc/lds was used for LDS and an R implementation of a Library for Support Vector Machine (LIBSVM) available in the e1071 package was used for SVM. SVM has two parameters C and , where C is the soft margin parameter and  is the parameter for the radial basis kernel function. LDS has several parameters, but we only considered two most critical ones C and , where C is the soft margin parameter and  is a softening parameter for graph distance computation. Default values were used for other parameters. For the parameters to be tuned, we let each of them vary among the candidate set {10 3 ,10 2 ,10 1 ,10 0 ,10 1 ,10 2 } to form different parameter combinations. Each combination of parameter choices was evaluated using stratified 5fold cross-validation, and the parameters with best cross-validation AUC [the Area under the Receiver Operating Characteristic (ROC)were identified. The final classifier model was then trained on the whole training set using the optimal parameters, tested on the independent validation dataset, and evaluated based on both AUC and accuracy.collected, normalized, z-score transformed, and then separated into labeled data and unlabeled data. A stratified K-fold cross-validation is used for classifier development. Features are selected based on labeled data, whereas LDS classifier is developed by combining labeled and unlabeled data. Fully developed classifier based on the optimal parameters identified in crossvalidation is then evaluated in an independent dataset. cross-validation is used for classifier development. Specifically, the labeled samples are randomly partitioned into K subsets, with each subset containing roughly the same proportions of the two types of class labels. Of the K subsets, a single subset is retained as a temporary test subset and the remaining K 1 subsets are used as a temporary training set. On the training set, a feature selection method is used to select a group of outcome-related genes. Although different methods can be used for feature selection, the most commonly used method, t-test, was employed in this study. Data on selected genes for samples in the training set is combined with those for unlabeled samples and used to parameterize the LDS classification algorithm. The parameterized classifier (yellow circle) is then used to classify samples in the test subset. The cross-validation process is then repeated K times, with each of the K subsets used exactly once as the test subset. The K results from the subsets then can be combined to produce a single estimation. Fully developed classifier (green circle) based on the optimal parameters identified by the cross-validation process is then validated by an independent dataset. The performance is evaluated based on both accuracy and AUC.
RESULTS
Overview
Semi-supervised classification of cancer recurrence
Integrating unlabeled data from the same dataset improves prediction performanceIn a cancer gene expression dataset, it is common that only some of the samples have sufficient clinical follow-up data and others are unlabeled with regard to the clinical question of interest. Therefore, we first investigated whether integrating unlabeled data from the same dataset could improve prediction performance using 5-year relapse-free survival in CRC as an example. GSE17536 was used for classifier development, in which 66 samples were labeled (30 recurrence and 36 nonrecurrence) and 72 samples were unlabeled. Of them, twenty three labeled samples in GSE14333 were used for independent validation (12 recurrence and 11 nonrecurrence). For reference, we compared performance from the semi-supervised method LDS to that from the state of the art supervised method SVM. To simulate different numbers and percentages of labeled samples in different datasets, we performed comparisons for three different sizes of labeled samples, 20, 40 and 66. For LDS, unlabeled samples were added at two different ratios. For each combination, results were generated for five random samples when possible in order to obtain robust performance evaluation results. For each random sample, t-test was used for feature selection with a cutoff value of P = 0.05.(selected based on cross-validation results, full models were developed based on all available data in GSE17536 (66 labeled and 72 unlabeled) and tested on the independent dataset GSE14333. The LDS classifier achieved an AUC of 0.55, which was 21% higher than that from the SVM classifier. Similarly, the LDS classifier obtained an accuracy of 0.52, which was 8.3% higher than that from the SVM classifier. Both cross-validation results and independent test results clearly demonstrated that LDS was able to integrate unlabeled data from the same dataset and achieve significantly better performance.
LDS is robust to the number of selected featuresWe used the t-test for feature selection and applied various cutoff values. The number of features selected depended on the cutoff used. In order to evaluate the robustness of LDS to the number of selected features, we tested different P-value cutoffs including 0.01, 0.05 and 0.1. From GSE17536, 40 randomly selected labeled samples and 72 unlabeled samples were used for the stratified 5-fold cross-validation analysis, and results were generated for five random samples and averaged. According to both AUC and accuracy, performance based on the P-value cutoffs 0.05 and 0.1 were very similar, whereas that based on the cutoff 0.01 was slightly worse (). However, the performance decrease between the 0.05 cutoff and the 0.01 cutoff was only 5.2% based on AUC and 5.5% based on accuracy. These results suggest that LDS was reasonably robust to the number of selected features with different P-value cutoffs. Because the 0.05 cutoff seemed to perform slightly better than its looser or more stringent alternatives, we continued the study using the 0.05 cutoff.
Integrating unlabeled data from different datasets improves prediction performanceAlthough there exists many gene expression datasets from different institutions in the public databases for many cancer type, very few datasets provide clinical follow-up information. Therefore, it is of particular interest to investigate whether integrating labeled data with unlabeled data from different datasets can lead to improved prognosis, and how performance changes with increased number of unlabeled samples. In addition to the two datasets used above (GSE17536 and GSE14333), we further collected three CRC datasets (GSE13294, GSE18105 and the CRC data in GSE2109) from the GEO database (). Similar to the above analysis, we kept GSE14333 as an independent test dataset and integrated the other four datasets for classifier development. A total of 662 samples in the four datasets were processed using the MAS5 algorithm followed by quantile normalization, removal of lowly expressed probe sets and removal of probe sets with low variation. Because strong batch effect was observed between different datasets, a gene-wise z-score transformation was applied to each dataset separately, that successfully reduced the batch effect (Supplementary). After data processing, 40 labeled samples were randomly selected from the GSE17536 dataset. Unlabeled samples were added to achieve different ratios between labeled and unlabeled samples (1:1, 1:4, 1:8, 1:12, 1:15). The t-test was used for feature selection with a cutoff value of P = 0.05. Semi-supervised classifiers were developed through stratified 5-fold cross-validation, and then evaluated using the 23 labeled samples in the GSE14333 dataset. For each ratio, the process was repeated five times and performance results were averaged. As shown in, improvement in AUC and accuracy on independent validation set was observed with increased number of unlabeled samples. The AUC and accuracy were 0.57 and 0.55, respectively with 40 labeled and 596 unlabeled samples (1:15), which were 14 and 10% higher than those with 40 labeled and 40 unlabeled samples (1:1). Compared with the performanceof SVM with 66 labeled samples (), LDS achieved 26% higher AUC and 14% higher accuracy with 40 labeled and 596 unlabeled samples. These results demonstrated that unlabeled data from different datasets could help improve prediction performance, and the improvement coincided with increased number of unlabeled samples.
Semi-supervised classification of cancer recurrence
LDS is effective in breast cancer datasetsTo test the general applicability of this semi-supervised method, we applied the LDS procedure to human breast cancer datasets. A breast cancer dataset GSE2034 with 275 samples was used to develop classifiers for the prediction of 5-year recurrence. About thirty labeled samples were randomly selected as labeled samples while all other samples were treated as unlabeled samples. Similar to the observation in colon cancer, the semi-supervised prediction performance was robust to the number of selected features when different P-value cutoffs were tested (Supplementary). Therefore, we used the 0.05 cutoff in the following studies. Semisupervised classifiers were developed through stratified 5-fold crossvalidation, and then evaluated using 158 labeled samples in an independent dataset GSE2990. This process was repeated five times and performance results were averaged. In cross-validation studies, LDS achieved 16.3 and 20% increase in accuracy as compared with SVM when 30 (1:1) and 245 (1:8.1) unlabeled samples were added respectively (). When AUC was used as the performance metric, 2.2 and 7.45% increase were observed as compared with SVM when 30 and 245 unlabeled samples were added, respectively (). Interestingly, the accuracy and AUC obtained by SVM with 275 labeled samples was only 1.5 and 2.6% higher than that by LDS with 30 labeledand 245 unlabeled samples, suggesting great potential of the semi-supervised method. Applying the full model developed by LDS with 30 labeled and 245 unlabeled samples on the independent validation set GSE2990 resulted in an accuracy of 0.62, which was 14.8% higher than that obtained by SVM with 30 labeled samples and was comparable with that obtained by SVM with 275 labeled samples (). However, significant gain in accuracy did not translate into superior AUC (). To test whether integrating unlabeled data from different datasets could improve prediction performance in breast cancer, we used an additional dataset GSE20271 with 178 samples (). We kept GSE2990 as an independent test dataset and integrated GSE2034 and GSE20271 for classifier development. After data processing as described in the CRC study, 30 labeled samples were randomly selected from the GSE2034 dataset. Unlabeled samples were added to achieve different ratios between labeled and unlabeled samples (1:1, 1:5, 1:10, 1:14). The t-test was used for feature selection with a cutoff value of P = 0.05. Semi-supervised classifiers were developed through stratified 5-fold cross-validation, and then evaluated using the 158 labeled samples in the GSE2990 dataset. For each ratio, the process was repeated five times and performance results were averaged. As shown in, improvement in AUC and accuracy on independent validation set was observed with increased number of unlabeled samples. These results were consistent with the observations in CRC and further demonstrated that unlabeled data from different datasets could help improve prediction performance.
DISCUSSIONThe present study was designed to address the small sample size problem in gene expression-based outcome prediction for human cancers. As compared with SVM, the semi-supervised LDS
M.Shi and B.Zhangapproach successfully employed unlabeled gene expression data and achieved significantly better performance. Previous studies in the machine learning field suggest that unlabeled data do not always help improve the performance (). If labeled data and unlabeled data follow different distributions, integrating unlabeled data may even lead to worse performance. This is a big concern for integrating datasets from different institutes, as these datasets are likely to follow different distributions because of both biological and technical reasons. In our analysis, we used quantile normalization to make distributions for all samples comparable. However, an unsupervised clustering analysis suggested that strong batch effect remained after this step (Supplementary). Further application of a genewise z-score transformation to each dataset separately, effectively reduced the batch effect (Supplementary). Without these data preprocessing steps, LDS was not able to achieve improved performance (data not shown). It is possible that more advanced data preprocessing () might further improve the LDS performance. Cross-validation provides an estimate of the expected prediction error for the classifier developed using the full dataset. We performed gene selection from scratch within each loop of the cross-validation to avoid overestimation of the performance. Moreover, we also repeated the 5-fold cross-validation for five times when possible to obtain a more robust estimation. However, when a fully developed model was applied on an independent data, the performance was notably worse than that estimated, based on cross-validation. This was true for both LDS and SVM classifiers, and performance degradation was more severe in the CRC study than the breast cancer study. Indeed, SVM performed worse than random (AUC < 0.5 and accuracy <0.5) on the independent test set in the CRC study. One explanation is the different class proportions between the training and the independent test datasets, given the small sample size in both datasets. Previously, it has been reported that varying class proportions in training and test datasets can lead to pessimistic biases for both accuracy and AUC, and this problem is common in microarray studies with small sample size and weak signals (). Although the class proportion can be well maintained in a stratified cross-validation, it is not controlled for independent test sets. Another explanation is the biological difference between different patient cohorts. For example, in the CRC study, the training dataset GSE17536 was from a US population, whereas, the test dataset GSE14333 was from an Australian population. AUC and accuracy are the two commonly used metrics for evaluating the predictive ability of learning algorithms. Previously, it has been reported that AUC and accuracy do not always coincide, and may even contradict one another. In our study, we also noticed clear difference between performance gain in AUC and accuracy. For example, in the breast cancer study, LDS achieved much higher accuracy as compared with SVM in both cross-validation and independent validation. However, the increase in AUC was relevantly smaller. Therefore, reporting both metrics is necessary for a more complete picture on the performance improvement. Although semi-supervised learning has been applied to different biological problems including gene expression-based cancer subtype discovery (), based on our knowledge, this is the first report on its application to gene expression-based classification of human cancer. Our results demonstrated great potential of semi-supervised learning in this critical but difficult clinical problem. The LDS algorithm used in this study is based on the 'cluster assumption'. An important future work is to compare the LDS algorithm with other semi-supervised algorithms such as those based on the 'manifold assumption' () to further investigate the application of semi-supervised learning to gene expression-based disease classification.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
