Motivation: Image non-uniformity (NU) refers to systematic, slowly varying spatial gradients in images that result in a bias that can affect all downstream image processing, quantification and statistical analysis steps. Image NU is poorly modeled in the field of high-content screening (HCS), however, such that current conventional correction algorithms may be either inappropriate for HCS or fail to take advantage of the information available in HCS image data. Results: A novel image NU bias correction algorithm, termed intensity quantile estimation and mapping (IQEM), is described. The algorithm estimates the full non-linear form of the image NU bias by mapping pixel intensities to a reference intensity quantile function. IQEM accounts for the variation in NU bias over broad cell intensity ranges and data acquisition times, both of which are characteristic of HCS image datasets. Validation of the method, using simulated and HCS microtubule polymerization screen images, is presented. Two requirements of IQEM are that the dataset consists of large numbers of images acquired under identical conditions and that cells are distributed with no within-image spatial preference. Availability and implementation: MATLAB function files are available at http://nadon
INTRODUCTIONThe effectiveness of high-content screening (HCS) depends critically on data processing and analysis techniques that are appropriate to its unique technologies and data formats (). In particular, image preprocessing, which represents a conditioning or preparation of the image data, is an often overlooked but essential step (). Image non-uniformity (NU) is a spatially varying bias that is intrinsic to all image-based biological datasets (). The quality of image NU bias correction, which occurs during the preprocessing stage, can affect the validity of all subsequent data analysis steps which include image quantification and statistical inference. In particular, the methods implemented in these steps usually presuppose that the incoming image data are free of bias. Image NU produces a bias in the pixel intensities across images, which causes objects of interest and their surrounding background to appear spuriously brighter or darker depending on their spatial location (e.g.;, Figures 45 and 51). This can create difficulties in the identification of consistent thresholds that distinguish objects of interest from background and, as a result, reduce the accuracy of their segmentation. Bias and variability are also induced in measured cell metrics which depend on both the pixel intensities and the segmentation step. Reduced quality in cell metric data reduces the sensitivity and specificity of hit identification which typically relies on treatment-control comparisons of cell-metric-derived statistics (). Cell classification accuracy (e.g.) will also be diminished if the classification criteria depend on pixel intensity in any way. The within-image spatial variation in cell intensity caused by image NU bias also introduces spurious heterogeneity between cells which can obscure the existence of real, biologically based cell subpopulations, a topic that has gained recent interest and pertinence (). In a particular, striking example of the impact of NU bias,show how the separation of the G1-and M-phase peaks in a cell-cycle classification analysis is obscured by the uncorrected image NU bias. Further discussion of the impact of image NU on image analysis and inference can be found in,the field of HCS, however, the nature of this bias, its impact on subsequent analyses and appropriate correction methods are often poorly understood or overlooked, which leads to the choice of suboptimal correction methods. For example, a large number of HCS studies make use of background subtraction type algorithms (such as the 'rolling ball') which, despite providing visually appealing results, does not correct the higher cell foreground intensities whose quantification is of paramount interest in HCS data analysis. Multiplicative correction and calibration-based methods also have limitations, since HCS assays typically comprise extreme ranges of cellular intensities (e.g.) and are also susceptible to instrumental drift effects. In general, various pre-existing NU bias correction methods and models developed for low-throughput microscopy, which may be either inappropriate for HCS or fail to take advantage of the additional information available in high-throughput contexts, have been the methods of choice for HCS studies. We present the intensity quantile estimation and mapping (IQEM) algorithm, a novel image NU correction method that makes use of the 'asymptotic spatial homogeneity' property found in large throughput (HCS) datasets (c.f. Section 3.1.1 and Supplementary Material Appendix B). (The method is not applicable to the correction of individual images acquired in a low throughput setting). The method accounts for characteristics and analysis objectives of HCS which include (1) large image datasets that comprise extremely diverse ranges of a priori unknown cell phenotypes and thus intensity levels; (2) image acquisition times that can extend over days and which lead to instrumental biases or drifts that can vary with experimental 'batch' and (3) the need for multiple inter-image and inter-plate statistical comparisons over large numbers of images, and the critical importance of controlling the error rates in the resultant hit detection. Concepts of image NU bias and limitations of existing correction methods used in HCS are first described, followed by a theoretical description and practical implementation of the IQEM method. Finally, validation tests using simulated image datasets as well as empirical HCS assay images acquired from a multiparametric assay on microtubule polymerization status (c.f. Supplementary Material Appendix A and) are shown.
THEORY
Mathematical formulation of image NU biasThe general mathematical formulation for the effect of image NU is I meas x, y   ij  f x, y I obj x, y   ij , 1where I meas x, y   ij denotes the measured image intensity corresponding to spatial coordinates x, y for the i th image and j th plate or experimental batch. I obj x, y   ij denotes the 'actual', unbiased intensity of the object (e.g. fluorescent cells) under measurement. f x, y is a function that transforms the object intensities and represents the distortion bias effect of the image NU; the subscriptand Supplementary Material Appendix A). All images have been clipped between the 10th and 75th intensity percentiles which greatly brightens the cell intensities, but permits the NU bias effect at low intensities to become visually apparent. (a) An uncorrected image in which the slowly varying, parabolic, low-intensity background NU is evident in the spaces between the cells; a NU bias at higher intensities that affects the cells also exists but is less easily discerned. (b) The result of a multiplicative-only (intensity-independent) correction is shown. This correction works well for brighter cells, but results in a highly inaccurate removal that augments the low-intensity NU bias. (c) The corrected image after application of the IQEM algorithm, which removes the NU bias at all intensity quantiles. Uncorrected samples of HeLa cells (Cy3 channel) from the high-content multiparametric assay of microtubule polymerization status are shown. A sample of typical cells from a DMSO control well is depicted in (a); cells treated with the depolymerizing agent colchicine, representing a low intensity 'hit' well, are shown in (b) on an intensity scale that is expanded by 10 x, y indicates the spatial dependence of the transformation function. Equation 1 shows that the NU distortion bias represents a mapping of object intensities to measured intensities, specific to each spatial (pixel) location. The objective of NU correction algorithms is to estimate the inverse of the image NU function f 1 x, y so that the object intensity can be recovered from the measured intensity: I obj x, y ij  f 1 x, y I meas x, y ij : 2It can be shown that a non-linear transformation function of intensity can also be expressed as an intensity-dependent multiplicative factor (c.f. Supplementary Material Appendix C). This leads to a conceptually useful alternative expression to Equation(1) for the effect of image NU:where M is the spatially dependent multiplicative factor that represents the NU bias effect unique to each intensity.
Description of existing NU correction methods used in HCSBackground subtraction, multiplicative correction and calibration methods are the three most frequently used NU correction methods in HCS. In these (as well as most other) NU correction methods, a linear approximation to Equation 1 is used:where M x, y   j and A x, y   j are multiplicative and additive factors that describe the effect of the NU bias. A primary advantage of this simplified model is that the estimation of the two intensity-independent factors M and A is much more tractable than the estimation of the general non-linear function f x, y I obs   j .
Background subtraction methodsIn this class of methods, the image NU is modelled as a purely additive or background component. (The 'rolling ball' algorithm described inand implemented in the ImageJ software (2011) provides an example.) Its correction thus consists of the estimation of A x, y   j and its subsequent subtraction from the measured image intensities. Using Equation 4, it can be seen that the corrected image intensities (I corr ) will have the following form:It is evident from Equation 5 that despite the removal of the spatially non-uniform additive component, the cell image intensities remain spatially distorted due to the multiplicative factor M x, y   j , which in general is non-negligible. As a consequence, a spatial bias in intensity will continue to exist in the corrected images. Many HCS studies nevertheless make use of only a background subtraction type method for the removal of image NU. It is possible that the visual appeal of removing background noise from images and the relative straightforwardness of the algorithms contribute to the use of this approach. Supplementary Material Appendix D provides simulation studies and further detailed discussion on the relative performance of background subtraction methods as compared to a full non-linear correction of the NU bias using IQEM.
Multiplicative correction methodsIn multiplicative correction methods (often termed 'shading' or 'illumination' correction), the image NU is assumed to be dominated by the multiplicative factor. The CellProfiler software () for example, provides a multiplicative correction option that uses the 'image-averaging' algorithm. This simplification is justifiable when the foreground or object image intensities are much brighter than the background intensities. That is, I obj x, y   ) A x, y  , and therefore I meas x, y   % M x, y  I obj x, y  . NU correction proceeds by estimating M x, y   and then dividing the measured image intensities to estimate the actual image:For most fluorescent microscopy images, the assumption described by Equation 6 is not unreasonable since the intensity level of fluorescing cells is generally much brighter than that of background. HCS assays, however, consist of large-scale image datasets where libraries of tens of thousands of compounds can be screened. Within such screens, a small number of wells with exceedingly low cell intensities may represent critically important cell populations that exhibit a pronounced response (e.g. apoptosis or depolymerization) to treatment (c.f.). For these cases, I obj x, y   % A x, y   and application of a multiplicative correction will not accurately remove the image NU spatial bias and can in fact lead to an augmentation of the bias at low intensities; an example is shown in.
Calibration methods Calibrationmethods measure a series of reference (i.e. flat field standard) wells prior to imaging experiments in order to estimate both the additive and multiplicative NU components characteristic of the imaging system. The method is described in a low-throughput microscopy context by, Model and Burkhardt (2001) and. It is also provided as an option by several commercial HCS image analysis packages including Metamorph  (Molecular Devices Corp.) and Volocity  (Perkin Elmer, Inc.). Measurements made on reference wells at a particular point in time, however, may not be applicable to all of the images measured over the time course of an HCS assay which can occur over a period of days or more. Temporal 'drift' in the performance of an imaging system and its components is a well-known phenomenon () and is caused by factors such as electrical, thermal and mechanical variations (). Since image NU is an artefact produced by imaging instrumentation, it is highly likely that each experimental batch in an HCS assay would have its own unique NU bias (). As a consequence, images generated in later batches would not be accurately corrected via an estimation made at the beginning of the experiment. Multiple reference measurements interspersed between or within experimental batches could potentially address this problem, but would be time-consuming and likely impractical to implement within the workflow of HCS assays. In general, image NU consists of both additive and multiplicative components and thus NU correction should not be restricted to the estimation and correction of just one or the other. Within HCS image datasets, substantial spatial NU bias will likely persist in cells that manifest high-/low-intensity phenotypes when only background subtraction/multiplicative methods are used. Non-calibration-based correction of both additive and multiplicative NU components, however, requires the implementation of two separate and very different algorithms that each must be tested, parameterized and validated (e.g. CellProfiler;); a method that could estimate and correct both components simultaneously would be preferable. Moreover, the partitioning of image NU into additive and multiplicative components is itself an approximation to the general, non-linear transformation function. For example, the model of additive background NU subtracts a single threshold intensity value at each pixel location, A x, y   j , as an approximation to the low-intensity background NU, which is in fact a spectrum of intensities. Any dependence in the NU bias function itself (f x, y :  ) with intensity within this range is thus neglected. In the model for the multiplicative component of NU, estimation of the correction factor, M x, y   j , is done via a single intensity reference or mean value (e.g. via calibration or image-averaging methods) at each pixel location, which presupposes that this factor applies to the entire range of intensities in the assay. This is an approximation whose accuracy likely decreases with intensities increasingly different from the reference or mean. As an alternative, we present the IQEM algorithm that estimates the full non-linear NU function, applies a bias correction that is appropriate over the full range of intensities present in an assay and can be implemented in a batch-specific level to account for possible experimental drift effects.
ALGORITHM
Theoretical description of the IQEM algorithm3.1.1 Image intensities at each pixel location are statistical realizations of an intensity quantile function (IQF). Under the 'asymptotic spatial homogeneity' condition, the object IQF is spatially invariant; the measured IQF can be estimated empirically Consider the distribution of the image intensities (I x, y   ij ) for a specific pixel location over all images of a particular experimental batch. This distribution, which comprises all of the inter-image variations in cell brightness and placement due to treatment compounds, phenotypes and random variability, can be described by the IQF Q x, y, P   j (where P denotes the percentiles of the quantile function, which range from 0% to 100%) (c.f. Supplementary Material Appendix E). In well-calibrated and optimized high-throughput image assays, there should be no within-image spatial preference for cell brightness or placement that persists systematically over all images. As a result, for the (unbiased) object intensities, the distribution of possible inter-image intensities is the same at each pixel location, and thereforeFurthermore, in the (asymptotic) limit as the number of images (n j  becomes sufficiently large, the IQF for the measured image intensities can be estimated empirically from the observed intensity values over all images in the batch:The above results comprise the 'asymptotic spatial homogeneity' condition, which is also assumed in multiplicative NU correction methods that use the image-averaging approach. (Further details are provided in Supplementary Material Appendix B.) 3.1.2 The effect of NU bias can be expressed as a mapping of the intensity quantiles of the object IQF to the measured IQF Both the measured and object intensities can be associated with the corresponding percentiles of their IQFs; thus Equation 1 can be written as I meas P meas , x, y   ij  f x, y I obj P obj , x, y ij . Assuming that f x, y is monotonic in P and does not scramble the order of the object intensity quantiles, then P meas  P obj  P, and therefore I meas P, x, y   ij  f x, y I obj P, x, y   ij . Thus, it can be seen that the effect of the image NU is to map object intensities to measured intensities while preserving the associated percentile. Note that the IQFs can be thought of as sets of intensitypercentile pairs. When f x, y is applied to the IQFs, the effect is to map the object IQF to a measured IQF. Thus,Therefore, if both the object intensity and measured IQFs could be measured, then the NU bias function f x, y and its inverse, f 1 x, y , could be estimated.
Removalof the effect of NU bias can be achieved by mapping the measured intensities at each spatial location to an arbitrary reference IQF The object IQF is intrinsically unknowable since object intensities cannot be measured without NU bias. Consider, however, an arbitrary reference IQF, Q ref P   j. Let g x, y be the function that monotonically maps the measured IQF at each pixel location toknown, the function g x, y can be estimated. Application of the mapping transformation g x, y to all the pixels in an image removes the spatial distortion effect of NU bias since the IQFs of the resulting transformed image will be spatially invariant and equal tois also a monotonic transformation, the ordering of the intensity quantiles in the mapped image is unchanged from those of the unbiased image, Q obj P   j. If Q ref P   j is then chosen from the IQF at the centre of the measured images, its distributional form should be quite close to that of Q obj P   j (since the region with least NU distortion is typically close to the image centre). As a result, mapping of the measured intensities to Q ref P   j will remove the spatially varying NU while preserving the intensity-based information in Q obj P   j (i.e. image processing and statistical operations will be either unchanged or minimally perturbed).
Implementation of the IQEM algorithmThe IQEM correction is implemented in two stages, as shown inStage 1, Step 1: A spatial grid is chosen for the initial estimation of the intensity-dependent NU variation across images. In the present study, a grid of 25  20  500 elements is used for all quantiles and allows for an adequate fit to the NU variation which in general varies relatively slowly across the image. For images that are 1300  1028 pixels in size, this results in approximately 52  50  2600 pixels per grid element. Note that if the spatial grid is chosen too finely, the number of pixels per grid element will be reduced, which may diminish the precision of the estimated IQFs (c.f. Section F3, Supplementary Material Appendix F). This step is depicted inare aggregated, and the corresponding IQF is determined from the quantiles of the resulting distribution. In the present study, with each experimental batch consisting of 768 images (corresponding to a 96-well plate with eight image fields per well), each IQF was formed from the aggregation of 2600  768  1 996 800 pixels. The measured IQFs were stored as vectors of intensity values estimated for a grid of pre-specified percentiles. This step is depicted in(c.f. also Section F4, Supplementary Material Appendix F). Examples of IQFs are shown in.Stage 1, Step 3: The spatial variation (over grid elements) of the intensities corresponding to each quantile represents the empirical estimate of the image NU distortion bias at that intensity quantile. Profiles of the spatial NU for several quantiles from the assay of the current study are shown ini. Note the slowly varying, parabolic variation across the image that is characteristic of image NU. 2D quadratic functions (of the form,xy) are fitted using multiple linear regression to the spatial intensity variation for each quantile (; c.f. also Supplementary Material Appendix G); log transformation of the intensity quantiles was done before fitting, to stabilize the variance. A vector of 6 coefficients is thus computed for each intensity quantile, and these permit the fine-scale computation of the IQFs at each pixel location during the correction process.shows representative plots of the b 1 (quadratic) coefficient versus percentile, for the Cy3 channel, for three different replicate plates. Note the variation in the coefficients (and hence variation in the shape of the NU bias) with percentile, illustrating the pertinence of the full non-linear NU model. Note also that the estimated coefficients vary smoothly, indicating that the image population sizes chosen provide adequate precision.Stage 2, Step 1: For each pixel location in a measured image, the IQF, Q meas P, x, y   j , is computed over prespecified percentiles, using the 2D quadratic functions. Using the estimated IQF, the percentile associated with the measured intensity value at each pixel is determined. This is depicted in.Stage 2, Step 2: The intensity value in the reference IQF, Q ref P   j , that coincides with the identified percentile is determined. The pixel intensities in the corrected image are set (i.e. mapped) to these intensity values, as depicted in.Further technical details, sensitivity studies and guidelines related to the selection of the IQEM algorithm spatial grid (Stage 1, Step 1), percentile grid (Stage 1, Step 2), the effect of image number, quadratic fitting (Stage 1, Step 3) and algorithm run-time are provided in Supplementary Material Appendices F (Sections F3, F4 and F5), G and H.. The sequence of steps in the IQEM algorithm is depicted. In Stage 1, the measured and reference IQFs are estimated; in Stage 2, the NU bias is corrected via a mapping of pixel intensities
VALIDATION
Validation testsThe objective of the validation tests is to demonstrate two aspects: (1) that the algorithm does not alter the pixel intensity of images when there is no NU present and (2) that the algorithm can correctly detect and remove a known, imposed image NU (e.g.). Validation tests of the IQEM algorithm were first performed on simulated image datasets, which are described in Sections 4.1.14.1.3; further details of the simulated datasets are provided in Supplementary Material Appendix I. Next, a 'self-consistency' test using real HCS images is described in Section 4.1.4. Each validation dataset consists of 768 images; each individual image measures 1300  1028 pixels in dimension. The results of each validation consist of profiles of Q meas P, x, y   j that are estimated and then fitted by the IQEM algorithm. Profiles are shown at four representative percentiles, P  25%, 50%, 75%, 90%, and plotted along the central long axis of the images. The estimated intensity quantile profiles were determined via aggregation across images while fitted intensity quantile profiles correspond to the fitted 2D quadratic function, as described in Section 3.2.shows the results of such a test, where a second-pass run of the IQEM algorithm is performed on the images pertaining toi. The resulting measured and fitted profiles across all intensity quantiles are flat, demonstrating that the IQEM algorithm detects no NU bias once the images have been corrected. Finally, Figures 1a and 1c represent a qualitative, visual validation of the IQEM algorithm performance; the NU bias at very low intensities that is visually evident in the background between cells of an uncorrected image () is no longer apparent in the corrected image shown in.
Variability of NU bias according to experimental batchAs described in Section 2.1, various experimental factors could cause NU bias to vary over the course of an HCS assay. For the microtubule depolymerization assay, a single setting was used for the imaging system throughout the assay. However, while wells within plates were imaged consecutively and close together in time (52 s between images), the time interval between plates was variable and ranged from 10 min to more than an hour for plates acquired on the same day, and more than 16 h for consecutive plates acquired between different days. For this reason, the IQEM correction method was applied on a plate-specific basis. Correction results were then examined for possible plate-specific variation in the NU bias.shows plots of a representative fitted quadratic coefficient (b 1 ) to the NU spatial bias function versus percentile, for the Cy3 channel. Each curve corresponds to a replicate plate that was measured on one of three different days. It can be seen that the fitted coefficients for plate 1 show a systematic deviation from that of the other two days, demonstrating the phenomenon of batch-specific image NU bias.
DISCUSSIONThe IQEM algorithm represents an improvement over existing methods of image NU correction used in HCS, which are based on varying degrees of simplification to a linear model approximation of NU bias. By estimating the full non-linear form of the NU bias, the IQEM method essentially applies a correction factor that is appropriate to each intensity quantile in the measured image. The method is particularly pertinent for the quantification of extremely low-intensity cell phenotypes, where multiplicative correction provides an inaccurate fit to the low-intensity image NU, and where background subtraction does not adequately model the range of dim intensity levels. An additional positive feature of the IQEM algorithm is that it can be applied on a batch-specific basis such that a unique image NU correction is estimated for each batch. The IQEM method does require that cell placement and intensity are spatially homogeneous within images (i.e. that the asymptotic spatial homogeneity condition holds). Assays that have been properly calibrated, and for which there are no systematic within-image gradients caused by poor optical focus, non-uniform fluorophore or reagent concentrations or cell density gradients (c.f. Supplementary Materials Section B.5), for example, should satisfy this condition. The measurement of multiple fields within wells, a standard practice in HCS, further ensures that on average, the spatial homogeneity condition will hold. Although the IQEM algorithm may be more complex than other conventional methods of NU bias correction, it is readily automated, and its complexity will not be apparent from the user's perspective once integrated into an image-processing pipeline. The IQEM algorithm arose during the analysis of the multiparametric assay of microtubule status, in which a method of batch-specific NU bias correction effective for very low-intensity, depolymerized phenotypes was needed (). The development of IQEM provides an illustration that methods adopted from low-throughput science may not necessarily be optimal in a high-throughput context, which involves the analysis of large-scale image datasets, the testing of compound libraries that produce extremely diverse ranges of a priori unknown cell phenotypes/intensities and requires statistical comparisons of metrics taken across the dataset. It should further be noted that while high-throughput, high-content datasets provide challenges to analysis methods (), they also provide opportunities. In the present case for example, the enormous size of HCS image datasets, which consist of images that are effectively statistical replicates within each experimental batch, makes possible the existence and estimation of the inter-image IQF; estimation of this entity in turn makes possible the inversion of the non-linear NU bias function via a mapping of intensity quantiles. In general, HCS systems comprise and integrate many complex state-of-the-art subsystems, ranging over biological experimentation (cell cultures and immunofluorescence staining for example), automated image acquisition, imaging instrumentation and image processing, each of which acts to produce or condition the high-content data, and also to contribute bias and variability that determine the resultant statistical characteristics of the data (). By more fully understanding the technical and technological issues of each subsystem within an HCS workflow, it becomes possible to better model the statistical distribution of the data, and thus to improve the sensitivity and specificity of statistical inference methods used to draw scientific conclusions from HCS experiments. The current work represents a step in this direction, in the context of the image NU bias produced by HCS imaging instrumentation.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Novel algorithm for the correction of image non-uniformity bias at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
E.Lo et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.1.1 Simulated images contain no NU and consist of random noise For the simulated images in this validation dataset, each pixel is assigned an intensity value that is generated from a positive-constrained normal distribution. This validation test thus represents the simplest 'null' test as there is no spatial uniformity in the images nor are there 'objects' of any kind. As shown in Figure 4a, the IQEM algorithm does not detect any discernible image NU in any of the intensity quantiles. 4.1.2 Simulated images contain no NU and consist of both cells and noise Next, an image dataset with both noise and simulated cells is tested. Simulated cells consisted of truncated bivariate Gaussian intensity functions, with peak intensity, x  y correlation, spatial placement and number of cells determined randomly over ranges of values chosen to mimic real cell populations (c.f. Supplementary Material Appendix Ib). Both multiplicative and additive noise were also added. Despite the much greater spatial heterogeneity produced by the simulated cells, the IQEM algorithm correctly detects no image NU, as shown by the flat measured and fitted intensity profiles (Figure 4b). 4.1.3 Simulated images consist of both cells and noise, with a non-linear NU imposed A parabolic NU is applied only to pixel intensities that are higher than the 85th intensity percentile of the simulated image dataset from Figure 4b. The IQEM algorithm correctly detects and fits this highly non-linear NU bias, as shown by the flat fitted profiles corresponding to the 25th, 50th and 75th percentiles and the parabolic NU that is detected for the 90th quantile (Figure 4c). The imposed NU was centred at 900 units (c.f. Supplementary Material Appendix Ic), which is also accurately detected. 4.1.4 NU correction of Cy3 channel images of HeLa cells from a microtubule polymerization assay The IQEM algorithm is applied to actual images from the multiparametric assay of microtubule polymerization status (c.f. Supplementary Material Appendix A, Lafanechere, 2008; Vassal et al., 2006). The tested image batch was acquired on Day 2 of the assay and consists of lysed cells acquired on the Cy3 channel (which corresponds to Tyr-tubulin cell content). The algorithm detects a pronounced image NU present in all intensity quantiles as shown in Figure 4d-i. Figure 4d-ii shows profiles of the ratio between the fitted intensity and that measured at the image centre, for each quantile. In the ratio profiles, the intensity dependence in both the shape and curvature of the image NU can be more clearly seenwhile the image NU is approximately symmetric at lower intensity quantiles, it becomes markedly off-centre at higher intensity levels. Absolute validation of NU correction algorithms on real images is not possible since the actual NU distortion bias is intrinsically unknown. However, a self-consistency test is possible in that a correction algorithm should not detect further NU bias on images that have already been corrected once. Figure 4d-iii Fig. 4. The results of the validation tests. Plots (a), (b), (c), (d-i) and (d-iii) show profiles of measured and fitted intensity quantiles, for four representative percentiles (P  25%, 50%, 75%, 90%), plotted on a log(intensity) scale. The units of intensity vary between image sets and are not shown. (d-ii) Plots of the intensity ratio at each position along the profile relative to intensity value at the centre of the image, for the image set of (d-i)
