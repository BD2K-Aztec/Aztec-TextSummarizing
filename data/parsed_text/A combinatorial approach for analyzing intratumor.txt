Motivation: High-throughput sequencing of tumor samples has shown that most tumors exhibit extensive intra-tumor heterogeneity, with multiple subpopulations of tumor cells containing different som-atic mutations. Recent studies have quantified this intra-tumor hetero-geneity by clustering mutations into subpopulations according to the observed counts of DNA sequencing reads containing the variant allele. However, these clustering approaches do not consider that the population frequencies of different tumor subpopulations are correlated by their shared ancestry in the same population of cells. Results: We introduce the binary tree partition (BTP), a novel com-binatorial formulation of the problem of constructing the subpopula-tions of tumor cells from the variant allele frequencies of somatic mutations. We show that finding a BTP is an NP-complete problem; derive an approximation algorithm for an optimization version of the problem; and present a recursive algorithm to find a BTP with errors in the input. We show that the resulting algorithm outperforms existing clustering approaches on simulated and real sequencing data. Availability and implementation: Python and MATLAB implementations of our method are available at
INTRODUCTIONCancer is a disease driven by somatic mutations that accumulate in the genome during the lifetime of an individual. High-throughput sequencing technologies now provide an unprecedented ability to measure these somatic mutations in tumor samples (). Application of these technologies to cohorts of cancer patients has revealed a number of new cancer-causing mutations and cancer genes (). Cancer sequencing studies have also demonstrated that most tumors exhibit extensive intra-tumor heterogeneity characterized by individual cells in the same tumor harboring different complements of somatic mutations (). Such heterogeneity is a consequence of the fact that cancer is an evolutionary process in a population of cells. The clonal theory of cancer evolution () posits that the cells of a tumor descended from a single founder cell. This founder cell contained an advantageous mutation leading to a clonal expansion of a large population of cells descended from the founder. Subsequent clonal expansions occur as additional advantageous mutations accumulate in descendent cells. A sequenced tumor sample thus consists of multiple subpopulations of tumor cells from the most recent clonal expansions (). Nearly all cancer sequencing efforts thus far sequence DNA from a single sample of a tumor at a single time. This is because of technical limitations: the most cost-effective DNA sequencing technologies (e.g. Illumina) require input DNA from many tumor cells, and such samples are typically available only when patients undergo surgery (Occasionally, paired samples from two time points, such as a primary tumor and a metastasis, are also sequenced.). While sequencing of multiple samples from the same tumor () or single-cell sequencing () might eventually provide even better datasets to assess intra-tumor heterogeneity, technical considerations have limited their applicability utility thus far. Thus, there is tremendous interest in methods that infer the relative proportion of different subpopulations of tumor cells in a single sample. Several recent studies () have demonstrated that it is possible to infer the subpopulations of tumor cells by counting the number of DNA sequence reads that contain a somatic mutation. For single-nucleotide mutations, or variants, the variant allele frequency (VAF) is defined as the fraction of DNA sequence reads covering the variant position that contains the variant allele rather than the reference/germ line allele. The VAF provides an estimate of the fraction of tumor chromosomes containing the mutation, but with error due to the stochastic nature of the sequencing process (). In addition, technologies currently used in cancer sequencing studies produce short reads that rarely contain more than one somatic mutation. Thus, for any pair of somatic mutations, the only information available to distinguish their subpopulation of origin is the VAF. To overcome substantial variability in measured VAFs, a common approach is to cluster VAFs and from these clusters infer the number and proportion of various subpopulations of tumor cells in the sample. A number of techniques have been introduced to perform this clustering, with Dirichlet Process Mixture models and related non-parametric models being particularly popular, as they do not fix the number of clusters in advance (). VAF clusters correspond to tumor subpopulations, and the cellular fraction, or fraction of tumor cells containing the cluster of somatic mutation, is derived from the VAF of the clusters. In the simplest case, the VAF directly determines the cellular fraction: e.g. a cluster with VAF = 0.5 corresponding to homozygous mutations in 50% of tumor cells, or *To whom correspondence should be addressed. y The authors wish it to be known that in their opinion, the first two authors should be regarded as Joint First Authors.  The Author 2014. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com heterozygous mutations in 100% of tumor cells. However, in practice, the inference of cellular fraction is complicated by copy number aberrations and normal admixture (percentage of the tumor sample that is normal cells), and these two factors are themselves correlated (). We will not consider such complications here; rather we restrict attention to heterozygous somatic mutations outside of copy number aberrations; assumptions that were made in sequencing studies including. With two exceptions (), current techniques for clustering VAFs treat each subpopulation independently and do not consider that these frequencies are correlated by the fact that they are partitions of the same cellular population. Thus, these approaches do not explicitly construct an evolutionary history of the accumulated somatic mutations in the cells.performs a heuristic search over possible trees, and we discussbelow. Contributions. In this article, we formulate the problem of inferring subpopulations of tumor cells from VAF data obtained from a single tumor sample as the combinatorial problem of constructing a Binary Tree Partition (BTP). We show that the problem of finding a BTP is NP-complete and present a 2 3  o1-approximation algorithm for a related max-BTP problem. The approximation algorithm is based on Local Search and we use the well-known packing bound offor the purpose of analysis. Next, we define "-BTP, a generalization of the BTP problem that allows for the possibility that VAFs are observed with errors and some VAFs are not observed. We present a straightforward recursive algorithm to find an "-BTP and show that this algorithm outperforms existing VAF clustering approaches on simulated and real data. This recursive algorithm is fast in practice and runs in less than a minute, on a single CPU, for each of our simulated or real samples.
TUMOR SUBPOPULATIONS AND THE BTPIn this section, we formulate the problem of determining tumor subpopulations from VAF clusters. The clonal theory of cancer evolution proposes that the cancerous cells in a tumor are the result of multiple waves of somatic mutation and clonal expansion. Given the relationship between sequence coverage (1000 10 000 for targeted studies) and number of tumor cells that are sequenced in a tumor sample (millions), we first assume that any somatic mutation reported in the data must be present in an appreciable fraction of tumor cells. This implies that the observed somatic mutations were present in at least one clonal expansion. Second, as in other recent studies (), we assume that somatic mutations follow the infinite sites assumption such that at most one single mutation occurs at a genomic locus (e.g. single position) during the evolution of the tumor. It follows from this assumption that if a mutation occurs in a tumor cell subsequent to a mutation , then the fraction of cells containing mutation must be at least as large as the fraction of cells containing. This condition was also recently noted in. We assume that at any particular time in the cancer progression at most one cell in the tumor population acquires a new mutation leading to a clonal expansion. We emphasize that, these clonal expansions give rise to a BTP, with nodes representing populations of tumor cells with specific subsets of somatic mutations. (c) The variant allele frequencies (VAFs) of somatic mutations are determined from sequencing data and used to infer tumor subpopulations and/or the BTP. Here the clusters correspond to clonal expansions, and center of each cluster estimates the frequency of the newly formed subpopulation (denoted with colored marker). Note that the size of each cluster depends on the number of mutations that accumulate before its expansion i79 A combinatorial approach for analyzing intra-tumor heterogeneity this assumption restricts only the number of clonal expansions that begin at a given time and not the number of clonal expansions that are ongoing at one time. Under this assumption, each clonal expansion splits the present tumor cell population into exactly two subpopulations: the subpopulation P of cells containing the newly acquired somatic mutation and the subpopulation P 0 of cells without the mutation (and possibly with a different set of new mutations occurring later in time). Thus, the ancestral history of the sequenced tumor cell population is represented by a rooted binary tree with nodes corresponding to populations of cells at each clonal expansion, and edges indicating the ancestral relationships between these populations. Consequently, each node v in the tree has a set M v of somatic mutations that accumulate along the unique edge p v that connects v to its parent (As the root r does not have a parent, the set M r represents the somatic mutations that accumulate before the first clonal expansion. Alternatively, we can let p r be a hidden edge that connects the founder cell of the tumor (represented by the root r) to the normal cell from which it is derived.). Each node v also has a frequency a v representing the proportion of sequenced tumor cells with mutations M v (). Note that most tumor samples contain admixture by normal cells with no detectable somatic mutations, and thus in general a r 51. A consequence of these assumptions is that every internal node v in the tree satisfies the children sum to parents (CSP) condition: P u child of v a u =a v. We make the following definition: DEFINITION 1.. Given a multiset L=fa 1 ;. .. ; a n g with 05a i 1, a BTP for L is a complete rooted weighted binary tree T = (V,E) with nodes V= v 1 ;. .. ; v n f gsuch that v i has weight a i and every internal node satisfies the CSP condition.shows a simple example of a complete binary tree in which the CSP conditions are satisfied for every internal node (also see Supplementary Appendix D.6 for a more general example). Recall that a complete rooted binary tree is a binary tree wherein there is a unique node of degree 2 (the root), and every node in the tree is either a leaf or has exactly two children. Our goal is to construct such a tree from the measured VAF data. We define the following. DEFINITION 2 (BTP problem). Given a multiset L=fa 1 ;. .. ; a n g, find a BTP for L if one exists.Note that in some cases, at the split defined by a clonal expansion, cells from P 0 may survive to the present, without undergoing additional clonal expansions (e.g. such cells may cease dividing, or senesce). In this case, there are no mutations that exclusively occur in P 0. We discuss this case in Section 5 below.
COMPLEXITY OF THE BTP PROBLEMIn this section, we outline the proof of the following theorem. THEOREM 3. The BTP problem is NP-complete.The proof of this theorem relies on the idea of finding a set of conflict-free triangles in the multiset L. This idea is also useful below for deriving an approximation for a related problem of finding a max-BTP, and so we now define the relevant concepts. Suppose L= a 1 ;. .. ; a n f gis a multiset of n elements. For any distinct i, j and k such that a i + a j = a k , we define the ordered pair k; i; j    as a triangle in the multiset. See Supplementary Appendix A.1 for an example. We call k as the peak of the triangle and i, j as the tails of the triangle. We say that triangles t=k; i; j    and t 0 =k 0 ; i 0 ; j 0    are in conflict if k = k 0 or i; j   \ i 0 ; j 0   6  ;. In other words, two triangles are in conflict if and only if they either share a common peak or a common tail. A set Z of triangles is conflict-free if no pair of triangles in Z are in conflict. If T is a BTP for L, for each internal node a k and its children a i and a j , we have a k = a i + a j , by CSP. Therefore, k; i; j    is a triangle in L, and thus, T corresponds to a set of conflict-free triangles in L: each internal node and its children form a triangle in L, and no two triangles share a common peak or a common tail. Because the number of nodes in a complete binary tree is always odd, jLj being an odd number is a necessary condition for the existence of a BTP for L. For a multiset L, with jLj=2q  1, the size of a conflict-free set of triangles is at most q  1. This is because each triangle has exactly two tails, and in a set of conflict-free triangles, all the tails must be distinct elements. We have the following theorem, whose proof is in Supplementary Appendix A.2.THEOREM 5. Let I =X; Y; B be an instance of NMTS. Then, I has a solution if and only if a particular multiset L I has a BTP (i.e. a set of 2m  1 conflict-free triangles). Moreover, each solution of I can be obtained (in polynomial time) from a BTP of L, and vice versa. PROOF. For a given instance I =X; Y; B,Moreover, let j = X j k=1 ^ b k ; 2 j m. Now we construct an instance L I of BTP (i.e. a multiset), with 4m  1 elements as follows:(Thus, by Theorem 4 we obtain a BTP from X and Y in polynomial time. (() Suppose S is a set of 2m  1 conflict-free triangles for L I. We claim that for each ^ x i a triangle  ^ b i ; f ^ x i ; ^ y i g exists, where and are two permutations on {1,. .. ,n}. Note that this i80 completes the proof, by taking X = 1 and Y = 1 *  for the instance I. Node ^ x i cannot be the root, as the largest number in L I is m. Therefore, ^ x i has a sibling s and a parent p. For all i 2 1;. .. ; m f g , we have ^ x i =1; ^ y i =3; ^ b i =4 and i = 4i, all in mod 4(m + 1). Thus, if ^ x i +s=p 2 L I , we have s=3 mod 4m+1  and p=4 mod 4m+1  . This implies s= ^ y i and p= ^ b i for some (i) and (i). Finally, because all the elements of L I are presented uniquely in T, and are two permutations on 1;. .. ; m f g. Note that we construct X and Y from T in polynomial time, and the proof is complete. h We note that the proof above shows that the BTP problem in NP-complete in the strong sense, i.e. the problem is still NPcomplete if the elements of the multiset are polynomially bounded. In addition, the analogous partition problem for non-binary trees is also NP-complete by reduction from the subset sum problem. See Supplementary Appendix A.6.
A 2 3  o1 APPROXIMATION FOR MAX-BTPIn the previous section, we showed that for a given multiset L of 2q  1 elements, each BTP for L corresponds to a collection of q  1 conflict-free triangles. Because L can have at most q  1 conflict-free triangles, we define the max-BTP problem to be the problem of finding the maximum sized set of conflict-free triangles. This is a closely related problem to the BTP problem: in the context of VAF data, the maximum sized set of conflictfree triangles denotes partial information about the ancestral relationships among mutations. Moreover, for a multiset of m elements if max-BTP has a solution of size " then a BTP with k = m  1  2" additional nodes can be found. See Supplementary Appendix A.7. We derive a 2 3  o1 approximation algorithm for the maxBTP problem for L. The algorithm is based on Local Search. We start with any collection of conflict-free triangles in L as a solution and iteratively add another triangle as follows. For a fixed constant t ! 1, we iteratively replace any subcollection of s t triangles in the solution with s + 1 triangles of L such that the new collection still contains only conflict-free triangles. It is easy to see that the above local search terminates in polynomial time. Let OPT be the size of the optimal solution. Because we cannot have more than q  1 conflict-free triangles in a solution, OPT q  1. After each iteration, the size of the collection increases by 1, and because t is a constant, the search procedure at each iteration is polynomial time. Similar to the technique that was used in, we use the packing bound of Hurkens and Schrijver (1989) to prove the following theorem (Proof in Supplementary Appendix A.7). THEOREM 6. There exists a polynomial time algorithm that gives an approximated solution to the problem of finding maximum set of conflict-free triangles within a factor of 2 3  for any 40.
THE "-BTP PROBLEMTypically on real data, a BTP will not existeither because the frequencies a i are determined with some error or the VAF data does not capture the frequency of a subpopulation that does not have mutations that exclusively occur in that subpopulation (VAFs provide information only about the proportion of cells with a mutation, and do not provide information about proportions of cells that have a specific mutation and lack another mutation.). In this section, we introduce the "-BTP to account for these scenarios. Suppose we have the multiset ~ L= ~ a 1 ;. .. ; ~ a m f gof observed frequencies and a corresponding VAF error vector " = (" 1 ,. .. ," m ) for ~ L, where " i is the maximum possible error in observing ~ a i for 1 i m. To account for subpopulations without distinguishing mutations, we may need to add auxiliary frequencies to ~ L that correspond to the missing subpopulation frequencies. We make the following definitions. DEFINITION 7 ("-BTP). Given a multiset ~ L= ~ a 1 ;. .. ; ~ a m f gwith associated VAF error vector = 1 ;. .. ; m , an "-BTP with k ! 0 auxiliary nodes is a BTP for a multiset L= a 1 ; a 2 ;. .. a m+k f g such that for all i m : ja i  ~ a i j i. We call the nodes a m+1 ,. .. ,a m+k the auxiliary nodes of the "-BTP. DEFINITION 8 (The "-BTP problem). Given a multiset ~ L and an associated VAF error vector ", find an "-BTP of ~ L with minimum number of auxiliary nodes such that two auxiliary nodes are not siblings.The constraint on auxiliary nodes in the definition of "-BTP problem follows from the assumptions in our model of cancer progression: each branching in the cancer progression happens only when at least one clonal expansion starts. So, the VAF data captures the frequency of the newly formed subpopulation (see Section 2). Thus, at least one of the children of the current subpopulation node is not an auxiliary node. It is straightforward to show that for any multiset L of size m, it is always possible to obtain an "-BTP with k = m  1 auxiliary nodes (proof in Supplementary Appendix A.3). Also, when " i = 0 for all 1 i m, a BTP exists for L if and only if the corresponding "-BTP has a solution with k = 0 auxiliary nodes. To outline our algorithm, we need the following definitions. DEFINITION 9 ("-CSP tree). Given a VAF error vector ", an "-CSP tree is a (weighted) binary tree, such that for each internal node ~ a i we have ~, where ~ a j and ~ a k are the children of ~ a i .We say that an "-CSP tree ~ T for a multiset ~ L is acceptable if we can obtain a BTP,  ~ T, by replacing each ~ a i by a value a i where ja i  ~ a i j i. Note that  ~ T is an "-BTP for ~ L. Also, note that an "-CSP tree is not necessarily acceptable (See Supplementary Appendix D.8). However, one can easily check whether a given "-CSP tree ~ T is acceptable by finding a collection of e i 's, where je i j i , satisfying the following constraints:  ~ a i +e i = ~ a j +e j +  ~ a k +e k ; for each internal nodes ~ a i and its children ~ a j ; ~ a k. This can be easily done via a linear program, which we denote by LP ~ T. Our Rec-BTP algorithm (Algorithm 1) uses a recursive method that works as follows: at each recursion during the algorithm, we have (i) a partially constructed "-CSP tree ^ T, (ii) a multiset of remaining frequencies ^ L and (iii) the number of remaining auxiliary nodes that we are allowed to use. We check if ^ T can be extended by attaching two elements of ^ L, or one element from ^ L and an auxiliary node, to one of the leaves in ^ T (we assign the auxiliary node's weight accordingly). If ^ L is empty, it i81 A combinatorial approach for analyzing intra-tumor heterogeneity means the algorithm has constructed an "-CSP tree. So we output  ^ T n o if LP ^ T has a feasible solution. Finally, RecBTP outputs all the "-BTPs. Iterating over all values of k from 0 to m  1, the algorithm will find the smallest k such that there exists an "-BTP. Later in Section 6, for the purpose of benchmarking our results, in case of multiple "-BTP outputs, we choose only the tree whose list of node frequencies has the minimum root mean square deviation (RMSD) from the original VAFs data (defined below in Section 6).
EXPERIMENTAL RESULTS
Simulated dataWe generate simulated mutation data from all complete rooted binary trees with 3, 5, 7 and 9 nodes (Supplementary Appendix D.7). For each tree topology, we generate 1000 random BTPs by assigning a weight a i to each node i, as follows. For the root r, we set a r = 1, assuming that our tumor sample is pure, i.e. is not contaminated with normal cells. Next, we proceed down the tree: for each parent with weight a i , we select a pair of real numbers a j and a k for the children uniformly at random such that the CSP condition (a i = a j + a k ) is satisfied. Finally, we generate a set M i of somatic mutations for each node, with jM i j selected uniformly fromindependently for each node. We assume all somatic mutations in the set M i happened independently because the parental cell was created. For each such BTP and set of mutations, we generate a VAF data corresponding to each tumor subpopulation. Ideally, the VAF of a tumor subpopulation from node v equals a v. However, because the observed frequencies are estimated from alignments of sequencing data, the observed frequencies will deviate from the true values. We assume that the observed VAFs for mutations of a subpopulation v are normally distributed with mean a v and standard deviation. Specifically, for each node v, let X v be a set of jM v j samples from N a v ; . Here, we present the results when = 2, with results on = 1, 4 in Supplementary Appendix B. The VAF data for the tumor sample is thus X=[ v X v. Note that we simulate VAFs directly rather than the number of mapped reads containing a mutation. Because we assume that our sequence coverage is high (41000), it follows that the corresponding binomial (or negative binomial) distribution of read counts is well approximated by the normal distribution. For lower coverages, the asymptotic normal approximation may not model the data as accurately; nevertheless, the simulations provide a comparison of the different methods on high-quality data. For each simulated VAF dataset X, we estimate the number and frequencies of tumor subpopulations using two nonparametric clustering algorithms: (i) Accelerated variational Dirichlet process Gaussian mixture model (AVDPM;), as implemented in https://sites.google.com/ site/kenichikurihara/academic-software/variational-dirichletprocess-gaussian-mixture-model, which is a general clustering method that we apply directly on VAF data, and (ii) SciClone (), which is a recent algorithm (with available software but no published paper) that estimates tumor composition from VAF data by clustering the data using a mixture of Gaussian model. Parameter settings for each method are given in Supplementary Appendix C. Also, because SciClone runtimes were extremely long, we down sampled the mutation data by a factor of 20. For each of our synthetic dataset, we implanted the fraction of the mutations (together with their corresponding VAF) on a synthetic chromosome with neutral copy number compatible with the SciClone input format (See Supplementary Appendix C). We ran SciClone with default parameters on each dataset and then extracted the means of reported clusters from SciClone. From the output of each clustering algorithm, we obtain the input for our Rec-BTP algorithm. We compute the sample mean ~ a i and standard deviation i for each cluster C i , and set the VAF error " i for the subpopulation frequency of cluster C i equal to 1:96  c i ffiffiffiffiffi ffi jCij p , where c is a constant set to 3. Note that 1:96  i = ffiffiffiffiffiffiffi ffi jC i j p is the radius of the empirical 95% confidence interval in estimating the true subpopulation frequency. We set L= ~as the input to Rec-BTP. We find the minimum k for which there exists a "-BTP for L with k auxiliary nodes. In many cases, there are multiple BTPs for L with exactly k auxiliary nodes. In these cases, we select a single BTP with the minimum cost, where s=n  k; X is the VAF dataset and D i =fx 2 Xjarg min j ja j  xj=ig is the subset of elements of X that are closest to a i. We compare the results of our Rec-BTP algorithm (applied to clusters from both AVDPM and SciClone) to the original i82 clusters output from these algorithms over the 1000 randomly constructed BTPs for each of the seven tree topologies. We use two measures to compare the estimated subpopulation frequencies: (i) the number of subpopulations and (ii) the RMSD between the set of estimated subpopulation frequencies and the true subpopulation frequencies. Number of subpopulations.shows that Rec-BTP outputs the correct number of clusters more frequently than the clustering methods. For trees with 3 and 5 nodes, Rec-BTP does not improve the AVDPM clusters much. However, with larger number of nodes the advantage of Rec-BTP grows. RecBTP provides a large improvement over the SciClone clusters. We further examined the scenarios where each algorithm reported the correct and incorrect number of clusters.compares the fraction of cases where the clustering method and the Rec-BTP assisted method report too few, the correct number or too many clusters. We see that most of the cases where RecBTP reports the correct number of cases (blue squares) are those where the clustering algorithm reported too few clusters and the Rec-BTP algorithm created additional clusters. Only in the case of 3 and 5 nodes do AVDPM and SciClone determine the correct number of clusters (green squares) in an appreciable fraction of cases. Overall, we see that the clustering methods tend to underestimate the correct number of clusters (first columns in each table in). In a significant fraction of these cases, RecBTP adds auxiliary nodes to obtain the correct number of clusters, although this becomes more difficult with larger trees. We also see that SciClone tends to underestimate the number of subpopulations more frequently than AVDPM. Accuracy of the subpopulation frequencies. We compare the estimated population frequencies and true population frequencies for each method using the RMSD. Suppose a 1 !. .. ! a n are the true subpopulation frequencies, and ~ a 1 !. .. ! ~ a m are the estimated subpopulation frequencies. If m = n, the RMSD is ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi n, we add zeros to the shorter sequence so the two sequences have equal length. The zeros reflect the fact that we have not estimated the frequencies of some subpopulations.gives RMSD for AVDPM, SciClone and Rec-BTP built from these clusters. Specifically, we provide the RMSDs when AVDPM or SciClone give (i) the same and (ii) less than the correct number of subpopulations. For some tree topologies, there is no sample in which both Rec-BTP and AVDPM/ SciClone give the same number of subpopulations equal to the true number of subpopulations, which we denote by N/A. In cases where both methods (Rec-BTP and a clustering algorithm) return the same number of subpopulations, they have similar performance in estimating the subpopulation frequencies. Also, as mentioned earlier, these results are for the simulated input data in which the variant allele frequencies deviate from their true value with standard deviation = 2. When = 1 Rec-BTP performs even better.
Comparison with PhylosubAs noted in the introduction,is a recent method that clusters VAF frequencies using a tree constraint. In particular,replace the Dirichlet process mixture for clustering with a Bayesian non-parametric prior over trees satisfying a weak form of the CSP constraint. We compared our Rec-BTP algorithm with PhyloSub. We generated VAF data from a collection of 400 random complete binary trees with three, five, seven and nine nodes with fixed topologies. For each tree, we generated 100 random instances. In contrast to the simulations in the previous section, here we used only one of the two topologies for trees with seven nodes and only one of the three possible topologies for trees with nine nodes. We converted each random simulated VAF data to a). Because PhyloSub usually tends to report trees with a higher number of nodes, we also considered the size of the smallest tree reported by PhyloSub in their provided list of top trees for each input. While this value was smaller, it was still much larger than the true value or the values from the other approaches. The large number of clusters produced by PhyloSub might result from the fact that the method does not assume that the trees are binary. The output trees contain many different topologies. Nevertheless, it is surprising that PhyloSub does not find binary trees when the data are produced from this topology. As PhyloSub reports a higher number of nodes than Rec-BTP, we were unable to directly compare the provided frequencies of the clusters of each method.
Acute myeloid leukemia sequencing dataWe tested our algorithm on VAFs obtained from deep read counts information for SNVs from an acute myeloid leukemia sample (AML1/UPN933124) using data from. We used the 386 SNVs reported in the primary AML sample, obtaining the tumor VAF data directly from Supplementary Table S5a in. Note thatalso report data from a relapse sample following chemotherapy. As the relapse-specific mutations form only one cluster, we do not analyze the BTP problem for this sample in our study. Nevertheless, the generalization of the "-BTP problem for the case where the input data contains two types of VAFs (e.g. both tumor-and relapse-specific mutations) is an interesting open problem. We first ran SciClone on the VAF data, obtaining four distinct VAF clusters with means of 47.17, 33.17, 22.42, 3.65%. We then ran Rec-BTP on these clusters, fixing the root of the BTP as an additional node with frequency 100%, reflecting the fact that the tumor sample was pure and started from a single founder clone ().shows the resulting "-BTP with corresponding multiset of population frequencies: L RecBTP = {100, 53.75, 46.25, 42.86, 32.25, 21.5, 3.39}.present a history of clonal expansions that implies an "-BTP for the multiset 100; 53:12; 12:74; 29:04; 5:1 f gwith two auxiliary nodes (). There are two such "-BTP, depending on the relative order of two clonal expansions (), one with subpopulation frequencies: L 1 = {100, 53.12, 46.88, 12.74, 34.14, 29.04, 5.1} and another with frequencies L 2 = {100, 34.14, 65.86, 53.12, 12.74, 29.04, 5.10}. However, because the frequencies reported inare scaled according to the estimated 93.72% purity of their sample, it is necessary to multiply the frequencies in L 1 and L 2 by 0.9372 before comparing with the clusters obtained from the VAF data. We compare these different subpopulation frequencies estimates by computing the average ' 1 norm between the VAF for each mutation and the closest subpopulation.shows this measure for each of the subpopulation multisets. We see that theRec-BTP gives a better fit to the VAF data than both estimates L 1 and L 2 given in. This shows that using the tree constraint in the BTP provides additional information that is useful for clustering real VAF data. Note that calculation of ' 1 and ' 2 norms for the SciClone cluster means would result in 2.4816 and 0.1823, respectively. However, because the number of SciClone clusters is only 4, these numbers cannot be reasonably compared with the ones calculated for the trees in.
i86
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.1 AE 5.1 10.1 AE 4.5 Note: Bold face text indicates best performance. Fig. 4. A violin plot for the number of clusters output by Rec-BTP, SciClone, PhyloSub where the top tree is considered, and PhyloSub where the tree, among the top ones, with the minimum number of nodes is considered. The y-axis shows the number of nodes in each tree, while the histogram in each violin plot corresponds to tree sizes of different experiments i84 I.Hajirasouliha et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
DISCUSSION In this article, we provide the first rigorous combinatorial formulation of the problem of inferring the composition of tumor subpopulations constrained by a tree in a single tumor sample from the variant allele frequencies (VAFs) of somatic mutations. In our formulation, we introduced a novel definition of the BTP and the "-BTP. We showed that the problem of finding a BTP (and hence an "-BTP) is in general NP-complete; however, we derived an approximation algorithm for a related problem, maxBTP. We developed a recursive algorithm for the "-BTP that works well in practice and showed the advantages on this algorithm on simulated and real sequencing data. These results show the utility of the BTP, but also suggest additional areas of further investigation. In particular, it would be interesting to combine the clustering of VAFs and the construction of the BTP into a single model. While there has been some work to combine these two steps using a machine learning approach (Jiao et al., 2014), the complexity of the corresponding inference problem is unknown. In our tests, we were unable to obtain satisfactory results using this model, suggesting there is room for additional improvements. One possible direction is to use MCMC or other sampling approaches over the space of BTPs, perhaps combining this inference into a graphical model that better models the features of real sequencing data [e.g. as used in pyClone (Shah et al., 2012; Roth et al., 2014)]. Finally, the extension of the BTP and related approaches to multiple samples from the same tumor (taken at the same or different times) will be increasingly useful as such data become available.
