Motivation: Detection of protein spots in two-dimensional gel electrophoresis images (2-DE) is a very complex task and current approaches addressing this problem still suffer from significant shortcomings. When quantifying a spot, most of the current software applications include a lot of background due to poor segmentation. Other software applications use a fixed window for this task, resulting in omission of part of the protein spot, or including background in the quantification. The approach presented here for the segmentation and quantification of 2-DE aims to minimize these problems. Results: Five sections from different gels are used to test the performance of the presented method concerning the detection of protein spots, and three gel sections are used to test the quantification of sixty protein spots. Comparisons with a state-of-the-art commercial software and an academic state-of-the-art approach are presented. It is shown that the proposed approach for segmentation and quantification of 2-DE images can compete with the available commercial and academic software packages. Availability: A command-line prototype may be downloaded, for non-commercial use, from http://w3.ualg.pt/~aanjos/prototypes .html. Contact:
INTRODUCTIONDeveloping new bioinformatics tools, both computational and experimental, such as those for membrane protein type prediction (), protein subcellular location prediction (), drugtarget interaction prediction (), substrateenzymeproduct triad network prediction (), and so on, can timely provide very useful information and insights for both basic research and drug development and hence are widely welcome by the science community. Using image feature or graphic approaches to study biological systems is currently a hot topic in the biological and medical science because it can provide useful intuitive insights, as indicated by * To whom correspondence should be addressed. many previous studies on a series of important biological topics such as enzyme-catalyzed reactions (), protein folding kinetics and folding rates (), inhibition kinetics of processive nucleic acid polymerases and nucleases () and others (). These kind of approaches are also of great importance in the field of proteomics (). The present study is an attempt to propose a new approach for the segmentation and quantification of two-dimensional gel electrophoresis images (2-DE). The proteome was originally defined as the protein complement of the genome (). The proteome is complex and highly dynamic, since the proteins present in a sample will depend on e.g. the tissue, cell, organelle and/or development stage analyzed. Analysis of proteomes requires techniques that can simultaneously separate thousands of proteins in complex mixtures. Classical proteome analysis is based on separation of proteins by 2-DE, a technique originally described decades ago (O'), which has since been a subject to continuous developments enabling high resolution and reproducibility. In the first dimension of 2-DE, proteins are separated by isoelectric focusing during which they migrate along a pH gradient to their isoelectric point (pI). The second dimension separation, perpendicular to the first, separates proteins by sodium dodecyl sulpfatepolyacrylamide gel electrophoresis (SDSPAGE) according to their molecular size. 2-DE is unique in its ability both to resolve differently modified forms of the same gene product in separate spots, facilitating analysis of protein posttranslational modifications, and to enable simultaneous analysis of synthesis and amounts of hundreds of proteins in the same gel. Thus, 2-DE is a widely used and important tool in proteome analysis (). In a typical 2-DE-based proteomics experiment, aimed at detecting changes in the proteome related to a specific treatment, several biological replicates each for treated and control samples are separated on 2-DE. Proteins on the gels may be visualized by one of many staining techniques (e.g. Coomassie blue dye, silver staining, fluorescent dyes, radiolabeling). In 2-DE, image analysis software is required for objective and quantitative comparison of 2-DE spot patterns, and several software packages are commercially available. Usually, 2-DE image pipeline analysis consists of: @BULLET spot detection; @BULLET alignment of multiple 2-DE images; and @BULLET quantification of protein spots.
Segmentation and quantification in 2-DGEIdeally, the analysis should involve minimum manual edition/supervision, which is both labor intensive and introduces subjectivity to the analysis. However, each stage is subject to complications due to the nature of the 2-DE technology. Protein stains have different detection limits, posing the problem of determining the threshold for spot detection. Due to the highly complex nature of biological samples, in most cases, thousands of protein forms will be present in a protein extract, and only the most abundant of these will be detected as spots on 2-DE, the remainder of which will be part of the background. Despite the high resolution of 2-DE, protein spots will often overlap partly or completely. Therefore, 2-DE spots are rarely of uniform, well-defined shape. Technical artifacts, streaking, either horizontal or vertical, can also disturb spot shape. Staining procedures and dust particles may give rise to background speckles. Such features of 2-DE images represent challenges for spot detection and quantification software.
AUTOMATIC ANALYSISSegmentation of the image is one of the most important steps in the computational analysis of 2-DE gels. Background and foreground are separated in this step, and areas in the gel will be accounted as belonging to the protein spot or discarded as background. Because all the remaining steps rely on the quality of the segmentation step, it is extremely important that this separation is performed as accurately as possible. Early approaches () for spot detection and gel segmentation involved the use of Laplacian of Gaussian techniques (LoG). LoG techniques are extremely sensitive to noise requiring an aggressive noise pre-filtering, which may result in the elimination of the weakest protein spots. Nowadays, the most popular technique for spot segmentation is the Watershed Transform (WST ) (). The WST is a technique used for more than 30 years with its origin in the field of mathematical morphology. It is a very powerful tool for image segmentation. Although computational power is not an issue in the present, there are other issues that prevent the WST from being an optimal approach. These will be addressed in the next sections.
Watershed transformFrom the different algorithms () for the WST, watershed by immersion simulation is one of the best for dealing with image plateaus. A plateau is an area where the neighbors of a pixel have the same gray level. It is important that the chosen algorithm is able to properly handle plateaus because, in this way, there is no need to transform the images being analyzed in lower complete images (). Vincent and Soille define a recursive algorithm for the computation of the WST by immersion simulation. For more details, please see Vincent and Soille (1991). Traditional approaches using the WST involve the use of the direct application of the WST on the, previously smoothed, image. Other approaches apply the WST on the gradient magnitude of the image. Both techniques are discussed in the next subsections.
Direct WSTThe WST 'sees' the image as a topographical surface so, the idea behind the WST by immersion is to simulate a flood of the topological surface, with water flowing from the regional minima of it. A dam is built whenever water coming from different catchment basins meet (see). The catchment basins, or simply basins, are the partitions in which the WST breaks the topological surface. At the end of the flooding process, the set of dams are the watershed lines or, simply, the watersheds. The WST presented by Vincent and Soille does not produce complete watershed lines. Thus, the result of this transform is post-processed in order to get the complete watershed lines. The result of applying the WST directly to a 2-DE image is shown in. It is noticeable that the resulting watershed lines are dividing the image in catchment basins that do not represent exclusively the protein spots. There is a lot of background included in each catchment basin. Moreover, there are basins that have no protein spots at all.
WST of the gradient magnitude Let fbe the gel image being processed. Applying the WST to the gradient magnitude of f is another typical approach. The gradient magnitude of f may be defined as:vs. 6shows that there is a quite good definition of the protein spot contours. One of the problems from this approach is that the resulting image is over-segmented due to the high sensitivity of the  f , resulting in excessive minima from which the flooding process starts. It is common to apply a threshold defining the minimum gradient value to solve this problem. However, this is inefficient because over-segmentation will still remain in some areas, and in some other, correct segmentation will be compromised (dos). If holes were drilled on the topological representation of the  f , and only in the desired minima (the center of each spot, in this case) and on the background, the flooding would only occur from those locations, and the watersheds would only be built at the border proximity of the desired objects. This is known as Marker Controlled Watershed Transform. The markers can be set Immersion of surface.Water flows through the minima. Watersheds as brick walls.
A.dos Anjos et al.by, for example, using the mouse pointer. Nevertheless, on 2-DE images, it is impractical to mark all the spots manually due to the great number of spots in each gel and the great number of gels usually involved in an experiment. Therefore, automatic detection of quality markers is extremely important.
Other approachesObviously, commercial packages, such as Progenesis Samespots (Non-linear Dynamics), PD-Quest (Bio-Rad) and Melanie (GeneBio), are, or became closed source, preventing a proper analysis and comparison of their approaches with academic approaches. In these cases, the only comparison that can be made is in terms of visible results.proposed a method for automatic detection of markers that consists of extracting minima from the low frequency components in the morphological gradient of the image. The h-minima transformation is used for that purpose. This transformation requires a parameter for minimum depth to be accounted and, although the gradient of the image is previously smoothed by a Butterworth low-pass filter of order 2, some valid regions, that have less depth than spurious ones, are inevitably destroyed. Recently, Morris et al.The window sizes used in defining the pinnacle proximities, and in the spot quantification are manually defined parameters.
PROPOSED TECHNIQUEWhen the gel images suffer from high-frequency noise, as is usually the case, a convolution of the image with a low-pass filter will increase the quality of the results. The images used in this study were pre-filtered by a Gaussian kernel (0.0 <  4.5), and this is the only pre-processing needed in order to obtain good results using the proposed method.
Initial watershedAs mentioned in Section 2.1.1, the basins delimited by the watersheds include a lot of background surrounding the protein spots. Also, there are many areas that do not contain a spot (see Section 2.1.1). Even if the result of the segmentation performed by the direct WST of f is not the intended result, a lot of useful information can be extracted from it that may be used for further segmentation. For example, a very important piece of information provided by the direct WST is that there is only one protein spot in each of the basins. This may not be entirely true due to saturation, limitations of the scanner or even due to the limitations of the staining methods of the gel. When two saturated spots are partially overlapped, a separation by the WST will not occur. That is a problem that can be solved afterward (e.g. by watershedding the distance transform) and it is not in the scope of this article. Completely overlapped spots are impossible to separate using current image processing techniques. In these cases, only running the sample through a narrower gradient gel, or cutting the spot from the gel and submitting it to mass spectrometry analysis, will allow to resolve the overlapping proteins. Thus, from now on, it will be assumed that each basin contains only one protein spot.
Automatic basin validationA great number of the basins without any protein spot may be rejected by setting a threshold for minimum spot area. All the basins that are smaller than the minimum spot area are ignored in the subsequent steps. The remaining invalid basins cannot be discarded as easily. Theoretically, the lines of the initial watershed are crossing only the background. Given this, a synthetic background b is generated by interpolation of these watershed lines, providing an extra layer of validation. Linear interpolation is used horizontally and vertically, then the average between these two interpolated backgrounds is used to produce the final synthetic background (see Supplementary Appendix A). For a better approximation of the possible real background, one can interpolate the watershed lines in other directions and, finally, calculate the average. Bi-linear, bi-cubic or other orders of interpolation can be used for a more accurate background synthesis. Although it would produce better results for the possible background, the drawback is that it requires more computational power with minimal advantages. Lieber anduse another possible approach for background approximation, where a sequence of polynomial fittings and subtractions are performed iteratively. Using the generated background, the validation of the basins is performed in the following way:be the set of all basins, where n is the number of basins present in image f. Also, let b = n i=1 b i , be the synthetic background, with b i being the connected component corresponding to the area of basin g i. After the generation of the synthetic background b, the decision of whether or not a basin contains a protein spot can be done by comparing the difference between the SD  of each basin g i and the SD of each of the respective areas b i of the generated background b, in the following way:False, otherwise.where s(i) is a boolean function that indicates if basin g i contains a valid protein spot or not.shows how sensitivity to protein spot detection may be controlled using different values of . It can be seen that the sensitivity to spots decreases as the parameter  grows.
Placing the markersAfter the valid basins are selected, holes are 'drilled' in the topological surface of  f . It is clear that, the image of the  f should be pierced at the same position as the center of each protein spot existing in image f. The center of the spot is usually the minima of the component but, due to the existenceof plateaus and, in some cases, the minima being placed side by side with the watershed lines, another approach is to apply a simple regional threshold (global with respect to the basin) to each of the valid basins and, then, find the centroid of the resulting component. Then, the centroid may be used as a marker of the spot center. It is not extremely important that the marker is set precisely at the center of the protein spot, as long as the marker is not placed on, or outside the borders (the watershed lines to be found) of the object.
Segmentation and quantification in 2-DGE
Final watershedThe WST is used again but, this time, to flood the surface of the  f image from the center of the protein spots and from the watershed lines of the initial WST. Now the water coming from different sides meets at the top of the 'craters' that represent the edges of the protein spots in image f. As there is a great number of other minima produced as result of the sensitivity to noise of the  f image, and there is no such thing as WST from minima, the image has to be transformed in such a way that the only existing minima are the ones pointed by the markers, that is, the watershed lines of the initial WST and the markers of the valid protein spots. The solution is to morphologically reconstruct the  f surface by minima imposition. This technique consists of reconstructing a mask image from a marker image (See Supplementary Appendix B). Let R v (u) be the reconstruction by erosion of a mask image v from a marker image u with domains D u = D v and u  v. Let M be the set of markers that identify valid spots, and h max be greatest possible intensity level allowed by the image in use. Let us use  f as the mask image, and the marker image f m be defined for each pixel p as:The reconstruction R is now performed by erosion of the marker image f m with respect to the mask image  f . In some situations, two or more distinct minima may fall within a plateau of  f at the gray level 0 (), so reconstruction should be made with respect to the image (  f +1). As this may violate the requirement that (thus demanding the use of self-dual reconstruction, the final mask is defined as (  f +1)f m , where  is the point-wise minimum operator. The watershed lines WS, that represent the edges of the protein spots, are the lines resulting from applying the WST in the following way:The final result is presented in. As can be seen, if compared with the initial watershed in, or the watershed of the gradient magnitude of f in, there is a great improvement in the segmentation of the image. Moreover, the segmentation was performed without the intervention of the user to select and place markers on the protein spots existing in the image.
Spot delineationThe method described in this article for spot detection and delineation finds a closed curve around the spot. The position of this curve is where the spot has a second-order derivative of zero. Some algorithms use the integrated density inside the delineation curve as a measure of spot volume. Although consistent this clearly underestimates the true spot volume. Others try to normalize the spots to give a less biased estimate of spot volume. On the other hand, this may be sacrificing variance. Here, we propose to use a property of the 2D Gaussian as a possible normalizing factor. For a 1D Gaussian, the points with second-order derivative equal to zero are called the deflection points. These occur exactly one SD away from the mean. This is illustrated inwhere the area under the curve between the deflection is seen to be 68.27%. For a 2D Gaussian, deflection points become a curve, namely a circle or an ellipse. In, a 2D Gaussian has been truncated at the deflection curve. The resulting volume corresponds to 39.35% of the full 2D Gaussian. For a spot in a 2-D electrophoretic gel, a simple way to estimate the volume of the full spot is by multiplying the volume found by the method described in this article by the constant 1 0.3935 or 2.54. Nevertheless, as protein spots only in very rare cases represent closely a 2D Gaussian (), this is an operation that may be considered controversial. Therefore, we leave the choice of normalization or not up to the user.
RESULTSTests were performed in order to assess the quality of the proposed approach. A state-of-the-art commercial software for 2-DE analysis and a recent academic approach were used as base of comparison. The chosen commercial software was Progenesis Samespots (), a very well-known tool in the field of proteomics. As for the academic approach, we used Pinnacle (). When analyzing images derived from biological samples, it is always necessary to validate detected spots manually to avoid inclusion of the background noise. In this study, the spots detected by any software in the whole set of images were manually checked by an experienced proteomics researcher and defined, based on experience, as protein spots ('valid positives'), or as 'false positives', resulting from staining artifacts giving rise to background noise or to erroneous definition of spot boundaries because of the overlapping spots.
DetectionFor evaluation of spot detection, five gel sections of varying quality were used (seein the Supplementary Appendix c), each of which contained 100250 spots. It is important to underline that Gel #5 was of extremely low quality, having a lot of noise (see(e) in the Supplementary Appendix c). In Progenesis and in the proposed approach, the spots were thresholded, by size, in two ways. First, the area (number of pixels) of the smallest proteinspot, in each gel, was chosen as a cutoff filter in both Progenesis Samespots and the proposed approach. The idea behind this option was to minimize the false positive spots. The selected cutoff filters used for gels 15 were of 2, 7, 7, 7 and 4 pixels, respectively. In Pinnacle, as there is no parameter to define a threshold for the minimum spot size, the used parameters were the default. The comparison of the results can be observed in. In the second test for spot detection, the 'optimal' cutoff filter was manually identified for Gel #1, separately for Progenesis Samespots and for the proposed method. The same filter was then applied to
A.dos Anjos et al.
Page: 373 368375
Segmentation and quantification in 2-DGEall gels. This was of 199 pixels for Progenesis Samespots and 6 pixels for the proposed approach. As for Pinnacle, the parameters 'Minimum Pinnacle Size (MPS)' and 'Neighborhood Size (NS)' were tuned in the following way: Gel #1: MPS = 0.1; NS = 10; Gel #2: MPS = 0.4; NS = 5; Gel #3: MPS = 0.5; NS = 8; Gel #4: MPS = 0.2; NS = 15; Gel #5: MPS = 0.6; NS = 8. The result of segmenting the gels with this parameters is presented in. When using the real size of the smallest valid spot in the gel as a cutoff filter, Progenesis Samespots overestimates the number of possible detected spots as presented in. This is due to the fact that Progenesis Samespots exaggerates the area of the spots, in part, as result of using common spot areas for all gels. When overestimating, one has to manually remove a lot of false positives, which is laborious. If the cutoff filter is adjusted to fit the individual program, the two packages will perform roughly the same (See). Asshows, in Gel #5, the proposed approach will detect a number of false positives that is near to Progenesis result. As stated 1-D Gaussian and deflection points.(a) 2-D Gaussian truncated at the deflection curve.(b)before, this was a very low-quality gel with a lot of noise and the cutoff filter was the same that was defined for Gel #1 which was of 6 pixels of area.vs.-3
QuantificationTo evaluate the quantification of spot volumes, three gel sections, originated from two biological replicates of barley leaf extracts, were used. The plants were grown in the presence or absence of nitrate in order to induce changes in their protein profiles. The volumes of 20 randomly selected spots were quantified using Progenesis, Pinnacle and the proposed approach, and the fold-change between samples, grown with and without nitrate, was determined. The results are presented in the table provided as Supplementary Material. When using Progenesis Samespot, the user selects a reference gel against the rest of the gels that are aligned. In this case, each replicate gel was used in turn as the reference, to test whether similar results would be obtained. The analysis conducted by Progenesis Samespot depends on which gel is chosen as reference (ProgA and ProgB), whereas Pinnacle and the proposed approach stayed consistent. It is noticeable from looking at the results of Tables 1 and 2, that in any of the situations Pinnacle will miss a lot of valid spots. All the presented methods obtain different results, which is not a surprise, as reported by, where it is shown that it is common that different software usually present different results, and, as the same source mentions, different versions of the same software brand also disagree in the presented results.vs.-3
DISCUSSIONWhen comparing protein profiles with Progenesis Samespot, using a reference gel that defines the spot area for all gels, the end-result will'ProgA' and 'ProgB' are the results from progenesis with different gels chosen as reference. N/A means that the spot was not detected on any of the gels.  and , mean that the spot was only detected in the first or the second gel, respectively. depend on which gel is chosen as reference. In Progenesis, it is most likely that the user chooses the gel with most round uniform spots, because it will be easier to align this to the others. The problem arises when the other gels/spots vary in quality with respect to shape and size. Having defined the spots' areas in the 'best' gel, and using these definitions in the other gels, if the analysis is repeated with a new reference gel, different results will be provided to the user, as demonstrated by the results presented in. Since the proposed approach independently defines the spot area in each gel, the program is more likely to give less-biased end-results for being reference-gel independent. Another issue is how the spot area is detected. Progenesis uses spot and background to define the spot area. Pinnacle centers a fixed size window on the pinnacle of the spot. The proposed approach defines the spot area from near the border of the spots and, therefore, avoids potential problems with less uniform spots in between gels. Furthermore, by defining the spot area from the border of the spot, it is easier to get at a more realistic estimate of spots placed close to each other as well as partially overlapping non-saturated spots, which will be present in most experiments. In comparison with the other software packages tested, the proposed method is shown to be able to detect the majority of validated protein spots in a series of gel images, while at the same time minimizing the number of false positives. This represents a considerable improvement in terms of the time needed for manual validation and correction of spot boundaries, a common bottleneck in proteomics studies. When analyzing samples based on biological material with unknown absolute quantities of individual protein forms, it is not possible to say which is the 'true' answer. Other software packages also give slightly different results, but again, it is not possible to say from this type of analysis which is the 'correct' answer. A complete gel image is included in the support data, segmented by Progenesis Samespot, PDQuest and proposed method for comparison. It is noticeable that PDQuest is the result that requires more user intervention and manual editing, as also witnessed by other studies (). In summary, this article presents an efficient way of automatic detection of quality markers to use in conjunction with the Marker Controlled Watershed Transform or even with the Image Foresting Transform () for the segmentation of 2-DE images and quantification of protein spots. Also, the presented technique can be used in the segmentation step for approaches that use common spot boundaries such asor even Progenesis Samespots. The results can also be used by gel alignment for gel alignment methods such as the one presented in. Post-processing the results produced by the method proposed in this article, using the domain expertise, will allow the correction of most of the discussed shortcomings but, as stated before, the topic of postprocessing is not in the scope of this article. This article contributes to the field of 2-D gel-based proteomics with an alternative approach that may compete with Progenesis Samespot and other important academic approaches in the detection of spots and the estimation of the spot volume for gel comparison.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
