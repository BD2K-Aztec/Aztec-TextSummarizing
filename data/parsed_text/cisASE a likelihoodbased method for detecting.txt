Motivation: Allele-specific expression (ASE) is a useful way to identify cis-acting regulatory variation , which provides opportunities to develop new therapeutic strategies that activate beneficial alleles or silence mutated alleles at specific loci. However, multiple problems hinder the identification of ASE in next-generation sequencing (NGS) data. Results: We developed cisASE, a likelihood-based method for detecting ASE on single nucleotide variant (SNV), exon and gene levels from sequencing data without requiring phasing or parental information. cisASE uses matched DNA-seq data to control technical bias and copy number variation (CNV) in putative cis-regulated ASE identification. Compared with state-of-the-art methods, cisASE exhibits significantly increased accuracy and speed. cisASE works moderately well for datasets without DNA-seq and thus is widely applicable. By applying cisASE to real datasets, we identified specific ASE characteristics in normal and cancer tissues, thus indicating that cisASE has potential for wide applications in cancer genomics. Availability and Implementation: cisASE is freely available at
IntroductionAllele-specific gene expression (ASE) refers to the differential expression of two alleles in a diploid genome. ASE is primarily a result of the associated cis-element variation and allele-specific epigenetic modifications (). Germline ASEs are usually associated with the existence of regulatory elements, which exert a pronounced effect on human phenotypic polymorphism and common diseases. Somatic ASEs (ASEs of somatic mutations) in tumors are often genetically linked to tumor drivers. Thus, ASE studies provide an opportunity for the development of new therapeutic strategies that activate beneficial alleles or silence mutated alleles at specific loci (). Next-generation sequencing (NGS) allows for the genome-wide identification of ASE (); however, several problems exist. The first problem is technical and intrinsic allele bias, which we and others have previously demonstrated (). For example, reads carrying single nucleotide variants (SNVs) are less likely to be correctly mapped than those carrying reference genotype (). Another example is that, a large proportion of previously identified ASEs, especially in tumor samples, have been found a result of copy number variations (CNVs) rather than cis-regulation (). The second problem is that gene-level ASE detection usually requires phased-SNVs or parental genomes (), which are usually not available. Although methods to phase singlenucleotide polymorphisms (SNPs) into individual haplotypes exist (), these methods cannot be applied to somatic mutations in tumors. The third problem relates to testing ASE with statistical confidence. Two simple statistical methods, i.e. binomial and chi-square tests, have been frequently used in SNV-level ASE detection (); however, these methods do not make full use of the information of these complex sequencing datasets. Although several tools have been developed for ASE detection, none has addressed all of these concerns (). To overcome the problems outlined above, we proposed a new computational method and developed a software tool, cisASE, based on a likelihood ratio test. cisASE uses DNA-seq data to make site-by-site adjustments for RNA allele imbalance assessment to reduce the effects of technical bias and CNV, and reports ASE putatively caused by cis-regulation. cisASE also considers the base quality of each base to reduce the influence of sequencing error. We tested cisASE on both simulated and real datasets, and compared it with other methods (). cisASE exhibits significantly improved accuracy and computational speed compared with existing methods. We applied cisASE to public colon tumor datasets, and observed several important features, i.e. germline ASE hotspots of human leukocyte antigen (HLA) loci, cancer somatic ASE genes in focal adhesion and extracellular matrix (ECM)receptor interaction pathways. These findings revealed a landscape of germline and somatic ASE in colon tumors and highlighted broad applications of our cisASE method in ASE detection.
Materials and methods
Simulated dataWe selected normal tissue data (n  46) of a human colon dataset (n  92) () as the basis for generating a simulated dataset (Supplementary Material) because this dataset contains high-quality matched DNA-seq and RNA-seq data with high sequencing depth. The dataset was also used to test our method (described in the following sections). First, fold changes of adjusted RNA allele counts of the real data were calculated using the following equation,where n is the number of SNVs for a specific feature (SNV, exon or gene). The distributions of log2 fc and log2 DNA depth were then modeled using Laplace (Supplementary) and normal distributions, respectively. For each simulated SNV, its DNA sequencing depth was drawn from the normal distribution, and its RNA sequencing depth was sampled from the real data. Both DNA and RNA reference allele counts were assumed to exhibit a binomial distributionr $ Bn; p, where n is the sequencing depth of DNA-seq or RNA-seq, and p is the frequency of reference allele. To simulate data without CNV (non-CNV data), DNA reference allele counts were subjected to a binomial distribution with parameter p estimated from real DNA-seq data. To mimic the proportion of ASEs in real data, we sampled fc for each SNV from the above Laplace distribution. When the sampled fc exceeded a certain cutoff (1.5, 2, 3, 4 or 5), we generated a true positive ASE SNV, whose RNA reference allele count was subject to a binomial distribution with parameter p determined as the fraction of DNA reference allele after adjustment by the sampled fc (illustrated in Supplementary). Otherwise, we generated a true negative site with the parameter p of the binomial distribution setting as its DNA reference allele fraction. We simulated 1000 genes for each fc cutoff, and the number of SNVs in each gene was also sampled from the real data. To simulate data carrying CNV (CNV data), DNA reference allele count of each SNV was assumed to have a binomial distribution, with a DNA ratio of reference (R) and alternative (A) alleles n(R):n(A)2, 3 or 4, for DNA copy numbers of 2, 3 and 4, respectively. Next, to assess the performance of cisASE at different sequencing depths, we simulated another non-CNV dataset with fixed depth (1020, 2030, 3040 and 4050) and fixed number of SNVs per gene (1, 2, 3, 4 or 5), resulting in datasets with 125 strata (Supplementary Material).
Real sequencing datasetsWe collected three real sequencing datasets to test cisASE. First, we obtained RNA and Exon sequencing data of 46 pairs of matched human colon tumor-normal samples from the European Genome-Phenome Archive (EGA) under accession number EGAS00001000288 (). Second, RNA-seq and DNA-seq data for a well-studied individual NA12878 were obtained from the Gene Expression Omnibus (GEO) under accession number GSE30401 () and the ENA with accession number ERR194147, respectively. The phased genomic variants of individual NA12878 in hg19 coordinates were obtained from Rozowsky et al. (2011). Additionally, a mouse dataset including exon and RNA sequencing data was downloaded from the European Nucleotide Archive (ENA) under accession numbers PRJEB5321 and PRJEB5320, respectively (). DNA-seq and RNA-seq reads were mapped to the reference genome using bowtie2, and all duplicated reads were removed to avoid the effects of polymerase chain reaction (PCR) duplication.
MethodsThe allele ratios of reference and alternative alleles in normal samples deviate from expected value (1:1) (Supplementary) because of technical bias in strand capture, sequencing process and mapping. Additionally, in cancer samples, because of somatic structure variations, e.g. CNV, the bias is more severe (Supplementary). To detect putative cis-regulated ASE regardless of bias and CNV, we use DNA-seq data for site-by-site adjustment based on the assumption ofthat technical bias in the measurement of the allele ratio for DNA is the same for RNA. cisASE pipeline is illustrated in, including following steps:(1) pileup files are generated from DNA-seq and RNA-seq data (mapped bam files after duplication removal) using samtools (Supplementary Material) (The pileup files are submitted to cisASE, and log-likelihood ratio score (LLR) for each feature (SNV, exon or gene) is calculated. (3) For each input sample, the null distribution of LLRs is simulated from the input itself, and the LLR cutoffs corresponding to alpha levels of 0.05 and 0.01 are determined from the null distribution. (4) The LLRs are compared with a cutoff at a specific alpha level to determine whether the features are ASEs.
Model for SNV-level LLR calculationWe take standard pileup files as input and calculate the probability of observing base b i on read i (i  1.. .d, where d is the coverage of base b i ) at each SNV following,where r and a refer to the reference and alternative allele respectively. f refers to the fraction of the alternative allele. e i is the probability of errors in that base call (each base has an associated Phred-like quality score, q i , where e i  10 q i =10 ). We assume that the sequencing errors are independent for each read and that substitution errors are uniformly distributed and occur with probability e i /3. To assess allelic imbalance, we explain the observations with the following two hypotheses,where DNAref/alt and RNAref/alt represent the allele read counts of the reference and alternative alleles in the DNA and RNA sequencing data, respectively. ASE detection is performed by comparing the likelihoods of two hypotheses. When the LLR, as defined below, exceeds a decision threshold, we identify the SNV as an ASE.2.3.2 Model for gene/exon-level LLR calculation For genes harboring n informative heterozygous SNVs, the hypotheses are modified as follows,where DNAhap1/2 and RNAhap1/2 represent the allele counts of the haplotype 1/2 allele. We implemented the pseudo-phasing process applied byin cisASE. This process estimates the major and minor haplotypes by assigning SNV-level alleles with higher RNA read counts to the 'major' haplotype (hap1) and those with lower RNA read counts to the 'minor' haplotype (hap2). This process is applied to both gene-level and exon-level ASE detection when no phasing information is provided. Alternatively, users can provide their own phasing information to cisASE. One problem in gene-level ASE detection is that alternative splicing can affect the ASE identification when skip efficiency differs between two haplotypes. cisASE can accept annotation files containing labels for constitutive exons (parameter  C1) and considers only SNVs within constitutive exons when measuring gene-level ASE. A chi-square test is applied to check the consistency of the allele ratios for all SNVs within a gene. For multi-SNV genes, a small P-value from the chi-square test indicates that individual SNVs differ significantly in their allelic ratios. This inconsistency can arise because of differences in ASE between various transcript isoforms of a gene or counting errors for SNVs prone to technical bias. Candidate ASE genes with this inconsistency (e.g. P-value of the chi-square test <0.05) should be filtered out by users.
Generating a null distributionTo determine a decision threshold to reject the null hypothesis, we perform the following simulation to calculate the threshold for a specific significance level a. For each input dataset, we simulate paired DNA and RNA data from the dataset itself. The simulated DNA and RNA sequencing depths are randomly sampled from the input. Read counts of both the simulated DNA and RNA reference alleles are assumed to follow a binomial distributionr $ Bn; p, where p is the average DNA or RNA reference allele frequency of the input. Base qualities and the number of SNVs in each feature (i.e. SNV, exon or gene) are also sampled from the input, and sequencing errors (0.001 errors per base) are added to the simulated reads. The LLR of each simulated feature is calculated according to Equation (4).. Overview of cisASE algorithm. Mapped RNA-seq and DNA-seq data are piled up using samtools. LLR of the null and alternative models is calculated for each feature, i.e. SNV, exon or gene. Simulated DNA and RNA allele counts are generated from the data to produce a null distribution of the LLR, which is used to define an LLR cutoff with respect to a particular significance level. The LLR of each measured feature is compared to the LLR cutoff to determine whether it is an ASE
Applications of cisASE in RNA sequencing dataBy repeating the simulation S times, we estimate a null distribution of the LLR and determine a cutoff corresponding to significance level a according to Equation (6),The default simulation repeat time S is set to 2000, which is reasonable for obtaining a robust cutoff (Supplementary; discussed in the Supplementary Material), and the LLR cutoffs at alpha levels of 0.05 and 0.01 are provided.cisASE can also be applied to datasets without parallel DNA-seq data. In this situation, the preexisting DNA bias can be set by users; otherwise, the pre-existing DNA bias is assumed to be the same as the mean of the RNA bias. In addition, when simulation is disabled by users, we recommend SNV-level LLR cutoffs of 0.85 and 1.47 and gene-level LLR cutoffs of 0.82 and 1.50 for alpha levels of 0.05 and 0.01, respectively, based on a simulation of 92 sets of high-quality sequencing data (). To test the robustness of the recommended LLR cutoff, we applied it to Seshagiri's data () and NA12878, and used the recommended LLR and the LLR calculated from the dataset itself as the cutoff to define ASE genes. This process revealed 4.2 and 2.3% differences in the Seshagiri's data and NA12878, respectively (see the Supplementary Material for details), indicating that, with the recommended LLR, cisASE has acceptable performance.
Implementation of the chi-square testWe also implemented chi-square test, a widely used test that uses count information of both DNA and RNA for ASE identification (), in cisASE. We adjust the DNA and RNA counts for the chi-square test using base qualities. The adjusted counts for each base is defined as 1  e i , where e i is the error rate of base i. In the absence of DNA input, we simulate the DNA reference and alternative allele counts for each SNV from the RNA sequencing depth and assume a DNA bias as mentioned in the Section 2.3.3. The allelic counts are summed for each haplotype for multi-SNV genes and exons for testing.
Method evaluation
Evaluation in simulated dataTo evaluate the effectiveness of taking DNA-seq data as a reference for reducing bias, we ran cisASE with the following four settings, using simulated non-CNV data and compared the performance (and Supplementary): A. cisASE default (adopt site-by-site bias adjustment with DNAseq data); B. set no DNA bias; C. set DNA bias as the mean reference allele fraction of all SNVs in the DNA-seq data; and D. set DNA bias as the mean reference allele fraction of all SNVs in the RNA-seq data. The highest performance was achieved when using setting A. The performances of cisASE with settings B and C were similar (overlapping in) and inferior to that obtained with setting A. These results suggest that bias is a local event and global adjustment does not perform better than no adjustment. The performance was worst when we estimated DNA bias from RNA-seq data (setting D). Because of overdispersion () and uneven sequencing depth of RNA-seq data, allele bias in a small percentage of highly expressed transcripts may shift the mean bias away from 0.5, resulting in higher false positive and false negative rates. Therefore, we recommend running cisASE with setting B, in which the DNA reference allele fraction is set to the expected value (0.5), for experiments without matched DNA-seq data. Of note, in this case, users cannot distinguish between cis-regulated ASE and CNV-resulted ASE. We compared cisASE with MBASED (), which, to the best of our knowledge, is the only currently published ASE-detection method that allows for gene-level ASE detection without phasing information (Supplementary). We applied MBASED to our simulated data with its default settings. For simulated CNV data, cisASE substantially outperformed MBASED (). As illustrated in the table in, when a SNV is located in a CNV region with a DNA ratio of 3:1 and its RNA allele ratio is 1:1, MBASED produced a false negative result, whereas for an RNA allele ratio of 3:1, MBASED produced a false positive result. cisASE also performed better with simulated non-CNV data (). Additionally, the computational speed of cisASE was faster than that of MBASED. On average, for a sample with 3500 SNVs, the running time for MBASED was 460 min, and cisASE was seven times faster, i.e. 68 min. Next, we compared our method with the chi-square test. The results showed that, although the two methods exhibited comparable specificity, the sensitivity of cisASE was much higher than that of the chi-square test (Supplementary). We also measured the accuracy of the chi-square test relative to that of cisASE. cisASE outperformed the chi-square test in each stratum of the simulated data, especially when the fold change threshold of the simulated data was low (fc  1.5), indicating its superior performance in detecting mildly biased ASE and ASE at low sequencing depth ().
Evaluation in real dataWe assessed the performance of cisASE in paired human colon tumor-normal samples (). We randomly selected 16 of the 46 pairs of paired data to compare the methodsbecause some of the methods have speed limitations. Ideally, without technical and assessment bias, we would expect a balanced proportion of ASE SNVs over-expressing reference allele and alternative allele (0.5 versus 0.5). For ASE SNVs identified in the data, the proportion of ASEs over-expressing reference alleles was 0.50 when using cisASE and 0.67 when using MBASED () (). We also compared the performance of cisASE with and without DNA-seq data as an input for bias adjustment (). These results indicate that cisASE efficiently decreased the false positive results caused by pre-existing bias, especially bias toward the reference allele. Next, we applied cisASE to a mouse colon carcinoma cell line (). We identified 43 ASE SNVs with cisASE, covering all 31 SNVs identified by chi-square test at the same significance level (P-value  0.01). As demonstrated in Supplementary, for the SNV-level ASE detection, even for the most biased SNVs (fc  5), sensitivity of the chi-square test was not as high as that of cisASE until the sequencing depth increased to 40. Of the 12 ASE SNVs only detected by cisASE, 10 had sequencing depths less than 40 for DNA or RNA, and one had a sequencing depth less than 60. The remaining one had a chi-square P-value that fell slightly short of the chosen cutoff of 0.01 (Supplementary). These results were consistent with our conclusions based on the simulated data, suggesting that cisASE has higher sensitivity, especially in cases of low sequencing coverage. We further applied cisASE to a high-quality phased individual, NA12878, from the 1000 Genomes Project. First, we assessed the performance of cisASE with and without known phasing information. RNA and DNA sequencing data were pre-processed analogously to our previous dataset (Supplementary Material). Overall 2295 genes were tested, including 963 (42%) with >1 heterozygous locus. In total, 274 and 291 genes (Supplementary) were classified as ASE genes at a significance level of 0.05 with and without the known haplotype as input, respectively. Among these genes, 273 were shared. Similar to previous reports (), pseudo-phasing had a high recovery rate of the true haplotype, and 98.0% (950/963) of the multi-SNV genes were correctly classified by cisASE when no phasing information was supplied. These results indicated that cisASE is an accurate method, even without phasing information. We then compared cisASE with MBASED() and Skelly's method () (see the Supplementary Material for details). Skelly's method requires known haplotype data as input and incorporates DNA-seq information as the overall adjustment for bias. In this comparison, haplotypes were supplied to all three methods. A total of 274 (significance level  0.05, adjusted MAF ! 0.7), 114 (P 0.05, MAF ! 0.7) and 137 [posterior P(ASE) >0.95, posterior median MAF ! 0.7] ASE genes were detected by cisASE, MBASED and Skelly's method, respectively (Supplementary). cisASE identified 85% ASE genes reported. Distribution of the percentage of ASE overexpressing reference alleles in a real dataset. For each cancer (N  16) and normal sample (N  16), we calculated the percentage of ASE specific to the reference allele (ASE with overexpressed reference allele)Applications of cisASE in RNA sequencing databy MBASED and 64% of those identified by Skelly's method but was more sensitive (and Supplementary). Additionally, cisASE required much less computation time, i.e. 90 min compared to 360 min for Skelly's method and 660 min for MBASED.
Recurrent germline ASE and ASE hotspots in normal and tumor samplesIn the human colon dataset, we found that most ASE SNVs are sample-specific (Supplementary). Low-frequency ASEs in the population randomly distribute across chromosomes. However, some hotspots exist (Supplementaryand), e.g. HLA regions (Supplementary). MHC loci are some of the most genetically variable coding loci in mammals, including humans (). In normal tissues, polymorphisms in the HLA loci have been found to be associated with a large number of human phenotypic traits and common diseases (). In tumors, HLA is frequently altered in comparison to the tissue from which it originates (). Our identification of ASE hotspots in HLA loci indicated that the HLA loci are enriched with regulatory polymorphisms, which contribute to phenotypic polymorphism and disease in humans.
Highly overexpressed somatic mutant alleles in tumor samplesSomatic ASEs, which are caused by linked somatic events in the regulatory regions of genes or the somatic mutation itself, may contribute to tumor progression. Because of the high genetic heterogeneity of tumors, matched DNA-seq data are required to identify somatic ASEs with high accuracy. We observed that 75% of the somatic ASEs overexpressed their mutant alleles. The significantly up-regulated expression level of the mutant alleles (Fisher exact test P-value < 2.2e-16, odds ratio  2.99) suggests the existence of widespread selective pressure to produce more mutant proteins in tumors. Of the 25% somatic ASEs, which underexpressed their mutant alleles, 73% lost the mutant allele expression completely. This is possibly because potential tumor suppressors are involved in suppressing the expression of these somatic mutations. By mapping somatic mutations to genes, we found that genes with underexpressed mutant alleles are significantly enriched in focal adhesion and ECM-receptor interaction pathways (Supplementary). Abnormal behaviors of these two pathways have been reported to play important roles in cancer progression in many cancer types (), including colon cancer (). Our ASE study reveals detailed information about how somatic mutations in these genes affect gene expression and identifies possible therapeutic targets.
DiscussionIn this work, we present a novel flexible computational method, cisASE, to detect ASE at the SNV, exon and gene levels. cisASE makes full use of information from DNA-seq and RNA-seq data to achieve an unbiased estimation of ASE. By default, cisASE adopts a site-by-site adjustment for ASE identification by using the DNA allele ratio. This procedure reduces the artifacts from technical and mapping bias () and CNVs (), making cisASE efficient for detecting putative cis-regulated ASEs. In the absence of matched DNA-seq data, cisASE performed moderately well. Additionally, the implementation of a pseudo-phasing function in cisASE allows the incorporation of unphased SNV data into an individual exon, gene or isoform. To evaluate the performance of cisASE for ASE detection, we performed extensive analyses based on both simulated and real data from multiple resources, i.e. human and mouse colon tumor celllines and a phased 1000 Genomes Project individual. cisASE outperformed the chi-square test in terms of accuracy, especially for genes with low sequencing depth. Additionally, cisASE exhibits greatly increased accuracy and computation speed compared with other previous methods based on complex models. By applying cisASE to a panel of paired tumor-normal human colon samples, we identified HLA loci as the most significant 'hotspot' of germline ASEs in both tumor and normal samples. In tumor samples, somatic ASE showed widespread overexpression of mutant alleles, indicating oncogenic roles of the mutant genes. These results confirmed the ability of cisASE to detect tumorassociated ASEs.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Applications To demonstrate the application of cisASE, we applied it to a panel of 46 paired tumor-normal samples (Seshagiri et al., 2012). 4. 1 Higher cis-regulated ASE level in tumor samples For methods that do not use DNA-seq as a reference for bias adjustment, a high rate of CNV in tumor tissues (Shlien and Malkin, 2009) distorts the ASE detection results. For example, according to Mayba et al. (2014), the ASE genes identified by MBASED in tumor samples are mainly driven by large-scale genomic alterations, especially CNVs. However, the ASEs reported by cisASE should be unaffected by CNV. Applying cisASE to colon samples revealed that only 1% of the ASE genes in tumor samples are located within CNV regions (Fig. 7) and that the CNV genes are not significantly enriched in ASE genes (Fisher test P-value  0.273). This result validates the effectiveness of cisASE in identifying cis-regulated ASEs. By comparing tumor and normal samples, we found that tumor samples exhibited 1.8-fold-higher ASE rates than normal samples (P  9.961e-06). This result indicates that the cis-regulation of gene expression is more extensive in tumors.
