Motivation: Normalization is critical in DNA copy number analysis. We propose a new method to correctly identify two-copy probes from the genome to obtain representative references for normalization in single nucleotide polymorphism arrays. The method is based on a two-state Hidden Markov Model. Unlike most currently available methods in the literature, the proposed method does not need to assume that the percentage of two-copy state probes is dominant in the genome, as long as there do exist two-copy probes. Results: The real data analysis and simulation study show that the proposed algorithm is successful in that (i) it performs as well as the current methods (e.g. CGHnormaliter and popLowess) for samples with dominant two-copy states and outperforms these methods for samples with less dominant two-copy states; (ii) it can identify the copy-neutral loss of heterozygosity; and (iii) it is efficient in terms of the computational time used.
INTRODUCTIONCopy number alterations (CNAs) have been associated with many genomic disorders (). Insertion or deletion of DNA sequences can directly alter the gene expression levels, and thus potentially cause genetic diseases (). For example, in a St. Jude study of4200 B-progenitor and T-lineage acute lymphoblastic leukemia (ALL) patients, 450 recurring regions of CNAs were identified. In addition, many of these recurring CNAs were specific to different subtypes of ALL, associated with prognosis, indicating that resistance to therapy in ALL might be caused by specific genetic changes (). In another St. Jude study, deletion, amplification and other types of CNAs were found to be in 40% of B-progenitor ALL cases (). Facilitated by the Human Genome Project, the development in comparative genomic hybridization (CGH) array technology has made it indispensable for CNA study. Among many types of CGH arrays, the single nucleotide polymorphism-CGH (SNP-CGH) array is widely used because of its high resolution and its ability to provide genotype estimates (). Although advances in next-generation sequencing are rapidly changing the landscape of genetics, the SNP-CGH array offers a cost-effective way in CNA studies, complementary to next-generation sequencing (). In addition, the SNP-CGH array has advantages in voluminous, publicly available data and a wealth of data analysis tools. Integrative analysis of genomic data generated from different platforms requires SNP-CGH data of high quality. The raw signals from the SNP-CGH array are inherently noisy because of sampling and/or technical variation. To reduce such noise, the logarithms of signal intensity ratios between tumor and normal samples from the same individual are usually used for CNAs detection (). A large portion of the sampling variation may be removed this way because of strong similarities between paired tumor and normal samples. In addition, tumor/normal pairs are expected to be run in the same laboratory and in the same batch to remove experimental variations as much as possible. Loss of heterozygosity (LOH) describes the loss of normal function of one allele in a gene, and LOH detection plays an important role in discovering DNA segments that harbor tumor suppression genes (). Copy-neutral LOH (cnLOH) refers to duplication of one of the two alleles and concurrently loss of the other allele, so that there is no change in a DNA copy number. As a result, it is difficult to detect cnLOH by conventional copy number measurements. On the other hand, the methods for accurate cnLOH detection often require both tumor and control samples from the same patient. Many statistical models and algorithms have been proposed for CGH array-based CNA analysis (). Normalization is critical for obtaining biologically meaningful results. An appropriate normalization method should be able to substantially remove systematic variations, while signal changes because of biological alterations are preserved. Some of the early CGH data normalization methods directly adopt those developed for microarray gene expression, such as Quantile normalization, Rank-invariant set normalization, Lowess normalization and so forth (). A fundamental assumption in these algorithms is *To whom correspondence should be addressed.  The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com that the distributions of the log-signal intensities from all samples are the same. However, this assumption may not hold in a CNA study. For example, nearly all solid tumor cancers exhibit whole-chromosome gains/losses (), and the proportion of gain/loss probes in the tumor genome can vary substantially from sample to sample. These translate into substantial differences in distributions of log signal intensities of different tumor samples. Therefore, directly applying normalization algorithms developed for gene expression data might result in 'over-normalization' of segments of CNAs (van). To address this problem, several methods have been proposed specifically for CGH array normalization. For example, based on genotype calls and log-ratio of signal intensities, a reference alignment method identifies chromosomes in two-copy state, which are then used as internal references in normalization/alignment (). One problem in this method is that the number of reference chromosomes identified is usually small, and thus they might not represent the two-copy probes well. Another method, popLowess, identifies probes in two-copy state using k-means clustering on the segmented mean values, and subsequently normalizes the data by Lowess regression using probes identified as references (). The weakness of this approach lies in that only coarse separation can be achieved because of probe pre-selection, and that k-means clustering requires a pre-determined number of clusters. The ridge-tracing normalization method normalizes CGH data by applying ridgeline regression on the highest ridgeline of a 2D log-intensity distribution and then using the expectation maximization algorithm to centralize the copy number ratio. This method assumes that the most frequently occurring copy number probes correspond to the two-copy states (). More recently, iterative normalization strategies, such as ITALICS (for one-channel array) and CGHnormaliter (for two-channel array), have been proposed (). In both cases, segmentation is the key step, and the subsequent normalization depends on the results of segmentation. TumorBoost () was developed to normalize the allele B fraction in tumor, whereas total copy number signals are not normalized. In this article, we propose a new normalization procedure for SNP array data. This is motivated by the following reasons.(i) Although applying paired samples in experimental design could substantially reduce noise in data, estimating the true copy number is often complicated by other experimental and biological factors, such as imperfect dissection of the primary tumors, the existence of the multiple clones in the tumor cell population, ploidy of a sample, the spatial signal variation and so forth. These factors can reduce the expected signalnoise ratio (SNR) and make it difficult to accurately estimate the true underlying copy number (). As a result, the conventional segmentation methods such as circular binary segmentation (CBS) (), which works well in partitioning a SNP sequence into segments of the same underlying copy number, do not provide estimation of the underlying copy number for each segment. (ii) Almost all current normalization methods do not take into consideration the existence of cnLOH. Since the mean value of probes in a cnLOH segment may be slightly different (but not significantly) from the mean value of probes in segments with true normal two-copy state, it is difficult to identify and subsequently remove them from the reference probe set. Therefore, it is necessary to develop new strategies that have strong statistical power in distinguishing probes in two-copy state from those having CNAs and simultaneously take into account the existence of cnLOH. We will briefly present Affymetrix SNP arrays in the next section, and then describe the proposed algorithm in two parts. The first part is to partition probes into the segments of UMS (uni-modal state, defined in Section 2) or BMS (bi-modal state) using a Hidden Markov Model (HMM). The second part is to apply the CBS segmentation method on the piecewise average log-ratio (PAlog-Ratio, defined in Section 2.3) to separate probes in two-copy state and other even-number copy number states. The application of our method on a publicly available dataset, followed by a comparison of our method with two currently available methods, is presented in Section 3. At the end of the article, we discuss the advantages and limitations of our method and possible improvements.
METHODS
Affymetrix GeneChip Mapping 500 K arrayThere are several widely used SNP-CGH array platforms, including Affymetrix genome-wide human SNP Array 5.0, GeneChip  Mapping 500 K Array and Illumina Infinium whole-genome SNP array. In this article, we will focus on the Affymetrix GeneChip  Mapping 500 K array. But the method we are proposing can be applied to data obtained from other platforms as well. The GeneChip  Human Mapping 500 K Array Set consists of Nsp and Sty arrays. These two arrays are digested with NspI restriction and StyI restriction enzymes separately, each having the capacity to interrogate $250 000 SNPs. At the SNP level, each SNP is interrogated by 610 probe quartets, each of which is composed of a 25 base pair (bp) perfect match (PM) oligonucleotide probe and a mismatch (MM) probe for alleles A and B (). There are 2440 different 25 bp oligonucleotide probes per SNP. We first define the log ratios of the PM probes A and B for SNP i of the tumor and normal samples as,where T Aij and T Bij (C Aij and C Bij ) are the raw intensities of the PM probes A and B in the jth probe quartet for SNP i of the tumor (paired normal) sample, respectively. As explained in, we will only use the PM probe data in our method. Further, using the PM probes only will allow our method to be readily used on newer generations of SNP arrays, where only PM probes are included (). Genotyping calls for normal samples usually can achieve 99% accuracy (), thus, it is feasible to accurately identify heterozygous probes in normal samples. Hence, we can define the allelic log ratios (alog-Ratio) of the PM probes A and B for heterozygous SNP i of the paired tumor and normal samples as:respectively. The difference of alog-ratios (dalog-Ratio) between the paired tumor and normal samples is defined as,Additionally, we define the log-intensities of the paired tumor and normal samples for SNP i as:and the log-Ratio as: Y i  T 0 i  C 0 i. The corresponding log-ratio for heterozygous SNP i is denoted as Y hz i : Note that, in calculating alog-Ratio of the PM probes, we first take the average of the raw signal intensities of all quartets of a probe, then take the logarithm, instead of averaging after taking the logarithm of the raw intensities. We explained in the Supplementary Data that the normality assumptions on dalog-Ratio and log-Ratio hold in both cases (see S1 in Supplementary Data for details). In practice, by averaging the raw signal intensities first, we observed less pronounced saturation effects (data not shown). In addition, under an ideal situation (), the relationship between dalog-Ratio and log-Ratio for heterozygous probes with one-copy gain/loss can be expressed as (see S2 in Supplementary Data for details):where E O hz AEA or E Y hz AEA is the expected change(s) in dalog-Ratio (or log-Ratio) of heterozygous probes with one-copy gain()/loss() comparing with normal two-copy heterozygous probes. By using dalog-Ratio instead of B allele frequency (BAF) in our proposed method, we can avoid the unnecessary data manipulation as required for computing BAF values; in the meantime, no useful information is lost. Next, we will present our proposed method, the PAIR algorithm, which consists of two parts. Part I applies a two-state HMM model on dalog-Ratio values to coarsely identify probes in two-copy state, and then Part II refines the results obtained from Part I by using CBS segmentation.
The PAIR algorithmPart I: partition probes into UMS and BMS using HMM modelThe HMM approach is intrinsically suitable for analyzing data with unobservable (missing) variablesthe hidden states. In general, a discrete state HMM with continuous output includes the following components ().(i) Let K be the number of hidden states (discrete). In this article, we will consider a Markov process with two states (K  2), with S 1 being the UMS, including all genotypes that have equal number of A and B alleles (i.e. 00, AB, AABB, AAABBB and so forth), and S 2 being the BMS including all other genotypes (see S3 in Supplementary Data for details).(ii) Let 1 and 2 be the initial probabilities of the two states in (i), where 1  2  1. It has been shown that for HMM, with a continuous distribution output, the initial values for and the state transition probability matrix T (defined next) can be chosen arbitrarily (). Thus, we can assign, for example, 1  0:8, and 2  0:2 as the initial probabilities for the two states, given that the two-copy state in most cases dominates. However, assigning any other moderate values would be acceptable. (iii) Denote T mn  P s t  S m js t1  S n   , 1 m, n K, and the state transition probability matrix T  T mn f g. We assigned a small value (0.0001) to the probability of changing from UMS to BMS (that is,T 12  0:0001) on the assumption that there are on average a few to around dozens of CNAs in the whole genome of a tumor sample. Consequently, the probability of staying in the UMS is 0.9999. Further, to avoid 'overnormalization' of probes with copy number gain/loss, and also to take into account the often large number of reference two-copy state probes used in normalization, we are prone to be conservative in calling a probe in UMS versus BMS. Thus, we assigned an even smaller value (0.00001) to the probability of changing from BMS to UMS (T 21  0:00001). Denote b 1 (O) and b 2 (O) as the emission probabilities for UMS and BMS, respectively. In our HMM model, the observation O is the difference of allelic log-Ratio of the heterozygous probes. Further, under the normality assumption of dalog-Ratio, b 1 (O) is a normal density with  0, and variance 2 , and b 2 (O) is the density of a mixture of two normal distributions (BMS) with means and , and the same component variance 2. Here, we also assume that the two modes of the BMS have equal weight because we do not expect an association between allele type and CNAs, and thus allele A is affected as often as allele B (see S3 in Supplementary Data for details). In addition, we assume the variance of b 1 (O) and the component variances of b 2 (O) are the same for the case of one-copy gain situation for simplification. Note that the component variances of b 2 (O) can be larger for other types of CNAs. However, this is not a concern for our model, as in those situations, is much larger, and a moderate change in component variance does not affect UMS and BMS partition (see Supplementary). Given the HMM, we used Viterbi algorithm () to compute the probability of the most probable state sequence. The distribution of probes that are in the BMS may be complicated. For example, there may be tumors that simultaneously have, say, segments of one-copy gain, one-copy loss, cnLOH and two-copy gain. As a result, a bi-modal distribution would not be sufficient to model it. However, among these gains/losses and cnLOH, one-copy gain is the most difficult one to detect (see S4 in Supplementary Data), except for some minor clone caused by CNAs that might not be detectable at all. Thus benefiting from this inequality, algorithms that detect one-copy gain will automatically detect other types of odd-number gain/loss, cnLOH and certain types of even-number gain/loss. To detect segments of one-copy gain, we applied a HMM with three iterations. In the first iteration, we set the initial values for the variance of b 1 (O) and the component variance of b 2 (O) in the HMM equal to the sample variance ( 2 0 ) of the whole sequence of observations (dalog-Ratio values). When there is none or only focal gains/losses, this sample variance is supposed to be close to the true variance. Otherwise, when there exist large segments of gain/loss, the value of 2the expected dalog-Ratio value of one-copy gain is41 standard deviation of the two-copy probes if the sample contamination rate is 12%. Note that, we made conservative assumptions in Supplementary Data S7. In practice, we were able to obtain good separation of UMS and BMS for all samples we tested. Detection of homozygous deletions (HDs) is much easier and can be achieved by applying the same HMM model to the dalog-Ratios of all probes (both homozygous and heterozygous probes). The variances of HD segments could be as small as 1/5 of the variances of other segments, thus these HDs could be easily identified in one iteration (see Supplementary). As the final step of Part I, we mapped the probes in BMS back to the original whole sequence (including both homozygous and heterozygous probes) and considered the probes within two consecutive BMS probes as CNA probes. After excluding these CNAs and HD probes, all remaining probes are called the initial reference set.
The PAIRalgorithmPart II: detecting probes in two-copy state by applying CBS on piecewise average log-ratio Let i , i  1, 2, :::, l, be the sequence of points where copy number changes occur. Assume that Y i is a sequence of independent random variables with normal distribution,. .. , l, and 0  0 5 1 5    5 l1  T: In this article, the variables Y i represent the logarithm of signal-intensity ratio described in Section 2.1. Divide the whole sequence of random variables into subsequences of equal size, with m random variables (elements) in each subsequence (the last one might have less than m random variables). We then obtain a new sequence of random variables,, 2, :::, T : m the average of all random variables within each subsequence, and term it the piecewise average log-ratio (PAlog-Ratio). Here, M p was calculated by taking the average of m ( 100) consecutive log-Ratio values in the whole sequence, including homozygous ones. Note that the reasons to use m  100 are 2-fold: (i) the computation is much faster and (ii) the bias in segment-mean estimate introduced by using PAlog-Ratios instead of raw log-Ratios is negligible. The execution of Part II started with a modality test () on PAlog-Ratios for all probes in the initial reference set. Based on BIC (), if a uni-modal distribution fits well, all probes in the initial reference set would be two-copy probes and will be used as the references in subsequent normalization. Otherwise, if a multiple-modal distribution fits well, the estimated mean log-Ratio of the component distribution with the smallest mean would be used as the mean of two-copy probes. Next, after applying CBS segmentation to PAlog-Ratio values (HD and one-copy loss probes have been excluded by Part I), we removed any segments whose mean log-Ratio values are greater than the median of the mean log-ratios of one-copy gain segments (see S5 in the Supplementary Data for the criteria to detect segments of one-copy gain/loss) and used the probes remaining in the initial reference set as the reference set. In cases where only segments of one-copy loss exist, we imputed the one-copy gain value by multiplying the absolute change of one-copy loss by 0.58. If neither a one-copy gain nor a one-copy loss segment was detected in Part I, we simply used a 95% confidence interval about the two-copy mean as the cut-off values.
Normalization via spline smoothingAfter identifying probes in the two-copy state, normalization was carried out using an MA plot, where the log-Ratio (M) was plotted against the log mean intensity (A). Note that A is the average of tumor and the paired normal sample log intensities (). We obtained M and A values for each probe, and set the median of M values of the probes (all probes for normal sample, and two-copy probes only for tumor sample) as 0. Then, we used the M and A values of probes in the two-copy state to create a spline smoothing curve (). The corrected M values for all probes based on the smoothing curve are the normalized log-Ratio values, where the median of normalized M values of the probes in the two-copy state equals 0.
An option for normalizing noisy dataWe have assumed that the distributions of the log-intensities of A and B alleles of heterozygous SNPs on the same array are the same. In other words, the log-intensities of probes with genotypes AA, AB and BB are supposed to have the same distribution. However, in practice, they may be somewhat different because of unexpected sources of variation. For example, cnLOH (exclusively AA or BB genotypes) should have the same mean log-Ratio as those of normal two-copy segments (including probes with AA, AB and BB genotypes), but minor differences do exist because of the fact that log-intensities of probes with AB genotype can be higher/lower than those of probes with AA or BB genotype. To correct this, especially for arrays with choppy signals, we used spline smoothing to normalize tumor and normal log-intensities separately before normalizing the log-Ratios. To normalize log-intensities, we plotted the log intensity of the tumor (or normal) sample versus the log-ratio of A and B alleles of the tumor (or normal) sample.
PAIR algorithm flow chartA flow chart outlining our procedure can be seen in.
Simulation studyTo evaluate how the proportion of two-copy probes affects the normalization result, we simulated the SNP array data by re-sampling one-copy gain/loss and two-copy probes from a tumor-control pair, where three normalization methods, CGH-normaliter, PAIR and popLowess, gave similar normalization results. Specifically, we first randomly filled the whole genome with one-copy gain/loss probes, such that all probes in each chromosome (or chromosome arm) have the same copy number either one-copy gain or one-copy loss. To maintain the correlation. Flow chart of the PAIR normalization structure, the log-intensities of alleles A and B for the paired tumor and normal samples and the genotype for the normal sample of the same SNP were sampled simultaneously. Then, we randomly replaced some of the one-copy gain/loss segments with the two-copy probes to have a pre-defined proportion of two-copy probes in the genome. That is, we randomly picked a chromosome (or arm) and filled it with two-copy probes and repeated this process until the pre-defined proportion was reached. Finally, we applied all three normalization methods to each simulated data, and calculated the rate of the two-copy probes correctly identified by each method. These rates are presented and compared in Section 3.6.
RESULTSWe demonstrated the performance of PAIR algorithm by applying it to a public dataset, where 114 multiple myeloma samples were analyzed by Affymetrix 500 K array set (Nsp  Sty). Among them, 80 samples have matched peripheral blood DNA performed on the same array types. These data were generated inand can be downloaded from the public domain GEO with access ID, GSE21349.
Partitioning heterozygous probes into segments of UMS and BMSBy Part I of the PAIR algorithm, a two-state HMM model was applied to dalog-Ratio, and the heterozygous probes were partitioned into segments of UMS and BMS. The partition result is presented in. In, probes in black color are those that follow a uni-modal distribution (the UMS segments), and probes in red color are those that follow a bi-modal distribution (the BMS segments). It is clearly indicated by the 95% confidence lines (in red) that probes in the UMS segments have smaller variance than those in the BMS segments do (see S6 in Supplementary Data for details). Note that any two-copy probe, if it exists, has to be within one of UMS segments. This is the key to ensure no misclassification of probes in two-copy state or in one-copy gain/loss. On the other hand, a UMS segment might include probes with certain types of even-number gain, such as AABB, AAABBB and so forth. This justifies the necessity of Part II of the PAIR algorithm. For example, fromthe plot of log-Ratios of the whole-genome with BMS probes being colored in red, the majority of probes on chromosomes 24, 712, 14, 1617 and 1922 are in UMS, but the probes on chromosome 9 are in two-copy gain instead of two-copy state. The explanation for chromosome 9 being partitioned into the UMS segment is that the genotypes of heterozygous probes on this chromosome are presumably AABB, instead of AAAB/ABBB.
Identifying probes in two-copy state from all probesin the initial reference set part of chromosome 1 in the aforementioned example. In the extreme cases where there are no two-copy probes in the whole genome, some additional work is needed. A brief discussion can be found in Section 4. Based on the fact that two-copy heterozygous probes follow a uni-modal normal distribution, by partitioning probes into UMS and BMS, we can confidently exclude probes in BMS from the reference set. On the other hand, conventional segmentation methods, such as CBS, were neither designed to accurately assign the true underlying copy number to segments that have the same copy number, nor to detect segments of cnLOH. For example, the mean log-Ratio values of probes on chromosome 18 and a part of chromosome 1 are close to those of probes in normal two-copy segments, thus it is difficult to distinguish them from the normal two-copy probes. Nevertheless, CBS (adopted in Part II) has greater power for detecting higher-magnitude change of mean log-Ratio value. In the aforementioned example, CBS provided satisfactory result for detecting two-copy gains of chromosome 9.
Normalization by an MA plotThe result of normalization (by an MA plot) is presented in Supplementary. As a quicker alternative to Lowess regression, spline smoothing was used in computing the correction curve. The advantage of using spline function over polynomial regression is to avoid distortion, especially at the left and right tails ().
Comparing with CGHnormaliter, popLowess normalization methods and othersThe R/Bioconductor package 'CGHnormaliter' and a standalone version of R code for popLowess were used to normalize the data for the purpose of comparison. Normalized data were then segmented using CBS to visualize the results. In many cases, three algorithms, CGHnormaliter, PAIR and popLowess, generated almost the same normalized data. However, when the proportion of two-copy probes is not predominantly high, both CGHnormaliter and popLowess may have difficulties in correctly centralizing the normalized data. Using the sample with ID 303 as an example, our method () centralized the data around the mean log-Ratio values of chromosomes 2, 3, 5, 7, 9, 15, 19 and 20. CGHnormaliter (), however, centralized the data around the mean log-Ratio values of chromosomes 1, 4, 6, 8, 10, 1214, 16, 21 and 22. We highlighted those probes that have AB genotype calls in normal, but AA or BB in tumor (see the probes in red color in; probes that do not have this change are in black color). As most of the probes that have heterozygosity loss are located in chromosomes 1, 4, 6, 8, 10, 1214, 16, 21 and 22, we assume that these chromosomes are the one-copy loss chromosomes. PopLowess () was able to centralize the data similarly to our method, the mean log-Ratio values of the reference chromosomes, especially chromosomes 9, 15, 19 and 20, were slightly different from 0. The possible reason is that the k-mean cluster approach used in popLowess does not provide precise estimates of cluster means. In another sample, CGHnormaliter and PAIR obtained similar normalization results, but popLowess picked different chromosomes as the reference (see Supplementary). We also compared PAIR to other methods, such as Quantile (), Invariant Set () and ITALICS (see Supplementary). The figure indicates that PAIR is the method that is able to set '0' at approximately the median of a copy number population.
Optional normalization of tumor and normal log-intensity separatelyThe allelic MA plot of probes in two-copy state is theoretically centered about a horizontal line, as the probes with AA, AB and BB genotypes are supposed to have the same log-intensity values. However, the real data often show that the pattern of log-intensity values deviates from a horizontal line, the superimposed spline smoothing white lines infor a tumor sample and c for the paired normal sample. Using paired samples could normally neutralize the effect of such differences if the pattern for the tumor sample is coincident with that of the paired normal sample. Nevertheless, should the patterns for the paired samples be more divergent, optionally normalizing the log-intensities of tumor (based on the PAIR identified two-copy probes) and the paired sample separately before normalizing log-Ratios might be necessary to improve the quality of normalization. The effects of the optional normalizations are presented in, where we plotted the PAIR normalized log-Ratio with or without the optional individual sample normalization in a or b.and d are the normalization results after applying CGHnormaliter and popLowess. Comparing a and b, we can see that applying the optional normalization resulted in a large reduction in the total number of segments detected by CBS. The reduction was also substantial if comparing with CGHnormaliter and popLowess normalization results.. The comparison of normalization results from CGHnormaliter, PAIR and popLowess algorithms. CBS segmentation profile was superimposed in yellow color. Probes in red color are those with AB genotype in the paired normal, but AA or BB in tumor. (a) Applying CBS segmentation on the raw log-ratio. The total number of segments was 70, and the mean log-ratio of neither of the two dominating copy number states was close to 0. (b) The PAIR normalized data. The total number of segments was 40, and the mean log-ratio values of the segments in two-copy state, that is, chromosomes 2, 3, 5, 7, 9, 15, 19 and 20, were $0. (c) The CGHnormaliter normalized data. The total number of segments was 65, the mean log-ratio values of chromosomes, that is, 1, 4, 6, 8, 10, 1214, 16, 21 and 22, were $0. (d) The popLowess normalized data. The total number of segments was 50; however, the horizontal cyan line, which indicates no CNAs, was slightly different from the mean log-ratio values of chromosomes, that is, 9, 11, 15, 19 and 20, indicating there might be some problems with the centralization process Furthermore, the white band (of mean log-Ratios) inis narrower than those in b, c and d, indicating that optional normalization may also be able to reduce the signal noise. Furthermore, the effect of the optional individual sample log-intensity normalization could also be seen from the change in the mean log-Ratio of segments of cnLOH. We compared calculating results by different methods (see S1 in Supplementary Data) in. Forand b, the intensities of A/B alleles were calculated by taking the averages of the raw A/B allele intensities of all quartets for a probe, and then the total log-intensity was the logarithm of the sum of A and B allele intensities. For c and d, the log-intensities of A/B alleles were calculated by taking the average of logarithms of the raw A/B allele intensities of all quartets for a probe, and the total log-intensity was the sum of the A and B allele log-intensities.showed that the mean log-ratio of the cnLOH segment was slightly different from those of the normal two-copy segments before individual normalization. The optional individual normalization mitigated this difference (). This effect was much striking when comparing d and c. Note that for samples that performed the optional normalization, segments of cnLOH could be included in the reference set.
Simulation resultIn Table 1, we present the simulation results of the numbers of two-copy probes correctly and incorrectly identified by themethods. All three methods perform equally well when the proportion of two-copy probes is 450%. However, when this proportion drops, neither CGHnormaliter nor popLowess provides satisfactory normalization. The main reason is that the assumption of these two methods is violated. In contrast, PAIR can provide satisfactory normalization even when the proportion of two-copy probes is as low as 10%.
DISCUSSIONCorrectly identifying reference probes in two-copy state from the SNP array is not trivial. We propose an algorithm, PAIR, that can accurately distinguish two-copy state probes from those with CNAs. The proposed PAIR algorithm first partitions the whole genome into segments of UMS or BMS. The normal two-copy probes, if they exist, can then be narrowed down to the segments of UMS. This algorithm does not assume that two-copy probes dominate the whole genome. This is an advantage compared with the methods that require this assumption. In contrast to the conventional methods, PAIR has the advantage of being able to identify segments of cnLOH. This is preferable, as the mean log-ratio values of probes in some cnLOH segments can be different from those in normal two-copy segments, and this could cause a bias in the step of centralization should the cnLOH segment be large. Furthermore, with the optional allelic normalization, we are able to equalize the log-intensities of A and B alleles, and thus remove one source of false discovery. We did not integrate log-Ratio and dalog-R analyses into the HMM model, but instead, we adopted a two-step process. In Part II, we applied CBS segmentation to PAlog-Ratios instead of the raw log-Ratios. By doing so, we could substantially reduce the computational time. Meanwhile, comparing with the methods using log-Ratio, the risk of false detection can be reduced if signal drift and uncorrected genomic wave exist (). We obtained the monotone relationship between log-Ratio and dalog-Ratio, and proposed to use dalog-Ratio instead of BAF in cnLOH detection and underlying copy number estimation to avoid unnecessary data manipulation. The proposed method reduced the computation time when comparing with CGHnormaliter. For the samples with a large number of segments, it takes only 35 min to complete the normalization process using our method, but usually 2030 min using CGHnormaliter, when the algorithms were run on Lenovo T400 laptop. CNAs are different from sample to sample, and sometimes can be complicated. It may be difficult to fully specify all CNA forms by a HMM model. Bearing this in mind, the proposed two-state model, although it might miss some focal CNAs, can greatly reduce the risk of misclassification of large segments of CNAs. This, in our opinion, is sufficient for a normalization method to be acceptable. One of the assumptions of the PAIR algorithm is that there are at least some normal two-copy heterozygous probes in the genome that need not to be dominated. The simulation result shows that the PAIR algorithm has almost 100% power for correctly detecting the normal two-copy states when the proportion of two-copy state probes are as low as 10%. In the extreme cases where virtually no two-copy probes exist, that is, the whole genome is in the same state, we could still determine whether the whole genome is in one-copy gain/loss from two-copy. It will be more challenging to accurately centralize the probes. However, this is not the focus of this article.
S.Yang et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
will be bigger than the true variance of probes in UMS, but smaller than the true mixture distribution variance of probes in BMS. As a result, probes with larger variance tend to fit the BMS better, and probes with smaller variance tend to fit the UMS better. Thus, a meaningful initial partition can be obtained with such choice of the initial values of variances. In the second iteration, we used the estimation of the variance of probes in the UMS (detected from iteration 1) as the input in the HMM model. And the third iteration is a repeat of the second iteration. Note that, when the SNR is high, the two states can be easily separated, and when the SNR is low, the power for distinguishing the two states from each other depends more on the means ( and ) of the two component distributions. Theoretically, additional iterations may be run until a convergence criterion is met. However, in practice, we observed that two or three iterations are usually sufficient to get a decent normalization result. We comment that to have large power to identify one-copy gain, it makes sense to set as small as possible while controlling false-positive rate. Based on our simulation, by setting at $2 standard deviations of a sequence of random normally distributed observations, we can control the false-positive rate at a 5% level. In practice, we noticed that setting close to any value between 1.9 and 2 standard deviations of the whole sequence (for first iteration), or observations in UMS (detected by previous iteration), can achieve decent results of separation between UMS and BMS, even for noisy samples. And minor changes in , such as AE0.05, would not affect the separation result except for some focal gains/losses. This is in concordance with Supplementary Data S7, where we show that
PAIR at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
By Part II of the PAIR algorithm, we aim to separate probes in two-copy state from the segments of the initial reference set. Based on the fact that the mean log-Ratio of probes in a two-copy gain segment is higher than that of probes in a one-copy gain segment, we concluded by Part II that chromosome 9, which was originally partitioned into the initial reference set, was a two-copy gain chromosome. In general, the segments with copy number gain of higher magnitude can be excluded from the reference set by Part II because their mean log-Ratios are higher than those of one-copy gain segments. After applying Part II, segments remaining in the reference set predominately consist of two-copy probes. By subtracting the median of log-Ratios of these two-copy probes from the raw log-Ratios of all probes, we obtained the centralized log-Ratio values. We comment that (i) it may be difficult to accurately identify CNAs by conventional segmentation methods alone. For example, chromosome 18 is in cnLOH (Fig. 2a), but it cannot be detected by conventional methods (Fig. 2c) because cnLOH is also two-copy. (ii) Although chromosomes 24, 16 and 17 are all two-copy chromosomes, there is a drift in segment mean along chromosomes (Fig. 2b). As a result, the segment means of PAlog-Ratio values of probes on chromosomes 16 and 17 are lower than those of probes on chromosomes 24 (the reference cyan line represents 0). This may result in assigning incorrect copy numbers to those chromosomes. In contrast, the dalog-Ratio plot (Fig. 2a) is symmetric about 0 for all the chromosomes, and the variations of dalog-Ratio values of probes on chromosomes 24, 16 and 17 are among the smallest, indicating that all these chromosomes are in UMS, and potentially in two-copy state. We applied Part I of the PAIR algorithm to achieve two goals: (i) to identify segments that contain probes in two-copy state; (ii) to detect segments of cnLOH, such as chromosome 18 and Fig. 2. An illustration of applying PAIR algorithm to one of the paired samples. (a) The application of Part I of the PAIR algorithmsegments of UMS and BMS were outlined by the two standard deviation confidence interval lines of each segment (in red). Probes in segments of UMS have the smallest confidence interval (variance), that is, chromosomes 2 4, 712, 14, 16, 17 and 1922. Probes in segments of BMS have larger variances of different scales owing to the different nature of gain/loss, that is, probes on chromosome 5 and 15, and part of chromosome 6 has one-copy gain, probes on chromosome 13 have one-copy loss and chromosome 18 and part of chromosome 1 are segments of cnLOH. (b) The application of Part II of the PAIR algorithmCBS segmentation was applied to the PAlog-Ratio. (c) The reflection of Part I UMS and BMS partition on log-ratio values. The black and red colors represent segments of UMS and BMS detected in Part I, respectively. Probes on chromosome 9, which have two-copy gains, were largely in UMS. (d) The reflection of applying CBS on log-ratio values. Chromosome 9 was re-identified as a segment of two-copy gain by CBS segmentation. Chromosome 18 and part of chromosome 1, both of which were cnLOH, were not identified as CNAs
