Wave-spec is a pre-processing package for mass spectrometry (MS) data. The package includes several novel algorithms that overcome conventional difficulties with the pre-processing of such data. In this application note, we demonstrate step-by-step use of this package on a real-world MALDI dataset. Availability: The package can be downloaded at http://www.vicc.org/biostatistics/supp.php. A shared mailbox (wave-spec@vanderbilt.edu) also is available for questions regarding application of the package.
INTRODUCTIONThis paper demonstrates how the Wave-spec package works, as an application note designed to complement a Wave-spec method paper published previously (). The rest of this paper is organized as a step-by-step demonstration on real MALDI-TOF data and follows the procedure presented in Supplementary.
WAVE-SPEC APPLICATIONUsers of Wave-spec must have basic programming skills in Matlab as well as background knowledge on mass spectrometry (MS) data. Given the complexity of high-throughput datasets, it is unrealistic to expect that an inexperienced user would master the use of Wavespec, even with the thorough guidance outlined here.
Read in dataFor the purpose of demonstration, we chose 210 spectra from one training cohort in a published dataset: 70 patients in 'Italian A' with 3 spectra per patient. Details of the data are given in (). For a batch read-in, it is best to put all the spectrum files in one folder. For example, we place the data in the following folder and the first command is to give the directory: dir = 'C:\Mass Project\Mass Data\';In .txt format, each data file should have two columns. The first column is m/z, and the second is intensity. Based on our experience, * To whom correspondence should be addressed. in most cases, the spectra will have the same acquisition frequency but slightly different m/z values across all samples. The following two commands are used to combine all spectral intensities (denoted as Y ) and to provide a common m/z value with the same dimension for all spectra.It is important to note two other possible situations involving m/z values: (i) all spectra share exactly the same m/z values. In this case, we need only the first command; and (ii) the acquisition frequencies are different, in which case the m/z values exhibit a large discrepancy across all samples (for example, due to being acquired from different machines/institutes). In this case, an interpolation algorithm might be needed to decide a common m/z value.
CalibrationCalibration is a highly interactive process. First, prior to calibration, we need a candidate calibration peak list, which is typically provided by the investigator. Secondly, we select appropriate peaks from this list by viewing their shape in the data we have [criteria for candidate peak selection are described in (. For example, Supplementaryshows that 9428 might be a good choice, as are 6631, 11 649.3, and 15 868. Therefore, we use the following commands for spectral calibration. R=; idR=wsMz2Id(R,mz); id=; YA=msalign(id',Y,idR);=wsNaNRemoval(YA); YA = YA(CutSt:end-CutEd,:); mz = mz(CutSt:end-CutEd);Note that, with the last three lines of code, we ignore some of the starting and ending values of the spectra, to avoid possible N/A values generated by the calibration process at starting and/or ending positions of spectra. The following process is not affected by these missing values. After calibration, we need to check the calibration performance, not only plotting the spectra before and after calibration around the calibration point, but also viewing the overall calibration performance for the full spectral range. For example, Supplementary Figures S2 and S3 show the results before and after calibration around candidate peak 9428. (Note that we generated and viewed additional plots to check the overall calibration performance, without presenting them here.)Page: 740 739740
M.Li et al.
Feature selectionThe step after calibration is to extract common features from the spectra. As explained in the initial method paper, the number of 'peaks' is determined by the level of wavelet denoising, and an appropriate smoothing threshold is obtained by a feedback index: the ratio of baseline area to total area under the peak location distribution curve. To balance the tradeoff between admitting false peaks and removing true peaks, we apply the following schema. First, we prespecify the feedback index upper limit (for example, 0.05). Then, we increase the wavelet threshold from relatively low levels until the feedback index is low enough to meet the upper limit constraint. To illustrate the threshold selection process, we set 3 values for the wavelet denoising threshold, thre, and set other parameters with fixed values in the code below.In most cases, the recommended selection range for thre is between 40 and 80. The other key parameters to tune and their recommended ranges are: (i) decomposition level, decomp,; (ii) spectral intensity signal-to-noise ratio, s,list =shows that when the threshold is set at 60, the feedback index obtains optimal values along the whole spectral range. Such a figure is usually generated to assist on deciding the optimal threshold. We then apply this parameter to achieve the final smoothing.=wsDenos(YA,mz,decomp,60,s);=wsKde(peak,0,0,st,ed,bw);
Feature quantificationWe quantify the selected features by calculating the area under a baseline-corrected (YB) and normalized (YN) curve. The final output intensity for selected features are auc. These steps can be achieved using the following code: YB = msbackadj(mz,YP); YN = msnorm(mz,YB); auc = wsAUC(bins,mz,YN); Supplementaryprovides average curves for the whole m/z range at 3 different pre-processing stages: (i) denoised only; (ii) denoised plus background-corrected; and (iii) denoised, background-corrected and normalized. The identified peaks are contained in rectangles (bins). This plot is helpful when reviewing and verifying pre-processing at the end of the procedure: we expect to see all large peaks contained in bins, and the average curve is smooth without elevated background. (Supplementaryis a detailed version of Supplementaryfor a small m/z range.) Such plots can be obtained using the following code: wsBinPlot(bins,mz,mean(YP')', mean(YB')',mean(YN')');
Output resultsThe final step in the procedure is to write out the results or any intermediate values that might be needed for further statistical analysis. For example, for bin range, peak values and names of each spectrum, use the following code to write out results: dlmwrite('C:\bins.txt',bins,'delimiter','\t'); dlmwrite('C:\auc.txt',auc,'delimiter','\t'); cell2csv('C:\specNames.csv',);
DISCUSSION AND CONCLUSIONBy using a publicly available mass spectrometry dataset, we have demonstrated how Wave-spec works. This package can be applied to many types of MS data, such as direct infusion or flow injection MS data, as well as MALDI-TOF MS reflectron-mode data. A user who wishes to apply our package should adapt our sample code accordingly and refer to the corresponding method paper.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
