Genotypic causes of a phenotypic trait are typically determined via randomized controlled intervention experiments. Such experiments are often prohibitive with respect to durations and costs, and informative prioritization of experiments is desirable. We therefore consider predicting stable rankings of genes (covariates), according to their total causal effects on a phenotype (response), from observational data. Since causal effects are generally non-identifiable from observational data only, we use a method that can infer lower bounds for the total causal effect under some assumptions. We validated our method, which we call Causal Stability Ranking (CStaR), in two situations. First, we performed knockout experiments with Arabidopsis thaliana according to a predicted ranking based on observational gene expression data, using flowering time as phenotype of interest. Besides several known regulators of flowering time, we found almost half of the tested top ranking mutants to have a significantly changed flowering time. Second, we compared CStaR to established regression-based methods on a gene expression dataset of Saccharomyces cerevisiae. We found that CStaR outperforms these established methods. Our method allows for efficient design and pri-oritization of future intervention experiments, and due to its generality it can be used for a broad spectrum of applications. Availability: The full table of ranked genes, all raw data and an example R script for CStaR are available from the Bioinformatics
INTRODUCTIONThe growing interest in causal inference (e.g.) has increased the need not only for methods able to handle this task but also for designed experimental validation. It is of general interest to infer the genotypic causes of a complex phenotypic trait (). The classical approach relies on randomized controlled intervention experiments, e.g. knocking out a gene and observing the effect on the phenotype relative to the wild-type organism. However, such intervention experiments are time consuming and expensive, and a prioritization with respect to most informative new experiments is very desirable. A genetic method to identify loci causing phenotypes or gene expression patterns is based on quantitative trait loci (QTL) and expression QTL (). This can be a very powerful approach but it is limited to loci where genetic variation exists and to situations where segregating progeny of control crosses is available. Often, however, it is desirable to predict causal effects from purely observational data. We therefore consider the problem of predicting total causal effects from data obtained by observing a system without subjecting it to targeted interventions (observational data). This problem is generally ill-posed, but the recently proposed IDA method () provides estimated lower bounds of total causal effects from observational data under some assumptions (Supplementary Section S1). However, these bounds come without a measure of uncertainty. We address this issue by introducing a new method combining IDA and a version of stability selection (), which we call Causal Stability Ranking (CStaR;). The addition of stability selection to IDA provides two advantages. First, CStaR leads to a stable ranking of genes (covariates) according to the sizes of lower bounds for their predicted total causal effects, irrespective of the choice of the tuning parameter in stability selection. Second, under some additional assumptions, CStaR allows controlling an error rate of false-positive findings, namely the expected number of false positives and hence also the per-comparison error rate (PCER). CStaR results were confirmed in two biological scenarios using the simple model Saccharomyces cerevisiae and the more complex model Arabidopsis thaliana. Together, the built-in error measure and the success in finding relevant regulator genes make CStaR an excellent ranking method for the targeted design of experiments based on easily available resources.
METHODSBased on observational training data and a set of required assumptions, CStaR predicts a lower bound for the total causal effect of a covariate on a response of interest, including a PCER for the false-positive selections. This is achieved by combining IDA (Section 2.1) with a version of stability selection (Section 2.2) on a range of different parameters. Predicted *To whom correspondence should be addressed. total causal effects are ranked according to their stability aggregated over this range (Section 2.3).
Causal inference whenthe directed acyclic graph (DAG) is absent (IDA)The IDA procedure () is a statistical method that infers lower bounds for the absolute values of total causal effects on a response of interest from observational data under the assumption that the data come from an unknown DAG without hidden variables. Suppose we have a dataset with n observations consisting of a response and p explanatory variables. Denoting by j (j  1,. .. , p), the true total causal effect of gene (covariate) j to the response (the total causal effect j can be interpreted as follows: a change of gene j by one unit (one standard deviation) causes an average change of size j in the response), the output of IDA is the estimated lower bound ^ j. It is shown () that under certain assumptions (Supplementary Section 1) and as sample size n tends to infinity:justifying the IDA procedure to infer lower bounds. These lower bounds are conservative: for example, if the lower bound is equal to zero, we would not make a statement that there is no causal effect (since the true total causal effect could be indeed equal to zero, or it could be larger than zero but the lower bound would not detect it). Based on the estimated lower bounds, we obtain a ranking of genes (covariates) with j 1 being the index corresponding to the top rank, j 2 for the second best rank and so on:Under the assumption that the data come from an unknown DAG without hidden variables, the true total causal effect j is generally non-identifiable from observational data, but lower bounds are. The conceptual idea for constructing lower bounds is as follows (). We first infer the so-called Markov equivalence class of all the DAGs (see Supplementary Section S1), which are compatible with the observational data. Using intervention calculus (), we derive all potential total causal effects based on each DAG G r in the equivalence class (for every gene (covariate) j) f j;r ; r  1,. .. , mg j  1,. .. , p   , and we define the true lower bounds as j  min r1, ..., m j;r j  1,. .. , p   : 2Under our assumptions (see Supplementary Section S1), these (true) lower bounds j are identifiable from observational data, and the IDA algorithm yields the estimates ^ j (j  1,. .. , p). The main components of the IDA method are the PC-algorithm for estimating the Markov equivalence class of DAGs () and a local algorithm for calculating the bounds j without enumerating all DAG members in the estimated Markov equivalence class (). It is) according to the following procedure. A subsample of size n=2   is repeatedly drawn from the total of n pre-processed data points (Step 2). On each subsample (or stability run), lower bounds for the total causal effects are estimated using IDA () and used to rank the genes (Step 3, Section 2.1). Next, for a range of different q-values, we record the relative frequencies over the 100 stability runs that each gene appeared in the top q ranks (Section 2.2). The median rank over these different qs is used to generate the final ranking of the genes (Step 4). Furthermore, under additional assumptions, an upper bound for the PCER is estimated for each q-value and its corresponding relative frequency (Section 2.3). Finally, the gene ranking allows for design of new experiments. Thus, a biological validation using intervention experiments can be performed. We tested CStaR in two situations. First, on a publicly available compendium of 31 natural A. thaliana accessions consisting of n  47 gene expression measurements, each with 21,326 genes and corresponding flowering time data (; Supplementary Section S2.1). We performed biological intervention experiments according to the causal gene ranking () by focusing on candidates that were not already known to control flowering time and for which mutant seeds were readily available (Supplementary Section S2.3). The biological experiments were analyzed using a two-sample Welch's t-test (Supplementary Section S2.4). The second validation was performed on a publicly available dataset in S. cerevisiae containing n  63 observational and 234 interventional full-genome expression profiles, with p  5,361 genes (; Supplementary Section S3). Since this dataset includes both observational and interventional data, the validation was analyzed by comparing estimated total causal effects based on the observational data with inferred effects from the interventional data () this local algorithm that makes the inference of these lower bounds based on thousands of genes (covariates) feasible. IDA is implemented in the R-package pcalg ().
Stability selectionCStaR incorporates a stability selection step (Meinshausen and BuhlmannBuhlmann, 2010). We draw 100 independent random subsamples of size n/2 and we run IDA on the subsampled data. In each subsampling run, which we also call stability run, we check whether gene (covariate) j has appeared among the top q variables when using the ranking as in equation (1) based on the subsampled data. We can then report the relative selection frequency ^  j , among the 100 stability runs, that gene (covariate) j has appeared (or been selected) among the top q variables. These relative selection frequencies yield a stable list of genes (covariates): the index j 1 corresponds now to the most stably selected variable, and j p to the least stable variable:Besides the increased stability in the ranking (3), stability selection is controlling the expected number of false-positive selections. Define the stably selected genes (covariates) asfor some threshold 0.55 thr 1. Denote the wrongly selected genes (false positives) by V  j ^ S stable \ S false j, where S false is the set of (false) genes (covariates) whose true lower bound j  0, see (2). Then, for a given threshold thr and a given value of q] we have, assuming an exchangeability condition (see Supplementary Section S1;):and this leads to a bound for the PCER (PCER  EV=p). If a gene (covariate) j has relative selection frequency ^  j , a bound for the corresponding PCER is given by
Summary rankingAs novelty, we avoid choosing a specific q for the execution of stability selection by assessing the stability and the rank of each gene on a range of different q-values. This constitutes the main modification of the standard stability selection scheme and it also constitutes a useful simplification for the practitioner. This can be summarized graphically (Supplementarygives an example for a single gene in the A. thaliana validation). We found that CStaR is relatively insensitive to the choice of the range of qs. However, down to a certain lower bound, small values of q lead to higher sensitivity and thus better results (see also Supplementary Section S3). If the q-values fall below such a lower bound, the ranking becomes unstable again. Finally, all genes are ranked according to the median rank with respect to the different q-values. Ties in the final ranking are sorted according to median total causal effect size.
ValidationWe validated CStaR in two situations. First, we trained CStaR on a publicly available compendium of A. thaliana gene expression data and performed new biological validation experiments (Supplementary Section S2). The compendium contains 47 expression profiles of natural accessions from diverse geographic origins (). The phenotypic trait of interest is time to flowering, which is robustly measured by the number of days to bolting or the number of rosette leaves formed before bolting (). Timing of flowering according to local climatic conditions is a major determinant of the plants' reproductive success and an important agronomical trait that greatly affects yield. Therefore, an improved knowledge about genes controlling flowering time is of substantial economic value (). As a second validation of the CStaR method, we compared it with the plain IDA method [ranking as in (1)], Lasso (), elastic net () both using linear models (ranking according to absolute values of estimated regression coefficients) and marginal correlation (ranking according to absolute values of marginal correlation to the response) on a publicly available dataset of gene expression profiles in S. cerevisiae (; Supplementary Section S3). This dataset includes both observational and interventional data obtained under similar conditions. Hence, it forms an excellent basis to assess the performance of methods aimed at estimating total causal effects from observational data, as the effects estimated from the observational data can be compared with the effects inferred from the interventional data. These data were used to validate IDA (), and we followed the same approach to validate CStaR. In particular, we used the interventional data to infer the total causal effects of the knock-out genes on the remaining genes and defined the top 5% of the effects that were largest in absolute value as the true positives.
RESULTS
Validation for A. thalianaCStaR scores five known regulators of flowering time (DWF4, FLC, FRI, RPA2B and SOC1;) in its top 25 (). In particular, SOC1, FRI and FLC are curated flowering time genes in; short dashed), elastic net (; dash dotted), the latter two using linear models and marginal correlation ranking (dotted) in the S. cerevisiae validation (Supplementary Section S3). Random guessing is indicated by the grey line. All methods were trained on the observational data. True positives were defined as the largest 5% of the effects (in absolute value) inferred from the interventional data Arabidopsis Reactome () containing 119 known regulators of flowering. This is a highly significant enrichment of known curated regulators when compared with random guessing (p510 5 in a hypergeometric test). Interestingly, FLC and FRI are not only major regulators of flowering time in the model species A. thaliana but also in the oil-seed rape crop. Among the other genes in the top 25, which were not already known to play a role in flowering time, there were 13 genes for which mutant seeds were readily available (Supplementary). These mutants were used for intervention experiments in order to further validate CStaR and to discover new influential genes for flowering time in A. thaliana (Supplementary Section S2.3). The intervention experiments were performed under two photoperiod conditions, short-day (SD) and long-day (LD) with 8 h and 16 h of light, respectively. As phenotypic responses, the number of days to bolting (DTB, for both SD and LD) as well as the rosette leave number (RLN, only for LD) were recorded. Seed viability varied between different genotypes (Supplementary Tables S2S4) reducing the number of testable mutants to nine (Supplementary). Differences between the knock-out and control group were tested using a two-sided Welch's t-test, because the mutant samples showed different empirical variances compared with the control group. This is most pronounced in the short-day layout. Four new genes were found to have a significant total causal effect on the phenotypic responses at level  0.05 in at least one of the three settings (). Among the significant genes is OTLD1, a gene involved in chromatin modifications, which may potentially regulate FLC expression. Another significant gene is PDH-E1, which is involved in carbohydrate metabolism, a known regulation point of flowering time. We did not adjust these p-values for multiple testing because we only perform a small number of tests and, in view of small sample sizes, we do not want to sacrifice power. Future studies of the identified novel genes may increase the biological understanding of flowering time control and provide potential targets for breeding strategies in crops. The entire approach from modelling to biological experiments and findings is schematically described in.The genes are ranked by increasing summary rank, where ties are sorted according to the estimated median total causal effect taken over 100 stability runs (third column). The maximum expression is taken over the original log 2 data. The error (PCER) is the median PCER over the range of q values. SOC1, FRI and FLC are 3 of 119 curated flowering time genes in the Arabidopsis Reactome () (http://www.arabidopsisreactome.org). This is a highly significant enrichment of known curated regulators when compared with random guessing (p510 5 , hypergeometric test). Although not curated in Arabidopsis Reactome, also RPA2B and DWF4 are known to affect flowering time (). Since the ordering of the genes in the table is given by their summary rank, the values of median total causal effect and PCER are not decreasing monotonously. For instance, ATSUC6 has a smaller median total causal effect and a larger PCER than the endonuclease, but since its lower bound for the total causal effect is more stable, the former is ranked 10 positions higher than the latter. All genes from this list, for which mutant seeds were readily available and which were not already known to control flowering time, were used in the subsequent intervention experiments (indicated in bold). In total, intervention experiments were performed for 13 of the 25 top genes not previously known to regulate flowering (Supplementary Section S2.3).
Validation for S. cerevisiaeWe trained the plain IDA method, Lasso (), elastic net () and marginal correlation ranking on the observational data, and compared their receiver operating characteristic curves on absolute scale () showing a clear improvement of CStaR over plain IDA. Moreover, CStaR and IDA are clearly superior to high-dimensional regression methods and marginal correlation screening, which is in line with the earlier validation of IDA ().
DISCUSSIONWe propose CStaR as a general method to obtain a stable ranking of genes in terms of the strengths of their total causal effects on a phenotype of interest. An added value of our method is that, under some assumptions, this ranking comes with an error measure controlling false-positive selections. We showed that CStaR exhibits a large increase in sensitivity when compared with plain IDA and modern regression-type methods in S. cerevisiae (). Moreover, we demonstrated the success of CStaR for the biologically much more complex multicellular organism A. thaliana. However, in view of uncheckable assumptions (Supplementary Section S1), CStaR is not a tool for confirmatory causal inference. We used insertion mutant lines for experimental validation. This approach can provide very strong evidence for hypotheses about gene function but it often suffers from a high false-negative rate. Genetic networks are characterized by a high degree of functional redundancy, which can buffer effects of single mutations. The A. thaliana genome, for instance, underwent a relatively recent duplication causing partial redundancy between many orthologous gene pairs. Thus, often double mutants need to be tested to observe alterations in phenotype. In addition, the function of essential genes cannot be tested with insertion mutants. Therefore, the high proportion of confirmation in the test set of insertion mutants is highly reassuring. This makes it plausible that CStaR is relevant for commercial crops, by pointing to better target genes for marker-assisted breeding and transgenic approaches. In fact since CStaR is mathematically justified under clearly stated assumptions (), it has the potential to generalize many other settings in biology, agriculture and other fields where efficient design and prioritization of new intervention experiments is a core aim.Only genes are shown for which the insertion was experimentally verified and for which in at least one of the following three settings at least four replicates could be harvested for validation: days to bolting in short days (DTB-SD), days to bolting in long days (DTB-LD) and rosette leave number in long days (RLN-LD). Each mutant was tested versus a control group. p-values50.05 are written in bold (for complete results see Supplementary Tables S2S4). A missing entry indicates insufficient number of replicates for testing, i.e. less than four plants.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
D.J.Stekhoven et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Causal stability ranking at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
