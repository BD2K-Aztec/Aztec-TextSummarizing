Motivation: Genomic studies have revealed a substantial heritable component of the transcriptional state of the cell. To fully understand the genetic regulation of gene expression variability, it is important to study the effect of genotype in the context of external factors such as alternative environmental conditions. In model systems, explicit environmental perturbations have been considered for this purpose, allowing to directly test for environment-specific genetic effects. However, such experiments are limited to species that can be profiled in controlled environments, hampering their use in important systems such as human. Moreover, even in seemingly tightly regulated experimental conditions, subtle environmental perturbations cannot be ruled out, and hence unknown environmental influences are frequent. Here, we propose a model-based approach to simultaneously infer unmeasured environmental factors from gene expression profiles and use them in genetic analyses, identifying environment-specific associations between polymorphic loci and individual gene expression traits. Results: In extensive simulation studies, we show that our method is able to accurately reconstruct environmental factors and their interactions with genotype in a variety of settings. We further illustrate the use of our model in a real-world dataset in which one environmental factor has been explicitly experimentally controlled. Our method is able to accurately reconstruct the true underlying environmental factor even if it is not given as an input, allowing to detect genuine genotype–environment interactions. In addition to the known environmental factor, we find unmeasured factors involved in novel genotype– environment interactions. Our results suggest that interactions with both known and unknown environmental factors significantly contribute to gene expression variability. Availability: and implementation: Software available at http://pmbio.
INTRODUCTIONLarge-scale genotyping and expression profiling initiatives have fostered expression quantitative trait loci (eQTL) analyses, investigating the genetic component of gene expression variability. eQTL studies in human (), segregating yeast strains (), mouse () and Arabidopsis thaliana () have revealed an abundance of associations between genetic polymoprhisms and the expression levels of individual genes. While building this compendium of eQTLs in different genetic systems and species, it has become clear that the cellular and environmental context needs to be taken into account to fully understand the genetic architecture of gene expression (). One route toward investigating such context dependency is explicit experimental stratification. In human, expression profiling in different tissue types, both in unrelated individuals () and families (), has shown that eQTLs frequently have tissue-specific effect sizes, and in some cases exhibit opposite effects. Analogously, also different environmental backgrounds and cellular contexts may modulate the genetic control of molecular traits (), suggesting that environment-specific genetic effects, also called genotypeenvironment interactions, are the rule rather than the exception. Despite their relevance, molecular studies with explicit environmental perturbations are difficult to carry out in populationscale studies. Precise control of the environmental state cannot be achieved for many important organisms. For example in human, the relevant environment could be of climatological or social nature, and hence is either completely unknown () or can only be indirectly influenced via targeted sample selection (). Furthermore, the most relevant factors for molecular regulation may not be a global external condition but rather cellular factors, which are in turn driven by genetic or external factors (). In all of these settings, the most relevant context and environment are not directly measurable; hence, statistical inference of these factors is needed to study their implications on the transcriptional state. *To whom correspondence should be addressed.Recently, several methods have been proposed to account for unknown confounding in eQTL studies, a substantial proportion of which can be attributed to subtle environmental effects (). While these methods have been shown to substantially increase power in detecting true eQTLs, the potential of using such recovered factors to identify genotypeenvironment interactions has largely been overlooked. Here, we present an integrated probabilistic model, LInear Mixed Model Interaction (LIMMI), which allows for recovering unknown environmental or cellular factors from gene expression profiles and detecting genotypeenvironment interactions. LIMMI allows for a flexible class of environmental and genetic effects that act on gene expression, including direct effects and interactions between them (). At the same time, the model enforces that the estimated factors are truly environmental and not themselves under genetic control. We evaluate LIMMI on synthetic data, where we assess the ability of LIMMI to (i) recover the true simulated environmental state, (ii) better detect direct genetic effects and, in particular, (iii) identify genotypeenvironment interactions with unmeasured environmental factors. We then revisit an eQTL study on yeast (), where we compare the inference of LIMMI with a measured environmental variable. Beyond accurately recovering this known environmental effect, LIMMI retrieves an additional 14 factors that are orthogonal to the genetic state. When using these factors to test for environment-specific genetic effects, we find hotspots of genotypeenvironment interactions, some of which are enriched for known response processes to environmental stimuli. Finally, we demonstrate that including interactions between genotype and learnt factors in a mixed model improves both detection power as well as calibration of test statistics for direct genetic effects in an eQTL scan.
METHODSLIMMI is based on a linear additive model that explains phenotype variability as the sum of genetic and non-genetic factors. Formally, assume we are given an eQTL dataset comprising a gene expression matrix Y  y 1 ,. .. , y G  of G gene expression levels. Each expression profile y g is observed in N individuals, i.e. y g  y g, 1 ,. .. , y g, N . We assume that the expression estimates Y are variance stabilized, i.e. the measurement error is independent of the expression level. Suitable variance-stabilizing transformations have previously been proposed for both data from microarray technologies () and RNA-Seq data (). Expression variability is modeled as the sum of effects from single nucleotide polymorphisms (SNPs) S and non-genetic (environmental) factors X. The generative model underlying LIMMI allows for direct effects on the phenotype, as well as interaction effects between SNPs and environmental factors. Using the framework of linear mixed models, the joint contribution to the expression variability of a single gene g can be written as the sum of individual covariance matrices for each of these respective effect typesHere, the individual N  N covariance matrices explain the joint covariation across genes due to genetic effects (K S ) and environmental factors (K X ), while K I explains the joint covariation due to genotype environment interactions. Additionally, we include a genetic relatedness matrix K P as a variance component, to account for confounding due to population structure, which can be estimated from the genotype data itself (). To determine suitable expressions for the individual covariance matrices, let the matrix of genotypes for the same N individuals be S  s 1 ,. .. , s K  of K SNPs. We use a binary (0,1) encoding for homozygous and a (0,1,2) encoding for heterozygous organisms; however, other encodings can be considered as well. Furthermore, let X  X o , X h   denote the set of non-genetic factors that influence the gene expression levels, where X o 2 R NC are a prioriobserved (measured) environmental covariates and X h 2 R NL denote unobserved factors we would like to infer from the expression profiles. Let the symbol denote the element-wise product. An interacting pair of a SNP s k and a factor x q can then be represented by the vector s k x q . In this form, the factor effect is masked for all samples where the genetic state is zero, here the major allele. Other interaction models can be implemented in an analogous manner (HallgrmsdottirHallgrmsdo). Assuming only linear additive effects of single SNPs, environmental factors and their interactions, we write all variance components in the form of linear kernels:The set  K  f 2 , 2 , 2 , 2 p , 2 e g denotes all kernel parameters. The relevance (variance) of individual direct factor effects, direct SNP effects and factorSNP interactions is controlled by the relevance parameters 2 q , 2 k and 2 k, q , respectively. The covariance model in Equation (2) can also be derived from a linear model equivalence (see Supplementary Methods, Section 1), assuming a hierarchical prior on the effect sizes for interactions and direct effects across all genes.
InferenceThe large number of SNPs in real-world datasets renders learning the relevance parameters for all K genetic effects ( 2 k ) and K  Q interaction terms ( 2 k, q ) in Equation (2) infeasible, both computationally and. Illustration of regulatory effects on gene expression modeled by LIMMI. First, non-genetic environmental factors can either be measured (observed) or hidden. Their effect on gene expression is typically dominated by direct effects (blue). In addition, some factors may act in a genotype-specific manner, for example, with effects only standing out in a particular genetic background (red). Finally, there are standard genetic expression QTLs with individual genetic loci regulating gene expression levels (black)statistically (see also Section 2.2.4). However, it is safe to assume sparsity where only a small fraction of all genome-wide SNPs have a non-zero SNP effect or SNPfactor interaction effect (). In the following, we call SNPs with a non-zero main effect or interaction effect active; the relevance parameters ( 2 k and 2 k, q ) of all remaining SNPs are implicitly assumed to be zero, which is equivalent to them being dropped from the model. We exploit this assumption to construct an algorithm similar, in principle, to expectation maximization (EM). Let us denote the set of active direct effect SNPs ( 2 k 40) as S. Analogously, the set of active SNPfactor pairs with nonzero relevances ( 2 k, q 40) will be denoted I. Inference in the full model is then achieved by alternating between two operations. First, the factors X and model parameters  K are learnt for given active sets S and I. Second, for fixed state of X,  K , additional SNPs are added to the active sets S and I using a greedy forward selection strategy. A specific schedule of these updates is used to ensure convergence to accurate solutions. In Section 2.2, we describe this EM-like iterative training scheme. The technical building blocks of the individual training steps are presented in Section 2.2.1, describing the gradient-based optimization of model parameters, and in Section 2.2.2, addressing the selection of SNPs to be included in the model. More details about the implementation and the initialization of the model are available in the Supplementary Methods.
Iterative training of LIMMITraining is achieved in three steps. First, the state of the environmental factors X and the model parameters  K is inferred for empty active sets, where both the set of SNPs with a direct effect (S) and the interactions (I ) have no elements. The necessary parameter inference for given active sets is achieved using a gradient-based optimization approach (see Section 2.2.1). As previously shown (), this simplistic inference that ignores the effect of genotype may result in learnt hidden factors that are correlated with genotype and hence have a genetic component. To rule out genetic control of the latent factors, SNPs that are correlated with these hidden variables are included in the set S (see Section 2.2.2), and the model parameters and factors are retrained. This process is iterated until no additional SNPs reach genome-wide significance for association with any of the learnt factors X. As a result of this process, genotype and the learnt hidden factors are quasi-orthogonal (see alsofor further details). Once the environmental factors have been determined, genotypeenvironment interactions are detected and SNPfactor pairs that participate in a significant interaction are included in the set I (Section 2.2.3). The model parameters are once again updated. This step completes the training. Individual components of the final covariance can then be used to test for specific hypotheses; see Section 2.3.
Gradient-based inference of covariance parameters If theSNP effects and interactions are only present for a defined active set of direct SNP effects (S) and interactions between pairs of SNPs and factors (I ), the full likelihood in Equation (2) reduces towhere D is the overall covariance, which in turn is parametrized by X,  K and the active sets S and I. Here, we have dropped the mean effect to unclutter the notation, and the summation is restricted to the elements in the respective active sets. The log of the marginal likelihood from Equation (3) can be written as ln pY j S, X,  K , I , S  lnGradients of the marginal likelihood with respect to individual elements of X and hyperparameters  K can be calculated in closed form using the matrix derivativeand combing it with the covariance derivative with respect to the ith kernel parameter, d dK i D, using the chain rule ().Parameter learning can then be done using a maximum likelihood approach, jointly determining the most probable state of the hidden environmental states X and model parametersA standard gradient-based optimizer, such as L-BFGS-B (), can be used to take advantage of the availability of closed-form gradients with respect to the elements of X and  K. A discussion on how the latent dimensionality Q is chosen and the implications on the model fitting are provided in Supplementary Methods, Section 2.
Inclusion of genetic effects Individual SNPs are selected forinclusion in S. We follow the approach taken in, and test for correlation between individual factors x 1 ,. .. , x Q and all genomewide SNPs s 1 ,. .. , s K. In each iteration, SNPs that are in significant association [assessed using q-values () qv SNP ] are added to the active set S. The exact cutoff SNP is not critical, as it merely alters the number of SNPs in the model, thereby affecting computational speed. Robustness with respect to this significance cutoff has previously been demonstrated ().
Inclusion of interaction effectsAfter the iterative procedure to determine the state of the environmental factors has converged, it is possible to test for interactions between factors and individual SNPs. We do so by exhaustively testing for interactions between SNPs k 2 f1,. .. , Kg and factors q 2 f1,. .. , Qg (Section 2.3.1). Significant interaction terms (qv GxE ) are then added to the active set I. Finally, LIMMI relearns all the model parameters while taking into account the newly added interactions, which allow the model to explain non-linear dependencies due to genotypeenvironment interactions.
Identifiability and robustnessNaive inclusion of all possible effects is both computationally intractable and statistically not identifiable, as this would result in K  Q  K relevance parameters. Greedy step-wise strategies, in contrast, suffer from convergence to local optima. To reduce such side effects, we enforce sparsity in a two-step procedure. First, a cutoff is used for the inclusion of genetic markers ( SNP 0:1 in the case of the yeast dataset presented in Section 3.2) and interaction terms ( GxE 0:05 again in the case of the yeast dataset) into the model. Then, irrelevant variance parameters ( 2 k , 2 k, q ) are set to zero during inference by means of automatic relevance determination (). The empirical stability of this approach has been explored in previous work (). Although we have taken measures to ensure that the learnt factors are likely environmental, there are fundamental limitations on statistical identifiability. The correct identification of factors that exhibit genotype-specific interactions affecting large numbers of target genes is particularly challenging. The variance explained by such an interaction hotspot can be similar to the variance of a direct factor effect, such that a single factor may mistakingly be learnt as two separate factors. When testing for interactions with the main effect factor, the second one can explain away the interaction signals; hence, the interaction hotspot may not be detected. Thus, our approach depends on the assumption that the direct contribution of environmental factors dominates genotype-specific effects. This assumption is reasonable in practice, and we found LIMMI to be robust with respect to deviations from it (seeand d and Supplementary).
Computational efficiencyThere are two components of the LIMMI model that determine the computational complexity. First, the Gaussian process latent variable model (Section 2.2.1), estimating the covariance parameters and the environmental factors, has a complexity that is independent of the number of genes. Instead, its runtime is dominated by inversions of the covariance matrix, which scale cubically with the number of samples. Thanks to modern linear algebra implementations, these computations are tractable even for thousands of samples. Second, given the latent variables, LIMMI carries out mixed model interaction and association tests relating inferred factors, genes and SNPs. Here, we build on recent advances in mixed models (), reducing the computational complexity of these statistical tests to a cost that is linear in the number of samples and tested hypotheses. Moreover, this second step can easily be parallelized across hypotheses, which is supported in our software implementation. As a result, LIMMI can be applied to human-scale datasets with hundreds of samples, $50 000 gene expression levels and $100 000 SNPs. For example, on the yeast dataset analyzed in Section 3.2, LIMMI converged within only 50 min
Statistical association and interaction testingThe ultimate goal is to use the covariance models described above to carry out tests for genetic associations (eQTLS) as well as tests for genotypeenvironment interactions. Statistical testing is also used to iteratively expand the LIMMI covariance model (Section 2.1). For testing, we use a strategy based on linear mixed models, where a fitted covariance structure D accounts for confounding and other factors that cause expression variability, whereas the fixed effect assesses the relevance of the effect of interestThe overall variance of the trait 2 g can be efficiently determined in closed form for each test (SNPgene pair), whereas g requires a gridbased optimization. We use the approximation proposed in, and determine g once on the null model, and keep this variance ratio fixed for all genome-wide tests. When testing for associations and interactions with LIMMI, the covariance D is intended to capture the effects from other SNPs, confounding factors and interactions. The covariance is derived from the components fitted on the null model (Section 2.1). A mechanistic understanding of the individual covariance components can be gained when deriving the individual covariance parameters from a linear model equivalence (Supplementary Methods, Section 1). In Section 2.3.1, we describe the covariance used for genotypefactor interaction tests (genotypeenvironment interactions). Association tests between genotype and expression traits (eQTL) are described in Section 2.3.2. Both, for interaction and association scans, we obtain P-values by applying a likelihood ratio test. For genome-wide significance estimates, we used false discovery rate (FDR) estimates from the q-value package ().
Interaction testThe likelihood ratio corresponding to the test for a particular SNP k and factor q affecting gene g can be expressed as, g and q, g correspond to the fitted fixed effect weight of the interaction term, the SNP effect and the factor effect, respectively. We have dropped the mean effect g to unclutter the notation. The background covariance includes all other additive effects and is defined asq0 , accounting for known covariates and the direct effects of all factors but factor q, which is tested.
Association test Analogous likelihood ratio tests can be derivedfor the hypothesis that SNP k is in association with gene g LOD asso k, g  logHere, the fixed-effect term includes the direct effect of the SNP, and the confounding covariance accounts for direct effects of the learnt environmental factors (K X ) as well as the detected interactions (K I ), i.e. Again, we have dropped the mean-effect term from Equation (8).
LIMMI-svaIn principle, in the first step of the procedure outlined in Section 2.2.1, any latent variable model could be used to infer environmental factors. For comparison, we have implemented a variant of LIMMI called LIMMI-sva. LIMMI-sva uses surrogate variable analysis (SVA) (), which does not encourage orthogonality of learnt factors and genotype and does not rely on the iterative model refinement described in Section 2.2. The details of the testing procedure are described in Supplementary Methods, Section 3.
RESULTSWe evaluated the ability of LIMMI to retrieve genuine genotypeenvironment interactions. In particular, we studied the relative performance of two approaches, LIMMI and LIMMI-sva, that share the same testing procedure but infer the unknown environment in different ways (Section 2.4). We also considered a standard linear association test as a baseline method.
Simulation studyFirst, we tested LIMMI on simulated data, where the underlying true associations and genotypeenvironment interactions are known. The simulation procedure largely follows previous studies to assess the performance of eQTL methods (). Each simulated dataset consisted of 800 SNPs simulated as from an F2 cross and 1000 gene expression levels. We simulated five environmental factors that have both direct effects on gene expression and interactions with genotype. In addition, we also considered five simulated technical factors that affect gene expression directly but are independent of genotype. The factor profiles were independently drawn from N 0, 1, and the effect sizes of factors q on genes g was sampled from w g, q $ N 0, 0:45, which is similar to empirical estimates from the yeast dataset (). We added 800 simulated associations with effect sizes sampled from w g, k $ N 0, 0:05 as well as five interactions between randomly chosen pairs of genetic loci and environmental factors, each affecting 15% of the genes and with an effect size sampled from N 0, 0:15. Broad genetic effects, such as trans-acting genetic variants, can complicate the recovery of the confounding factors (). If the genetics and the environment are not modeled jointly, part of the genetic signal will be captured by the estimated confounding factors, making the discovery of genotypeenvironment interactions even harder. To further investigate this hypothesis, we simulated five broad trans-acting genetic variants, each affecting 20% of the genes and with an effect size sampled from N 0, 0:2. Finally, we added independent measurement noise to each gene g $ N 0, 0:15. The simulation framework used here does not favor any of the considered methods, as they all share the assumption that the environmental state is characterized by few environmental factors, i.e. is low rank. First, we checked that factor models like LIMMI are able to recover environmental variables and geneenvironment regulatory interactions.depicts the receiver operating characteristic (ROC) curve, assessing the true positive rate of alternative methods as a function of the permitted false positive rate (FPR). For practical applications, the regime of few false positives is most relevant; hence, we consider the ROC analysis on the range of FPR between 0 and 0.2. Determining an explicit mapping between the learnt environmental factors and the simulated ones is difficult and may introduce biases. Thus, we assessed the accuracy of recovering SNPgene pairs with a detected interaction for any of the learnt environmental factors. Both LIMMI-sva and LIMMI detected many of the simulated genotypeenvironment interactions, where LIMMI significantly outperformed LIMMI-sva. Next, we evaluated alternative methods for detecting eQTLs, i.e. direct associations between polymorphic loci and gene expression levels that are not environment specific (). Standard linear regression (LINEAR) ignores the presence of unknown environmental factors, which resulted in a poor recovery of true associations. SVA and PANAMA account for the direct effect of learnt environmental factors, resulting in a considerable improvement compared with the linear model (see also discussion in). Finally, LIMMI also accounts for both the learnt environmental factors and their interactions with the genetic state, resulting in a marginal but consistent improvement over PANAMA. Supplementarypresents the analogous results when considering a precisionrecall measure, leading to the same conclusions. Finally, we investigated the impact when changing the relative magnitude of direct environmental effects and genotypeenvironment interactions.and d show the respective area under the ROC curve (AUC) when varying the relative fractions of variance explained by genotypeenvironment interactions and direct environmental effects. In each plot, the leftmost point corresponds to a setting with very small (0.01) relative proportion of variance explained by interactions, whereas the rightmost point corresponds to an equal proportion (0.50) of variance explained by direct effects and interactions. As expected, the ability of LIMMI to detect genotypeenvironment interactions improved with larger relative effect sizes of the interactions (), whereas the performance of LIMMI-sva degraded when the relative variance explained by interactions exceeded 10%. This observation exemplifies the model misfit of approaches like SVA that ignore genotypeenvironment interactions during inference. Analogous conclusions hold when considering the performance of the considered methods to detect direct associations or eQTLs (). Here, PANAMA came close second and again SVA degraded in performance for increasing relevance of the interaction terms. Remarkably, starting from 30% of the variance explained by genotypeenvironment interactions, a standard linear association test that ignores unknown environments entirely yielded more accurate results than SVA. In addition to varying the relative proportion of interactions and direct environmental effects, we also considered varying the variance of each effect type in isolation. Supplementaryshows analogous AUC performances when varying the variance explained by direct factor effects (Supplementaryand b) or the variance from genotypefactor interactions (Supplementaryand d), keeping the other term constant. In contrast to alternative methods, LIMMI was able to detect genotypeenvironment interactions even for weak interaction effects (510%, Supplementary), suggesting that the method is suitable in studies where genotypeenvironment interactions have a subtle effect. LIMMI is related to previous approaches, such as SVA () and PANAMA (), that have predominantly been intended to identify and account for the effect of technical factors. To assess the effect of technical factors versus environmental effects, we considered a series of simulated settings, changing the relative proportions of environmental and technical factors. In principle, LIMMI will retrieve both types of factors on equal footing; however, only environmental influences are expected to yield interactions with the genetic state. Indeed, the results presented in Supplementarysupport that even when almost all factors are technical and do not interact with genotype, LIMMI is still able to recover the small number of genuine genotypeenvironment interactions.
Applications in yeast genetics of gene expressionWe revisited the yeast study from Smith and Kruglyak (2008), studying genetic regulation of gene expression as a function of environmental background. In this study, an F2 population of yeast strains has been expression profiled in two contrasting growth media: glucose and ethanol. Thus, the growth medium is a strong and likely dominant environmental factor. In the primary analysis, both major direct genetic effects (associations) as well as prevalent genotypeenvironment interactions have been reported (). LIMMI accurately recovers the genotypeenvironment interactions with a measured environmental factor We applied LIMMI and LIMMI-sva to the yeast dataset without providing knowledge about the measured environmental factor that corresponds to the growth medium as an input. SVA identified nine latent factors, and LIMMI found 15 factors. When considering each learnt factor to test for genotypeenvironment interactions with individual gene expression levels, LIMMI-sva retrieved a larger number of genes with significant effects than LIMMI (, at comparable statistical calibration; see Supplementary Figs S5 and S6). For both methods, the factor with the greatest number of genotype/factor interactions was strikingly correlated (r ! 0:99) with the known environmental state that corresponds to the ethanol/glucose condition. Other factors were largely uncorrelated with this known environmental variable (Supplementary), suggesting that the first factor indeed captures most of the effect due to the ethanol/glucose condition. First, we focused on the recovered factor that is a likely proxy for the true environmental state.depicts the ROC curve, assessing the accuracy of genotypeenvironment interactions recovered by LIMMI and LIMMI-sva when using genotypeenvironment effects with the known environment as ground truth (as done in). LIMMI outperformed LIMMI-sva, which is likely due to a combination of two important differences between these methods. First, LIMMI incorporates a constraint such that recovered factors are uncorrelated with genotype, whereas many of the factors retrieved by SVA are themselves under genetic control (Supplementary). Second, the statistical test for interactions used in LIMMI accounts for direct effects of all other learnt factors, explaining away nuisance variation due to other environmental axes (Section 2.3.1). To investigate this further, we considered different variants of LIMMI-sva where alternative testing strategies were compared. Despite some improvement, this adjustment alone did not cure the inferior performance of LIMMI-sva (Supplementary), suggesting that both the lower extent of genetic correlation and the refined testing procedure contribute to the performance of LIMMI. Novel genotypeenvironment interactions with unknown environmental effects In addition to interactions that correspond to the known environmental factor of the glucose/ethanol contrast, both LIMMI-sva and LIMMI retrieved additional factors, which were considered for possible G  E interactions (). The factors recovered by LIMMI-sva tended to be in strong association with genotype, suggesting that they capture genetic signals instead of environmental effects. The factors retrieved by LIMMI, in contrast, were found to be orthogonal to the genetic signal (Supplementary). A map of the genetic loci and regulated genes for interactions with all factors detected by LIMMI is shown in(interaction results for each individual factor are given in Supplementary). Notably, genotypeenvironment interactions with the factor that recapitulates the ethanol/glucose effect (factor 0) were enriched in the proximity of the regulated genes, suggesting a cis mechanism. Other factors yielded interactions that involve distal loci, and hence have a putative trans mechanism (Supplementary). A particularly prominent hotspot appeared for factor 13 in chromosome 4, where LIMMI detected genotypeenvironment interactions involving 10 distinct SNPs in that region. In the direct vicinity of these SNPs (AE10 kb), there were six annotated genes, four of which have previously been reported as implicated with temperature response (YDL143W, YDL139C, YDL135C, YDL132W) (). This enrichment suggests that factor 13 may explain subtle temperature variation in the experiment. Corresponding maps that reflect the interactions retrieved by LIMMI-sva are given in SupplementaryThe number of genes with at least one significant genotypeenvironment interaction (FDR 0:01) as identified by LIMMI and SVA. The first factor was most correlated with the measured ethanol/glucose contrast, capturing this experimental condition. (b) ROC curves for LIMMI-sva and LIMMI, assessing the accuracy of recovering pairs of genetic loci and genes in statistical interactions with the first factor. Ground truth information was derived from genotypeenvironment tests with the measured environment (FDR 0:01). The dashed line indicates the accuracy of a random predictorDetecting regulatory geneenvironment interactions, whereas Supplementarydepicts the interaction map when using the known environmental condition (glucose/ethanol) to test for genotypeenvironment interactions. The results obtained in the latter are remarkably similar to the ones obtained to LIMMI interactions on Factor 0, which is in line with the ROC analyses discussed earlier (). Overall, LIMMI identified more trans bands for genotypeenvironment effects than LIMMI-sva. Genotypeenvironment interaction hotspot may confound genetic association analyses Finally, we considered the ability of different models to call direct eQTL associations between genetic loci and individual gene expression levels.shows the number of associations retrieved by alternative methods as a function of the FDR cutoff. As in the simulated settings (), LIMMI accounts for the interaction effects found, which controls for nuisance variation due to these effects. As a result, LIMMI identified additional cis eQTLs, while the number of trans eQTLs decreased when compared with PANAMA. At the same time, the P-value statistics of LIMMI was slightly more uniform than PANAMA, suggesting that better control for confounding has been achieved (Supplementary Figs S5 and S6). While more uniform P-values support an improved calibration () of the methods presented here, some inflation of the test statistics was retained, which is an expected consequence of the presence of extensive trans hotspots (see, for a discussion). These results suggest that including interaction terms into the model can also be beneficial to identify direct genetic effects in real studies. On one hand, this finding supports the conjecture that the interactions retrieved by LIMMI are indeed genuine, as they explain variance that cannot be captured by a model that relies on fully additive effects. On the other hand, it is clear that genotypeenvironment effects contribute to gene expression variability, and accounting for their effect in genetic analyses has similar benefits than accounting for hidden confounding () or correcting for population structure (). eQTLs retrieved by LIMMI have a slightly better cis enrichment compared with PANAMA, a criterion previously suggested to judge the plausibility of eQTL results ().
DISCUSSIONHere, we have presented a novel approach to detect genotype environment interactions with unmeasured environmental factors. LIMMI is able to recover the unmeasured environmental state solely from gene expression data. Once learnt, these variables can be used in genetic analyses to investigate interactions between environmental factors and genotype with a regulatory effect on gene expression traits. Approaches like LIMMI are relevant for virtually any genetic study of high-dimensional molecular traits, in particular if the environmental state is only partially measured or remains entirely unknown (). Here, we illustrated and assessed LIMMI in simulated examples and in retrospective analyses of data from yeast genetics. We compared genotypeenvironment interactions with learnt environments with interactions found when using explicit environmental measurements. First, LIMMI was able to accurately detect previously known interactions. Second, we found novel genotypeenvironment interactions beyond what can be detected when relying on the measured environmental state. These additional effects were predominantly trans-acting, with some loci having widespread effects on large fractions of the expression traits. In the case of the largest hotspot, the interacting locus overlapped with a group of genes involved in temperature sensitivity, providing a plausible explanation of the mechanistic underpinning of this finding. Finally, we have shown how the recovered interactions can be used to refine statistical testing procedures. Accounting for the effect of genotypeenvironment interactions within a LIMMI eQTL scan resulted in increased power to detect true associations in simulations and yielded improved test statistics on real data. LIMMI is related to a range of existing factor models, in particular techniques that model hidden expression determinants to correct for their confounding effect. These methods can be broadly grouped in two classes: models that are aimed at retrieving a set of confounding factors explicitly () and models that account for the variance introduced by confounding factors (). In principle, any of the models that retrieve an explicit representation of factors can be used for interaction analyses like the one presented here. Specifically, in this article, we implemented a version of our method that was using SVA for this purpose. LIMMI is most closely related and builds on PANAMA (); however, we propose a new route toward understanding the role of the environment in a genetic context rather than merely 'correcting it away'. For this purpose, we extend PANAMA in several ways. First, we introduce a systematic approach to use inferred environments to test for genotypeenvironment interactions while accounting for the effect of unknown environments. Second, we show how the detected genotypeenvironment interactions can be used to further refine the statistical testing of eQTLs. Other methods like SVA (), PEER () and the method by Listgarten et al. () do not focus on recovering interactions per se, although we have created a modified variant of SVA for the purpose of comparison. The main shortcoming of these techniques is the lack of an effective mechanism to ensure that the learnt factors are not driven by genotype, which leads to the inferior performance of LIMMI-sva in our experiments. In conclusion, LIMMI is a methodological advance that allows for refined inference of environmental factors from molecular profiling data. When used in genetic analyses, these learnt variables help to improve the mechanistic understanding of molecular traits, thereby increasing the fraction of phenotype variability that can be explained. Approaches as the one presented here will become even more useful when dataset sizes increase further, providing sufficient power to estimate even more complex models and effect types between the genetic state, known and hidden environments and the transcriptional state of the cell.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Detecting regulatory geneenvironment interactions at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
N.Fusi et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
