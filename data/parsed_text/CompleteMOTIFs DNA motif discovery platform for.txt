CompleteMOTIFs (cMOTIFs) is an integrated web tool developed to facilitate systematic discovery of overrepresented transcription factor binding motifs from high-throughput chromatin immunoprecipitation experiments. Comprehensive annotations and Boolean logic operations on multiple peak locations enable users to focus on genomic regions of interest for de novo motif discovery using tools such as MEME, Weeder and ChIPMunk. The pipeline incorporates a scanning tool for known motifs from TRANSFAC and JASPAR databases, and performs an enrichment test using local or precalculated background models that significantly improve the motif scanning result. Furthermore, using the cMOTIFs pipeline, we demonstrated that multiple transcription factors could cooperatively bind to the upstream of important stem cell differentiation regulators. Availability:
INTRODUCTIONGene expression is a complex process that is coordinately regulated by interactions of multiple transcription factors (TFs) and other proteins that form promoter and enhancer complexes. The recent development of next-generation sequencing technologies has made it possible to determine in vivo and in vitro bindings of diverse TFs on a genomic scale (i.e. ChIP-Seq). One immediate question is whether the peak regions are functionally associated with the transcriptional regulation of target genes. An indication of such functional associations is the presence of loci occupied by multiple TFs or highly conserved sequences across species (). Hence, an important step towards understanding functional binding events is to study the presence of DNA sequence motifs in the context of nearby TFs, genomic features and epigenetic modifications. * To whom correspondence should be addressed.  The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.There are several challenges in finding motifs in peak regions identified from TF binding experiments. In the case where only a subset of ChIP-Seq peaks has common motifs, de novo discovery tools might not be optimal. Scanning for known motifs is faster and capable of detecting motifs that appear less frequently; however, the relatively short (425 bp) nature of protein-binding motifs can produce non-significant results. Many tools such as GimmeMOTIFs (van), Tmod () and MoAn () have been deployed to identify sequence motifs, while RSAT () and Galaxy () provide more comprehensive means to analyse regulatory sequences in general. Each method has its own strength in identifying potential transcription factor binding site (TFBS); however, it is crucial to combine results from complementary tools () and provide an intuitive interface that streamlines peak annotation, filtering, motif discovery and summary. CompleteMOTIFs (cMOTIFs) was developed to provide biologists an easy to use yet comprehensive web tool for ChIP-seq data analysis. First, peak regions are annotated with comprehensive genomic information such as known genes, conservation scores and repeating sequence elements. Second, Boolean logic operations such as intersection and union can combine multiple datasets from different TF bindings or histone modification states. Using the annotation and Boolean operations, users can filter and combine peak lists from one or multiple experiments, facilitating the study of cooperative TF binding events (). Third, combining the top 10 ranked motifs from three de novo methods and known motif scanning using background models helps to identify novel or known TFBS of interest as well as possible co-factor binding sites.
IMPLEMENTATIONThe cMOTIFs pipeline was built using MySQL, Perl, CGI and R statistical language, and the overview of workflow is illustrated in. Input format: the pipeline accepts DNA sequences in FASTA format or genomic coordinates in BED or GFF formats. Format conversion tools are provided for human (hg18, hg19), mouse (mm9) and rat (rn4) genomes.Ensembl), multispecies conservation scores (PhastCons) and repeating sequence elements (RepeatMasker), which enable users to select regions based on any combination of annotation criteria. The GOstats R library () was integrated to the pipeline to summarize enriched Gene Ontology categories for the peak-associated genes. For instance, users can select peaks, which are highly conserved, contain no repeating sequence elements, and are located within 10 kb of transcription start sites of known genes, for subsequent motif discovery processes.Boolean logic operations with multiple datasets: eight operations are provided to perform intersection, union, subtraction, common merge, common region, merge by distance, unique and extension on multiple genomic-region files (more details on the web site). For instance, to identify possible multiple transcription factor binding loci (MTL), users can merge neighbouring motif-enriched regions from different TF experiments. Motif discovery: we incorporated three existing de novo discovery algorithms [MEME (), Weeder () and ChIPMunk (and a motif scanning method [Patser (with position-specific scoring matrices (PSSM) from databases including TRANSFAC (public version 7.0) () and JASPAR () () to prioritize overrepresented motifs. The pipeline also accepts user-defined PSSM for motif scanning. The Computer Unified Device Architecture (CUDA) library enhanced MEME performance (). A suffix-tree-based exhaustive enumeration algorithm, Weeder (v1.4.2), and an iterative algorithm that combines greedy optimization with bootstrapping, ChIPMunk, have been included. The Patser [version 3b, ()] is used to scan motifs from JASPAR and TRANSFAC databases. After the original Patser scanning, each target sequence is shuffled N times (default N = 1000) while maintaining (mono, di or tri) nucleotides frequency to create a random background model based on user input sequences or pre-compiled upstream sequences for each species. A permutation P-value is calculated from the frequency of random motif occurrences with the false discovery rate calculation (). This procedure allows estimating the significance of a motif occurrence in a target sequence compared with a set of randomly shuffled sequences. The current version of the pipeline allows up to a total of 500 000 bases for motif discovery, and this can be increased to 5 million bases if users choose to run ChIPMunk alone.
Motif summary: the top 10 motifs from the above four methods are ranked with corresponding scores and frequencies, and summarized with the STAMP tool by clustering motifs based on similarities (), and loci can be saved as BED format for further visual inspection and iterative analysis. Results are confidentially stored in users' personal accounts.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [14:49 2/2/2011 Bioinformatics-btq707.tex]
RESULTS AND DISCUSSION We demonstrated our pipeline with a previously published ChIPSeq dataset, which mapped binding locations of 13 TFs involved in embryonic stem cell differentiation (Chen et al., 2008). For 12 of the 13 TFs (except for E2f1), the pipeline successfully identified the reported binding motifs as the top-ranked motifs. Notably, the dinucleotide shuffling improved motif rankings from Patser (see Supplementary Material). The pipeline facilitates identification of multiple TF-binding loci. For instance, after processing the top 500 peaks from Nanog, Oct4 (encoded by Pou5f1 gene) and Sox2 TF profiles, we found a subset of peaks enriched with known binding motifs in JASPAR. Using Boolean logic, we merged neighbouring motif '+'regions within 500 bp and identified 35 MTL, each of which was occupied by Nanog, Oct4 and Sox2, suggesting collaborative binding from all three. These illustrate some examples of complex gene expression regulations that can be analysed efficiently with the pipeline (see Supplementary Material for the detail).
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
