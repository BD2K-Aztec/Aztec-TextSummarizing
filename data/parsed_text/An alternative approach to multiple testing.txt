Introduction: An increasing number of studies investigates the influence of local genetic variation on DNA methylation levels, so-called in cis methylation quantitative trait loci (meQTLs). A common multiple testing approach in genome-wide cis meQTL studies limits the false discovery rate (FDR) among all CpG–SNP pairs to 0.05 and reports on CpGs from the significant CpG–SNP pairs. However, a statistical test for each CpG is not performed, potentially increasing the proportion of CpGs falsely reported on. Here, we presented an alternative approach that properly control for multiple testing at the CpG level. Results: We performed cis meQTL mapping for varying window sizes using publicly available single-nucleotide polymorphism (SNP) and 450 kb data, extracting the CpGs from the significant CpG–SNP pairs (FDR50:05). Using a new bait-and-switch simulation approach, we show that up to 50% of the CpGs found in the simulated data may be false-positive results. We present an alternative two-step multiple testing approach using the Simes and Benjamini–Hochberg procedures that does control the FDR among the CpGs, as confirmed by the bait-and-switch simulation. This approach indicates the use of window sizes in cis meQTL mapping studies that are significantly smaller than commonly adopted.
INTRODUCTIONGenome-wide association studies (GWASs) are widely used to uncover the genetic basis of complex disease. Disease-associated genetic variants identified in GWASs are commonly located in non-coding regions, leaving the molecular mechanism underlying the associations unclear (). The likely mechanism involves an effect on transcriptional activity of genes nearby (cis) or located distantly (trans), for example, by influencing epigenetic regulation (). This can be studied by investigating the relationship between genetic variation, and epigenetic marks, including DNA methylation, and gene expression. Already, many studies have reported on associations of specific genetic variants with variation in gene expression (expression QTL or eQTLs) () and DNA methylation, in particular the methylation of cytosines in CpG dinucleotides (e.g.) (DNA methylation quantitative trait loci or meQTLs). Creating catalogs of meQTLs and eQTLs will be instrumental in the discovery of genetic mechanisms determining DNA methylation and gene expression, the possible interplay between the two, and eventually the etiology of common diseases. To achieve this goal, further development of sound statistical methodology will be important. Typically in meQTL and eQTL studies, a GWAS (i.e. testing hundreds of thousands to millions of single-nucleotide polymorphisms, SNPs) is performed for the level of methylation of every CpG measured or the level of transcription of every gene (more generally, for every transcript or exon), respectively, leading to a vast amount of possible combinations to investigate. Although we will focus on cis meQTL studies, we note that the same principles and problems may also apply to cis eQTL studies. With the recent introduction of the Illumina 450 k DNA methylation array (), meQTL studies have become possible investigating4400 thousand CpGs in large numbers of subjects. To test for associations of methylation at CpGs with genetic variants in cis, that is locally, studies have been considering SNPs anywhere between 5 (Gutierrez) to 1000 kb () from measured CpGs. Particularly large window sizes will result in hundreds of millions statistical tests, and thus brings about a huge multiple testing problem. A common strategy to account for multiple testing in meQTL studies is to control the false discovery rate (FDR;) of all significantly associated CpGSNP pairs at 0.05 (e.g.). This means that 5% of all significantly associated CpGSNP pairs are expected to be false-positive results. Owing to the extensive linkage disequilibrium (LD) in the human genome, individual CpGs will frequently be associated with many SNPs. Hence, a particular CpG will often occur many *To whom correspondence should be addressed. times in the list of significant CpGSNP pairs. In practice, this is redundant information because LD structure renders it impossible to pinpoint the causal SNP responsible for the variation in DNA methylation using statistical means (cf. GWAS;). Hence, the results reported on and further analyses generally focus on the CpGs in the list of significant CpG-SNP associations, i.e. all CpGs that significantly associate with at least one SNP (e.g.). We will refer to this approach as the CpGSNP pair-based approach. A large proportion of CpGs among the FDR significant CpGSNP pairs may be false-positive results (). To obtain a list of CpGs influenced by genetic variation in cis that is properly controlled for multiple testing, we propose to formally test each CpG, obtaining a single valid P-value per CpG and control the FDR among those Pvalues, which we will refer to as the CpG-based approach. Using a new bait-and-switch simulation scheme, we compare the proportion of falsely identified CpGs using the CpGSNP pair-based approach and our proposed CpG-based approach in simulated data.
METHODS
DataWe used Illumina 450 k DNA methylation data () and Illumina HumanHap 550 k SNP data () on 96 unrelated healthy Caucasian Americans. The DNA samples were obtained from lymphoblastoid cell lines included in the Human Variation panel (sample set HD100CAU; Coriell Cell Repositories). Both datasets are publicly available from the Gene Expression Omnibus (GEO) data repository (accession numbers GSE36369 and GSE24260, respectively). The SNP array data were imputed to 30 038 302 SNPs based on the 1000 Genomes Central European (CEU) reference panel and using IMPUTE v2 (). A dosage value ranging from 0 to 2 reflected the uncertainty in the imputation for the imputed SNPs. We selected SNPs with a minor allele frequency45%, a minimum call rate of 95% and an imputation quality score of at least 0.4, leaving 6 596 758 SNPs for analysis. The quality control of the 450 k array was done based on the signal intensities and detection P-values. We set any beta values (), a measure of the DNA methylation fraction, with a corresponding detection P-value50.01 to missing. Next, we removed any samples with a log2 median intensity under 10.5 in either the methylated or the unmethylated signal. In addition, we removed any probes or samples with a call rate 595%. Finally, we removed probes mapping to the sex chromosomes, mapping ambiguously to the genome (), or with an SNP in the interrogated CpG (MAF41% in 1000 Genomes). These filters resulted in 423 825 probes left for analysis out of the 482 421 probes on the array targeting CpG sites. The normalization of the 450 kb data consisted of a correction for background signal, followed by a dyebias correction. Both procedures were performed using the methylumi package (). All further analyses were done using beta values. To verify that genotype and methylation data were linked to the correct sample identified, MixupMapper was used (). For 77 of the 93 samples remaining after quality control, SNP and methylation data could be linked (Supplementary Tables S1 and S2).
meQTL mappingWe tested all associations between genotypes and methylation of CpGs in cis, that is, locally, defined by window sizes from 1 to 500 kb around each CpG, calculating the Spearman rank correlation between the imputed dosage values and beta values. To this end, we use the Matrix eQTL package (). Because the Matrix eQTL package is only able to calculate the Pearson correlation, which is less robust to outliers than the Spearman rank correlation, we pre-calculated the ranks of the observed values for all CpGs and SNPs as input for Matrix eQTL to obtain a test on the basis of the Spearman correlation. The Matrix eQTL package provides a list of all CpGSNP pairs tested across all windows evaluated and the P-values reflecting the statistical significance of the associations. Obtaining a list of statistically significant CpGSNP pairs was achieved by limiting the FDR among the CpGSNP pairs to 0.05.
Obtaining an FDR controlled list of CpGs influenced by genetic variationAlthough the FDR among the CpGSNP pairs is controlled at 0.05, there is no guarantee that this is also true for the set of CpGs among these pairs. No formal statistical test is performed for each CpG individually, testing the global null hypothesis H 0 of no association between the variation in methylation and genetic variation in cis. To obtain a list of CpGs that is controlled at an FDR of 0.05, we proceed as follows. First, we perform a statistical test to assess the global null hypothesis H 0;i of no association between a CpG i and the SNPs in cis to obtain one valid P-value for each CpG. Next, we apply the BenjaminiHochberg procedure () to these P-values to obtain an FDR controlled list of CpGs associated with genetic variation. As commonly used software packages return P-values p i;j for all CpGSNP pairs (i, j) tested, we propose to use the p i;j to test the global null hypothesis H 0;i. The Bonferroni correction multiplies the minimum of the observed Pvalues in a window by the number of such P-values as follows:P i =k i min p 1;i ;. .. ; p ki;i   1 where k i is the number of SNPs in that window. The Bonferroni correction is conservative in the case of dependent P-values (like in the case of LD between SNPs), as the effective number of tests done may be smaller than the number of tests corrected for by Bonferroni. Hence, we propose to use the Simes procedure () (see Supplementary Materials), a method developed specifically to test a global null hypothesis H 0. This method makes the extra assumption of positive dependence among the Pvalues, similar to the BenjaminiHochberg procedure (). The Simes procedure implicitly takes these dependencies into account, yielding a less conservative P-value than the Bonferroni correction. The Simes procedure orders the P-values belonging to CpG i in ascending order, such that p 1;i. .. p ki;i. Next, a P-value P i for CpG i is calculated by multiplying each p j;i by a smaller factor k i =j and taking the minimum of these corrected P-values:P i =min j :Both the Bonferroni procedure and the Simes procedure multiply the smallest P-value p 1;i by k i. However, the Simes procedure multiplies the larger p i;j by a smaller factor, making the Simes procedure a more liberal procedure in the case of positively correlated P-values.
Estimating the CpG-level false discovery proportion in a simulated setting using the bait-and-switch simulation procedureWe have discussed two approaches for compiling a list of CpGs influenced by genetic variation: the CpGSNP pair-based approach and our CpG-based approach. We will now discuss a novel data-based simulation scheme called the bait-and-switch simulation to provide an assessment of the performance of these approaches in terms of the proportion of CpGs falsely identified as being significantly associated with genetic variation in a realistic simulation setting. Because simulation of realistic genome-wide genotype and methylation data is hard to do from scratch, we choose to modify the current dataset in such a way that we have knowledge of what null hypotheses are true, i.e. which CpGs should not associate with any genetic variation. This simulation consists of several steps and is depicted in:(1) Within-window correction: perform the Simes correction within each CpG's window separately. Take the minimum adjusted Pvalue as the P-value for this CpG.(2) Between-windows correction: control the FDR among the newly calculated P-values to obtain a list of FDR significant CpGs.(3) The data consisting of FDR significant CpGs will be called the bait set. The rest of the data, the non-significant CpGs, are called the switch set.(4) Permute the methylation values for the switch set, leaving the data in the bait set and the genotype data intact.(5) Perform the CpGSNP pair-based approach and the CpG-based approach on the simulated data, obtaining a list of significant CpGs for each approach.To get an estimate of the CpG-level FDR, we calculate the proportion of the CpGs obtained in step 3 coming from the switch set. Although we do not know which of the CpGs in the bait set are truly associated with genetic variation, we do know that none of the CpGs in the switch set have any such association. As a result, the calculated FDP is a lower bound. The CpG-level FDR is the average of the different realizations of the FDP coming from many repetitions of the same simulation experiment.
RESULTS
CpGSNP pair-based meQTL mapping approachWe performed cis meQTL mapping, varying the window size from 1 to 500 kb. For each window size, we applied the the CpGSNP pair-based approach, obtaining a list of statistically significant CpGSNP pairs and a list of the CpGs among these CpGSNP pairs, i.e. the CpGs that are associated with at least one SNP. Despite the relatively small sample size,shows that the BenjaminiHochberg method finds an increasing number of CpGSNP pairs with increasing window size, with a maximum of 223 428 CpGSNP pairs at a 200 kb window and a maximum of 10 034 CpGs at the 100 kb window size. If we keep expanding the search window around each CpG, the multiple testing burden becomes too great, leading to a slight decrease in the number of CpGSNP pairs and CpGs in that list. The increase in the number of CpGSNP pairs can be mainly attributed to LD. When observing a statistically significant CpGSNP pair, LD may virtually guarantee finding more significant CpGSNP pairs if that SNP is strongly correlated to other nearby SNPs and we expand the window around each CpG. This is illustrated by the LocusZoom plot () for a CpG (cg12247378) associated with several SNPs on 22q13.1 in. Many of the SNPs associated with this CpG are in LD and will be included with an increasing window size.
Evaluating the CpG-level false discovery proportion in a simulated setting using the bait-and-switch simulationLD causes identification of the causal SNP responsible for the variation in methylation to be impossible by statistical means.Therefore, it would be more insightful to consider individual CpGs only, instead of focusing on all CpGSNP pairs. Following the CpGSNP pair-based approach, we report on the CpGs from the FDR significant CpGSNP pairs found (see), i.e. the CpGs that associate with at least one SNP. However, this set of CpGs has no guarantee of FDR control and likely includes many false-positive CpGs. To evaluate the CpG-level FDP in a controlled setting, we use the bait-and-switch simulation scheme. We construct a new simulated dataset that is similar to the original data, but allows us to compute a lower bound on the FDP among the CpGs. Performing the CpGSNP pair-based approach for varying window sizes on the simulated dataset yields a list of CpGs associated with at least one SNP and a list of all CpGSNP pairs at an FDR of 0.05, similar to the results in. In the simulated dataset, we know for which CpGs we permuted the methylation values and thus are false-positive ones (see). Strikingly, a large portion of the identified CpGs using the CpG SNP pair-based approach seems to be false-positive results, especially for larger window sizes (). Even when using a small 0.5 kb window size, we find an estimated FDP of 0.1 (SE = 0.0006, based on five permutations), meaning at least 10% of the CpGs found among the CpGSNP pairs in the simulated data are coming from the permuted switch set, i.e. are not truly associated with an SNP. This number greatly increases to 49.1% (FDP = 0.49, SE = 0.002, based on five permutations) for the 500 kb window size. Although we can only claim that up to 50% of the CpGs found in the simulated data are false-positive results, this approach will probably yield an inflated proportion of falsely identified CpGs in the original data too. Our proposed CpG-based approach, however, controls the FDP at 0.05 (SE 0.0010.005, based on five permutations) for all window sizes.
A FDR controlled list of CpGs influenced by genetic variationTo obtain a valid list of CpGs that are significantly associated with genetic variation in cis in the original data, we calculated one P-value per CpG, testing the global hypothesis of no association between variation in methylation and any of the SNPs in its window. We calculated these P-values by means of the Simes procedure. The Simes procedure implicitly takes into account the correlation structure among the SNPs, making it a more powerful method than, e.g. the conservative Bonferroni method. After this within-window correction, we applied the Benjamini Hochberg procedure to the resulting P-values, controlling the FDR among the CpGs to 0.05.shows that this approach identifies a maximum of 3721 CpGs at a 500 bp window size (black line, triangles). This suggests that strongly associated SNPs are often in close proximity to the CpG, as reported earlier (). To show that this approach does control the FDP among the CpGs at the desired level, we again conducted the same bait-and-switch simulation experiment, applying our proposed CpG-based approach on the simulated dataset. While our approach seemingly discovers fewer CpGs than the CpGSNP pair-based approach to meQTL mapping when applied to the original data, the FDR among the CpGs identified in the simulated data is controlled at 0.05 ().BenjaminiHochberg procedure to control the FDR across CpGs. Strikingly, this approach suggests that optimal window sizes for the identification of cis meQTLs are much smaller than frequently used in the literature (up to tens of kb instead of hundreds of kb). These smaller window sizes are in line with reports that SNPs strongly associated with a CpG are often in close proximity to the CpG (). The large window sizes used in literature may stem from the CpGSNP pair-based approach reporting on the CpGs from a list of all FDR significant CpGSNP pairs. Using the) and the SNPs in its window. The left y-axis shows the P-value corresponding to the association with the methylation levels on a log 10-scale, and the right axis shows the recombination rate. The color coding indicates the r 2 between the SNPs, based on 1000 Genomes, build hg19. Many of the associated SNPs are in strong LD with one another bait-and-switch simulation, we show that the latter approach yields up to 50% falsely identified CpGs in simulated data. Our proposed approach controls the CpG-level FDR at the desired level and still identifies a substantial number of CpGs associated with genetic variation in cis. Our method can be directly applied to the output of commonly used QTL mapping software, e.g. Matrix EQTL, which returns P-values corresponding to every CpGSNP pair tested. In addition, the current method does not require the use of permutations to control the FDR, making it a fast and easy-to-use approach. Although permutations are still feasible for small 450 k array datasets, this becomes burdensome for large datasets, particularly when using bisulphite-sequencing data measuring millions of CpG sites. When calculating one P-value for the window around each CpG site, it is important to account for LD between SNPs in the window. Not doing so will substantially reduce statistical power. Therefore, some methods, like the Bonferroni correction, may be too conservative. The Simes procedure implicitly takes LD into account by multiplying larger P-values with smaller factors. Although the Simes procedure seems to perform well in terms of CpGs found, it still does not fully capture the correlation structure. A possible solution would be to estimate the number of independent tests for each window, e.g. using GATES() or TATES (van der), accounting for the number of independent tests done. However, this may be computationally expensive. Our proposed approach is unable to distinguish between two independent SNP effects on the methylation levels of a CpG. It only allows for making claims about the global null hypothesis of no association with any genetic variant in cis. This approach takes into account that the causal variant cannot be identified with statistical means only. Another limitation is that currently there is no valid method to determine the optimal window size for a study before QTL mapping. In general, the optimal window size will be greater for studies with higher statistical power. Our study suggests that the optimal window size will be 1050 kb instead of the commonly used hundreds of kb, which will reduce statistical power by dramatically increasing the number of tests. In this article, we introduced the bait-and-switch simulation method to estimate the true false discovery proportion among CpGs with a meQTL in cis in simulated data. This approach indicated up to 50% of identified CpGs in our simulated data may be false positive. While we know this is true in the simulated data, we cannot extrapolate this to the original data. It is likely that the common approach to multiple testing also brings about an increased CpG level FDR in the real data. This finding may also be an issue for cis expression QTL studies and possibly trans QTL studies. Interpretation of results based on the common approach evaluated here should be interpreted with caution. Development of statistical methodology will aid in getting a complete catalog of meQTLs and eQTLs that is key in understanding the mechanisms underlying the association of noncoding genetic variants with disease phenotypes.
DISCUSSION
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Multiple testing in methylation QTL mapping at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
R.Luijk et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
