We present a new, first-of-its-kind, fully automated computational tool MOTIF-EM for identifying regions or domains or motifs in cryoEM maps of large macromolecular assemblies (such as chaperonins, viruses, etc.) that remain conformationally conserved. As a by-product, regions in structures that are not conserved are revealed: this can indicate local molecular flexibility related to biological activity. MOTIF-EM takes cryoEM volumetric maps as inputs. The technique used by MOTIF-EM to detect conserved sub-structures is inspired by a recent breakthrough in 2D object recognition. The technique works by constructing rotationally invariant, low-dimensional representations of local regions in the input cryoEM maps. Correspondences are established between the reduced representations (by comparing them using a simple metric) across the input maps. The correspondences are clustered using hash tables and graph theory is used to retrieve conserved structural domains or motifs. MOTIF-EM has been used to extract conserved domains occurring in large macromolecular assembly maps, including as those of viruses P22 and epsilon 15, Ribosome 70S, GroEL, that remain structurally conserved in different functional states. Our method can also been used to build atomic models for some maps. We also used MOTIF-EM to identify the conserved folds shared among dsDNA bacteriophages HK97, Epsilon 15, and Ã´29, though they have low-sequence similarity.
INTRODUCTIONThe key processes in a cell, the fundamental building block of life, are carried out or at-least influenced by large macromolecular assemblies (LMAs) such as ribosomes and chaperonins. Understanding their structures and interactions is needed for understanding their mechanisms and hence essential for a complete understanding of life processes at the molecular level. A major development over the last 15 years has been the success of cryoEM in the very challenging task of determining and understanding the structures of LMAs (often in the molecular mass range 1100 million Da). CryoEM has emerged as a method distinctly more suited for determining and understanding structures of LMAs in under near-native conditions and inferring conformation flexibility (by capturing 'snapshots' of dynamic processes) associated with their working * To whom correspondence should be addressed. mechanisms (). With recent automation advances, CryoEM structures of large assemblies can be obtained at subnanometer resolution within few days of work (). Structural comparison is a critical step in structural biology research using cryoEM. For instance, in order to derive the functional mechanism of a newly determined structure, it is often compared with structures (for instance, same molecule in different functional states) already determined and studied by X-ray crystallography or cryoEM. In this article we present a new fully automated first-of-its-kind computational tool MOTIF-EM, which is meant to solve an important structural comparison problem P. P is defined as follows: compare a non-atomic resolution structure (i.e. a cryoEM map from EMDB) with another structure (either another cryoEM map or a map blurred from a crystal structure) and identify conserved structural domains or motifs or sub-map (if there is any) between the pair of input structures. The by-product of solving P is revelation of the regions in the input pair which are not-conserved between them. These non-conserved regions can point to local molecular flexibility related to biological activity, if the input pair are same molecule in two different functional states. For instance, two cryoEM maps of ribosome 70S are shown inand b Solving P with these two maps as input means detecting the location and shape (or domain boundary) of the two domains: 50S and 30S (shown as yellow and blue regions, respectively, inand d) that are known to be structurally conserved between the two maps. The by-product of solving P for this pair of 70S, is the revelation of the regions which are notconserved or flexible between the input structure pair, i.e. the red regions, as detected by MOTIF-EM, inand d. This region has been implicated with EF-G binding and and tRNA locomotion (). Prior to MOTIF-EM, there was no direct and fully automated way of solving P, without substantial prior knowledge (unavailable at times)such as, the occurrence of the common conserved subregion in the two input maps as a high-resolution structural homolog in some domain databank (such as SCOP). See Section 2 for more details. Structural comparison tools like MOTIF-EM are useful as conserved motifs or domains can point to conserved active sites, indicating function sharing, evolutionary relationships or drug binding targets for therapies. The remaining non-conserved regions in the input structure pair, revealed as by-product, can point to local molecular flexibility related to biological activity. MOTIFEM is expected to work with cryoEM maps upto the resolution when structural domains and assembly components in the maps remain detectable, which is typically believed to be 15  or betterPage: i302 i301i309
M.Saha et al.resolution (). Apart from breaking a map into conserved and non-conserved regions, we will show that MOTIFEM can be used to:(a) infer conformation changes (Section 4.2.1),(b) dock atomic-resolution domains (from NMR and X-ray crystallography based methods) into cryoEM maps (Sections 4.2.2),(c) propose atomic models for cryoEM maps in some cases (Section 4.2.2), and(d) compare maps of proteins with little sequence similarity (Section 4.2.3).The technique used by MOTIF-EM to detect conserved substructures is inspired bya recent breakthrough in 2D object recognition.
RELATED WORKThe indirect approach in) to solve P is to first convert input maps into collections of helices (which requires manual specification of appropriate map density thresholds () that can be found in the input maps, ignoring any other non-helical information in the input maps. Hence this approach is not suitable for those cryoEM maps which are predominantly defined by non-helical entities (such as, beta sheets) or even hardly detectable helices (like ones that are short or occur in maps coarser than 10  resolution). MOTIF-EM, on the other hand, does not do any reduction of input maps and works on their full form and is fully automated (i.e. does not require the user to guess and provide input parameters). Hence, unlike), MOTIF-EM is applicable to any kind of macromolecular cryoEM map. Other available methods that could help solve P, but in limited cases, can be described in two classes: I 'Compare and dock' methods: Methods like () search atomic-resolution domain banks (e.g. SCOP) for structural homologs of the domains in a given cryoEM map. Structural homologs, if found, are docked into appropriate regions of the maps resulting in full or partial atomic resolution models for the map. Some, like (), also allow conformational flexibility in the docked homologs.II De novo methods: These methods () try to detect long helices and large beta sheets in maps with sub-nanometer resolution. In the cryoEM maps with resolution better than 4.5 , backbone tracing has also been achieved (). One could use methods from these two classes to construct the backbone (which can have construction errors), of the macromolecular assembly, after which one could use existing common protein substructure determination methods to solve P. But this approach has a very limited applicability as constructing the backbone using the class (I) and (II) methods is not easy in the first place. For instance, class (I) methods assume that isolated high-resolution structural homologs of different parts of a given cryoEM are available in some databank, which is often not the case. Moreover, class (II) methods can only be used in maps which are predominantly composed of long helices and large sheets and are in the sub-nanometer resolution range, which is again not common. Also both (I) and (II) may require significant amount of manual intervention. On the other hand, MOTIF-EM searches for conserved domains between the input cryoEM maps without depending on the availability of isolated structural homologs or backbone trace or even detectable secondary-structure elements in the maps and in a fully automated way. As indicated earlier, MOTIF-EM can also be used to compare a cryoEM map with an atomic-resolution structure, from say X-ray crystallography or NMR-based methods.
METHOD: THE ALGORITHM MOTIF-EMIn this section we describe the working mechanism of our new structural comparison computational tool MOTIF-EM. Its main steps are summarized in. MOTIF-EM takes as input a pair of cryoEM maps M 1 , M 2. If one of the inputs is an atomic resolution structure, then it has to be converted to a simulated cryoEM map using, say, 'pdb2mrc' in the EMAN package ().(also see), MOTIF-EM finds local OXYZ Cartesian reference frames for all the grid points in M 1 and M 2 using 'compute_frame_set' (). At a given grid point p o , an O-XYZ Cartesian reference frame is placed, such that the orthogonal directionsX,Y ,Z represent directions of larger local density variations. This is achieved by sampling k points in the neighborhood of p o (). Singular value decomposition (SVD) is done on the density variations of the sampled points (Figs 1B, S2) to obtain the orientation of O-XYZ (Figs 1B, S3 and S4: X is the first column of U, and so on). In Step 2 of(also see), MOTIF-EM finds a local region descriptor (LRD), denoted by , for all the grid points in M 1 and M 2 ().) is essentially a gradient histogram GH(p o ) (), representing a coarse discretization of thedirection space, in which the local gradients at the), mimicked in 2D. A Cartesian reference frame is placed at each of the grid points. The length of a frame axis reflects the extent of local density variation along the axis.Step 2 of MOTIF-EM (), LRD or gradient histogram construction, mimicked in 2D. The principal direction (x-axis) of the reference frame of a grid point around p o is first re-expressed in p o 's reference frame and then stored in the bin (of the gradient histogram) representing the direction closest to the re-expressed one. The magnitudes of the stored gradients in a bin are summed up to obtain a numerical value for each binsampled points are distributed. In our implementation a GH has 26 bins (or representative gradient directions). For a sampled point p i , the local gradient g i (the first axis of the local frame at p i ) is first re-expressed in the local frame at p o (Figs 1C, S2.12) and then put into the GH bin which represents the direction closest to g i (Figs 1C, S2.4). Re-expressing the g i 's in the local frame of p o makes (p o ) rotationally invariant (). After putting all g i 's in the bins, for a given bin the magnitudes of the gradients stored in it are summed up to get a numerical value for that bin (Figs 1C, S2.5). Then (p o ) is essentially the numerical values of the bins stacked as a vector. A more complex LRD (the one actually described in) is constructed by dividing the region around p o into eight quadrants, constructing a (p o ) i for each quadrant, and stacking the (p o ) i 's together as a vector [).), mimicked in 2D. For a given grid point p in input cryoEM grid 1, locally similar grid points are found in the input cryoEM grid 2 by comparing the LRD at p with LRDs in grid 2.In Step 3 of(also see), for a LRD 1
B
i303
M.Saha et al.) which are most similar (using the Euclidean metric) to 1 i. That is, the grid pointsThere may be false positives in 1 i _closest, as computation of local reference frames are noisy and is a dimensionally reduced description (resulting in loss of information) of a local 3D region. The interfering false positives will be removed at the end, in Step 6. In Step 4 of(also see), MOTIF-EM has k match pairs for each grid point in M 1. Hence, n grid points in M 1 results in n*k match pairs. For a given match pair m() be the 4  4 spatial rigid body transformation matrix that transforms). Let 6DOF be the six degrees-of-freedom that parameterizes T. T and 6DOF are computed by the function 'find_dof' as described inChapter 2) and Horn (1987). In Step 5 of(also see), MOTIF-EM clusters the n*k match pairs found in Step 3 of. The distance between two match pairs m() is defined as the distance between 6DOF(. Suppose D is a domain/sub-region that is rigidly conserved in M 1 and M 2 and appears in them as D 1 and D 2 , respectively. Then all the points in D 1 will map onto corresponding points in D 2 using same T and hence same 6DOF. Hence a cluster corresponds to a potential rigidly conserved domain between M 1 and M 2 , as all the matches in a cluster would have approximately same 6DOF and hence T. Let C be a prominent), mimicked in 2D. A graph is constructed such that match pairs are nodes. An edge between two nodes indicates that the distance between the corresponding two grid points is preserved between the two maps. A clique in the graph (formed by blue nodes) is a collection of grid points whose inter-point distances are preserved between the maps. cluster found during clustering and contains D. C is a collection M(C): {m 1 , m 2 , m 3 ,}, where m i is a match pair (p 1 a , p 2 b ). Since computation of T is usually noisy, all the match pairs in C may not correspond to D. MOTIF-EM uses another step, Step 6 of(also see), to remove the false positives in C, i.e. those match pairs that do not correspond to D. For a domain/sub-region D to be rigidly conserved as D 1 and D 2 in M 1 and M 2 , respectively, inter-point distances in D have to be conserved both in D 1 and D 2. To use this property, we construct a graph G, corresponding to C, such that a node n i in the graph is a match pair m i from M(C). Suppose the nodes n i and n j correspond to match pairs m(respectively. An edge occurs between n i and n j , if the distance between the p 1 i1 and p 1 j1 is the same as that between p 2 i2 and p 2 j2 , within a small thresholdlet us call this construction C1. Having defined G like this, MOTIF-EM extracts large cliques from G using graph methods described in. A clique corresponds to a maximal sub-graph S(G) in G, such that there is an edge between every pair of nodes in S(G)let us call this axiom A1. Since the nodes of G corresponds to M(C), S(G) corresponds to a subset of M(C), which we call SMHence the match pairs in SM(C) define a set of grid points S 1 : {p 1 a1 , p 1 a2 , } in M 1 and a corresponding set of grid points S 2 : {p 2 b1 , p 2 b2 , } in M 2 , such that the inter-point distances are preserved between S 1 and S 2 , i.e. distance[S 1 (i),. This follows from the construction C1 and the axiom A1, just laid. This is partially illustrated in. The grid point sets S 1 and S 2 are reported as identified conserved domain/sub-region pair by MOTIF-EM. The computational complexity of the MOTIF-EM algorithm will be discussed in the extended version of this article.
RESULTSNow we report the outcome of applying MOTIF-EM on some instances of P. MOTIF-EM was run on a 2.33 GHz, 512 CPU cluster, located at Stanford University (http://biox2.stanford.edu). MOTIFEM took upto 60 min on the cluster to generate the outcomes. The same implementation of MOTIF-EM is available for download and use at: http://ai.stanford.edu/mitul/motifEM. The images of structures shown were generated using UCSF Chimera package () from the Resource for Biocomputation, Visualization and Informatics at the University of California, San Francisco (for cryoEM maps, surface representation was used).
i304
A simulated caseFirst, in this section, we verify the sanity of MOTIF-EM on a simulated testcase. We create two synthetic cryoEM maps A and B. Map A is simulated from an 'open' conformation GroEL atomic coordinates (PDB id: 1oel) containing a domain called 'equatorial'. Map B is simulated by arbitrarily placing a part of the same GroEL equatorial domain in a protein environment [. MOTIF-EM is used to compare A and B and extract the part of GroEL equatorial domain co-occurring in them. This is done in two rounds of tests (or two varying conditions). Testing under varying map resolution: In the first round of tests, four sets of cryoEM map pair A and B are synthesized, evenly in the resolution range 520  (, column 1). The size or spatial volume occupied by the atomic resolution equatorial domain, included while generating A and B, was kept constant at v 0. MOTIFEM is applied to each set of the map pair to extract the part of equatorial domain co-occurring in them. As seen in, second column, in all five cases, MOTIF-EM successfully determined the geometric locations of the co-occurring equatorial domain with error below 1%. The blue regions in/a4 and b3/b4) are the cooccurring equatorial regions, as detected by MOTIF-EM, in the 10 maps A and B, respectively. Also, the third column in, reports the relative size (v/v 0  100) of the equatorial map region (size or spatial volume: v) co-occurring in maps A and B, retrieved by MOTIF-EM [i.e. ratio of blue regions in. We see in, that the relative size of the extracted conserved region pair is in the range 9356%, as the resolution of the map pair is varied from 5 to 20 . The shrinking size of the extracted conserved region pair is not the inability of MOTIF-EM, but is due to the fact that more and more structural information is lost, especially near domain boundary, as the map resolution worsens. As noted in (), one expects domains and assembly components less likely to be detected as the resolution of a cryoEM map approaches 15 . Testing under varying conserved domain size: In the second round of tests, four sets of cryoEM map pair A and B are synthesized such that the size or spatial volume occupied by the high-resolution equatorial domain [blue regions in, included while generating A and B, was reduced from v 02 = v 0 to v 02 = 0.25v 0 (Table 2, column 1). The resolution of the maps was kept fixed at 10 . Again, MOTIF-EM is applied to each set of the map pair. Here also, as seen in, second column, in all five cases, MOTIF-EM successfully determined the geometric locations of the co-occurring equatorial domain portion with error below 1%. The 3rd column in, reports the relative size (100 v/v 02 ) of the conserved sub-region (size or spatial volume: v) or the equatorial map region co-occurring in maps A and B, extracted by MOTIF-EM, for each set. We see in, that the size of the extracted conserved domain pair is reduced from 83 to 45%, as the size v 0 of the common equatorial domain used in the simulated maps is reduced from 100 to 25%. Again this is expected, as noted in () as the size of a conserved structural regions decreases it becomes i305
M.Saha et al.Aharder to detect it. For example, smaller entities like alpha-helices are reasonably detectable in maps only upto 10  resolution.
Applying MOTIF-EM to real data
Conformation change in ribosome 70SWe used MOTIFEM to compare a pair of cryoEM maps [(http://www.ebi.ac.uk/pdbesrv/emsearch/) EMD ids:, corresponding to the pre-and post-translocational states, respectively, of ribosome 70S (and b). MOTIF-EM yielded two distinct conserved domain pairs between them, as shown inand d and B. The remnant non-conserved regions are shown in red inand d and C. The two domains when compared with the data inturned out to be predominantly the 30S and 50S subunits of 70S ribosome.also indicates that the remnant non-conserved region is likely to be marked by activities such as EF-G binding and tRNA locomotion. We measured the relative positions of extracted domains, corresponding to 30S and 50S subunits, in the two conformations and verified the ratchet like motion reported in. The animation in http://ai.stanford.edu/mitul/motifEM/rna_anim.gif depicts this ratchet like motion of the two subunits in 70S, upon conformation change, deduced by MOTIF-EM. We validate these results from MOTIF-EM in the following ways:(a) Visual inspection using markers:and b show the correspondences (numbered red balls) established by MOTIFEM between the first extracted domain pair. Likewise,and d correspond to the second extracted domain pair. The correspondences are reasonably located.B), this is predominantly the 30S subunit of the 70S ribosome. (Bd): The second pair of conserved domain extracted from the input map pair by MOTIF-EM. As per (), this is predominantly the 50S subunit of the 70S ribosome.(b) Both the extracted domain pairs, when aligned, have high map density cross-correlation values of 0.92 and 0.91, respectively.(c) The geometric transformation yielded by MOTIF-EM that aligns the extracted domain pair has been confirmed by realigning the extracted domains using FOLDHUNTER () (an existing software to dock a cryoEM submap into another map).The plasticity of the remnant map regions [shown as red in(such as SCOP) were searched. Then these homologs were docked into the cryoEM maps using semi-automated means. However, as we saw in this section, MOTIF-EM is able to detect the conserved and non-conserved regions in an automated fashion.
Model building using MOTIF-EM Nextwe show the potential of MOTIF-EM to build C backbone models for cryoEM maps in special cases. We demonstrate this by doing model building for the GroEL cryoEM 6  map (). The map and the C backbone structure of a closed conformation GroEL ring (PDB ID: 1aon) were compared using MOTIF-EM (, left, top block). This yielded the three conserved domain pairs (, right block), between the two input structures, corresponding to the known equatorial, intermediate and apical domain demarcations in GroEL. MOTIF-EM also gives relative geometric rigid body transformation matrices needed to dock/fit the extracted conserved domains from the C backbone structure into the cryoEM map. Based on these transformation matrices and the D7 symmetry of the GroEL 6  cryoEM map, a C backbone model corresponding to the map was assembled and is shown in(left bottom). The assembled model is in reasonable agreement with a model obtained by individually docking three pre-demarcated GroEL domains using SITUS () and Chimera's () model fitting tool (for the intermediate domain, initial guess was required). The advantage of MOTIF-EM against any other docking-based model building software, such as SITUS (), etc., is that one does not have to demarcate the input atomic structure, i.e. specify domain boundaries (or refer to curated SCOP domain bank). MOTIF-EM automatically crops out the domains from the input atomic structure that need to be fitted in the input map.A
Structural comparsion of maps with little sequence similarityIn this demonstration, we use MOTIF-EM to identify the conserved shared folds among dsDNA bacteriophages HK97, Epsilon 15 and Phi 29. The fold similarity between them is also evident by visual inspection [(a and b) of. Here, MOTIF-EM is used to confirm and precisely quantify it. For HK97 an atomic resolution structure is available (PDB id: hk97). For Epsilon 15 and Phi 29, cryoEM maps at 4.5 and 7.9 , respectively, are available. There is no evident sequence similarity among HK97, Epsilon 15 and Phi 29 (). In the first trial, a monomer each from HK97 and Epsilon 15 (and b) were given as input to MOTIF-EM. MOTIF-EM extracted the conserved fold between the input monomer pair as shown inand f (also the non-red region inand d). Sixty percent of the HK97 backbone is conserved. In the second trial, a monomer each from HK97 and Phi29 (and b) were given as input to MOTIF-EM. In this case also, MOTIF-EM extracted the conserved fold between the input monomer pair as shown inand f (also the non-red region inand d). Sixty-four percent of the HK97 backbone is conserved.
i307
M.Saha et al.BThese conserved folds extracted from bacteriophages HK97, Epsilon 15 and Phi 29 confirm the high structural similarity between the phages, even with no evident sequence similarity between them, suggesting the possibility of a common ancestor between them (). We evaluate these results from MOTIF-EM in the following way. Since the resolution of the Epsilon 15 map is reasonably high, the evaluation is best done by visual inspection. As seen in, the conserved part (blue cartoon) of HK97, as determined by MOTIF-EM, is contained very well in the map density of Epsilon 15, while the non-conserved (red cartoon) part usually protrudes out of the density. This is further supported by fitting scores from Chimera (): the conserved part has a fitting score of 43.1, much higher than 16.7: that of non-conserved part. We also use markers (numbered red balls inshow the visually convincing correspondences between the HK97 and Epsilon 15 structures, established by MOTIF-EM. Likewise, the correspondences between Phi29 and HK97, obtained by MOTIFEM, are shown inshows the alignment of the conserved (blue cartoon) and non-conserved (red cartoon) parts of HK97, as determined by MOTIF-EM, with the Phi29 map. As seen, the conserved part fits the map much better than the nonconserved parts of HK97. This is also supported by fitting scores from Chimera (): the conserved part has a fitting score of 0.80, much higher than 0.49: that of non-conserved part.
CONCLUSIONWe have described a new, first-of-its kind, computational tool MOTIF-EM that can identify structural motifs or domains that are conserved between a pair of cryoEM maps. As a by-product, regions that are not conserved are also revealed. Such a tool is useful as conserved structural entities can point to conserved active sitesindicating common function, evolutionary links and drug binding targets for therapies. The non-conserved regions, revealed as by-product, can point to local molecular flexibility related to biological activity. Apart from breaking an input map pair into conserved and non-conserved regions, MOTIF-EM can (i) dock existing atomic-resolution domains into cryo-EM maps, (ii) propose atomic resolution models for some cryoEM maps, and (iii) compare maps with conserved structures but little sequence similarity. The distinct advantage of using MOTIF-EM is that it enables the users to directly and automatically compare and analyze two cryoEM structures. Otherwise, the conventional way has been indirect comparison, via docked structural homologs or backbone traced models (both not always available), which can introduce errors from imperfect docking and modeling into the structural analysis. Overall, this required significant manual intervention. In the future we would like to do structure comparisons using MOTIF-EM on a much larger scale. Such as, comparing a given cryoEM map with all the available structures in various databanks (such as, EBI cryoEM and PDB databanks) and detecting previously unknown links between the cryoEM map and all other known structures.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
i309 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
