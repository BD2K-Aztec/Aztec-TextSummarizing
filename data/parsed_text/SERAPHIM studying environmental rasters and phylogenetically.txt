SERAPHIM (" Studying Environmental Rasters and PHylogenetically Informed Movements ") is a suite of computational methods developed to study phylogenetic reconstructions of spatial movement in an environmental context. SERAPHIM extracts the spatio-temporal information contained in estimated phylogenetic trees and uses this information to calculate summary statistics of spatial spread and to visualize dispersal history. Most importantly, SERAPHIM enables users to study the impact of customized environmental variables on the spread of the study organism. Specifically, given an environmental raster, SERAPHIM computes environmental " weights " for each phylogeny branch, which represent the degree to which the environmental variable impedes (or facilitates) lineage movement. Correlations between movement duration and these environmental weights are then assessed, and the statistical significances of these correlations are evaluated using null distributions generated by a randomization procedure. SERAPHIM can be applied to any phylogeny whose nodes are annotated with spatial and temporal information. At present, such phylogenies are most often found in the field of emerging infectious diseases , but will become increasingly common in other biological disciplines as population genomic data grows. Availability and Implementation: SERAPHIM 1.0 is freely available from http://evolve.zoo.ox.ac.uk/. R package, source code, example files, tutorials and a manual are also available from this website.
IntroductionPhylogenetic techniques are now a standard tool in the study of the spatial and demographic history of organisms (e.g.). In the context of infectious diseases, for example, phylogenetic inference can be used to reconstruct epidemic history (e.g.). Of most relevance here, phylogeographic methods, such as that implemented in the software program BEAST (), enable the reconstruction of the dispersal history of a phylogeny of a given set of genomes sampled through time in continuous space (). The current version of this approach uses a relaxed random walk model () to reconstruct historical dispersal. Phylogeographic methods model the geographic locations of nodes in a phylogeny, and can therefore be considered a type of phylogenetic character mapping approach. Trees inferred using this method, or related methods such as the structured coalescent model () can be visualized in a geographical context, such that each branch is interpreted as a vector that characterizes a distinct path through time and space. Thus, the tree represents a collection of phylogenetically informed V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com movement events and contains useful information about the past dynamics of spatial spread. Here we present SERAPHIM ( " Studying Environmental Rasters and PHylogenetically Informed Movements " ), a new suite of computational and statistical methods developed to study the environmental context of spatio-temporal phylogenies. SERAPHIM is available as a R package (R Core Team, 2016, http://www.R-pro ject.org) that (i) extracts spatio-temporal information from a set of phylogenetic trees, (ii) estimates and plots dispersion statistics, and (iii) statistically test hypotheses regarding the relationship between dispersal velocity and environmental variables, such as altitude, population density and land cover.
FeaturesSERAPHIM first extracts the spatio-temporal information contained in a set of suitable phylogenetic trees from a Nexus file containing trees in a Newick format. Phylogenetic uncertainty will be incorporated into the analysis if a set of trees is used, for example a posterior distribution of trees obtained using a Bayesian phylogenetic approach such as that implemented in BEAST. The user can then compute a set of spatial statistics that summarise dispersal. These include the mean branch velocity, the diffusion coefficient as defined in, the weighted diffusion coefficient as defined in, and plots of the maximal distance of an invasion wavefront from the spatial origin against time. Wavefront plots are generated using two distance metrics: (i) the direct distance, which corresponds to the straight-line distance between the origin and the wavefront, and (ii) the patristic spatial distance, which is the sum of the spatial distances along all phylogeny branches between the tree root and the corresponding tree tip. These summary statistics can be useful to compare the mode and rate of spatial spread of different populations. Supplementaryillustrates the plots obtained when SERAPHIM is applied to phylogenies that represent dispersal history of the West Nile virus (WNV) in North America. The phylogenies used were those reported in. SERAPHIM also allows users to generate graphs of spatial dispersal history. These plots are similar to those produced by the software package SPREAD (). Supplementaryshows the reconstructed dispersal history of WNV in North America, again obtained by applying SERAPHIM to the data from. A detailed tutorial on how to undertake these analyses is available with the SERAPHIM package. The main functionality of SERAPHIM is to statistically test the impact of environmental factors on dispersal velocity. SERAPHIM does this in three steps. First, it computes an environmental " weight " for each branch using a pre-specified environmental raster in an ASCII format. Second, it estimates the correlation between branch duration and branch weight. Third, it tests the statistical significance of these correlations using null distributions generated by a randomization procedure (see manual for details). SERAPHIM implements three different movement models for computing the environmental weight of each dispersal vector (i.e. each phylogeny branch): the (i) straight-line, (ii) least-cost () and (iii) random walk models (). The random walk dispersal model is based on circuit theory () and for this model, SERAPHIM calls CIRCUITSCAPE, an external Python package (). These three models allow the user to explore and test different modes of dispersal when there is no prior information about which movement model might be most appropriate. Once the environmental weights are computed for each branch and environmental raster, the correlation between vector durations and environmental variables are calculated using either a univariate or
Bioinformatics, 2016, 13 doi: 10.1093/bioinformatics/btw384 Advance Access Publication Date: 22 June 2016 Applications Note Bioinformatics Advance Access published July 13, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Perspectives Although the framework presented here has been developed for the analysis of movement events extracted from spatiotemporal phylogenies (e.g. trees generated by BEAST), it can also be applied more generally to dispersal events that have been observed using nonphylogenetic methods, such as GPS collars or through capturemark-recapture. Any method that produces a collection of movement vectors, each defined by a start and end location and a start and end time, will be compatible with the SERAPHIM framework.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
