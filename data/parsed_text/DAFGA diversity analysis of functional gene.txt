Diversity analysis of functional marker genes provides physiological insights into microbial guilds that perform an ecologically relevant process. However, it is challenging to group functional gene sequences to valid taxonomic units, primarily because of differences in the evolutionary rates of individual genes and possible horizontal gene transfer events. We developed a python script package named DAFGA, which estimates the evolutionary rate of a particular functional gene in a standardized manner by relating its sequence divergence to that of the 16S rRNA gene. As a result, DAFGA provides gene-specific parameter sets for operational taxonomic unit clustering and taxo-nomic assignment at desired rank, and it can be implemented into the diversity measurements offered by QIIME.
INTRODUCTIONMicrobes are the most abundant and most diverse organisms on earth playing crucial roles in ecosystem functioning. Massively parallel sequencing of 16S rRNA genes allows us to explore the phylogenetic diversity and taxonomic composition of microbial communities in any environment (e.g.). Contrary to the 16S rRNA gene, genes encoding key catalytic enzymes define particular functional guilds that perform ecologically relevant functions, e.g. methane-oxidizing bacteria (pmoA) and nitrogen-fixing bacteria (nifH). Exploring the prevalence and diversity of these protein-coding genes can help identify novel lineages of particular functional guilds as well as physiologically differentiate closely related phylotypes. Similarity of tree topology with that of the 16S rRNA gene should reveal the potential of a functional gene to be used as a phylogenetic marker (). Protein-coding genes, however, evolve faster than the 16S rRNA gene, and at varying rates. There are considerable variations in the evolutionary rates (ERs), even among individual genes present in the same genome (). Use of arbitrary threshold values for clustering functional gene amplicons into operational taxonomic units (OTUs) could lead to incorrect estimates of microbial diversity within functional guilds. Therefore, computational tools for functional gene amplicon analysis have to take into account the ER of a targeted gene. Because variations in ER result primarily from changes in the protein sequence itself rather than from external factors such as changing environment or lifestyle (), the ER of individual genes can be measured in relation to that of 16S rRNA genes (). DAFGA compares the sequence divergence of functional genes with that of 16S rRNA genes obtained from the same source organisms. It then extrapolates the sequence identity thresholds that define different taxonomic ranks and use them for OTU clustering and taxonomic assignment to the lowest rank possible.
FEATURES AND METHODS
Reference database and correlation plotsDAFGA parses the publicly available sequences of a functional gene, which are retrieved from the NCBI protein database in genpept format. It excludes all the environmental sequences lacking taxonomic information and subsequently constructs the reference database to be used for taxonomic assignment. DAFGA retrieves the full taxonomic lineage of each reference sequence from the NCBI taxon ID, and fetches near full-length 16S rRNA gene sequences (12001600 bp in length) of the source organisms from the NCBI nucleotide database, but only from those organisms that were identified at strain level. The pairs of functional and 16S rRNA gene sequences are used to compute the ER of the functional gene in relation to that of its 16S rRNA gene by pairwise alignments between all the strain-level source organisms using the EMBOSS SmithWaterman alignment tool (). The identity thresholds of a functional gene that correspond to different taxonomic ranks are deduced from a linear regression curve of identity scores in sequence alignments and used for OTU clustering and taxonomic assignment. Alternatively, similarity scores can be used to taxonomically assign OTUs ().
OTU clustering of functional gene ampliconsInsertion and deletion errors in next-generation sequencing (e.g. 454 pyrosequencing and Ion Torrent semiconductor sequencing) can often cause a shift in reading frame during translation, thereby inflating diversity of functional gene sequences. To overcome this problem, DAFGA uses a two-step procedure for OTU clustering. Amplicon reads, which passed user-defined qualityfiltering, are preclustered into OTUs defined by high nucleotide sequence identity (497%), using USEARCH (). A consensus sequence of each OTU is generated from multiple sequence alignment and selected to represent the preclustered OTU. The translated consensus sequences are subjected to final OTU clustering using the gene-dependent sequence identity threshold that corresponds to the desired taxonomic rank. *To whom correspondence should be addressed.Centroid sequences are selected to represent each final OTU and used for both taxonomic assignment and phylogenetic tree construction. The OTU mapping file is generated by merging preclustering and clustering output. When examined with pmoA test amplicon data (L uke and), this twostep clustering reduced the number of OTUs as compared with a single-step approach based on translated amino acid sequences. In particular, singleton OTUs significantly declined.
Taxonomic assignment and phylogenetic treeThe number of functional gene sequences that are available for the construction of reference databases is limited and biased toward taxa characterized by sequenced genomes. For instance, dependent on the functional marker gene, the number of sequences deposited in FunGene ranges from 100 to maximum 77 876 (including environmental sequences), while43 million 16S rRNA sequences are available (). In similaritybased taxonomic classification of functional gene sequences, lack of homologues at low taxonomic ranks, such as genus or species, can often lead to incorrect classification due to high sequence divergence with the most homologous sequence. For instance, a statistically significant alignment (E-value51e-10) shows 40% amino acid identity between environmental sequence and the reference sequence of a particular species. This explicitly indicates that the environmental sequence is derived not from the same species but from another species, so that the relationship is validly recognized only on a higher taxonomic level such as, for example, family or order level. Therefore, DAFGA takes into account the query coverage and the absolute identity or similarity scores in alignment with the best homologues, and performs assignment at the most likely taxonomic rank by referring to the correlation plot between the functional and 16S rRNA gene sequences. It creates an OTU table with taxonomic information and a phylogenetic tree of representative sequences. These outputs can be used as input files for various diversity measurements in QIIME () or Mothur ().
CONCLUSIONThe most critical step in the diversity analysis of functional marker genes and rRNA genes is to cluster taxonomically homogeneous sequences into valid OTUs. DAFGA offers a standardized procedure to determine the ER of functional genes in relation to that of the 16S rRNA gene, and it provides sequence identity thresholds that correspond to different taxonomic ranks. As such, DAFGA allows for the automated cluster analysis and taxonomic categorization of environmental sequence data and provides a computational means to evaluate the potential of a functional gene as a phylogenetic marker.. Workflow of DAFGA (A) and correlation plot of pmoA and 16S rRNA gene sequence divergence (B). The pmoA gene was selected as a representative example. pmoA reference sequences deposited in FunGene (http://fungene.cme.msu.edu/) were obtained in genpept format from NCBI non-redundant protein database. Similarity and identity values of protein sequence alignments were plotted in green and blue, respectively. Dashed red line is a linear regression curve of, respectively, similarity and identity of pmoA over 16S rRNA gene sequence identity
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
