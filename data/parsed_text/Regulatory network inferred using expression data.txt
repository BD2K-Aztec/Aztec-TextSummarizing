Motivation: Modeling regulatory networks using expression data observed in a differentiation process may help identify context-specific interactions. The outcome of the current algorithms highly depends on the quality and quantity of a single time-course dataset, and the performance may be compromised for datasets with a limited number of samples. Results: In this work, we report a multi-layer graphical model that is capable of leveraging many publicly available time-course datasets, as well as a cell lineage-specific data with small sample size, to model regulatory networks specific to a differentiation process. First, a collection of network inference methods are used to predict the regulatory relationships in individual public datasets. Then, the inferred directional relationships are weighted and integrated together by evaluating against the cell lineage-specific dataset. To test the accuracy of this algorithm, we collected a time-course RNA-Seq dataset during human erythropoiesis to infer regulatory relationships specific to this differentiation process. The resulting erythroid-specific regulatory network reveals novel regulatory relationships activated in erythropoiesis, which were further validated by genome-wide TR4 binding studies using ChIP-seq. These erythropoiesis-specific regulatory relationships were not identifiable by single dataset-based methods or context-independent integrations. Analysis of the predicted targets reveals that they are all closely associated with hematopoietic lineage differentiation. Availability and implementation: The predicted erythroid regulatory network is available at
IntroductionIn the past decades, significant research efforts have been devoted to infer gene regulatory networks (GRNs) in the bioinformatics field (). The challenge lies in that inferring regulatory network is an ill-posed problem, because the number of interactions to be inferred exceeds the number of independent experiments. Today, the standard solution to these p > n problems (p is the number of parameters and n is the number of training samples) is different regularization techniques, adopting or modifying the method Tikhonov developed almost 80 years ago. When p>>n, i.e. an extremely limited set of experimental observations are available, it is often challenging to find a stable solution. In this article, we show a method to utilize both small, context-specific expression data, and large, non-specific datasets to infer regulatory networks. The essence of this method is to intrinsically increase the p by giving a weight to non-specific datasets according to their relevance to the contextspecific dataset and accuracy. This technique has been used in non-directional networks, but hasn't been applied to regulatory networks with time-course data. Current methods () for modeling regulatory networks based on expression data can be divided into two categories. The first category utilizes a single time-course dataset over a development process or under certain environmental perturbations. Methods in this category focus on predicting regulatory networks corresponding to the same context of input data, which includes context likelihood of relatedness (CLR) (), dynamic Bayesian network (DBN) (), smoothing spline clustering (SSC) () and Learning Module Networks (LeMoNe) () and semi-supervised regulatory network discoverer (SEREND) (). Intensive research efforts have been devoted to these methods, with community-based assessments (e.g. the Dialogue for Reverse Engineering Assessments and Methods challenges) identifying several well-performed algorithms (), including ours. Numerous great methods have been derived from these crowd sourcing efforts (). This category of methods may capture the cell lineage-specific and other context-specific information. However, the accuracy of these algorithms is expected to be heavily affected by the input time-course data and subject to fluctuation due to experimental observation errors. Methods in the second category generate regulatory networks by integrating multiple genomic datasets, such as supervised inference of regulatory networks (SIRENE) (), multilevel integrated inference and analysis of regulatory networks (), combinatorial algorithm for expression and sequence-based cluster extraction system (COALESCE) () and simultaneous genome-wide inference of multiple types of interactions including regulatory ones (). By leveraging multiple datasets, these algorithms are expected to be more accurate in predicting a global, non-specific network (). However, the context-specificity of such integrative methods is limited, due to the lack of contextspecific input data. The complementary nature of the two categories motivated us to develop DIFMINE, a novel multi-layer graphical model that leverages multiple non-specific time-course expression datasets, as well as a single context-specific, yet small-scale dataset to infer regulatory networks that are specific to a differentiation process. In this multi-layer model, the regulatory networks of individual non-specific genomic datasets are inferred using network inference algorithms developed for a single dataset. For this step, we tested state-of-the-art algorithms identified in previous community-based blind assessments (). Next, the relevance of these non-specific networks against the context-specific dataset is evaluated using Bayesian rules, and integrated into a single network. The resulting network intends to reveal the context-specific regulatory relationships on the whole genomic scale. In contrast to other state-of-the-art regulatory network prediction methods, our approach benefits from both the large number of publicly available functional genomic datasets and the small-scale cell lineage-specific dataset that defines the context. We applied our algorithm to a cell lineage-specific expression RNA-seq dataset of human erythropoiesis. We demonstrated that we could significantly improve the performance of the network inference based on a single, limited dataset, compared with one of the most cited, the state-of-the-art single-dataset methods such as CLR () and DBN. Additionally, we compared the performance of our algorithm against context-insensitive integration without the information from the cell lineage-specific dataset and found that the former successfully identifies regulatory relationships activated during erythropoiesis. Finally, we used a recently generated ChIP-seq data for TR4, an important transcription factor involved into erythropoiesis (), and validated our prediction of regulatory relationships using this data.
Materials and methods2.1 Inferring cell lineage-specific regulatory network with observed expression data with a small number of samplesThe problem we address in this article is how to infer cell lineagespecific regulatory network with limited observed expression data. The differentiation of a cell lineage is a confined process. Typically, a short series of time-course expression data is sufficient to describe the transcriptomic profile of this process. Methods that are used to infer regulatory networks tend to be limited in accuracy when only a small number of sampling points are available. In the original paper that reported one of the most cited method in this field, CLR, 445 sampling points were used to reconstruct the regulatory network (). To address this challenge, we developed a multilevel graphical model to leverage both the cell lineage-specific expression data and the generic, publicly available expression data to infer regulatory networks. We tested our strategy as human erythroid CD34  progenitor cells differentiated into mature erythroid cells in vitro (), in which the erythroid cells differentiated nearly synchronically. We collected RNA-seq datasets for the transcription profiling at day 4, 8, 11 and 14, respectively, after inducing human CD34  hematopoietic progenitor cells differentiation (Section 2). This time frame covers the differentiation stages from immature progenitor cells until mature reticular erythroblasts.is the workflow of DIFMINE, which contains two levels of Bayesian networks: 1. Generate erythroid-specific gold standard pairs. This cell lineage-specific dataset, together with known regulatory interactions, was used to generate the gold-standard regulatory relationships for evaluating the relevance of the non-specific datasets. First, we obtained activation regulatory interactions from Kyoto Encyclopedia of Genes and Genomes (KEGG) pathway (). Then gene pairs that are significantly co-expressed in the erythropoiesis dataset are identified. The intersection of the two sets was used to establish the gold standard regulatory relationships involved in erythropoiesis, with defined directions. 2. Collect suitable public available datasets. We first acquired 1335 human microarray datasets from Gene Expression Omnibus (GEO) database () as of September 20th, 2013. These genome-wide datasets will allow us to derive a prediction score between almost every transcription and other genes. These datasets are then filtered according to the following criteria.(i) They represent samples of relatively small time intervals, i.e. no more than 48 h between time points. (ii) Each of them has more than or equal to eight points, so that time-lagged analyses can be carried out. There are 52 datasets satisfying these criteria (Supplementary Supporting Information S1) and thus included in the integration. Datasets are imputed using Sleipnir () KNNImputer. The pre-processing details of the public datasets are available in Supplementary Supporting Information S7. 3. Generate first layer DBN. For each dataset, we calculated a score for each gene pair that is indicative of the probability of one gene regulating the other. The following algorithms were tested for inferring the regulatory network based on a single dataset: (i) Time-lagged correlation (), in which correlations between time-shifted transcription profiles were calculated to represent the regulatory relationships. (ii) DBN, in which regulator-target gene pairs are usually identified based on a statistical analysis of their expression relationships across different time slices (), (iii) Lasso regularization, which is a popular method for regularization. (iv) Truncated Singular Value Decomposition (TSVD), which is another regularization method that solves the ill-posed problem (). Each of the above methods is capable of producing a score for each gene pair. Note that for all of these methods, score S is not symmetric due to the directionality of regulatory relationships, i.e. S(i, j) = S (j, i). More details can be found in Supplementary Supporting Information S4. 4. Generate second layer DBN. For each method listed earlier, we integrated the scores from the 52 datasets together based on the cell lineage-specific gold standard pairs using Bayesian integration (). The integration workflow is similar with our previous works (), while the previous workflow is targeting gene co-functional networks (i.e. noFor each selected dataset, we calculated regulatory likelihood score for every gene pair using DBNs. The expression regulation was retreived from public databases and formed the global gold standard, which was then refined into erythroid-specific gold standard according to erythroid expression data. A second layer Bayesian classifier was used to integrate regulatory probablities from multiple datasets together based on the gold standard pairs and to generate the lineagespecific regulatory networkRegulatory network inferred using expression datadirections) while this workflow is modified and targeting regulatory networks (i.e. with directions). Datasets are weighted automatically based on their qualities and relevance to erythropoiesis. As will be described in the next section, the result indicates that both DBN and Time-Lagged Correlation have satisfying performance in the computational cross validation. In the following analysis, we will use DBN as the base-learner to infer the erythroid-specific network. More details can be found in Supplementary Supporting Information S4.To evaluate the improvement led by integrating multiple datasets, we generated a model for a global regulatory network in human. This was generated by using gold standard pairs not refined by lineage specificity.
Collecting gold standard regulatory interactions
Global pairsPositive gold standard pairs, which represent experimentally validated activation regulatory relationships, were obtained from KEGG (). More specifically, a gene pair to be included in the positive gold standards must be marked as positive in 'expression'. A number of 979 positive gold standard regulatory relationships were obtained. Because there is no existing database that defines non-regulatory gene relationships, the negative gold standard was approximated with randomly generated gene pairs.
Erythroid-specific differentiation data and gold standard pairsTo better represent the regulatory relationship in the erythroid differentiation process, we have generated a human erythroid cell differentiation dataset to further refine the gold standards to be cell lineage-specific. Purified human CD34  hematopoietic progenitor cells were allowed to differentiate ex vivo under conditions that were previously reported to achieve 1,000-fold cell proliferation and nearly synchronous erythroid differentiation (). RNA-seq measurements cover four time points, day 4, 8, 11 and 14 after initialization of differentiation, and two biological replicates were taken. This RNA-seq dataset is mapped to human genome using TopHat v2.0.10 () and Cufflinks v2.1.1 () using National Center for Biotechnology Information build 37.2 transcript annotation files. We then calculated Pearson's correlation coefficient for every expressed gene pair (an expressed gene is defined as the gene with Fragments Per Kilobase Of Exon Per Million Fragments Mapped value larger than 1 at least one time point). An erythroid-specific gold standard pair must satisfy two criteria:(i) it must be included in the generic positive regulatory gold standard pairs; (ii) this gene pair must be co-expressed in the erythroid differentiation dataset (q ! 0.30). Two hundred eighty positive gold standard pairs were retained in the erythroid-specific gold standards.
Prior transcription factor informationTo further improve our ability to infer the directionality in interactions, a list of 1469 human transcription factors was obtained from (). The transcriptional factor list was used to refine the prediction result, in which the predicted probability was first up weighted 20 times if i a transcriptional factor and all the probability values are re-scaled to.
ChIP-seq experimentWe used ChIP-seq experiment to experimentally evaluate whether the cell lineage-specific modeling can help identify the regulatory interactions specific to erythropoiesis. TR4 binding peaks in ChIPseq (chromatin immunoprecipitation followed by high-throughput DNA sequencing) data was compared against the predictions. TR4 (orphan nuclear receptor TR4, NR2C2) is a key factor in repressing fetal c-globin gene transcription and presenting in human and mouse erythropoiesis. TR4 peak annotation was based on the shortest distance from the center of a peak to the transcription start site (TSS) of the nearest RefSeq gene. The TR4 ChIP-seq was performed on Day 8 from CD34 cell cultures, which generated 32  106 TR4 ChIP-seq enriched, 50-bp short reads. One thousand twenty-five TR4 peaks were identified using a statistical cutoff of P < 10 5 (Supplementary Supporting Information S2). This dataset is used as the experimental validation for the erythroid-specific regulatory network. The TR4 downstream targets were validated by knocking down the expression of TR4 followed by transcription profiling with RNA-Seq. From this study, we find out that the genes with TR4 binding at the promoter region, within a 500-bp window, are potential TR4 downstream targets ().
Results
Computational evaluation of the prediction algorithmWe first evaluated the performance of predicting the global regulatory relationships without lineage specificity. To prevent contamination in cross-validation, the gold standard pairs were split into two disjoint graphs, with one serving as training set and the other one as testing set. We have repeated the computational cross-validation 10 times with different partition of the gold standard pairs. We evaluated this model using different base-methods to determine the regulatory likelihood within each dataset, i.e. DBN, time-lagged correlation, Lasso regularization and TSVD. Additionally, we evaluated the improvement gained using prior information of which genes are likely to be transcription factors. Receiver Operating Characteristic curve (ROC) and Precision Recall Curve (PRC) were used to visualize the accuracy of prediction by assessing Type I and Type II error ratios. Area under ROC and PRC were also calculated in order to quantitatively measure the accuracy. Without prior information of the regulators, the areas under ROC are both 0.568, for DBN and time-lagged correlation (). The method based on TSVD has lower prediction ability with an area under ROC. Furthermore, Lasso regularization delivers a close-to-random result and was thus removed from the following analysis. This is likely due to the extremely sparse regulatory relationships that were recovered after Lasso regularization, because Lasso's penalty term is not differentiable at 0. Then, we downloaded all known transcription factors in the human genome (Section 2.2.3). We up-weighted the predicted probability if the pair starts with a transcriptional factor. With prior information of the genes that are likely to be transcription factors, the area under ROC is further improved to extremely high values of0.863 and 0.854 and the area under PRC is increased to 0.347 and 0.346, for DBN and time-lagged correlation, respectively, indicating that the prior information added to this model is correct and is helpful in predicting the directions of the interactions.illustrates the ROC curves and the PRCs of using different base-classifiers to calculate the probabilities. DBN and time-lagged correlation showed high precision (>0.5) in low and median recall area. For example, in the cross validation, when FOS (FBJ murine osteosarcoma viral oncogene homolog) was a held-out gene, we could observe how well the predictions can recover the interactions of this gene. In the hidden test set, there are nine direct targets (IL1B, CDK4, VEGFB, CCND1, IL6, MMP2, FIGF, IL12B and CCL4) that are activated by FOS. For example, FOS promotes IL1B, IL6 and IL12B via DNA in JAK-STAT signaling pathway (KEGG: hsa04620), and promotes CDK4, VEGFB, MMP2 and CCND1 in PPAR signaling pathway (KEGG: hsa05200). Eight out of the nine targets are correctly identified () using our regulatory network with a probability value larger than 0.1, which is a cutoff about 20-fold of the randomly predicted probability with a z-score larger than 1. The only case that was missed out in the prediction was CCL4.
ChIP-seq experiment verifies predicted erythroidspecific regulatory interactionsBecause DBN showed decent performance among all base-learners in the cross-validation results of the global network, the erythroidspecific network was calculated using DBN as a base-learner. In this section, we compare the regulatory probabilities of genes regulated by TR4 against the distance (i.e. the distance between the middle of a peak and the TSS of the nearest gene) measured in the ChIP-seq data. The result is available at Supplementary Supporting Information S3. We separated the genes into two groups based on the distance from the peak center to the nearest TSS of RefSeq genes. For a random prediction, the probability value should be the baseline0.05. The distribution of probability values for different groups are displayed (). For TR4 direct downstream targets, namely the genes within a 500-bp window (low distance group, proximal promoter region), 25% of the regulatory probability is above 0.132. For the genes that are not in the 500-bp window (high distance group), 25% of the predicted regulatory probability is over 0.1512, indicating that TR4 is not regulating the genes in the high distanceRegulatory network inferred using expression datagroup. This shows that DIFMINE predicts the genes in low distance group with a much higher probability than the high distance group (P  0.0035). We have also evaluated the Pearson's correlation coefficient between the predicted probability values and the distance e, the results indicate that they are significantly correlated (q  0.24, P  2  10 5 ). Supplementary Supporting Information S5 is a representative view of TR4 binding sites of three top DIFMINE predicted genes (in low distance group), MRPL20, NOL7 and CTR9, by integrative genomics viewer (IGV) (). A clear peak is observed for both these three genes. Based on DIFMINE's prediction, the probability of TR4 regulating MRPL20 is 0.47 (z  3.32); the probability of TR4 regulating NOL7 is 0.43 (z  3.02); the probability of TR4 regulating CTR9 is 0.36 (z  2.40). This functional analysis supports that this method is able to identify direct regulatory relationships that are verified by binding data. Similar trend was observed between genes in the low distance group and all expressed genes. Furthermore, we found significant improvement achieved by using erythroid-specific integration compared with the global regulatory network (). The significant difference between low distance group, high distance group and all expressed genes, which is observed in erythroid-specific network, does not exist in the global regulatory network. Additionally, genes in the low distance group and high distance group do not have significantly different probability values (P  0.2251) in the global regulatory network.
Activities of known erythroid-related genesCell lineage-specific integration is further validated by important erythroid genes and their surrounding regulators.shows how the erythroid-related genes have significantly higher regulating probability values from their top 10 upstream regulators between erythroid-specific and global inference network. In general, erythroidrelated genes are predicted with much higher probabilities in the lineage-specific regulatory network compared with the global network. We repeated this evaluation on 110 expert-curated erythroid-related genes (100 genes from the Hembase database () and 10 well-known erythroid-related transcriptional factors). Similar trend was observed (Supplementary Supporting Information S1). For example, the top 10 genes regulating hemoglobin beta (HBB) have a significantly different probability values (P  5  10 5 ) for erythroidspecific network (average probability  0.652) then in the global. Validation of predicted probabilities of regulatory relationships using TR4 ChIP-seq data. Genes are split into two groups based on their distance from the peak center to the nearest TSS in RefSeq. The low distance group contains those genes with distances <300 bp. The high distance group contains genes that are >500 bp away and last group contains all the genes that do not have significant peaks.shows the distribution of predicted probabilities using DIFMINE with prior information,is regulatory probability for the global regulatory network inferred with prior information but without the differentiation-specificity.is the result from CLR.is directly using the correlation calculated on the erythropoiesis expression data. The P values indicating the difference between low distance group and high distance group are calculated using Wilcoxon rank-sum testOne most important utility of DIFMINE is that it is capable of interrogating context-specific regulatory relationships using a dataset with limited samples. To demonstrate this utility, we compared DIFMINE with a classical method, CLR. We used CLR to infer the regulatory relationships based on the same time-course RNA-Seq data we have collected.shows the distribution of CLR likelihood scores for the three groups in the ChIP-seq data, where noticeable difference between these three groups cannot be observed. This is further reflected by the non-significant Wilcoxon rank-sum test result (between the low distance and high distance group, P  0.1512). The correlation coefficient between predicted scores and distance is not significant either (q  0.072, P  0.117). We attribute the unsatisfactory performance of CLR to the small number of samples, i.e. CLR usually requires 10 of samples, but in this erythropoiesis dataset, only 8 samples (four time points and two replicates) are available. In fact, most methods based on coexpression, mutual information or any types of correlation could be severely harmed by the lack of samples, if no outside large-scale data is leveraged. This is further supported by directly using the coexpression networks as a prediction of regulatory relationships (), where the distance between TR4 and the middle point of genes is only marginally correlated with their correlation coefficients (q  0.172, P  0.049). This integration model, DIFMINE, uses both the context-specific and non-specific data to refine the regulatory network that is able to minimize the negative effect of the uncertainty due to insufficient sample size, and to adjust the network to fit the specific context.
Computational timeAssuming that the number of genes in a dataset is N, the number of dataset is M, and the number of samples is K, the computational complexity to perform each base-learner is OMN 2 K. For the second layer of Bayesian network (the integration step), the computational complexity is O MN 2   . In the experiment that was performed on a common commercial computer (with PowerEdge R410 processor), the running time for calculating probabilities over all datasets (the first layer of Bayesian network) is similar between different base-learners (DBN, timelagged correlation or TSVD), which is 5 to 7 days. More specifically, it takes 25 h for each dataset depending on the coverage (i.e. number of genes) of this dataset. As the calculation tasks between different datasets are independent, parallelization () can also be used to speed up this step, i.e. giving enough central processing unit/graphics processor unit cores, the computational time can potentially be reduced to O N 2 K   . The running time for the second layer of DBN is $16 h. The computational time is expected to be similar when analyzing different biological systems. Furthermore, results of the first layer of Bayesian network can be reused for different biological systems.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
F.Zhu et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Discussion Predicting cell lineage-specific GRNs is an important yet challenging problem in system biology. This is mainly due to the fact that lineage-specific expression data are usually limited in sample size. In this study, we developed a novel algorithm that models cell lineagespecific regulatory networks and applied it to erythropoiesis. This algorithm advances previous methods on two aspects: (i) Cell lineage-specificity: experimental validation indicates that it is more accurate than the classical methods and global integration in predicting erythroid-specific regulatory interactions. (ii) Robustness: the interrogation of multiple datasets for their relevance of a specific developmental process makes the integration more robust than using a single dataset. We have demonstrated the accuracy of the reconstructed regulatory network via computational and experimental validations. In computational cross-validation, results indicate that this model could precisely recover the hidden test set of gold standards. With prior information of a list of transcription factors downloaded from publicly available databases (Zhang et al., 2012), DIFMINE achieved area under ROC and PRC to 0.863 and 0.347, respectively. In experimental validation, results of DIFMINE are validated using ChIP-seq transcriptional factor binding peaks. A strong correlation between the predicted regulatory probabilities and the distances between the peak and the TSS site (P  2  10 5 ) was observed. Genes in the low distance group and high distance group also have a significantly different probability values (P  0.0035) based on Wilcoxon rank-sum test. Both of the computational and experimental evaluations supports that the accuracy of this model compared with previous models or context non-specific integrations.
