Motivation: Pairwise protein sequence alignments are generally evaluated using scores defined as the sum of substitution scores for aligning amino acids to one another, and gap scores for aligning runs of amino acids in one sequence to null characters inserted into the other. Protein profiles may be abstracted from multiple alignments of protein sequences, and substitution and gap scores have been generalized to the alignment of such profiles either to single sequences or to other profiles. Although there is widespread agreement on the general form substitution scores should take for profile-sequence alignment, little consensus has been reached on how best to construct profileâ€“profile substitution scores, and a large number of these scoring systems have been proposed. Here, we assess a variety of such substitution scores. For this evaluation, given a gold standard set of multiple alignments, we calculate the probability that a profile column yields a higher substitution score when aligned to a related than to an unrelated column. We also generalize this measure to sets of two or three adjacent columns. This simple approach has the advantages that it does not depend primarily upon the gold-standard alignment columns with the weakest empirical support, and that it does not need to fit gap and offset costs for use with each substitution score studied. Results: A simple symmetrization of mean profile-sequence scores usually performed the best. These were followed closely by several specific scoring systems constructed using a variety of rationales.
INTRODUCTIONProtein sequence comparison is fundamental to computational molecular biology. Early work in this field focussed on pairwise sequence alignment, and was then inevitably extended to multiple alignment. Approaches to multiple alignment that generalize dynamic programming to more than two dimensions () are necessarily confined to a small number of sequences, and have therefore found limited applications. Most multiple alignment * To whom correspondence should be addressed. algorithms proceed, in either a progressive or iterative manner, by performing pairwise alignments either between single sequences and multiple alignments or between two multiple alignments (). Closely related subfields concern the extraction of protein 'profiles', or position-specific score matrices, from multiple alignments and their comparison either to single sequences () or to one another (;). Central to any protein alignment method is the scoring system; it uses to distinguish among the exponentially large number of alternative alignments. For pairwise sequence comparison, alignment scores are usually constructed as the sum of 'substitution scores' for aligning pairs of letters, and 'gap scores' for aligning runs of letters in one sequence to null characters inserted into the other. In the context of ungapped local alignment, an analytic statistical theory () characterizes all substitution scores as log-odds scores, and most popular pairwise substitution scores have been explicitly constructed using the log-odds formalism (). Similarly, most extensions of substitution scores to profile-sequence comparison now involve log-odds scores as well, mediated by position-specific amino acid frequencies estimated from a multiple alignment column (). However, for profile profile comparison, there is no consensus on how the alignment of positions or columns from two profiles should be scored, and a large variety of such substitution scores have been proposed. There have been a variety of comparative evaluations of profile profile scoring systems (), some quite systematic and comprehensive. Most of these studies have assessed scoring systems by how well they were able to distinguish by score alignments of related and unrelated profiles, or by how accurately they were able to align related profiles. Several studies () faced the issue of how to choose profileprofile gap scores to use in conjunction with the various substitution scores considered. In addition, they had to 'offset' raw substitution scores so they could be used with equal footing in a local alignment algorithm. They addressed this problem by attempting to optimize, for each scoring system, gap and offset score parameters over a multidimensional space. Here, we take up again the question of comparing profileprofile substitution scores, but propose a new evaluation methodology that avoids the question of how best to select gap and offset parameters. In brief, given a 'gold standard' multiple alignment, we first choose two subsets of sequences from the alignment, and construct a profile from each aligned set. We then simply calculate the probability that a column from one of the profiles has a higher substitution score when aligned to the correct column of the other profile than when aligned to an incorrect column. We generalize this measure by considering two or three adjacent columns from one profile aligned to adjacent columns of the other. We argue below that these measures of scoring system quality are appropriate, and have several advantages to previous measures. Our approach is related to one suggested by Edgar (2004b), but differs in several ways, e.g. in that it does not compare columncolumn scores from different profile pairs. As described below, our approach requires a set of accurate multiple alignments involving fairly large numbers of distantly related proteins. Several multiple alignments sets have been developed for evaluating multiple alignment methodologies, but not all are well suited to our approach, often because their alignments involve too few sequences, or sequences that are on average too closely related. Accordingly, we based our evaluation set of multiple alignments upon a standard database, but supplemented it with carefully curated multiple alignments from several recent publications. We applied our measures of alignment quality to 39 profile profile substitution scoring systems, most of which have previously been proposed in the literature. Although no single scoring system emerged as best in all our tests, variations on the approach of constructing scores as an average of profile-sequence scores () consistently outperformed most others. Fairly close behind were 'BILD scores', constructed as a generalization to multiple alignments of pairwise log-odds scores (), a weighted and symmetrized form of relative entropy-based scores () and 'co-emission'-based scores (). Incorporating any of these substitution scores into a profileprofile or a multiple alignment program will generally require the introduction of gap scores and perhaps of offset scores. Our evaluation method purposely avoids the consideration of such scores, and the best way to define them may depend upon the substitution scores with which they will be used.
Profileprofile substitution scores
METHODS
Gold standard alignment setIn order to evaluate profileprofile scoring systems, we require a set of accurate multiple alignments to serve as a 'gold standard'. A variety of multiple alignment datasets have been developed for the explicit purpose of evaluating multiple alignment methods. Recently, Edgar (2010) analyzed several such sets (), and found them flawed by a variety of measures. Nevertheless, we require some alignments as a basis for analysis, and so began with OXBench (), the dataset that appeared most reliable by Edgar's measures. Our approach requires relatively large alignments, ideally containing over 25 sequences, of distantly related sequences. Only 11 OXBench alignments were suitable, so we supplemented these with 14 additional, carefully constructed multiple alignments from recently published papers (). The resulting alignment set is summarized in Supplementary Table S1; it has 25 alignments from 8 superfamilies, each alignment containing from 27 to 122 sequences. As described below, these large multiple alignments may be used to generate many distinct pairs of profiles, already in putatively proper alignment. Profileprofile alignment methods generally are used to compare profiles that are constructed from multiple alignments whose constituent sequences are more closely related within an alignment than between them. To construct pairs of profiles with this property, we proceed as follows. From a given gold standard multiple alignment, we choose at random a pair of sequences S 1 and S 2 to act as seeds for two profiles. We then choose at random a new sequence from the multiple alignment, determine with which of S 1 and S 2 (to both of which it is already aligned) it shares greater percent identity, and add it to the profile seeded by that sequence. We repeat this process until the two profiles have in aggregate N sequences, with N equal to 10 or 20. If one of the profiles so constructed has <3 sequences, we start over. Finally, the pair of profiles is assigned to a bin, depending on the mean percent identity between all sequences from one profile and all those from the other. Our bins cover the percent identity ranges 510, 1015, 1520, 2025, 2530 and 3035; any pair of profiles that falls into none of these bins is discarded. Given the size of our original alignments, we are able to generate a very large number of effectively distinct pairs of aligned profiles. We therefore populate our bins evenly, and with equal representation from each superfamily and, subordinately, from each constituent family. The only hindrance is that certain of our alignments lend themselves to generating profile pairs only for a subrange of percent identities, as detailed in Supplementary Table S1. When populating bins outside their effective range, these alignments are ignored.
Quality measures for profileprofile substitution scoresOur measures of substitution score quality are calculated on pairs of profiles that are putatively accurately aligned. For a given column of one profile, we calculate the percent probability  1 that its substitution score, when aligned to the correct column of the other profile, is greater than when aligned to an incorrect column; ties register as half a success. Averaging  1 over all columns of both profiles yields our quality measure 1. For profileprofile as for sequencesequence alignment, perhaps the simplest error involves the misalignment of a single column, which leads to the slight misplacement of a gap, as illustrated in. The measure 1 can be seen to bear directly on the probability of such a simple alignment error arising. Slightly larger errors in gap placement can correspond to the misalignment of two or more adjacent columns. An error of this sort, however, cannot always be explained as multiple single-column misalignment errors, and may require the scores of the misaligned columns to be considered together. Accordingly, we can extend the measure 1 to n by determining, for two related profiles, the mean percent probability that the aggregate score of n adjacent columns from one profile is greater when properly than when improperly aligned to n adjacent columns from the other. In this article, we will consider only the measures 1 , 2 and 3. Measuring substitution score quality in this way avoids using the scores actually to construct by dynamic programming new profile profile alignments, and may therefore be considered somewhat indirect. Nevertheless, our approach has several distinct advantages. The location of gaps in an accurate alignment of two profiles effectively limits realignmentbased measures to evaluating scores on a very small number of column Page: 3358 33563363pairs. In contrast, our measures treat all profile positions equivalently, and gather information from them all. Furthermore, it has recently been argued that none of the collections of multiple alignments used as gold standards for evaluating multiple alignment programs, or sometimes for evaluating profileprofile scoring systems, is very reliable (). A problem with constructing a new alignment B from sequences contained in a gold standard alignment A, and then comparing B to A, is that the two alignments are most likely to differ precisely in the columns of A that are least reliably aligned, whereas no information is gained from the majority of A's columns that are relatively easy to align, and therefore most likely to be accurate. An additional problem with realignment-based measures for evaluating substitution scores is that they generally require gap and offset scores to be specified for each scoring system. This entails optimizing at least three independent parameters (), which is time consuming and, because inevitably non-optimal, introduces noise into the analysis. More importantly, as discussed below, the best form for gap scores to take varies with the substitution scores employed (), so choosing a particular form for gap scores is likely to bias one's conclusions. This article proceeds on the assumption that it is reasonable to analyze substitution scores independently of gap and offset scores. Once a particular set of substitution scores has been selected, gap and offset scores may then be optimized in the chosen context.
X.Ye et al.
A B
General issues for profileprofile scoring systems
Sequence weights and independent observationsProfileprofile substitution scores depend at root upon the counts of amino acids observed in the two multiple alignment columns implicitly being aligned. However, the sequences comprising a multiple alignment generally cannot be viewed as independent observations from a protein family, but may have a complex structure of correlations arising from phylogenetic relationships. Accordingly, it is often advisable to downweight the amino acid counts derived from closely related and thus highly correlated sequences, and a large number of methods for doing this have been proposed (). Relatedly, it is also sometimes useful to estimate the number of effectively independent observations a column represents (), which is generally smaller than the actual number of residues it aligns. Using these methods, the data in a profile column can be summarized by an 'effective' amino acid frequency vector f (perhaps extended to include the null character as a twenty-first letter), and an 'effective' number of observations c. One may, of course, forgo any weighting methods in generating these column statistics. In either case, it will sometimes be useful to refer to the 'observed' amino acid count vector c = c f. In this article, when sequence weighting is performed, we used the method ofwith a modification described infor estimating the effective number of independent observations.
Predicted frequenciesBefore comparing a column, summarized by c and f , to another, it may be useful to estimate the unobserved amino acid frequencies q thought to characterize the column. When c is large q should approach f , but when c is small this will generally be a poor approximation: it is clearly wrong to infer zero probability for an amino acid to appear in an alignment position just because it is not observed in a small sample. Two methods for inferring q from c and f have gained widespread use. The 'Dirichlet mixture method' () is rigorously Bayesian. It assumes a Dirichlet mixture prior on the space of amino acid frequency vectors, and obtains q by integration over the posterior distribution implied by the data from a column. The alternative 'data-dependent pseudocount method' () calculates q by adding 'pseudocounts' to the observed amino counts c; these pseudocounts are derived from c and a specified pairwise amino acid substitution matrix. One motivation for this method is the desire for the target frequencies q to approach those implicit in the specified matrix () as c approaches 1. Both methods imply that q approaches f as c grows large. Many of the profileprofile substitution scores we will consider are defined using predicted frequencies q for the profile columns aligned. In order not to confound an analysis of the quality of substitution scores with the method used for deriving q from c, we employ the Dirichlet mixture method throughout. This choice is preferred because the Dirichlet mixture method is integral to the BILD-based scores () that we will consider. We use the 'recode3' Dirichlet mixture priors developed at the University of California at Santa Cruz (Supplementary; http://compbio.soe.ucsc.edu/dirichlets/index.html), but make no claim that these are superior to other possible priors.
Gap scores Profileprofile alignment scoring systems in general must deal with two distinct issues arising from gaps. The first is that a profile column itself may be constructed from a multiple alignment that contains gaps in the corresponding position. Should the frequency of gaps in this position be estimated explicitly? If so, how should such gap frequencies be considered when defining substitution scores for aligning two profile columns? As will be evident, some of the profileprofile substitution scores considered below have natural (although not necessarily optimal) generalizations to deal with gap frequencies, while others do not. The second issue is that the alignment of two profiles may introduce gaps, aligning columns of one profile with gap columns inserted into the other. How such gaps should be scored will depend upon the profileprofile substitution scores adopted, and also upon the way in which gap frequencies are treated by such substitution scores. Because the gap-scoring problems for profileprofile alignment are multifarious and likely not subject to a uniform optimal treatment (), we here attempt to sidestep the issues involved as much as possible. We ignore gaps within a column for all profileprofile substitution scores. To minimize the effect upon our results, we confine our analysis primarily to profile columns derived from alignment positions containing relatively few gaps. Also, our quality measures for substitution scores avoid any need to specify gap scores for profileprofile alignment.
Profileprofile substitution scoresThe substitution scoring systems we consider largely subsume those analyzed by Edgar and Sjlander (2004); Edgar (2004b);;;;. We do not, however, consider scores that are rounding variants of others, or that are asymmetric under exchange of the aligned columns, but we do analyze several scores considered in none of these papers. Many substitution scores make use either of the observed frequencies f associated with the columns compared, or the predicted frequencies q. In addition, some substitution scores use the odds ratio vectors g or r, defined by
Profileprofile substitution scoresfrequencies. Yet others use the log-odds score vector s defined by s i = logr i ; a corresponding score vector cannot be derived from g, because some of g's components may be zero. Certain profileprofile scores are defined using a standard pairwise substitution score matrix. Such a matrix S has implicit amino acid pair target frequencies Q (), which may also be expressed as amino acid pair odds ratios R. In short,, where  is a scale factor. In this study, we will use the BLOSUM-62 matrix (), and its associated target frequencies and odds ratios, whenever such a matrix is called for. We use the convention that larger substitution scores are better. However, some scoring systems are based on distances, with smaller distances preferred, so for these the substitution score needs to be the negative distance. In practice, an offset is usually added for constructing local alignments, but because we do not use the scores here for this purpose, we have no need for such offsets.lists the corresponding names those papers employ. Also, if a score was not introduced in one of these articles, the table cites the paper where it was first proposed, as best as we have been able to determine.
Euclidean-distance based scoresIntuitively, one prefers to align columns with similar letter frequencies, so one may base a scoring system on a 'distance' between two column-derived vectors. An obvious candidate is the Euclidean distance between vectors x and x :For aligning two profile columns, the vector x used in Equation (1) may be taken, variously, to be the f , g, q, r or s derived from the first column, and x the corresponding vector from the second. We call the five resulting scores, defined as the negative of Equation (1),r and Euclid-s.
Dot-product based scoresThe dot product of two vectors x and x is defined asBecause the dot product of two vectors of fixed magnitude increases as the angle between the vectors decreases, it has been seen as a promising basis for profileprofile substitution scores. Basing x and x in Equation (2) on the various profile-column vectors we have defined yields the five scores dot-f, dot-g, dot-q, dot-r and dot-s. In addition, when x and x are odds ratios, it has been suggested that a substitution score is better defined as the log of the dot product (), yielding in our notation the two additional scores ldot-g and ldot-r. Although such a monotonic transformation is invisible to our 1 measure of score quality, it can make a difference when the scores for aligned column pairs are added. Finally, Sding (2005) has proposed a profileprofile scoring system that, in essence, is the log of q@BULLET@BULLET r or q @BULLET@BULLET r; we call this score ldot-qr.
Pearson-correlation based scoresThe Pearson correlation of two vectors x and x is defined aswhere  x and  x are, respectively, the means of the components of x and x. Basing x and x on our various profile-column vectors yields the five scores corr-f, corr-g, corr-q, corr-r and corr-s. It has also been suggested () that one replace the components of the vectors x and x by their numerical ranks within these vectors (i.e. replacing the largest x i by 1, etc.) to yield y and y , and then calculate the Pearson correlation of these new vectors. Doing so yields the four scores we call rank-f, rank-g, rank-q and rank-r; because logarithms are monotonic, rank-s is identical to rank-r.
Pairwise-substitution-matrix based scoresGiven a pairwise substitution score matrix S and two probability vectors x and x , one can calculate the average score:Depending upon whether the observed or predicted frequencies are used for x and x , we call the two resulting scores aS-f and aS-q. The former is closely related to what are frequently called 'SP' or 'Sum-of-Pairs' scores for multiple alignments (). A variation on this idea averages the target frequencies Q or odds ratios R implied by S and then takes the logarithm of this average (von). We call the resulting scores laQ-f, laQ-q, laR-f and laR-q.
Relative-entropy based scoresThe relative entropy () of two probability vectors x and x is defined asBy continuity, H may be extended to the case where some x i are zero by simply omitting the corresponding terms. However, if any x i vanishes while x i remains positive, H is undefined. Although H is asymmetric, it may be symmetrized () using the definitionWith predicted frequencies q and q substituted for x and x , the negative of this expression yields a score we call sre-q (). In general, no corresponding score using observed frequencies is valid, because one H term or both may be undefined. An alternative symmetrization of relative entropy is the JensenShannon divergence (), defined aswhere x = ( x ++ x )/2. The negative of this expression may be used with either observed or predicted frequencies to yield the two scores we call JS-f and JS-q, respectively.argued that columns with amino acid frequencies far from the background frequencies p should have greater weight than those with frequencies near p, and therefore defined a scoreDepending upon whether observed of predicted frequencies are used for x and x , we call the resulting scores YL-f and YL-q.
Profile-sequence based scoresOver the years a number of methods have been proposed for generating profile-sequence substitution scores, but a consensus has formed on the best general strategy. From a multiple alignment column with observed counts c, one estimates amino acid frequencies q, from which odds ratios r and log-odds scores s are derived. The score for aligning the profile column to a particular amino acid then reduces to selecting the appropriate component of s. If instead one wishes to align the profile column to that from another profile, one possible generalization is to use the observed frequencies f from the second profile column to calculate a weighted average f @BULLET@BULLET s of profile-sequence scores (). An immediate conceptual difficulty is that it is unclear why one profile column should be used to generate the scores and the other to average them. It is simple, however, to symmetrize this approach and define the score f @BULLET@BULLET s+ f @BULLET@BULLET s (), which we call sdot-fs. Variations on this idea replace the observed frequencies f and f with either the observed counts or the predicted frequencies, to yield respectively the scores sdot-csPage: 3360 33563363
X.Ye et al.and sdot-qs (). A modification of sdot-cs, implemented in the program Compass (), and which we call comp-cs, isA motivation for this definition is that it reduces to the standard profilesequence substitution score when one of the columns consists of a single observation. We will also consider the scoring system comp-fs, with the same limiting property, in which the count vectors in Equation (9) are replaced by observed frequency vectors. For either comp-cs or comp-fs, when both c and c are 1 the substitution score may be defined using a standard pairwise score matrix. As described above, we here calculate q and q and the resulting s and s using the Dirichlet mixture method in lieu of the data-dependent pseudocount method employed by PSI-BLAST () and in Sadreyev and; Wang and Dunbrack (2004).recently proposed a generalization of pairwise log-odds substitution scores to profileprofile alignments. Specifically, they assumed an M-component Dirichlet mixture prior, with mixture parameters (m i ; i = 1,2,...,M) and Dirichlet parameters ( i,j ; i = 1,2,...,M;j = 1,2,...,20). Then the probability of observing a specific column with count vector c is given by
BILD scoreswhere  i  j  i,j and () is the Gamma function. The BILD score for aligning two columns with count vectors c and c is then
RESULTSWe evaluated the profileprofile substitution scores described above on profile pairs generated as described in Section 2. Specifying either 10 or 20 aggregate sequences, we generated 2400 aligned profile pairs P and P for each mean percent identity bin. For each pair, we calculated the quality scores 1 , 2 and 3 defined above, either using sequence weights or not. We omitted, however, from this calculation any columns of P or P containing over 25% gap characters. For each substitution score, the mean values of 1 , using weights, are shown in. These values are significant to approximately the first digit past the decimal. In each column, the largest  1 is italicized, and all  1 that differ by <1% (in absolute rather than relative value) are shown in bold. In addition, for ease of interpretation, the differences between each value of  1 and the maximum in its column are represented in a color panel to the right of the table of numbers. We discuss below several broad features of, and the relationship of its data to those that result when various parameters of our analysis are varied. For each score, the values of  1 increase both with the mean percent identity between profiles, and with their aggregate number of sequences. This is fully expected, as both changes should render it easier to align the profile columns correctly. The performances of certain pairs of scores, i.e. (dot-g and ldot-g) and (dot-r and ldot-r), are indistinguishable by  1. Brief consideration reveals that this will be true of any scores that may be mapped to one another by a monotonic function. Nevertheless, we continue to consider both scores from each pair because the quality measures  2 and
Page: 3361 33563363
Profileprofile substitution scores
X.Ye et al.evaluation approach different than ours, but one that also avoided defining gap and offset scores. They found that, among those scores they considered, the best were YL-q (), and several sequence profile-based scores, probably led by compcs (). BILD and ldot-qr scores, of course, had yet to be defined. Several studies that required the fitting of gap and offset costs (;) were unable to demonstrate much significant difference among most of the scores they considered. Because of this article's focus, it is silent upon the questions of how best to weight correlated sequences within a multiple alignment when constructing a profile, and on how best to define gap and offset scores for use with the recommended substitution scores. Any fully functional profileprofile alignment program needs to address these questions. It is hoped, however, that by restricting the variety of substitution scores that are best considered, it will be easier to take up these additional issues.
Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
do in fact distinguish them. We now turn to examining the relative performance of the 39 substitution scores. Several scores, namely Euclid-g, Euclid-r, dot-s, rank-q, rank-r, aS-q and laQ-q, do quite poorlymore than 5 percentage points worse than the best scorein most or all columns of Figure 2. The score sdot-fs (Mittelman et al., 2003), a simple average of profile-sequence scores, outperforms all others in 75% of the columns, and is second best to the related sdot-qs in the remaining 25%. The ideas of using observed counts (sdot-cs) or predicted frequencies (sdot-qs) in place of the observed frequencies to calculate this average do not, in general, yield an improvement, nor does the idea of giving extra weight to the profile-sequence scores derived from the larger profile (comp-fs; comp-cs). After sdotfs and closely related scores, BILD scores (Altschul et al., 2010) usually perform second best, and YL-q scores (Yona and Levitt, 2002) third; both almost always yield a  1 within 2 percentage points of the best. In 47.9% of the cases shown in Figure 2, employing sequence weights yields a worse value for  1 than does leaving the profile data unweighted. The differences between the values of  1 when weights are employed and when they are not is shown in Supplementary Figure S1. It is somewhat surprising that weights degrade performance so often. Of course, for the alignments used to generate the test set, some care has been taken to eliminate redundancy. Thus, sequence weighting is less likely to be of value for our than for more general profile pairs. Nevertheless, Supplementary Figure S1 shows clearly that the weights we have employed (Altschul et al., 2009; Sunyaev et al., 1999) tend to improve most scoring systems' performances at low mean sequence identity (515%), but to hurt them at moderate identity (2535%), and this effect is more pronounced the more sequences the profiles contain. Also, it is evident that these weights are substantially better adapted to certain profileprofile scoring systems than to others. The use of weights or not does not alter in any substantive way our conclusions concerning which profileprofile scoring systems are best. However, that weighting degrades so many of the  1 , some very significantly, implies that much remains unknown about the proper construction of sequence weights, at least for use with profileprofile substitution scores. Pursuing such an analysis further is beyond the scope of this article. It is advisable to consider quality measures based upon multiple columns, so we have performed experiments similar to those described above for  2 and  3. The results are given in Supplementary Figures S2 and S3. We observe, first, that by these measures, a monotonic function applied to a scoring system now affects its quality, because the magnitude of the scores becomes relevant once they are added. As a result, dot-g becomes distinguishable from ldot-g, and dot-r from ldot-r. Second, as more adjacent columns are considered, it becomes easier to distinguish correct from incorrect alignments. For alignment pairs containing 20 total sequence, with 3035% mean sequence identity, the best scoring system has a >99% chance, and almost every other scoring system a > 94% chance, of assigning the correct alignment of three adjacent columns a better score than an incorrect alignment. We could extend our measure to four or more adjacent columns, but such an analysis eventually becomes irrelevant. There are a few minor differences between the one-, two-and three-column results. The basic finding stands that sdot-fs and related scores in general
. Some differences exceed the upper limit of the color scale. perform best. The relatively poor performance of BILD scores at low mean sequence identity is more apparent, but as we will see below, this deficit may be mitigated by using different Dirichlet mixture priors. Also, for 2 and 3 , the performance of ldot-qr scores (Sding, 2005) rises to among the best. One may construct predicted frequencies q for an alignment column using a variety of priors for the Dirichlet mixture method, as well as by using the alternative data-dependent pseudocount method (Altschul et al., 1997; Tatusov et al., 1994) with a standard pairwise substitution matrix. To study whether our results are sensitive to these variations, we reran our experiments for the quality measure  1 with sequence weights, but using 'recode4', 'recode5' and 'fournier' Dirichlet mixture priors (Supplementary Tables S2b, S2c, S2d; http://compbio.soe.ucsc.edu/dirichlets/index .html) in the place of 'recode3', as well as using the datadependent pseudocount method in conjunction with the BLOSUM62 substitution matrix (Henikoff and Henikoff, 1992). We compare the results to those using 'recode3' in Supplementary Figure S4. Many of the scoring systems we have studied make no use of predicted frequencies, so these are omitted from the comparison. Also, as discussed above, BILD scores can be used only with the Dirichlet mixture method. As can be seen, different Dirichlet priors may be optimal for different scoring systems. For example, 'recode4' priors yield the best average results for YL-q, 'recode3' for sdot-fs and 'fournier' for BILD. Furthermore, the data-dependent pseudocount method yields better results than does the Dirichlet mixture method for most scoring systems, but not for sdot-fs and most related scores. Nevertheless, even when each scoring system is paired with its optimal method for estimating q, our basic conclusions still hold. 4 CONCLUSION In this article, we have addressed the isolated question of how best to define substitution scores for profileprofile comparison. Using gold standard multiple alignment datasets, we constructed pairs of profiles with known alignment. We then measured the quality of a scoring system by the probability with which it rated properly aligned columns better than improperly aligned ones. This evaluation method has several advantages, as described above. Our results suggest that among the wide variety of substitution scores considered, the best are variations on sequence-profile based scores, most notably sdot-fs (Mittelman et al., 2003), followed fairly closely by BILD (Altschul et al., 2010), YL-q (Yona and Levitt, 2002) and ldot-qr (Sding, 2005) scores. BILD scores have various attractive theoretical features; for example, they yield a consistent measure of multiple alignment similarity, and may help define the proper boundaries of a homologous domains (Altschul et al., 2010). Although BILD scores may be preferred for these reasons, this study suggests that other scores may be somewhat superior for the simple purpose of profileprofile comparison. To the extent that previous studies have been able to distinguish among the scoring systems they considered, their results are broadly consistent with ours. For example, Mittelman et al. (2003) took an
