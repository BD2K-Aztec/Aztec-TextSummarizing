Motivation: Sampling the conformational space of biological macromolecules generates large sets of data with considerable complexity. Data-mining techniques, such as clustering, can extract meaningful information. Among them, the self-organizing maps (SOMs) algorithm has shown great promise; in particular since its computation time rises only linearly with the size of the data set. Whereas SOMs are generally used with few neurons, we investigate here their behavior with large numbers of neurons. Results: We present here a python library implementing the full SOM analysis workflow. Large SOMs can readily be applied on heavy data sets. Coupled with visualization tools they have very interesting properties. Descriptors for each conformation of a trajectory are calculated and mapped onto a 3D landscape, the U-matrix, reporting the distance between neighboring neurons. To delin-eate clusters, we developed the flooding algorithm, which hierarchically identifies local basins of the U-matrix from the global minimum to the maximum. Availability and implementation: The python implementation of the SOM library is freely available on github: https://github.com/
IntroductionClustering is an ideal way to reduce huge high-dimensional data sets generated by conformational sampling, facilitating their analysis and visualization. In general, clustering requires prior knowledge, such as the relevant number of clusters. Furthermore, the encoding of the structures in 3D Cartesian atomic coordinates depends strongly on alignment, a problem when studying large conformational transitions such as folding/unfolding. Our novel algorithm to analyze conformational sampling addresses these points: (i) To abolish the dependence on structural alignment, we use the matrix of squared Euclidean distances as conformational descriptor. (ii) We exploit the property of large self-organizing maps (SOMs) to spontaneously and clearly cluster similar conformations in basins, and to separate dissimilar ones by barriers, by projecting the highdimensional exploration onto 3D landscape maps.
ApproachThe conformational descriptor is derived from the matrix D of squares of Euclidean distances d i,k between atoms i and k. To speed up the SOM training and reduce memory usage, we use a subset of atoms (for proteins, the n C a atoms) and the resulting n  n matrixD is condensed by computation of the eigenvectors of the covariance matrix, C:whose eigenvalues, N i , vanish for i > 4 (). d algorithms (). SOMs are best visualized by the U-matrix (Unified distance matrix), filled with U-values, the mean distance of each neuron and its eight neighbors. Since our descriptor is in A  2 units, we calculate the square root of the U-matrix to display results in A  units. Since our SOMs are toroidal, clusters can straddle the matrix border, making visual interpretation difficult. To overcome this, we use the periodicity to position the U-matrix basins in an aggregated way with the largest barriers outside. This is done by 'flooding', inspired by the watershed algorithm (). Flooding starts from the global minimum of the U-matrix. Periodic boundaries are applied to define neighbors. The water level rises continuously until the whole map is covered, except when a new basin is found. Then, the minimum of the new basin is identified by steepest descent and the flood continues from that point.
ImplementationThe package is implemented in python and requires a PDB file and a trajectory in CHARMM DCD format as input. It includes the makeVectorsFromdcd.py utility to generate descriptors, the SOM.py library to compute the SOM and the U-Matrix, and the SOMclust.py library to perform flooding. A detailed. The square root of the U-matrix, showing the local similarity between structures, is plotted as a contour plot. The RMSD from the native structure is shown in the prune-green heat-map. The U-matrix minima are shown with red dots and their minimum spanning linking tree with black lines. Some conformation sets associated with local minima of interest are depicted in putty cartoons. The root mean square fluctuation (RMSF) of the backbone is represented by the width of the main chain and the blue-green-red color code how-to is accessible: http://nbviewer.ipython.org/gist/bougui505/ 9955459.
ResultsThe SOM algorithm was applied to the analysis of 15 ms molecular dynamics at 330 K of a simplified sequence of a 56-residue a=b subdomain of the protein G () (). This 750 000-frame trajectory presents multiple folding and unfolding events. The map organizes the large diversity of explored conformations, from extended forms to the native state. The U-matrix depicts the covered conformational space and its topology. The minimum spanning tree between local minima reveals possible transition paths between conformational basins. We found 53 conformational basins and corresponding minima. The transition (i ! j) probability flux for each pair of basins (i, j) can be computed as explained in. This Markov model provides the distribution of the first passage times in the folded basin. The distribution we obtain is similar to the one found byand can be fitted by a single exponential in a similar way, with a mean folding time of 137 ns, compared with 163 ns (seein Supplementary Materials).
ConclusionThe package presented here exploits the ability of SOMs to spontaneously cluster macromolecular conformations. It provides a powerful tool for the analysis and visualization of the sampled conformational space even when they cover extremely different areas. It can also delineate more subtle conformational changes such as catalytic mechanisms of an enzyme (). Furthermore, the method can be applied to sparser sampling as inwith only 3900 conformations. The SOM algorithm is a non-linear dimensionality reduction technique, in contrast to linear approaches such as principal component analysis. This is of major importance for the study of highly non-linear processes such as folding/unfolding. The SOM computation effort scales linearly with data size and this enables us to cluster even massive numbers of conformations. This is very important given the ever increasing length of simulations. It is largely automatic and has only very few parameters, which we have optimized for this type of application. The good agreement with the previous study byon the same trajectory is highly satisfying, in particular considering the fact that our method requires no interventions. The SOM library is very flexible and the conformational descriptors can be tailored to different cases of conformational clustering and analysis.
FundingThis
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
i is the average of d 2 i;k on all the atoms k. Then, we obtain our conformational descriptors by projection of D on N i : P i  D  N i , i 2 1;. . .; 4. A toroidal map is used to make all neurons equivalent and avoid border effects. Each neuron is a 4 n vector, n being the number of descriptor atoms, initialized with a uniform distribution covering the range of descriptor values. With our examples, a size of 50  50 neurons resulted in densities of 10 to 20 conformers per neuron, which proved appropriate for visualization of the U-matrix and analysis of the data. For other systems, the size of the map may need to be adjusted to obtain a similar density. Training proceeds in two phases, taking each input vector at least once per phase (by default once in the first phase and twice in second) to identify the closest neuron and update it and its neighborhood. The learning rate decreases exponentially from 0.50 to 0.25 in the first phase and from 0.25 to 0 for the second. The neighborhood function is a Gaussian, whose radius exponentially decreases from 6.25 (a quarter of the map toroid radius) to 3.00 in the first phase, and from 4.00 to 1.00, for the second. These parameters ensured convergence for various datasets of different sizes issued from molecular dynamics or other sampling
G.Bouvier et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
