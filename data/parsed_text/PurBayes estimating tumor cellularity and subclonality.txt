We have developed a novel Bayesian method, PurBayes, to estimate tumor purity and detect intratumor heterogeneity based on next-generation sequencing data of paired tumor-normal tissue samples , which uses finite mixture modeling methods. We demonstrate our approach using simulated data and discuss its performance under varying conditions. Availability: PurBayes is implemented as an R package, and source code is available for download through CRAN at http://cran.r-project. org/packageÂ¼PurBayes.
INTRODUCTIONWith advances in high-throughput next-generation sequencing (NGS) technologies, sequencing of tumor-normal tissue pairs is becoming commonplace in cancer studies. Often, the sampled tumor tissue is contaminated with stromal cells, resulting in a mixture of tumor and normal sequence data in the tumor sample. There has been a recent interest in accurate estimation of tumor purity levels in tumor data analysis (), including methods specific to NGS data such as PurityEst (). However, a subset of the observed somatic mutations may be subclonal because of intratumor heterogeneity (). Unlike clonal mutations, which are observed tumor-wide, subclonal mutations will be observed at cellularities less than the tumor purity level and subsequently bias purity estimates under an assumption of tumor tissue homogeneity. By modeling this heterogeneity, it may also be possible to make inferences about tumor evolution and founder events. To date there are no methods that aim to both quantify tumor purity and detect intratumor heterogeneity using NGS data. In this article, we present a Bayesian mixture modeling approach, PurBayes, toward estimating tumor purity and subclonality using NGS data, resulting in posterior distributions of tumor cellularities from which credible intervals (CI) can be derived. To illustrate its implementation, we conduct a simulation study under a variety of conditions and discuss the performance of PurBayes on synthetic data.
METHODSFor a set of S observed heterozygous loci because of somatically acquired single-nucleotide variants (SNVs) for a given tumor sequencing sample, each SNV can be represented by respective normal and mutant allele read counts X i and Y i. The total number of sample reads N i  X i  Y i can in turn be decomposed into respective tumor and normal tissue read counts N t i and N w i , such that N i  N w i  N t i. As it cannot be directly determined which cell type each individual read was derived, N t i and N w i are latent variables. If we assume N t i to be binomially distributed, such that N t i $BinN i ,  and indicates tumor sample purity, and Y i jN t i $BinN t i , 0:50, then Y i follows a binomialbinomial hierarchical mixture model with marginal distribution BinN i , =2 (). Consider a tumor that exhibits intratumor heterogeneity. If we assume subclonal mutations cluster into an a priori finite number of J-1 subclonal populations, Y can be modeled under a Bayesian finite mixture model. Let j denote to the probability a mutation corresponds to variant population j with respective cellularity j , for j  1,. .. , J, such that P j j  1, 1 5. .. 5 J1 5 J , and J ffi , with uniform priors on j. To obtain a data-driven value for J, PurBayes generates model fits iteratively by initially assuming tumor homogeneity and then increasing the subclonal population count by one until an optimal model fit is achieved under a penalized expected deviance (PED) criterion (). Mapping bias can result in non-reference alleles in heterozygous loci being mapped at rates50.50 (), which would impact tumor purity estimation. PurBayes can accommodate this bias by estimating it from additional reference and alternate allele counts in heterozygous normal tissue variant calls. PurBayes is implemented in the statistical programming language R and uses the MCMC software JAGS (). The only inputs required for PurBayes are the tumor tissue read counts (N and Y) for a set of highconfidence SNVs, which can easily be derived from most variant calling software output file formats on NGS data.
SIMULATIONSTo illustrate the performance of PurBayes under a variety of conditions, we conducted simulation studies based on real sequencing data from the 1000 Genomes Project () (details in Supplementary Materials). We first simulated read count data for homogenous tumors ranging in purity from 2080%, with S  100 and average sequencing depth at 50 and 100. We ran 100 replications of each unique set of conditions and examined the PurBayes posterior median estimates. We ran similar simulations for heterogeneous tumor data with J  2 at 100 for various values of j and j to determine how well PurBayes can detect intratumor heterogeneity and estimate tumor purity. For each application, we also simulated read count data from 100 additional germ line variant calls to account for mapping bias. For purposes of comparison, we also applied the PurityEst algorithm to each simulation replicate.For each application of PurBayes, the first 50 000 iterations of the optimal MCMC model fit were discarded as a burn-in before posterior sampling of 10 000 iterations. Mean per-sample execution time was $2 min on a workstation equipped with an Intel  Core TM i5 3.10 Ghz processor and 4 GB of random access memory.
RESULTS AND DISCUSSIONFor the homogenous tumor simulations, PurBayes correctly identified tumor homogeneity in all replications. Distributions of the posterior median estimates of tumor purity for each value of and method are displayed in. Estimates from PurBayes and PurityEst were nearly identical, with a Pearson correlation of 0.9997. Both methods were accurate, tending toward overestimation at lower values of. When we applied PurBayes to heterogeneous data, the ability to detect heterogeneity was highly dependent on the disparity between cellularities (). The proportion of clonal variants also affected detection, with larger values of 1 leading to higher mean absolute error (MAE) of the posterior median purity estimates. Although PurityEst performed comparably under certain conditions, the ability for PurBayes to detect heterogeneity generally resulted in greater estimate accuracy. Our simulation results highlight the potential bias of tumor purity estimates in the presence of unaccounted intratumor heterogeneity. By simultaneously estimating tumor purity and subclonality, PurBayes may also provide additional advantages, such as facilitating inference regarding the tumor composition and evolution as well as isolation of potential founder events. As a Bayesian approach, measures of uncertainty are directly derived from the posterior distribution of J in the form of CIs. One possible issue in the application of PurBayes is if it estimates J to be larger than the true value because of outlier observations, which leads to a positively biased tumor purity estimate. This can be especially problematic with the existence of copy number variation (CNV) and structural rearrangements. Given that regions of CNV will result in multiplicative impact on the number of mapped reads and SNVs contained within such regions will not truly reflect heterozygosity at a proportion of 0.50, such SNVs would highly influence estimation of J. As such, we anticipate PurityEst to perform better in instances in which CNVs are present and unaccounted for in purity estimation because of its robust estimation procedures. It is thus highly recommended that regions indicated to be CNVs by parallel analyses be filtered from the estimation procedure. We foresee a variety of extensions to the concepts in PurBayes. For example, the mixture model could be alternatively formulated to characterize tumor cellularity as a continuous distribution using semi-parametric approaches. Integration of CNV and ploidy information will also make PurBayes a more effective estimator.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
PurBayes at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
