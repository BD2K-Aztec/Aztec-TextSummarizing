Motivation: It has recently become possible to build reliable de novo models of proteins if a multiple sequence alignment (MSA) of at least 1000 homologous sequences can be built. Methods of global statistical network analysis can explain the observed correlations between columns in the MSA by a small set of directly coupled pairs of columns. Strong couplings are indicative of residue residue contacts, and from the predicted contacts a structure can be computed. Here, we exploit the structural regularity of paired b-strands that leads to characteristic patterns in the noisy matrices of couplings. The b–b contacts should be detected more reliably than single contacts, reducing the required number of sequences in the MSAs. Results: bbcontacts predicts b–b contacts by detecting these characteristic patterns in the 2D map of coupling scores using two hidden Markov models (HMMs), one for parallel and one for antiparal-lel contacts. b-bulges are modelled as indel states. In contrast to existing methods, bbcontacts uses predicted instead of true secondary structure. On a standard set of 916 test proteins, 34% of which have MSAs with < 1000 sequences, bbcontacts achieves 50% precision for contacting b–b residue pairs at 50% recall using predicted secondary structure and 64% precision at 64% recall using true secondary structure, while existing tools achieve around 45% precision at 45% recall using true secondary structure. Availability and implementation: bbcontacts is open source software (GNU Affero GPL v3) available at https://bitbucket.org/soedinglab/bbcontacts Contact
IntroductionMethods for protein structure prediction can be classified into template-based and de novo methods. The first group model the structure for a query protein based on a sequence alignment with a homologous template protein of known structure. This class of methods is by far the most widely used for its speed and reliability. Many protein families lack a 3D template, and therefore much effort has been invested into developing methods for de novo protein structure prediction. The most successful de novo prediction methods, such as ROSETTA (), are based on complex, knowledge-based scoring functions and structural fragment assembly. Even though in roughly a quarter of the cases the top methods can produce models with the correct fold (), their practical usefulness is severely limited by the difficulty of predicting which models are correct. An alternative de novo approach relies on the observation that correlated mutations between pairs of multiple sequence alignment (MSA) columns could predict physical contacts between residues (). Furthermore, it was realized that only few correctly predicted residue-residue contacts ($10% of the number of residues) are sufficient to predict the correct protein fold (V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.). However, it was only recently that statistical methods were applied to the MSAs that could distinguish direct couplings between MSA columns from mere transitive correlations (). This allowed for the first time the reliable de novo prediction of structures for proteins with many homologs (). In the past few years, these methods have been further improved by applying different approaches of direct coupling analysis (). Yet, obtaining reliable structural models requires large numbers of homologous sequences, still severely limiting the scope of these methods. Here, our goal is to increase the reliability of contact predictions by detecting patterns in the matrix of predicted couplings corresponding to interactions between secondary structure elements. We focus on the case of bb contacts because of their strongly constrained spatial arrangement. b-sheets are composed of regularly arranged pairs of interacting b-strands. The interaction between two extended b-strands is defined on the basis of regular patterns of hydrogen bonds, connecting residues in two different strands in either a parallel or an antiparallel fashion (). The prediction of contacts between b-residues has applications in protein design (), in the study of folding characteristics () and in de novo protein structure prediction (). According to a recent study, while direct contact predictions have similar average precision for mainly-a and mainly-b proteins, the structural models obtained using these predictions as restraints are more accurate for mainly-a proteins (). A variety of methods have been developed for the prediction of bb contacts. An early method used statistical potentials for pairs of interacting b-strand residues ().were the first to predict bb contacts with neural networks. Cheng andintroduced the important idea of exploiting the topology of b-sheets in their BetaPro method by filtering out the solutions incompatible with the specific geometry of b-sheets. In MLN and MLN-2S, Lippi and Frasconi (2009) used Markov logic networks to incorporate structurebased constraints directly into the learning process. Two recent methods use correlated mutation signatures to predict b-sheets. CMM () integrates these with a b-topology model. BCov () processes predicted coupling scores with integer programming to enforce topological constraints. CMM, BCov and MLN-2S display the best bb contact prediction performances so far (). Finally, some methods aiming to predict all protein contacts (not only bb contacts) also use topological information, in particular related to b-sheet organization: CMAPpro (), PhyCMAP (), PconsC2 (). PconsC2 reports the highest contact prediction accuracies to date. It takes direct coupling scores from the PconsC meta-predictor as input and trains random forests on local 11  11 windows in the coupling matrix to predict the contact state of the central cell. Existing bb contact prediction methods have used known instead of predicted secondary structure. It is unclear, however, how they would perform in practice when substituting true with predicted secondary structure. Here, we describe a method to predict bb contacts that, even though it makes use of predicted instead of true secondary structure, achieves better performance than previous methods. We designed two hidden Markov models (HMMs) for parallel and antiparallel bb contacts that integrate signals from the predicted couplings and the predicted secondary structure.
Methods
General approachSimilar to contact maps or distance maps, which can be used to describe a protein structure or compare two structures (), direct coupling predictions can be mapped on a twodimensional grid. Each cell in the resulting matrix contains the strength of the predicted coupling, indicating whether the two corresponding positions in the protein are reliably predicted to be in direct physical contact. We call such representations 'matrices of predicted couplings' or simply 'coupling matrices'. Interactions between b-strands create conspicuous patterns in the coupling matrices, linked to the regularity of their 3D structural arrangement.shows a coupling matrix for a domain of PDB structure 3dk9, with four highlighted antiparallel bb contacts. A schematic antiparallel pattern is displayed intogether with a diagram showing the corresponding contacts between b-residues. In short, b-strand interactions create a diagonal stretch of strong couplings between the closest residues. This stretch is perpendicular (respectively parallel) to the diagonal of the coupling matrix for antiparallel (respectively parallel) b-strands. Most often, given a contact between residues i and j on this main diagonal, increased couplings can also be observed between i and j 6 2 and between j and i 6 2, as the corresponding side-chains are close in space and point in the same direction. Such couplings form 'secondary diagonals' on both sides of the main diagonal of the pattern. Interactions between b-strands are very regular, but b-bulges constitute a frequent type of irregularity disrupting the regular alternation of side-chain direction (). The most frequent b-bulges arise from the insertion of a residue between successive hydrogen bonds connecting two b-strands. Such b-bulges induce a shift in the main diagonal of the pattern by one position, as illustrated in. In some rarer cases, a b-bulge can arise from the insertion of one residue on each b-strand (so that the main diagonal of the pattern is not shifted) or from the insertion of more than one residue on one b-strand (so that the main diagonal of the pattern is shifted by more than one position). To detect the patterns created by bb contacts, we designed the HMM architecture shown in. In contrast to most HMMs used in bioinformatics applications (e.g. transmembrane helix predictions), our HMM detects patterns in a 2D map and not in a 1D sequence or 1D sequence profile. The nine hidden states circled inrepresent different types of interactions between pairs of b-residues. The 'first' and 'last' states represent the first and last non-bulge residueresidue contacts. The 'internal' state is the main HMM state and bb contact predictions can be extended to any length by looping through this state. b-bulges correspond to indels in HMMs used for pairwise sequence alignment. We only take into account b-bulges inducing a shift in the pattern and this shift is achieved through the transition from bulge i 0 to bulge i 1 or from bulge j 0 to bulge j 1. All HMM transitions except those between two bulge states correspond to a diagonal (respectively antidiagonal) displacement for parallel (respectively antiparallel) bb contacts. Bulge states i 2 and j 2 allow for the insertion of two residues in the same b-bulge; we do not allow for the insertion of more than two residues. The 'start' and 'end' states are added for modelling both ends of the contact between two extended b-strands. Figures 1c and d show coupling patterns with annotated HMM states. The same HMM architecture is used for parallel and antiparallel bb contacts, but two different sets of HMM parameters are trained (Section 2.5) and the direction of HMM decoding is diagonal for parallel contacts and antidiagonal for antiparallel ones.The observed variables are the real-valued predicted couplings as well as the predicted secondary structure states (or the true secondary structure states assigned by DSSP (), when used in order to compare our method with existing ones). The HMM emission probabilities consequently include a product of continuous emissions accounting for the observed couplings (including signals from the main diagonal and the secondary diagonals of the pattern) and discrete emissions accounting for the discrete secondary structure states (H, E and C). These emissions are described in more detail in Section 2.5. A path (sequence of states) traced by the HMM through the coupling matrix corresponds to a contact between two extended b-strands. Each state within the path corresponds to an interaction between two b-residues. We want to detect all patterns in the coupling matrix corresponding to parallel and antiparallel b-strand contacts. To this effect, we use a local version of the Viterbi algorithm, so that we can predict several paths that can start and end anywhere in the coupling matrix. The Viterbi score associated to a path measures the confidence of the corresponding prediction. We rank the paths by decreasing Viterbi score and retain all paths (above a given threshold) which satisfy the topological constraints associated with b-strand pairings. In the following sections, we describe the training and benchmarking of bbcontacts.
DatasetsTo compare our method with existing ones, two previously published test datasets were used. The BetaSheet916 dataset () has been routinely used as a benchmark dataset for bb contact prediction. It is also our main test dataset. It consists of 916 protein chains containing 31 638 b-residue contacts.recently proposed a complementary dataset, built from more recent structures. This new dataset, BetaSheet1452, consists of 1452 protein chains containing 56 552 b-residue contacts. The two test datasets are non-redundant at 20% sequence identity, both internally and with each other. Our training dataset was built from the CATH database of protein domains v3.5 (). The building process aimed to reduce as much as possible the redundancy between the training dataset and both test datasets at the fold (CATH Topology) level. We extracted all CATH domains that did not belong to any of the fold groups identified by CATH in the test datasets. We filtered the resulting dataset to reduce internal redundancy, using the HH-suite script pdbfilter.pl (). Finally, 943 domains containing b-contacts form our training dataset (Supplementary Dataset S1). Because not all chains from the test datasets were annotated in CATH v3.5, there might be some residual redundancy between the training dataset and the test datasets. We checked that this did not lead to overtraining of bbcontacts, by verifying that the results did not deteriorate when taking the subset of each test dataset that is strictly non-redundant with the training dataset at the fold level (see Supplementary Results and Supplementary).(d)(d) an antiparallel interaction involving a b-bulge and the associated pattern, displaying a shift in the main diagonal. The HMM states associated to the main diagonal are annotated in patterns (c and d) ('int' is short for internal and 'bi0', 'bi1' for bulge i 0 , bulge i 1 ; see also). In (c), the dotted lines delineate the three couplingsone main diagonal and two secondary diagonal couplingsentering into the emission probability calculation for cell (6,2). The arrow indicates the direction of Viterbi score calculation and decoding for antiparallel contactsFor the HMM detecting parallel (respectively, antiparallel) contacts, most transitions correspond to a diagonal (respectively, antidiagonal) displacement in the coupling matrix, except the transitions between bulge i states (transitions along the j axis with i remaining fixed, such as the one displayed in) and the transitions between bulge j states (transitions along the i axis with j remaining fixed). A b-bulge involves at least one (and at most two) inserted residue(s) on one of the two strands, thus state bulge i 0 can only be followed by bulge i 1 (same for bulge j 0 ! bulge j 1 )All b-contacts were assigned based on backbone contacts, following the DSSP definition (). For both training and testing, the DSSP assignment was reduced to three states (B and E were mapped to E; H, I and G were mapped to H; T, S and C were mapped to C). b-bulges were detected by PROMOTIF (Hutchinson and). We then filtered the detected b-bulges to retain only those inducing a shift of the main diagonal in the direct coupling pattern (see).
Data used for HMM trainingFor the training and test datasets, we built MSAs by running HHblits () against the uniprot20 database dated March 2013. Each MSA was filtered down to 90% sequence identity with HHfilter (). Supplementaryshows the distribution of the number of sequences in the resulting MSAs for each dataset. Secondary structure predictions were obtained with PSIPRED (), using the HH-suite script addss.pl for improved performance (). Direct coupling predictions were obtained with CCMpred (), a fast implementation of the state-of-the-art methods byand Ekeberg et al. (2013). We observed that the range of predicted couplings varied greatly depending on the number of sequences N in the MSA and the protein length L. We found that g  ffiffiffiffi ffi N p =L was a good descriptor for the range of couplings observed in a predicted matrix. For each domain in the training dataset, we filtered the initial MSA in order to build MSAs of reduced diversity, using the qsc parameter of HHfilter (). We derived 12 datasets for g  0:05; 0:1; 0:2; :::; 1:0; 1:2 (see Supplementary). We ran CCMpred on all diversity-filtered alignments and used the resulting coupling matrices to train the coupling-based part of the HMM emission probabilities.
Local background correction of the coupling matricesThe coupling matrices sometimes display darker regions that can lead to many false positive predictions (Supplementary). We therefore applied the following local background correction procedure to all coupling matrices in the training and test datasets: from each coupling, we subtracted the average coupling over an area of size (2S  1)  (2S  1), extending by S cells in each direction. For single domains with a good alignment coverage (including most domains in the training dataset), this procedure has almost no effect on the coupling values (Supplementary).
HMM parametersThe HMMs were trained using the labeled data contained in the training dataset. We trained two sets of HMM parameters separately for parallel and antiparallel b-strand pairings. We did not train bbcontacts for the detection of b-bridges, because we do not expect the residues involved in isolated b-bridges to be generally predicted as b-residues by PSIPRED, and because the coupling signals typically do not form patterns for such isolated b-contacts. The HMM transition probabilities were trained by counting how many times each transition was used in the training dataset. The HMM emission probabilities contain a product of two terms, one based on couplings and one based on secondary structure (from either PSIPRED predictions or DSSP assignments). Each term is expressed as the odds-ratio of the conditional distribution of the observed variables when in one of the HMM states, relative to the background distribution.
Coupling-based emissionsThe coupling-based part of the emission probability at position (i, j) was expressed as the product of three odds-ratios relative to the background: one for the central coupling at position (i, j) belonging to the main diagonal of the pattern and one for each of the two couplings at the positions adjacent to (i, j) belonging to the secondary diagonals of the pattern [Supplementary Equations (1). This is illustrated in: the dotted lines delineate the three couplings entering into the emission probability calculations for cell (i  6, j  2), at positions (i, j), (i  1, j  1) and (i  1, j  1). These adjacent cells are chosen rather than i; j62 and i62; j to avoid multiple counting. Because of data scarcity, we did not distinguish between different HMM states and bundled all b-contacts together for this stage of the training. For each decoding direction (parallel and antiparallel), we thus had to describe three coupling distributions: one for the background, one for the main diagonal of the patterns and one for the secondary diagonals of the patterns. After centering the coupling distributions at zero, we fitted their density using two transformed Gamma distributions, one for positive couplings and one for negative couplings. To describe the density fit for a given value of g, we used seven parameters: the shift needed to center the coupling distribution, the relative weight of the positive and negative sides, plus two transformed Gamma parameters for negative couplings and three for positive couplings. The shift was fitted as a quadratic function of g and all remaining parameters were expressed as linear functions of g. The optimization was performed by maximum likelihood estimation. The final number of parameters for the coupling-based emissions is 90. Details are given in the Supplementary Methods and the final fits are illustrated in Supplementary.
Secondary-structure-based emissionsThis part of the emission probabilities was trained separately for the PSIPRED predictions and the DSSP assignments. We used a discrete mapping of the secondary structure observations to three states (E, H and C). In the PSIPRED case, the most probable secondary structure state was used for each position. We denote by z an HMM state and by r i ; r j  the pair of secondary structure states at position (i, j). We tested two types of secondary-structure-based emissions. The 'non-conditional' emissions were defined as the set of probabilities pr i ; r j jz, as expected from the traditional definition of emission probabilities. However, this does not account for the important fact that by definition, a secondary structure element is a segment of residues immediately adjacent in sequence. Therefore, the 'conditional' emissions were defined as the set of probabilities pr i ; r j jr iprev ; r jprev ; z of observing a pair of secondary structure states r i ; r j  in state z, given that we additionally already observed secondary structure states r iprev ; r jprev  at the previous position i prev ; j prev . We also added pseudocounts derived from the non-conditional probability distribution to the conditional probabilities: when calculating the conditional probabilities, we added N 0 counts from the non-conditional frequencies to the observed conditional counts. This effectively interpolates between the conditional and non-conditional distributions: for states with few conditional counts relative to N 0 , the conditional probabilities with added pseudocounts will be very similar to the non-conditional probabilities. Different values of N 0 were tested (see Section 3.1). Because we found that the secondary structure states for the coupling matrix cells situated immediately before and immediately after a b-strand interaction contain information about the likelihood to start and end this interaction, the model also contains secondarystructure-based emission terms for the start and end states. The start term is always a non-conditional probability and can also be seen as a prior based on secondary structure. In total, there are 415 parameters for the DSSP secondary-structure based emissions and 415 parameters for the PSIPRED-based emissions [see Supplementary Methods and Supplementary Equations (5)(10)].
Prior probability distribution depending on sequence separationThe sequence separation between two interacting b-strands has a lower bound due to geometric considerations, especially for the parallel case. In addition, it is strongly biased in practice, especially for antiparallel b-strands, a majority of which are b-hairpins for which the two strands are separated by a short loop. Thus, we introduced a prior for starting a b-strand interaction depending on the sequence separation between the first pair of interacting residues. This prior is based on 34 fitted parameters for PSIPRED-based predictions and 34 fitted parameters for DSSPbased predictions [Supplementary Equation (11) and]. We also introduced constraints to prevent the detection of b-contacts for positions too close to the diagonal of the coupling matrix. More details are given in the Supplementary Methods.
HMM decodingFollowing the ideas introduced byfor local sequencesequence alignment and by Biegert and S ding (2008) for local HMMHMM alignment, we use a local version of the Viterbi algorithm for decoding a matrix of predicted couplings to detect patterns corresponding to b-strand interactions. We dispense with an explicit background state by using odds-ratio emission probabilities: each emission probability corresponding to an HMM state is always divided by a background probability. The HMM paths can start and end anywhere in the coupling matrix. We do not detect a single most likely path corresponding to the best Viterbi score, but instead all paths above a certain Viterbi score threshold. For each position (i, j) and each state z, the Viterbi variable V [i, j, z] is defined as the probability of ending a path at position (i, j) and in state z. The local Viterbi algorithm consists of four major steps: initialization, recursion, termination and back-tracing [see Supplementary Methods, including Supplementary Equations (12)(14)]. In the initialization step, the Viterbi variables Vi; j; start are initialized for all positions (i, j) in the coupling matrix and the priors described above are applied. In the recursion step, all Vi; j; z for z 2 j fstart; endg are calculated using the transition and emission probabilities. In the termination step, the Vi; j; end probabilities are calculated. During recursion and termination, pointers are used to keep track of the most likely paths. The initialization, recursion and termination steps of the Viterbi decoding are performed separately for the parallel and antiparallel directions, but all Vi; j; end scores are then merged and sorted in decreasing order for the final back-tracing step. The most likely path, corresponding to the highest V[i, j, end] probability, is retrieved by back-tracing through the saved pointers. Then, we cross out a region extending by 6 3 residues around this path in the Viterbi matrix corresponding to the path direction (parallel or antiparallel), i.e. we do not take into account any more probabilities for this region. This avoids retrieving many variants of a contact between the same b-strands. The next path that does not contain any crossed-out residue pairs is then saved and a region around this path is crossed-out. We proceed iteratively in this manner until we reach a given Viterbi score threshold.
Prediction-shortening modeFor PSIPRED-based results, in some cases, the Viterbi paths can be very long because of the spatial architecture of the protein (see Supplementaryfor an example). We designed a procedure, called 'PSM' (prediction-shortening mode), to ensure that the predicted parallel paths stay below 11 residue pairs in length and the predicted antiparallel paths below 15 residue pairs. When PSM is triggered, it shortens the predicted paths by iteratively decreasing the transition probabilities and rerunning the Viterbi algorithm until the predicted paths are below the length threshold. For DSSP-based results, such a procedure is unnecessary because the secondary-structure-based probabilities make it impossible to predict contacts between non-b-residues, so that the length of any path is limited by the length of the longest b-strands. More details about PSM are given in the Supplementary Methods.
Topology filteringWhen all most likely Viterbi paths have been retrieved, a final postprocessing step is applied to filter the incompatible paths given the topological constraints that apply to bb contacts. We go through the list of retrieved paths sorted by decreasing Viterbi score. Each path can be retained or excluded. A path is excluded if it contains a residue that already has two b-partners in previously retained paths or a residue pair that already belongs to a previous path. Using this residue-based filtering rather than a strand-based filtering means that bbcontacts can handle cases where a b-strand is in contact with more than two strands, as also pointed out for previous methods (). In addition, when the DSSP assignment is used, we can rely on the exact positions of b-strands, so we exclude any path containing a contact between two residues from the same b-strand or between a pair of b-strands that already belongs to a previous path.
EvaluationPerformance is measured in terms of precision and recall at the strand level and at the residue level, as was done for previous bb contact prediction methods. The F1-score (harmonic mean of precision and recall) is also used, as it provides a single value to measure the quality of the bb contact predictions. bbcontacts is compared with the best methods available so far: BetaPro (), MLN and MLN-2S (), CMM () and BCov (). Residue-level evaluation is straightforward in all cases. Strandlevel evaluation is only straightforward for DSSP-based results. For PSIPRED-based results, because the true b-strand positions are unknown, additional conventions need to be adopted for the strand-level evaluation (see Supplementary Methods). Because PSIPRED-based strand-level evaluation is based on these additional criteria, it is provided only in an indicative manner and the residuelevel evaluation forms the most solid basis for comparison between different versions of our method. bbcontacts is also compared with general contact predictors: CCMpred (), PhyCMAP () and PconsC2 (). Baselines for these methods are obtained by restricting predictions to DSSP-defined b-strand regions. To make the comparison fairer to these methods, we exclude all false positives with sequence separation smaller than 6 from their predictions. True positives are unchanged (bb contacts assigned by DSSP).
Results and discussionFor the sake of simplicity, all results are shown for the BetaSheet916 test dataset. However, the trends described also hold for the training dataset and the BetaSheet1452 test dataset (see Supplementary Results and Supplementary Figures S2125).
Contribution of the different terms in bbcontactsThis section illustrates how much the various steps composing the bbcontacts method contribute to its performance. Here, the secondary structure predicted by PSIPRED is used as an input. This section is focused on residue-level performance because this assessment is more stringent. We use a reference version of bbcontacts in which local background correction with S  10 is applied to the coupling matrices, the conditional secondary-structure-based emission probabilities with N 0  10 000 pseudocounts from the non-conditional distribution are used, the prior depending on sequence separation is used and PSM is turned off. We then modify one element of the model at a time and discuss the impact of each of the corresponding terms. First of all, when developing bbcontacts, we tested 'conditional' and 'non-conditional' secondary-structure-based emission probabilities (see 'Methods'). We also tried adding pseudocounts from the non-conditional probability distribution to the conditional probabilities. This was motivated by the observation that the conditional probabilities for some rarely observed states were derived from very low counts; in this case, adding counts from the non-conditional distribution (for which all states are well populated) should make the resulting probabilities more robust. However, we found an optimal number of pseudocounts N 0 of 10 000 on the training dataset (see Supplementary), much larger than we would expect if the pseudocounts were just used to avoid overtraining of the conditional probabilities derived from low counts. This large number of pseudocounts actually performs an interpolation between the conditional and non-conditional probability distributions. This can be understood by noting that the dependency between two consecutive states is already described to some extent by the HMM transitions for the HMM states, but not for the background. Consequently, the conditional probabilities are better suited to the background than to the HMM states. Using 10 000 pseudocounts, the secondary-structure-based probabilities are very close to the conditional ones for the background (which has several million counts in the training data), but intermediate between conditional and nonconditional for the HMM states (which have a few hundred to a few thousand counts).shows the prediction results using the different types of secondary-structure-based emissions: purely non-conditional, purely conditional or conditional with 10 000 pseudocounts taken from the non-conditional distribution. Adding pseudocounts from the nonconditional distribution to the conditional probabilities significantly improves the performance of bbcontacts. Another major contribution to the performance of bbcontacts is brought by correcting the local background of the coupling matrices in order to remove false positives, by avoiding the presence of dark regions concentrating strong couplings in the predicted coupling matrices (see '). The results inshow a notable performance improvement when using local background correction, for the three displayed values of S. We chose S  10 as the default parameter for bbcontacts, because it displays the best improvement in precision without loss in recall. The results for S  5 show a slightly higher precision for high-confidence predictions, but the final recall is also lower. Other terms in the bbcontacts model have a smaller influence on the final performance. The prior depending on sequence separation has a small, but consistently positive effect on the performance of bbcontacts (Supplementary). The influence of including signal from the secondary diagonals of the patterns as well as signal from the main diagonal is analyzed in Supplementary. Inclusion of secondary diagonal signal notably increases the final recall reached by bbcontacts. However, taking signal only from the main diagonal slightly increases the precision for high-scoring predictions. This effect is dampened when PSM is turned on. Finally, the red traces inshow that PSM slightly increases the precision for high-confidence residue-level predictions, because it removes false positives belonging to long paths with large Viterbi scores. The strand-level performance is almost unaffected by PSM (). Although all methodological choices for bbcontacts illustrated in this section relate to PSIPRED-based bb contact predictions, the performance of bbcontacts when using the DSSP assignments as an input is either improved or unchanged by these choices (see Supplementary Figures S9 and S10).
Comparison with previous methodsFigure 4 presents the precision-recall results on the BetaSheet916 dataset for the final version of bbcontacts compared with previous(b)bb contact prediction methods, at the strand level () and at the residue level (). Supplementary Tables S2 and S3 present a summary of this comparison. Supplementaryshows the strand-level results when testing for correct orientation of predicted b-strands as well as correct pairing.As a complementary view,and Supplementaryshow examples of contact maps predicted by bbcontacts using predicted secondary structure. These illustrate the capacity of bbcontacts to remove noise from CCMpred coupling matrices., b and Supplementaryclearly show that for DSSP-based predictions (blue traces, blue symbols), bbcontacts outperforms all previous methods, even though it was not specifically designed to perform well for DSSP-assigned secondary structure. This is particularly striking at the residue level. The effect is not as strong at the strand level because bbcontacts was not trained to detect isolated b-bridges, as we cannot expect secondary structure prediction methods to detect isolated b-residues. However, b-bridges are included in the performance assessment and the strand-level recall particularly suffers from this as b-bridges represent 17.6% of the b-strand pairs in the BetaSheet916 dataset. As expected, PSIPRED-based predictions (red traces inand Supplementary) are less confident than DSSP-based predictions, but they still exhibit remarkable precision and recall. In particular, residue-level PSIPRED-based predictions display better precision and recall than previous methods when they use the true secondary structure. The gap between DSSP-based and PSIPREDbased performances (i.e. between the blue and red lines in) is explained by errors in the PSIPRED predictions, but also by the major advantage of knowing the exact DSSP strands compared with strand predictions (however accurate), since using true secondary structure we can rule out entirely any bb contact occurring outside of the strand regions. The precision-recall curves show that bbcontacts not only has good overall performance, but also provides (through the Viterbi score associated with each path) a measure of the confidence we can place in each prediction. The results of bbcontacts are quite robust: the precision drops very slowly with recall, up to around 50% recall for DSSP-based and 40% recall for PSIPRED-based predictions. To investigate how much of the performance improvement obtained with bbcontacts is due to using better contact predictions as input, we introduced additional reference points BCov* and CMM*, corresponding to results obtained when couplings predicted with CCMpred are used as an input to the b-contact prediction algorithms from BCov and CMM. Better input couplings strongly improve bb contact predictions, but this does not explain the full extent of the bbcontacts DSSP-based performance (see Supplementary Results and Supplementary). In Supplementary Figures S14 and S15, we analyze the performance of bbcontacts for each of the 916 test cases depending on the alignment size N and on the CCMpred precision for L/5 predicted contacts (where L is the length of the protein). For each test case, the F1-score is calculated for all bb contact predictions above a Viterbi score threshold chosen to maximize the residue-level F1score on the training dataset (Supplementary). As expected, the trend for bbcontacts performance is to increase with N and with CCMpred precision. However, even for alignments containing a few hundred sequences, a number of cases display similar performance compared with cases with many homologs. Note that the precision and recall reported in this work are rather conservative estimates of how useful the predicted contacts might be for structural modelling. Indeed, in compliance with previously published approaches, the evaluation adopted in this paper relies on the DSSP definition of bb contacts, based on backbone hydrogen bonds. Because of this rigid definition, close side-chain contacts between pairs of residues which do not form backbone contacts (such as pairs of bulge residues or pairs of residues immediately adjacent to b-strands, but not assigned as b-residues by DSSP) canshows that if we exclude all residue pairs within 6 A  Cb distance from the false positives during evaluation, there is a large increase in bbcontacts precision for PSIPRED-based predictions, reaching $80% precision at 40% recall on the full BetaSheet916 dataset (Supplementary). Finally, bbcontacts was compared with general contact prediction methods: CCMpred (), PhyCMAP () and PconsC2 (). The results are shown in, using both the DSSP-based evaluation framework (solid lines) and the 6 A  distance tolerance (dashed lines). The latter is a middle ground for evaluation, since bbcontacts was trained to detect only bb contacts strictly assigned by DSSP (mostly distributed around 5 A  ), while the general contact predictors are designed to detect all contacts up to 8 A . Due to the computational cost of PconsC2, this evaluation is performed on a subset of BetaSheet916 containing 186 protein chains (Supplementary Dataset S2). However, the evaluation of bbcontacts, CCMpred and PhyCMAP on the full BetaSheet916 dataset reported in Supplementaryshows very similar trends. As expected, PhyCMAP, which does not use direct coupling analysis, displays low precision even at low recall. PconsC2 improves largely over PhyCMAP and CCMpred, but its precision drops much earlier with recall than the bbcontacts precision, even when relaxing the evaluation criteria to 6 A  tolerance. Supplementary Figures S17S19 show the results when using 8 A  tolerance in the evaluation: in this case, we also remove many false positives corresponding to predicted bb contacts with a shifted register. Even so, bbcontacts improves greatly over CCMpred and PhyCMAP, and the PconsC2 precision-recall curve drops earlier than the bbcontacts curve.
Conclusionbbcontacts is the first predictor of bb contacts that does not require known secondary structure from DSSP and that therefore can be used in practice. Having to use predicted instead of true secondary structure makes bb contact prediction a much more challenging problem. In particular, we can no longer rely on the knowledge of the exact b-strand positions. Analyzing the contributions of different terms in bbcontacts shows that the choices that have a strong impact on PSIPRED-based predictions do not affect DSSP-based results to the same extent (compare for instancewith Supplementary). This underlines the importance of specifically designing methods to deal with predicted secondary structure. bbcontacts also illustrates that HMMs are an attractive approach for statistical modelling of variable-length bb contacts based on the detection of specific patterns in the coupling matrices. The use of a local Viterbi algorithm enables the detection of local patterns. In addition, bbcontacts can pick up signal in a number of alignments with relatively few homologous sequences. Another interesting feature is that it provides a score for each predicted b-strand contact, which expresses the reliability of the prediction. Finally, bbcontacts is provided as free and open-source software with few dependencies. The runtimes on a single core of an Intel Xeon E52650 processor are typically under one minute for proteins up to 500 residues, and up to a few minutes when PSM gets triggered (Supplementary). This makes bbcontacts easily applicable to a variety of situations, including predictions for large proteins and large-scale b-contact prediction. Another possible application for bbcontacts would be the case of inter-chain b-sheets, provided enough homologs are available for both chains. bbcontacts could be further improved by including additional information in the HMM emissions, such as amino acid profiles and solvent accessibility predictions, or other input sources complementing CCMpred, for instance PSICOV (). Further planned work involves incorporating input from predictors such as CMAPpro () or PhyCMAP () which do not use direct coupling analysis and perform better than CCMpred or PconsC2 when few homologous sequences are available (). One advantage of our approach in this respect is that it can handle new sources of input in a probabilistic manner, through the addition of new terms in the emission probabilities. Also, one could improve the use of topological constraints by calculating posterior probabilities for all b-strand topologies that can be built from the list of best Viterbi paths. Finally, the approach developed in this study can be generalized to detect patterns of other interacting secondary structure elements such as helix-helix and helix-strand interactions and thus points to a promising avenue for future research.
J.Andreani and J.S ding at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
