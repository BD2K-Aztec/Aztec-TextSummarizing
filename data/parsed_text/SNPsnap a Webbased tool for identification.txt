An important computational step following genome-wide association studies (GWAS) is to assess whether disease or trait-associated single-nucleotide polymorphisms (SNPs) enrich for particular biological annotations. SNP-based enrichment analysis needs to account for biases such as co-localization of GWAS signals to gene-dense and high linkage disequilibrium (LD) regions, and correlations of gene size, location and function. The SNPsnap Web server enables SNP-based enrichment analysis by providing matched sets of SNPs that can be used to calibrate background expectations. Specifically, SNPsnap efficiently identifies sets of randomly drawn SNPs that are matched to a set of query SNPs based on allele frequency, number of SNPs in LD, distance to nearest gene and gene density. Availability and implementation: SNPsnap server is available at
MOTIVATIONGenetic loci identified by genome-wide association studies (GWAS) point to biology that help us to understand the etiology of complex traits and diseases (). A typical first step following GWAS is to assess whether associated loci as a group implicate biological pathways (), or whether associated single-nucleotide polymorphisms (SNPs) are enriched for annotations such as non-coding functional elements () or missense variants (). The simple approach, comparison of associated SNPs with random sets of SNPs, is susceptible to bias from nonrandom clustering of functionally related genes, and the greater likelihood of associated SNPs to be within (large) genes and regions of strong linkage disequilibrium (LD) and other potential confounders (). If not properly accounted for by appropriate matching of random sets of SNPs, these biases may lead to spurious enrichments; for instance, brain pathways (typically containing large genes that are more likely to harbor associated SNPs) will appear to be overrepresented in most sets of GWAS loci (). The SNPsnap Web server identifies randomly selected SNPs with similar genetic properties as a set of query (associated) SNPs. Random SNPs are matched based on minor allele frequency, number of SNPs in LD (LD buddies), distance to nearest gene and number of nearby genes (gene density). By using sets of random but matched SNPs, investigators can compute enrichment statistics on more appropriate negative controls to get an unbiased empirical estimate of the significance of enrichment results obtained with associated SNPs. We and others have previously used a similar approach (), however currently there is no software tool that formally implements this approach.
IMPLEMENTATIONWe used biallelic, uniquely mapped SNPs from the 1000 Genomes Project () genotype data and computed the following properties (see also Supplementary Material):(a) Minor allele frequency: we partitioned SNPs into minor allele frequency bins (using 12, 23,. .. , 4950% strata).(b) LD buddies: for each SNP, we counted the number of 'buddy' SNPs in LD at various thresholds (r 2 40.1, 0.2,. .. , 0.9) [using PLINK v.1.07 () to(c) Distance to nearest gene: we computed the distance to the nearest 5 0 start site using Ensembl gene coordinates (). If the SNP was within a gene, we used the distance to that gene's start site.(d) Gene density: we counted the number of genes in loci around the SNP, using LD (r 2 40.1, 0.2,. .. , 0.9) and physical distance (100, 200,. .. , 1000 kb) to define loci. Next, we developed an algorithm to sample the best matching SNPs given the genetic properties of the query SNPs (). Because sampling of a sufficient number of SNPs exactly matched to a given query SNP is infeasible, we allowed *To whom correspondence should be addressed.
yThe authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. deviations between the query and matched SNP for the properties used in matching. The SNPsnap algorithm identifies sets of matched SNPs for each query SNP as follows:(1) In five uniformly spaced increments, increase the allowable deviation for each of the properties, ending with the prespecified maximum allowable deviation. For each increment, identify matching SNPs, defined as SNPs with genetic properties within the allowable deviations.(2) If there are at least as many matching SNPs as requested, sample without replacement the requested number of SNPs from the matching SNPs and proceed to step 5.(3) If the number of matching SNPs is less than the number of requested SNPs, increment the allowable deviation and return to step 1; if the maximum allowable deviation has been reached, proceed to step 4.(4) Sample with replacement from the matched SNPs identified in step 1.(5) Proceed to the next query SNP.For the default parameters, SNPsnap provides two visual and two numeric scores that indicate how well the requested number of SNPs could be retrieved (see Supplementary Material).
WEB SERVERThe query set of SNPs should be independent and must be uploaded using rs-numbers or chromosomal coordinates. SNPsnap allows for test of input SNPs' independence. Besides the number of SNP to be sampled, the investigator must specify the maximum allowed deviation for each of the four properties. The investigator can choose whether matched SNPs may contain the query SNPs. The output consists of a matrix with query SNPs as rows and matched SNPs as columns. The investigator can optionally enable annotation of the SNPs to yield output files that include the genetic properties, nearest genes and genes in loci.
EXAMPLEWe used SNPsnap to illustrate how using properly matched SNPs can avoid spurious results. We first retained the top 500 independent SNPs from a simulated GWAS based on random phenotypes with no genetic basis, and retrieved a set of synapse genes (see Supplementary Material). Next, we conducted a Fisher's exact test, which indicated that the synapse genes were 2.4-fold enriched at the random GWAS loci (P = 0.005). We then used SNPsnap to retrieve 10 000 matched SNPs for each of the 500 simulated GWAS SNPs and computed the fold enrichment for each of the 10 000 SNP sets. From this we calculated an empirical P-value showing no enrichment of synapse genes (P = 0.16), as expected.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Funding: T.H.P. is supported by The Danish Council for Independent Research Medical Sciences (FSS) and The Alfred Benzon Foundation. P.T. is supported by The Novo Scholarship Programme. This work was supported by The National Institute of Diabetes and Digestive and Kidney Diseases [2R01DK075787 to J.N.H.]. Conflict of interest: none declared. REFERENCES Abecasis,G.R. et al. (2012) An integrated map of genetic variation from 1,092 human genomes. Nature, 491, 5665. Flicek,P. et al. (2014) Ensembl 2014. Nucleic Acids Res., 42, D749D755. Gamazon,E.R. et al. (2010) Chemotherapeutic drug susceptibility associated SNPs are enriched in expression quantitative trait loci. Proc. Natl Acad. Sci. USA, 107, 92879292. Gamazon,E.R. et al. (2013) Enrichment of cis-regulatory gene expression SNPs and methylation quantitative trait loci among bipolar disorder susceptibility variants. Mol Psychiatry., 18, 340346.
SNPsnap at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
T.H.Pers et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
