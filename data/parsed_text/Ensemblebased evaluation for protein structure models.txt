Motivation: Comparing protein tertiary structures is a fundamental procedure in structural biology and protein bioinformatics. Structure comparison is important particularly for evaluating computational protein structure models. Most of the model structure evaluation methods perform rigid body superimposition of a structure model to its crystal structure and measure the difference of the corresponding residue or atom positions between them. However, these methods neglect intrinsic flexibility of proteins by treating the native structure as a rigid molecule. Because different parts of proteins have different levels of flexibility, for example, exposed loop regions are usually more flexible than the core region of a protein structure, disagreement of a model to the native needs to be evaluated differently depending on the flexibility of residues in a protein. Results: We propose a score named FlexScore for comparing protein structures that consider flexibility of each residue in the native state of proteins. Flexibility information may be extracted from experiments such as NMR or molecular dynamics simulation. FlexScore considers an ensemble of conformations of a protein described as a multivariate Gaussian distribution of atomic displacements and compares a query computational model with the ensemble. We compare FlexScore with other commonly used structure similarity scores over various examples. FlexScore agrees with experts' intuitive assessment of computational models and provides information of practical usefulness of models. Availability and implementation: https://bitbucket.org/mjamroz/flexscore
IntroductionProteins are intrinsically flexible molecules. Flexibility is essential in understanding protein activity where conformational entropy has a major role, including protein-ligand (), proteinprotein interactions (), protein allostery (), and protein folding. Although it is conventional to consider a single structure for a protein particularly when the structure was solved by X-ray crystallography, a protein can change its conformation in different experimental conditions (). Furthermore, there is compelling evidence that indicates even X-ray diffraction data contains flexibility information and that diffraction data can be interpreted into different conformations (). Indeed, a group of structural biologists proposed to deposit an ensemble of structures even for X-ray crystallography to public databases so that data represent structural heterogeneity and dynamics more properly (). Thus, in principle it is more appropriate to represent a protein structure as an ensemble of alternative conformations (). In practice, flexibility information of a protein can be obtained either from experiments, such as NMR, or computational analysis including molecular dynamics (MD) simulations and normal mode analysis. By bringing flexibility into the picture of proteins, the protein sequence-tostructure-to-function paradigm () must be revised to sequence-to-structure-to-dynamics-to-function. Reflecting the current situation that a protein is usually represented with a single conformation, most of the commonly used protein structure model evaluation methods compare a model against a single structure of the protein ('the native structure'). For example,
i314This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com, i314i321 doi: 10.1093/bioinformatics/btw262 ISMB 2016 the most commonly used dissimilarity measure, the root mean square deviation (RMSD), quantifies difference of corresponding positions of two rigid structures after optimal superimposition ():where A and B are the Cartesian coordinates of atoms of two proteins, x A i is the coordinates of atom i in protein A and N is the number of atom pairs to be compared. In the protein structure prediction field, measures that are based on RMSD, such as GDT-TS (), TM-score (), are also used, which all compare two rigid structures. There are other methods that compare different representations of protein structures (), but they all belong to the rigid structure comparison realm and suffer from the same problem of neglecting protein flexibility. In evaluating a computational model, neglecting flexibility in the native structure results in overestimating displacement of residues in the model at flexible regions and underestimating displacement at rigid regions of the protein. For example, structure difference in a model at a flexible tail of the protein does not need to be penalized as long as the tail is modeled within the range of reasonable tail motion. On the other hand, a displacement of residues in a model at the core of a protein may be considered as a severe error of the model. Simply superimposing a rigid model to the single rigid conformation of the native structure cannot distinguish these two cases. Although considering the flexibility is still not common for evaluating protein structure prediction models, there have been several structure comparison methods that consider protein flexibility. In the simplest form, flexibility can be indirectly represented as weights assigned to each residue in a pair of protein structures to be compared, where weights are computed from the B-factors in crystallography () or theoretical estimates of fluctuation. Weights can be also computed from the distance of corresponding residues in the previous round of alignment in iterative computations of RMSD (). FlexE uses a residuelevel elastic network model and evaluates the difference of two structures in terms of energetic cost for deforming one structure into the other (). An alternative strategy is to consider ensembles of protein structures. Br schweiler proposed a fast computational method for averaging pairwise RMSD of two ensembles (). The Kullback-Leibler divergence was used to quantify the similarity of two structure ensembles (Lindorff). An algorithm was developed for specifically aligning structure ensembles in a MD trajectory, which minimizes the variance of structures as well as pairwise displacement of structures from adjacent time frames (). THESEUS () and bFit () use maximum likelihood to superimpose flexible protein structures where atom positions are assumed to have Gaussian distribution. An advantage of these two methods is that they are free of ad hoc parameters. Related works include structure alignment algorithms that explicitly consider local conformational change in structures caused by flexibility () and protein flexible functional site identification (). In this work, we propose a score for evaluating quality of protein structure models by taking flexibility of the native protein structure into account. The score named FlexScore (FS) quantifies how well each residue in the query model locates within the displacement range observed in structure ensemble. Among the existing methods mentioned above, only FlexE was designed for structure model evaluation. In contrast to FlexE, which needs parameter setting for an underlying elastic network model and outputs an energy value to a model that is not straightforward to interpret, our method does not need arbitrary parameters and provides an intuitive score that is easy to compare with conventional structure evaluation scores. Below we first introduce FS and clarify the characteristics of the score using illustrative models. Then we compare FS with RMSD, GDT-TS (), and TM-score () on several computational models. Lastly, FS was applied to evaluate computational models that were submitted to the Critical Assessment of Techniques for protein Structure Prediction (CASP;). It is shown that FS provides more reasonable and complete evaluation for structure models in comparison with other commonly used structure similarity scores.
MethodsWe begin with outlining the algorithm of the structure superimposition method that was used for computing FS and then explain the dataset of protein models we used.
Maximum likelihood superimposition of protein ensemblesFirst, an ensemble of alternative conformations of a reference structure (native structure), against which computational models will be compared, is obtained from MD simulation (details given in the next section) or an experimental method, e.g. NMR. Then, the ensemble of conformations is represented as a probabilistic model, where a probability density function describes each residue Ca atom displacements from the ensemble mean. A probabilistic model is defined using structure superimposition by maximum likelihood estimation on the multivariate Gaussian model (). We used the framework of THESEUS for this ensemble superimposition, as it properly considers variance and correlations of atoms in the structures in an explicit fashion. Below we briefly outline the algorithm. For more details refer to the original paper (). The coordinates of a structure X i in an ensemble can be represented asusing a mean structure M, a zero-mean Gaussian matrix displacement E i that follows a Gaussian distribution of N k,3 (0, R, I 3 ), where R is a k  k covariance matrix where k is the number of Ca atoms in the structure, a rotation matrix R i , a 3  1 translational vector t i , and a k  1 column vector of ones. T denotes transpose of a matrix. As commonly used in Bayesian analysis, eigenvalues of the covariance matrix are assumed to be distributed according to an inverse Gamma distribution, which is defined with a parameter a. According to this multivariate Gaussian error model of the native state ensemble, the parameters can be iteratively estimated by optimizing the following log-likelihood function:This is called a hierarchical model, which combines the loglikelihood that comes directly from Equation (2) (first term) and the log-likelihood of an inverse Gamma distribution, where k are FlexScore: protein structure model evaluation i315 eigenvalues of R. X is the ensemble that contains n structures. The parameters are estimated iteratively, given X and an initial value of estimated covariance, ^ P  I and a  0. First, t, M, and R are estimated iteratively. It is shown that the translation t can be estimated asHat (^) denotes an estimated value. The rotation matrix R is derived by single value decomposition (SVD) ofThe mean structure M is computed as the average of the translated/rotated ensemble structures coordinates. Then, the covariance matrix can be estimated as usual:Here X ^ s denotes the sample covariance matrix that is computed for the first term in the right hand side of Equation (3). Next, a of the inverse Gamma distribution and the eigenvalues k are estimated iteratively by solvingwhere ^ P h is the estimated covariance matrix of the hierarchical model, the left side of Equation (3), m is the number of missing eigenvalues, E k 1 sm ja; c; c   is the expected value of the inverse of the m smallest missing eigenvalues conditional on the smallest observed eigenvalue c, c is the shape parameter of the inverse Gamma distribution, which is set to 0.5. Once a and ^ P h are updated, t, M, and R are again updated and iterations continue until convergence.
FlexScoreGiven the estimated covariance matrix ^ P h and the ensemble mean b M, it is possible to superimpose a protein structure model to the ensemble, which was not primarily included in the original ensemble. Consider a computational protein structure model Y. Y contains the amino acid sequence identical to the reference protein structures, X. Using ^ P h and b M the translation vector and the rotation matrix for Y can be computed by applying Equation (4) for the translation vector and by SVD ofthe rotation matrix. After translation and rotation of Y, we define FlexScore, FS, aswhere k i is the eigenvalue of the covariance matrix ^ P h , thus variance of Ca atom i and Y sup i is the position of Ca atom i after superimposition. FS has a simple interpretation: how far, on average, residue positions of the computational model are to the native state ensemble in standard deviations units. The best score of 0 is obtained for a model if the model has the identical conformation as the mean. As a model deviates from the mean structure, the score will be larger.
Protein native-state ensemblesAn ensemble of native structures of a target protein was constructed by a MD simulation. A 10-ns-long MD simulation of the native state of a target protein was performed with bound ligands and ions with explicit water representation using a structure deposited in the Protein Data Bank (PDB). 1 MD run is sufficient because as shown in Supplementary, flexibilities observed in independent MD trajectories are usually consistent with each other. Selenium atoms in selenomethionine residues were replaced with Sulphur. NMR-solved protein structures were simulated using the first model in the PDB files. The force field used for simulations was AMBER99SB* with a NVT system. For details of the simulations, see a Supplementary Material in a paper by. From a simulation trajectory, we extracted structure at each 10 picoseconds to form an ensemble of structures.
Computational protein modelsWe chose 10 CASP 10 and 18 CASP11 targets as follows, which meet the following criteria for applying and evaluating FS: (i) monomers; (ii) no missing residues in the middle of chains in the PDB file; (iii) does not contain ligands for which force-field are not developed yet. For these targets, we analyzed server models with a complete chain. The number of models for each target ranged from 201 to 257 (average: 224.9). For the CASP11 targets, 10 'template-based modeling' and 8 'free-modeling' where chosen. The number of models for CASP11 targets ranged from 163 to 191 (average 175.5).
Conventional scoresFS was compared with RMSD () and two widely used model evaluation scores, GDT-TS () and TM-Score (). GDT-TS is the average of fraction of residues in a model that are predicted within 1, 2, 4, and 8 A  after superimposing the model to a reference structure of the protein. TM-Score is also a fraction of residues in a model that are closer than a heuristic cutoff value to corresponding residue positions after superimposing the model to a reference structure. Thus, both scores range from 0 to 1, with 1 as the best score.
Results
FS for two example structuresTo illustrate characteristics of FS, we made two structure models for the C-terminal domain (residue 529577) of human CSTF-64 protein (PDB ID: 2j8p). From the first structure model of this protein in its PDB file (this protein was solved by NMR), two models were built by manual modification, which have identical RMSD, GDTTS, and TM-Score values (1.47, 0.95, and 0.93, respectively) between each other. The first model (shown in green in) was modified at a helical region (residues 550554), while the second model (shown in blue) was modified at the C-terminal fragment (residue 573577). Referring to the structure ensemble of this protein (all NMR models in the PDB file) shown in gray in the figure, the second model (blue) would be better than the first one in green because the deviation of the blue model at the C-terminus is still in the range of observed structure variation. In contrast to the existing scores that give the same quality evaluation to the two models, FS gave clear distinction between these models: the first model had FS  1.96, and the second model had FS  1.42.shows the variance of the NMR ensemble, and the deviation of the two models from the mean structure, and FS computed at each residue. It is clear that the deviated helical region in the first model was appropriately i316 M.penalized with a large value, while the C-terminal region of the second model is not.
FS for structure modelsNext, we computed FS for structure models of the 28 CASP targets and compared the scores with RMSD, GDT-TS, and TM-Score.summarizes correlation of the FS and the other three scores. Overall, FS correlated well for most of the cases with GDT-TS, TM-Score, and RMSD. Because the smaller the better for FS, it has positive correlation with RMSD while negative with GDT-TS and TM-Score. However, there are exceptions, T0651, T780, T0808, T0814, and T0853, where FS has a strong correlation to RMSD while essentially no correlation with GDT-TS and TM-Score. In these cases, the quality of all the models is low as can be seen in the average score values in. Some models have long unphysical, totally stretched regions, which made their RMSD large. These bad regions of a model were severely penalized in RMSD and FS, which made their correlation high with each other but the correlation to GDT-TS and TM-Score low, because such regions were neglected by these two scores.shows that RMSD has the largest correlation among the three scores with FS. However, RMSD and FS have substantially lower correlation for T0655, T0675, T0716, T0769, and T0773 (). This is owing to the flexible nature of these target proteins, which was shown in. Compared with a rigid target structure T0714 shown infor which FS has a correlation coefficient of 0.98 with RMSD, these three targets have one or two flexible regions. Because RMSD optimizes non-weighted (homoscedastic) mean deviation in comparing a model and a reference structure, it results in overestimating error for such flexible proteins, which makes a lower correlation with FS. Note that as shown in Supplementary Table S1, overall correlation between GDT-TS and TM-Score is slightly higher than that of between FS and RMSD. Correlation between the scores for invididual targets are provided in Supplementary, where differences between FS and RMSD are observed in many targets. We have also examined score correlation separately for templatebased (TB) targets and free modeling (FM) targets (* in). Naturally, the quality of computational models are higher for TB targets (i.e. higher GDT-TS, TM-Score, and lower RMSD values) than FM targets, because the latter are more difficult to model. For the TB targets, FS showed high correlation to RMSD and had moderate correlation to GDT-TS and TM-Score (0.488 and 0.513,Structure superimposition of native-ensemble of the protein, 2j8p, determined by NMR (gray) and two models (blue and green). Both models have identical RMSD, GDT-TS and TM-Score (1.47, 0.95, and 0.93, respectively) but distinct FS (green model: 1.96, blue: 1.42). (B) Structural variance of the NMR ensemble, the distance of residues in the two models to the mean structure of the NMR ensemble, and the FS of each residue of the modelsFlexScore: protein structure model evaluation i317 respectively). For FM targets, the correlation to the GDT-TS and TM-Score dropped substantially to a low level (0.143 and 0.219) while the correlation to the RMSD became even higher for FM targets (0.93 and 0.99, respectively). We now discuss some examples of models that have inconsistent relative scores by FS with RMSD, GDT-TS or TM-Score. The first examples are models of T0716 (). For this target, FS has overall sufficient correlation to the other three scores (), 0.88 with RMSD, and 0.82 and 0.79 with GDT-TS and TM-Score. However, there are notable differences that deserve attention. There are models with similar FS between 2.5 and 4 but have diverse RMSD values that range between 4 and 8 A  (the right panel in).shows superimposition of two such models relative to the ensemble structures generated by MD. These two models in green and orange have largely different RMSDs of 3.93 A  and 5.40 A  while with similar FS s of 2.75 and 2.71, respectively. Asshows, the target protein is flexible in its N-and C-terminus. Considering the flexible regions of the protein, the quality of both models are essentially the same, because the core region of the two models is modeled correctly and the tail region is within the ensemble. The second pair of models () has a similar GDT-TS score of 0.52 (green) and 0.51 (orange) but has different FS of 7.4 and 24.1, respectively (the left panel,). As the figure shows, although the two models share common structures with the crystal structure at the middle part of the protein (the left side in the, the green model has a better agreement of the topology to the structure ensemble. The orange model has long-stretched helices in both), but distinguishable RMSD (3.93 A  and 5.40 A  , respectively). (C) Superimposition of another pair of models for T0716. They have similar GDT-TS (0.52 and 0.51 for green and orange) and TM-Score (0.48 and 0.49), but have substantially different FS of 7.4 and 24.1, respectively chain termini, which largely disagree with the reference structure ensemble. Reflecting these characteristics of the two models, FS for the green model is substantially better than the orange model (7.4 for the chain in green and 24.1 for the chain in orange). The next examples are for the target T0655 (). Looking at the score correlation in, there are a cluster of models that have a GDT-TS score around 0.5 or TM-Score of 0.6. FS, in contrast, distinguishes the quality of these models with a diverse range of score values.shows such examples. The two models incapture correct b-class fold in the middle of the protein. The green model has totally unstructured tails that are far off from the structure ensemble of its reference structure, which is reflected in a substantially worse FS of 23.05 than the orange one (9.2). This quality difference can be also detected by RMSD (25.93 A  and 7.28 A  , respectively, for the green and the orange model); however, the structure alignments computed for the green model by the FS and the RMSD computation are different (Supplementary). RMSD of the core region of the green model (residue 22142) by FS computation was 4.01 A  , while the RMSD superimposition gave 17. 22 A . Thus, considering the ensemble helped making better alignments in the FS case. The last example is from the target T0714 (). These two models have similar GDT-TS (0.84 and 0.83 for the green and the orange model, respectively), and similar TM-Score (0.83 and 0.86, respectively). We also computed GDT-HA score for these models, which was 0.64 and 0.61, respectively. In contrast, FS indicates that the orange model, which has a score of 2.69 has a better quality than the green one, which has a score of 4.42. This is a reasonable evaluation considering the larger number of incorrect regions in the green model that are off from the ensemble structures (indicated with blue circles in the figure).
FS using NMR ensembleIn, we compared FS computed using a MD-generated ensemble and an NMR-derived ensemble. The two scores are consistent, particularly for models with higher accuracy (FS < 10), with an overall correlation coefficient of 0.994.
Ranking prediction groups in CASP modelsIn the last section, we examine how performance of prediction methods are ranked among peers with FS. For this experiment, we used the 10 CASP10 targets selected in Section 2.4. There were 68 groups who submitted server models to at least one of these 10 targets in CASP10, who were subject to the analysis. In CASP, a group can submit up to five models for a target, but here only the first models (TS1 model) were evaluated. Ranking of the groups with FS was compared with those by three other scores, GDT-TS, TMScore, and RMSD.(B) Superimposition of two models (green and orange) for T0655 onto MDderived structural ensemble (thin lines). Both models have a similar GDT-TS score (0.50 and 0.54), and TM-Score (0.61 and 0.66), but they have different FS (23.05 and 9.2, respectively). Superimposition of two models of T0714 on to MD-derived structure ensemble (thin lines). The model in green and orange have similar GDT-TS of 0.84 and 0.83, and TM-Score of 0.83 and 0.86, respectively. FS of the two models are 4.42 and 2.69, for the green and the orange models, respectively. Comparison of FS using a MD-generated ensemble and an NMRderived ensemble for a protein solved by NMR (T0176). Scores of 235 models were plotted
FlexScore: protein structure model evaluation i319For this comparison, we devised another score named FS-GDT based on FS, which follows the concept of GDT-TS. Similar to the GDT-TS that counts the fraction of Ca positions that fall within 1, 2, 4 and 8 A  to the corresponding positions in the reference structure after superimposition, FS-GDT computes the average fraction of residues (Ca positions) that have FS within 1, 2, 4, and 8. Ranking of the groups was determined by the accumulated Z-score in the same way as performed for the official CASP rankings: (i) For a target, Z-scores from a raw score were computed for all TS1 models. (ii) Then, bad models with a Z-score of 2.0 or lower were removed as outliers. (iii) Z-scores were recalculated without the outliers; (iv) and finally, each group accumulates the Z-score from the previous step from each target.shows the group ranking results up to the top 10 groups. Because the purpose of ranking groups is not to decide who did well and who did not but to examine similarity of ranking by different scores, the group identities are denoted with alphabets. Overall the group ranking by FS and FS-GDT correlated well with GDT-TS, TM-Score, and RMSD. In, Group A was consistently ranked the top by all the scores and every pair of scores shares at least four groups among the top 5 ranked groups by the scores. The Spearman's correlation coefficients between rankings by FS and FS-GDT against the other three existing scores are all high, all over 0.9 except for the FS-GDT and RMSD pair (0.806) (). Correlation between FS and FS-GDT with the other scores is also high when the sum of the Z-scores used to rank the groups were compared (). Thus, while FS provides alternative evaluation to structure models by reasonably considering protein flexibility (Section 3.1 and 3.2), evaluation is close and consistent with the other existing scores when it comes to ranking of groups. Equivalent data to Tables 2 and 3 for the CASP11 targets are provided in Supplementary Material (Supplementary Tables S3 and S4), which consistently show strong correlation between group rankings by different scores.
DiscussionWe proposed a new score named FS and its variant, FS-GDT, which evaluates the quality of computational protein structure models by considering flexibility of protein chains. FS effectively distinguishes deviations of a model from a reference structure at intrinsically flexible and rigid regions, and assigns more permissive scores to the former than the latter. This is reasonable from the biophysics perspective of protein structures. The flexibility of a protein was measured from a MD simulation of 10 ns because it was long enough to observe large flexibility in protein terminal regions and to highlight incorrect regions of structure models that are beyond the range of chain flexibility. For a CASP11 model, T0733, we extended the MD run to 100 ns, but FS did not show meaningful change (Supplementary Table S2 and). The framework provided here is valid in principle with any data of protein flexibility, and FS would provide reasonable evaluation to these models under the provided flexibility information. We point out that MD simulations are easier to perform than it used to be, for example by using web-based MD tools (). Previously, we developed a method named FlexPred, which predicts absolute values of residue fluctuation from a tertiary structure (i.e. a PDB file) of a target protein (), which can be also used to obtain flexibility. At this juncture, it would be of interest to discuss difference of using MD simulations and using B-factors as the source of fluctuation. As mentioned in Introduction, the work by Wu & Wu introduced a B-factor weighted RMSD (2010). First of all, the level of fluctuation considered are different between them. B-factors indicate discrepancy of a solved structure to the X-ray diffraction pattern of the protein. Thus, although the B-factors were shown to have correlation to residue flexibility observed in computational simulation (), it is flexibility in the crystal condition of proteins. It was shown that B-factors are appropriate measure of fluctuations for stable parts of proteins, but significantly underestimate motion in flexible regions (). In contrast, MD used in FS is aimed at considering flexibility of proteins in solution, which is a more natural environment for proteins. From a technical stand point, to use B-factors for flexibility value, a weight parameter needs to be arbitrarily selected because B-factors do not provide absolute values of flexibility (). Also in FS, flexibility is used more explicitly in the structure superimposition step than the B-factor weighted RMSD. The results in the prediction group ranking shows that FS is in reasonable agreement with the other existing scores. In recent rounds of the CASP experiments, computational models are evaluated with a combination of several scoring terms that examine different structural aspects of models (). Combined with other scores, FS will be able to provide a new viewpoint to the protein structure evaluation. The technique
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.Jamroz et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.Jamroz et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from of considering ensemble structures will be also useful for various other related problems including multiple protein structure alignment, flexible proteinprotein or proteinligand docking, flexible structure fitting to electron microscopy density maps.
