Motivation: Contamination of a cancer tissue by the surrounding benign (non-cancerous) tissue is a concern for molecular cancer diag-nostics. This is because an observed molecular signature will be distorted by the surrounding benign tissue, possibly leading to an incorrect diagnosis. One example is molecular identification of the primary tumor site of metastases because biopsies of metastases typically contain a significant amount of benign tissue. Results: A model of tissue contamination is presented. This contamination model works independently of the training of a molecular pre-dictor, and it can be combined with any predictor model. The usability of the model is illustrated on primary tumor site identification of liver biopsies, specifically, on a human dataset consisting of microRNA expression measurements of primary tumor samples, benign liver samples and liver metastases. For a predictor trained on primary tumor and benign liver samples, the contamination model decreased the test error on biopsies from liver metastases from 77 to 45%. A further reduction to 34% was obtained by including biopsies in the training data.
INTRODUCTIONSeveral studies have considered molecular predictors for primary tumor site identification (see). All these studies report misclassification percentages of $10% in predicting the primary tumor site from primary tumor samples, which is consistent with our findings (see Section 3). However, the performance of molecular predictors on metastatic samples is less clear. Most studies assess the performance of their predictor using a combination of primary tumor and metastatic samples, with an unbalanced metastatic sample set. Metastases are often more difficult to classify by conventional diagnostics, compared with primary tumors. Yet, samples of metastatic cancers are generally underrepresented in the validation. To correctly validate the performance of a predictor, the validation samples must be representative of the samples that the predictor is intended to be used on. For the majority of patients with metastatic cancer, identification of the primary tumor site relies on small formalin-fixed paraffinembedded (FFPE) needle biopsies (core biopsies) from metastatic lesions. Hence, we argue that a molecular predictor designed to assist in the diagnostic work-up of patients with metastatic cancer must be compatible with, and validated on, FFPE core biopsies from metastatic lesions. To develop such a predictor for primary tumor site identification of metastases, it would seem preferable to train it exclusively on core biopsies constituting metastatic tissue. However, it may be difficult to obtain a sufficient amount of metastatic biopsies of known primary tumor origin. Furthermore, a larger technical variation because of the smaller amount of processed material and the varying tumor content make it difficult to rely on core biopsies only. Therefore, previous studies, as well as ours, have relied on primary tumor samples as a predominant part of the training set. These considerations lead to the central problem that we address in this article: when core biopsy samples are scarce or completely absent, how can we best adapt primary tumor samples to build a molecular predictor able to identify the primary tumor site of metastatic tumor samples? Such an adaptation is generally referred to as a domain adaptation. The problem being that the distribution of the cases to be predicted (the target domain) differs from the distribution of the cases used for training (the source domain) (see e.g.). To overcome this problem, we explicitly model how the target domain is related to the source domain, and use this model to train a predictor. A central difference between the source and target domains in our setting is caused by the fact that a core biopsy is often contaminated by tissue surrounding the tumor cells, that is, benign tissue from the biopsy site unrelated to the tumor (see). Another difference can arise if the molecular signature of the metastatic tumor deviates from the signature of the primary tumor; see, e.g.orfor a discussion of the biology of metastases. Recent findings bysuggest that tissue contamination may result in a decline of performance for molecular predictors. The results presented in the present article *To whom correspondence should be addressed. yThe authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. demonstrate that tissue contamination hampers primary tumor site identification of non-microdissected metastatic liver core biopsies. We developed our contamination model to correct this. However, our suggested methodology is not specific to primary tumor site identification, the biomarkers usedin our case microRNA (miRNA) expressionor the technological platform. It is a general computational model, which is broadly applicable whenever sample contamination constitutes a problem. We found that a non-adapted primary tumor site predictor, trained solely on miRNA expression measurements from primary tumors and benign liver samples, misclassified 60% of the liver core biopsies in our sample set. Notably, the performance of the predictor was even worse for the subset of liver core biopsies constituting metastases. By applying our contamination model and suggested domain adaptation procedure, this performance was improved. For a predictor based on 50 miRNAs, the contamination model decreased the misclassification percentage for metastatic liver core biopsies from 77 to 45%. A further improvement was obtained by combining the contamination model with a few biological metastatic liver core biopsies. This combined approach reduced the misclassification percentage for metastatic liver core biopsies down to 34%.
METHODS
Domain adaptationTo present our contamination model in an appropriate context, we briefly review the domain adaptation terminology. The goal is to predict samples drawn from a distribution T called the target distribution or target domain. However, none or only a small number of samples drawn from T are available for training. The philosophy of domain adaptation is to use a related distribution S, called the source distribution or source domain, to construct a target domain predictor. Typically, either the source distribution or a predictor trained on samples from the source distribution are adapted to the target domain, perhaps, using (the few) available target samples. In our setting, the source distribution is the distribution of molecular signatures for primary tumor and benign liver samples (resections). The target distribution is the distribution of molecular signatures from liver core biopsies. The relation between the source distribution and the target distribution is made explicit in Section 2.2 below. We suggest to apply the following general domain adaptation strategy to our problem.(1) Specify a domain adaptation model, that is, specify a map F : F source ! F target where F source and F target denote the sets of relevant source and target distributions, respectively.(2) With ^ S the empirical distribution of source samples, use the plug-in estimate F ^ S as an estimate of the target distribution.(3) Generate an approximate target distribution T sim by simulation of artificial target samples based on F ^ S.(4) Use T sim for training of a predictor.The domain adaptation model F provides a special kind of relation between source and target; for any given source, S, there is only one related target, the model target FS. In practice, the model F will contain unknown components that have to be specified or estimated from data as well. The following sections describe how the steps of the general procedure above are carried out in the context of tissue contamination. Supplementaryshows a flow chart of the entire implementation.
Contamination modelsA simple model of the molecular signature from a liver-contaminated core biopsy is  primary tumor signature  1    normal liver signature where 2 0, 1 is the relative amount of tumor content. This is a plausible model on the molecular level, but the contamination is not necessarily additive on the measured scale. Therefore, we need to transform the measurements using a suitable scale function f : R p ! R p , which is a function fx 1 ,. .. , x p   gx 1 ,. .. , gx p  for a continuous strictly monotone function g : R ! R. Letting X, Y 2 R p  f1,. .. , Kg denote a pair of random variables, with X representing the molecular signature and Y the site label, the distribution of X, Y is the source distribution. With Z 2 R p a random variable representing the molecular signature of the contaminating tissue, let Uy  def f f 1 X  1  f 1 Z   jY  y for f a scale function and 2 0, 1 another random variable representing the relative amount of tumor content. The variables X, Z and are assumed conditionally independent, given Y, as illustrated in. With Y T the marginal distribution of class labels in the target distribution, the distribution of UY T , Y T  constitutes our model target. The model is specified by choosing a scale function and conditional distributions of Z and given Y. We will consider domain adaptation models for two particular scale functions. The linear scale function is given by simply taking f to be the identity, thus assuming that the contamination is additive on the measured scale. The data used in this article consist of miRNA (a small noncoding RNA molecule) expression measurements, obtained by quantitative polymerase chain reaction (qPCR); see, e.g.,orfor an introduction to qPCR. For qPCR, a logarithmic scale function that models the relation between the actual miRNA concentration and the measured quantity is appropriate. The log scale function is given by g  def R log for 40 proportional to the molecular count and R40 a constant. The log scale function can be derived based on theoretical considerations for qPCR reactions. The constant e
Simulation of artificial core biopsiesThe approximate target distribution T sim is generated as a weighted empirical distribution of a total of M simulated samples. First, the class labels y 1 ,. .. , y M are sampled or chosen. Based on the source dataset (primary tumors, normal and cirrhotic liver), we sample x 1 ,. .. , x M independently, given y 1 ,. .. , y M , such that x i jy i is sampled from the conditional empirical distribution of the source data given y i. That is, x i is drawn with replacement from the source data with class label y i. In addition, we draw M samples with replacement z 1 ,. .. , z M , from the contamination data and M samples 1 ,. .. , M independently given y 1 ,. .. , y M such that i jy i has the desired distribution. For a given scale function f, we computeand the empirical distribution of the samples u 1 , y 1 ,. .. , u M , y M  with weights ! 1 ,. .. , ! M form the approximate target distribution T sim. The weights can be chosen to achieve a desired distribution of class labels in T sim , for example, to match the distribution of class labels for the primary tumor dataset. The simulation assumes the conditional independence structure illustrated in. If the less restrictive conditional independence structure illustrated inis assumed, we need to adjust the simulation to draw z i conditionally on y i , but this requires knowledge of a class-dependent contamination distribution. Note that the biological liver core biopsies do not need to completely fulfill the assumptions on which the simulations are based. For our purpose, the usefulness of the contamination model and the resulting artificial target data is judged by its ability to improve the performance of the predictor.
Class predictionFor class prediction, we use multinomial logistic regression, which is the multiclass extension of logistic regression. The predictor is trained using a group-lasso penalized likelihood approach as described in detail in. We briefly review the multinomial group-lasso regression method. Consider a prediction problem with K classes, N samples and p features. Assume, given a dataset x 1 , y 1 ,. .. , x N , y N  where, for all i  1,. .. , N, x i 2 R p is the observed feature vector, and y i 2 f1,. .. , Kg is the categorical class label. With h : f1,. .. , Kg  R K ! R defined asthe (symmetric) multinomial model is given byHere, the parameters are organized as the K-dimensional vector 0 of intercept parameters and the K  p matrixwith j 2 R K the parameters associated with the jth feature. The grouplasso maximum likelihood estimator of  0 ,  is the minimizer of the group-lasso penalized negative log-likelihood,Where ! 1 ,. .. , ! N are sample weights. Here, k  k 2 is the 2norm on R K. The penalization results in feature selection, meaning that for some features the corresponding parameter vector is estimated to be 0. The regularization parameter 40 is a tuning parameter, and the larger the , the fewer features are selected. For comparison, we also apply the procedure used in Ferracin et al.(2011) for class prediction. They used analysis of variance (ANOVA) for selection of miRNAs, and then prediction analysis of microarrays (PAM) for the actual prediction; seefor the details.
Biological samplesA total of 240 samples were included in the study. These samples consist of 128 resected primary tumors of different origin (representing seven primary tumor classes), 60 liver core biopsies from metastatic or primary liver tumors of known origin (representing the same predefined seven primary tumor classes), 37 liver resections and 15 liver core biopsies from normal and cirrhotic liver (see). The five classes breast, colorectal, gastric/cardia, pancreatic and squamous cell cancers are referred to as the nonliver-related cancers, and the corresponding 53 liver core biopsies are referred to as the metastatic liver core biopsies.Fig. 2. The random variables , X, Y and Z represent the tumor proportion, the molecular signature, the site label and the molecular signature of the contaminating tissue, respectively. A minimal assumption (a) of our domain adaptation model is that X, Z and are conditionally independent, given Y. The actual assumption made (b) is that Z is marginally independent of the other variables, and that X and are conditionally independent, given Y was defined as tumor and stromal cells. All samples were from independent patients; thus, no patient overlap between primary tumor samples and liver core biopsy samples was accepted. All samples were reviewed by an independent pathologist to confirm the reference diagnosis and to estimate the proportion of tumor (see). Based on these tumor percentage estimates, the core biopsy samples were divided into two groups representing high (450%) and low (550%) tumor content. For each sample, the expression levels of 377 miRNAs were measured using quantitative real-time PCR (TaqMan low-density array cards, human MicroRNA array A, Applied Biosystems) according to the manufacturer's instructions. Before a predictor was trained, the artificial core biopsy data were simulated and data were preprocessed. Simulation and preprocessing were executed in the following order.(1) Controls and miRNAs not expressed in the primary tumor samples were removed.(2) Linear and log scale artificial core biopsies were simulated (see Section 2.3).(3) All samples, such as primary tumor samples, core biopsy samples and the artificial core biopsy samples, were normalized and then standardized as described below.The data were first normalized by centering and scaling the individual samples to mean 0 and variance 1. The purpose of normalization is to remove technical (non-biological) variation. It was demonstrated inthat for qPCR, mean centering outperforms alternative normalization strategies. Supplementaryshows the effect of the normalization on the sample distribution. To ensure that differences in scale do not influence the variable selection, data were standardized by centering and scaling the expression measurements of each miRNA across the samples. The centers and scales were estimated using the primary tumor samples and applied for standardization of the primary tumor samples as well as the core biopsy and artificial core biopsy samples. That is, the standardized sample ~ x 2 R p of a sample x 2 R p is given bywhere ^ i and ^ i denote the empirical mean and standard deviation, respectively, for the ith miRNA in the primary tumor dataset. Note that the order in which normalization and standardization are applied matters.
RESULTSIn this section, we present results obtained by testing the suggested domain adaptation method on the miRNA expression dataset described in Section 2.5. The domain adaptation method was used with a linear and a log scale contamination model, as described in Section 2.2. Predictors were constructed using multinomial group lasso, outlined in Section 2.4, and by using the ANOVA  PAM method fromResults obtained with and without using the domain adaptation method were compared. To assess the generalization ability of the predictor method, a multinomial group-lasso predictor was trained and crossvalidated solely on the 165 resections. This predictor achieved an overall 10-fold cross-validation error of 11% on the resected primary tumors, normal liver and cirrhotic liver samples. However, on liver core biopsiesour target domainthis predictor had an overall test error of $60%. Note that results are reported in terms of misclassification percentages of the predictors, which we also refer to as the errors of the predictors. The errors are either estimated on test data by cross-validation or by subsampling as described in detail in the following sections. Furthermore, all errors reported henceforthexcept Section 3.5originate from validation on our target domain, i.e., samples from one of the following categories: liver core biopsies of metastatic tumors, liver core biopsies of primary liver cancers and core biopsies of normal and cirrhotic liver.
Predictors based on primary tumor samplesThe results presented in this section were obtained using primary tumor and benign liver resections for training, i.e. no core biopsy samples were used for training. Errors were estimated solely on liver core biopsy samples. We compared multinomial group-lasso predictors obtained by training on one of the following three datasets:(a) Primary tumor and benign liver samples.(b) Artificial core biopsies obtained using the linear scale contamination model.(c) Artificial core biopsies obtained using the log scale contamination model.For the simulation of artificial core biopsies, as described in Section 2.3, we used the 20 normal liver resections as contamination data. The distribution of was taken as a beta distribution with shape parameters (2, 2) for the seven cancer classes, and degenerate at one for the two benign liver classes. That is, for the benign liver classes, no contamination was added. The two artificial core biopsy datasets were generated using either the linear or the log scale contamination model described in Section 2.2. The simulation was carried out with 750 samples from each class, and the weights were chosen aswhere, N prim, yi is the number of primary samples of class y i. For the two benign liver classes, the simulation amounts to sampling with replacement from their empirical distribution. In practice, the simulation step for these two classes was therefore skipped, and the 37 benign liver resections were just included, all with weight 1.shows the test error plotted against the number of miRNAs included in the predictor. A larger number of miRNAs correspond to a lower value of the tuning parameter in (1). The predictors trained directly on the primary tumor, normal liver and cirrhotic liver samples performed poorly when applied to theliver core biopsy samples. The best predictors achieved an overall error of $60%.further shows that the error was even larger on the metastatic liver core biopsies. From, we see that the overall error dropped to $50% for the predictors trained on the artificial core biopsies using the linear scale contamination model. Using the log scale contamination model, the overall error could be further reduced to $35%.shows that the overall improvements embraced notable differences between the sample subgroups. In particular, the log scale contamination model performed best on core biopsies with low tumor content, whereas it did not improve the error rate as much for the high tumor content samples. In contrast, the linear scale contamination model resulted in marginally better predictors for the high tumor content samples.
Comparison of distributionsThe main purpose of introducing the contamination model was to improve the performance of the predictor. In addition, we validated the model itself by comparing the distributions of the simulated artificial core biopsies, the biological core biopsies and the primary tumor resections. Because the contamination model does not alter the normal and cirrhotic liver signature, these classes were kept out of the comparison. Hence, we compared the distribution of the seven cancer classes.shows a bivariate projection of the distributions. It shows that the distribution of the primary tumor samples clearly differed from the distribution of the biological core biopsies. Theshows that the distribution of the artificial core biopsies matched the distribution of the biological core biopsies better. The figure was constructed as follows: for each of the nine classes, we computed the class mean of the primary tumor samples and projected the samples onto the two first principal components of these nine class means.
Predictor based on metastatic tumor samplesFor comparison, we trained a predictor solely on the 75 available liver core biopsies. The leave-one-out cross-validation error was $55% for the best predictor, using $100 miRNAs. It is likely that the error could be further reduced if additional core biopsies were available for training.The error is shown as a function of miRNAs included in the predictor. The predictors were trained using primary tumor samples or artificial core biopsy samples derived from primary tumor samples using either the log or the linear scale contamination model
Predictors based on primary and metastatic tumor samplesTo further improve the predictors, we investigated the effect of training on either primary tumor samples or artificial core biopsies in combination with available biological core biopsies. Thus, for training we included n  1, 2, 3 or four core biopsies from each of the nonliver-related classes. To assess the performance of this procedure, we used the following subsampling scheme repeated 100 times.(1) Randomly split the core biopsy samples into a training and a test dataset, such that each contains approximately half of the samples per class.(2) Randomly sample n core biopsies from the training dataset for each of the five nonliver-related classes.(3) Train the predictor on the combined training dataset (artificial core biopsies or resections  biological core biopsies selected for training).(4) Estimate the error using the core biopsy test data.shows that the combination of primary tumors and core biopsies resulted in predictors with a smallest achievable error $40% for the metastatic liver core biopsies. Combining the artificial core biopsies with the biological core biopsies, this error was reduced to just above 30% using the log or the linear scale contamination model.shows that the 50 miRNA predictor based on the artificial core biopsies and four biological core biopsies per class and using the log scale, achieved an error of 34%.further shows that the optimal predictors were achieved with 4060 miRNAs using the log scale and 6080 miRNAs using the linear scale. For the log scale contamination model, a minor improvement on low tumor content samples was seen when including biological core biopsies. However, a considerable improvement was seen for high tumor content samples. In contrast, for the linear scale contamination model, a considerable improvement was seen for low, as well as high tumor content samples, when biological core biopsies were included.
Comparing predictorsWe compared multinomial group-lasso predictors with predictors obtained using the ANOVA  PAM method applied in. For comparison, the test errors on the 53 metastatic liver core biopsies were used, and predictors using 50 or 100 miRNAs were considered.shows the results. We trained ANOVAPAM predictors on our 165 resections of primary tumors, normal and cirrhotic liver. The predictor worked as expected on the primary tumor samples with crossvalidation errors on the nonliver-related classes being 23% (50 miRNA predictor) and 16% (100 miRNA predictor). However, as seen inthe corresponding errors were 81 and 77% when the predictor was applied to metastatic liver core biopsies. Large errors were seen for all of the predictors trained solely on primary tumor, normal and cirrhotic liver samples, as shown in. These errors decreased, if we either included core biopsies in the training, or if we trained on the artificial samples from our log scale contamination model, instead of the primary
DISCUSSIONContamination of samples can affect the performance of molecular predictors. This has been reported in other studies (e.g.). In the present article, we have seen that normal liver contamination hampers primary tumor site identification of liver biopsies. This was seen regardless, whether multinomial group lasso or ANOVA  PAM was used. Several molecular predictors for identification of the primary tumor site have been published, which include Ferracin et al.In the present article, we show, how an ANOVA  PAM predictor exclusively trained on primary tumor, normal and cirrhotic liver samples, results in a misclassification percentage of 77% when validated on the 53 metastatic liver core biopsies. Hence, the ANOVA  PAM predictor is, like the multinomial group-lasso predictor, not able to generalize well from the primary tumor samples to non-microdissected metastatic liver core biopsies with a heterogenous tumor content distribution. We did not find that any of the previous studies systematically addressed the problem of identifying primary tumor site of non-microdissected core biopsies. Addressing this problem, we found that novel methodology was needed to explicitly incorporate tissue contamination. We have developed a computational approach that deals with tissue contamination from surrounding tissue, and we have shown that the method improves the performance of the molecular predictor. Notably, training of such predictors does not require metastatic samples from the specific biopsy site, e.g. liver. Comparable improvements could be obtained by including liver core biopsies in the training data for each of the nonliver-related classes. Moreover, including liver core biopsies in combination with the contamination model was shown to reduce the error even further. With a sufficiently large number of metastatic liver core biopsies, the improvement because of the contamination model is likely to be small. However, an advantage of the contamination model is that it reduces the number of metastatic samples from the specific biopsy site needed for training. Combining the contamination model with 20 core biopsies, the misclassification percentage of the non-microdissected metastatic liver core biopsies was reduced to 34%. Although we only considered liver core biopsies in the present article, it is natural to assume that our contamination model will work for other biopsy sites as well. With a limited number of benign tissue resections, representing the biopsy site of interest, our contamination model could easily be used to develop a predictor adapted to core biopsies of other metastatic sites. In addition, even though we only address tissue contamination, our contamination model has the potential to be used to model background contamination in other types of samples.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
R  1 is the amplification efficiency, and we use a standard value of 0.8 throughout the article. Fig. 1. Micrograph of a liver core biopsy with cancer. Cancer as well as normal (benign) tissue can clearly be seen
M.Vincent et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Improving molecular identification of the primary tumor site of metastases at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
