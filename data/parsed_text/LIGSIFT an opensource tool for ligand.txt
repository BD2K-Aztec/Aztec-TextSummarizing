Motivation: Shape-based alignment of small molecules is a widely used approach in computer-aided drug discovery. Most shape-based ligand structure alignment applications, both commercial and freely available ones, use the Tanimoto coefficient or similar functions for evaluating molecular similarity. Major drawbacks of using such functions are the size dependence of the score and the fact that the statistical significance of the molecular match using such metrics is not reported. Results: We describe a new open-source ligand structure alignment and virtual screening (VS) algorithm, LIGSIFT, that uses Gaussian molecular shape overlay for fast small molecule alignment and a size-independent scoring function for efficient VS based on the statistical significance of the score. LIGSIFT was tested against the compounds for 40 protein targets available in the Directory of Useful Decoys and the performance was evaluated using the area under the ROC curve (AUC), the Enrichment Factor (EF) and Hit Rate (HR). LIGSIFT-based VS shows an average AUC of 0.79, average EF values of 20.8 and a HR of 59% in the top 1% of the screened library. Availability and implementation: LIGSIFT software, including the source code, is freely available to academic users at http://cssb.biol ogy.gatech.edu/LIGSIFT.
INTRODUCTIONIdentification of new lead molecules is a major challenge in the drug discovery process, as the experimental screening of large chemical databases is very expensive and depends on how representative the library is. Virtual screening (VS) approaches are frequently used for lead identification, which can be then verified under laboratory settings. VS approaches can be broadly classified into protein-centric approaches (e.g. docking) and ligand centric approaches. Protein-centric approaches do not depend on known ligand information and are generally expected to perform better, as they enable one to explicitly evaluate proteinligand interactions. However, these approaches rely heavily on the quality of the receptor structure and suffer from inherent limitations of the applied protocol. Ligand centric VS methods, on the contrary, do not need receptor information and often use known ligands as a seed to identify potential binders based on their 2D or 3D similarity to the known active molecule (). 2D VS methods generally represent a molecule as a vector with entries indicating the presence or absence of molecular features. These methods are popular, as they provide a fast and easy way of fishing out similar active molecules. However, the scaffold hopping potential of such methods is controversial (), and both molecular size and complexity negatively affect the search performance of such methods (). In contrast, 3D VS methods are computationally taxing due to complexities associated with ligand flexibility and determination of the optimal 3D alignment. Nevertheless, with improvement in computational power, 3D VS methods have become popular, as they capture the physical and functional features required for the biological interaction and are generally capable of scaffold hopping (). The scaffold hopping potential of 3D methods not only help to reduce false negatives during VS experiments, but also provide important insights for bioisostere replacement (), potential off-target interactions and cross-reactivity of existing drugs. Three-dimensional methods for aligning small molecules consist of three basic components: (a) a descriptor to represent the molecule, (b) a scoring function to assess the alignment quality and (c) an optimization procedure to find the best possible alignment with respect to the chosen scoring function. Common choices of descriptors include molecular interaction field-based (), pharmacophore-based () and shape-based representations of small molecules. A number of algorithms for shape-based VS have emerged in the last few years; each seeks to maximize the shape overlap between the pair of molecules under consideration. Most use atom centered, smooth Gaussian functions to model molecular volume, as it helps to achieve rapid overlay and can also be performed relatively easily using simple mathematical operations. For example, Rapid Overlay of Chemical Structures (ROCS), a highly popular closed-source algorithm, uses a Gaussian description of the molecular shape and chemical nature of the ligand () for ligand screening. Similarly, Align-it TM , an opensource tool uses a Gaussian description of molecular pharmacophores, but follows a different optimization approach to find the best overlay (). These and other similar tools use the Tanimoto Coefficient (TC) or similar size-dependent functions for measuring molecular similarity (). Moreover, these scoring functions *To whom correspondence should be addressed. lack a statistical model that can indicate the significance of structural/chemical match between molecules (). In this study, we present a new open-source, ligand-based VS algorithm that provides a size-independent scoring function to measure shape and chemical similarity and also reports the P-value to assess the statistical significance of the match between a pair of molecules. Performance evaluation of LIGSIFT on the 40 targets in the Directory of Useful Decoys (DUD) set shows overall improved performance compared with other wellestablished shape-based VS methods such as ROCS and Align-it TM .
METHODS
Molecular representation and alignmentThe 3D structure of a small molecule is represented using atom-based descriptors in LIGSIFT (supplementary). The molecular shapedensity of every heavy atom i is described using a spherical Gaussian function:is the decay factor, ' i = 22 is the amplitude, R i is the atomic coordinate for the ith atom and i is its van der Waals radius. The chemical nature of pharmacophore heavy atoms (supplementary) is identified using SMARTS expressions in OpenBabel (O'), and is modeled using the same Gaussian description as the atomic shape. Additionally, the spatial orientation of some atom-types (H-bond donor and acceptor) is calculated based on the position of neighboring atoms (supplementary). Using this model, the shape/chemical density of any molecule can be calculated as the sum of atomic densities, defined as:and the overlap between two molecules A and B is calculated as the sum of the overlaps of individual atoms' Gaussian functions:where i and j are the heavy atom indices of molecules A and B, i and j are the atomic Gaussian distributions of each atom and d ij is the distance between atom i and j. To identify the correct shape and chemical similarity between molecules A and B, we need to first identify the relative poses of A and B that maximizes V AB. To achieve this, two types of quickly identifiable initial alignments are used. The first type of initial alignment is generated by aligning the principal axes of the moment of inertia tensors of molecules A and B. This procedure helps to quickly scan the complete 3D space with minimum iterations, but is more suitable for aligning molecules of similar size. The second type of initial alignment is based on a three-atom superposition of an atomic triad selected from A and B. Although a systematic search would involve all combinations of atom pairs from both the molecules and would provide a very close to optimal alignment, this is not a practical solution for fast VS applications. Therefore, only pairs of atoms having similar chemical nature are used as triad pairs to generate sub-optimal initial alignments. Starting from each sub-optimal initial alignment, the optimal nonsequential alignment is identified using the JonkerVolegenant shortest augmenting path algorithm (), which aims to minimize the total cost of misaligning heavy atom pairs. A cost matrix is calculated for every heavy atom pair (i 2 A; j 2 B), where the cost (C ij ) for aligning atom i and j is defined as:where V ij is the overlap of the atomic Gaussian distribution between atom i and j, and k = 100 is an arbitrary constant larger than V ij. When evaluating chemical similarity, V ij is evaluated as zero for atom pairs with dissimilar chemical types, in order to encourage matches between atom pairs with same or similar chemical type. Finally, a short Metropolis Monte-Carlo simulation with rigid body rotation and translation of coordinates is performed to refine and maximize the overlap (V AB ) between molecules A and B.
Molecular similarity of overlapped structuresOnce the relative pose of molecules A and B that results in maximum overlap (V AB ) is identified, the scaled TC (sTC) score is calculated as:Here, TC is the Tanimoto coefficient of the shape/chemical similarity, V A and V B are the shape/chemical densities of molecules A and B calculated using the Gaussian model (Equation 2). s 0 in Equation(5) is the scaling factor that ensures that the mean molecular similarity scores are sizeindependent and is calculated as:
Validation datasetFor the validation, we have used a standard database of active and decoy molecules for 40 pharmaceutically relevant protein targets, listed in the DUD (). For each active molecule, there are approximately 36 physically similar but topologically dissimilar decoys, selected based on matching molecular weight, number of hydrogen-bond donor and acceptors, number of rotatable bonds and log P. Duplicate entries were removed; thus only a single entry for each molecule in the database is retained. The list of all the 40 targets along with the number of actives and decoys is found in supplementary Table S4. To evaluate the effect of conformational flexibility on VS, conformational models of the ligand derived from the 40 DUD proteinligand complexes and database molecules were generated using OMEGA () with default settings.
Evaluation of VSTo evaluate the performance of different screening approaches, we used the standard evaluation metrics: (a) the receiver operating characteristic (ROC) curve and (b) the enrichment factor (EF) of screened compound library and (c) the hit rate (HR). The ROC curve plots the true positive rate as a function of false positive rate. The area under the curve (AUC) is frequently used to quantify the shape of the ROC curve, with values in the range, with 0.5 indicating random performance. For evaluating the performance in the top x% of the screened library, a common metric EF has been applied, which is defined as: EF x% = True Positives x% =N x% selected
N actives =N total 9We have used EF 1% , EF 5% and EF 10% to analyze the performance. A known problem of EF is its dependency on the ratio of active and decoy molecules in the database. Therefore, we have used an additional metric HR, defined as:where EF x% ideal is the ideal EF that would be obtained in x % of the database.
RESULTSVS was performed for all the 40 DUD targets using bioactive and both single and multiple database conformers and database molecules were ranked using various shape and chemical similarity metrics. Multi-conformer models of database molecules were generated using OMEGA (OpenEye Inc.).
Effect of size-independent scoring function on VSA common problem in VS is the large number of false negative predictions. One possible cause is the size dependence of the scoring functions that are used in scoring and ranking. We sought to address this problem by scaling a widely used metric TC, so that it becomes size independent (scaled TC). To examine the effect of scaling, independent of the contribution from different conformers of the database molecules, we used a single conformer per database molecule, as provided in the downloaded DUD structure file, which was generated using CORINA ().shows the average AUC and EF values obtained for the 40 DUD targets, using the bioactive query conformer and a single conformer of the database molecules (see Section 2.4). The same molecular overlay was used for both TC and sTC. Overall, sTC shows a small improvement in both average AUC and EFs on the DUD set. In most cases, AUC and EF values either remain unchanged or the improvement was marginal, because the size of seed ligand and database molecules are mostly similar in the DUD set (supplementary). Only for the targets where database molecules were of much different size than the seed ligand does the advantage of scaling TC become apparent on average (supplementary). To examine this, we increased the size and heterogeneity of database molecules by including active and decoy molecules from other 39 proteins in the DUD set. We observe (supplementary) that as the size of database molecules diverge from the seed ligand, the difference between AUC and EF1% of sTC and unscaled TC becomes larger. This suggests that sTC helped to rank active molecules, which had statistically more significant matches but lower TC scores higher than those that had statistically less significant but higher TC scores. For example,shows structural superposition of a cdk2 active molecule ZINC03814437, on the seed ligand taken from cdk2 receptor structure (PDB: 1ckp). As the size of the active database molecule (in tan) is smaller than the seed ligand (in cyan), the large volume of the seed ligand overwhelms the unscaled chemical TC score of TC = 0.415. Based on TC, ZINC03814437 is ranked at position 123 (6.7% of database). For sTC, the chemical similarity is scaled, so the same overlap has a sTC = 0.54, which ranks the active molecule at position 62 (3.3% of database); highlighting the advantage of a size-independent scoring function.
VS performance of LIGSIFTThe performance of LIGSIFT is next benchmarked using the bioactive conformation of the seed ligand and modeled multiple conformations of database molecules.shows the AUC values of the ROC curves (supplementary) for each of the 40 DUD targets. Overall, LISIFT shows very good VS performance. The average AUC for the 40 targets is 0.79 AE 0.20, which is better than the well-established shape-based VS tools like ROCS (AUC = 0.73 AE 0.2), that uses a similar combo scoring function, and is much better than available open source tools like Align-It TM (AUC = 0.75 AE 0.23). For 38 targets, LIGSIFT VS rankings were better than random (AUC40.5), while it failed for two targets: PDGFRB and SRC. The control methods, Align-It and ROCS, also failed on these two target proteins (AUC50.5), in addition to another three and four other proteins (), respectively. A detailed analysis of these two failed target proteins suggests that the seed ligand may not be a good representative for fishing out other active molecules for this receptor. For instance, when we used other active molecules in the database as our seed molecule, AUC values as well as EF and HR generally improved for both the proteins (supplementary). As expected, the performance using these database seed molecules depends on how well they represent other actives molecules in the database. These cases highlight the applicability and advantage of using multiple seed ligands to identify similar active molecules from the database. Nevertheless, as observed in case of single conformers, even when we use multiple database conformations, the size-independent scaled TC (sTC) scoring performs slightly better than simply using the unscaled TC as the metric. A closer examination of the results highlights that AUC of the ROC curves improved for 20 of the 40 proteins (underlined values in), suggesting that the scaling of the similarity scores was helpful in alleviating false negatives for 50% of the test proteins. The VS results are further analyzed using the EF (Equation 9), with the results summarized in. Using chemical similarity, LIGSIFT achieved an average EF of 20.8 AE 12.6, highlighting the ability of the method to recognize active molecules at the beginning of ranked database. High enrichment rates(EF1% 430) were observed for 15 proteins: ACHE, ADA, AMPC, AR, COMT, COX2, DHFR, GPB, HMGA, HSP90, INHA, MR, NA, PNP and RXR; while no enrichment (EF1% = 0) was observed for SRC (supplementary). These values are comparable to those reported for ROCS (EF1% = 19.4 AE 12.9) (), and much better than what is obtained using Align-It (EF1% = 16.9 AE 12.5). However, the enrichment of active molecules using ROCS VS is null (EF1% = 0) for four proteins (FGFR1, GART, TRYPSIN and VEGFR2), while Align-It failed on three proteins (COMT, PR and VEGFR2). Although the AUC of ROC curves along with EF1% are commonly used for evaluating VS performance, a known disadvantage of EF is its dependence on the ratio of actives and decoys in the database, which makes comparison of various methods on different datasets ambiguous. Therefore, we additionally used the Hit Rate (Equation 10) for evaluating VS performance. The average hit rate of LIGSIFT in the top 1% of the screened library was 59%, better than the ROCS hit rate of 54.6 and the Align-It hit rate of 48.0%. These results clearly show that on average LIGSIFT ranks a large number of active molecules as best among the screened molecules in the database. For example, 22 of the 40 DUD proteins achieved a hit rate 450%, while only two proteins had a hit rate of 510% (supplementary). It is interesting to note that even though multiple ligand conformations should result in better molecular overlap and is expected to have better VS performance, the observed improvement in average AUC was marginal (increasing from 0.78 to 0.79). The average EF1% showed the largest improvement, increased from 17.9 to 20.8. To examine the effect of molecular flexibility on VS performance, we further analyzed EF1% for molecules with different molecular flexibility (supplementary), measured by their number of rotatable bonds, but found no correlation between molecular flexibility and VS performance.
DISCUSSION AND CONCLUSIONShape-based ligand structural alignment has multiple applications, the most practical being drug discovery. Even though there is a rapid increase in the number of tools developed for this purpose, the metrics used for evaluating molecular similarity in these applications are size dependent and lack statistical significance quantification. Here, we have developed a new algorithm (LIGSIFT) for the structural overlay of small molecules and quantification of molecular similarity (both shape and chemical) using a sizeindependent scoring function (sTC). This score is essentially a scaled TC based on a random background distribution of shape and chemical TC calculated for millions of overlays of molecules of various sizes. A rigorous benchmark and evaluation done using three standard metrics, namely AUC of ROC curve, EF and Hit Rate (HR), highlight the improvements in VS using scaled TC (sTC) over commonly used size-dependent ranking functions like TC, especially for database molecules that have different size than seed ligand. In a commonly used DUD benchmark dataset, LIGSIFT performs better (AUC = 0.79 AE 0.2) than other well-established shape-based VS methods like ROCS (reported AUC = 0.73 AE 0.2) (), ShaEP (reported AUC = 0.64 AE 0.17) (), MolShaCS (reported AUC = 0.63 AE 0.08) and Align-It (0.75 AE 0.2). Overall, for 95% of the test proteins, the VS performance of LIGSIFT was nonrandom and the hit rate of active molecules was410% in the top 1% of screened library. While these results are encouraging, we noticed that using a given seed ligand, LIGSIFT was able to retrieve only half of the active molecules in nearly 55% of the tested proteins. This phenomenon is not restricted to only LIGSIFT, but was also observed for other shape-based VS tools, suggesting that a single-seed ligand contains a limited imprint of the physicochemical information of the ligand-binding site and may not be sufficient for identifying all active molecules present in the ligand database. In addition, it is also possible that these missed active molecules bind at a different location on the protein. For these cases, it might be useful to use a diverse set of known active ligands as seeds. If other active molecules are unknown, ligands from homologous proteins can be useful as seeds in VS experiments. In future work, we will explore this option in further detail.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
To estimate s 0 , we need a random background distribution of molecular similarity (MS) scores consistent with the conformational variability of small molecules. Therefore, a conformational pool of 737 PubChem molecules of various sizes was generated using RDKit's distance-geometry conformer generator. For each molecule, a maximum of 50 lowenergy conformers were generated, and each conformer was structurally aligned with 11 604 representative PDB ligands. In addition, all PDB ligands were also aligned to each other. Pairwise TC values for shape similarity and chemical similarity obtained after aligning molecule pairs of various sizes were used for calculating s 0 (using Equation 6). This scaling of TC values ensures that the molecular similarity scores are size-independent for random match between ligands. The parameters for a, b, c, d and e in Equation 6 for different optimization schemes (shape similarity, chemical similarity and combination of shape and chemical similarity) are listed in supplementary Table S2. Figure 1 shows the distribution of scaled TC mean and unscaled TC mean obtained for random structural alignments. Both scaled shape and chemical similarity scores have a narrow distribution with a maximum density near 0.49 and 0.42, respectively, reflecting that the mean scores for alignment between random pair of molecules are size independent. Meanwhile, molecular similarities measured using unscaled TC have a large spread, which reflects their size dependence. 2.3 Statistical significance of molecular similarity The statistical significance of the sTC between any two molecules is estimated by comparing the similarity score with values obtained for the alignment between random molecule pairs. The structure similarity of random pairs of various sizes was calculated using the same procedure as described above for calculating s 0 and modeled by Gumbel distribution fitting in the R evir package. A statistical model of fitted distributions was
A.Roy and J.Skolnick at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
LIGSIFT at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
