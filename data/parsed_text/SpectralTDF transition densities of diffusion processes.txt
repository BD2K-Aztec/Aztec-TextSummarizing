Motivation: In the Wrightâ€“Fisher diffusion, the transition density function describes the time evolution of the population-wide frequency of an allele. This function has several practical applications in population genetics and computing it for biologically realistic scenarios with selection and demography is an important problem. Results: We develop an efficient method for finding a spectral representation of the transition density function for a general model where the effective population size, selection coefficients and mutation parameters vary over time in a piecewise constant manner. Availability and implementation: The method, called SpectralTDF, is available at https://source forge.net/projects/spectraltdf/.
IntroductionThe transition density function (TDF) of the WrightFisher diffusion describes the time evolution of the frequency of an allele (). The TDF is useful for understanding the effects of demography, mutation and selection on genetic variation, and it is a key component of a number of methods for inferring selection coefficients (), predicting allele fixation times () and computing population genetic statistics such as the site frequency spectrum (Z  ivkovictivkovict al., 2015). Most existing approaches for computing the TDF assume either restrictive models of dominance () or selective neutrality () or are computationally slow for selection strengths commonly observed in biological data (). However, Song and Steinr cken (2012) and Steinr cken et al. (2013) recently developed a numerically stable and computationally efficient method for finding a spectral representation of the TDF for a general selection model in the case of constant parameters (population size, mutation rates and selection coefficients). Despite the utility of this new approach, assuming that model parameters remain constant over time is often too restrictive for biological applications (of selection in which the fitness of a homozygote is twice that of a heterozygote (i.e. additive or genic selection). Furthermore, selection parameters are assumed to remain constant over time, and the model does not allow for recurrent mutations. Here, we present the first method for computing the TDF under arbitrary models of dominance and recurrent mutation while allowing selection parameters, mutation rates and effective population sizes to change over time in a piecewise constant manner.
ApproachWe consider a biallelic locus with two alleles, A 0 and A 1 , evolving in a single panmictic population. In the corresponding WrightFisher diffusion, X t denotes the frequency of allele A 1 at time t, measured continuously in units of generations. We assume that either X 0 is given or the distribution of X 0 is specified. The effective population size, mutation rates and selection parameters are assumed to be constant within each of K disjoint epochs. As illustrated in, the kth epoch has effective size N k (diploid individuals) and duration s k .
Epoch boundaries are denoted byWithin the kth epoch, the per-generation probability that a copy of allele A 0 mutates to allele A 1 is a k , and the per-generation probability that a copy of allele A 1 mutates to allele A 0 is b k. In addition, selection acts in such a way that the relative fitness of an individual carrying i copies of allele A 1 is 1  s ki (i  1, 2).See Song and Steinr cken (2012) for discussion on the appropriate boundary conditions. In Equation (1), the parametersk2 are the population-scaled versions of the mutation and selection parameters. Within each epoch, k, a spectral representation of the TDF p k t; x; y can be obtained by employing the framework of Song and Steinr cken (2012), who developed an efficient algorithm for finding the eigenvalues and the eigenfunctions of the diffusion generator L k. The challenge in computing the TDF for the full model with K epochs lies in knitting together the expressions for the densities p k t; x; y across the different epochs. The method we implement involves an efficient and numerically stable algorithm for carrying out this knitting procedure using a polynomial interpolation method, which is detailed in Supplementary Methods.
ImplementationOuris shown in. The full command options are detailed in the user manual distributed with the software.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Discussion Our implementation provides a fast and numerically stable method for computing the TDF for a general model with piecewise-constant population sizes and a broad range of time-varying mutation and selection parameters. It also allows for a variety of initial conditions, including a specified initial frequency and stationary distributions under mutation-selection balance or mutation-drift balance. The JAVA implementation is designed to be used either as a stand-alone application or in combination with other methods. For example, the code can be easily incorporated into the method of Steinr cken et al. (2014), allowing the inference of selection parameters from time series data sampled from populations with timevarying demographic and selection parameters. In general, the method we present provides a flexible and efficient tool for studying the evolution of allele frequencies over time under complex evolutionary scenarios. Fig. 1. Diagram of the model. A population has constant size in each of K epochs (N1  1000; N2  600; N3  900). An allele, A 1 , at a locus of interest evolves over time, subject to pressures of mutation and selection that are constant within each epoch Fig. 2. Plot of the TDF for the model shown in Figure 1 with the parameters specified in the example in Section 3, evaluated at the times t 1 , t 2 and T
M.Steinr cken et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
