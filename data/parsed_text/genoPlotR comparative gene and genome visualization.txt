The amount of gene and genome data obtained by next-generation sequencing technologies generates a need for comparative visualization tools. Complementing existing software for comparison and exploration of genomics data, genoPlotR automatically creates publication-grade linear maps of gene and genomes, in a highly automatic, flexible and reproducible way. Availability: genoPlotR is a platform-independent R package, available with full source code under a GPL2 license at R-Forge: http://genoplotr.r-forge.r-project.org/ Contact:
INTRODUCTIONComparison of genes and genomes has increasingly been used to infer patterns and processes in evolution and to relate phenotypic differences to genomic changes. With the recent advent of modern high-throughput sequencing technologies, the need for methods and visualization tools in comparative genomics has vastly increased. As of 2010, more than 1000 bacterial and archaeal genomes are available in public databases, making the number of possible comparisons almost infinite. Several programs such as the Artemis Comparison Tool (ACT;), UCSC Genome Browser (), Mauve (), MGCAT () and Murasaki () have extensive visualization functions. However, these tools lack the ability (i) to directly add annotations to the publication quality graphics they produce or (ii) to fully automate the production of comparative figures. GenomeGraphs () is a R package, which allows the visualization of one genomic region with related datasets such as microarray data. It can display several annotations for the same region, but it cannot show several regions in a single plot. The R package genoPlotR is an attempt to fill in those gaps, by providing a flexible, automatable tool. It allows the user to graphically represent the comparison between several segments or subsegments of genomes in a linear fashion. It reads data stored in commonly used formats (EMBL, Genbank, BLAST and Mauve outputs) or in user-created tabular files and allows comparisons of one or several subsegments of a genome. A tree can be added to show the phylogenetic relationships between the segments, as can also scales and annotations to each subsegment. The use of R (R Development) and its grid package enables the use of its graphical power and flexibility to manipulate data and to
VISUALIZATIONAfter being read and modified, objects can be passed to the main graphical function plot_gene_map. The user can define, for each segment, several subsegments that will be represented in the plot. These subsegments can be represented in reverse orientation (e.g. see, first subsegment on the top DNA segment). The placement of each subsegment on the plot is either automatically determined by minimizing the area of the genoPlotRcomparisons, or fixed by the user. annotation and phylog objects are also passed to the main function plot_gene_map, and a scale can be added to any of the DNA segments, or placed at the bottom right of the plot. Colors of the comparisons can be set to gray scales or to shades of blue and red, depending on the e-value or the bit score of the hit, as in ACT. In addition to DNA segments and comparisons, other objects can be added to the plot, such as a phylogenetic treeparsed into R using the package ade4 ()or annotations for each DNA segment. Using R embedded graphic generation functions, the figure can then be displayed on the screen or saved to various graphical formats, including both raster (functions png, jpeg, tiff, etc.) and vector formats (functions postscript, svg, pdf, etc.). The output of the graphical function can also be embedded in larger plots, allowing the user to create multi-panel figures. Numerous examples and datasets, including the ones in, are included in the package, to guide the users' first steps.
CONCLUSIONSBy using the graphical power and flexibility of R, the package genoPlotR generates reproducible maps of genes and genomes that can be used to generate publication-ready figures, starting from a wide range of formats. Since all the instructions for drawing the figures are contained in R code, it is highly flexible, and thus it is straightforward to automate the process of drawing very similar figures for different datasets. The use of a scripting language makes it particularly suitable for integration into annotation and comparative genomics pipelines.
* To whom correspondence should be addressed. integrate gene and genome maps into more complex graphics. The results can be saved either in high-quality raster or vector formats for further editing. 2 INPUT DATA genoPlotR uses two main objects: dna_seg, which represent segments of DNA containing genes or other features, and comparison, which represent the relationships between two dna_seg. genoPlotR reads dna_seg objects from the widely used Genbank and EMBL formats (described here: http://www.ncbi .nlm.nih.gov/collab/FT/; Fig. 1A), or from tabular formats, either as protein table files (NCBI) or user-generated. Genbank or EMBL files can be generated by the user or downloaded from nucleotide databases, e.g. from NCBI's Nucleotide Entrez (http://www.ncbi.nlm.nih.gov/sites/entrez). By default, only CDS features are read, but any set of features can be specified for reading. genoPlotR reads comparison objects using the tabular output of, e.g. BLAST (Altschul et al., 1990) or from user-generated tabular files (Fig. 1A). Hit tables in text format produced by stand-alone or online BLAST programs are suitable for input in genoPlotR. For example, from the NCBI BLAST web page, sequence alignments of genes and genomes can be produced with the option 'align two or more sequences'. The hit table can then be downloaded. The backbone file produced by Mauve, a multiple-genome alignment tool (Darling et al., 2004), can be transformed into both dna_seg and comparison objects (Fig. 1B). Both dna_seg and comparison objects can be filtered either by using arguments to the reading functions, or by using R functions, for example, to remove short genes or low-significance comparisons. Objects can be modified to specify color, size or appearance (arrows, blocks, lines, etc.) for each element of the DNA segments and of the comparisons. Intron-containing genes in EMBL and Genbank files are automatically recognized (Fig. 1D). In addition, a phylogenetic tree in Newick format can be parsed as a phylog object, using the package ade4 (Dray et al., 2007; Fig. 1A). Finally, annotation objects can be designed to add a legend to the DNA segments.
The Author(s) 2010. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/2.5), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited. at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [10:45 23/8/2010 Bioinformatics-btq413.tex]
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
