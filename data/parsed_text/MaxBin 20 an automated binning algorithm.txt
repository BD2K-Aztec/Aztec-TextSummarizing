The recovery of genomes from metagenomic datasets is a critical step to defining the functional roles of the underlying uncultivated populations. We previously developed MaxBin, an automated binning approach for high-throughput recovery of microbial genomes from metage-nomes. Here we present an expanded binning algorithm, MaxBin 2.0, which recovers genomes from co-assembly of a collection of metagenomic datasets. Tests on simulated datasets revealed that MaxBin 2.0 is highly accurate in recovering individual genomes, and the application of MaxBin 2.0 to several metagenomes from environmental samples demonstrated that it could achieve two complementary goals: recovering more bacterial genomes compared to binning a single sample as well as comparing the microbial community composition between different sampling environments. Availability and implementation: MaxBin 2.0 is freely available at http://sourceforge.net/projects/ maxbin/ under BSD license.
IntroductionRecovering individual genomes from metagenomic samples remains a difficult task since sequences of all microbial populations are sampled simultaneously; however, it is a critical procedure to understand the functional potential of the uncultivated microbes in natural and engineered ecosystems. Binning is a process to classify unassembled reads or assembled contigs into discrete clusters, in which one bin represents one genome. Predominant binning approaches include clustering by nucleotide frequencies () or sequence coverages (). Automating the binning process provides a high-throughput method to recover microbial genomes from metagenomes. We previously developed MaxBin (), an automated binnning algorithm that classifies assembled genomic sequences from metagenomic datasets. Based on both tetranucleotide frequencies and sequence coverages, MaxBin automatically estimates the bin number from the target metagenome, classifies the sequences into genome bins, and measures the coverage levels for the binned genomes in the metagenome. In total, 19 and 26 draft genomes were recovered from two cellulolytic bacterial consortia enriched from compost using MaxBin (), demonstrating its utility in recovering the genomes of uncultivated microbes. Recovering genomes from multiple samples may improve the performance of binning algorithms. A differential coverage binning approach was developed to use the coverage information of the contigs from two metagenomic samples to bin genomes by plotting them on a two-dimensional map (). Binning tools that employ multiple samples also demonstrated better performances when V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com two or more samples are co-assembled and binned (). Here we describe MaxBin 2.0, the next generation of the MaxBin algorithm that recovers genomes from co-assembly of multiple metagenomic samples. By exploiting contig coverage levels across multiple metagenomic datasets, MaxBin 2.0 achieves better binning results than binning individual metagenomic samples. In comparison to other binning algorithms that utilize multiple metagenomic datasets, MaxBin 2.0 is highly accurate in recovering genomes from simulated metagenomes. The ability of MaxBin 2.0 to measure the coverage levels of the genome bins also allows comparisons of the genomeresolved microbial community composition across multiple samples.
MethodsMaxBin 2.0 employs an ExpectationMaximization (EM) algorithm to recover draft genomes from metagenomes. Briefly, after coassembling sequencing reads of multiple metagenomic datasets, MaxBin 2.0 measures the tetranuncleotide frequencies of the contigs and their coverages for all involved metagenomes and classifies the contigs into individual bins. The abundances of all genome bins, which were unknown before the binning process, are estimated by the EM algorithm. The description that follows demonstrates the incorporation of multiple metagenomic datasets into the MaxBin algorithm. Let the number of metagenomes be M. The reads of all metagenomes are combined and co-assembled. Let S be a contig in the co-assembly. The probability that S belongs to a genome G can be measured based on its tetranucleotide frequencies and contig coverages in all metagenomic datasets, which isIn which P dist  and P cov  are probability density functions for Euclidean distance of tetranucleotide frequencies and coverages between S and G, respectively. This probability term is then applied in the Expectation-Maximization algorithm for binning genomes from metagenomes. See Supplementary Materials for a more detailed description about the probabilities and the algorithm. Other improvements include adding multi-thread support into the MaxBin algorithm and adding more runtime options to allow users to adapt MaxBin 2.0 to specific applications.
ResultsThe performances of MaxBin 2.0 was compared to three other automated binning software: GroopM (), CONCOCT () and MetaBAT (), using metagenomic datasets simulated by MetaSim () and assembled by Megahit (). Benchmarking the tools using different minimum contig length settings (500 and 1000 bps) revealed that MaxBin performed relatively well (in terms of F-score, which is the harmonic mean of precision and recall) compared to other binning tools (). It was also ranked first in tests involving 20 or more samples, indicating its accuracy in classifying contigs into distinct genomes. MaxBin 2.0 was also applied to two sets of real metagenomes. One set consists of two cellulolytic consortia adapted from compost; the other set contains ten Human Microbiome Project (HMP) datasets. Binning the co-assembly of the two compost metagenomes yielded 84 bins, surpassing the number of bins generated by binning the two metagenomes separately (19 and 26 bins). Bins produced by individual binning of the metagenomes are mostly present in the coassembly, and more than half of the bins (57) uniquely belong to the co-assembled metagenome. The co-assembly of the ten HMP metagenomes sampled from five body sites was also binned using MaxBin 2.0. The co-assembled metagenome yielded many more genome bins (96) compared to individual binning of each metagenomic dataset (21.4 in average). Clustering the ten HMP samples based on the coverage levels of the genome bins suggested that similar body sites share similar microbial community composition, demonstrating how MaxBin 2.0 helps users compare microbial content among a number of distinct sampling environments.
Overall performances of the binning tools
Bioinformatics, 32(4), 2016, 605607 doi: 10.1093/bioinformatics/btv638 Advance Access Publication Date: 29 October 2015 Applications Note at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Y.W.Wu et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Richter,Y. et al. (2008) MetaSim: a sequencing simulator for genomics and metagenomics. PLoS One, 3, e3373. Sharon,I. et al. (2013) Time series community genomics analysis reveals rapid shifts in bacterial species, strains, and phage during infant gut colonization. Genome Res., 23, 111120. Wang,Y. et al. (2012) MetaCluster 5.0: a two-round binning approach for metagenomic data for low-abundance species in a noisy sample. Bioinformatics, 28, i356i362. Wrighton,K.C. et al. (2012) Fermentation, hydrogen, and sulfur metabolism in multiple uncultivated bacterial phyla. Science, 337, 16611665. Wu,Y.W. and Ye,Y. (2011) A novel abundance-based algorithm for binning metagenomic sequences using l-tuples. J. Comput. Biol., 18, 523534. Wu,Y.W. et al. (2014) MaxBin: an automated binning method to recover individual genomes from metagenomes using an expectation-maximization algorithm. Microbiome, 2, 26. MaxBin 2.0
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
