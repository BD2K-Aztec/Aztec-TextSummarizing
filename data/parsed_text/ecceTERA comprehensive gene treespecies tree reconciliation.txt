A gene tree-species tree reconciliation explains the evolution of a gene tree within the species tree given a model of gene-family evolution. We describe ecceTERA, a program that implements a generic parsimony reconciliation algorithm, which accounts for gene duplication, loss and transfer (DTL) as well as speciation, involving sampled and unsampled lineages, within undated, fully dated or partially dated species trees. The ecceTERA reconciliation model and algorithm generalize or improve upon most published DTL parsimony algorithms for binary species trees and binary gene trees. Moreover, ecceTERA can estimate accurate species-tree aware gene trees using amalgamation. Availability and implementation: ecceTERA is freely available under
IntroductionReconciling gene trees with a species tree () is a crucial step in many phylogenomics problems (), from the reconstruction of gene trees (; Sz oll} osi and) to the reconstruction of ancestral genomes (). Internal gene tree nodes, representing ancestral genes, are assigned to species (extant or extinct) and evolutionary events such as gene duplications or horizontal transfers. This results in evolutionary histories (or reconciliations) for gene families explaining apparent discordances with the speciation history. There exist several reconciliation software packagessuch as Notung (), RANGER-DTL (), Mowgli (), Eucalypt (), AngST () and Jane ()whose algorithms and models, differ, sometimes in subtle ways, in terms of the evolutionary events they consider (). Furthermore, an important difference lies in the nature of the species tree. First, some software packages assume that the considered species tree is fully dated (i.e. speciation dates are provided) and ensure that horizontal transfers are timeconsistent (i.e. that no transfer can occur between species that did not exist at the same time, see), while others ensure only local time-consistency (). But other software packages do consider undated species trees (i.e. the timing of speciation events is not known), and, as ensuring time-consistency with undated trees is an NP-hard problem (), these programs sometimes fail to find a consistent, parsimonious scenario and either output an inconsistent one or produce no output. This disparate body of parsimony models and algorithms makes it difficult to assess if discrepancies between the results provided by different software is due to differences in the model, the algorithm or the implementation.
MethodsWe introduce ecceTERA, a program whose aim is to compute parsimonious reconciliations between species trees and gene trees under a comprehensive evolutionary model. The program ecceTERA improves upon existing parsimony reconciliation software in several aspects. Inwe show how ecceTERA compares to the most commonly used parsimony algorithms/software that compute reconciliations using the Duplication-Transfer-Loss (DTL) model. Most notably, its evolutionary model is comprehensive as it includes the following evolutionary events: speciation, speciation-loss (speciation followed by a loss of one gene copy), gene duplication, gene loss, gene transfer and transfer-loss (gene transfer with loss of the original gene) between two sampled species, and gene transfer and transfer-loss from/to an unsampled species (i.e. a species that is not represented in the dataset) to/from a sampled one. To the best of our knowledge, ecceTERA is the first parsimony software to implement this last event, called 'transfer from/to the dead' in Sz oll} osi et al. (2013b), where it was shown on a dataset of 36 cyanobacteria species that a significant number of gene transfers that occurred in the past could reasonably be transfers from/to unsampled species. A more detailed description of the evolutionary model of ecceTERA is provided in the Supplementary Material. Also, ecceTERA, can take as input a species tree that is either undated, fully dated (speciations are totally ordered), or partially dated (the dating of a selected set of speciations is known), and computes parsimonious reconciliations that are consistent with the provided time information, if any. Thus, for fully dated species trees, ecceTERA provides consistent parsimonious reconciliations, while with partially dated or undated species tree, ecceTERA checks the consistency of the computed parsimonious reconciliations and indicates the inconsistent ones. Finally, the ecceTERA software is based on a unified dynamic programming algorithm (described in the Supplementary Material) that builds upon the model of the Mowgli algorithm (). The time and space complexity of the ecceTERA reconciliation algorithm is Ok  1jSjjGj to construct one parsimonious reconciliation, where S is the species tree, G the gene tree and k the number of dated nodes of S. The use of a single algorithm ensures that, when comparing the results obtained on the same data with different models (for example to evaluate the impact of a speciation time), the observed differences can be attributed to differences in the models and not to model-specific algorithmic or implementation issues. ecceTERA also includes several features of interest for the analysis of reconciled gene trees. For example, ecceTERA can compute a compact graph structure that represents the set of all parsimonious reconciliations for the chosen evolutionary model, as described in. It is also possible to associate support values with reconciliation events obtained by considering nearly-optimal or Pareto-optimal reconciliations, as described in) also amalgamates gene trees, though using a different algorithm, and that MowgliNNI (), Notung () and TreeFix-DTL () can modify gene trees using local rearrangements improving the reconciliation score. ecceTERA is a command line software written in C , using the Bio  () and BOOST C  libraries, and is available as source code. It has been tested on the Mac and Linux platforms, for which executables are provided. It requires input trees in Newick format and outputs reconciliations in a custom format, described in the manual provided with the software. ecceTERA can also output reconciliations in a format readable by SylvX (ChevenetThe symbols and indicate whether or not a method implements a given feature. The symbol / is used for features that can be turned on/off. Column A. indicates support for the transfer-loss atomic operation. Col. B. indicates whether transfers from/to an unsampled species are considered by the model. Col. C. specifies which algorithms support Rooted (R) or Unrooted (U) gene trees. Col. D. and E. specify which algorithms can perform gene tree reconstruction, either through almagamation of clades (D.) or local rearrangements (E.). Col. F. indicates whether the program provides support values for the events of the computed reconciliations. Col. G. indicates which programs account for Incomplete Lineage Sorting (ILS). Col. H. specifies whether Fully dated (F), Undated (U), or Partially dated (P) species trees are supported by the program. Columns I. and J. indicate whether the program only reports optimal solutions that are feasible (i.e. consistent with both the topology of the species tree and the speciation dates if available). For Col. J., a / value means that no feasible solution is provided when all optimal solutions are infeasible. Col. K. shows whether the program can enumerate all optimal (feasible) solutions. Col. L. indicates the availability of a Graphical User Interface (all programs have a command-line mode). Note that ecceTERA can be run online at http://mbb.univ-montp2.fr/MBB/subsection/ softExec.php?softeccetera. Col. M. indicates the availability of the source code and the associated programming language that is used. Programs without a source code distribution can nevertheless be executed on all major operating systems.), a software for visualizing and manipulating reconciliations (an example of visualization of an ecceTERA reconciliation is provided inof the Supplementary Material).
ecceTERA
Case studyWe applied ecceTERA to the reconstruction of species-tree aware gene trees using the joint amalgamation method presented in, under several evolutionary models. The tests were performed on a dataset composed of a dated species tree of 36 cyanobacteria and a set of 1099 gene trees obtained from simulated alignments generated as described in Sz oll} osi et al. (2013a, Supplementary Material). We found that using a dated species tree and a full evolutionary model, including transfer-loss and transfer from/to extinct or unsampled species, achieves the highest accuracy, with a mean RobinsonFoulds (RF) distance of 9.42 to the true trees; this corresponds to the model described in. Excluding transfer from/to extinct or unsampled species led to a larger mean RF distance of 9.78, while considering the species as undated provided the worst results, with mean RF distances slightly above 10. These experiments are described in more detail in the Supplementary Material. To assess its computational efficiency, we compared ecceTERA to RANGER-DTL (), the most efficient parsimony software available to date, using three large datasetsCOG, CYANO and HOGENOMdescribed in detail in the Supplementary Material. The default parameters were used for both programs. For the COG and CYANO datasets the running times and memory requirements of the two programs were comparable while, on the HOGENOM dataset (see Supplementary), ecceTERA was faster, by a mean factor of 3:29, for 73% of the gene families, and RANGER-DTL-U performed better, by a mean factor of 1:28, on very large gene families (indeed, most of the remaining 27% of the gene families where RANGER-DTL-U was faster contained more than 800 genes). We refer the reader to the Supplementary Material for a precise comparison.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Conclusion ecceTERA supports a comprehensive set of reconciliation models, for which parsimonious reconciliations are computed using an efficient implementation of a unified dynamic programming algorithm. Moreover, it offers additional features that were not available in a single software, such as species-tree aware gene tree reconstruction and the computation of all parsimonious reconciliations. Future extensions will include the reconciliation of rooted non-binary gene trees (manuscript in preparation, partial support for this feature is provided in the current release), the sampling of optimal and suboptimal reconciliation scenarios, and provide a model of incomplete lineage sorting (ILS) (Chan et al., in preparation), in the spirit of Stolzer et al. (2012).
