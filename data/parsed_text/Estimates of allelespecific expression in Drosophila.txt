Motivation: Genetic variation in cis-regulatory elements is an important cause of variation in gene expression. Cis-regulatory variation can be detected by using high-throughput RNA sequencing (RNA-seq) to identify differences in the expression of the two alleles of a gene. This requires that reads from the two alleles are equally likely to map to a reference genome(s), and that single-nucleotide polymorphisms (SNPs) are accurately called, so that reads derived from the different alleles can be identified. Both of these prerequisites can be achieved by sequencing the genomes of the parents of the individual being studied, but this is often prohibitively costly. Results: In Drosophila, we demonstrate that biases during read mapping can be avoided by mapping reads to two alternative genomes that incorporate SNPs called from the RNA-seq data. The SNPs can be reliably called from the RNA-seq data itself, provided any variants not found in high-quality SNP databases are filtered out. Finally, we suggest a way of measuring allele-specific expression (ASE) by crossing the line of interest to a reference line with a high-quality genome sequence. Combined with our bioinformatic methods, this approach minimizes mapping biases, allows poor-quality data to be identified and removed and aides in the biological interpretation of the data as the parent of origin of each allele is known. In conclusion, our results suggest that accurate estimates of ASE do not require the parental genomes of the individual being studied to be sequenced. Availability and implementation: Scripts used to perform our analysis are available at https://github.com/d-quinn/bio_quinn2013.
INTRODUCTIONRecently, high-throughput RNA sequencing (RNA-seq), in which a library of millions of short cDNA fragments are sequenced in parallel, has emerged as the preferred method for genome-wide studies of gene expression (). Gene expression polymorphism is the result of differences in either cis-or trans-regulatory elements. As transregulatory changes affect the expression of both alleles equally, the role of cis-regulatory variation can be determined by examining differences in expression between alleles, termed allelespecific expression (ASE) (). Detection of ASE from RNA-seq data involves mapping sequence reads to their region of origin and assigning them to separate alleles. Both of these steps are non-trivial and in need of further development. Reads can be mapped to a single reference genome; however, this method is inherently biased (). Reads representing reference alleles are more likely to map correctly than those representing non-reference alleles because they contain fewer mismatches, yielding estimates of ASE that favor the reference ().illustrated this problem by generating a simulated human RNA-seq dataset that contained an equal number of reference and non-reference reads. The authors found that reads carrying the single-nucleotide polymorphism (SNP) allele found in the reference genome were significantly more likely to be mapped. Increasing the error rate in the sequence reads increases the bias by introducing additional mismatches to the reference genome (). In both humans and Drosophila, the degree of bias is unequal across genes (), with loci containing clusters of SNPs showing a strong bias toward the reference sequence. Therefore, even if the average bias across all genes toward mapping reads matching the reference genome is just a few percent, individual loci may have far greater biases (). The importance of clusters of SNPs also means that the problem is expected to be greater in species like Drosophila melanogaster that have a far greater density of SNPs than humans (). One way in which researchers have attempted to overcome the bias is by aligning reads separately to maternal and paternal genomes () or to transcriptomes (). These methods are effective, but are not useful in cases in which parental genotypes cannot be readily or cost-effectively obtained (). Another strategy involves aligning reads to a reference genome supplemented with all possible haplotypes within one read-length (). Again, this technique has been shown to reduce the reference bias; however, it is impractical for use in systems that contain many polymorphisms, as the number of haplotypes increases exponentially with the number of polymorphic sites (). This problem can be reduced by phasing the data using population genetic data, provided that genotypes are available from multiple individuals (). A third solution has been proposed by, in which analysis of ASE is restricted to genomic regions with fewer differentiating *To whom correspondence should be addressed. sites than the number of mismatches allowed. This solution is not ideal, however, as it requires one to discard useful data, ultimately decreasing statistical power. Finally, altering the alignment parameters can reduce the bias but does not eliminate it, while a comparison of different alignment software packages revealed little difference among them (). Once reads have been mapped to the reference sequence, they are assigned to separate alleles and counted. This can be accomplished by identifying SNPs between alleles. Unfortunately, SNP calls from RNA-seq data are not reliable because of the fact that there is no a priori expectation regarding read frequencies for each SNP allele, as there is when sequencing genomic DNA from a diploid individual (). Therefore, it is unclear whether unequal frequencies of reads from the two alleles are because of strong ASE or an incorrect SNP call. Furthermore, RNA editing can alter the sequence of RNA after transcription, and these changes can be mistaken for SNPs (). Accurate SNP calls are important for obtaining reliable estimates of ASE because errors in SNP calling, like mapping errors, will introduce bias toward one allele. Thus, SNPs are typically called from genomic data (). Although this method is generally effective, there are situations in which one would want to determine ASE without the extra time and cost associated with acquiring genomic sequences. Here we present a protocol for obtaining accurate ASE estimates in D.melanogaster, which involves creating an alternate reference sequence featuring SNPs called directly from an RNA-seq dataset after filtering out SNPs not observed in a high-quality SNP database. Our methodology is advantageous in that it only requires a single reference sequence, can be used in systems that contain many polymorphisms and does not involve discarding data based on the number of mismatches in a region.
METHODS
DatasetsWe used three RNA-seq datasets. The first was produced by, and downloaded from the EMBL-EBI ArrayExpress Web site (accession number E-MTAB-1266). The dataset we used comprised 10 million 79-bp Illumina single-end reads generated from a cross between lines 362 and 765 of the Drosophila Genetic Reference Panel (DGRP), which is a set of highly inbred lines derived from a natural population (). The second dataset was RNA-seq data simulated from the same cross as the first dataset (lines 362 and 765) and contained 10 million 79-bp single-end reads. The simulated data included SNPs reported in DGRP freeze 2 for each line but lacked indels or ASE. Reads were simulated separately for each line with an overall sequencing error rate of 1%, and the expression levels for each transcript were weighted by the expression levels observed in the first dataset. Reads were then merged together to mimic the cross. The third dataset was our own RNA-seq data made up of 18 293 076 101-bp Illumina paired-end reads generated from a cross between a D.melanogaster genotype from Innisfail, Australia, and the isogenic reference stock used for the original genome sequence (). The approach we took was to effectively isolate a single haploid genome from the Australian isofemale line (C12) and cross this to the reference stock. Specifically, we crossed virgin females from the Australian line to males of a T(2;3)CyO-TM6/pr cn; mwh rye balancer stock in which the second and third chromosomes co-segregate. A single male from the progeny exhibiting the balancer phenotype was then crossed with y; cn bw sp virgin females from the reference stock, and offspring not exhibiting the balancer phenotype were collected for sequencing. Sixto nine-day-old females were homogenized in Trizol and frozen on liquid nitrogen. RNA was extracted using Direct-zol RNA MiniPrep kits according to the manufacturer's protocol (Zymo Research, Irvine, CA). Libraries were constructed following poly-A selection using the standard non-strand-specific TruSeq RNA library preparation protocol and sequenced using Illumina HiSeq2000. The D.melanogaster genomic sequence (Ensembl build BDGP5.25) and GTF transcript annotation files for coding and non-coding genes were downloaded from the TopHat Web site http://tophat.cbcb.umd. edu/igenomes.shtml. Variant data from DGRP freeze 2 were downloaded from the Baylor College of Medicine Web site http://www.hgsc.bcm.tmc. edu/projects/dgrp/freeze2_Feb_2013/.
SoftwareRNA-seq data were simulated using RNASeqReadSimulator (https:// github.com/davidliwei/RNASeqReadSimulator). To ensure the expression level of genes in the real and simulated data was the same, reads mapping to each transcript in the default parameter alignment of the Massouras et al. dataset were enumerated using HTSeq () and used to weight simulations. Sequences were quality trimmed using Trimmomatic version 0.30 (). Reads were trimmed from the 3 0 end when average quality scores in sliding windows of 4 bp dropped below 20 or when the quality score at the end of the read dropped below 20. Sequences 550 bp in length were discarded. We used TopHat (version 2.0.8 with Bowtie 2 version 2.1.0) for read alignment (). For the alignment, we input the GTF file with known D.melanogaster transcripts (setting the G parameter), instructed TopHat not to consider novel splice junctions ( no noveljuncs), set the length of seed substrings to 20 ( b2L 20) and set the number of mismatches allowed in an alignment during multiseed alignment to one ( b2N 1). In addition, we varied the number of read-mismatches (N) and the indel length ( readgaplength,  maxinsertionlength,  maxdeletionlength,  readeditdist) allowed in the final read alignment (see Section 3). SAMtools (version 0.1.19) was used to discard nonuniquely mapping reads and to produce an mpileup file (). To identify potential SNPs in the RNA-seq data, we used VarScan mpileup2snp (version 2.3.5) (). For a potential SNP to be called by VarScan, the read-depth had to be greater than one ( mincoverage 2), and a read had to have an average base quality of at least 20 to be counted ( minavgqual 20). In addition, we set the P-value threshold for calling SNPs at 1.0 ( P-value 1), did not implement a strand filter ( strandfilter 0) and set the minimum variant allele frequency threshold at 1e-10 ( minvarfreq 1e-10). Bedtools intersect (version 2.17.0) was used to filter SNPs by known variants (by setting the wa parameter) and to filter and annotate SNPs according to location within a gene (by setting wa wb) (). We generated alternate FASTA sequences via GATK's FastaAlternateReferenceMaker (version 2.4.9) (). HapCUT (version 0.5) was used to phase SNPs (). In-house python scripts were used for all else not covered above. The scripts and data files required to recreate this analysis are available at https://github.com/d-quinn/bio_quinn2013. The sequences generated during this project have been submitted to the Sequence Read Archive and have the accession number SRP040244.
Aligning to a single referenceTo examine the effects of mapping bias, we used a published RNA-seq dataset from a cross between DGRP lines 362 and 765 for which the genomic sequences are available (). Reads were aligned to the D.melanogaster reference sequence using TopHat, and those that did not align uniquely to the genome were discarded. We identified candidate SNPs using VarScan mpileup2snp set with the extremely generous parameters listed earlier (which will have allowed many false-positive results), identifying any candidate SNP found in at least two supporting reads with average base quality 419. We also removed SNPs with more than two alleles, as SNPs were being called from a single individual so these represent errors. We then filtered SNPs according to a variable and fixed coverage cutoff. Where a gene has been sequenced to a high depth of coverage, it becomes increasingly likely that the same sequencing error will occur in multiple reads. To compensate for this, we required SNPs to have more supporting reads as the depth of coverage increased. We used a binomial distribution where the probability of an error in any one read was 1 in 100 (the expected rate with a phred score of 20). A threshold was set for each depth of coverage such that the probability of observing enough erroneous reads to exceed this threshold would be 50.0001, assuming every read had the lowest possible quality score (a phred score of 20). In addition to this variable coverage cutoff, we used a fixed cutoff, which eliminated SNPs at positions with fewer than 15 total reads. Furthermore, SNPs that were not found in known transcripts (those that did not intersect with genes in the GTF transcript annotation file) were discarded, as they are not relevant for measuring ASE. Finally, SNPs were filtered by a set of known variants, retaining only SNPs that have been previously reported (see Section 3).
Aligning to multiple referencesTo reduce mapping bias, we aligned reads to both the original reference genome as well as an alternate version that featured SNPs called from the RNA-seq data. The protocol was similar to that for aligning to a single reference, with the addition that the filtered SNPs identified from the initial alignment were then used to create an alternate reference sequence, using GATK's FastaAlternateReferenceMaker and an in-house python script to fix FASTA headers. FastaAlternateReferenceMaker replaces reference bases at variant positions with bases supplied by a file in variant call format (VCF). Raw reads were realigned to this alternate sequence, and SNPs were identified in the same manner as before. Finally, we combined unique reads from both alignments to get per-SNP ASE estimates. A flow chart summarizing these steps and some others explained later is shown in Supplementary.
Aligning to parental genomesWe used SNPs from the DGRP freeze 2 dataset to generate parental genomes for thedata. Specifically, SNPs in DGRP lines 362 and 765 were separately used as inputs for FastaAlternateReferenceMaker, yielding two separate parental genome proxies. Only homozygous SNPs were included, as the DGRP lines are highly inbred. We aligned the RNA-seq data to each parental genome, called SNPs (again, implementing a variable and fixed coverage cutoff) and calculated ASE values for each position called as a SNP in either of the parental lines. Unique reads from the two alignments were combined to get per-SNP estimates of ASE. We refer to this as our benchmark alignment, as it should produce the most accurate ASE estimates for the ideal case where both parental genome sequences are known.
Phasing SNPsTo phase SNPs, we used HapCUT, which uses a max-cut-based algorithm for haplotype assembly (). We input our set of filtered SNPs from the alignment, the corresponding alignment (BAM) file and the D.melanogaster reference sequence (in FASTA format) into HapCUT and used the output to create two VCF files with an in-house python script. The logic for the creation of the VCF files was as follows:(i) if a SNP in the original VCF (the set of filtered variants from mapping to a single genome) was homozygous (comprises all non-reference reads), the SNP was included in both VCF files; (ii) if a SNP was heterozygous (there were reference and non-reference reads) and phased, it was included in a single VCF along with the other SNPs on that haplotype; and (iii) heterozygous SNPs that were not phased were all placed into one of the VCFs. The resulting two VCFs were input into FastaAlternateReferenceMaker to create two alternate reference sequences. Reads were aligned to these separately, SNPs called and unique reads combined to get per-SNP estimates of ASE.
Combining SNPs by geneWe wrote a script to combine SNPs across a gene in such a way that reads spanning multiple SNPs are counted only once. As input, it takes two VCF files that have been intersected (using the-wa-wb parameters of Bedtools intersect) with a GTF as well as the corresponding BAM files used to call those variants. The script iterates through the VCF files and produces a list of SNPs for each gene. It then uses Pysam, a lightweight wrapper of the SAMtools C-API, to generate lists of read IDs for each state of each SNP. For instance, if a SNP on chromosome 2L has two states, A and G, representing the reference and non-reference bases, respectively, it will generate a list of read IDs that contain an A at that position and a list of reads IDs that contain G at that position, and it will repeat this for every SNP in the gene. Lists of reference and non-reference read IDs are concatenated, the duplicates are removed and the lengths are used as the new per-gene expression counts.
Removing conflictsWhen a single read contains multiple SNPs, then all the SNPs should assign the read to the same parent. Errors can therefore be detected when the SNPs conflict and assign the same read to different parents. On the first pass through our pipeline, we recorded both which reads were assigned to both parents and which SNPs were causing these conflicts. These reads and SNPs can be ignored on a second pass through the pipeline, producing a new set of per-gene estimates.
RESULTS AND DISCUSSION
Mapping: alignment to single referenceTo examine patterns of ASE, we aligned published RNA-seq data from the F1 progeny of a cross between two inbred D.melanogaster lines () to the published reference genome sequence, allowing up to two mismatches between each read and the genome (the default) [. The genomes of these two lines have been sequenced, so we called SNPs from the aligned reads but removed any SNPs missing from the genome sequences. In total, there were 29 999 SNPs in 5404 genes (of the 14 869 genes in the genome). With these SNPs, we were able to assess the contribution of mapping bias aloneindependent of SNP calling errorsto estimates of ASE. The mean proportion of reads carrying the reference allele of the SNPs was 0.535, much higher than the expected value of 0.5 (). The strength of this bias was strongly correlated with the density of SNPs (Supplementary), as expected if the bias is caused by SNPs introducing mismatches to the reference genome and preventing reads from mapping. In contrast, indels seem less important, as there was no difference in the strength of the bias between genes with or without indels (t = 0.10, df = 3564, P = 0.92).Because mapping biases are being caused by SNPs preventing the read from mapping, they are affected by the number of mismatches allowed between the read and reference genome during mapping. To investigate this, we reran the previous protocol with several different sets of TopHat parameters. We found that increasing the number of mismatches allowed in an aligned read (N) decreased the mapping bias substantially (and Supplementary). The potential cost of allowing more mismatches is that the reads might map to multiple locations in the genome, decreasing the number of uniquely mapped reads. As multiple mapping might differentially affect the two alleles of a gene, the removal of these reads could give a false signature of ASE. However, although the number of uniquely mapped reads increased as we allowed more mismatches, the number of multiply mapped reads remained fairly constant (). We also varied the maximum indel length allowed in an aligned read; however, this had relatively little effect on the reference bias or the number of mapped reads (). Altering other parameters had little effect, so default settings were used for these, we chose to allow up to five read-mismatches in future alignments and kept the allowed indel length at the default value of two. In the case of alignment to the published reference, the mean proportion of reads carrying the reference allele was 0.505 [(ii) and], with this bias affecting 1.5% of SNPs (51.5% of SNPs have more than half the reads being the reference allele). Although allowing 10 mismatches gave a value closer to 0.5, we reasoned that the gain was not substantial enough to warrant the reduced stringency, which could compromise the accuracy of the alignment. Others have demonstrated that accurate estimates of ASE can be obtained by aligning RNA-seq data to the genomes of the parents of the individual under study (). Using this technique, we found that the mean proportion of reads carrying the reference allele after aligning to the parental genomes was 0.504, slightly closer to 0.5 than the mean from our single alignment (0.505). Although these numbers are similar, when we compared bias among individual sites, it is apparent that there are many SNPs in the single alignment that remain biased toward the reference allele (). Thus, allowing multiple mismatches greatly reduces the bias toward the allele found in the reference genome, but does not eliminate it. The analysis to this point has used real RNA-seq data, so true ASE might affect our results. To check that this was not the case, we simulated data with no ASE and repeated our analysis. The overall pattern was extremely similar to the true data, with mapping to a single genome generating a false signal of ASE at some SNPs (, mean proportion reference mapping to reference genome is 0.503 compared with 0.501 when mapping to parental genomes). It is unclear why a small bias toward the reference remains even when aligning to the parental genomes. One possibility is that there is still a mapping bias because our parental genomes are incomplete. In particular, these genomes still have the reference state for indels. However, this can only be a partial explanation, as there is still a small bias for the simulated RNA-seq reads that lack any indels (), and the presence of indels is not correlated with the bias (see earlier text). Furthermore, any variants not included in the parental genomes are excluded from our analysis, so they will only create a systematic bias toward the reference allele at neighboring sites that were analyzed if they are in linkage disequilibrium. Alternatively, the remaining bias may result from errors in SNP calling rather than a failure to map reads.
Mapping: alignment to multiple referencesIn an effort to improve our estimates further, we aligned thedata to the published reference sequence and then to an alternate sequence featuring SNPs called from the RNA-seq data [. Thus, we generated an alternate reference sequence without having to sequence the genomes of the parents. Again, for both the alignment to the original reference, SNPs were filtered by those identified from the parental genomic sequences so that estimates of ASE would be independent of SNP calling errors. For (ii)(vii), we allowed five read-mismatches in the alignment, as this substantially reduced the reference allele bias. The DGRP was used to filter SNPs in (vi) and (vii) sequence and to the alternate sequence, we only analyzed homozygous SNPs found in the parental genomic sequences, allowing us to separate the contribution of mapping bias from errors in SNP calling. Initially, we did not phase the SNPs, so the alternate sequence is a mixture of SNPs identified in both genomes. The mean proportion of reads carrying the reference allele was 0.504 (), which is the same as when we aligned the reads to the parental genome sequences (our benchmark). Furthermore, the measures of ASE for individual SNPs were nearly identical to those obtained when we aligned to the parental genomes (Pearson's R 2 = 0.999,). In addition, coverage for SNPs from aligning to multiple reference sequences is nearly identical to that for the benchmark (Pearson's R 2 = 1.00;). This indicates that a virtually identical set of reads are mapped when aligning to multiple references generated from unphased SNPs as when the reads are mapped to the parental genomes. Overall, this represents a substantial improvement over the alignment to a single genome, with fewer SNPs exhibiting a reference bias (versus A) because of this approach allowing us to map reads that would otherwise be missing from the single alignment (versus F). A potential weakness with our protocol for aligning to two genomes is that we have no information concerning the chromosome on which each SNP is found (i.e. its phase). This means that the alternate genome sequence we generated from the unphased SNPs includes variants from both chromosomes, so sequence reads may still not be perfect matches to either of the genomes we are using. It should often be possible to accurately phase clusters of SNPs because of the co-occurrence of SNPs within the same read pairs (). We used HapCUT () to phase SNPs (restricted to SNPs found in the parental genomes as before) and generated two alternate genomes from these phased SNPs [(iv)] After aligning to these, we found that the mean proportion reference was 0.504, nearly identical to that of the unphased alignment. Plotting this against estimates from our benchmark revealed that phasing has little effect on ASE estimates (R 2 = 0.999, compareand D). The finding that generating alternative reference genomes using unphased SNPs performs as well as using phased SNPs is unexpected. Presumably this is because the large number of mismatches allowed when the reads are mapped circumvents any need for phasing. For a read not to map to both the reference and an unphased alternate genome, it must contain six mismatches to both genomes (there must be a cluster of 12 SNPs within the space of one read). Linkage disequilibrium between nearby SNPs will make this scenario even more uncommon, as reference and alternate alleles will tend to be found on the same reads.
SNP calling: using the RNA-seq dataIn the previous sections, we examined patterns of ASE using only SNPs found in the parental genomic sequences, which allowed us to isolate the effect of mapping bias from that of SNP calling errors. By altering our alignment parameters and aligning reads to multiple reference sequences, we were able to largely eliminate mapping bias. We next explored how errors in SNP calling can affect estimates of ASE and developed a strategy to reliably call SNPs from the RNA-seq data itself. To investigate how errors in SNP calling from RNA-seq data can bias estimates of ASE, we aligned thedataset to the published reference sequence as well as to an alternate reference generated using SNPs called from the RNA-seq data [. Again, SNPs were filtered by a fixed and variable coverage cutoff (see Section 2). However, unlike before, we did not remove SNPs that had not been found in the genome sequences of these lines. The errors in SNP calling were substantial. Because sequencing errors tend to occur at low frequency, they inflate the frequency of the reference allele in the same way as mapping biases. The mean proportion of reads carrying the reference allele was 0.517 (). The strategy we took to improve the quality of our SNP calls was to remove any SNPs that had not been previously reported in D.melanogaster. Initially, we filtered our SNP calls from the RNA-seq data by those found in the DGRP lines, a panel of highly inbred lines whose genomes have been sequenced [(vi. This resulted in a mean proportion reference of 0.510. This suggested that although this basic filtering is somewhat effective at removing errors, many still remain. The DGRP lines are highly inbred, so SNPs always called heterozygous are likely to be errors, and singletons may also be of lower quality. Therefore,we refined our criteria by keeping only SNPs that were called homozygous in two or more DGRP lines [(vii)], giving a mean proportion reference of 0.505, an estimate that is nearly identical to that from our benchmark (). We plotted estimates from variants filtered by SNPs called homozygous in two or more lines against those from the benchmark, which was based on aligning to and SNP calling from parental genome sequences. We found that the two datasets are similar (Pearson's R 2 = 0.999,). Comparing this with the plot shown inillustrates that filtering by SNPs called homozygous in two or more lines gives much the same results to filtering by SNPs called from the parental genomes alone. By relying on a high-quality database of known SNPs, we called SNPs using as little as 15X coverage with two reads supporting the variant. These fairly low coverage data appear to be sufficient, as there is no correlation between coverage and the reference bias, which can be used as a proxy for SNP calling errors (Supplementary). These analyses have used real data, which may be affected by factors such as true ASE or our benchmark having SNP calling errors. We therefore repeated the analysis using simulated data where these factors are controlled, and again found that SNPs can be reliably called from RNA-seq data (Figs. 4B versus 2C).
Per-gene ASE estimates: removing pseudo-replication and conflictsThus far, we have focused on per-SNP estimates of ASE, but most research questions are concerned with gene-level estimates of ASE. Gene-level expression could be calculated by simply adding up ASE estimates from each SNP in a gene. However, this method is problematic because it leads to pseudo-replication when a single read overlaps two or more SNPs. To avoid this, we combined reference and non-reference counts across the gene without counting a read more than once. Our technique relies on the data being accurately phased across the full length of the gene, so phasing using the sequences themselves may be unreliable. We suggest a simple alternative approach to phase the variants in Drosophila and other model organisms: if the genotype of interest is crossed to the homozygous strain used to generate the reference genome, then all the variants called are inherently phased. With this in mind, we generated a dataset composed of 100-bp Illumina paired-end reads from the F1 progeny of a cross between a haploid genome derived from a fly line collected in Innisfail, Australia,. The effect of aligning to different reference genomes on the bias toward the reference allele and the number of reads mapped. Panels A and B: There is a substantial bias toward the reference allele when mapping (A) real or (B) simulated data to the reference genome (Y axes) compared with mapping to the parental genomes (our benchmark, X axes) (Panel A: Pearson's R 2 = 0.993, Panel B: Pearson's R 2 = 0.972). Panels C and D: Aligning to genomes including SNPs called from RNA-seq data substantially improves estimates of allele-specific expression, regardless of whether SNPs are (C) unphased or (D) phased. In both cases, the proportion of the reference allele of SNPs is 0.504, and the correlation with the benchmark of aligning to the parental genomes is strong (Pearson's R 2 = 0.999). Panels E and F: Aligning to multiple reference sequences increases the number of mapped reads. The coverage of SNPs is shown from aligning reads to (E) the published reference genome and (F) both the published reference and an alternate reference generated including unphased SNPs called from the RNA-seq data. In both cases, the coverage is compared with our benchmark alignment to both parental genomic sequences. Shading indicates a greater density of superimposed points. Filtering out low-quality SNPs using a SNP database reduces bias. Reads were aligned to the published reference genome as well as to an alternate reference generated using SNPs called from the RNA-seq data. (A) Unfiltered SNPs have considerable bias (mean = 0.517), while (B) a substantial portion of the bias is removed by only retaining SNPs that were called homozygous in at least two DGRP lines (mean = 0.505). Arrows highlight portions of the distributions that change and the D.melanogaster y; cn bw sp stock sequenced for the reference genome (). As in the previous section, we aligned reads to the published reference as well as to an alternate reference made up of SNPs called from the RNA-seq data. Again, we filtered variants by a fixed and variable coverage filter and by those found homozygous in at least two DGRP lines. The proportion of read-pairs carrying the reference allele was 0.504 when the SNPs were analyzed independently and 0.503 when they were combined within each gene (). As this bias is slightly less than what we observed earlier using two DGRP lines (lines whose genome sequences are included in our database of high-quality SNPs), this suggests that our approach at SNP calling can be applied to cosmopolitan populations of Drosophila that have not been included in the reference database. With accurate phasing, read-pairs spanning multiple SNPs can be used to improve estimates further. Because one set of chromosomes in our dataset came from the Australian genome, whereas the other came from the reference genome, read-pairs should be assigned to only one genome. Of the 2 456 755 read-pairs spanning multiple SNPs, 99.7% were assigned to the same genome, whereas 0.3% were assigned to both genomes. Across SNPs, we found that 5% of 45 920 SNPs had a single conflicting read-pair, and 1.5% had greater than one conflicting read-pair.These conflicts indicate SNP calling or sequencing errors. If the conflict is caused by a sequencing error, the read should be excluded, but if it is caused by a SNP calling error, the SNP should be excluded. We found that SNPs with fewer than five conflicting read-pairs  which represented the grand majority of SNPs with conflicts ()had close to the expected distribution of proportion of reference read pairs (and C). This suggests that ASE estimates for most of these SNPs are nearly correct. We reasoned that the majority of SNPs with a small number of conflicts were not called in error, and that the conflict was instead because of sequencing error. In contrast, those with five or more conflicts did not have the expected distribution (and C), and therefore, many of these might be SNP calling errors. The most conservative course of action would be to remove all SNPs with conflicts, but this would involve discarding a large amount of data (Supplementary). With this in mind, we removed SNPs that contained three or more conflicts, and removed read-pairs that conflicted with one or two SNPs. The mean proportion of reference read-pairs did not change appreciably after removing conflicting SNPs and read-pairs. However, of the 2 384 931 reads that spanned multiple SNPs, 99.9% were now assigned to the same genome. Furthermore, the total number of conflicting SNPs decreased from 7 to 3.5%, and no SNPs exhibited more than two conflicting read-pairs (SNPs with two conflicts represented only 0.3% of the 44 643 total SNPs). Our decision to remove only SNPs with three or more conflicting reads was driven by our desire to retain most of the useful. No bias was observed when applying our pipeline to RNA-seq data generated from a cross between the D.melanogaster reference line and a line collected in Australia. The data were aligned to multiple references featuring SNPs called from the RNA-seq data and filtered by high-quality DGRP SNPs [scenario (vii) in. Proportion reference allele distribution across (A) SNPs (mean = 0.504) and (B) across genes (mean = 0.503)data, and this should be adjusted according to the experimental design and goals of a given project. For obtaining the most accurate estimates, we suggest removing all SNPs that contain a read-pair assigned to multiple genomes. For retaining more data, there is little bias if as many as five conflicts are allowed ().
CONCLUSIONWe have developed a protocol for obtaining accurate per-SNP and per-gene estimates of ASE from RNA-seq data. The main advantage of this protocol is that it does not require parental genomic sequences; SNPs used to get allele counts are called directly from the RNA-seq data. This can significantly reduce the time and cost associated with measuring ASE. Unexpectedly, it does not appear that phased data are required for getting unbiased per-SNP measures of ASE using our datasets. We found that our estimates were nearly the same with and without phasing. However, phased data are required for combining SNPs to obtain per-gene measures of ASE, and this also allows us to remove unreliable reads and SNPs. We show that the data can be phased if genotype of interest is crossed to the homozygous strain used to generate the reference genome, although this will only be possible in Drosophila and other model organisms. The main drawback to our method is that it requires knowledge of variation in the population of the organism of study, as this allows filtering to remove SNP calling errors. In Drosophila this data is readily available. As new sequencing technologies mean that comprehensive SNP databases are available from increasing numbers of species, this approach will become viable in even more species, especially those with short generations.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
A.Quinn et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Estimates of allele-specific expression at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
