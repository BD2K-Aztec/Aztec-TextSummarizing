Motivation: In high-dimensional testing problems p 0 , the proportion of null hypotheses that are true is an important parameter. For discrete test statistics, the P values come from a discrete distribution with finite support and the null distribution may depend on an ancillary statistic such as a table margin that varies among the test statistics. Methods for estimating p 0 developed for continuous test statistics, which depend on a uniform or identical null distribution of P values, may not perform well when applied to discrete testing problems. Results: This article introduces a number of p 0 estimators, the regression and 'T' methods that perform well with discrete test statistics and also assesses how well methods developed for or adapted from continuous tests perform with discrete tests. We demonstrate the usefulness of these estimators in the analysis of high-throughput biological RNA-seq and single-nucleotide polymorphism data.
IntroductionIn multiple testing inferential problems, we want to select which among a large number of hypotheses are true. The proportion of truly null hypotheses, p 0 , plays a critical role in adjusting for multiple testing, gives a benchmark for the number of statistically significant tests which should be discovered and is an important measure of effect size (). We assume that m null hypotheses, H 01 ;. .. .. . ; H 0m , are being tested corresponding to m parameters or features. The ith hypothesis is associated with an observed test statistic X i and observed P value p i. A number of methods are available for estimating p 0 when X i and hence p i are continuous (). These methods rely on modeling the mixture distribution arising from the mix of truly null and non-null tests using various parametric and nonparametric approaches (). Let N be the set fijH i0 is trueg. In many cases with continuous response, such as gene expression microarray studies and pixel-wise intensity analysis of images, it is reasonable to believe that the distribution of X i is the same for all i 2 N for example, we might perform a t-test for each feature and expect the null distribution to be Student's t. Alternatively, we can use p i as the test statistic, in which case the null distribution is Uniform (0,1). Although it is not known which hypotheses are in N , the empirical distribution of the test statistics is a mixture of m 0 observations from the null and m 1  m  m 0 observations from an alternative distribution, so that deviations of the empirical distribution from the known null can be used to estimate p 0 (). For the discrete case, the situation is more complicated. Each X i can take on only a finite number of values, which often depend on an ancillary statistic which varies with i. For example, for Fisher's exact test and other tests of independence in two-way tables, the ancillary is a table margin. As a result, even for i 2 N , the distributionwith i and the empirical distribution of the observed statistics is a mixture. For example,displays P values from simulated gene expression data with p 0  0:8. For each feature (gene), there are two treatments and the null hypothesis is no difference in mean expression level. The P values arising from the null distribution are displayed in gray and the P values arising from the non-null features are stacked in white. The two histograms look very different. In, the P values come from two-sample t-tests, where 20% of the P values come from various non-central t-distributions. Note the relative uniformity of the null (gray) P values versus the non-null (white) P values, which are skewed toward small values. In contrast,displays P values coming from Fisher's exact tests, where 20% of the P values come from various non-central hypergeometric distributions. In this case, both the null and non-null P values are highly non-uniform and there is a non-zero probability of yielding a P value equal to 1 under the null and alternative distributions. The differences between continuous and discrete tests are apparent with real data.shows P values from real studies:differential expression analysis of the primate liver study using RNA-seq technology with three biological replicates (), used in Section 3.1 andthe bovine iron single-nucleotide polymorphism (SNP) study (), used in Section 3.2. In this article, we propose new methods for estimating p 0 for discrete tests and compare them to some popular methods developed for continuous data. We also apply these methods to determine the proportion of differentially expressing genes in primate livers and for selecting SNPs associated with bovine muscular iron levels.
BackgroundWe assume that after performing the m tests and observing test statistics X 1    X m , we decide whether to reject each null hypothesis. In a slight abuse of notation, we will write H 0i  1 when the ith null hypothesis is true, and H 0i  0 when it is false. The number of true null hypotheses is m 0  P m i1 H 0i and p 0  m 0 =m. In many testing situations, X i jH 0i  1 are identically distributed. In this case, we denote the null density (or mass) function of X i jH 0i  1 as f 0 x. In other cases, X i jH 0i  1 depends on an ancillary statistic A i , which is observable and independent of the value of H 0i. In this case, the conditional null density function is f x i jH 0i  1; A i  a i   f i0 x and we can write the null distribution as f 0 x  P m i1 f i0 xProbA i  a i . The alternative distribution of X i jH 0i  0 usually depends on i. However, in the same spirit, we will write f 1 x to mean the mixture distribution of alternatives. Then, we can consider the marginal density of X:This representation of the marginal density is central to estimation of p 0 using the m observed values of the test statistic.
Continuous testsWhen the test statistic is continuous, it is common to assume that X i jH 0i  1 are identically distributed. A number of estimators of p 0 are available but we will focus on three popular estimators that all use the P value as the test statistic. In this case, f 0 P  1 for 0 P 1. We describe the estimators and also give some heuristics about their use with discrete P values.
Storey's methodStorey (2002) is one of the most popular methods for estimating p 0 and has been shown to estimate p 0 well for continuous test statistics. The estimator is: ^ p 0 k  #fP i jP i > kg m1  kwhere k 2 0; 1 is a tuning parameter and #S is the number of elements in set S. Although k is sometimes selected adaptively from the data, we used k  0:5. Note that if all the tests are null, E#fP i jP i > kg  m1  k. The absolute deviance from true p 0 in the Storey estimator is larger for smaller values of p 0 unless there is perfect power to detect the non-null hypotheses at level k. As well the pile-up of P values at P  1 for discrete tests has the effect of creating further over-estimation and can yield ^ p 0 k > 1. We actually use min 1; ^ p 0 k as the estimator where min a; b is the minimum of a and b. 2.1.2 Nettleton's methodpresents an algorithm for estimating p 0 by estimating the proportion of observed P values that follow the uniform distribution. The idea is to create bins in the interval 0; 1 and use the excess of expected versus observed P values in those bins to iteratively update the estimate of m 0. The algorithm is provided in detail in. For the implementation of Nettleton's method, we used the R function from Nettleton's website, http://www.public.iastate.edu/ $dnett/microarray/multtest.txt. The number of bins is a tuning parameter. In our simulation studies, we found that partitioning the P values into B  25 bins gave good results. Note that this method relies on the heuristic that the P values of the hypotheses i 6 2 N should be skewed toward zero. For discrete data, the pile-up of P values at P  1 depletes the other bins of the histogram. Since the algorithm utilizes the bins with P close to zero, again it seems thatthere may be over-estimation of p 0. On the other hand, since the P value histogram can be erratic with peaks in the center, it is not as clear whether Nettleton's method is prone to inaccuracy, and if it is, whether it will over-or under-estimate p 0 .
Pounds and Cheng methodPounds and Cheng (2006) proposes an estimator of p 0 when the test statistics are continuous and two sided. Their estimator can be summarized as ^ p 0  min 1; 2p where p  1 m P m i1 p i. This estimator tends to over-estimate p 0, but the difference is small when Pf 1 p is small, that is when f 1 p has most of its mass at small P. Like the Storey method, the difference is also smaller when p 0 is close to 1. They also proposed this estimator for discrete two-sided P values.
Discrete testsEquation (1) readily creates heuristics for estimating p 0 for continuous tests because of the assumption that X i ; i 2 N is an i.i.d. sample from f 0. In most discrete testing situations, the X i 's and the P values have null and alternative distributions that depend on the realization of the ancillary statistic A i. We will continue to use p i as our test statistic as it is a transformation of X i which is on a convenient scale for plotting. The achievable values of P under the alternative distribution are a subset of those achievable under the null. Usually, this will include mass at P  1 albeit with lower probability than under the null hypothesis. Hence, even if none of the hypotheses are true, we expect some mass at P  1, that is f 1 1 > 0. Since the number of achievable P values is finite, for each value of A i, there is a minimum achievable P value. For example, for Fisher's exact test for 2  2 tables, an ancillary is A i, the total of the first row. If A i  1, the minimum and maximum P value from Fisher's exact test is P  1, while for A i  2, if the column totals are equal, the maximum is P  1 and the minimum is P  0.5. For A i  1 or 2 we can never reject the null hypothesis. For discrete tests, the power depends on the ancillary statistic, and in many situations, the region around P  0 is depleted compared with the Uniform(0,1) distribution, even when p 0 < 1, and regions in the middle of the (0, 1) interval can have greatly increased mass. For simulation studies, we have considered A i to be random and generated new values with each round of simulation. However, for estimation, we condition on the observed values of A i in each realization. We consider several methods for estimating p 0 each of which takes advantage of the observed values of the ancillary statistic. We assume that p 0 does not depend on the ancillary, which has d unique observed values A 1 ; A 2 ;. .. ; A d each corresponding to a known null distribution f 01 ; f 02 ;. .. ; f 0d respectively. Each null distribution f 0j has a finite set of achievable P values S j  S j1 ; S j2 ;. .. ; S jTj   with S j1 < S j2 <    < S jTj  1 and with corresponding probabilities / 0j1 ; / 0j2 ;. .. ; / 0jTj. Note that set S j is the support of f 0j , with / 0j1  S j1 and / 0jk  S jk  S j;k1 for 2 k T j. The hypotheses are partitioned into sets, so that if the null distribution of the ith P value is known to be f 0j , then the corresponding support is S j. The alternative distributions have the same support but unknown probabilities.
Regression methodA new method proposed by, the regression method is applicable when m is large enough, so that mProbA i  A j  > 1 for at least one ancillary statistic with at least three achievable P values. Then we have Prob P i  S jt jA i  A j ; H 0i  1    / 0jt , which is known. When the null hypothesis is false, we denote the P value mass function as Prob P i  S jt jA i  A j ; H 0i  0    / 1jt where the probabilities / 1jt come from an unknown mixture of alternatives with A i  A j. We assume that the distribution of P i  S jt jA i  A j ; H 0i  0 is stochastically smaller than the distribution of P i  S jt jA i  A j ; H 0i  1. The alternative distribution of P i jH 0i  0 usually depends on i, but continuing spirit of Equation 1, we will write / 1jt to mean the mixture distribution of alternatives:When the set D j  H 0i : A i  A j   is sufficiently large, / jt can be estimated from the data. From Equation (3), ProbP i  S jt jA i  A j  is an approximately linear function of / 0jt , with slope p 0 (). Of the M j hypotheses in D j , we observe that K jt of the hypotheses have P value S jt, so thatwhere M j is the cardinality of set D j and K jt is the number of hypotheses in D j that have P value S jt. We know that E ^ / jt   / jt  p 0 / 0jt 1  p 0 / 1jt and that / 0jt is known. We regress ^ / jt on / 0jt. The slope is an estimator of p 0 .illustrates the positive linear relationship between ^ / jt and / 0jt. As p 0 increases, the relationship gets stronger: for random samples of the RNA-2, m  10 000 data of Section 4.1, the correlation increases from 0.51 for p 0  0:1 to 0.97 for p 0  1. The cluster of points near the origin for low values of p 0 due to the non-null distributions increases the variance of the slope and degrades the performance. Any consistent estimator of the slope is a suitable plug-in estimate in our calculations. We use ordinary least squares. The results in Section 3 of Eicker's paper () prove the consistency of the estimated slope. To obtain estimates ^ / jt , we need M j to be sufficiently large. In our simulation study, we arbitrarily set a lower bound and used only the sets D j with M j ! 10.
Remark 1:Since ^ b, the estimate of the slope, can be <0 or >1, we truncate ^ p 0 to the interval.
Bancroft methodThe method developed byis an adaptation of Nettleton's method to discrete tests. Nettleton's method is applied to each of the d sets of P values corresponding to the d unique null distributions, f 01 ; f 02 ;. .. ; f 0d to come up with an estimate of m 0j , the number of tests corresponding to true null hypotheses in set D j using the achievable P values as the 'bins'. Note that the initial estimate of m 0j would be M j , the total number of tests in D j .Then, the estimate of p 0 becomesThis estimator can be computationally intense as m, the total number of hypotheses, grows. Additionally, when there exist unique distributions with relatively large number of bins (support values) compared with the number of P values that follow that distribution, the estimator will be larger than the true p 0 , especially when very few observed P values fall into the leftmost bins.
Remark 2:Due to the relative computational intensity of Bancroft's algorithm, for our simulations, we modified the method: If the minimum expected cell count for a table (distribution) is three or fewer, we utilize this discrete method. If all expected cell counts are at least 4, we assume uniformity and combine the P values of those distributions into a single set and utilize Nettleton's continuous method. For example, if d disc of the d unique distributions have a minimum expected cell count of three or fewer, then there will be d disc  1 total estimators of the number of true null hypothesis tests, which are then summed and divided by m to obtain the estimator of p 0 for that simulation. The algorithm is provided in the Supplementary Materials.
T methodsWhen S j is small, f 0j yields a component of the null distribution that is far from uniform. The corresponding values of the ancillary statistic typically yield tests with zero power regardless of the effect size, because the smallest achievable P value is larger than the boundary of typical rejection regions, say P < 0.05 or P < 0.01.noted that for improving the power of multiple comparisons adjustments, tests with zero power should be filtered out. We introduce methods that filter tests with zero power and denote them as 'T' methods. Filtering out zero power tests improves the uniformity of the P values. This is particularly effective when the distribution of the ancillary is highly skewed toward small values. For RNA-seq data, the ancillary is typically the total reads per feature, whereas for SNPs, it is the number of individuals with the rare variant. The ancillary distribution is usually very skewed with most features having small values. Filtering rare RNA-seq features and SNPs dramatically reduces the peak at P  1, as well as intermediate peaks at P values associated with values of the small ancillary statistics. Let A be the set of null hypotheses for which the ancillary statistic passes the power threshold. Since our a priori assumption is that the ancillary statistic A i is independent of whether or not H 0i  1, the proportion of truly null tests in A is p 0 and applying an estimator restricted to A does not bias the estimate, although it does decrease the number of test statistics. We denote the method of restricting an estimator M to the (possibly random) set A as an M  T estimator. In our simulation study, we use the T estimator for each of the Storey, Pounds and Nettleton estimators.
Application to real datasets
Application of methods to a primate RNA-seq datasetThe estimation methods were applied to RNA-seq data obtained from gene expression levels in livers from three primate species (human, chimpanzee and Rhesus monkey), using three male and three female samples from each species (GEO dataset GSE17274) (). We considered two comparisons: male humans versus male chimpanzees and male humans versus male Rhesus monkeys. On the basis of the evolutionary divergence, we expect humans to be more similar to chimpanzees than to Rhesus monkeys and hence expect a larger value for p 0 for this comparison. Since the data include biological replication, which is likely to induce extra-Poisson variation, we fitted a Negative Binomial Model using the R package edgeR (). edgeR uses a sophisticated method of dispersion shrinkage, which increases the power of the tests by using information from all the tests. Because of this, it is not clear how to compute an ancillary statistic to use for the regression and Bancroft methods. We used only procedures developed for continuous tests and their corresponding T-methods. Since biological variation tends to induce over-dispersion in the counts, tests based on a Poisson distribution are anti-conservative. Therefore, removing tests that have zero power under the Poisson assumption will be conservative, while still improving the estimator. Therefore, we remove genes from the analysis that have fewer than six reads summed over all the samples. Even for the 'T' methods, however, there is some question about how to proceed, because the dispersion shrinkage uses all the genes. Therefore, genes removed due to lack of power need to be removed from the entire analysis, not just from the p 0 estimation stage. We take a compromise stance. When using 'T' methods, we first use all the genes that have total reads above the threshold, even if those reads are scattered over multiple treatments. We then do the pairwise comparison using only those genes that are above a more conservative threshold based on only the samples involved in the comparison. A total of 20 689 features were used in the study, but 2803 were not detected in any sample. The first level of filtering, in which we retained only genes with at least 6 reads over all 18 samples, removes 5273 genes from the analysis. The second level of filtering, in which we conservatively retained genes with at least 4 reads in the 6 samples used in each the pairwise comparison, removed a further 860 genes from the comparison with chimpanzee and 864 from the comparison with Rhesus monkey. It is common practice to remove low expressing genes from the differential expression analysis. Using the recommendation in, genes with fewer than 25 reads would be removedfor both comparisons the smallest P value among these genes is <0.00005. Many of these genes could be detected as non-null if left in the analysis. The estimation of p 0 for each comparison is presented in. We see firstly that as expected from evolutionary history, all the methods estimate a higher value of p 0 for the comparison of humans versus chimpanzee than versus Rhesus monkeys. We also see that for each method, the corresponding 'T' method estimates a lower value of p 0 than the unfiltered method. This is expected both by theory and our simulation results. Another interesting thing to notice, however, is that Nettleton's method gives a much lower estimate of p 0 than the other two methods but that Nettleton's 'T' method is quite similar to the other two 'T' methods.
Application of methods to a bovine SNP datasetSamples of muscle tissue from 2285 Angus cattle were obtained for genotyping on 53 367 SNPs. Iron concentration in the tissue was also measured. The study and results for the entire sample are described in. One hundred samples were selected at random from the 2285 to use as an example. Animals with more than 5000 missing SNPs and SNPs with more than 20 missing values or just one genotype were removed. The remaining 95 samples were divided into high-and low-iron groups, splitting at the median, giving 47 samples with iron level above the median and 48 below. For each of the 48 816 SNPs, we computed Fisher's exact test. Because of missing values, it was not possible to find enough tables with the same margin to use the regression or Bancroft methods. Tables for which the sum of the two smallest margins is <5 have zero power at critical value 0.05 when there are no missing values for most animals. This increases mildly for SNPs with many missing values, but for simplicity we used this cut-off for filtering throughout for the 'T' methods. P values for the detected SNPs are displayed in. Filtering removes much of the mass at P  1 and at P  0.5. The estimated values of p 0 are listed in. As in other analyses, the estimate of p 0 is always lower for the 'T' methods. However, despite the dramatic change in the height of the histogram at P  1, the filtered and unfiltered methods do not vary as dramatically as for the RNA-seq data. It seems reasonable to estimate p 0 at around 80% for these data.
Simulation studiesMuch of the work in multiple testing since the seminal paper byhas been motivated by problems in high-throughput biology, in which tens or hundreds of thousands of biological features (mRNAs, proteins and SNPs) are measured simultaneously. Typical questions of interest are whether there are quantitative differences among two or more conditions. We focus on two types of study in which the response for each variable is a count: RNA-seq data for gene expression and SNP data for genotype association. In this article, we focus on discrete data with just two conditions (e.g. the treatment and control scenario). For the simulation studies, we generated data from two RNAseq scenarios without biological replication (RNA-seq studies with biological replication was discussed in the real data example) and two SNP scenarios. For each configuration of each type of data, we generated 1000 datasets for both m  1000 and 10 000 hypotheses. The proportion of nulls used in the simulations included 0:10; 0:20;. .. ; 0:90; 0:95; 1:00. The algorithms for generating the simulation data are in the Supplementary Materials. For both types of data, we will focus on the hypothesis that for each feature the mean frequency is the same for the treatment and control. We use Fisher's exact test as the test statistic, although the chi-squared test could also be used when the table entries are sufficiently large. Our objective is to estimate p 0 , and we compare eight estimators: (i) Nettleton (ii) Storey (iii) Pounds (iv) Nettleton-T (v) Storey-T (vi) Pounds-T (vii) Regression and (viii) Modified Bancroft and Nettleton.
Simulated RNA dataThe simulated RNA-seq data were based on the real dataset analyzed in Section 3.1. We use a discretized log-Normal(4,2) in condition 'RNA-1' and a discretized log-Normal(3,2) in condition 'RNA-2'. The latter distribution produces a slightly larger number of genes with small total counts. In the main simulation study, the features were simulated independently. In an additional set of simulations suggested by a referee, we generated the features in correlated clusters. An example of data for the ith feature is presented in. N, the total count in the two samples, is typically in the tens of millions. The column totals N T and N C are the same for each feature but differ from each other. The ancillary statistic is the total of the first row, A i  n i .
Results of RNA-seq simulationsTo investigate the performance of the eight methods in estimating p 0 , we obtained the distribution of ^ p 0 for each data configuration. The simulation results are presented in. Because overestimation is generally considered a less serious error than underestimation, the 25th percentile of the simulations is shown. The plots for m  1000 and m  10 000 are quite similar except that the under-estimation of the Nettleton methods for large p 0 is more pronounced for smaller m. We show only the results for m  10 000.
Discussion of the results of RNA-seq simulationsAll the methods over-estimate for small values of p 0. The regression and Nettleton-T methods have the smallest deviation from p 0 , especially for large values of p 0 , whereas Pounds-T and Storey-T have quite similar performance to the regression method for small p 0 but over-estimate for large p 0. The variances of the estimators are not shown, but they are quite similar except near p 0  1 where the truncation of the more positively deviated estimators squeezes them to 1.0. For all combinations of simulation conditions and m, Pounds method produces the highest mean estimate of p 0 and the NettletonT produces the lowest. The Nettleton, Nettleton-T and Modified Bancroft/Nettleton methods can under-estimate more egregiously, especially for smaller values of m (not shown), and hence cannot be recommended. Of the remaining methods, all over-estimate for p 0 < 0:9. This is not surprising: first, we have already seen that Pounds' and Storey's methods have intrinsic positive deviation not removed by filtering out the zero-power tests. Pounds' and Storey's methods are highly correlated, with even higher correlation after filtering but are less correlated with the regression method.Estimation of the proportion of true null hypotheses
Simulated SNP dataThe simulations for the SNP data are based on a random sample of 100 animals from the bovine SNP dataset () discussed in Section 3.2. Linkage disequilibrium was induced by sampling in sets of five tables. For the simulated data, we considered two scenarios: one with 50 animals in each of the treatment and control groups, and one with 20 animals in the treatment group and 80 in the control group. The data for a feature are summarized as a count of individuals for each genotype for each treatment as in. The association between genotype and treatment is tested using a Fisher's exact test or chi-squared test for each SNP.
Results of SNP simulationsTo investigate the performance of the eight methods in estimating p 0 , we obtained the distribution of ^ p 0 for each data configuration. The simulation results are presented in. Because overestimation is generally considered a less serious error than underestimation, the 25th percentile of the simulations is shown. The plots for m  1000 and m  10 000 are quite similar except for the regression method. The regression method performs very poorly for m  1000, possibly because there are too few tables with the same margins. We show only the results for m  10 000.
Discussion of the results of SNP simulationsThe performance of the eight estimators in the SNP data varied dramatically, especially considering their relatively comparable efficacy in the RNA-seq data. We see that all methods generally over-estimate until p 0 is close to 1, particularly when the sample sizes for the two conditions are very unequal. Of these, the Modified Bancroft/ Nettleton method has the largest absolute difference from p 0. Though not shown here, the regression method did not perform as consistently as the others when the number of tests was m  1000. Among the methods considered, Pounds, Storey and Nettleton, along with their 'T' methods, have the best performance and are very similar.
DiscussionThere is no clear 'winner' among the p 0 estimators. In part, this is because discrete tests for count data become closer to uniform as the size of the counts increase.The regression method requires computing f 0d , the null distribution conditional on the observed values of the ancillary statistic A d for each d. These null distributions have more support points for larger values of A d , adding to the computational burden while providing fewer observations for computing ^ / jt. As well, it may be difficult to compute ^ / jt in studies in which the number of different values of the ancillary is large.is also very computationally complex as the number of different null distributions increases. Thus, it also is not an ideal candidate when there is a large number of unique ancillary statistics. Finally, these methods do not extend readily to continuous tests. In contrast, the 'T' methods naturally adapt to higher counts because the filtered features are those with small counts. Hence, as frequencies increase and the P values are closer to continuous, fewer features are filtered and the 'T' method is closer to the continuous method on which it is based. The 'T' methods also adapt naturally to missing datafeatures with missing data are naturally those with smaller counts. As well, in complex studies such as genome-wide association studies with continuous response or RNA-seq studies with biological replication, it is still reasonable to assume that features with small counts will be associated with very low power tests. Hence, the 'T' methods are readily implemented. For these reasons, we recommend the use of 'T' methods except in simple studies with multiple tests with the same ancillary statistic, for which the regression method may be better. Of the three 'T' methods tested here, Storey-T appears to be most resilient to different types of data, ancillary distributions and sample sizes. It has become common practice in RNA-seq studies to filter out genes with low total counts; generally, the cut-off is selected arbitrarily. For example, the edgeR software () recommends the total for genes retained should be about 100 reads per million detected, while the primate liver paper () dropped genes with median count per sample of 1 or less. The 'T' method suggests a more principled approachselect the largest P value for which the investigator would be willing to declare significance and filter out features for which the test statistic has minimum achievable P value which is higher. For 2  2 tables with large margins in one direction such as those generated by RNA-seq studies, a simple rule of thumb is that the test has zero power at P 0:05 when the minimum margin (total reads for a gene) is <6. For 2  3 tables with large margins in one direction such as those generated by genome-wide association studies using SNPs, a simple rule of thumb is that the test has zero power if the sum of the two smallest margins is <5. In many scenarios, tests are not independent. For the RNA-seq scenario, the primary simulation study was done using independently generated features. We also simulated 1000 runs of RNA-seq. The 25th percentile of ^ p0 for different estimators for the SNP simulations. (a) p 0 estimates for SNP study with 50 controls 50 treated, m  10 000. (b) p 0 estimates for SNP study with 80 controls 20 treated, m  10 000 data with correlated test statistics and m  1000 tests. The algorithm used to simulate the data is provided in the Supplementary Materials. We found little difference in the performance of the p 0 estimators between the independent tests and the dependent tests; the 'T' methods still performed well overall. For the SNP scenario, the SNPs were simulated in small correlated clusters in the primary study. The results suggest that the p 0 estimators do not require independence of the tests to work well.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Conclusion For discrete tests, the null distribution of the P values is discrete, and thus, estimates of p 0 need to take this into account. For multiple comparisons methods or false discovery rate estimators, it is clear that the statistical significance calls need be adjusted only for tests that have sufficient power to be significant. Hence, the 'T' methods provide the most suitable estimates of p 0 because they estimate the proportion of truly null hypotheses among the hypotheses for which significance could be achieved in the study at hand. One question not addressed by the analysis is the interpretation of p 0. On occasion, p 0 is used as a measure of overall signal strength-for example, Zhang et al. (2005) used the estimated number of differentially expressed genes as an estimate of the proportion of genes involved in organ differentiation. Since genes not expressing in the organs in question cannot be involved in organ differentiation, estimates of p 0 probably should include these nonexpressing genes among the null hypotheses. Similarly, SNPs that exhibit no variation in the samples clearly cannot be related to differences among the phenotypes under study. On the other hand, the very low expressing genes or genotypes present at very low frequency might be non-null, even though the low detection levels in the study do not allow enough power to determine this. For this type of study, it is very important to distinguish among those hypotheses for which the null may be true trivially (through a response of zero under all treatments) and those for which even the most extreme observed differences in response do not provide sufficient power to distinguish between the null and alternative hypotheses.
