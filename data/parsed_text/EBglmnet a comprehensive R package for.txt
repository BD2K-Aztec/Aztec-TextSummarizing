EBglmnet is an R package implementing empirical Bayesian method with both lasso (EBlasso) and elastic net (EBEN) priors for generalized linear models. In our previous studies, both EBlasso and EBEN outperformed other state-of-the-art methods such as lasso and elastic net in inferring sparse genotype and phenotype associations, in which the number of covariates is typically much larger than the sample size. While high density genetic markers can be easily obtained nowadays in genetics and population analysis thanks to the advancements in molecular high throughput technologies, EBglmnet will be a very useful tool for statistical modeling in this area. Availability and implementation: EBglmnet package is freely available from the R archive CRAN (http://cran.r-project.org/).
IntroductionIn areas such as multiple quantitative trait locus (QTL) mapping and pathway-based genome-wide association studies (GWAS), high density gnomic markers can be obtained easily as technologies advanced in molecular genotyping. Including all marker effects in a single regression model leads to a large number of model variables, typically much larger than the sample size. Traditional regression methods failed when p ) n, where p is the number of model variables, and n is the sample size. We recently developed an efficient empirical Bayesian method with lasso (EBlasso) () and elastic net (EBEN) priors () for variable selection and effect estimation. EBlasso has two sets of hierarchical priors (EBlasso-NE: normal and exponential hierarchical prior; EBlasso-NEG: normal, exponential and gamma hierarchical prior) enforcing different levels of shrinkage to produce a sparse model; and EBEN encourages a grouping effect while inferring a sparse model, which is able to select a group of highly correlated variables when EBlasso fails. Comprehensive simulation and real data analysis in QTL mapping () and pathway-based GWAS () demonstrated that EBlasso and EBEN outperformed other state-ofthe-art algorithms such as lasso () and elastic net () in term of power of detecting true effects (PD), false discovery rate (FDR), as well as detecting a group of highly correlated effects. The aforementioned studies implemented those methods separately either in MATLAB or R, and were not available for different generalized linear regression models (GLMs). In this paper, we developed a cross-platform software package EBglmnet, with implementation of both Gaussian and binomial models for all methods. Core algorithms in the software are programmed in efficient C/C  with user-friendly R interface. Comparing to the original implementation, computational speed via EBglmnet is very fast thanks to the basic linear algebra subprograms (BLAS) and linear algebra package (LAPACK) () utilized by the package.
MethodsLet us consider using a GLM for variable selection, g  lI  Xb;where X an n  p matrix containing p variables for n samples with p being allowed to be ) n, g is an n 1 linear predictor and is related to an n 1 outcome variable y through a link function g: Ey z X  g 1 g  g 1 lI  Xb, and b is a p 1 vector capturing the corresponding effects. Based on the model assumptions, the distribution of y depends on the linear predictor lI  Xb, and in some cases, a dispersion parameter e. For example, in our previous studies of multiple QTL mapping, where y is the quantitative traits, (1) corresponds to the linear regression model:and e can be modelled by an independent identical Gaussian distribution with zero-mean and covariance r 2 0 I; In the example of pathway-based GWAS where y indicates the binary outcome of disease status for the n samples, y is linked to (1) via a logit function:where p i  Pry i  1, and g i  l  x i b is the linear predictor for the ith sample. Based on the above GLMs, both EBlasso and EBEN assign 'peak zero and flat tails' prior distributions to b, which have a large proportion of the probability mass around zero while still allowing a small decay rate at the two tails (). For example, EBlasso-NE employs a two-level hierarchical prior distribution: at the first level, b j follows an independent normal distribution with mean zero and unknown variance r 2 j : b j $ N0; r 2 j , j  1, ., p. At the second level, r 2 j follows an independent exponential distribution with a common parameter k:,. . ., p. Then the empirical Bayesian approach employs a coordinate ascent method to find b r 2 j , the estimate of r 2 j , that maximizes the marginal likelihood function of r 2 j. In the iterative process, many r 2 j , or equivalent b j are shrunk to exact zero, and the posterior mean and covariance for the non-zero coefficients b b are obtained through maximizing the marginal posterior of b with the given b r 2 j , j  1,. . ., p. In EBglmnet, k controls the degree of decay rate at the two tails (degree of shrinkage) and is determined via cross validation (CV). More details of the methods and prior setups for EBgmnet can be found in the package documentation and the references therein.
EBlasso-NEG methodWe previously reported a powerful EBlasso method using normal, exponential and gamma hierarchical prior (NEG) with both multiple linear regression model and logistic regression model, and demonstrated that it outperformed other state-of-the-art algorithms in term of PD and FDR, such as lasso (), HyperLasso (), BhGLM (), EB method (), as well as the Relevant Vector Machine (RVM) (). The NEG prior enforces a strong degree of variable shrinkage, and is able to handle a model with millions of effects as demonstrated in our whole-genome QTL mapping using the linear regression model () and pathwaybased GWAS with the logistic regression model (). A unique feature for this prior is that when genetic interactions are considered, a group EBlasso method is available to apply a higher degree of shrinkage on the interaction effects. In EBglmnet, a group parameter in the function is available to turn on this feature.
EBlasso-NE and the EBEN methodBased on the NEG prior, a two level normal and exponential hierarchical prior (NE) is also developed for the logistic regression model in our previous study (). With only first two-level of the hierarchical NEG prior, EBlasso-NE typically selects more non-zero effects, and results in a less sparse model. Though the original algorithm was developed for logistic regression model, we further implements the NE prior with multiple linear regression model in EBglmnet. While EBlasso typically selects one variable out of a group of highly correlated variables, we recent derived a novel elastic net prior that is able to encourage a strong grouping effect similar to that of elastic net, but under the empirical Bayesian framework (). Similar as lasso and elastic net, EBlasso-NE becomes a special case of EBEN. Note that the computational speed for EBglmnet is mainly determined by the number of non-zero effects selected by the model. Without the third layer constraint, EBlasso-NE and EBEN select more variables with small effects, and take longer time to finish the computation (). Additionally, for a true effect that is highly correlated with other group of effects, EBEN tends to select the whole group, resulting in a smaller estimated effect size with larger P-value on the true effect, and longer computational time.
Epistasis analysis in EBglmnetAll the aforementioned methods include a parameter 'Epis' to turn on the feature of epistasis analysis. For p genetic variables, this willPerformance metrics were calculated by the mean of 100 replicates of the simulation having optimal parameter pre-determined through CV. A t-test P-value 0.05 cutoff was used when determining PD and FDR for EBglmnet methods. Simulations were based on a simulated F 2 population with p  481 even spaced (5 cM) markers having 20 true QTL effects (10 main and 10 epistatic effects in the case of Epis  TRUE; effect sizes were randomly generated from unif), and computation was performed on a computer cluster including computing nodes with 2.6 GHz Xeon CPU running Linux. bLasso and elastic net were compared using glmnet package implemented with Fortran code. The package failed to analyze simII and simIII due to the separation problem in logistic regression. cWhen Epis  TRUE, the scale hyperparameter for interaction terms is different with that of main effects by a factor of ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi pp  1=2 p . analyze a total of p 0  p(p  1)/2 number of effects adding all pairwise interactions using memory efficient algorithmic techniques, such that only main effect matrix is saved in memory and interaction effect is generated dynamically when the particular effect is under evaluation. As illustrated in (), p can include both additive and dominance effects, and with appropriate genetic coding, all main effects, additive  additive, additive  dominance, dominance  additive and dominance  dominance interactions can be included in the model with 'Epis' on. Generally, a larger sample size is required in epistasis analysis given the p(p-1)/2 more candidate effects. Such performance differences are illustrated in the simulation example using a larger sample size in simIII comparing with that of simII, which are both simulated with 10 main effects and 10 epistasis effects out of the total p 0  p(p  1)/2 115 921 possible effects.
PerformanceEBglmnet not only incorporates powerful algorithms developed in several of our papers, but also has novel algorithms first reported in this Application Note that make the package completely functional. The list of algorithms is provided inusing binomial model as an example, and each method is implemented with a CV method to decide the shrinkage parameter(s). Thanks to the C/C  implementation with the fast BLAS and LAPACK, the software is also time efficient, considering the high complexity of the algorithms. All three sets of simulation have p > n. However, performance of simII is worse than simI given the same sample size but more than 200 times more variables. The noise accumulation and spurious correlation are alleviated with increased sample size in simIII. With the same number of variables as simII, simIII also demonstrates that a longer computational time is required given that more non-zero true effects are selected into the model. Of note, severe spurious correlation leads to complete separation in logistic regression model, and glmnet was not able to handle the problem due to the correlationbased discarding rules ().
ConclusionsEBglmnet is a powerful package for GLMs that performs variable selection and effect estimation. The algorithms outperform other state-of-the-art methods in terms of PD, FDR, as well as handling high correlated effects. EBglmnet package can be very useful for research studies such as multiple QTL mapping, pathway-based GWAS, among other research areas (). Conflict of Interest: none declared.
Bioinformatics, 2016, 13 doi: 10.1093/bioinformatics/btw143 Advance Access Publication Date: 15 March 2016 Applications Note Bioinformatics Advance Access published April 4, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
A.Huang and D.Liu at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
