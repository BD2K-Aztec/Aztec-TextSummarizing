Motivation: Gene expression data exhibit common information over the genome. This article shows how data can be analysed from an efficient whole-genome perspective. Further, the methods have been developed so that users with limited expertise in bioinformatics and statistical computing techniques could use and modify this procedure to their own needs. The method outlined first uses a large-scale linear mixed model for the expression data genome-wide, and then uses finite mixture models to separate differentially expressed (DE) from non-DE transcripts. These methods are illustrated through application to an exceptional UK Brain Expression Consortium involving 12 human frozen post-mortem brain regions. Results: Fitting linear mixed models has allowed variation in gene expression between different biological states (e.g. brain regions, gender, age) to be investigated. The model can be extended to allow for differing levels of variation between different biological states. Predicted values of the random effects show the effects of each transcript in a particular biological state. Using the UK Brain Expression Consortium data, this approach yielded striking patterns of co-regional gene expression. Fitting the finite mixture model to the effects within each state provides a convenient method to filter transcripts that are DE: these DE transcripts can then be extracted for advanced functional analysis.
INTRODUCTIONResearch efforts in molecular and cellular biology are vital to develop our understanding of, for example, the human central nervous system (CNS) function, and to dissect the functional complexity and the progress of diseases. These rapid advancements were mainly determined by the genomic, transcriptomic and diagnostic technological innovations (). These technologies, such as expression arrays and RNA sequencing, are applicable at the genome-wide scale, and their application results in more insightful information being produced, and this can lead towards more informed investigations and in turn through to clinical applications. However, the analyses and the volume of the data that are generated from these complex techniques are computationally challenging. To date, there is no standard protocol available to normalize and process the raw data from these experiments into a manageable format that can then be further interrogated on a personal computer and to align and assemble the data to a reference genome by scientists with no great experience in bioinformatics (). With expression arrays and RNA sequencing increasing in coverage and reducing in cost, they are now widely used with increasingly large sample sizes. Consequently, there is an ongoing need to develop and assess computationally efficient means of analysing 'big data'. Although there is no 'universal' approach to gene expression analysis, the conventional approach is to consider a model for one gene at a time, and consider if this particular gene is differentially expressed (DE) between any of the biological states considered, for example, as implemented in the limma package of R (). Naturally, this results in an extreme multiple testing situation, which is usually overcome by using an appropriate false discovery rate (FDR) control, such as the q-value procedure. The alternative is to consider a global model for all the expression data and replace the many thousands of null and alternative hypotheses by more global tests to dissect causes of variation in gene expression. Such an approach would have two advantages. First, transcripts are not independent identities, and there is much common information across the genome, so combining this would be expected to increase power of signal detection. Second, although a more philosophical point, we question whether it is best practice to consider many thousands of separate hypotheses: as students, we were taught the importance of writing out the null and alternative hypotheses *To whom correspondence should be addressed.for every statistical test, and this pragmatic approach would seem to fail here. So a global or genome-wide approach can be achieved by fitting linear mixed models (LMMs) to all the data, for example, as has been done by, with the variation between transcripts as another source of variation.suggested a similar process using hierarchical models. One potential limitation of the approach of using an LMM fitted to all the expression data is that it may not allow for differences in variability in expression across the biological states of the system under study. For example, in the human brain, some regions of the brain show greater levels of variation in gene expression than in other regions, However, improvements in LMM software, for example, as described inand Pinheiro and Bates (2000), allowing flexible variance structure modelling, make it worthwhile again considering the use of large-scale LMMs in expression data analysis. Fitting LMMs by themselves does not lead to the determination of which individual transcripts are DE, nor do the LMMs identify clusters of transcripts with similar expression profiles. However, fitting of finite mixture models has been used successfully in this endeavour, to separate out potential DE from nonDE transcripts (). The following article demonstrates how these two approaches can be adopted in the analysis of a large gene expression dataset. The methods are described to allow easy implementation in other situations. While some of this approach has been described in previous papers (), the present article provides additional detail and extends these methods. To illustrate the methods, one of the most comprehensive gene expression databases related to human brain tissue, namely, the UK Brain Expression Consortium (UKBEC), is used, highlighting different expression patterns across the brain regions ().
METHODS
DataAssume that we have expression data recorded from a number of arrays (m), and each array has expression measures for n transcripts. Further, each array measures expression levels in one of s different biological states (e.g. regions of the brain). Possibly, the number of replicates for each state is equal (k), in which case m  ks, but this is not essential. So the entire expression dataset of m  n observations is described as y ij(k) , i  1,. .. , m; j  1,. .. , n; with k  1,. .. , s being specified for a particular array i. It is assumed that the expression arrays have been normalized [e.g. using the RMA procedure (, and that appropriate quality control checks have been undertaken. It is also assumed here that y ij(k) is expressed on a logarithmic (base 2) scale.
Linear mixed modelA large-scale LMM is fitted to all the gene expression data simultaneously. This is used to assess sources of variation in gene expression at an overall level, i.e. to estimate and interpret the variance components. The form of the model, in its simplest form, is y ijk   Array i Note that although normalization should remove any between-array effects, the random array effect (Array i ) is included to account for any variation not adjusted for by that process. So it is expected that an estimate of 2 A would be close to 0. The random transcript effects (Transcript j ) account for overall differences in gene expression between transcripts across all states (i.e. some transcripts have a consistently high or low expression value): this variation must be adjusted for, but is not the term of interest in exploring between-state variation in gene expression: it is the transcript  state effects (Transcript.State jk ) that are of interest here. To fit the LMM, a residual maximum likelihood (REML) method is preferable, particularly when the design is unbalanced. Note that REML as a model-fitting procedure is available in some commercial packages commonly used for brain expression analysis, such as Partek  Genomics Suite TM ; however, the approach implemented there is still 'one gene at a time'. For example, the REML method is available in the nlme (), lme4 (http://CRAN.R-project.org/packagelme4) and ASReml-R () packages in R, the latter being a commercial package. REML estimates of 2 A , 2 T and 2 TS (as well as 2 " ) can be obtained and their significance assessed, either in relation to their standard errors (as available in ASReml-R) or the intervals and confint functions in nlme and lme4, respectively. However, a preferable method is using a REML likelihood ratio test (LRT), comparing full and reduced models (by omitting the random effect in being tested). Estimated effects, or more precisely the best linear unbiased predictions (BLUPs) of the random effects, can then be obtained, although, as mentioned before, it is the BLUPs of the Transcript.State ij effects that will be most useful. Typically, these will need to be re-formatted into an n  s array of effects (transcripts  states). These show how expression changes across states, and relatively simple data exploration including boxplots (by state) and pairwise scatterplots (by state) can reveal much information, particularly in patterns of co-expression. This will be returned to later, in Section 3.
Extending the LMMOne important way in which the above LMM can be extended is to include additional factors that may be associated with gene expression, X l , l  1,. .. , p. For example, expression may differ according to gender or age group. Further, these factors may also differ between states. For example, there may be different age-related expression effects, but these may differ across regions of the brain. This can be accommodated by extending the model aswhere the additional terms are also random effects with Transcript:X jl $ N0, 2 TXl , l  1,. .. ,p and Transcript:State:X jkl $ N0, 2 TSXl : Again, inclusion of additional fixed effects (and random interaction effects of these with transcripts) is not uncommon in expression analysis; however, the approach here is that this information is included in a genome-wide model. A second important way the LMM can be extended is by including variance heterogeneity. For example, there may be different levels of genetic variation across regions of the brain, so rather than a single variance component 2 TS , there may need to be separate variances for each region (state), say 2 TR, k , k  1,. .. , s; further, there may also need to be separate residual variances for each state, i.e. 2 ", k , k  1,. .. , s. The need for these can be diagnosed by plots of the BLUPs of the Transcript.State jk effects, or the residuals.
Computational aspects of fitting LMMsFitting a large-scale mixed model can be computationally demanding, especially for a large expression dataset. One solution to this is to fit the model separately to q subsets of the data, each subset having a randomly selected 1/q of the transcripts. Note that all records on the one transcript should be retained in the same data subset file. Hence, any differences could be attributed to sampling fluctuations; nevertheless, this is checked by comparing parameter estimates (fixed effect , and variance component estimates) from each model fit. The estimates from all subsets can then be combined in a weighted average,and the standard error of the estimate obtained as se ^ 2 c    P q i1 w i  1=2 where w i  se ^ 2 i, c  2 , with ^ 2 i, c and se ^ 2 i, c  being the estimate of variance component c and its standard error, based on dataset i  1,. .. , q. Note that while the se ^ 2 i, c  are available in ASReml-R, they are not available using nlme or lme4. In that instance, they may be approximated as one quarter of the confidence interval width, as returned using the intervals function in the nlme package, or the confint function in the lme4 package. However, an unweighted average would also be appropriate, given that the only differences would be due to sampling variation associated with the random splitting of the full dataset. There are also benefits of fitting the model to random subsets of the expression data while developing the model, as this will allow a variety of models to be evaluated in a reasonable time. Estimates of variance components are remarkably similar when using only a sample of m  1000 transcripts compared with a full dataset of m  $20 000 transcripts, so inferences made on a smaller sample may be appropriate.
Finite mixture model to assess DE transcriptsHaving obtained the model-based predicted values of the transcript  state effects, the next issue is to assess which transcripts are differentially expressed across the states. The definition here of DE is a transcript showing an unusually high or low expression level in that particular state, compared with all the other gene transcript expression levels in that state, i.e. it is not defined in terms of DE between states. Typically, a histogram (or normal QQ plot) of the BLUPs of these Transcript.State jk effects (say g jk ) within any one state k shows extreme tails. This can be modelled as a finite mixture distribution consisting of two components, the one with the larger variance 2 1 consisting of DE transcripts and the other with a smaller variance 2 0 consisting of non-DE transcripts (non-DE). The proportions of transcripts that are DE versus non-DE, i.e. the prior probabilities, are 1  P(DE) and 0  1  1  P(non-DE). Further, it is assumed that the expression values are normally distributed, i.e. gjDE $ N0, 2 1  and gjnon-DE $ N0, 2 0 . This is indicated in Supplementary. Fitting the mixture model separately for the transcript effects in state k can be undertaken using maximum likelihood. The log-likelihood is calculated aswhere fg; 2   2 1=2 expg 2 =2 2  is the probability density function for an N(0, 2 ) random variable. This mixture distribution is easily fitted using the expectationmaximization (EM) algorithm (). The details of implementing the EM algorithm as well as assessing the fit of the finite mixture model can be found in Supplementary File Section 1.6. As a by-product of the EM algorithm, the (posterior) probability ( jk ) of each specific transcript being DE is returned. Any transcript with jk 40.5 is more likely DE than non-DE. However, to reduce false-positive results, a higher threshold is recommended. Typically, a threshold of jk 40.8 is a good choice, and there is usually a distinct subset of transcripts with high DE probabilities (as indicated from a histogram of these values). This choice can be evaluated by calculation of the corresponding FDR, FDR  1  meanf ^ jk j ^ jk 40:8g, i.e. the average of the posterior probability of a transcript being non-DE, given it was declared as being DE. The end result of these two processes, i.e. fitting the LMM to obtain genetic effects for each state, and then assessing which transcripts are DE in each state, provides a smaller dataset (n 0 transcripts  k states), where likely, n 0 ( n, which can then be used for further targeted analysis. This may involve assessing patterns of co-expression across different states, or leading towards evaluation of functional gene networks. Some of these further explorations are considered in the following section that describes the implementation of these methods outlined above.
APPLICATION
Description of study and dataTo illustrate the methods presented here, use is made of a study involving 101 frozen human post-mortem brain and CNS tissue samples of Caucasian controls with no neurological conditions, and these were obtained from the Medical Research Council (MRC) Sudden Death Brain and Tissue Bank, Edinburgh, UK (). From each brain, tissue samples from up to 12 brain regions were collected, namely, cerebellum (CRBL, from n  95 brains), frontal cortex (FCTX, n  96), hippocampus (HIPP, n  93), hypothalamus (HYPO, n  13), medulla (specifically inferior olivary nucleus, MEDU, n  92), occipital cortex (specifically primary visual cortex, OCTX, n  95), putamen (PUTM, n  94), substantia nigra (SNIG, n  68), spinal cord (SPCO, n  13), temporal cortex (TCTX, n  84), thalamus (THAL, n  83) and intralobular white matter (WHMT, n  91). RNA samples were extracted and expression levels analysed using Affymetrix Exon 917 arrays with 19 215 gene transcripts recorded. This represents a major part of the UKBEC dataset, the most comprehensive CNS expression dataset to date. The expression dataset was normalized using the RMA procedure, and routine quality control checks were applied, including detection above background filtering. Further details of the study are found in
Analysis of the UKBEC dataFor the analysis of this dataset, the initial model fitted to the expression data was based on n  1000 randomly selected transcripts. The form of the model waswhere y ij(kl) is the RMA-normalized data, on a log-2 scale, and all terms except are random effects. Note that gender was included to test if there were gender-specific expression patterns. Also, the age of the brain donor was included as a random covariate effect, i.e. different linear effect of age associated with each gene transcript, b j $ N0, 2 TAge : However, while statistically significant based on crude Wald tests and on LRTs, the magnitude of these two variance components was substantially smaller than all other variance components (including array); consequently, these two effects were subsequently dropped from the model.However, this initial modelling also indicated that the variation in these gene transcript effects differed across regions, so a common transcript  region variance  2 TR  was replaced by a separate variance for each region  2 TR, k ; k  1,. .. 12. Also as a check, separate residual variances were fitted for each region  2 ", k ; k  1,. .. 12, but the estimated variance components were similar across the 12 regions, and this did not improve the fit of the model. This is also supported by the examinations of residuals by brain region (Supplementary). In the definitive analysis, the data were split randomly into two (q
RESULTSThe estimates of the overall expression mean () and the variance components from each random subset, as well as their combined estimates, are shown in. It is clear that the estimates from both subsets are similar and consistent with sampling fluctuations. There is very little between-array variation, as indicated by its small estimated variance component  ^ 2 A  0:007 AE 0:0002.There was a relatively large estimated variance component to assess between-transcript variation  ^ 2 T  2:032 AE 0:0209. (BLUPs of overall transcripts effects can be obtained to highlight differing overall expression levels between transcripts.) For the transcript-specific effects in individual regions, the level of variation differed widely: CRBL showed the greatest level of variation  ^ 2 TR, 1  0:799 AE 0:0083, followed by WHMT  ^ 2 TR, 12  0:411 AE 0:0044, with HYPO displaying the least variation  ^ 2 TR, 4  0:042 AE 0:0008. Note the formal REML LRTs indicate the heterogeneous model was superior to a homogeneous model with a common between-transcript variance: for Part 1, LRT  21 044 and for Part 2, LRT  20 327, and compared with a chi-square distribution with 11 df returns P  0 in both. Estimated residual variation  ^ 2 "  0:202 AE 0:0001 accounted for between 6.6 and 8.8% of the variation in expression levels (depending on the region). Supplementaryshows a boxplot of the BLUPs of the transcript  region interaction effects. It corroborates the large estimated variance for CRBL and WHMT, and the small variance for HYPO. Supplementaryshows the correlation matrix (Pearson correlation, r) between these region-specific transcript effects. Correlations (almost) 40.5 in absolute value have been coloured (red: positive; blue: negative), and those 40.75 are shown in bold. It is noteworthy that the expression levels in CRBL were not substantially correlated with those in other regions, the greatest being with OCTX (r  0.318). The highest correlations (all positive) were between the three cortex regions (FCTX, OCTX and TCTX). To illustrate,shows a smoothed scatter plot (using the smoothScatter function in the geneplotter package of R) indicating the strong correlations between FCTX and OCTX (r  0.86). Supplementaryshows similar pairs of regions for which jrj40.5, including a negative correlation between TCTX and SPCO (r  0.75).shows details of the region-specific transcript effects for HYPO. (Similar results for the other 11 regions can be found in the Supplementary Figs S6S9).shows the histogram of the distributions of transcripts effects, supported by a corresponding QQ plot in. They show evidence of some extreme effects, i.e. differential gene expression, both upregulated and downregulated, as indicated by the departures from the line in the QQ plot. Similar findings are found in the other regions. The two-component mixture model was fitted to the transcript effects within each region, and these are summarized in. On average, just 530% of transcripts show differential expression in any one region, although this varies from 16 (HYPO) to 45% (OCTX). In terms of variation in expression, the DE transcripts show on average 3.3 greater standard deviations than non-DE transcripts, and this ratio is fairly consistent across regions (r  0.90). Note that using results for mixture distributions, the overall REML variance estimates incan be approximately reproduced here, as 2 TR, k  1 2 1  1  1  2 0 (because the means of both mixture components can be taken as 0). To illustrate here for CRBL, fromshows the QQ plot for the fitted mixture model for HYPO: while not a perfect fit, they fit the expression effects reasonably well, indicating that a two-component mixture model is adequate. (Two transcripts are identified on that plot as being even more extreme: one upregulated and one downregulated).shows the distribution of the probabilities of transcripts being DE in HYPO. What is apparent for each region is a cluster of transcripts with extremely high probabilities of being DE, i.e. DE transcripts. Transcripts with a probability 40.8 can be selected as being DE. The average of the values (1  ) for transcripts declared DE is the FDR: for the current dataset, this is calculated as 4.3%
SUBSEQUENT FUNCTIONAL ANALYSIS OF DE GENESFitting the LMM results in the production of a 'dataset' of Transcript.Region effects (19 215 rows  12 columns). Fitting the finite mixture model within each region identified 7786 transcripts that are DE in one or more regions. These can be extracted to form a reduced file (7786 rows  12 columns) and apply standard bioinformatic approaches for downstream analysis. For example, a heatmap of this dataset (using the heatmap function in R) confirms the similar patterns of expression across the three cortex regions, and distinct separation of CRBL and WHMT from other regions (). It also demonstrates two 'super-clusters' of transcripts. A simple means of clustering transcripts with similar expression profiles is to group together transcripts with the same patterns of DE (upregulation,  ; downregulation; ) or non-DE (.) across the 12 regions (). Whileshows a simple cluster (upregulated in CRBL only, 381 transcripts),shows a far more complex cluster of gene expression showing upand downregulation in 6 of the 12 regions (82 transcripts). With. Naturally, more complex methods for analysing this reduced dataset are appropriate. For example, the weighted gene co-expression network analysis method () may also be applied to identify network connectivity modules in specific regions or between all regions (), as well as gene annotation and functional analysis such as DAVID to identify enriched biological themes such as functional and clustering classification using gene ontology (GO) (demonstrated the use of DAVID, in conjunction with the current LMM/finite mixture model approach. Identification of over-represented transcription factor binding sites in targeted modules () and the use of a bioinformatics database, Encyclopaedia of DNA Elements (ENCODE) consortium, are also applicable.
DISCUSSION AND CONCLUSIONSWith ever-increasing volumes of data generated from expression arrays or RNA sequencing, there is a need to increase the efficiency and sensitivity in analysing large biological datasets. There is also a need to provide methods that are accessible to researchers without a strong bioinformatic and statistical background. The methods outlined here are aimed at addressing these goals: the method described should be able to be adapted to other situations, and some R code has been provided to assist with this (see Supplementary File Section S1). The use of LMMs as a means for analysing all expression data simultaneously is intuitively appealing, as there is much common information across the entire genome that can be used simultaneously to estimate genetic parameters and obtain predicted effects of individual transcripts. The analysis outlined here demonstrates how the standard LMM can be extended to include variance heterogeneity in the genetic effects but also in residual effects. Using recent developments in mixed model theory, we can incorporate a spatial correlation structure over the array. The method as described here, and also as illustrated using the brain expression data, assumes that the expression data have been normalized. However, even in the absence of normalization, results are fairly similar, but with some indications of more transcripts being flagged as being DE (Supplementary File, Section S4). Although not suggesting that expression data should not be normalized, it does indicate that a low-level form of normalization would be expected to return similar results to the RMA method used here. Another important consideration is the software used to fit the large-scale LMM to the expression data. For the analyses presented here, the commercial package ASReml-R has been used
becauseof the flexibility of model specification, in particular the ability to specify a heterogeneous variance model, all conducted within the R environment. However, for this dataset, the impact of fitting a homogeneous variance model was not found to have serious consequences (see Supplementary File, Section S1.5), allowing the freely available lme4 or nlme packages to be used. Naturally, we are aware that using any analysis method to detect DE transcripts will have its own limitations. For example, there might be a functionally important DE transcript missed out as part of the detection above background process used to reduce some of the background 'noise'. Or alternatively, it may fail the test for being DE (threshold  0.8). However, such a transcript still may be detected using one of the clustering methods mentioned here, which only requires information on the effect size, and not the DE status. Note that the LMM/finite mixture model method proposed here produced a more targeted list of DE transcripts, the list becoming more accurate with increasing number of arrays. This is a point of contrast to the 'gene by gene' approach in limma (): with increasing sample size (number of arrays), the limma approach will flag the majority of transcripts as DE, but these will not necessarily be biologically important. Some comparisons of analysis using limma and the current method are included in Supplementary File Section S5. In the method proposed here, there are two separate procedures, namely, (i) fitting the LMM and then (ii) fitting a finite mixed model to the BLUPs of these effects, separately in each state (brain region, in the current example). Ideally, the two processes would be combined, fitting a mixture model to capture DE/non-DE within the LMM. However, with a large number of states (s), the theoretical number of possible DE/non-DE patterns becomes immense (2 s  4096), and fitting a mixture model with this many components would be infeasible. However, the LMM is reasonably robust against model misspecification. As an illustration, the correlation between the BLUPs of the Transcript.Region effects obtained from models with and without variance heterogeneity included was 0.98 (see Supplementary), despite the obvious between-region variance heterogeneity. Nonetheless, further research in combining these two stages is warranted. The main endpoint of the methods outlined here is to produce a table of effects of gene transcripts in different states, the table being restricted to transcripts that are DE in any one of the s states: following this, further analysis is of course required to identify clusters and the functional pathways using different advanced tools as mentioned in the previous section. This provides a way forward to obtain more reliable information about transcriptional regulation in the human CNS to understand the effect of genetic disorders targeting specific human CNS regions.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
D.Trabzuni et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Application to regional differences in the human brain at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
