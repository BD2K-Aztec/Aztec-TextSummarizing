Motivation: Differential transcript expression (DTE) analysis without predefined conditions is critical to biological studies. For example, it can be used to discover biomarkers to classify cancer samples into previously unknown subtypes such that better diagnosis and therapy methods can be developed for the subtypes. Although several DTE tools for population data, i.e., data without known biological conditions, have been published, these tools either assume binary conditions in the input population or require the number of conditions as a part of the input. Fixing the number of conditions to binary is unrealistic and may distort the results of a DTE analysis. Estimating the correct number of conditions in a population could also be challenging for a routine user. Moreover, the existing tools only provide differential usages of exons, which may be insufficient to interpret the patterns of alternative splicing across samples and restrains the applications of the tools from many biology studies. Results: We propose a novel DTE analysis algorithm, called SDEAP, that estimates the number of conditions directly from the input samples using a Dirichlet mixture model and discovers alternative splicing events using a new graph modular decomposition algorithm. By taking advantage of the above technical improvement, SDEAP was able to outperform the other DTE analysis methods in our extensive experiments on simulated data and real data with qPCR validation. The prediction of SDEAP also allowed us to classify the samples of cancer subtypes and cell-cycle phases more accurately.
IntroductionIn recent years, RNA-Seq has taken a major role in the quantitative analysis of transcript expression and variant discovery and become a vital component of genomic and transcriptomic research (). For case-control studies, several differential transcript expression (DTE) analysis methods such as Cuffdiff 2 (), DESeq2 (), edgeR (), and ALEXA-Seq () have been developed to discover genes that have differentially expressed transcripts whose abundance values alter between known biological conditions. In addition to the DTE methods, differential splicing (DS) analysis methods such as MISO (), FDM (), MATS (), DEXSeq (), and DiffSplice () are focused on identifying difference in relative abundance of transcripts. Note that a change in the absolute abundance of a transcript may result from a change in the basal expression level of the corresponding gene, its splicing ratio or both (). In other words, DTE methods should be able to discover DS events but not vice versa. Moreover, the DTE and DS analyses may also find many important applications in population based studies, where predefined conditions are unavailable a priori. For example, a recent population study to improve the diagnosis and prognosis for breast cancer shows that triple-negative breast cancer can be further classified into six subtypes based on the differential analysis of the expression profiles of patients (). Each of the six subtypes has different sensitivities to targeted therapies. To understand the functions and mechanisms during cell development or differentiation, differentially expressed transcripts are used to characterize cell types or specificity in a mixed population (). Due to the emergent demand for computational tools for DTE and DS analyses without known biological conditions, several methods have been proposed recently. SIBER and DEXUS test differential expression by looking at the numbers of reads mapped to individual genes or exons (). An extended protocol of DESeq2 has been published recently to identify differentially expressed genes for single-cell (SC) RNA-Seq data based on ERCC spike-in data (). SigFuge compares the areas under normalized read-depth curves to call DS genes (). In a DTE analysis, the expression of genes (or transcripts) is summarized by numerical features, called expression features (e.g., read counts of genes or exons in DEXUS and areas under normalized read-depth curves in SigFuge). The DTE of genes is assessed by calculating the variation of the expression features across the samples of different biological conditions. When the biological conditions of samples are not predefined, to test whether an expression feature has experienced differential expression, the input samples are usually clustered based on the expression levels of the feature across the samples. The clusters of the samples are then used as the biological conditions and the variation of the expression feature between the conditions is then measured statistically (). Clearly, the correctness of the clustering is critical to the DTE analysis when the biological conditions is not available. Both SIBER and SigFuge assume that the input population consists of only two conditions and always cluster the samples into two clusters. This assumption is unrealistic in many applications and an incorrect partition (or clustering) of samples may lead to unreliable conclusions of differential expression tests. Although DEXUS also assumes binary conditions by default, it allows the user to input the number of the biological conditions, which will be used as the number of clusters on all expression features. However, specifying the correct number of the biological conditions directly from samples is difficult for a routine user. Moreover, since some expression features may exhibit little variability on a subset of the biological conditions, the optimal numbers of clusters for individual expression features may differ and may not always be equal to the number of biological conditions defined by the user, even when the user-defined number is correctly specified. Hence, a computational method that can determine the numbers of clusters automatically from data is urgently needed to conduct reliable DTE analyses when the biological conditions are not available. In addition to the challenge in specifying the number of clusters, these tools only report changes in coverage of exons of genes by RNA-Seq reads which do not directly suggest how and where transcript expression diverges as a result of alternative splicing events (ASEs). Such ASE information could be valuable in down-stream applications in their own right, e.g. as biomarkers in several cancer studies (). To address these issues in the existing DTE analysis tools, several technical improvements have been made in a new DTE analysis algorithm, called SDEAP. In SDEAP, the number of clusters for expression feature is no longer fixed as two or required as a part of the input. Instead, a Dirichlet infinite mixture model is applied to determine the number of clusters for every expression feature by fitting the data optimally. To further discover ASEs, a graphical data structure, called the splice graph, is used in SDEAP to model the structures and abundance of all transcripts of a gene such that ASEs can be represented by decomposing the graph into alternative splicing modules (ASMs), as originally proposed in DiffSplice (). However, the graph modular decomposition algorithm employed in DiffSplice is not used here because we have found a counterexample to its correctness (see the Supplementary Materials for a detailed discussion). A corrected algorithm is described in this paper and implemented in SDEAP. Moreover, a method accounting for variability due to technical noise across biological or technical replicates has been adopted to reduce the number of false positives in SDEAP (). To assess the prediction accuracy of SDEAP, extensive experiments on both simulated and real data were conducted to compare SDEAP with DEXUS. SIBER was excluded from our comparisons because the performance of SIBER and DEXUS in detecting the variation of read coverage of genes and exons due to DTE has been compared in (). DEXUS was shown to constantly outperform SIBER and, moreover, SIBER can only be run on large datasets of more than 50 RNA-Seq samples (). In our simulation experiments, SDEAP outperformed DEXUS by at least 0.17 in the area under precision-recall curve (or AUCpr, which is used as the assessment of overall performance), on average. The numbers of conditions for at least 88% genes in the simulated data were correctly predicted by SDEAP. Although DS analysis is not the main purpose of SDEAP, we compared it with SigFuge in the detection of changes in relative abundance of transcripts by repeating the simulated experiments in (). SDEAP discovered more DS genes than SigFuge without producing any false positives. Furthermore, the performance of SDEAP is also compared to that of three state-of-theart DTE methods, namely DESeq2, Cuffdiff 2 and edgeR, that require known (binary) conditions as a part of the input using simulated datasets. When the numbers of individuals from each condition are not highly imbalanced, there is no noticeable difference between the prediction accuracy of SDEAP and that of the three methods. The time efficiency of SDEAP is discussed in the Supplementary Materials. To further demonstrate the utility of SDEAP in real biological applications, the DTE genes predicted by SDEAP were used as biomarkers to classify different cancer subtypes, cell types and cell-cycle phases on several recently published RNA-Seq datasets (). These applications are interesting because some critical diseases, e.g., breast cancer (BC), are known as heterogeneous diseases with a variety of transcriptomic alterations that severely affect the diagnosis and prognosis of the diseases (). Finding DTE genes that could be used as transcriptomic biomarkers to identify subtypes of such diseases could be important for the design of clinical trials to investigate targeted treatments. Moreover, the expression patterns of transcripts in individual cells of different cell types or cell-cycle phases, which can be revealed by the SC RNA-Seq technology nowadays, are fundamental to studies on alternative cellular functions during the development of a tissue or an organ (). Our real data experiments demonstrate that the classification of RNA-Seq samples using the ASEs from SDEAP is much more consistent with the real biological conditions (i.e., cancer subtypes, cell types and cell-cycle phases) than using the differentially expressed exons predicted by DEXUS. The prediction results of both methods were also compared with the qPCR validations of gene expression. More validated DTE genes were covered by the prediction of SDEAP. These results suggests that SDEAP also performs DTE analysis well on real population data.
MethodsAn expressed segment is an exonic region delimited by two exon boundaries. A splice graph G(V  {s, t}, E) of a gene g is a weighted and directed acyclic graph where every vertex v  V denotes an expressed segment Rv. For every pair of vertices u and v, there is a directed edge (u, v) from u to v if the expressed segment Rv immediately follows Ru in some transcript of the gene g. In addition to the vertices V representing expressed segments, two artificial vertices s and t are included in G to indicate the beginning and end of all transcripts of the gene g, respectively. The vertex s is connected to every vertex corresponding to the very first expressed segment of a transcript of the gene g and every vertex denoting the last expressed segment of a transcript is connected to t. In SDEAP, we assume that splice graphs are provided as the input. Given all RNA-Seq reads mapped to the gene g in an RNA-Seq sample, the weight of a vertex v, w(v), is defined as the number of reads mapped to the region Rv and the weight of the edge (u, v), w(u, v), is the number of reads that span the two expressed segments Ru and Rv. A vertex u  V pre-dominates a vertex v  V if every path from the artificial vertex s to v contains u. A vertex w  V post-dominates a vertex v  V if every path from v to the artificial t contains w. An ASM (or alternative splicing module) is an induced subgraph H(s 1 , t 1 ) = {V H , E H , s 1 , t 1 } of G with the entry s 1 and the exit t 1 outside H that satisfies the following conditions (): (1) (Single entry) All edges from (GH) to H come from s 1 ; (2) (Single exit) All edges from H to (G  H) go to t 1 ; (3) (Alternative paths) Let d + (u) denote the number of outgoing edges from the vertex u and d  (u) the number of incoming edges of u. Then d + (s 1 ) > 1 and d  (t 1 ) > 1; (4) (There does not exist a vertex v  V H , such that v post-dominates s 1 or predominates t 1 in H(s, t). Moreover, an ASM H 1 (t 1 , s 1 ) can be a subgraph of another ASM H 2 (t 2 , s 2 ). If there is no ASM that contains H 1 and is contained by H 2 , H 1 (s 1 , t 1 ) is said to be a child ASM of H 2 and H 2 is the parent ASM of H 1. The abstraction of an ASM H 2 (s 2 , t 2 ) is a graph obtained by replacing every child ASMwith an artificial edge (s 1 , t 1 ). An ASM path is a path from s 2 to t 2 in the abstraction of an ASM H 2 (s 2 , t 2 ).
Discovery of ASMsThe algorithm proposed in DiffSplice for discovering ASMs is not used here because we have found a counterexample to its correctness (see the Supplementary Materials for a detailed discussion). In our new ASM discovery algorithm, every ASM is discovered before its parent and then shrunk into an artificial edge immediately. All vertices of the input splice graph G are sorted by topological sort (). Let  be the topological order of vertices and (u) the index of vertex u in the order. If there is a path from vertex u to vertex v, then the index of vertex u is greater than the index of vertex v, i.e., (u) > (v). Assume that an ASM H 2 (s 2 , t 2 ) has a child ASM H 1 (s 1 , t 1 ). If all vertices are traversed in the order of , the exit t 1 of H 1 must be traversed before the exit t 2 of its parent H 2 , i.e., (t 1 ) < (t 2 ). Let   be the reverse of the topological order . Similarly,). To discover ASMs, every vertex v with the in-degree d + (v) > 1 (or the out-degree d + (v) > 1) is selected as a candidate of an exit (or an entry, respectively.) of ASMs. We firstly traverse all candidates of the entry in the order of  . When a candidate of the entry u is visited, for every candidate exit v such that (v) > (u), v is chosen in the order of  to pair up with u as a candidate entry-exit pair (u, v). The union of all paths bounded by (u, v) is checked if it is an ASM or not. If the union is an ASM, we replace it by an artificial edge. In this order of enumerating candidate entry-exit pairs, for every ASM H 1 (s 1 , t 1 ) and its parent H 2 (s 2 , t 2 ), the candidate entry-exit pair (s 1 , t 1 ) is always tested before (s 2 , t 2 ). Thus, every ASM is guaranteed to be identified before its parent. The time complexity of identifying ASMs from a splicing graph G is O(|V | 3 + |V | 2 |E|). Please see the Supplementary Materials for a pseudocode of the algorithm for discovering ASMs and the derivation of the time complexity.
Estimation of Expression FeaturesIn SDEAP, the expression features of a gene are the abundance values of all ASM paths in the ASMs of the gene by default. However, when the number of ASM paths in an ASM increases, estimating the abundance values of ASM paths is less accurate due to non-identifability as discussed in DiffSplice (). Hence, if the number of paths in an ASM is greater than 3, instead of the abundance values of the ASM paths, we use the abundance values of the expressed segments and junctions in the ASM as its expression features. The abundance values are measured in terms of the average RNA-Seq fragment coverage per kilobases per million fragments (FPKM). For an expressed segment, the FPKM is the number of fragments mapped to the expressed segment divided by the length of the segments in kilo bases and the size of the RNA-Seq fragment library in million bases. For a junction, because the length of mapped reads is the length of the region where each junction read spans, the FPKM of a junction is the number of mapped reads divided by the read length and the size of the library. Given an ASM H(u, v), let the ASM paths of H(u, v) be P = {p 1 , p 2 , ..., p N } such that all expressed segments and junctions covered by the paths can be represented as a binary matrix A M N = (a i,j ), 1  i  M and 1  N  j, where each of the M rows represents an expressed segment or a junction and each of the N columns represents a path. If the path p j includes an expressed segment or junction i, a i,j = 1. Otherwise, a i,j = 0. Every expressed segment or junction i is associated with a value of effective length l i. If the row i represents an expressed segment, l i , is the length of the expressed segment. Otherwise, l i is set as the length of the RNA-Seq reads. Note that the first and last vertices and artificial edges of each path are not included in the rows of A M N. Let the abundance values (FPKMs) of the paths be X = {x 1 , x 2 , ..., x N }. All mapped reads are assumed to be evenly distributed on each of the paths. Let the observed number of reads falling into the i-th expressed segment or junction be r i. The expression levels of the paths, X = {x 1 , ..., x N }, can then be determined by using the abundance values X * that minimizes the following residual sum of squares as done in IsoInfer ():with respect to the constraints that x j  0 for all 1  j  N. In the implementation of SDEAP, an R package opt is used to solve the above quadratic optimization problem by the L-BFGS-B algorithm ().
Selecting Informative Expression FeaturesWhen there are n RNA samples, each expression feature f has n instances, F = {f 1 , f 2 , ..., fn}, where f i represents the abundance value of f in the i-th RNA-Seq sample. In the literature (), the observed variance of the instances is postulated as due to technical noise and biological variation. To control the number of false positives, only the expression features with variance of the instances significantly higher than the variance due to technical noise are considered as informative features and used in the DTE analysis. The expected variance  due to technical noise is usually modeled as a quadratic function of the observed mean  f of f such that ( f ) =  f +  f 2 , where the parameter  is a parameter to be estimated by regression using all expression features in the samples of the same condition. However, since the biological conditions are not given a priori in our case,  is approximated by using all input samples as done in the literature (). Let the observed variance of the instances of an expression feature f b  f. An expression feature f is selected as an informative feature ifif if f /( f ) > , where  is a user defined threshold, as employed in ().
Testing Differential Transcript ExpressionThe Dirichlet infinite mixture model used in SDEAP is a Gaussian mixture model that allows us to determine the number of components from data automatically. To illustrate the Dirichlet infinite mixture model, we start from a finite mixture model of fixed k components. Let F be the n instances of an informative expression feature f and C = {c 1 , c 2 , ..., cn}, c i  {1, 2, ..., k} be the set of component indices such that each index c i indicates which component f i belongs to. In a finite mixture model, the joint probability of C and F can be written as:where  = { 1 ,  2 , ...,  k } such that  j is the probability of an instance f i belonging to component j, I is an indicator function and the base distribution N (f i | j ) is the distribution of instances in the component j given the parameters  = { 1 ,  2 , ...,  k } of the k components. In a Dirichlet infinite mixture model, each   0, is assigned a Dirichlet prior with k concentration parameters such that   Dirichlet(/k, ..., /k) where  is a hyper parameter. At the same time, the number of components, k, is allowed to go to infinity. By integrating the mixing proportion , the conditional prior probability of f i belonging to component j, i.e., c i = j, iswhere n i,j is the number of components i with c i = j, i < i. By combining the likelihood function of Eq. (2) with Eq. (3), the conditional posterior probability functions for c i = c j with the given model parameters,  and , and observed feature values F arewhere b is a constant for normalization, C i =C  {c i } and n i,j is the number of c i  C i such that c i = j.. The conditional posterior probability functions for c i = c j , for all j = i arewhere G 0 is the prior probability of . More detailed derivation of the prior and posterior probabilities of the parameters is discussed in (). The component indicators C that maximize the joint probability given in Eq. (2) can be determined by sampling from a Markov chain of the posterior probabilities with Eq. (4) and Eq. (5) as its equilibrium distribution. To further improve the execution time of the sampling process, an algorithm based on variational inference has been proposed in the literature (). Here, we assume that reads from a transcript are uniformly distributed among the transcript. As justified in the literature (), the distribution of the FPKM values can be approximated by a Gaussian distribution based on the assumption. Hence, the Dirichlet infinite mixture model is appropriate to fit the observed FPKM values from RNA-Seq data. The implementation of the variational inference algorithm in the Python package scikit-learn is used in SDEAP (). After the clustering of the instances F , a one-way ANOVA test is performed to test if the clusters are indeed significantly different (). The p-values from the ANOVA test are adjusted for multiple comparisons and the adjusted p-values are called the false discovery rates (FDRs) as done in (). If the FDR of an informative feature f is smaller than a given threshold, e.g., 0.1, we conclude that the informative feature f differentially expressed across the input samples.
Evaluation MetricsAll our experimental results are evaluated in terms of precision (PRE), PRE = TP/(TP + FP), and recall (REC), REC = TP/(TP + FN), where TP is the number of true positives, FP the number of false positives and FN the number of false negatives. Because the number of equally or differentially expressed transcripts in DTE analysis is usually unbalanced, a recently published study suggests that precision-recall curves are more informative than ROC curves on unbalanced data (). Hence, the area under the precision-recall curve (or AUCpr) is used as a measure of the overall performance of a prediction method in our tests. In this paper, an R package PRROC is used to calculate the PRE, REC and AUCpr scores (). To measure the similarity between clusters of RNA-Seq samples and real biological conditions, a widely used assessment, Jaccard index, is calculated as in the literature ().
Experiments on Simulated Data
Simulation of Regular RNA-Seq ReadsIn our simulation studies, we simulate RNA-Seq reads from the Ensembl GRCh38 (hg38) reference genome as the input data to test the abovementioned DTE analysis methods. The simulated datasets consist of various numbers of samples from two or more predefined conditions according to different experimental designs. The simulation process for each datasets consists of three steps. The first step is to create an expression profile, which includes the FPKM values of all transcripts annotated in the hg38 reference genome, for each of the predefined conditions. Then, the observed numbers of reads from the transcripts in every sample of a predefined condition are randomly drawn from the negative binomial distributionconfigurations of group sizes as considered in(a) and 1(b). Again, the X-axis shows different combinations of group sizes and the Y-axis illustrates the three scores.shows the accuracy of estimating the numbers of conditions on simulated SC RNA-Seq data, which is demonstrated in the same way as in(c) and 1(d). parameterized by the FPKM values. Finally, paired-end reads are synthesized from the annotated transcripts according the observed numbers. The details of the three steps are given below. We describe first how the two expression profiles for binary conditions are created. The construction of the profiles for three or more conditions will be introduced later in Section 3.1.3. In the first of the two expression profiles, the FPKM value of each transcript is randomly drawn from a lognormal distribution as done in the literature (). Here, only genes that have multiple transcripts are considered. A transcript is said to be detectable if its FPKM value is greater than 0.1. A gene with multiple transcripts is discarded if the sum of the FPKM values of its transcripts is less than 1.0 or none of its transcripts is detectable according to the first expression profile. Hence, our simulated datasets are comprised of 3089 genes. To create the second expression profile, among the 3089 genes, 308 (10%) genes are chosen as DTE genes. All the DTE genes are evenly divided into three categories: up-regulated, down-regulated and differentially spliced. For each up-regulated gene, a detectable transcript is randomly selected and its abundance is increased by a factor of at least 4, a widely used threshold to define differential expression in the literature (). Similarly, for each down-regulated gene, the abundance of a randomly selected (detectable) transcript is decreased by a factor of at least 4. For each differentially spliced gene, the maximumand minimum abundance values of its transcripts are swapped. Different from up-and down-regulated genes, total amount of reads mapped to differentially spliced genes may not have significant difference between the samples from the binary conditions. All three types of DTE genes are included and tested in the following simulation studies. The other 2781 genes are selected as equally expressed (EE) genes and the FPKM values of their transcripts remain the same in both expression profiles. Given an FPKM value xt,c of transcript t in the expression profile for a predefined condition c, the number of observed RNA-Seq reads, r t,i , from the transcript t in a sample i of the condition c follows the negative binomial distribution N B(t,c, ), where t,c is the mean value of the read counts and  is the dispersion rates. The variance of r t,i modeled by the distribution is t,c +  2 t,c. The mean value t,c = xt,c  lt   s, where lt is the length of t in kilo bps andsand ands is the size of the RNA-Seq library in millions. We simulate RNA-Seq libraries of moderate sizes withs with withs set to 40M. The dispersion rate  is set to be 0.179 as done in the literature (). In real RNA-Seq data, the observed variance of the read counts is significantly greater than the sample variance modeled by the distribution () due to outliers. Two studies based on real RNA-Seq data show that approximately 5% genes from the same biological condition have significantly higher variance in transcript expression than expected due to outliers (). To simulate datasets that reflect real RNA-Seq data as much as possible, 5% genes are selected as genes that contain outliers in the simulated samples. Extreme high values of transcript expression are usually detected in approximately 10% of real RNA-Seq samples (). To simulate such extreme high expression values, we allow the randomly drawn read counts r t,i for transcript t from the selected outlier genes to have a 10% probability of being amplified from 5 to 10 times in sample i as done in (). In addition to the existence of extremely highly expressed transcripts, a study shows that the exons of lowly expressed transcripts could be ubiquitously missing in every one of two technical or biological replicates (). To account for such missing-value events, among the 5% selected outlier genes, we allow the randomly drawn read count r t,i for a transcript t with abundance lower than 1.0 to have a 30% to 50% probability of being assigned zero in sample i. Given the randomly drawn read counts r t,i , r t,i paired-end RNA-Seq reads of 50 bps each are obtained from both ends of r t,i /2 cDNA fragments synthesized from the genomic region of the transcript t in the hg38 reference genome. The density distribution of the synthesized cDNA fragments along the genomic region of the transcript t follows a positional profile that reflects positional biases due to complementary DNA fragmentation (). To avoid biased assessment of prediction accuracy due to random sampling, the simulation experiment on each configuration is repeated 10 times and the average performance of each method is reported in the following discussion.
Performance on RNA-Seq Data from Two ConditionsBoth SDEAP and DEXUS are tested on several simulated datasets with binary conditions. The combinations of group sizes, n 1 and n 2 , in the simulated datasets are from the literature (). If n 1 > n 2 , the n 1 RNA-Seq samples are called the major group and the n 2 samples are called the minor group. The performance results of both methods on all group size configurations are summarized in(c). The accuracy in estimating the number of conditions, as demonstrated in(b), is measured by the proportion of genes that have at least one expression feature resulting in correctly estimated number of conditions. To evaluate the ability of false positive control, the false positive rates at the REC score (i.e., sensitivity) 0.9 on the 2781 EE genes are illustrated in Supplementary(a). A comparison of the overall performance (the AUCpr scores) of the methods shows that SDEAP clearly outperforms DEXUS. The average AUCpr of SDEAP over all configurations is 0.809 and the average AUCpr of DEXUS is only 0.624. SDEAP outperforms DEXUS by at least 0.09 and 0.1 in the PRE and REC scores, respectively. In general, increasing the number of samples benefits the REC scores of both methods. The performance of DEXUS is generally lower than what was reported before in the literature (). This is because outliers frequently observed in real data were not included in the experiments performed in (). The false positive rates of SDEAP are significantly lower than those of DEXUS, as shown in Supplementary(a). This shows that SDEAP controls false positives better due to a robust background variance analysis where most of the outliers could be filtered out due to their variance which is generally lower than that of the DTE genes. As summarized in(c), SDEAP is able to identify the correct number of conditions for at least 94.2% of the genes. We notice that its accuracy in predicting the correct number of conditions on DTE genes drops significantly on the configuration (80,16). This is because the clustering algorithm of SDEAP on the minor group is more sensitive to the outliers when the proportion of the minor group decreases. Clearly, the accuracy in estimating the number of conditions is correlated with the quality of predicted DTE genes. Notably, the prediction accuracy of DEXUS is very sensitive to changes in the proportion of the minor group such that its AUCpr score drops drastically from 0.789 on the configuration (50,50) to 0.513 on the configuration (9,3). The performance of SDEAP is more robust with respect to the decrease in the proportion of the minor group until it drops down to 16.6% in the last two experiments with the configurations (20,4) and (80,16). A possible explanation for the deteriorated performance of SDEAP is that, on these two imbalanced configurations, the observed variance of the expression features in some DTE genes is close to the background variance due to the outliers and these DTE genes may be filtered out in the background variance analyses. The other reason could be due to less accurate clustering results on the DTE genes.
Performance on RNA-Seq Data from Three or More ConditionsTo simulate datasets from three conditions, we start with the two expression profiles for binary conditions described in the previous simulation experiment and define the third expression profile as the average of the first and second profiles. For example, if the FPKM values xt,a and x t,b , of a transcript t are 1.0 and 4.0 in the first and second profiles for two conditions a and b, respectively, then the FPKM value xt,c in the third profile for the condition c is 2.5. These configurations are designed in order to reflect the reality in some challenging practical applications, e.g., RNA-Seq data sampled during cell development (). To further test the capabilities of SDEAP and DEXUS, we include simulated RNA-Seq samples from five conditions as follows. Given the profiles for the previous three conditions, the fourth expression profile is the average of the first and the third profile, while the fifth expression profile is the average of the second and the third profile. For example, if the FPKM values xt,a, x t,b and xt,c, of a transcript t are 1.0, 4.0 and 2.5, respectively, then x t,d and xt,e are 1.75 and 3.25 in the profiles for the fourth and fifth conditions d and e. Since DEXUS does not provide any tool to estimate the correct number of conditions when clustering instances of every expression feature, the default number (two) of conditions is still used for DEXUS. The performance of SDEAP and DEXUS on various configurations with three or more conditions is reported in(b). The accuracy in estimating the numbers of conditions by SDEAP is summarized in(d). The false positive rates at the REC score 0.9 of the two methods is illustrated in Supplementary(b). Again, SDEAP significantly outperforms DEXUS overall. The AUCpr scores of SDEAP are at least 0.126 higher than that of DEXUS in every experimental setting. This could be due to the incorrect assumptions on the number of clusters by DEXUS. When the correct numbers of conditions, three or five, are provided to DEXUS as a part of the input, the performance of DEXUS can be improved as illustrated in Supplementary Tab. S1. This demonstrates the importance of being able to know the correct number of conditions in DTE analysis. The AUCpr scores of SDEAP drastically decrease on the configuration (10,10,10,10,10). This is because the expression features of DTE genes have low observed variance so close to the background variance that the features are very likely considered as non-informative in the background variance analysis. In general, the expression features of DTE genes present higher variance on the configuration (20,10,10,10,10) than on (10,10,10,10,10) and are thus less likely considered as non-informative. This explains why SDEAP performs better on the configuration (20,10,10,10,10). The comparisons in terms of precision scores and false positive rates suggest again that SDEAP controls false positives better than DEXUS. SDEAP is able to predict the correct number of conditions for at least 88.2% of the 3089 genes on average. We notice that the accuracy in estimating the correct number of clusters for the 308 DTE genes drops down to 0.142 and 0.155 on the configurations (10,10,10,10,10) and (20,10,10,10,10), respectively. This is due to the fact that the separation of expression features becomes more subtle on these two configurations. Two hypothetical gene models concerning two transcripts, isoform t 1 and isoform t 2 , are considered as illustrated in Supplementary. The first model has a cassette exon excluded from isoform t 1 but retained in isoform t 2. The second model contains mutually exclusive cassette exons. For each configuration, RNA-Seq samples of binary conditions are simulated. Let the relative abundance values of the two transcripts t 1 and t 2 be  1 and  2 , respectively. In the first configuration, the first gene model is used where the relative abundance values, ( 1 ,  2 ), are set as (0.5, 0.5) in order to evaluate the number of false positives in prediction. In the second configuration, ( 1 ,  2 ) is set as (0.75, 0.25) and (0.25, 0.75) for the binary conditions, in order to evaluate the number of true positives. In the third configuration, the same abundance values in the second configuration are applied to the second gene model. In each configuration, two combinations of group sizes (n 1 , n 2 ), (50, 50) and (75, 25), are considered. The detailed simulation of RNA-Seq reads is described in the Supplementary Materials. In each configuration, 100 individual genes of each exon model are tested as done in () and the DS analysis results are summarized in Supplementary Tab. S2. SDEAP consistently achieves high sensitivity and precision with zero false positives in all three experimental settings. SigFuge also achieves a high sensitivity in the second configuration. However, its sensitivity drops in the third configuration when the sizes of the groups become unbalanced.
DTE Analyses with or without Predefined ConditionsIn this subsection, we evaluate how much the known conditions of samples may contribute to the accuracy of a DTE analysis by comparing the prediction results of SDEAP with those of three state-of-the-art DTE methods, Cuffdiff2, DESeq2 and edgeR, which require predefined conditions. The latest implementations of the three methods, Cufflinks 2.2.1, DESeq2 1.12.2 and edgeR 3.14.0, are downloaded and run on the simulated datasets of binary conditions. The biological conditions of the samples are provided to Cuffdiff2, DESeq2 and edgeR as a part of the input. A FDR value 0.1 is set as the threshold to call DTE genes in SDEAP. The PRE and REC scores of the three methods are calculated by using the same number of top-ranked genes in their predictions. The assessment of the performance on the simulated datasets is summarized in Supplementary. Among the three DTE methods requiring known conditions, DESeq2 achieves the best overall performance, i.e., AUC scores. The AUC scores of SDEAP, ranged from 0.858 to 0.837, are comparable to those of DESeq2 on the first four configurations. However, on the configurations (20,4) and (80,16), where group sizes are highly imbalanced, the AUC scores of SDEAP drop to 0.726 and 0.737 on the two configurations, respectively. As discussed in Section 3.1.2, the AUC scores of SDEAP may decrease when the proportion of the minor group becomes very small. At the same time, Cuffdiff 2, edgeR and DESeq2 provide consistent predictions with similar accuracies across all configurations. The results show that the conditions of samples, if available, can significantly contribute to the accuracy of a DTE analysis, especially when group sizes are highly imbalanced. When the group sizes are balanced, DTE analysis methods like SDEAP that require no prior knowledge of the conditions can do just as well as those that assume the conditions are given.
Experiments on Real Data
SDEAP Detects Different Cancer SubtypesIn this experiment, SDEAP and DEXUS are applied to a recently published RNA-Seq dataset including 17 individual human samples belonging to three subtypes of BC: Triple-Negative, Non-Triple-Negative and HER2positive (). The RNA-Seq reads of the BC samples are aligned against the Ensembl GRCh37.62 B (hg19) reference genome using TopHat 1.4.1 with the default parameters, i.e., the maximum number of mismatches allowed per aligned read is 2, the maximum insertion/deletion length is 3 and so on, as defined in (). The downloaded reads do not contain any adapter. All reads that are mapped to multiple locations or have the low mapping quality score (MAPQ <10) are removed by SAMtools 1.2 (). With the FDR threshold 0.1, SDEAP predicts 1366 DTE genes. These genes are compared with the top-ranked 1366 predicted DTE genes by DEXUS and used to hierarchically cluster the 17 samples as illustrated in(a) and 3(b). The 17 samples in each dendrogram are then partitioned into three clusters and compared with the three subtypes of BC. In the clustering by SDEAP, only one of the 17 samples is misclassified while there are three misclassified samples in the clustering by DEXUS. The Jaccard index of SDEAP's clustering is 0.760, which is significantly higher than that of DEXUS (0.481). Moreover, in this BC dataset, six differentially expressed (DE) genes were validated experimentally by qPCR with fold change rates greater than 5.0. Three of the six validated DE genes are predicted by SDEAP while two are among the predicted DTE genes by DEXUS.
SDEAP Identifies More Validated Marker Genes Specific to Cell TypesIn this experiment, an SC RNA-Seq dataset of two cell types, 12 mouse ES cells and 12 primitive endoderm (PrE) cells, is downloaded from the NCBI GEO database with accession code GSE42268. The downloaded reads do not contain any adapter and are mapped to the mouse reference genome (mm9) by TopHat 1.4.1 with the default parameters. The same data-preprocessing protocol in the Section 3.2.1 is applied to this dataset. In this dataset, there are 17 manually selected biomarker genes reported in the literature (). The ranks of the 17 biomarker genes in the ranked lists of DTE genes predicted by SDEAP and DEXUS are summarized in Supplementary Tab. S3. Using the FDR threshold 0.1, SDEAP predicts 1614 DTE genes. All 17 biomarker genes are included in these predicted DTE genes. Among the 1614 top-ranked DTE genes predicted by DEXUS, only 13 of the 17 biomarkers are included. 8 of the 17 biomarkers were further validated by qPCR in (). While all of these 8 validated biomarkers are in the prediction of the DTE genes by SDEAP, 2 of them are missed in the prediction by DEXUS. The better coverage of the biologically meaningful biomarkers by SDEAP suggests that it can provide a more comprehensive picture of transcript expression. On the other hand, the clustering results based on the predicted DTE genes by SDEAP and DEXUS are equally well as shown in Supplementary. This can perhaps be explained by the fact that the two cell types have many redundant biomarkers in the sense that even if some of them are missed, the rest are still able to separate the cell types.
SDEAP Is Better at Separating Cell-Cycle PhasesThe SC RNA-Seq dataset of 35 samples with the accession code GSE42268 is downloaded from the NCBI GEO database where the cell-cycle phases of each cell is known a priori. The downloaded reads do not contain any adapter. Among the 35 samples, there are 20 cells in the Growth 1 phase (G1), 8 in the pre-mitotic/mitotic (G2/M) phase and 7 in the synthesis (S) phase. All sequenced reads of each RNA-Seq sample are aligned against the Ensembl GRCh37.62 B (mm9) reference genome using TopHat 1.4.1 with the default parameters as done in the previous subsections. With the same FDR threshold of 0.1, the 532 top-ranked genes in the predictions by SDEAP and DEXUS are used to hierarchically cluster the samples and the clustering results are illustrated in, respectively. The cells in the dendrograms are partitioned into three clusters, as shown by the red boxes, and clusters are then compared with the three cell-cycle phases. In the clustering by SDEAP, some S cells are clustered together with G1 cells while the other S cells are with G2/M cells. This makes some sense because the S cell-cycle phase is between the G1 and G2/M phases in the cell-cycle and hence the expression profiles of some S cells are closer to those of G1 cells while the other S cells might be closer to G2/M cells. In general, the G1 cells and G2/M cells are well separated by SDEAP. However, the clustering by DEXUS fails to provide a reasonable partition consistent with the cell-cycle phases. As a result, the Jaccard index of the DEXUS clustering (0.261) is much lower than that of the SDEAP clustering (0.391). The similarity of the 35 SC samples encoded by the expression features of the predicted DTE genes is further visualized in the 3D space by principal component analysis (PCA), as shown in(e) and 3(f). In the PCA transformation using the DTE genes predicted by SDEAP, although some S cells are mixed with G1 and G2/M cells, the cells of the three cell-cycle phases are still visually separable. However, in the PCA transformation using the DTE prediction of DEXUS, all cells of the three cell-cycle phases are mixed together such that the separation between the cell-cycle phases becomes more subtle. In our simulation experiments, we concluded that SDEAP is less sensitive to outliers in SC RNA-Seq data than DEXUS and is able to discover more true DTE genes that characterize the biological conditions in a population. The above clustering results on real SC RNASeq data support these claims. Note that since this dataset does not offer any qPCR validated DTE genes, we are unable to compare true DTE genes predicted by the methods as in the previous two experiments.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Experimental Results SDEAP and DEXUS are tested on both simulated and real datasets. In our simulation study, several realistic configurations of real RNA-Seq data are considered. In the first simulation, bimodal RNA-Seq data, as assumed in DEXUS, are simulated, while data are generated from three or more overlapping groups in the second simulation. Noise unique to single-cell RNA-Seq is introduced in the third simulation to test the robustness of the methods in dealing with data with high background variance. The simulation study performed in (Kimes et al., 2014) is repeated as the forth simulation experiment to assess the performance of SDEAP in calling DS genes. The results of SDEAP are then compared with those of SigFuge reported in (Kimes et al., 2014). Moreover, the performance of SDEAP is also compared with that of three popular DTE analysis methods for data with predefined biological conditions, namely DESeq2, Cuffdiff 2 and edgeR. In our experiments on real data, we assume that if the DTE genes are correctly predicted, the expression features of the predicted DTE genes can then be used to reconstruct the biological conditions of the input samples. Hence, given the expression features from the predicted DTE genes, all samples are clustered by the hierarchical clustering package MADE4 which is widely used in gene expression analysis (Culhane et al., 2005). Hierarchical clustering is performed using the average linkage clustering algorithm in MADE4 while the measure of similarity is the Pearson correlation of expression features. Note that, the partitions (or clusterings) made from the Dirichlet model are for calling DTE genes and may be coarser than the partition corresponding to the biological conditions. Ideally, the biological conditions of samples should represent a refinement of the partition obtained on each individual expression features, as illustrated by an example in Supplementary Fig. S1. To avoid biases due to the sizes of genes, if a predicted DTE gene has more than one differentially expressed feature, the feature with the greatest significance measurement, i.e., FDRs in SDEAP or I/NI scores in DEXUS, is selected as the representative expression feature for the DTE gene. Although our real data analysis will include two experiments on single-cell RNA-Seq data, the extended protocol of DESeq2 for single-cell RNA-Seq data is not compared in the experiments because it requires spike-in ERCC information which is not provided in our single-cell RNA-Seq datasets. Note that DEXUS provides the I/NI scores as the output which cannot be compared with the FDR scores from SDEAP. Hence, we set a widely used FDR value of 0.1 as the threshold to call DTE genes in SDEAP. DEXUS is compared by using the same number of top-ranked genes in its prediction.
.1.4 Robustness on Simulated SC Data Single-cell RNA-Seq serves as a fundamental tool to measure the expression of transcripts in individual cells and has numerous applications in biological research. However, due to the low abundance of transcripts in an individual cell, the technical noise in single-cell (SC) RNA-Seq data is much higher than that in regular RNA-Seq data (Buettner et al., 2015). Moreover, some transcripts of genes with moderate or high abundance in one cell may not be detected in another cell (Buettner et al., 2015). In our simulated SC RNA-Seq data, outliers unique to SC RNA-Seq data, as described in the literature, are included in the simulation to test the robustness of the two DTE analysis methods on noisy RNA-Seq data. See the Supplementary Materials for the protocol used to simulate our SC RNASeq datasets. We reuse the group sizes in the above experiments on regular RNA-Seq data to study the prediction accuracy of SDEAP and DEXUS on balanced and unbalanced SC data. The assessment of the performance of the two methods on four simulated SC dataset is summarized in Fig. 2(a) and the accuracy in estimating the numbers of conditions by SDEAP is summarized in Fig. 2(b). The false positive rates of the two methods are shown in Supplementary Fig. S2(c). Similar to the results on the simulated regular RNA-Seq data, SDEAP significantly improves the precision and recall scores of DEXUS by at least 0.273 and thus achieves much better overall performance score AUCpr. This shows that SDEAP is more robust with respect to the increased background noise. Note that among the four configurations, DEXUS has very low prediction accuracy, at most 0.222 and 0.231 in precision and recall, respectively, except on the balanced binary configuration (50,50). This suggests that DEXUS may not be suitable for treating SC data. The conclusion is consistent with the results of our later experiments on real SC data. Due to the high background noise, SDEAP achieves significantly lower false positive rates than those obtained by DEXUS as illustrated in Supplementary Fig. S2(c). However, the false positive rates of SDEAP on the SC datasets are much higher than those on the regular RNA-Seq data. At the same time, the accuracy in estimating the number of conditions is lower than that on the regular RNA-Seq samples in general as shown Fig. 2(b). 3.1.5 Detecting Changes in the Relative Abundance of Transcripts To compare the performance of SDEAP, DEXUS and SigFuge in DS analysis, we repeat the simulation experiments in (Kimes et al., 2014) as follows. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Conclusion We have introduced SDEAP, an algorithm to identify DTE genes for a population of RNA-Seq samples with unknown conditions based on the splice graph data structure. SDEAP takes advantages of an accurate graph modular decomposition algorithm for discovering ASMs, efficient feature extraction for reducing the impact of technical noise, and a robust Dirichlet mixture model for inferring the groups in a population without assuming the number of biological conditions. These features make SDEAP more suitable for many practical applications. As shown in our simulation and real data experiments, the DTE features identified by SDEAP suffice to separate the subtypes of cancer, detect cell types and classify cell-cycle phases. We expect that SDEAP will serve as a useful differential expression/splicing analysis tool for RNA-Seq data in population studies with unknown biological conditions.
