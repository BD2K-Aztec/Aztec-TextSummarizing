Motivation: Detection and quantification of the absolute DNA copy number alterations in tumor cells is challenging because the DNA specimen is extracted from a mixture of tumor and normal stromal cells. Estimates of tumor purity and ploidy are necessary to correctly infer copy number, and ploidy may itself be a prognostic factor in cancer progression. As deep sequencing of the exome or genome has become routine for characterization of tumor samples, in this work, we aim to develop a simple and robust algorithm to infer purity, ploidy and absolute copy numbers in whole numbers for tumor cells from sequencing data. Results: A simulation study shows that estimates have reasonable accuracy, and that the algorithm is robust against the presence of segmentation errors and subclonal populations. We validated our algorithm against a panel of cell lines with experimentally determined ploidy. We also compared our algorithm with the well-established single-nucleotide polymorphism array-based method called ABSOLUTE on three sets of tumors of different types. Our method had good performance on these four benchmark datasets for both purity and ploidy estimates, and may offer a simple solution to copy number alteration quantification for cancer sequencing projects. Availability and implementation: The R package absCNseq is available from
INTRODUCTIONCopy number alterations (CNAs) are an important class of somatic aberrations in tumor genomes and have been extensively studied in the hope of understanding the mutational landscape and clonal evolution of cancer (). Highthroughput platforms such as array comparative genomic hybridization (), single-nucleotide polymorphism (SNP) arrays () and next-generation sequencing (NGS) () have been widely used to measure CNAs. The direct readout from these platforms is a measure of the relative DNA content between a tumor sample and its normal counterpart, over a set of genomic regions. However, at the cellular level, CNAs are integers: for example, a region of DNA with normal copy number 2, corresponding to the two chromosomes, may be duplicated in one chromosome, resulting in copy number 3, or deleted, resulting in copy number 1. To estimate absolute copy numbers from the observed ratio of tumor to normal DNA, it is necessary to know two additional parameters, tumor purity, which is the ratio of tumor cells to total cells in the sample, and tumor ploidy, which is the average copy number of the entire tumor genome and can be used to account for whole-genome duplication events in the tumor (). Tumor ploidy may itself be a prognostic factor in cancer (). A related issue occurs with detection of somatic single nucleotide variants (SNV) (). As with CNAs, it is more informative to know the integer multiplicity of each gained somatic SNV, rather than the percentage of the alternate allele in the tumor/stromal mixture. Incorporating purity, ploidy and absolute copy number information may also help popular SNV callers like samtools () and GATK () to reduce both false-positive and falsenegative calls. All this highlights the importance of accurately estimating the absolute copy number information from noisy genomic data. Recent work addressing this issue has aimed to control for the effects of either tumor purity or ploidy or both in CNA detection (). ABSOLUTE () uses allele-specific copy ratios from SNP array data to infer purity, ploidy and absolute copy numbers and has demonstrated high accuracy. In principle, ABSOLUTE can also be extended to sequencing data, although the working pipeline and performance on sequencing data are not yet published. As more cancer samples are sequenced using NGS technology and as whole-exome sequencing (WES) becomes a routine platform for characterization of tumor samples, there is an urgent need to develop a similar tool for NGS.developed a method to estimate tumor purity from the deep whole-genome sequencing data; however, their method does not offer the estimation of ploidy and absolute copy numbers, and has not been shown to work equally well on WES data. In this work, we develop a simple and robust statistical method to estimate tumor purity, ploidy and absolute CNAs from WES data. We validated our method by comparing our purity and ploidy estimates against independent gold standard *To whom correspondence should be addressed. values using recently published exome data from 31 cancer cell lines (), 16 breast (), 16 prostate (The Cancer Genome Atlas Research) and 17 glioblastoma cancer patients (The Cancer Genome Atlas Research Network, 2008). We also study the effects of the existence of subclonal populations or segmentation errors on the accuracy of the purity estimation. To the best of our knowledge, this is the first work that has provided a working pipeline to estimate purity, ploidy and absolute copy numbers from raw WES data, which has been validated on several independently published WES datasets. We implemented the algorithm in an R package called absCNseq that is freely available from our Web site (http://biostats.mcc.ucsd.edu/files/absCNseq_1.0.tar.gz).
METHODS
Exome sequencing datasets and post-alignment processing pipeline2.1.1 NCI60 cell line dataset The NCI60 tumor cell lines from multiple tissues of origin have long been used for in vitro anticancer drug screening, and their molecular and cellular characteristics have been well studied by a variety of biological assays. In particular, they have been individually karyotyped by the spectral karyotyping (SKY) assay (). Just recently, the majority of these cell lines also had their exomes sequenced (); hence, this represents an ideal validation dataset for our ploidy inference. We used the SKYdetermined modal ploidy as the reference ploidy value and compared our ploidy estimates with these reference values.
dbGAP breast cancer datasetWe obtained published data from paired breast tumor-normal samples, which had both SNP array data (Affymetrix Genome-Wide Human SNP Array 6.0) and WES data (Illumina GA II, average coverage 100) (). Published estimates of purity and ploidy were available for these samples using ABSOLUTE on the SNP array data. We downloaded the aligned read files (BAM files) from dbGAP () under the study number phs000369.v1.p1 for the first 23 Mexican subjects (BR-M-005 through BR-M-085) in the published Supplementary Table S2 (). We extracted the experimental information from the BAM file headers. We excluded seven subjects from further analysis because the sequencing date for the matched germ line and tumor samples were in different weeks, and thus must have been in different sequencing runs. The remaining 16 subjects all had the matched samples sequenced in the same week. Interestingly, we found that the mean coverage ratio across the genome recapitulated our inclusion/exclusion rule almost perfectly: the mean coverage ratios are all close to 1.0 for the samples we included, and obviously further away from 1.0 for the excluded samples (Supplementary). This supports our selection of samples for this analysis, as it implies that there may exist systematic bias between different sequencing batches.. For all the WES data, the BAM files () have been realigned, deduplicated and recalibrated. We used samtools (version 0.1.18) () to count the number of total reads that were properly paired and aligned in each BAM file, and used this as a normalization constant to compare the coverage depth between the paired tumor and germ line DNA samples. We then used varscan2 (version 2.3.2) () to compute the ratio of coverage between the paired tumor/normal DNA samples for each bin, with bins determined by varscan2. The bin size was 100 bp. We used the DNAcopy package () to perform copy number segmentation. Segments 5200 bp in length were excluded because short segments are likely caused by technical artifacts. In addition to calling copy number ratios, the varscan2 software also outputs a set of high-confidence somatic SNVs in the tumor exome. We computed the observed allele frequencies for these somatic SNVs, which provide orthogonal purity information to copy number variation. We included both the segmented copy ratio information and the SNV allele frequencies in our objective function to be optimized, as described later in the text.
TCGA tumor dataset
Statistical frameworkappears once in each germ line cell (copy number 2) and an integral number of times in each cancer cell, q m, i times for the maternal copy and q p, i times for the paternal copy. Then the copy number in the tumor for the segment is q i  q m, i  q p, i , which is an integer. For a subclonal segment, q i is the average copy number over the differing cancer cell populations that form the tumor subclones, and so may not be an integer. It is important to note that segmentation errors can also cause q i to not be an integer, with q i then defined to be the average copy number over the w i bases comprising genomic segment i. To relate copy number to genomic ploidy, note that q i w i is the total number of base pairs of DNA from genomic segment i per tumor cell and 2w i the corresponding number for a germ line cell, so that the relative copy number q i =2 gives the ratio of total DNA from a cancer cell relative to a normal cell for this segment. Then total genomic DNA in an average tumor cell is given by P i q i w i , and so twice the ratio of tumor to germ line DNA is given byHowever, 0 may not reflect the proportion of aligned reads captured from tumor relative to germ line cells because the capture efficiency of the sequencing may differ between genomic segments, as represented by the parameters i. Hence, we define the sequencing ploidy asOf the T t total aligned reads from the tumor sample, T t are expected to be from the tumor and 1  T t from stroma, with  =  21  : 2
A copy-numberbased ratio estimator Expected read depthfor segment i in the tumor sample, Ex i , can be expressed in terms of purity , copy number q i and expected germ line depth Ey i   i. First, the total read count in the tumor sample, overall and in segment i, is the sum of reads from stromal cells, denoted with subscript s, and from cancer cells, denoted by c, that is,The total stromal reads T s are not observed, but are equal to 1  T t. They will distribute across the genomic segments in expected proportion to 2 i w i =T g , so that for each segment the expected number of stromal reads in the tumor sample is given by the following equation:On segment i, the cancer to stromal DNA is in the ratio q i : 21  , so that, assuming equal capture efficiency for the cancer and stromal DNA within the segment,Combining these expressions,Equation (3) suggests use of a ratio estimator based on the normalized ratio of means r i  R 1 x i =y i to estimate the parameters of interest and q i , and thus .
AnSNV-frequencybased estimator Suppose segment i contains one or more loci with an SNV, and let m(i) be the total number of SNVs on the segment, and f j , j  1. .. mi, be the corresponding observed variant allele proportions out of the total aligned reads from the tumor sample, for each of the SNVs. By similar arguments as above, the expected SNV allele frequency may be estimated by the following:where s j is the absolute copy number of the somatic allele at locus j. Because up to q i copies of tumor DNA may carry the mutation, s j q i. Therefore, the observed allele frequencies f j can also be used to estimate and q i .
The least squares objective functionThe least squares objective function is given by the sum of two terms, one containing information about read depth, and the other about variant allele frequency,and is to be minimized over the non-negative integers s j q i and 2 0, 1. As in Section 2.2 above, on segment i, r i is the observed normalized copy number ratio and r i  R 1 x i =y i , and f j is the observed variant allele frequency for each of the m(i) SNVs residing in segment i. If there is no SNV in that segment, then f j  s j  0. The relative importance of these two parts is given by the weight parameter 2 0, 1. When  1, the objective function reduces to the simple case where only the copy number information is used. In this work, we assessed  1 and  0.5 (equal weights).
Estimation algorithmWe propose an iterative estimation scheme in which we maximize each parameter in turn, cycling through the parameters. Initially, we assume q i 2 f0, 1,. .. , Qg, so that all segments are clonal with maximum copy number Q. The purity is constrained to lie in the interval. Step 0 is an initialization step; steps 1 and 2 are iterated to convergence (relative changes in objective function 51e-4).Step 1: Assume all intervals are clonal. For each i, set q k i to solveNote that the q's and s's are available in closed form, as this step only requires rounding the right-hand term inside the absolute value sign to the nearest integer. Here we have dropped the dependence of s j on i for convenience.Step 2: Given the estimates fq k i g, fs k j g and k , use the non-linear least square method to find k1 that minimizes the objective function (5).
Grid search over initial values and 'no estimate' results Thisinteger optimization problem converges quickly. As with many integer valued maximization problems, the algorithm may find a local optimum, depending on the initial values of and. Hence, we use a grid search strategy over the starting values 0 and 0 to find the global optimum of the objective function. We initiate the core algorithm described above over a grid of starting values of purity (ranging from 0.20 to 0.95 with an increment of 0.05) and ploidy (ranging from 1.5 to 5.0 with an increment of 0.05). The set of local maxima found at convergence is inspected and filtered. Solutions that occur only from a single starting value (i.e. solutions that do not recur from multiple initialization points) are removed, as well as biologically implausible solutions (i.e. solutions outside the search range, e.g. with purity 0 or 100%). From the remaining set of stable solutions, the parameter set fq i , , g with the minimum mean-squared error is returned as the optimal estimate of copy number, purity and ploidy. Our method returns no estimate if the filtration results in no solution. The stable solution set can be retained for further inspection, as there may be more than one solution with nearly equal values of the objective function.
RESULTS
Performance on simulated dataWe used two simulation studies, the first to assess the accuracy and the second to assess robustness of our estimates of purity. We based our simulated data on the empirically observed data in our samples. We randomly chose sample BR-M-028 as a model.
AccuracyFor the first study, to generate the data, we obtained empirical values for the N segment lengths w i from sample BR-M-028. We used the estimated segment integer copy numbers q i. We then computed the true ploidy using Equation (1). We generated r i 's from N( i , 2 ) where i was computed using Equation (3) with fixed at 0.3, 0.5 or 0.7, and 2  0:1 fixed at the value obtained empirically from cancer sample BR-M-028. Thus, these data model a tumor sample with true known values of , and q i. We used a simulation size of 50, to be consistent with the more extensive simulation of robustness reported later in the text. Notably, to assess worst-case performance of the algorithm, we did not apply the filtering, which yields a 'no call' result, as described in Section 2.4.1, but instead report the values found by the optimization routine. Thus, most of the extreme values reported here would instead be 'no call' results.shows that the method appears to be unbiased; at all purity levels, the median of the estimates are near the true values. When the tumor purity is moderate to high (5070%), the variability appears to be low, with interquartile range of 0.03 at 50% purity and 0.02 at 70% purity. However, when tumor purity is low (30%), while the median estimate is still close to the true value, the 95% percentile estimate is much larger, demonstrating increased variability. This is expected because in low purity samples, the signal (tumor cell) to noise (stromal contamination) ratio is much lower, and finding the correct unique solution becomes more challenging.
RobustnessFor the second study, we used the same data as above, but allowed the q i to be non-integer. Recall that q i is the true average copy number for the ith genomic segment; q i will fall between integer values if there is an error in the segmentation algorithm, so that copy number is not constant across the segment, or if the tumor contains two or more subclonal mixtures of cells with different copy numbers, so that read depth is averaged from the two subclonal populations. Each of these circumstances is likely to hold for at least a fraction of the genomic segments that are fed into AbsCN-Seq. To model non-integer copy numbers, we used the same basic simulation setup as above. However, here we designated a fraction n/N of segments to be non-integer, with n varying from 0 to N=2. We chose N=2 as the upper limit because we thought it unlikely that more than half of segments would be impacted by a copy number event, which was either poorly estimated by the segmentation algorithm or was impacted by a difference between subclones. For each simulated dataset, we then randomly selected a subset of n segments, and for these, we set the true copy number to be a random draw from the uniform distribution U(q i  0:5, q i  0:5). For each subclonal fraction n/N and purity , we simulated 50 different r i 's. We then applied AbsCN-seq to the simulated r i 's and assessed the deviation from the true underlying as the subclonal fraction increases. Again, we did not filter out any 'no call' solutions, and so we forced the method to produce an estimate in all 50 cases.depicts the effects of the presence of subclonal segments or incorrect segmentation (i.e. non-integer q i ) on the estimated purity. The X-axis is the proportion of segments that are non-integer, and varies from 0, which is the case reported in, to 50%. The boxplots on the Y-axis show the estimated purity for each of 50 simulated datasets. True purity is shown by the horizonal line. We did not filter out 'no calls'. In practice, many of the extreme estimates of purity shown here would be replaced by 'no estimate'. At least some of the outliers seen in(and in particular, all of the estimates with  1) were due to this 'no filtration' strategy. It can be seen that the estimated purity is most accurate when the percentage of subclonal segments is 530%. As the proportion of segments with non-integer q 0 i s increases (e.g. 430%), our method tends to underestimate tumor purity, and the bias is larger when the true purity is higher. However, even in the 'worst' case, at 70% purity and with 50% of segments impacted by segmentation errors or subclonal copy number events, the median estimated purity is $66% and almost all estimates (90%) are between 58 and 73%. Hence, even in this extreme case, our method appears to give reasonably good and practically useful estimates, although they are somewhatbiased toward lower purity in the presence of segmentation errors.
Performance on real data3.2.1 NCI60 cell line dataset We downloaded WES data for 38 cell lines with the first letter from A to P. Unlike the patient tumor samples, the cell lines do not have their paired germ line exomes. Therefore, we used the nearly diploid hematopoietic cell line SR as a common reference for all other cell lines. Seven cell lines with unreasonably small or large mean coverage ratios were excluded. We ran our method on the remaining 31 cell lines and compared our ploidy estimates to the SKY-determined values (and Supplementary). Throughout the article, we recorded the top two solutions in terms of minimum fitting errors and listed in the tables the one that better matches the benchmark value. Using this approach, we obtained close ploidy estimates from the WES data as compared with the SKY benchmark values for 29 of 31 (94%) cell lines. The top first solutions and second solutions matched the SKY values for 22 and 7 cell lines, respectively. Among the two outliers, HOP-92 is known for presence of a large number of structural rearrangements () that potentially complicated the analysis. The reason why HCC2998 was the other outlier was unclear to us. If these two outliers are excluded, the Spearman correlation coefficient is 0.93 (P50.0001), the root mean squared error (RMSE) is 0.16 and the concordance correlation coefficient () is 0.94, indicating high concordance between our ploidy estimates and the SKY values for most cell lines. If using only the top ranked solution for all 31 cell lines (as compared with using 24 first and 7 second solutions as above), the RMSE is 0.55, similar to the performance of published SNP-based methods on similar cell lines ().
dbGAP breast cancer datasetWe used a publicly available exome sequencing dataset from 16 breast cancer patients (), which has published estimates of purity and ploidy from SNP array data using ABSOLUTE (). ABSOLUTE is a well-established method to estimate purity and ploidy from SNP array data, and we used its estimates as a gold standard. We applied AbsCN-seq, both with and without SNV information, to the exome sequencing data and compared the resulting estimates of purity and ploidy with those of ABSOLUTE (). The number of SNVs called in these samples ranges from 17 to 154. As expected, ploidy estimates are almost the same for AbsCN-Seq with and without SNV information unless distinct solutions are selected, asshows that SNV frequency does not provide direct information about ploidy. For estimated purity, AbsCN-seq incorporating SNV information has a higher concordance with ABSOLUTE than AbsCN-seq without this information. Hence, we will take AbsCN-seq incorporating SNV information as our default algorithm. Overall, the estimates of purity and ploidy from AbsCN-seq with SNV information have good concordance with ABSOLUTE (and). ABSOLUTE gave no estimate for three subjects (18.8% no call rate), and AbsCN-seq gave no estimate for one subject (6.3% no call rate). AbsCN-seq failed to converge to a biologically plausible solution for subject 27, leaving 12 subjects remaining for comparison. The top ranked first solutions and second solutions matched the ABSOLUTE estimates for 9 and 1 tumors, respectively. Subject BR-M-074 is the only subject with a large discrepancy in both estimated purity and ploidy (). ABSOLUTE estimates low purity (0.25) and high ploidy (3.88), assigning this sample the extreme estimate in both measures. By comparison, AbsCN-seq approximately. Simulation showing effects of subclonal fraction on estimated purity, at three purity levels (30, 50 and 70%; horizontal lines). Data modeled after tumor sample BR-M-028. X-axis: proportion of segments set to be subclonal, for which the copy number was perturbed by a uniform random shift away from its integer value. Y-axis: estimated purity for n  50 simulations. Solutions which would normally be 'no call' are included for completeness. A subclonal fraction 430% is seen to introduce some bias, but estimated purity remains reasonabledoubles the estimated purity (0.51) and halves the ploidy (1.95), giving estimates for this sample near the middle of the group. Thus, ABSOLUTE would appear to infer a whole-genome doubling event, which AbsCN-seq does not. Notably, the ABSOLUTE solution fits the exome sequencing data poorly and does not belong to the stable solution set obtained by AbsCN-seq. Thus, there appears to be a true discrepancy in estimated purity and ploidy for subject BR-M-074, with ABSOLUTE providing extreme, and AbsCN-seq mid-range, estimates. In particular, the exome sequencing data do not appear to support a whole-genome doubling event. Hence, we will take the AbsCN-seq estimate as reasonable for this sample, and omit it from further comparisons. A second subject, BR-M-038, has an alternate AbsCN-seq estimate in the stable solution set that closely matches the ABSOLUTE estimates (purity 0.49 and ploidy 1.93, shown as an open triangle on), although this alternate estimate did not belong to the top two solutions as measured by the AbsCN-seq objective function. It is plausible that, for subject BR-M-038, the discrepancy between the two methods might result from which ABSOLUTE uses an external database with expected frequency of karyotype information to adjust the rank of the observed solutions. Comparing the two series of estimates across all 12 subjects, the RMSE is 0.20 for purity and 0.35 for ploidy, respectively. Again, the moderate discrepancy of ploidy estimates is driven by the outlier subject BR-M-074 discussed earlier in the text. When this outlier subject is disregarded, the RMSE becomes 0.13 for purity and 0.22 for ploidy, respectively. Averaged over the 11 samples, the estimated purity for ABSOLUTE is 0.48 and for AbsCN-seq is 0.52, suggesting that on these samples, the SNP-arraybased ABSOLUTE estimates tend to give somewhat lower estimated purity on average than AbsCN-seq. Estimated ploidy is similar between the two algorithms, generally within 3%. Recall that the two algorithms are using independent sets of data, exome sequencing data for AbsCN-seq and SNP array data for ABSOLUTE, and so this performance appears to be reasonable. After determining the most likely purity and ploidy, AbsCNseq computed integer copy numbers q i 's and s j 's for each segment. A typical graphical representation of the CNAs on each chromosome is shown in, for subject BR-M-030 and chromosome 16.
TCGA tumor datasetTo evaluate whether our method can be applied equally well to different tumor types other than cell lines and breast tumors, we assessed our method on $20 prostate and 20 GBM tumor samples from the TCGA database.(a). Comparison of purity (a) and ploidy (b) estimates from AbsCN-seq (exome data) versus ABSOLUTE (SNP array data). The alternate estimate for BR-M-038 mentioned in the main text is shown as an open triangleWe compared the purity and ploidy estimates by our method with those from ABSOLUTE, applied to the same data. We excluded a few samples that ABSOLUTE output marked as either 'high entropy' or 'low purity', with 16 prostate and 17 GBM samples remaining for comparison (and Supplementary).shows that the two estimates are highly concordant over a broad purity and ploidy range. The Spearman correlation for purity and ploidy is 0.80 (P50.0001) and 0.91 (P50.0001), respectively, and the concordance correlation coefficients are 0.78 and 0.89, respectively. Averaged over the 33 samples, the estimated purity for ABSOLUTE is 0.581 and for AbsCN-seq is 0.589. We no longer observed the minor discrepancy we saw in the breast tumor samples, implying that the minor discrepancy might be induced by the difference between platforms. Interestingly, the distribution of the ploidy estimates for each tumor type () recapitulated what was observed in SNP array data for a larger sample size [c.f.. For example, prostate tumor ploidy shows a bimodal distribution with peaks at 2.0 and 43.5, and few intermediate cases. In contrast, the GBMs tend to have continuous ploidy in the range from 2.0 to 4.0. This cross-platform consistent pattern not only substantiates that our random samples are representative of the larger population, but also provides additional evidence that our estimates as a whole are likely reasonable.
DISCUSSIONWe have developed a statistical approach, AbsCN-seq, which can estimate tumor purity and ploidy from WES data, and then use these estimates to infer absolute copy number and absolute multiplicity of somatic SNVs in the tumor. The ploidy estimates of our method fit the SKY values well. Our method also has good concordance with ABSOLUTE, although the two differ in several aspects. First, the input data are generated from different high-throughput platforms, ABSOLUTE, in it standard form, using SNP array data while our method takes NGS data. Second, the statistical framework and implementation differ. ABSOLUTE uses a Bayesian framework, whereas our method uses a simpler frequentist approach. Third, ABSOLUTE uses additional independent information to infer which solution is most likely, such as empirical karyotype models, while our solution refers only to the data from the sample and chooses the estimate that gives the best least-squares fit to the data. Given these differences, it is encouraging to see the high concordance between these two methods on our validation datasets. For the breast cancer patients, ABSOLUTE did not make calls on three(a). Comparison of purity (a) and ploidy (b) estimates from AbsCNseq versus ABSOLUTE for 17 GBM samples and 16 prostate samples. Assignment of integer copy numbers to the segments on chromosome 16 for subject BR-M-030. Raw copy ratios and segmented copy ratios between the tumor DNA mixture and the match germ line DNA are in green and blue, respectively. The estimated absolute copy numbers in pure tumor cells are in red. As a copy ratio of 1.0 corresponds to a normal diploid segment, we multiply the copy ratios by two to bring the copy ratio and the absolute copy number to the same scale subjects, and our method made reasonable calls on all three. We are unclear whether the failure of ABSOLUTE to produce an estimate for these subjects was due to a failure in SNP array experiment or to the algorithm itself. Thus, it seems that AbsCN-seq can work for certain samples where ABSOLUTE cannot make a call. On the other hand, our method failed to produce estimates in one case where ABSOLUTE could make an estimate, thus providing complementary approaches. As has been seen by ABSOLUTE, the best fitting solution is not always the correct solution. The validation studies here show that the top two solutions of our method usually cover the correct answer, but exceptions do exist. We recommend the user to manually inspect each solution whenever possible. Although our method does not yet incorporate subclonal tumor heterogeneity, it has been shown to be robust to a considerable amount of such heterogeneity, as well as to segmentation errors, in the estimates of purity and ploidy. Our method is flexible in the sense that it can also be applied to shallow whole-genome sequencing data (), an emerging NGS application to identification of copy number variants genome-wide. However, presence of somatic mutations cannot be reliably called in these type of data, let alone the corresponding variant allele frequency. For these type of data, we can set the algorithm to only use copy number information, by setting  1. The reduced objective function (first term of Equation 5) in step 2 now has a closed form solution. Define a new parameter  =  21  : It is easy to see that when q i 's are given, Equation (3) reduces to a simple linear regression on q i 's. Then can be obtained from the estimate. A caveat arises when we apply this form of AbsCN-seq to the WES data as seen in. We observed a systematic upward bias in the purity estimates as compared with the SNP-based ABSOLUTE estimates. However, by incorporating the SNV information, such bias was greatly diminished, and this did not appear to affect the ploidy estimates. This might not be a concern in practice, as for WES data, we will always use the default form with SNV information. At this moment, it is not clear to us what is the major cause for the small remaining observed bias. Platform-specific biases in the raw copy ratio data could be one possible reason. For instance, as shown by, the algorithm relying on the Illumina SNP array data () systematically underestimate tumor purity, as compared with the ABSOLUTE method relying on the Affymetrix SNP array data. Likewise, the apparent small overestimation of purity by our method as compared with ABSOLUTE might also be attributed to the characteristics of WES data compared with SNP array data. A supporting evidence is that we did not observe such minor biases when the platform is fixed. We have not tested our method on shallow WGS data with reference to purity estimates and we do not know yet if such overestimation also exists in the WGS data. Future work will examine the performance of the method on shallow WGS data, when a benchmark dataset becomes available.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.2.1 Basic notation and description of the sequencing data The input data for AbsCN-seq are a set of N segmented genomic intervals and their accompanying observed read depths, for matched germ line and tumor samples. If the segmentation algorithm is correct, then the tumor cells have constant copy number on each segment. A segment may be clonal, in that all tumor cells share the same copy number for the segment, or subclonal, in that there are two or more subpopulations of tumor cells with different, but constant, copy numbers on the segment. In addition, the tumor sample is composed of mixed cancer and stromal cells, where the stromal cells contain germ line DNA and the cancer cells contain DNA with somatic mutations, including the copy number aberrations considered here. Let the ith genomic segment be w i base pairs in length, and let l be the read length. On the ith segment, the tumor sample has total aligned read count t x, i and corresponding read depth x i  lt x, i =w i , with total aligned reads in the sample given by T t  P N i1 t x, i. Similarly, let the germ line read depth be denoted by y i  lt y, i =w i , with total read count in the germ line sample T g. Let i  Ey i =2 be the haploid mean read depth for segment i for the germ line sample, given that total read depth is T g ; thus, i is the mean read depth expected from each homologous chromosome in the germ line sample for this segment. Note that the i capture variation in aligned read depth at different locations in the genome due to sequencing bias, which may arise, for example, from varying GC content in the genomic segment, differences in mappability for repetitive regions, differences in capture efficiency of probes in the case of targeted sequencing, or PCR bias in the amplification step. If there is no sequencing bias, so that coverage is expected to be uniform, then i for all segments i. We assume that for every segment i expected read depth is strictly proportional to total read count, so that 2 i T t =Tg is the mean read depth that would be expected from the germ line sample at total read count T t rather than T g. 2.2.2 Purity () and ploidy ( 0 ) Let be the purity of the tumor sample, that is, the proportion of cancer cells in the tumor sample. Let 0 represent the average genomic ploidy for the tumor sample, that is, twice the ratio of the average amount of genomic DNA per cancer cell relative to the total DNA within a stromal cell, so that 0  2 for a tumor with no copy number aberrations. Then in the tumor sample, the ratio of cancer to stromal DNA will be 0 : 21  , and the proportion of DNA in the sample from the cancer cells, 0 , will be 0 0 = 0  21  : 2.2.3 Segment copy number, q i First, consider a clonal segment, so that all the cancer cells have identical genomes for this segment. The biologic model is that for each of the two homologous chromosomes, maternal and paternal, the DNA sequence represented by interval i
AbsCN-seq at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
L.Bao et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
