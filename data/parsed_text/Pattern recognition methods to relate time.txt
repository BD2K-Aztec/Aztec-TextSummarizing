Motivation: Comparing time courses of gene expression with time courses of phenotypic data may provide new insights in cellular mechanisms. In this study, we compared the performance of five pattern recognition methods with respect to their ability to relate genes and phenotypic data: one classical method (k-means) and four methods especially developed for time series [Short Time-series Expression Miner (STEM), Linear Mixed Model mixtures, Dynamic Time Warping for-Omics and linear modeling with R/Bioconductor limma package]. The methods were evaluated using data available from toxicological studies that had the aim to relate gene expression with phenotypic end-points (i.e. to develop biomarkers for adverse outcomes). Additionally, technical aspects (influence of noise, number of time points and number of replicates) were evaluated on simulated data. Results: None of the methods outperforms the others in terms of biology. Linear modeling with limma is mostly influenced by noise. STEM is mostly influenced by the number of biological repli-cates in the dataset, whereas k-means and linear modeling with limma are mostly influenced by the number of time points. In most cases, the results of the methods complement each other. We therefore provide recommendations to integrate the five methods.
IntroductionComparing time courses from different types of measurements is an important topic in biological research (), because it contributes toward understanding the response of complex cellular systems to perturbations. In particular in toxicogenomics (which stands for the application of-omics technologies to toxicology), comparing time courses of gene expression with time courses of phenotypic endpoints (i.e. biomarkers for the adverse outcomes induced by a chemical compound) may help to distinguish gene expression changes related to toxicity from changes not related to toxicity (). Thepresent study focuses on comparing time courses of gene expression with time courses of phenotypic data, also called phenotypic anchoring of gene expression data. Phenotypic anchoring may provide additional insight in the response to perturbations that cannot be generated by analyzing gene expression alone. Various statistical tools can be used for phenotypic anchoring (), including pattern recognition. Pattern recognition includes clustering (e.g. k-means), classification (e.g. support vector machines) and model reduction (e.g. principal component analysis) (). Biological entities belonging to the same cluster are assumed to be functionally related (). In this study, five representative pattern recognition methods were chosen. First, we included a clustering method that is able to remove random patterns, called Short Time-series Expression Miner (STEM). Removing random patterns is important for datasets with a high number of variables compared with the number of time points (). Secondly, Dynamic Time Warping for-Omics (DTW4omics), a method that takes into account time delays in biological processes (), is considered. In contrast to clustering methods (which treat all variables in the dataset as equivalent entities), DTW4omics treats the phenotypic data as predefined profiles and searches for genes matching these profiles using a distance metric. Thirdly, Linear Mixed Model (LMM) mixtures, a clustering method correcting for variability between replicates (), is discussed. Furthermore, we applied k-means, a classical clustering method for static data. Finally, we used a regression method [linear modeling with the R/Bioconductor package limma (, to find relationships between gene expression and phenotypic endpoints. The five methods were compared with respect to their ability to extract functionally related groups of genes, their sensitivity to measurement noise, the influence of the number of time points and the influence of the number of biological replicates. The technical aspects (influence of noise, number of time points and number of replicates) were evaluated on simulated data, mimicking real expression and phenotypic data. The biological outcome was evaluated exploiting two public datasets from toxicogenomics.
Materials and methods
Pattern recognition methodsIn this study, both simulated and real datasets were analyzed by means of STEM, DTW4Omics, LMM mixtures, k-means and linear modeling with limma.gives an overview of the properties of the four methods. Calculations were performed in R (http://www. r-project.org/), except for STEM, which is a Java application. 2.1.1 Short time-series expression miner STEM () is a freely available Java tool (http://www.cs.cmu.edu/jernst/stem/) for clustering time profiles that run in parallel. STEM distinguishes between real and random patterns in time series by identifying time profiles that are significantly present in the dataset. Significance is determined by permutation testing. Phenotypic endpoints were treated as genes and added to the study. Opposite time profiles of phenotypic endpoints were also added to the study in order to determine negative relationships between genes and phenotypic endpoints. The variables in the dataset (genes, phenotypic endpoints) are assigned to the significant profiles based on similarity (positive correlation). Genes assigned to the same profile as a phenotypic endpoint are assumed to be related to that endpoint. The STEM clustering algorithm is described in detail by Ernst and coworkers (). STEM has been previously applied to cluster toxicogenomics time profiles (). In this study parameters for STEM were taken as described in previous work (). 2.1.2 Dynamic time warping for omics DTW4Omics is publicly available in-house R code (http://web.tgx. unimaas.nl/svn/public/dtw/) to detect similar patterns on different time scales, due to delays or differences in speed (). For each endpoint, a list of significant genes (false discovery rate <0.05) is produced based on the calculation of the optimal distance between time profiles and permutation testing. All genes in this list are supposed to be positively related to that endpoint. To determine negative relationships, we repeat the previous steps for the opposite time profiles of the phenotypic endpoints. DTW4Omics uses the distance function from the DTW package described by Giorgino and coworkers ().
LMM mixturesLMM mixtures is a model-based method for clustering time series that run in parallel, taking into account variability between replicates (). Phenotypic endpoints were treated as genes and added to the study. Opposite time profiles of phenotypic endpoints were also added to the study in order to determine negative relationships between genes and phenotypic endpoints. LMM mixtures divide the dataset in an optimal number of clusters. For each cluster, the average profile for the cluster is described by a LMM, with the times as fixed effects and variability between replicates as random effect. Genes assigned to the same cluster as a phenotypic endpoint (respectively, the opposite profile of a phenotypic endpoint) are assumed to be positively (respectively, negatively) related to that endpoint. The optimal number of clusters is determined using the Bayesian Information Criterion (BIC) and maximum-likelihood parameters are iteratively determined by an optimization algorithm (). To determine a starting value for the optimization algorithm for LMM mixtures, spectral clustering () was applied. Using the cluster solution from spectral clustering has previously been reported as an efficient initialization strategy for LMM mixtures (). Spectral clustering was performed in R using the 'specc' function of the 'kernlab' package (). The mixture of LMM was fitted with the 'FLXMRlmm' interface of the 'flexmix' package (Gr n and). Both R packages are available on the CRAN website (http://cran.r-project.org).
k-Means clusteringPhenotypic endpoints were treated as genes and added to the study. Opposite time profiles of phenotypic endpoints were also added to the study in order to determine negative relationships between genesNote: NA, not applicable. and phenotypic endpoints. k-Means then clusters profiles with an iterative optimization algorithm that minimizes within-cluster variability, while maximizing between-cluster variability (). Each cluster is represented by its cluster center. Genes assigned to the same cluster as a phenotypic endpoint (respectively, the opposite profile of a phenotypic endpoint) are assumed to be positively (respectively, negatively) related to that endpoint. The optimal number of clusters is selected based on the sum of squared error (SSE), the sum of squared distances between cluster members and center (). The optimal solution was calculated in R using the code available at http://www.mattpeeples.net/kmeans.html and is the number of clusters for which the SSE for the original data differs the most from the average SSE for 250 random datasets. k-Means was performed in R using the source code available at http://www.mattpeeples.net/ kmeans.html, which uses the 'kmeans' function of the 'stats' package (http://cran.r-project.org).
Linear modeling with limmaFor each phenotypic endpoint, genes that vary with that endpoint were determined by fitting a LMM to the gene expression data using the R/Bioconductor package limma () (www.bio conductor.org/packages/release/bioc/html/limma.html). Time, treatment (exposed versus control) and the phenotypic endpoint were taken as fixed effect, and replicates as random effect in the model. Using the phenotypic endpoint as a contrast (coefficient in the linear model), limma tests which genes vary significantly with the phenotypic endpoint. A cut-off value of 0.05 was taken for the false discovery rate. The regression coefficients for the endpoints determine whether the relationships are positive or negative.
Simulated dataPerformance of statistical methods can be evaluated by checking whether the results correspond with prior biological knowledge. However, often our knowledge about the underlying biology is incomplete. In this case, computer simulations are very useful to assess how well a method works (). Here, the influence on the results of making changes, for example adding noise, to a reference dataset is studied.After simulating control samples, a perturbation was simulated by changing one of the rate constants. Three biological replicates were generated for both control and perturbation by adding small random variables to the affinity constants and Hill coefficients. The reference dataset consisted of the log2-ratios for the three biological replicates. Clusters of variables relating to variables 9961000 were determined applying the four pattern recognition methods, so variables 9961000 are considered to be the endpoints. The influence of measurement noise was studied by successively adding 15%, 20% and 25% Gaussian noise to the reference data and comparing the solutions for the pattern recognition methods with the solutions for the reference dataset. Results of the reference dataset were also compared with pattern recognition results when using less time points (the first eight and six time points) and when using only two biological replicates instead of three.presents an overview of the simulated data. More details about the simulation and the Matlab code are provided in the Supplementary Data, Section 1.
Simulation method
Evaluation of pattern recognition methodsThe results for the different simulated datasets were compared with the results obtained from the reference dataset. The accuracy describes how close the results of the simulation were to the results for the reference dataset.
Real datasetsThe five pattern recognition methods were applied to two datasets obtained from the human hepatoma cancer cell line HepG2: after exposure to either benzo(a)pyrene (B(a)P), a human carcinogen, or menadione (vitamin K3), an agent producing reactive oxygen species (ROS). Both positive and negative associations with particular endpoints were determined.
Responseof HepG2 to B(a)P B(a)P is a carcinogenic polycyclic aromatic hydrocarbon, having genotoxic and non-genotoxic properties. B(a)P exposure causes, among others, oxidative stress, DNA adduct formation and apoptosis (van). Sources of exposure are (among others) wood burning, coal tar, vehicle exhaust and cigarette smoke (). Gene expression and phenotypic endpoints (DNA adducts, cell cycle, apoptosis indicative of molecular responses to DNA damage induced by the carcinogen) were measured at 12 time points after exposure to B(a)P (3, 6, 9, 12, 15, 18, 24, 30, 36, 48, 54 and 60 h). HepG2 cells were treated with 3 mM B(a)P or vehicle control. Cell cycle profiles (G1, G2/M and S phase) and apoptotic cell levels were determined by flow cytometry. DNA adduct levels were determined byPattern recognition methodshepatocellular carcinoma (). Menadione has been used as a drug therapy and sometimes also as nutritional supplement (). Gene expression and phenotypic endpoints (oxidative DNA damage, protein oxidation, cell cycle, apoptosis, which are all toxic responses inflicted by ROS) were measured at seven time points after exposure to menadione (0.5, 1, 2, 4, 6, 8 and 24 h). HepG2 cells were treated with 100 mM menadione or vehicle control. Cell cycle profiles (G1, G2/M and S phase) and apoptotic cell levels were determined by flow cytometry. Protein oxidation was determined by protein carbonyl assay, measuring protein carbonyl formation by spectrophotometry. Oxidative DNA damage was determined using the FPG-comet assay. Gene expression was determined using Affymetrix microarrays. Three biological experiments were conducted. Microarray data are available at Gene Expression Omnibus (GSE39291). Phenotypic data are available in the Supplementary Data (were determined using the R/Bioconductor package limma (), controlling for dye swaps in case of two-color arrays. 'Treatmenttimematched control' contrasts were fitted at each time point and with each treatment (exposure, control). Genes with false discovery rate lower or equal than 0.01 and absolute log fold change higher than 1.5 were selected. Log2 ratios were taken to transform the data to be normally distributed. Data were centered and unit variance scaled to make the values of all variables (genes and endpoints) comparable.
Evaluation of pattern recognition methodsOverrepresentation analyses (pathway and GO analysis) were performed on the lists of genes related to the endpoints using ConsensusPathDB, an interaction database containing pathways from 32 databases (). Pathways and GO terms with at least two genes in common with the gene lists were selected. To correct for multiple testing, only pathways and GO terms with false discovery rate lower or equal than 0.05 were selected. Overlap between the genes, pathways or GO terms was determined using the online tool Venn Diagrams (http://bioinformatics.psb. ugent.be/webtools/Venn/). Lists of overrepresented pathways and GO terms were compared with prior biological knowledge, among others from the Comparative Toxicogenomics Database ().
Results
Simulated dataLMM mixtures divided the dataset into 19 clusters (based on the BIC), while k-means only distinguished 5 clusters (based on the SSE). Because of their different properties and underlying assumptions, there is minor overlap among all of the five methods (and Supplementary). Which methods show the largest overlap is different for different variables (e.g. for variable 996 DTW4omics and k-means show the largest overlap, while for variable 1000 STEM and DTW4omics show the largest overlap). The overall biggest overlap is found between DTW4omics and k-means, followed by STEM and DTW4omics. The accuracy of the five methods for the simulated datasets is shown in. Accuracies above 80% were found for all methods after noise had been added to the data, except for limma, where accuracies for datasets with 25% noise were between 74% and 81%. Limma and k-means appeared the most influenced by the number of time points. Lowering the number of time points lowered the accuracy significantly. STEM was most influenced by the number of biological replicates available.
Real datasets3.2.1 Response of HepG2 to B(a)P Lists of genes, pathways and GO terms for each endpoint are provided in the Supplementary Excel file for each of the five methods. Applying STEM, DTW4omics and limma resulted in a separate gene list for each phenotypic endpoint. For LMM mixtures and k-means, some of the clusters contained more than one phenotypic endpoint: @BULLET DNA adducts and G1 were assigned to the same cluster by both LMM mixtures and k-means; @BULLET Apoptosis and S are assigned to the same cluster by LMM mixtures; @BULLET Apoptosis, G2 and S are assigned to the same cluster by k-means. For DTW4omics and limma, some of the gene lists had genes in common (see Supplementary Excel file, tab 'B(a)P intersections gene lists'). The other methods by definition divide a dataset into clusters that do not have genes in common. LMM mixtures divided the dataset into 11 clusters (based on the BIC), while k-means only distinguished 7 clusters (based on the SSE). Apart from a few exceptions, there was minor overlap across the five methods when comparing lists of genes, pathways and GO terms (Supplementary Data, Supplementary Figs. S2S16).present a summary of the molecular response pathways related to DNA adducts for the five methods. Detailed tables with pathway lists for all endpoints, including references to prior biological knowledge, are available in the Supplementary Data (Supplementary Tables S2S11). The pathway 'direct p53 effectors'was found by both LMM mixtures (positive relationship, seeand Supplementary) and limma (negative relationship, seeand Supplementary). Transcription factor p53 is important in signaling DNA damage (). Limma also found 10 pathways related to DNA damage response (and Supplementary).
Response of HepG2 to menadioneLists of genes, pathways and GO terms for each endpoint are provided in the Supplementary Excel file for each of the five methods. Apart from a few exceptions, there was minor overlap among all of the five methods when comparing lists of genes, pathways and GO terms (see Supplementary Data, Supplementary Figs. S17S34). Applying DTW4omics and limma resulted in a separate gene list for each phenotypic endpoint, except for the G1 and S phases wherefore DTW4omics did not find genes that were positively and negatively related, respectively. For STEM, LMM mixtures and k-means, some of the clusters contained more than one phenotypic endpoint: @BULLET apoptosis and protein oxidation were assigned to the same cluster by both STEM and k-means; @BULLET protein oxidation, G1 and S were assigned to the same cluster by LMM mixtures; @BULLET G1 and S were assigned to the same cluster by k-means. For DTW4omics and limma, some of the gene lists had genes in common (see Supplementary Excel file, tab 'MEN intersections gene lists'). The other methods by definition divide a dataset into clusters that do not have genes in common. LMM mixtures divided the dataset into 10 clusters (based on the BIC), while k-means only distinguished four clusters (based on the SSE).present a summary of the molecular response pathways related to oxidative DNA damage for the five methods. Detailed tables with pathway lists for all endpoints, including references to prior biological knowledge, are available in the Supplementary Data (Supplementary Tables S12S23). The pathway 'direct p53 effectors', an important pathway in signaling DNA damage (), was found by LMM mixtures (positive relationship, seeand Supplementary). Furthermore, LMM mixtures found two DNA damage response pathways (and Supplementary).
Computational timeThe computational time for running the analyses was about 10 s for STEM and limma, about 3040 min for DTW4omics and about 30 min for k-means (including the algorithm for determining the number of clusters) on a 64 bit Windows 7 computer, 64 GB memory, intel i5-3320 M processor. Running LMM mixtures takes 1 day for a given number of clusters, so it would, e.g., take 24 days to generate the cluster solutions with 2, 3,. .. , 25 clusters. Therefore, the calculations for different numbers of clusters were run in parallel on a 64-bit Windows 7 server, 64 GB memory, intel i7-3930 K(hexacore).Note: The range of the accuracy for the influence of noise is based on three experiments per noise level.Pattern recognition methods
DiscussionApplying pattern recognition methods to toxicogenomics time series of both microarrays and phenotypic endpoints can provide new hypotheses about interactions of the genome with the adverse outcome of exposure to a toxicant. These new hypotheses will guide wet laboratory experiments (e.g. knock down experiments) that aim to verify such new relationships. In this study, we evaluated five pattern recognition methods. The main focus is on methods developed for time series methods, except k-means, which we added to the study in order to assess the impact of time dependencies on pattern recognition. Another method for static data, that has been frequently applied to time series, is Weighted Correlation Network Analysis (WGCNA) (), which combines correlation analysis with hierarchical clustering (). Clusters obtained by applying static-based methods on time series are often less biologically coherent than clusters determined with time-series methods (). However, this could not be observed from this study. STEM, LMM mixtures and k-means treat all the genes and endpoints as equivalent entities and cluster them all together. As a consequence several endpoints may end up in the same cluster and some clusters will have no endpoints. In our study, having several endpoints within the same cluster was found upon applying STEM, LMM mixtures and k-means. Having two or more endpoints within the same cluster has the advantage that similarity between the two endpoints is explicitly known. A drawback of having two endpoints in the same cluster is that one cannot really assess whether any particular gene in the cluster is more strongly associated with one endpoint than the other. Another drawback is that one can have only certainty that the gene expressions really match the profile of the endpoint if the endpoint is at the center of the cluster. DTW4omics treats the endpoints as profiles and matches each of the genes to these profiles. Limma uses the endpoints as fixed effects in a regression model. As a consequence, for DTW4omics and limma, each cluster has only one endpoint and a gene can match more than one endpoint or none. Clustering methods that do not correct for random patterns, like LMM mixtures and k-means divide the datasets into large clusters. This mostly leads to a large amount of pathways related to a large number of biological processes. Correcting for random patterns (like STEM) results in smaller gene lists, which has the advantage that these lists are mostly easier to interpret. A disadvantage is that if two variables are highly correlated to one of the model profiles by coincidence, the two variables would also be in the same cluster, which leads to false positives. Another drawback is that in cases when the variable is not correlated to one of the model profiles, it is not taken into account for further analysis. In this way information may be lost. While STEM, LMM mixtures, k-means and limma find gene expression modifications that covary simultaneously with the investigated endpoints, DTW4omics allows time lags and delays. Because of this property results from applying the DTW4omics approach are more influenced by the number of time points than the two other time series methods (). Limma is more sensitive to noise than the other methods (). LMM mixtures and limma need biological replicates (for modeling the random effects), while STEM, DTW4omics and k-means in principle can be applied without having replicates. However, this is not recommended because it decreases the accuracy of STEM, and to a lesser extent, of DTW4omics and limma (). STEM and DTW4omics both use a permutation test for calculating significance. Permutation tests assume independence between subsequent time points, which can be disadvantageous in case clear trends are observed in the data (). LMM mixtures clustering and limma take into account variability between replicates. The consequence of having a low number (23) of replicates is that variability (the random effect in the model) can be overestimated or underestimated. For LMM mixtures, underestimation (respectively, overestimation) of the variability between replicates leads to clustering too strictly (respectively, not strict enough), and as a consequence, may generate false negatives (respectively, false positives). Another disadvantage of LMM mixtures, and of model-based clustering in general, is that the algorithm is slow compared with other methods. For limma, underestimation (respectively, overestimation) of the variability between replicates has influence on variance shrinkage and leads to decreased (respectively, increased) sensitivity to detect relationships between genes and phenotypic endpoints, which in its turn leads to false negatives (respectively, false positives).For all five methods studied, pathway and GO analysis of these gene lists provided pathways and GO terms that have been previously related with exposure to the particular toxicant or with one of its adverse outcomes (see Supplementary Material). The hallmarks of cancer () review biological processes related to all types of cancer, and the signaling pathways involved in those biological processes. Those hallmarks are: (1) sustaining proliferative signaling; (2) evading growth suppressors; (3) avoiding immune destruction; (4) enabling replicative immortality; (5) tumor-promoting inflammation; (6) activating invasion and metastasis; (7) inducing angiogenesis; (8) genome instability and mutation; (9) resisting cell death and (10) deregulating cellular energetics. Because B(a)P is a carcinogen and menadione causes hepatocellular carcinoma, pathways known to be involved in the hallmarks of cancer provide biologically relevant hypotheses to test in follow-up experiments. For B(a)P, in particular signaling pathways related to DNA damage response are relevant (). Examples are signaling pathways involving p53, NFkB and MYC (). For menadione, pathways related to oxidative stress provide relevant hypotheses. Signaling pathways influenced by oxidative stress given in Martindale and Holbrook (2002) include pathways involved in growth arrest, cell proliferation, senescence and apoptosis. All five methods provide biologically relevant pathways and GO terms that are related to the exposure to the toxicant or its adverse outcomes (e.g. cancer, oxidative stress) (see Figs. 25 and Supplementary Material, Section 3). Therefore, in terms of retrieving biologically relevant information, there is no method that outperforms the others. If we compare the results of limma, the only regression-based model in the study, with the results for the other (correlation-and distance-based) methods, we observe the following. LMM mixtures positively relate the pathway 'direct p53 effectors' to DNA adducts, while limma finds a negative relationship. Four genes of 'direct p53 effectors' are in both the genes lists resulting from LMM mixtures and limma analysis (PCNA, TNFRSF10B, LIF and BAX), which means that these four genes have a positive correlation with DNA adducts, but a negative regression coefficient. This can be explained as follows. The regression coefficient of the limma model gives the relationship between gene expression and DNA adducts, when all other variables in the model (treatment, time) are held constant. This means that the positive relationship observed by determining similarities between the time profiles was due to another (confounding) variable. This shows an advantageous property of limma, namely correcting for confounding factors. For the menadione dataset (dataset), limma cannot find any pathways related to oxidative DNA damage, while all other methods generate a pathway list. For this dataset, applying DTW4omics results in detecting some pathways that cannot be found without time warping. One of these pathways is related to the hallmarks of cancer (). This shows the relevance of having a method taking into account time delays. Applying the methods for phenotypic anchoring described in this article results in poorly overlapping gene lists. This is a general problem of clustering algorithms. There are several reasons for the lack of consistency between methods. First, parameters (optimal number of clusters, thresholds) are determined by statistical means and not on biological properties (). Second, differences in output are due to different intrinsic properties of these methods. Limma is a regression method, while the other methods are based on similarity measures (correlation, distance). Other differences in intrinsic properties (taking into account time dependencies, delays, variance; correcting for random patterns) are shown in. For static-based methods, several attempts have already been undertaken to address these issues. WGCNA selects thresholds based on scale-free topology, a network property previously observed in biological networks (). Consensus clustering attempts to combine the different approaches, capturing the advantageous properties of each methods (). However, to our knowledge, similar attempts have not been undertaken for methods developed for time series, taking into account time dependencies and delays. In summary, we conclude that all five methods are suitable for extracting new hypotheses concerning gene-phenotypic endpoint relationships and none of the five methods outperforms the others in terms of biology. Furthermore, all methods have their limitations. Because these methods provide complementary results, we recommend developing a method that integrates the results from the different methods. A possible way to do this is to calculate a weighted score for the probability of each geneendpoint relationship based on the accuracy of the methods. Simulation experiments can guide the choice of the weight for each method. For example, because STEM was highly influenced by the number of biological replicates, we decrease the weight for STEM when having less replicates. In a similar way, we can adapt the weight of k-means and limma according to the number of time points. We can then multiply the false discovery rate for each pathway with this probability score in order to correct for inaccuracies due to the low number of replicates and/or time points.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
D.M.Hendrickx et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
