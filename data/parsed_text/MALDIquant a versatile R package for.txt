MALDIquant is an R package providing a complete and modular analysis pipeline for quantitative analysis of mass spectro-metry data. MALDIquant is specifically designed with application in clinical diagnostics in mind and implements sophisticated routines for importing raw data, preprocessing, non-linear peak alignment and calibration. It also handles technical replicates as well as spectra with unequal resolution. Availability: MALDIquant and its associated R packages readBrukerFlexData and readMzXmlData are freely available from the R archive CRAN (http://cran.r-project.org).
INTRODUCTIONMass spectrometry profiling is increasingly becoming an important tool in clinical diagnostics, for example to identify biomarkers for cancer (e.g.). Similarly as with other high-throughput technologies, sophisticated statistical algorithms are essential in the analysis of spectrometry data (). We have developed MALDIquant to provide a complete opensource analysis pipeline on the R platform (R Development) comprising all steps from importing of raw data, preprocessing (e.g. baseline removal), peak detection and non-linear peak alignment to calibration of mass spectra. MALDIquant is written as a standalone package using S4 object-oriented programming to facilitate further extension. MALDIquant was initially developed for clinical proteomics using Matrix-Assisted Laser Desorption/Ionization (MALDI) technology. However, the algorithms implemented in MALDIquant are generic and may be equally applied to other 2D mass spectrometry data.
DISTINCTIVE FEATURESIn comparison with related R packages for mass spectrometry analysis, MALDIquant features a number of unique capabilities.In particular, it implements a sophisticated non-linear peak alignment algorithm () as well as a calibration procedure for normalization of peak intensities across spectra that are modeled on a related method for sequence count data (). In addition, MALDIquant allows to analyze technical replicates and spectra with unequal resolution, a crucial feature in clinical mass spectrometry where spectra from multiple sources need to be compared.
DETAILS ON ALGORITHMSAn example workflow for mass spectrometry analysis using MALDIquant is depicted in, starting with a raw unprocessed MALDI spectrum (A), followed by smoothing, baseline correction and peak detection (B), local alignment of peaks across spectra by warping (CE) and merging and visualization (F). In the following, we briefly provide some background on the respective algorithms.
Data importMALDIquant is carefully designed to be independent of any specific mass spectrometry hardware. Nonetheless, native input of binary data files (as well as complete folder hierarchies) from Bruker flex series instruments and input of the mzXML data format is supported through the associated R packages readBrukerFlexData and readMzXmlData.
Data preprocessingFor preprocessing spectral data, MALDIquant offers a complete set of routines for smoothing, variance stabilization, baseline correction and peak detection. MALDIquant implements several approaches to adjust the baseline and uses per default the SNIP algorithm () that returns a smooth baseline and leads to positive corrected intensities ().
Peak alignmentFor comparison of peaks across different spectra, it is essential to conduct alignment. In order to match peaks belonging to the same mass,to the matched reference peaks (E). This also allows to merge aligned spectra from technical replicates. An example of a merged spectrum with identified and labeled peaks is shown in.
CalibrationQuantitative analysis of multiple spectra, e.g. to detect differentially expressed peaks, requires calibration. In order to render peak intensities comparable across spectra, a suitable scale factor for each individual spectrum needs to be determined. Experimentally, quantification of intensities is performed by reference to spike-in samples. In absence of spike-ins, MALDIquant offers a way of calibrating relative intensities by adapting an algorithm for calibrating next generation sequencing data (). In this procedure first a reference spectrum is created using the median intensity of aligned peaks from all spectra. Subsequently, a scale factor is computed for each spectrum by using a robust estimator of the overall ratio of the peak intensities of the uncalibrated spectrum versus the reference spectrum. Additionally, calibration based on total ion current is available.
Classification and feature selectionFinally, the resulting calibrated peak intensity matrix may be exported for further use in high-level statistical analysis, for instance classification and feature selection using shrinkage discriminant analysis (AhdesmakiAhdesmaki and Strimmer, 2010).R package for the analysis of mass spectrometry data
CONCLUSION
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
