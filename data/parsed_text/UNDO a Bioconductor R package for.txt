We develop a novel unsupervised deconvolution method, within a well-grounded mathematical framework, to dissect mixed gene expressions in heterogeneous tumor samples. We implement an R package, UNsupervised DecOnvolution (UNDO), that can be used to automatically detect cell-specific marker genes (MGs) located on the scatter radii of mixed gene expressions, estimate cellular proportions in each sample and deconvolute mixed expressions into cell-specific expression profiles. We demonstrate the performance of UNDO over a wide range of tumorâ€“stroma mixing proportions, validate UNDO on various biologically mixed benchmark gene expression datasets and further estimate tumor purity in TCGA/CPTAC datasets. The highly accurate deconvolution results obtained suggest not only the existence of cell-specific MGs but also UNDO's ability to detect them blindly and correctly. Although the principal application here involves microarray gene expressions, our methodology can be readily applied to other types of quantitative molecular profiling data. Availability and implementation: UNDO is available at http://biocon-ductor.org/packages.
INTRODUCTIONTumorstroma interactions serve as both a major confounding factor and an underexploited information source in studying tumor and microenvironment (). Although analyzing tumor cells in their microenvironment provides the most relevant context, mixed expressions cannot be resolved directly by global profiling (). Experimental solutions to isolate pure cells are inconvenient and have many limitations (). Current computational alternatives perform basically a supervised deconvolution (), where the required a priori information is often inaccurate or context dependent, thus greatly limits supervised approaches. Supported by a well-grounded mathematical framework, we argue that both cell-specific expression profiles and mixing proportions can be estimated in a completely unsupervised mode from two or more heterogeneous samples using raw measured gene expression values. Fundamental to the success of our approach is the geometric identifiability of cell-specific marker genes (MGs) warranted by (i) non-negativity of gene expression values and (ii) co-definition of distinct phenotypes and cellspecific MGs. The UNsupervised DecOnvolution (UNDO) R package adapts and extends recent unsupervised deconvolution framework in the literature (). Using UNDO to dissect tumorstroma mixed gene expressions, we show that () (i) the scatterplot of mixed cell expression profiles is a compressed version of the scatterplot of pure cell expression profiles; (ii) resident genes on the two radii of scatter sector are cellspecific MGs, and furthermore, the two radius vectors defined by the MGs coincide with mixing proportions. Accordingly, UNDO first detects MGs on the two radii of the scatter sector in tumor samples, then estimates cell proportions using standardized average expression values of MGs and finally uncovers pure cell expression profiles by matrix inversion. We demonstrate the performance of UNDO on both synthetic and benchmark real gene expression datasets with highly accurate deconvolution results. We further apply UNDO to estimate tumor purity in three datasets from TCGA (The Cancer Genome Atlas)/ CPTAC (Clinical Proteomic Tumor Analysis Consortium) and obtain highly comparable results with the estimates by BACOM 2.0 and ABSOLUTE based on somatic copy number data ().
DESCRIPTION
Methods and softwareWe adopt the linear latent variable model of raw measured expression data, given by (bold font indicates column vectors), *To whom correspondence should be addressed.
yThe authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. for genes i = 1,. .. , n,where s tumor (i) and s stroma (i) are the gene expression values in pure cells, x sample1 (i) and x sample2 (i) are the gene expression values in heterogeneous samples and a jk are the mixing proportions with a 11 + a 12 = a 21 + a 22 (after signal normalization). Our method is built on a linear mixture of normalized raw measured data without log transformation (). We further adopt the concept of cell-specific MGs (), i.e. genes whose expressions are exclusively enriched in a particular cell population, or mathematically s(i MG-tumor ) %As raw measured gene expression values are non-negative, when cell-specific MGs exist for each cell type, the linear latent variable model (1) is identifiable using two or more mixed expression profiles, supported by the following newly proved theorems: THEOREM 1 (scatter compression). Suppose that pure cell expressions are non-negative and x(i) = a 1 s tumor (i) + a 2 s stroma (i) where a 1 and a 2 are linearly independent, then, the scatterplot of mixed expressions is compressed into a scatter sector (, the set of light blue cross) whose two radii coincide with a 1 and a 2 .THEOREM 2 (unsupervised identifiability). Suppose that pure cell expressions are non-negative and cell-specific MGs exist for each constituting cell type, and x(i) = a 1 s tumor (i) + a 2 s stroma (i) where a 1 and a 2 are linearly independent, then, the two scatter sector radii a 1 and a 2 of mixed expressions can be readily estimated from marker gene expression values.
(See Supplementary Information for the formal proofs.)Supported by the newly proved theorems, the UNDO algorithm performs the following major steps ():(1) preprocessing: quality control and removal of the minimally expressed genes whose norm is less than a pre-fixed positive small real number and outlier genes whose norm is bigger than a pre-fixed positive large real number on normalized raw data;(2) dimension reduction when the sample number is larger than two;(3) marker gene detection: identify the indices of cell-specific MGs located around the two radii of scatter sector that correspond to the genes with minimum/maximum ratio between the two mixed samples (1b, the set of orange diamond);(4) estimate tumorstroma proportions using marker gene expressions;where MG-tumor and MG-stroma are the index sets of MGs, and n MG-tumor and n MG-stroma are the numbers of MGs, for tumor and stroma, respectively; and jj.jj denotes the vector norm;(5) estimate cell-specific expression profiles using matrix inversion.More details on UNDO method, algorithm, parameter settings and alternative schemes are given in Supplementary Information.
Experimental validation and case studyWe use five complementary evaluation criteria and the ground truth to assess the performance of UNDO method and algorithm. To assess the accuracy of cell proportion estimates, we use both Pearson correlation coefficients and E1 index (). To evaluate the accuracy of the estimated cell-specific expression profiles, we calculate the Pearson and concordance correlation coefficient (r p and r c ) between the estimated expression profile and ground truth over both 'marker genes' (correct and rigorous way) and 'all genes' (can be misleading due to significant number of housekeeping genes). To assess the match/ mismatch of membership/rank between the MGs detected from pure versus mixed expressions, we use Venn diagrams and Spearman's rank correlation coefficient. To validate UNDO method and algorithm, we reconstituted tumorstroma mixed expressions by multiplying pure expressions by pre-designed proportions. Solely using mixed expressions, UNDO accurately estimated the MGs, mixing proportions with r p = 0.99, cell-specific expression profiles with r p = 0.99 and r c = 0.99 (see Supplementary Information). We then tested UNDO algorithm on biologically mixed expressions from two breast cancer cell lines (MCF7-tumorand HS27-stroma). The mRNA extracted from the individual cell lines are mixed with pre-specified proportions. Such mixtures mimic the actual biological samples with varying abundances of the constituent subsets from one another. UNDO method again accurately estimated the cell mixing proportions with E1 = 0.0778 (r p = 0.99) and cell-specific expression profiles with average r p = 0.99 and r c = 0.98 between the deconvoluted expression profile and the measured expression profile in the pure cell lines (). The highly accurate deconvolution results obtained suggest not only the existence of cell-specific MGs but also UNDO's ability to detect them blindly and correctly. We further assess UNDO's ability to detect differentially expressed genes (DEGs) without deconvolution. We compared the ranked DEGs indices detected by UNDO directly from mixed expressions, with the 'gold standard' reference DEGs identified from pure cell expressions, using Venn diagram, Spearman's rank correlation coefficient (r rank = 0.92) and receiver-operating characteristic curve (AUC = 0.85). See Supplementary Information for more results on testing UNDO against ground truth and the estimates by BACOM 2.0 and ABSOLUTE on benchmark and TCGA/CPTAC datasets.
DISCUSSIONThe UNDO software delivers a completely unsupervised deconvolution method for dissecting tumorstroma mixed gene expressions (Supplementary). Tested on many benchmark datasets, UNDO is effective at detecting cell-specific MGs and DEGs and estimating cell proportions and cell-specific expression profiles. We expect UNDO method, with a Bioconductor R package, to be a useful tool for extracting cellspecific molecular signals in studying tumorstroma interactions in many biological contexts. Though the UNDO method currently works for two-source mixtures only, it is principally applicable to the situation where tumor or non-tumor tissue is assumed to have a common composition of cellular subtypes across the tumor samples.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
N.Wang et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
