Motivation: Directed evolution, in addition to its principal application of obtaining novel biomolecules, offers significant potential as a vehicle for obtaining useful information about the topologies of biomolecular fitness landscapes. In this article, we make use of a special type of model of fitness landscapes—based on finite state machines—which can be inferred from directed evolution experiments. Importantly, the model is constructed only from the fitness data and phylogeny, not sequence or structural information, which is often absent. The model, called a landscape state machine (LSM), has already been used successfully in the evolutionary computation literature to model the landscapes of artificial optimization problems. Here, we use the method for the first time to simulate a biological fitness landscape based on experimental evaluation. Results: We demonstrate in this study that LSMs are capable not only of representing the structure of model fitness landscapes such as NK-landscapes, but also the fitness landscape of real DNA oligomers binding to a protein (allophycocyanin), data we derived from experimental evaluations on microarrays. The LSMs prove adept at modelling the progress of evolution as a function of various controlling parameters, as validated by evaluations on the real landscapes. Specifically, the ability of the model to 'predict' optimal mutation rates and other parameters of the evolution is demonstrated. A modification to the standard LSM also proves accurate at predicting the effects of recombination on the evolution.
INTRODUCTIONA fitness landscape is a conceptual visualization of the topographic relationship between a genotype and a static fitness function, a property that will determine reproductive rate (). The properties of the fitness landscape relate to the behaviour of evolving populations and as such they have become integral tools in both * To whom correspondence should be addressed.  The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First authors. evolutionary biology and evolutionary computation. Despite their long term and widespread use, the information pertaining to real biological fitness landscapes is currently limited. As a consequence, researchers interested in studying the dynamics of evolution are often forced to rely on in silico landscape models instead. Many artificial fitness landscapes have attempted to model the properties of real biomolecular fitness landscapes. These have ranged from John Maynard Smith's simple word game metaphor for protein space (), to more complex models, which incorporate properties such as ruggedness and neutrality (). The real fitness landscapes of proteins are poorly understood and so the accuracy of these simplistic models is unknown. At the molecular level adaptive evolution is routinely studied and exploited during the process of directed evolution. The steps within a directed evolution experiment mimic Darwinian processes within a lab and closely resemble the structure of many standard genetic algorithms, methods used widely in computer science for optimization. Iterative cycles of mutation (and/or recombination) and selection have led to the development of a plethora of novel or improved biological entities (). This has been achieved without any guidance from a molecular level understanding of protein function. Sequencing the intermediates produced during the course of a directed evolution experiment reveals the series of modifications that have led to the new functionality. This approach has provided new insights into the relationship between the sequence and function of proteins and how proteins may adapt during natural evolution (). Determining how properties such as selection pressure, mutation rate and library size (population) will affect the success of future experiments, however, would require extrapolation beyond these limited evaluations. Recently, a study was undertaken to map the complete interaction profile of every possible 10-base oligonucleotide with a fluorescent protein (allophycocyanin), using the ability to perform highly multiplexed assays afforded by microarrays (). Based on over one million evaluations the data set reveals a complete sequence-fitness landscape. This still represents a simple biomolecular interaction; ideally, a resource is desired that represents more complex biological systems. No doubt, with the continuing). development and availability of high-throughput sequencers and/or microarrays, even more extensive datasets will emerge over the coming months and years. This potential development, while exciting, is only part of the battle, however. In order to understand something useful about the landscapes and the dynamics of evolution on them, appropriate models or abstractions from the raw data must be inferred. In computer science, in the field of evolutionary computation, characterizing fitness landscapes and how their features might affect evolutionary progress and dynamics is an area of intense study (). Grefenstette (1995) and Altenberg (1995) independently developed the idea of modelling/predicting evolutionary progress from fitness distribution data using, respectively, simple regressions and 'search kernels' to represent these distributions. The Landscape Machine (LSM;) was developed independently, but is a concrete implementation of Altenberg's search kernel. It models the fitness landscape of a particular abstract optimization problem as a finite state machine, representing landscapes purely as collections of phenotypic states and describes transitions between these states as a consequence of mutation. Consider S is the collection of all possible fitness values within a landscape, and s (s  S) represents a value associated with an individual (for simplicity a single sequence). When s (the parent's fitness) is transformed by mutation, a new value e (e  S, the child) is generated with a probability t se. The probabilities of transformation between all points within S can be stored within a transition matrix, T , and used to 'replace' the real landscape. In some cases, the LSM can model these transitions exactly.represents a simple MaxOnes problem. The states s 05 represent values of solutions to the problem, in which the aim is to optimize the number of 1 s within a binary string {0,1} of length L = 5 (the states match the number of 1 s within the string). Arcs indicate the transition probabilities between these states when a single random bit is flipped (0  1 or 1 0) within a string. Such a model can act as a substitute for the real problem when assessing the performance of a genetic algorithm, in which candidate solutions (variations of the string) have been replaced by these states. The success and speed of several different algorithms (meaning different population sizes, different methods of biased selection, different selection pressures and so forth) can then be assessed without the use of any genotypic information. For more complex landscapes, calculating these transitions or even storing a matrix of transitions between all points within S becomes intractable. If this is the case, points within S are pooled together into equally spaced fitness intervals (states) and transition probabilities are inferred from values generated by a sampling algorithm run on the real landscape. Using this approach, landscape state machines have shown a high degree of accuracy and specificity in predicting the performance of different evolutionary algorithms on a range of optimization problems studied in Computer Science (). LSMs were proposed not only for the study of computer science optimization problems, but also with the intention of future use in directed evolution (). In this article, we begin to examine, empirically, their potential in this area for the first time. Until now, no attempt has been made to model recombination events using LSMs. This task is not a trivial extension to the scheme since populating a three dimensional transition matrix (for the fitnesses of two parents and one child) would require a much greater number of evaluations on the real landscape. In other words, the sampling will be at an even greater order of sparseness than with the standard LSM. The LSM will also be limited in the algorithms it can assess because the sampling algorithm will only sample combinations of parents from a range dictated by the selection pressure employed and the properties of the fitness landscape. We attempt to correct for these problems using a simple heuristic, described in 'Methods' section. The performances of a range of genetic algorithms (including those that incorporate recombination) were assessed on both real landscapes and LSM abstractions of these landscapes. NKlandscapes () with different levels of epistasis and a DNAprotein interaction landscape derived from real experimental evaluations were both investigated. The LSMs proved adept at modelling the features of the landscapes, with strong correlations between the relative performances of the LSMs and the corresponding real-world algorithms. The ability to model real biological fitness landscapes with sufficient fidelity to allow predictions of the most appropriate (near-optimal) parameters of evolution (mutation rates, recombination, selection pressures, etc.) using fitness information alone seems to be an encouraging prospect for future progress in this area.
METHODS
Artificial fitness landscape: the NK ModelThe NK-model is a Boolean structure conceived by Kauffman () that assigns continuous values to combinations of bits in a binary string. The model has been used to represent the combinatorial effects of genes in a whole organism but can equally be applied to the interaction of amino acids in a protein structure. The fitness of each individual position (gene), f i , is determined by the state of K coupled residues as well as its own state. N is the dimensionality of the landscape, which is equal to L, the length of the string (chromosome). The total fitness F of a string is the average fitness across all f i , as given in Equation (1), in which i is the position assessed and  n are the states (1 or 0) of the K +1 coupled residues.The properties of the landscape can be tuned by varying K. When K is zero the landscape is smooth resulting in a single peak of the Mount Fuji type. When K is increased the landscape becomes increasingly rugged resulting in many fitness peaks, making it more difficult for algorithms with highselection pressure to find the global optimum. Two NK-landscapes were assessed in this study, with K = 2 and K = 3. Both had N = 100.
Experimentally-derived DNAprotein interaction landscapeThe second landscape was obtained from measured experimental data (). These data comprise every DNA sequence ten bases in length and their corresponding affinities with the fluorescent proteinPage: 2147 21452152
Predictive models for population performanceallophycocyanin (as measured in duplicate through hybridisation on a microarray chip). The properties of the resultant landscape were studied using various statistical measures in comparison to known NK-landscapes with noise added at a similar level to that observed in the experimental replicates. A comprehensive data set allows us to evaluate genetic algorithms' performance on the data as they would on the real landscape without the need to perform a single measurement. The data set can be downloaded from http://dbkgroup.org/direvol.htm.
Algorithm designThe algorithms that are assessed in this study are based upon a standard (, ) algorithm (), chosen as it resembles the approach employed by many experimentalists when performing directed evolution. The fittest  individuals within a population of size  are selected and reproduced iteratively over a number of generations, with diversity introduced through bit-flip point mutations and recombination. Point mutation rates refer to the probability that each bit in a chromosome will be flipped (0  > 1 or 1 > 0), or in the case of the experimental landscape that a base will be switched to one of the three alternatives. The performances of multiple algorithms with the following properties were assessed on both the experimental and real landscapes (L is the length of the sequences under investigation). The algorithms based on the NKlandscape were chosen to match those previously used to model directed evolution ().Recombination, when present, was applied at a rate of 0.6, with the two parents selected randomly, to produce a single offspring in the next generation, using standard uniform crossover (). Performance was measured as the mean best fitness observed during the course of each evolution based on 100 replicates.
Construction and assessment of LSMsIn order to construct an LSM, it is necessary to sample transitions (mutation or recombination steps) from the problem landscape. In this work, transition probabilities for LSMs were inferred from the NK-landscapes and experimental landscape using genetic algorithms with the following properties: NK-landscapes @BULLET A standard (, ) algorithm, with  = 400 and  = 40 000. @BULLET A mutation rate of 0.2/L.@BULLET Uniform crossover at a rate of 0.6.the first generation of the sampling algorithm were stored separately. Individuals were selected randomly from these states to form the starting populations of all algorithms tested using the LSMs. Genetic algorithm performance was then assessed using the LSM as it would be on the real landscape. Mutations were represented by states changes, with the new states determined by fitness proportionate selection from the transition probabilities associated with the parent's state. The algorithm performance on the LSMs was evaluated over 1000 replicates by measuring the highest state achieved or, if two algorithms achieved equal values, the number of generations taken to reach this value.
Modelling mutation ratesHigher mutation rates can be approximated by raising the transition matrix, T , to the appropriate power. For example, to model a mutation rate of 1/L, based upon a sampling algorithm using a mutation rate of 0.2/L, T would be applied five times (represented as T 5). This approach approximates the higher mutation rates but can become inexact under certain circumstances. First, if the LSM is extrapolated to a high mutation rate from an extremely low mutation rate, any errors in sampling (where the true transition probabilities have not converged) will become magnified. To assess this effect, a sampling algorithm was also run at 1/L and the performance at higher mutation rates was compared to that of the sampling algorithm run at 0.2/L. A second problem arises when modelling landscapes where L is small. An LSM modelling a mutation rate of 2/L derived from a sampling algorithm run at 1/L is essentially modelling two successive rounds of mutations. When L is small the probability that a bit (or a base) will be mutated and then mutate back to the original base in the second round of mutations is high (see). This will have the effect of distorting the transition probabilities. As L increases, the probability of these 'nullifying mutations' decreases and so they have less effect on the transition probabilities. It is simple to compute these errors exactly. Consider a sequence of length 5 and a mutation rate of 2/L. The probability that all five bits flip from 0 to 1 is (2/L) L = 0.01024. The probability that all five bits are flipped P( 1t = 1,  2t = 1... Lt = 1) by two consecutive applications of a 1/L mutation is a product of the probability that a 1 is generated (by one of two routes 0  1  1 or 0 0  1) at each position i in L. This is given by Equation (2), in which  {0,1}.where  it is the state (1 or 0) after i successive mutations. When L = 5 this equals 0.00336, about a third as much. Thus, for a short sequence and an extreme event, probabilities are underestimated. These errors could be corrected by using transition matrices for single-mutation events rather than for a fixed mutation rate.
These matricesPage: 2148 21452152
W.Rowe et al.would be applied x times, where x is determined by the expected probability of 1,2,...,L mutations. However, this would incur some cost to the simplicity of the method and would require the collection of sequence information that is not commonly available during directed evolution experiments. An alternative approach, which we adopt here, is to retain the simpler fixed mutation rate model, but to assess its accuracy. We note in advance, however, that the NK-landscape is much less likely to be affected by this problem than is the experimental landscape as L = 100 in the former and L = 10 in the latter.
Modelling recombinationTo model the consequence of crossover on genetic algorithm performance, a separate recombination transition matrix was constructed. In this 3D array, an element e ijk represents the (sample) probability of obtaining offspring of fitness k from parents of fitnesses i and j (where here fitnesses are understood to have been discretized and normalized), where the array is symmetric and i is the fitter parent. Due to considerations of the sparseness of this array, a GA evaluated on the LSM may require transitions from a parental combination that was not encountered by the sampling algorithm. To address this issue, a heuristic was implemented such that instead of using row e_ ij of the matrix, e im was used, where m  i was the closest row to j in which at least one crossover event had been encountered during sampling. A single sampling algorithm was used to populate the mutation and crossover matrices: when individuals were selected for crossover this event was used to populate the crossover LSM (fitness values were assessed before mutation was applied); when individuals were mutated these operations were stored in the mutation only LSM. To implement the effect of crossover the two matrices were used in series, with the crossover-modelling matrix applied before the mutation-modelling matrix. Compatibility between the crossover and mutation matrices was ensured by parameterizing the data into the same intervals within both matrices. Keeping the two processes separate enables the assessment of a wider range of algorithms using the LSMs. The ability of the LSMs to represent the different landscapes was measured in three different ways: @BULLET Pearson correlation between the algorithm performances on the real landscape and the LSM, at different mutation rates. For example this could represent the correlation between the performance of a (, ) algorithm with  = 2 and  = 1000 over a range of mutation rates (0.2, 0.4, 0.8, 1.0, 2.0, 3.0, 4.0, 5.0 and 10.0/L) on the experimental landscape and on the LSM. @BULLET The ability of an LSM to determine the optimal mutation rate for each algorithm. @BULLET The overall rank correlation between the performances of the LSM and (, ) search on a real landscape as measured by the Kendall tau correlation coefficient. This represents the correlation of the performance rankings on the LSM and the real landscape across all algorithms, taking into account variations in , the presence or absence of crossover, and the range of mutation rates, and therefore represents a single statistic for each landscape.
RESULTS
NK-LandscapesPlots of the performance of each of the algorithms assessed on the real landscapes and the LSMs are displayed in6; the corresponding Pearson correlation coefficients are listed in. The correlations between the values produced on the LSM and the real landscapes are high for both NK-landscapes, ranging from 0.94 to 1.00. While these values are strikingly high, in real terms they only relate to the general trends in performance of each of the algorithms (with increasing mutation rates) in isolation. The relative performance at each mutation rate was ranked for all algorithms andthe degree of correspondence between the rankings on the LSMs and the (, ) algorithm was determined using the Kendall tau correlation coefficient ().Values of tau were 0.82 and 0.64 for the landscapes where K = 2 and K = 3, respectively. Performance can also be measured as the ability of the LSMs to determine the best parameters such as mutation rate for further optimizations in experiments such as directed evolution. In practical terms, the optimal mutation rate will vary according to many factors, including the properties of the landscape and construction of the algorithm assessed (). It has for instance been observed that high mutation rates are superior when libraries are large in directed evolution (). Amongst the evolutionary computing community there has, however, been almost a prescriptive trend to use the 1/L heuristic (), to set the mutation rate. Of the 16 algorithms assessed, the LSMs predict 3 optimal mutation rates correctly (see electronic supplementary information). On average the predictions disagree with the real data by 1.79/L, with seven predictions disagreeing by more than 1/L. Nevertheless, the use of LSM-predicted mutation rates results in a significant improvement over the use of a fixed 1/L rate. A fixed 1/L mutation rate is on average inaccurate by 2.2/L. None of the optimal mutation rates correspond to 1/L and 10 algorithms have optimal
Predictive models for population performance
Experimental landscapePlots of the performance of the different algorithms on the experimental landscapes and the resultant LSMs are displayed inThere are many differences between the experimental landscape and the NK-landscapes listed previously. In particular: @BULLET The experimental landscape has been shown to be filled with local optima from noise. However, there is still a high underlying correlation between neighbouring (in terms of sequence similarity) sequences (). @BULLET The sequences are shorter than those that comprise the NKlandscapes. Despite these two factors there is an overall consistency shown by the genetic algorithms, all of which performed better at mutation rates lower than 10/L (a level at which new sequences are essentially generated randomly).The Pearson correlation coefficients of the average best fitness achieved on the real landscape and the LSM are much lower for the experimental landscape than for the NK-landscapes (). Correlations between 0.49 and 0.79 are observed for each individual algorithm and a value of tau of 0.61 from the Kendall tau correlation test was recorded, based on the overall predicted and observed values. Although these values are not as high as those for the NKlandscapes, there are still very clear trends in algorithm performance on the real landscape that are identified by the LSM. This is best exemplified by the clear differentiation of performance of the two algorithms where  = 100 (with and without crossover) from the other algorithms. In terms of predicting the optimum mutation rate the LSM performs well. The predictions differ from the actual landscape on average by only 0.88/L, with only one algorithm differing by more than 1/L. In contrast the 1/L heuristic performs poorly on this landscape, with optimal mutations rates differing on average by 2.25/L.
W.Rowe et al.
RecombinationTo determine how accurately the LSM is modelling the effect of crossover, the specificities of the predictions were assessed. To assess whether the LSMs could accurately depict the difference between algorithms with and without crossover a simple metric was applied. The performance (mean best score) of each algorithm without crossover was deducted from the performance of the same algorithm with crossover at each mutation rate. Specificity was recorded as the Pearson correlation between values derived from evaluations on the LSM and those on the real landscape. From the results in, it can be seen that there is a general trend between the performance of the LSMs at modelling the effect of crossover and the value of  for each algorithm. At low values of  the correlation between the LSMs and the real landscapes is low. As  increases the correlation increases, reaching 0.99 in each of the NK-landscapes where  = 400 and 0.97 in the experimental landscape where  = 100. At low values of , there is little difference in the performance of the algorithms with and without crossover on all of the real landscapes assessed (). When the performances of the two sets of algorithms are so similar it is difficult to model the difference between the two. As  increases, the algorithms that include crossover increasingly outperform those without and consequently the specificity metric increases.
Effect of samplingSampling the landscapes with an algorithm using a mutation rate of 0.2/L means relying on a huge extrapolation of the sampled probabilities when predicting performance at 30/L. Figures 7 and 8 represent the performance of algorithms on the experimental landscape and the corresponding LSM. For this landscape, L is low (10). From these figures, it may be seen that the relative performances of the algorithms at low and high mutation rates are incorrectly predicted by the LSMs. Specifically, in the real landscape the performances of algorithms at low mutation rates (0.2/L) are better than those at high mutation rates (10/L), whereas for the LSM this trend is reversed. This is most likely a result of inaccuracies in the transition probabilities when L is low owing to the inherent bias in the simulation of high mutation rates due to the effect that mutations can be 'undone' (see discussion above). While the LSM has been raised to the power of 10 the effective mutation rate is actually much lower.shows the correlation of performance of genetic algorithms on the real landscapes and two LSMs, derived from sampling algorithms employing a 1/L mutation rate and a 0.2/L mutation rate (only genetic algorithms run at a mutation rate of 1/L or greater were assessed). For each of the three landscapes NK-landscape with K = 2, NK-landscape with K = 3 and the experimental landscape8 different mutation rates were assessed. An increase in accuracy when sampling at 1/L was seen in, respectively, 8, 5 and 7 cases. In the four cases where there was a loss in accuracy the drop was small (0.036 maximum). In contrast, the gains in accuracy were in some cases high, especially in the experimental landscape. In Supplementary Figures 1 and 2 it can be seen, for instance, that the performance of a genetic algorithm is predicted to be better at 10/L than at 1/L. However, with the LSM sampled at 0.2/L this is not the case. Sampling at the higher mutation rate also greatly improves prediction of the optimal mutation rate compared to the use of the 1/L heuristic. Of the 16 algorithms assessed on the NK-landscapes the Page: 2151 21452152. Pearson correlation coefficients between average best fitness values observed using the NK-landscapes (K = 2, K = 3) and the experimental fitness landscape and those predicted using LSMs sampled at 1/L and 0.2/L for different ,  algorithms (where  = 40 000) with varying mutation rate (X denotes crossover)LSMs sampled at 1/L predict five optimal mutation rates correctly. Most importantly, the predictions of the LSM sampled at 1/L are better than (or at least as good as) the 1/L heuristic on every single landscape and at every selection-pressure setting, both with and without crossover.
Predictive models for population performance
DISCUSSIONPredicting the performance of genetic algorithms using limited sampling is not a new concept and a multitude of statistics have been developed to characterise the features of landscapes and the consequent effects on algorithm performance (). These statistics tend to be self validating in that they are correct only in their own terms and require prior knowledge of the landscape they are characterising. In practice these predictors of genetic algorithm hardness often underperform and are incapable even of determining whether a hillclimber (an algorithm that accepts only beneficial changes) will be more effective than a genetic algorithm. Identifying whether a landscape is 'easy' or 'hard' to search using these measures gives almost no indication of how to tackle it. Currently, the only way to tune algorithms for optimal performance on a landscape is to assess the performance of these algorithms through trial and error. LSMs are abstractions of real landscapes based on limited sampling data, allowing genetic algorithm performance to be assessed as it would be on the real landscapes. The ability of the LSM to characterize the landscape of interest can be directly measured by comparison of the performance of the genetic algorithms on the landscapes and on the LSMs. The LSMs in this study are capable of closely replicating algorithm performance on the landscape from which they are derived. The cost of generating the models described here is high, with the number of evaluations sampled from the experimental landscape (1 050 000) similar to the number required to map the entire 10-mer landscape (1 048 576). In contrast no sequence information is required to construct the LSMs. This makes LSMs cheap to construct as by-products of directed evolution experiments, which are more than capable of producing quantities of data of this magnitude.It has previously been shown that accurate LSMs can be constructed with far fewer real evaluations and an effective sampling algorithm can be beneficial to LSM accuracy (). In this study, a sampling algorithm with a low mutation rate was selected not for its performance on the landscape, but because from this low mutation rate a much greater range of mutation rates can be assessed by the LSM through matrix multiplication. This comes at a price: higher mutation rate transitions may not be sampled. The predictions made on the performance of algorithms with much higher mutation rates show only a small loss in accuracy, which is remarkable given that any error within the transition matrix is multiplied with every matrix multiplication. The most important finding of this study has been that the simple structure of the LSM is capable of mimicking the features of a real biological landscape derived from real experimental data, despite the noise that is inherent to such measurements and the complex sequence/structural interactions. It would be interesting to determine to what extent LSMs can replicate real biological fitness landscapes, and whether they can be extended to model non-static and multiple fitness functions. It may be necessary to modify the structure of the LSMs (as we have attempted here to model recombination). For instance higher order Markov models may be more appropriate for highly neutral and epistatic landscapes. Further, landscape state machines are not limited to studying static mutation rates but could also be applied to dynamic mutation rates and could feasibly be implemented in memetic algorithms (). Directed evolution experiments give an insight into the process of molecular evolution that is unobtainable at the level of whole organisms. Parent and child fitness values have previously been used to make quantitative assessments of biomolecular fitness landscapes through measures such as autocorrelation. LSMs go beyond simple landscape metrics, providing an abstraction of the real systems upon which further experiments can be performed (). With the onset of high-throughput methodologies for the assessment of modified/transformed peptides (), proteins and cells, LSMs can make use of this deluge of data in a tractable manner independent of any sequence or structural information. The resulting LSMs may serve as a resource to researchers studying molecular evolution, providing a platform beyond simplistic and often unrealistic model landscapes. In this study, we extended LSMs to generate 3D structures capable of modelling recombination in genetic algorithms (). Using several matrices representing different mutation rates serially can permit the assessment of algorithms with dynamic mutation rates and there is no reason to suggest that the structure of the LSMs could not be extended to model multiple fitness functions simultaneously. Experiments performed using NK-landscapes and an experimental landscape indicates LSMs represent a promising tool in both evolutionary computation and evolutionary biology.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 2145 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
