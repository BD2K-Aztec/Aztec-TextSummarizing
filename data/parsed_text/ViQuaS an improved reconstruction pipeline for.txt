Motivation: The combined effect of a high replication rate and the low fidelity of the viral polymer-ase in most RNA viruses and some DNA viruses results in the formation of a viral quasispecies. Uncovering information about quasispecies populations significantly benefits the study of disease progression, antiviral drug design, vaccine design and viral pathogenesis. We present a new analysis pipeline called ViQuaS for viral quasispecies spectrum reconstruction using short next-generation sequencing reads. ViQuaS is based on a novel reference-assisted de novo assembly algorithm for constructing local haplotypes. A significantly extended version of an existing global strain reconstruction algorithm is also used. Results: Benchmarking results showed that ViQuaS outperformed three other previously published methods named ShoRAH, QuRe and PredictHaplo, with improvements of at least 3.1–53.9% in recall , 0–12.1% in precision and 0–38.2% in F-score in terms of strain sequence assembly and improvements of at least 0.006–0.143 in KL-divergence and 0.001–0.035 in root mean-squared error in terms of strain frequency estimation, over the next-best algorithm under various simulation settings. We also applied ViQuaS on a real read set derived from an in vitro human immunodeficiency virus (HIV)-1 population, two independent datasets of foot-and-mouth-disease virus derived from the same biological sample and a real HIV-1 dataset and demonstrated better results than other methods available. Availability and implementation: http://sourceforge.net/projects/viquas/
IntroductionInside an infected host, most RNA viruses such as human immunodeficiency virus (HIV), hepatitis C, foot-and-mouth-disease virus (FMDV) and some DNA viruses like hepatitis B exhibit very high replication rates (). The low fidelity of the proof-reading function of the viral polymerase () coupled with this high replication rate results in the formation of a viralquasispecies population. More specifically, a quasispecies is a set of genetically related but non-identical viral mutant types (which can also be referred to as strains) that are able to co-exist within the host (). As anti-viral vaccines and drugs make use of the knowledge on various stages of the host-viral interaction process and viral replication process (), the presence of different viral strains in the population affects the natural host-immune response as well as the antiviral drug therapy (). Therefore, information about these strains, or quasispecies spectra, is of critical importance to antiviral drug design and vaccine design. In particular, such information would enhance research into viral evolution, disease progression and provide insights into the biology and pathogenesis of viruses (). During the analysis of quasispecies, identifying the co-occurrence of nucleotide level mutations is as important as identifying individual mutations. As such, there are two main challenges in this analysis: assembling nucleotide sequences of each individual strain to identify co-occurring mutations and to estimate the relative frequency of each strain within the quasispecies. Collectively, these two challenges constitute Quasispecies Spectrum Reconstruction (QSR). The most similar problem to QSR is the metagenomic binning problem as applied to bacterial metagenomes (), butemphasizes the inability of binning methods based on sequence similarity and sequence composition to discriminate between strains of the same species due to high nucleotide compositional similarity. Single-genome de novo assembly is another similar problem to QSR (). These algorithms are optimized to overcome technical sequence errors assuming the existence of a single species in the sequenced sample (). Hence given a metagenomic dataset as input, most assemblers work towards generating a single assembly of reads misinterpreting genetic variability as potential technical sequencing errors. One of the earliest methods for viral population estimation using next-generation sequencing (NGS) was proposed in. It uses a multiple read alignment and clustering strategy for read error correction, a combinatorial algorithm for strain reconstruction and a statistical model-based expectation-maximization strategy for strain frequency estimation. The method formulated in, named ShoRAH, extends the method ofand uses a Bayesian inference algorithm for read error correction and a probabilistic clustering algorithm for strain reconstruction (). Three other interesting approaches to solve the QSR problem are the combinatorial method proposed in, which was later published as a software named QuRe (), the method proposed innamed ViSpA and the method proposed in) named PredictHaplo. Current methods that address the QSR problem rely on the fact that the NGS reads of a quasispecies sample can be assigned with a unique alignment position to a known reference genome or a consensus sequence. This has become possible due to the rarity of repeats in viral genomes (). Following read alignment, a typical quasispecies analysis pipeline consists of three major steps: (i) First, the genetic diversity is determined on either overlapping or non-overlapping local windows of the reference genome by clustering reads within each window together with strategies to eliminate or correct technical sequencing errors. This is also referred to as constructing local haplotypes. (ii) Second, the global diversity is inferred by connecting the local haplotypes to form the nucleotide sequences spanning the entire genomic region of interest (i.e. strain reconstruction). (iii) Third is the step of estimating the relative frequencies of the reconstructed strains. Comprehensive reviews on different techniques used within these main steps of an analysis pipeline are found inand Beerenwinkel and Zagordi (2011). The most critical component within this pipeline is global diversity estimation, where previous studies have relied on one of two key concepts (). The most popular strategy of inferring global diversity is based on graph-based methods, as has been implemented in. Alternatively, the problem has also been approached using probabilistic clustering methods (). Less common, but a very useful third approach for quasispecies identification based on de novo assembly has been published in. Even thoughdoes not address the QSR problem from strain assembly to frequency estimation, it provides an interesting initiation point for the total strain assembly problem using short NGS reads. We have further developed the idea of using a de novo assembly algorithms for quasispecies assembly in this work. An analysis of the effects of average read length, depth of coverage and technical sequencing errors on total strain reconstruction is presented in, and it highlights the fact that inferring quasispecies population diversity of larger genomic regions using short NGS reads remains a challenging problem. In this article, we present a new analysis pipeline named ViQuaS for viral QSR using short NGS reads. Our main focus is on inferring quasispecies spectrum within a certain genomic region of a viral sample using sequence reads that are several folds shorter in length compared with the region, in the presence of a moderate level of technical sequencing errors. The novelty of our method is 2-fold. (i) We propose a novel reference-assisted de novo assembly algorithm for defining local haplotypes. (ii) We propose a significant extension to the global reconstruction algorithm presented in, based on relative coverage depths and overlap agreement of local haplotypes. Moreover, we present the first benchmark study of ViQuaS and three other existing methods named ShoRAH (), QuRe () and PredictHaplo (), on a broad spectrum of simulated data allowing for a thorough comparison of performance between the four methods. The correctness of the nucleotide sequences reconstructed is primarily evaluated based on the measures Recall and Precision. Under different simulation conditions, the four methods used in the benchmark study outperformed each other in Recall and Precision without a particular pattern. Hence, the geometric mean of Recall and Precision termed as F-score is used to measure the performance using a single measure. On the other hand, the accuracy of the estimated relative frequency distribution of the reconstructed strains is measured using KL-divergence () and root mean-squared error. ViQuaS outperformed ShoRAH, QuRe and PredictHaplo, demonstrating improvements of at least 3.153.9% in Recall, 012.1% in Precision and 038.2% in F-score in terms of strain sequence assembly and improvements of at least 0.0060.143 in KL-divergence and 0.0010.035 in root ViQuaSmean-squared error over the next-best algorithm under various simulation settings.
Materials and Methods
DatasetsWe evaluated ViQuaS on a broad spectrum of simulated viral quasispecies NGS read samples. The complexity of a sample of reads primarily depends on three independent factors; the number of different strains in the population N s , the average hamming distance between all strains (Diversity) and the extent of technical sequencing errors present in the NGS reads. An important factor in measuring the performance of the reconstruction algorithm is the number of theoretically reconstructible strains N p  out of N s. Given a set of n total number of NGS reads with a mean read length L r , N p depends on the minimum relative frequency f min  that a strain can have, in order to have a probability of at least p min of being completely covered during the sequencing process. f min is calculated according to the relationship between n total , L r , p min and the length of the reference genome, derived with the assumption of LanderWaterman model of sequencing (). In calculating f min values corresponding to the read sets described below, we set p min  0.99. In performance evaluation of the method, we used N p instead of N s as the expected number of strains to be retrieved through the method.
Platform-independent simulated datasetsThe samples used have Diversity values in the range of 110% Diversity 2 f1%; 2%; 3%; 4%; 5%; 6%; 7%; 8%; 9%; 10%g, N s in the irregularly spaced range of 3100 N s 2 f3; 5; 7; 10; 25; 50; 75; 100g and substitutional technical error probability (e) of 0% (error-free reads) and 0.1% (theoretical maximum substitutional error probability of quality trimmed reads with a PHRED threshold of 30). An irregularly spaced range between 3 and 100 was used for N s to evaluate the behaviour of methods under both small and moderately high number of strain numbers without unnecessarily increasing the number of simulated datasets. Different strains were derived by mutating a reference sequence at randomly chosen locations to achieve desired Diversity values. A total of 6400 read samples categorized in to eight sets (SS1SS8) were simulated using the read simulating software named Grinder () (version 0.5.3). Supplementaryof Supplementary File S4 summarizes the simulation parameters of SS1SS8 and Supplementary File S4 provides further details on the simulation settings. 2.1.2 Platform-independent simulated dataset with real HBV mutations To evaluate the performance of ViQuaS on 'near real' data, we designed a simulated dataset (SS9) where the strains contain mutations at nucleotide positions from 1814 to 1956 (a region of 143 nt length in the pre-C/core gene), summarized underof. Supplementaryof Supplementary File S4 summarizes the simulation parameters of SS9.
Platformindependent simulated datasets with real HIV-1 strains We simulated two psudo-real (simulated with a mix of real and artificial parameters) quasispecies sample datasets (SS10 and SS11) by using 10 real HIV-1 strains published in. Supplementary File S4 provides further details on SS10 and SS11 and Supplementary Table S3 summarizes the simulation parameters used.
HIV-1 in vitro population real datasetWe used the 5-virus-mix dataset published into evaluate the performance of ViQuaS and other existing method on real Illumina sequence reads derived from a quasispecies population generated in vitro using five known HIV-1 strains named as HIV  1 89:6 , HIV  1 HXB2 , HIV  1 JRCSF , HIV  1 NL43 and HIV  1 YU2. Sequencing has been performed on an Illumina MiSeq Benchtop sequencer. The reads from the sequencer are paired end with 2  250 bp length. We selected a 5000-bp-long genomic region encompassing the 4036-bp-long gap-pol region of the HIV-1 genome as the region of interest for the global reconstruction of haplotypes. Supplementary File S4 provides further details on data pre-processing.
Real Illumina FMDV datasetWe used two Illumina Genome Analyzer IIx datasets (GenBank accession numbers ERR180978 and ERR180979) derived from the same biological sample (GenBank accession number ERS182429) presented into evaluate the performance of the four methods on real data. Supplementary File S4 provides further details on this dataset and pre-processing.
Real Roche 454 HIV-1 datasetRoche 454 was the first new generation sequencing platform used for rare variant analysis. Even though our main focus is on data generated from Illumina platform, we used V11909 dataset derived from an antiretroviral-experienced HIV-1 infected patient, published in, to evaluate the applicability of ViQuaS on Roche 454 sequences. Supplementary File S4 provides further details on this dataset and pre-processing.
ViQuaS analysis pipelineThe proposed analysis pipeline assumes the availability of a set of NGS reads (R total ) generated out of a viral quasispecies sample and the availability of an appropriate reference genome (G ref ). G ref could either be a reference sequence of the viral type of interest obtained from a public sequence database or the consensus sequence of the multiple sequence alignment of R total. Both R total and G ref are the inputs to the pipeline, and we are interested in identifying the cooccurring mutations in each strain and the relative frequency of each strain in the population. Following is a description of the main steps of the pipeline. A detailed description of ViQuaS analysis pipeline with an example is presented in Supplementary File S1.
Read filteringR total is aligned to G ref and is partitioned into two sets denoted by R pa and R mu based on whether or not each read has a perfect alignment with G ref or not [i.e. mutated (mu)], respectively.
de novo assemblyThis step involves unsupervised partitioning of R mu into contigs based on the greedy graph-based short NGS read assembly algorithm presented in, named SSAKE (version 3.8) [a brief review of this algorithm can be found in. A major concern in using a de novo assemblers for quasispecies assembly is that they produce chimeric contigs when the strains are closely related in genetic content. SSAKE, which is a greedy graphbased de novo assembler, tries to overcome this by reusing similar reads that do not agree with an existing extension iteration at a later stage to generate new contigs (). This property of SSAKE was the main reason to choose it for this step over the wellknown de bruijn graph-based assemblers. This algorithm may still produce chimeric contigs and we address this issue under the Chimeric error correction step. The pipeline is developed in a modular architecture, such that SSAKE is replaceable with any other better performing algorithm as far as it keeps track of the individual reads contributing the contigs. SSAKE is designed and tested for assembling high-throughput Illumina short reads. Let N CE be the number of contigs produced by SSAKE. Each contig consists of a subset of overlapping reads from R mu. Moreover, within the de novo assembly algorithm, SSAKE eliminates probable technical sequencing errors. The two user defined parameters, o (which stands for the minimum number of reads needed to call a base during an extension) and r (which stands for the minimum base ratio used to accept an overhang consensus base), are used to determine the probable bases with technical sequencing errors. Further details regarding these parameters are found in the support documents provided with the SSAKE software package. Parametrization of SSAKE (i.e. setting o and r values) is done, such that mutation arising from low abundant strains is not misinterpreted as technical sequencing errors. Accordingly, o gets a value in the range of 35 and r gets the default value of 0.7. An accurate assessment of the technical sequencing error profile of the input read set will enable specific parametrization of SSAKE. We observed that o  3 and r  0.7 produces the best results under the ideal scenario of error free reads. For an appropriately quality-controlled input read set with an Illumina technical error profile (average error rate<0.12%), o  5 and r  0.7 produces the best results.
Mutation callingEach read in R mu consists of at least one mutation with respect to G ref. Hence, appropriate parametrization of SSAKE produces contigs from R mu , such that each contig contains at least one mutation. The Mutation calling step involves aligning each contig to G ref using an altered version of SmithWaterman algorithm (Smith and), which performs a semi-global alignment without end gap penalties to identify the nucleotide variations (i.e. mutation) with respect to G ref. The output of this step is N CE number of mutation sets where each contig produces one mutation set.
Chimeric error correctionThe de novo assembly algorithm does not guarantee that all the mutations present in one contig correspond to a single strain. During the graph generation step of SSAKE, reads corresponding to two different strains can have significant common overlap regions resulting such reads being included in a single contig. This phenomenon leads to mutations corresponding to different strains to be present in a single contig, which we consider as a chimeric error. On the contrary, in a technical error-free experiment, the NGS technology ensures that the nucleotide sequence captured in each read in R total corresponds to a genomic region of only one of the strains in the sample (). Because R mu is a subset of R total , the nucleotide sequence (and hence the set of mutations) captured in a single read of R mu corresponds to a single strain. In other words, we assume that no chimeric reads occur during the sequencing process. Therefore, the Chimeric error correction algorithm is based on the assumption that the set of mutations captured in a single read of R mu corresponds to a single strain. Based on the above assumption, each of the N CE number of mutation sets and the corresponding contigs will be split into two or more subsets if insufficient evidence is found in the reads of R muIn comparison to SS1, where L r  200 bp; e  0%, only SNPs are present (T  P) and f min  0:7%, SS2 has a longer read length (L r  300 bp), SS3 has a shorter read length (L r  100 bp), SS4 has a reduced depth of coverage (f min  2.1), SS5 contains sequencing errors (e  0:1%), SS6 has both a shorter read length (supporting the co-occurrence of any pair of consecutive mutations. Assume that this step results in a total of N CC number of error-free contigs (N CC !N CE ). Each of the N CC number of error-free contigs (and the corresponding mutation sets) represents a set of closely located mutations of a single strain, which is also referred to as a local haplotype. The three steps: de novo assembly, Mutation calling and Chimeric error correction constitute the proposed new reference-assisted de novo assembly algorithm.
Local haplotype frequency estimationAssume that l s and l e be the start and end alignment positions, respectively, of a local haplotype to G ref. Then, the relative frequency of the particular local haplotype is the ratio between the number of reads in R mu contributing to it and the total number of reads in R total having an alignment to G ref , entirely within l s and l e. At the end of this step, we obtain N CC number of local haplotype sequences (HS i where i 2 1;.. .; N CC ) and the corresponding local haplotype frequencies (HF i where i 2 1;.. .; N CC ).
Global spectrum reconstructionThe two goals of Global spectrum reconstruction are combining local haplotypes, such that all mutations from the same strain are grouped together forming each of the original strains and estimating the corresponding relative frequencies. The algorithm used here was derived from the algorithm described in, which is based on matching multinomial distributions. The Global spectrum reconstruction algorithm iteratively connects overlapping HS i ; HS j  sequence pairs, where i 6  j, if the overlapping regions agree with each other. If two or more such pairs show overlap agreement, the pair with the closest HF i ; HF j  value pair will take precedence. At the end of each iteration, the connected set of overlap-agreeing HS i 's gives the nucleotide sequence of the reconstructed strain. The lowest value out of the corresponding HF i 's gives the relative frequency of the reconstructed strain. The three major extensions we propose to the existing algorithm inare as follows:1. Instead of partitioning the nucleotide space of G ref into windows having a predefined constant width (the window width is typically set equal to the average read length) to infer the local diversity (i.e. local haplotypes), we allow contigs to grow along the nucleotide space of the G ref without restricting to a predefined nucleotide width. This approach reduces the number of partition boundaries at which heuristic decisions are made to connect overlapping HS i 's during the reconstruction process. 2. We use the HF i values to determine the closeness of prevalence of two overlapping HS i 's. In contrast, the existing algorithm employs the read numbers contributing to the read clusters corresponding to HS i 's. This alteration leads to accurate strain reconstruction and frequency estimation without relying on the assumption of a uniform coverage depth. 3. We hypothesize that the lowest value out of the HF i 's corresponding to the connected set of HS i 's gives the most accurate estimate to the relative frequency of a reconstructed strain. In contrast, the existing algorithm incalculates it based on the number of reads contributing to the local haplotype that belongs to both the set of connected local haplotypes and the partition window of G ref through which the maximum number of haplotypes pass. Supplementary File S1 describes the iterative algorithm in detail with an example.
ResultsPerformance evaluation of QSR is 2-fold. The performance in terms of total strain reconstruction is evaluated based on the metrics Recall, Precision and F-score as defined below.The performance in terms of frequency estimation is evaluated based on KL-divergence and root mean-squared error between the input and output relative frequency distributions. We compared ViQuaS with three other previously published software, named ShoRAH (), QuRe () and PredictHaplo (), based on entirely simulated, psudo-real and real data. A noteworthy factor in performance comparison is the distinction between the objectives of the global spectrum reconstruction algorithms used by these three methods. ShoRAH aims to output the most parsimonious set of strains that is consistent with a given set of reads (), which in general produces a larger number of strains than the actual number of strains present in the population. This leads to a better chance of producing true strains, while also producing many false in silico recombinants. In contrast, QuRe, PredictHaplo and ViQuaS aim to output a selective set of strains that is likely to be totally covered by the given set of reads, minimizing the production of false in silico recombinants. Our choice to consider only the number of theoretically reconstructible strains (N p ) as the expected number of strains in calculating Recall (eq. 1) and to disregard the number of reconstructed strains having a relative frequency less than f min in calculating Precision (eq. 2) provide practical and fair grounds to compare the performance in terms of the metrics Recall, Precision and F-score. Also, in calculating KLdivergence and root mean-squared error, we only considered the input and output strains with relative frequency values greater than f min. In Sections 3.13.3, we validate ViQuaS and benchmark it against ShoRAH, QuRe and PredictHaplo using the simulated datasets SS1SS11 using the metrics Recall, Precision, F-score, KLdivergence and root mean-squared error. In Section 3.4, we validate and benchmark the methods using average pair-wise alignment cost between the known and reconstructed haplotypes. Finally, in Sections 3.5 and 3.6, we compare the results of the four methods on real datasets. As a result of the fact that the exact nucleotide content of the strains and their relative frequencies are unknown in these real datasets, we have used other criteria as described under the respective subsections to evaluate the results.
Performance comparison on platform-independent simulated dataSample set SS1 was selected as the reference dataset to compare the performance of ViQuaS, ShoRAH, QuRe and PredictHaplo. The intention of selecting SS1 was to nullify any effect on performance from technical sequencing errors and the presence of indels, focusing solely on the capability of the four methods in strain reconstruction and frequency estimation. ShoRAH and QuRe were initially published with pyrosequencing reads () (>300 bp), and ShoRAH was later used in a comparison study () on shorter read lengths (36 bp, 75 bp and 150 bp). Hence, we chose an intermediate mean read length of 200 bp for SS1 and platform-independent simulation parameters for SS1SS8. On the reference dataset SS1, ViQuaS clearly outperformed ShoRAH, QuRe and PredictHaplo in total strain reconstruction when Diversity > 3% [(a)]. We observe that the higher the complexity of a quasispecies population, the better the performance of ViQuaS compared with ShoRAH, QuRe and PredictHaplo in terms of total strain reconstruction. ViQuaS produced the highest number of correct strains out of the four methods when Diversity!3 % as shown by the Recall graph [. ShoRAH and PredictHaplo performed at comparable levels (with ShoRAH performing marginally better) in terms of Recall, while QuRe showed the lowest levels of Recall out of the four methods. Because of the highly conservative reconstruction of strains by PredictHaplo, it performed better in terms of Precision(b)] over the other three methods, but ViQuaS performed comparably with PredictHaplo at higher Diversity levels. When considering the F-score values [(shows that both ViQuaS and ShoRAH perform at comparable levels to each other, while significantly outperforming QuRe and PredictHaplo in terms of frequency estimation. Moreover, we calculated root mean-squared error between the input and output frequency distributions and observed similar patterns to KL-divergence (refer Supplementary Figs. S23(d) and S24(d) of Supplementary File S3). Considering the performance of the four methods on the reference dataset SS1, we observe that ViQuaS performs the best in both aspects of total strain sequence reconstruction and strain frequency estimation. ShoRAH reconstructs marginally higher number of true strains than PredictHaplo and significantly outperforms PredictHaplo in strain frequency estimation. We assume that the comparable levels of performance of ShoRAH and PredictHaplo is due to the fact that both methods use of a Dirichlet process mixture model for read clustering (). Even though QuRe demonstrates the lowest levels of performance on SS1, we observe that QuRe is the only existing method out of the three used in our study that is capable of performing a successful spectrum reconstruction when the strain contain mutations in the form of indels in addition to substitutions (). Furthermore, the results of PredictHaplo are not reproducible.presents the variations in performance of the four methods under different sequencing and population parameters simulated in SS1SS8 in terms of both total strain reconstruction measured by Recall () and strain frequency estimation measured by KLdivergence (). Barring the samples within the Diversity range 13%, under which all three methods performed poorly,summarizes the performance of the three methods on SS1SS8. In comparison to SS1 [L r  200 bp; e  0% and only SNPs are present (T  P)], the performance of all four methods was negatively affected by a shorter read length (SS3: L r  100 bp) [(b) and(b)], the presence of indels (SS7: T  P; I; D) [(e) and(e)] and the presence of technical sequencing errors (SS5: e  0:1%) [(g) and(g)]. Even though a reduced read length has a significant negative impact, the performance measures tend to converge for higher Diversity and N s values(a),(a),(b) and(b)]. It was observed that the number of true positives reduces under a reduced depth of coverage. Nevertheless, in terms of Recall, the performance of the method under a reduced depth of coverage (SS4: n total  10 000) was comparable with SS1 (n total  30 000) [. This observation is due to the fact that the inverse proportionality between f min and n total makes Recall, Precision and F-score values comparable, as the number of strains to be reconstructed (N p ) reduces with an increased f min. SS6 was employed to evaluate the combined effect of a shorter read length and a reduced depth of coverage. Performance patterns of all four methods under SS6 [(a) and(a)] were comparable to the performance patterns under SS3 [(b) and(b)] providing evidence for the conclusion that a shorter read length has a significant negative effect on performance compared with a reduced coverage depth. Comparison of performance patterns between SS3 [(b) and(b)], SS1 [(d) and(d)] and SS2 [(f) andshows that for a given depth of coverage, performance of all four methods increases with an increased read length. As the mean read length (L r ) and the total number of reads (n total ) of a sequenced sample are user-controllable parameters of an NGS experiment, the presence of indels and technical sequencing errors become the two inevitable negative influential factors of a sample dataset. SS8 was employed to evaluate the combined effect of indels and technical sequencing errors on the performance of the four methods and ViQuaS showed clear advantage over ShoRAH, QuRe and PredictHaplo [(h) and(h)]. Having observed the performance patterns of the four methods over a broad range of parameters, we further evaluated the performance of them under a more adverse sequencing error rate including errors in the form of indels in addition to mismatches. We chose two sets of 10 sample populations from SS8 having parameters (Diversity  1%, N s  3) and (Diversity  7%, N s  75). These two sets represent comparatively simple and complex population structures, respectively. We generated 20 sample datasets from these populations keeping all parameters except the error rate unchanged from the values of SS7 and SS8. The error rate was set at a level of 0.3% with a 4:1 ratio between mismatch errors and indel errors.summarizes the performance of the four methods under different levels of technical sequencing errors. The observed performance pattern under e  3% shows similarity to the pattern observed in(h). In summary, ViQuaS managed to maintain its superior performance compared with ShoRAH, QuRe and PredictHaplo under the negative influences of a shorter read length, the presence of technical sequencing errors, the presence of indels and a reduced coverage depth. Under all simulated settings used in this benchmark study, ViQuaS managed to produce the highest average number of true strains (refer Recall measures in) and the most accurate frequency estimates (refer KL-divergence and root mean-squared error measures in). On average, PredictHaplo performed better than ShoRAH, QuRe and ViQuaS in terms of Precision (refer Precision measures in). This superiority in Precision becomes prominent under shorter read lengths. Nevertheless, on average, ViQuaS managed better F-score values over PredictHaplo, ShoRAH ViQuaSand QuRe. Variations in performance of the four methods in terms of Recall, Precision, F-score, KL-divergence and root mean-squared error against different values of Diversity and N s are presented in Supplementary File S3 (Supplementary Figs. S15S24). A detailed table carrying the raw results and performance measures of all 6400 sample in sample sets SS1SS8 is presented in Supplementary File S2. To compare the time efficiency, we analyzed the running times of the four methods when the most complex samples are given as input.summarizes the running times of 10 samples from each of the sample sets SS1SS8. All measurements were done on a Ubuntu 12.04 (64-bit) operating system running on a Intel V R Core TM i5-4200U CPU at 1.60 GHz  4 with 5.6-GB random access memory. It is important to note that for ViQuaS and QuRe, input reads were given in FASTA format, whereas ShoRAH was provided with BAM alignment format, and PredictHaplo was provided with SAM alignment format. Therefore, indicated running times of ShoRAH and PredictHaplo do not include the time taken to perform sequence alignment. ViQuaS demonstrated the best time efficiency under all simulation configurations. The presence of indels and the level of technical sequencing errors are observed to have minimal effect on the time efficiency of all methods except ShoRAH. For a given read length, running time is observed to have a direct proportionality to the number of reads, but a simple relationship between the running time and the read length under a constant coverage level is not observed in these results.shows the performance comparison of ViQuaS, ShoRAH, QuRe and PredictHaplo on the dataset simulated with real HBV mutations (SS9). The performance patterns with varying Diversity and N s values observed for entirely simulated datasets (SS1SS8) were similarly observed for SS9 as well. Also, ViQuaS outperformed ShoRAH, QuRe and PredictHaplo in terms of total strain reconstruction (Supplementaryof Supplementary File S5).
Performance comparison on real HBV mutations
Performance comparison on real HIV-1 strainsSupplementary Table S5 of Supplementary File S5 summarizes the performance comparison between the four methods on SS10 and SS11. All four methods were able to reconstruct a higher number of true strains under a longer read length, whereas ViQuaS showed the best performance among the four methods under both SS10 and SS11.
Performance comparison on in vitro population real Illumina HIV-1 dataGiven the 376 545 number of quality filtered reads derived from the 5-Virus-Mix in vitro population as input, none of the methods used in our benchmark study were able to successfully reconstruct any of the five known strains in the population. This confirmed our observation on simulated data that the global reconstruction of haplotypes becomes harder when the ratio between the genomic region of interest and the read length grows high.ViQuaS ShoRAH QuRe PredictHaplo. Variations in (I)-total strain sequence reconstruction and (II)-strain frequency estimation performance of ViQuaS, ShoRAH, QuRe and PredictHaplo with L r , e, presence of indels in the strains and f min. L r is the mean read length (read length $ N Lr; 25), e is the substitutional error probability of the reads and f min is the theoretically reconstructible minimum relative frequency methods. On the other hand, ShoRAH could not produce a proper output on the dataset as it experienced a runtime error and QuRe could not handle the volume of input data and resulted in a memory handling error without producing an output. A comparison between the methods in terms of average pair-wise alignment cost between the known and reconstructed haplotypes is presented in. We observed that both ViQuaS and PredictHaplo have reconstructed strains with similar pair-wise alignment distances from the true strains with the exception of ViQuaS becoming very close to reconstructing HIV  1 HXB2 (pair-wise alignment cost197).
Performance on real Illumina FMDV dataIdeally, the reconstructed populations should be identical for the two input datasets ERR180978 and ERR180979 as they were derived from the same biological sample. Indicators of similarity between the pairs of populations reconstructed using the ViQuaS, ShoRAH and QuRe are summarized in Supplementaryfor ERR180978 and a single dominant strain of 96.53% for ERR180979. Furthermore, both dominant strains in ERR180978 were different from the dominant strain of ERR180979 indicating a clear deviation from identical spectra. On ERR180978, QuRe reconstructed four strains out of which none had internal stop codons and on ERR180979, two strains were reconstructed, none of which had internal stop codons. Similar to ShoRAH, QuRe reconstructed two dominant strains of 50.32% and 48.99% for ERR180978 and a single dominant strain of 96.30% for ERR180979. Also, both dominant strains in ERR180978 were different from the dominant strain of ERR180979 indicating a clear deviation from identical spectra. On ERR180978, PredictHaplo reconstructed two strains out of which none had internal stop codons and on ERR180979, one strain was reconstructed, which did not have internal stop codons. Similar to ViQuaS, both spectra reconstructed by PredictHaplo contained a single dominant strain with relative frequencies of 98.43% (ERR180978) and 100.00% (ERR180979), respectively. Even though PredictHaplo reconstructed similar spectra on ERR180978 and ERR180979, it is evident that it significantly underestimates the richness of the quasispecies populations confirming the observation under simulated data. As second criteria of justifying the better performance of ViQuaS over ShoRAH and QuRe on sequence reads with Illumina platformspecific technical sequencing errors, we simulated 10 quasispecies populations each with a sequencing error profile that mimics Illumina platform, modelled inand implemented in the read simulator software named Grinder (), 60-bp read length and n total  100 000. Having observed the performance of the three methods over different Diversity and N s values (), we set the Diversity of these 10 samples to be around 7% to minimize performance degradation due to a low Diversity. Also, we selected N s  75 to eliminate undue bias towards any particular method by using a very low or very high value for N s. Strains were derived from the same 339-nt-long region analysed using ERR180978 and ERR180979. The overall error rate was calculated to be $ 0:11% for each sample. It should be noted that ShoRAH and QuRe were designed for Roche 454 reads. The comparison of performance of ViQuaS, ShoRAH, QuRe and PredictHaplo on this dataset is presented under Supplementary Table S7 of Supplementary File S5, which highlights the better performance of ViQuaS under Illumina error profile. Especially, the clear improvement in Recall and KLdivergence provides evidence to conclude that the populations reconstructed by ViQuaS on ERR180978 and ERR180979 have a much higher likelihood of representing the actual but unknown FMDV populations in the biological sample.
Performance on real Roche 454 HIV-1 dataAnalysis of the dataset V11909 () using ViQuaS resulted 24 different strains out of which 6 strains had internal stop codons in the protease and reverse transcriptase genes due to the presence of indels. We used two criteria to evaluate the biological validity of the remaining 18 strains. First criterion was to check the agreement between the mutations present in the reconstructed strains and that are published in. All 18 strains under consideration produce amino acid sequences in the proteasee  x%y : z denotes a technical sequencing error probability of x% with a y : z ratio between the mismatch errors and indel errors. Each value indicates mean value of the measure.All reported running time measures are in seconds and indicate the average over 10 samples. From each dataset SS1SS8, the 10 most complex (i.e. Diversity  10% and N s  100) samples were chosen for this analysis. All measurements were done on an Ubuntu 12.04 (64-bit) operating system running on a Intel V R Core TM i5-4200U CPU at 1.60 GHz  4 with 5.6-GB random access memory. For ViQuaS and QuRe, input reads were given in FASTA format, whereas ShoRAH was provided with BAM alignment format, and PredictHaplo was provided with SAM alignment format. Indicated running times of ShoRAH and PredictHaplo do not include the time taken to perform sequence alignment. Bold face figures show the best performance measure in each row.
ViQuaSand reverse transcriptase regions with mutations agreeing withexcept for one strain which had the amino acid E at the 65 th amino acid position of reverse transcriptase gene that does not agree with. As a second criterion, we checked these 18 strains for the presence of 40 highly correlated and 10 least correlated mutation pairs in the protease and reverse transcriptase regions published in. None of the 10 least correlated mutation pairs are present in these strains, and 14 and 2 out of the 40 highly correlated mutation pairs in the protease and reverse transcriptase regions, respectively, are present in these 23 strains indicating the biological validity of the strains. Results of the two validation criteria on strains reconstructed by ViQuaS, ShoRAH, QuRe and PredictHaplo are summarized in. Analysis of the dataset V11909 using ShoRAH resulted 184 different strains out of which 131 strains had internal stop codons in the protease and reverse transcriptase genes due to the presence of indels. Out of the remaining 53 strains without internal stop codons, 3 strains including the highest frequency strain had the amino acid K at the 89 th amino acid position of the protease gene and 3 strains had Y at the 48 th , 5 strains had E at the 65 th , 4 strains had N at the 73rd and 1 strain had V at the 214 th amino acid positions of the reverse transcriptase gene, all of which do not agree with. Under the second validation criteria, these 53 strains contained zero and 2 out of the 10 least correlated mutation pairs in the protease and reverse transcriptase regions, respectively, and 14 and 9 out of the 40 highly correlated mutation pairs in the protease and reverse transcriptase regions, respectively. Analysis of the dataset V11909 using QuRe resulted 15 different strains out of which 13 strains had internal stop codons in the protease and reverse transcriptase genes due to the presence of indels. Out of the remaining two strains without internal stop codons, all mutations agree with. Under the second validation criteria, these two strains contained zero and 2 out of the 10 least correlated mutation pairs in the protease and reverse transcriptase regions, respectively, and 11 and 2 out of the 40 highly correlated mutation pairs in the protease and reverse transcriptase regions, respectively. Analysis of the dataset V11909 using PredictHaplo resulted in only 1 strain, which had no internal stop codons in the protease and reverse transcriptase genes. This only strain had I at the 73 rd position that does not agree with. Under the second validation criteria, this strain contained none of the 10 least correlated mutation pairs in the protease or the reverse transcriptase regions, respectively, and 9 and 7 out of the 40 highly correlated mutation pairs in the protease and reverse transcriptase regions, respectively. The results of the two validation criteria used here () provide clear evidence to conclude that ViQuaS reconstructed a population with a higher degree of biological validity compared with ShoRAH, QuRe and PredictHaplo.
DiscussionWe present in this article, a novel method for QSR named ViQuaS. The main novelty is the proposed reference-assisted de novo assembly algorithm constituted by the three consecutive steps de novo assembly, Mutation calling and Chimeric error correction. The greedy graph-based de novo assembly algorithm and the subsequent mutation loci-guided chimeric error correction algorithm provide ViQuaS with a significant advantage over ShoRAH, QuRe and PredictHaplo when it is used to analyse short NGS reads. Our method clearly outperformed ShoRAH, QuRe and PredictHaplo on the 6810 simulated datasets used in the benchmark study, demonstrating the capability of reconstructing quasispecies spectra using short NGS read samples (100 bp, 200 bp and 300 bp) with comparatively less susceptibility to the presence of sequencing errors and indels. Given a viral genomic region of interest, the average read length of the NGS read sample and the Diversity of the quasispecies population were identified as the two most critical factors affecting the performance of ViQuaS, provided that the technical sequencing error rate is kept at a minimum level. It is evident that strain sequence assembly gets easier when the Diversity of a quasispecies population becomes higher, provided that read data are available covering the whole genomic region of(Lr  100 bp; e  0%, both SNPs and indels are present in strains T  P ; I; D, n total  30 000 and f min  1:4%). L r is the mean read length (read length $ N Lr; 25), e is the substitutional error probability of the reads, n total is the total number of reads and f min is the theoretically reconstructible minimum relative frequency. Each point indicates mean value of the measureinterest. This pattern of performance was common to all four methods considered in our study. Under all eight different simulation conditions, ViQuaS gave the highest average Recall values demonstrating the best total strain reconstruction capability. ViQuaS and ShoRAH performed at comparable levels in terms of strain frequency estimation, while clearly outperforming QuRe and PredictHaplo. Due to the unavailability of real datasets with known quasispecies populations, the best alternative for validating these methods under real world conditions was to use simulated datasets such as SS9SS11 that can be assumed to resemble such conditions. Agreement between the performance patterns of entirely simulated data (SS1SS8) and data resembling real conditions (SS9SS11) further confirmed the enhanced performance of ViQuaS over ShoRAH, QuRe and PredictHaplo. Even though the correctness of the reconstructed strains cannot be evaluated due to the unavailability of exact nucleotide content of the strains in the real FMDV samples (ERR180978 and ERR180979) and real HIV-1 dataset V11909 (), the consistency of results produced by ViQuaS on real FMDV samples and the higher degree of biological validity of the strains reconstructed from real HIV-1 data by ViQuaS indicate the applicability of ViQuaS on real sequence data and better performance over ShoRAH, QuRe and PredictHaplo. In addition, simulated samples with Illumina sequencing parameters further confirmed the superior performance of ViQuaS. In this study, we performed a comprehensive comparison of performance between ViQuaS, ShoRAH, QuRe and PredictHaplo in a broad range of Diversity and N s values. Because of the requirement of ViSpA () to have the Diversity of a sample as an input parameter, which is impractical for real data, and its poor performance under read lengths in the range of 100 bp and 200 bp, we did not use it in this study. Another method found in literature named QuasiRecomb () was also omitted from further analysis due to its poor performance even on SS2 (on which the other three method used in the analysis showed their best performance). Two of the most significant observations of the comparison study are the drastic drop of performance of ShoRAH and PredictHaplo under the presence of indels [refer(e) and(h)] and of QuRe under a shorter (100 bp) read length [. On the contrary, ViQuaS was much less susceptible against both indels and reduced read lengths. All four methods handled the sequencing error rate of 0.1% without a significant drop of performance. In particular, we observed a better performance of ShoRAH and PredictHaplo on SS9 in the presence of indels compared with their poor performance on SS7. This observation is due to the fact that some strains in SS9 do not have insertions (but SNPs and deletions), which are correctly reconstructed, while every strain in SS7 has both insertions and deletions. It was not evident that ShoRAH and PredictHaplo eliminates all insertion considering them as technical sequencing errors because some reconstructed strains in SS7 contain a few (but not all) correct insertions. This also explains the improved performance of ShoRAH on SS10 and SS11 compared with QuRe (Supplementary), as the 10 real HIV strains used in SS10 and SS11 does not have any mutations in the form of insertions. On the other hand, QuRe performed better than ShoRAH and PredictHaplo on SS9 (Supplementary) where some of the simulated HBV strains contain insertions. The second significant factor is that ShoRAH, QuRe and PredictHaplo define local analysis windows a priori. These window boundaries restrict the growth of the read clusters along the nucleotide space of the region of interest. In contrast, ViQuaS allows the contigs to extend as far as the reads provide information supporting the co-occurrence of mutations. This unrestricted growth of contigs becomes advantageous in the total strain reconstruction stage. In ShoRAH, each of the paths in the cover of the read graph contains a number of nodes equal to the number of windows (). In QuRe, the complexity of the global reconstruction algorithm is proportional to the number of windows (). The window length is typically set equal to the average read length in both ShoRAH and QuRe. Hence, the algorithmic complexity of the global reconstruction methods of both ShoRAH and QuRe increases in proportionate to the ratio between the genomic region of interest and the read length. These factors significantly affect the performance of the respective methods as been discussed in, takes advantage of the unrestricted de novo assembly algorithm and dynamically defines the local haplotype boundaries for each strain, at which the decisions for connecting local haplotypes are made. This dynamic definition of local haplotype boundaries significantly reduces the number of heuristic decisions to be made when connecting local haplotypes providing a clear advantage over QuRe. This advantage becomes prominent especially under shorter read lengths. The third source of performance enhancement in ViQuaS is the improvement of estimated strain frequency values (demonstrated in terms of KL-divergence and root mean-squared error) resulted from the second and third major extensions to the algorithm indescribed under the subsection 2.2.6. Limitations of ViQuaS include the requirement of higher computational resources when analysing longer read lengths owing to the use of SmithWaterman algorithm in the pipeline. However, this computational complexity does not degrade the performance of the pipeline. A shorter read length compared with the genomic region of interest reduced coverage depth of the sequences and a higher rate of technical sequencing errors were identified as the factors influencing negatively on the performance of ViQuaS. In fact, these factors were common to all four methods in our study and ViQuaS was observed to be the least susceptible to them. Also, all four methods failed to reconstruct strains with a relative frequency less than f min, and the correctly reconstructible minimum relative frequency increased with the presence of technical sequencing errors. We notice that the performance of the methods analyzed vary with different population characteristics and sequencing parameters. Therefore, it is a difficult task to define parameters within which a certain method performs at an acceptable level. In fact, the acceptable level of performance varies according to the needs of the individual user. Hence, the decision on choosing the best method of analysis and the appropriate sequencing parameters is left to the end user. Furthermore, the longest region that can be successfully reconstructed depends on both the read length and Diversity. For instance, when the region of interest and the Diversity are given, we observe that the performance increases with increasing read length. This does not imply that we can expect the same levels of performance with the same Diversity and read length over a larger genomic region. A thorough analysis of this fact is presented in. We anticipate the use of ViQuaS to extend beyond quasispecies spectra profiling with applications in other omics fields including ViQuaScancer genomics, metagenomics and immunogenomics. For instance, applications such as estimating genetic diversity of tumour cells and understanding gene heterogeneity and diversity of microbiomes in various environments such as human gut or waste treatment plants may benefit from the underlying methodology.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
D.Jayasundara et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
