Motivation: Sequence analysis algorithms are often applied to sets of DNA, RNA or protein sequences to identify common or distinguishing features. Controlling for sequence length variation is critical to properly score sequence features and identify true biological signals rather than length-dependent artifacts. Results: Several cis-regulatory module discovery algorithms exhibit a substantial dependence between DNA sequence score and sequence length. Our newly developed LOESS method is flexible in capturing diverse score-length relationships and is more effective in correcting DNA sequence scores for length-dependent artifacts, compared with four other approaches. Application of this method to genes co-expressed during Drosophila melanogaster embryonic mesoderm development or neural development scored by the Lever motif analysis algorithm resulted in successful recovery of their biologically validated cis-regulatory codes. The LOESS length-correction method is broadly applicable, and may be useful not only for more accurate inference of cis-regulatory codes, but also for detection of other types of patterns in biological sequences. Availability: Source code and compiled code are available from
INTRODUCTIONAn important task in computational biology is to score DNA, RNA or protein sequences for a variety of features. These features may range from relatively basic sequence properties such as GC content or evolutionary conservation, to more complex measures of putative biological function, such as the presence of transcription factor binding sites (TFBSs) or of TFBS clusters organized into cisregulatory modules (CRMs), e.g. transcriptional enhancers (). Such general computational endeavors often face the central challenge of properly accounting for input sequences of varying lengths. * To whom correspondence should be addressed.Accounting properly for dependence between a sequence score and its length is critical to identify a true biological signal, rather than a correlation artifact. A greater sequence length offers greater opportunities for finding good local matches by chance alone. For instance, artifacts associated with length dependence were noted in the early days of searching sequence databases. A nearly linear correlation was often observed between the best local similarity score and the length of the sequence match in the queried database, even when those sequences were unrelated (). More recently, adjusting for sequence length dependence was also found necessary in analysis of next-generation RNA sequencing (RNA-Seq) data (). Since the number of reads mapped to a gene depends on its transcript abundance and length (), transcript length may confound gene expression analysis (), with a bias for calling a higher proportion of long transcripts as expressed more highly. In the Drosophila melanogaster genome, for instance, genes have varying non-coding sequence lengths, ranging from 10 2 to 10 6 bp (). A prior study found that genes with more complex expression patterns tend to have longer non-coding sequences (). In prior investigations of CRMs and cisregulatory codes (), it was observed that for various input TFBS motifs there was a notable correlation between a gene's non-coding sequence length (i.e. totalmelanogaster the length of a gene's non-coding sequence varies across four orders of magnitude, from 10 2 to 10 6 bp. For instance, the C1 somatic mesoderm FC gene set has on average lengthier non-coding sequences, with a median of 17.4 kb (25.3 kb mean) as compared with 4.3 kb (11.4 kb mean) for all genes in the genome, a difference that must be accounted for to avoid computational artifacts.
LOESS correction in genomic sequence analysisupstream, downstream and intronic sequence) and its CRM score. We here find that this length-dependence artifact is more general than previously expected. It can affect several other CRM discovery algorithms () and to our knowledge is not accounted for by currently existing algorithms for CRM prediction and inference of cis-regulatory codes. In fields other than computational prediction of CRMs, a few approaches have been proposed to correct for dependence between two variables (). Here, we focus on approaches that can be applied in our context. Given a sequence score of interest, S, and a sequence length, L, one may adjust S for potential length dependence by subtracting ln(L) as in Equation (1) (), shown below. Alternatively, one may regress a linear function, with slope m and intercept b, and adjust the score as shown in Equation (2) ().In scoring of protein sequence similarity, several variations on Equations (1) and(2) yielded different performances depending on the scoring matrices and gap penalty combinations used (). However, the general consensus was that even simple log-length normalization improved performance and increased the selectivity of the queries (). In RNA-Seq analysis,either subtract or divide their score by a length-dependent correction factor c  L d, where L is the gene length, d is the sequenced tag length (2532 bp), and c is an empirically derived weight (a constant). There also exists a diversity of mathematical procedures based on principal component analysis (PCA) () to convert potentially correlated datasets into uncorrelated ones. However, available approaches either assume an a priori model of the correlation relation (e.g. linear or of order 1 / 2 ), or might overlook potential underlying structure of the correlation relation, thereby being inflexible or inapplicable to problems with varying correlation instances. Applying normalization methods that are blind to the correlation structure in any particular context may remove the overall correlation but might still yield undesired artifacts due to data interpretation (described further below in Section 3.3). We present a general and flexible approach to adjust for different dependence relations between two variables of interest (e.g. a sequence score and its length). Our strategy derives the local correlation structure of the dataset under consideration by fitting a LOESS curve () to the score versus length (SL) scatter plot, and dividing the scores by the values of this fitted curve at the corresponding length value. We compare the performance of our LOESS approach to that of four other normalization methods and benchmark them in the context of cis-regulatory code discovery in embryonic mesoderm development and nervous system development in the fruit fly D. melanogaster.
METHODSWe first present the cis-regulatory code and CRM discovery frameworks, followed by the datasets and normalization methods used in this study.
Cis-regulatory code discoveryTo computationally predict cis-regulatory codes, we use a gene set (GS) enrichment analysis framework () implemented in the Lever algorithm (). Lever is a general method that infers cis-regulatory codes for predefined sets of putatively co-regulated genes (e.g. genes co-expressed under different conditions, with similar biological function, within the same pathway, etc.), by considering overrepresented TFBS motif combinations within putative CRMs, typically predicted by the CRM prediction algorithm PhylCRM (). A main advantage of using the algorithms Lever and PhylCRM (detailed in Sections 2.2.1 and 2.3, respectively) is that they provide the capability of exploring several tens of kb of non-coding sequences, as opposed to other algorithms () that might intrinsically consider only proximal promoter regions of a fixed length (e.g. 1 kb around transcription start sites). Although Lever was developed in conjunction with PhylCRM, Lever can be used with any CRM prediction algorithm.
CRM discovery
PhylCRM CRM prediction algorithm:Briefly, the PhylCRM score PS(MC i ,w) is a statistical measure of TF binding site density and evolutionary conservation for a given TFBS motif combination MC i over a sequence window of width w. Specifically, PS(MC i ,w) represents the log(P-value) of observing another window of size w with a higher density of conserved motif matches for MC i in the entire non-coding genome. Thus, the PhylCRM score by itself accounts for the window length over which it is computed. To assess conservation of a TF binding site within a set of aligned genomic sequences, PhylCRM uses the probabilistic evolutionary model MONKEY (). This model computes the extent to which each position along a putative binding site is both conserved and a close match to the TFBS motif. The PhylCRM score PS(MC i , w) is then based on a Fuzzy Boolean logic integration of the MONKEY score across individual motif occurrences, for a particular combination MC i and a window size w (). To identify the most likely CRM for a given motif combination MC i and gene g l , we define the 'gene CRM score' S(MC i ; g l ) as the highest (maximum) PhylCRM score. Note that S(MC i ; g l ) is the maximum PhylCRM score evaluated over a continuous range of user-specified window sizes (e.g. 501000 bp) and over the entire non-coding sequence of a gene g l. Thus, a gene CRM score of zero, S(MC i ; g l ) = 0, indicates that the gene has no sequence windows that contain TFBS motif matches for the motif combination MC i. In a biological sense, a gene CRM score of 0 indicates that MC i is unlikely to directly regulate the gene g l through a cis-acting DNA regulatory element.
Other CRM prediction algorithms:To assess whether the length variation problem affects other CRM prediction algorithms, we focused on the following algorithms that were reviewed and performed well in): MSCAN (), ClusterBuster () and STUBBMS (i.e. Stubb with conservation) (). These algorithms use different computational strategies and types of inputs, as described in Section 3.1. Default parameter settings were used. For each algorithm and for each motif combination, the 'gene CRM score' represents the score of a gene's highest scoring, predicted CRM.
Lever analysesLever is a cis-regulatory code finder () based on GS enrichment analysis (). Lever identifies significant over-representation of particular combinations of evolutionarily conserved TFBS motif occurrences within putative CRMs in the non-coding regions of predefined foreground gene sets. Formally, given an input collection of N foreground gene sets F 1 ,...,F N , a corresponding collection of N disjoint background gene sets B 1 ,...,B N is constructed to form the compound foregroundbackground gene sets GS m ={F m ,B m },m {1,...,N}. For each. The AUC reflects the likelihood of observing a higher-scoring CRM in a randomly chosen foreground gene g l  F m with respect to a randomly chosen background gene g l  B m. Thus, for a given motif combination, a high AUC value indicates that the foreground genes tend to have higher-scoring CRMs than their background gene counterparts; a motif combination with a high AUC value is thus hypothesized to be a cis-regulatory code of the foreground GS under investigation. To assess the statistical significance of observing such an AUC value (or higher) by chance, Lever performs many permutations (default 1000) of the labels between the foreground and background genes in each compound GS m , re-computes the AUC statistic on each permuted dataset, and estimates the resulting false discovery rate (FDR;).
Parameter settings:For all Lever and PhylCRM analyses, window widths ranged between 50 and 1000 bp. To assess evolutionary conservation, the genomes of all 12 sequenced fly species () were used. To identify putative TFBS motif matches, an information content cutoff of one SD below the motif's position weight matrix (PWM) average score was used (). The PWM average score represents the mean information score over all 4 k sequence variants, where k is the length of the PWM. We used Lever in two broadly defined biological contextsembryonic mesoderm development and neural developmentthat encompassed seven different foreground GSs. For the mesodermal GSs, we used Lever to evaluate all Boolean AND motif combinations up to five-way combinations. For the neural GSs, we used Lever to evaluate Boolean AND as well as OR motif combinations up to seven-way combinations since the putative code could involve an OR logic. We used default settings for all other Lever parameters.
Genome pre-processing:The D. melanogaster genome (BDGP Release 5/dm3) and its 11 MultiZ Drosophila alignment genomes were pre-processed as in (). Both coding and repetitive sequences were masked. For each gene, the non-coding region that we examined included its introns and the entire upstream and downstream intergenic regions until the nearest flanking genes.
Permuted motif analysis:We conducted this analysis to further assess the specificity of a given motif combination for its target GS. Initially, for each pairing of motif combination and GS, the FDR on the AUC Lever statistics was derived by randomly relabeling the foreground and background genes, yet using real TFBS motifs. In this additional analysis, we generated column-permuted motifs (i.e. maintaining nucleotide composition, but shuffling the nucleotide positions) as negative controls for each input, real TFBS motif. We repeated the Lever analyses 100 times using different versions of these shuffled motifs. An empirical P-value equal to N/100 can be derived, where N is the number of shuffled (negative control) motif combinations that scored more significantly than their original real motif counterparts. Therefore, for a given GS, a motif combination was considered a putative cis-regulatory code if it proved statistically significant with an AUC 0.6, FDR q 0.05 () and an empirically derived p 0.05.
Biological datasetsWe conducted our computational study on two biological systemsan embryonic somatic mesoderm founder cell (FC) GS and neural GSsfor which prior experimental support exists for their cis-regulatory codes (). We also performed our analysis for additional systemsan additional embryonic somatic mesoderm GS and cardiac mesoderm GSs where we sought to discover potentially novel codes (). Our analyses center on D. melanogaster GSs particular to four different cell types in the embryonic mesoderm and to three cell types in the peripheral nervous system.
Gene sets:The C1 (cluster 1) GS () is a collection of 37 genes that are co-expressed in a subset of somatic mesoderm FCs and that respond similarly across 12 genetic perturbations of myogenesis (). The FCM-all GS comprises 104 genes expressed in fusion-competent myoblasts (FCMs) (), cells which fuse with individual FCs to form somatic muscles. PC-only and CC-only are sets of 39 and 35 genes that are expressed only in pericardial cells (PCs) or cardial cells (CCs), respectively (), the two main cell populations of the embryonic heart vessel in Drosophila. The PNC GS comprises 44 genes validated by in situ hybridization to be expressed in proneural cluster (PNC) cells, which have the potential to adopt neural cell fates in the larval wing (). The SOP GS is a subset of 26 PNC genes expressed in sensory organ precursor (SOP) cells in the peripheral nervous system. The non-SOP GS is the remaining subset of 18 PNC genes expressed in the inhibited cells, which adopt an epidermal cell fate (). The genes in each GS are provided in Supplementary Table S1.
Transcription factor binding site motifs:Our input collection of TFBS motifs that might regulate the four mesodermal GSs under consideration included motifs for the TFs activated by the Wg, Dpp and Ras pathways: T cell factor (dTCF), Pointed (Ets motif), Twist (Twi), Tinman (Tin) and Mothers against dpp (Mad). For the neural GSs, we additionally considered motifs for Achaete/Scute (Ac/Sc) and Suppressor of Hairless (Su(H)). All motifs (Supplementary) were obtained from ().
Normalization methodsWe examined the performance of Lever in identifying putative cis-regulatory codes using the following five general normalization approaches. For each motif combination under consideration, normalization is applied accordingly to all genes under investigation in all compound foregroundbackground
Length matching:Previously length matching (LM) was applied to genes analyzed by the CodeFinder algorithm to evaluate potential cisregulatory codes (); CodeFinder was subsequently scaled-up and further developed in Lever (). For every foreground GS F m a corresponding background GS B m was constructed. Each background set is chosen so as to contain at least 20 times as many genes as the foreground set, and so that the distribution of noncoding sequence lengths of the foreground and background sets are matched. We use LM here as the baseline method for length normalization, and the generated length-matched background sets are used in all other normalization methods examined in this article.
Linear log-regression normalization:This approach was initially applied in Lever because of its success in protein sequence homology searches (). Considering only genes with nonzero CRM scores, a linear curve with slope m and intercept b is regressed to the scatter plot of 'gene CRM score' versus 'non-coding sequence length'. Then, for each gene g l the CRM score is adjusted as in Equation (2). Linearity between sequence score and length is here assumed.
PCA-based normalization:Based on PCA for multivariate data, a linear transformation can be used to decorrelate two (or more) variables, despite a non-linear correlation between them (). Thus, given a matrix X mxn with n variables (here, n = 2: 'gene CRM score' and 'non-coding sequence length') for m genes, and a matrix Z mxm with all of its entries set equal to 1, we apply
LOESS correction in genomic sequence analysisthe following two-step mapping:to transform the variables so that they have zero correlation with each other (and zero mean). We chose this method as a general representative for other more recent state-of-the-art variations of PCA-based decorrelation methods, such as DECO (). DECO has recently been used to decorrelate expression datasets in GS analyses. This method conducts eigenvalue decomposition of a covariance matrix, followed by linear transformations and eigenvalue rescaling and truncation. DECO is similar, for instance, to the Mahalanobis-based transformation () for pixel decorrelation in image compression, but is rather slow and may present numerical instabilities despite the sophisticated shrinkage covariance estimator used (). Therefore, because of the similarity in decorrelation performance between DECO and the general PCA-based approach described by Equations (3.a) and (3.b) (Supplementary), we chose to use the latter method.
Length division:This method is similar in spirit to the recent RNASeq correction approach from (). There, the score is divided by a correction factor c  L d, with L being the effective gene length, d the sequenced tag length (2532 bp), and c an empirically derived constant (0.0301 or 0.0436). However, since the score-length correlation relation is not generally of order 1 / 2 , normalizing by  L l or log 10 (L l ) is ineffective (Supplementary). Therefore, we instead use LD as a general approach where, for each gene g l , the CRM score is divided by log 10 (L l ), the logarithm of the associated non-coding sequence length.
LOESS-fit normalization:We implemented this method because of its flexibility in capturing the score-length relationship without any a priori assumptions. First, considering only genes with non-zero CRM scores, a LOESS curve is regressed to approximate the local dependence relationship between the gene CRM score and the non-coding sequence length. Then, for all genes, the CRM score is divided by the value of the LOESS curve at the corresponding non-coding sequence length. A second-order LOESS curve with a smoothing parameter of 0.5 was used. We found the normalization to be robust to the value of the smoothing parameter considering a range of values (Supplementary), and we chose this parameter to avoid overfitting the data (Supplementary).
Normalization performance evaluationNormalization is applied using information from all available genes. However, using all genes to normalize and assess the post-normalization score-length correlation would not necessarily represent a stringent evaluation of performance. Therefore, we instead compute this correlation using different sampled foregroundbackground GSs. Because subsequent enrichment analyses are conducted on these same foregroundbackground GSs, we must ensure the successful removal of the correlation at the GS level as well, since any remnant correlation might bias the results.
RESULTSAmong other genes, mesodermal genes and non-SOP genes have complex gene expression patterns () and lengthy non-coding sequences (and Supplementary). For example, as shown in, the C1 GS has a median non-coding sequence length of 17.4 kb as compared with 4.3 kb for all D. melanogaster protein-coding genes (WMW P-value < 8.610 10 ). Thus, GS analyses that examine non-uniform sequence lengths must correct for length variability to avoid potential artifacts. We first show that dependence between a gene's CRM score and its non-coding sequence length affects several CRM prediction algorithms. We then compare our LOESS method to other normalization methods in correcting for this dependence and in identifying validated cis-regulatory codes.
Length dependence of gene CRM score affects a variety of CRM discovery algorithmsAs a result of length variability, longer sequences provide the opportunity for an algorithm to predict higher scoring CRMs by chance alone. Many well-known algorithms display to some extent a correlation between their gene CRM score and the gene's non-coding sequence length (). Although results are depicted for only MC i = 'Ets AND Twi AND Tin' (), the correlation effect is consistent across a wide variety of motif combinations, despite the different algorithmic strategies and types of inputs used (Supplementary). For instance, PhylCRM uses its own heuristic scoring scheme that exploits phylogenetic information across all 12 fly species, based on the MONKEY evolutionary model (). STUBBMS () employs a different phylogenetic strategy, uses only one other fly species (here, the distantly related Drosophila grimshawi), and is based on a hidden Markov model (HMM). Cluster-Buster () is also an HMM scheme, but unlike STUBBMS does not use the BaumWelch algorithm on the DNA sequence to derive the state transition probabilities. Cluster-Buster heuristically derives these probabilities from expected input motif cluster structure parameters, and from background distributions from sliding windows along the non-coding genome. Both ClusterBuster and MSCAN () do not use phylogenetic information. MSCAN is not HMM-based and uses its own heuristic to evaluate the combined statistical significance of dense clusters of motif matches within a sliding window. Despite these considerable differences in the underlying algorithms and types of inputs used, their calculated gene CRM scores tend to correlate with non-coding sequence length.
Length matchingAs an initial solution to this length variability problem, LM was devised to generate for each foreground GS a background set with a matched non-coding length distribution (). However, LM by itself does not solve the distinct problem of having a gene score depend on its non-coding sequence length. For example, considering the union of the C1 genes and their
A.Aboukhalil and M.L.Bulyklength-matched background genes for the three-way AND motif combination MC i = 'Ets AND Twi AND Tin', there remains a considerable score-length correlation (r p  0.62), close to that of all genes under consideration (r p  0.7) (Supplementary). LM alone is insufficient to adjust for the score-length correlation artifact across different foreground and background gene sets GS m for combinations of real (, panel i; Supplementary, panels a and c) and shuffled motifs (, panel ii; Supplementary, panels b and d). Highlighting the C1 genes emphasizes the length dependence of gene CRM scores (Supplementary). Since length dependence may confound subsequent motif analyses, further normalization is necessary in addition to LM.
Log-length regressionFor different gene sets and motif combinations, applying loglength regression (LLR) reduces the median Pearson correlation to 0.10.2 in the case of AND combinations (, panels iii and iv; Supplementary, panels e and f) and to 0 in the case of OR combinations (Supplementary, panels g and h). Despite this considerable reduction in correlation, LLR is incompatible with our cis-regulatory code discovery framework on two fronts, which may lead to serious artifacts. First, in a gene set enrichment-based cis-regulatory code discovery framework, two genes with no candidate CRMs are interpreted as functionally equivalent 'non-target' genes, irrespective of their non-coding sequence length. That is, despite non-coding sequence length differences, both genes are unlikely to be targeted directly by a motif combination of interest. Therefore, it is desirable that 'non-target' genes receive an equal score (e.g. zero, both pre-and post-normalization) irrespective of non-coding sequence length. However, LLR adjusts zero-scoring 'non-target' genes to acquire unequal and length-dependent scores (, panels iii and iv; encircled in blue in Supplementary, panels i and iii, and ii and iv), thereby breaking down the desired property that 'non-target' genes receive an equivalent score irrespective of non-coding sequence length. Second, it is desirable for a 'potential target gene' to acquire an adjusted score greater than that of a 'non-target' gene. However, with LLR, some putative 'non-target' genes may rank higher than 'potential target genes' (, panels iii and iv; Supplementary, panels iii and iv). The effect is stronger for the Ets AND Twi AND Tin motif combination (Supplementary, panel iv), for which very short 'non-target' genes (encircled in blue) score more highly than most of the 'potential target genes'. As a result, in gene set analyses, artifacts may occur where strong enrichment is observed for a motif combination in a given GS, even though no or very few genes have motif occurrences in their non-coding sequence. This issue is more pronounced for AND combinations which, by the nature of the scoring scheme, tend to have a higher number of zero-scoring genes.Original
LOESS correction in genomic sequence analysis
PCA-based normalizationAlthough the PCA-based approach generates relatively similar SL scatter plots as does LLR (, panels iii and iv, and iv and vi), in general, it performs worse than LLR with a wider interquartile range of the Pearson correlations. For different GSs and motif combinations, applying PCA reduces the median Pearson correlation to 0.20 (range 0.50.2) in the case of AND combinations (, panels v and vi; Supplementary, panels i and j) and to a median of 0 (range 0.40.3) in the case of OR combinations (Supplementary, panels k and l). Nonetheless, PCA-based methods suffer from the same potential artifacts as LLR (Supplementary).
Length divisionTo avoid potential artifacts that may arise in LLR and PCA (due to an inherent subtraction operation [Equation (2) and Equation (3.a), respectively], we tested the LD normalization method, whereby the gene CRM score S i is divided by log 10 (L i ). However, since the relationship between S i and log 10 (L i ) is not linear, LD does not eliminate the correlation effectively (, panels vii and viii;, panels vi and vii; Supplementary, panels m to p), resulting in a median r p  0.30.5. Therefore, instead of using higher-order or exponential curves, for which one needs to select the function and its parameters a priori,we sought to find a fitting function that is general, simple and flexible.
LOESS-fit normalizationWe pursued LOESS as an alternate approach to better characterize and reduce the length-dependence relationship in gene CRM scores. We use the LOESS-fit approach to derive empirically the relationship between the gene CRM score and log 10 (L i ). This fit is then used to adjust the CRM score for each gene. After normalization by the LOESS curve, the Pearson correlation between the gene CRM score and non-coding length has a relatively tight distribution around zero across all seven GSs for the real TFBS motifs (i.e. 505 MCGS pairings;, panel ix; Supplementary, panels q and s; range 0.1) and for the shuffled motifs (i.e. 50 500 MCGS pairings;, panel x; Supplementary, panels r and t; range 0.2). LOESS-fit normalization was the only method for which the median of the distribution of Pearson correlations was consistently 0, as evidenced by a WMW AUC close to 0.5 (Supplementary). In sum, the LOESS-fit approach is the most consistent and most effective method for correcting the length-dependence correlation. We also tested various exponential, logarithmic, trigonometric and hyperbolic functions based on the LOESS fit, and found that a simple LOESS fit reduced correlation the most (data not shown).
Cis-regulatory code motif analysisTo further assess the utility of the LOESS-fit correction of gene CRM scores, we considered the corrected gene CRM scores in cisregulatory code motif analysis in real biological contexts.
LOESS-fit correction helps recover known cis-regulatory codes: First, we first focused on the GS C1 for which there is prior experimental support for the AND motif combination Ets AND Twi AND Tin acting as a cis-regulatory code (). The original version of Lever (i.e. length-correction by LM) () does not yield any statistically significant codes for the GS C1 considering five TFBS motifs of relevance in mesoderm development [(LM); Supplementary. However, Lever with LOESS-fit normalization yields three statistically significant codes involving these five motifs (AUC 0.60, q0.05;C; Supplementary Tables S5S7) and includes the Ets AND Twi AND Tin cis-regulatory code for the C1 GS. To further assess the robustness of our results, we ran the Lever analysis using 100 shuffled versions of the five real TFBS motifs as negative controls. No shuffled motifs or combinations thereof scored more significantly than the three putative codes (p < 0.01; Supplementary Tables S5S7). Furthermore, comparing these significant codes to those identified by a prior cis-regulatory code evaluation framework (CodeFinder) that used a different CRM scoring scheme and phylogeny for only three fly species (ModuleFinder) (), yielded generally consistent results (Supplementary). To assess the generality of LOESS-fit correction of gene CRM scores, we applied it in a second biological context. In D. melanogaster neural development, there is experimental support for the motifs Ac/Sc and Su(H) participating in a cis-regulatory code for the non-SOP GS (). We ran Lever with LOESS-fit correction to investigate both AND and OR combinations of these motifs along with the five motifs analyzed for the mesodermal GSs. We repeated the analysis with 100 shuffled versions of each of the seven real TFBS motifs. We recovered Ac/Sc (alone), Su(H) (alone), as well as the Boolean AND and OR combinations of Ac/Sc and Su(H) among the top statistically significant codes, with five or fewer of 100 of their shuffled motif combinations scoring more significantly (i.e. p  0.05) (Supplementary).
LOESS-fit normalization performs favorably against other competing methods in recovering known cis-regulatory codes:We repeated all our previous PhylCRM and Lever analyses using LLR, PCA and LD to correct for length dependence (Supplementary Tables S9S11). In general, all these forms of normalization improved detection of putative codes as noted by an increase in the AUC and a decrease in the q-value with respect to the original Lever analyses performed using LM alone (). For the nonSOP GS, LOESS-fit compares favorably to the other normalization methods in recovering validated codes in a statistically significant fashion. For the validated Ets AND Twi AND Tin code for C1, the LOESS-fit approach performed the best (). However, as shown above, both LLR and PCA normalization may yield undesired artifacts (Sections 3.3 and 3.4), and LD does not remove length dependence as effectively as does LOESS-fit (Sections 3.5 and 3.6).
LOESS-fit correction improves cis-regulatory code resultsobtained using MSCAN, Cluster-Buster and STUBBMS CRM prediction algorithms: We repeated our Lever analyses using three other well-known CRM prediction algorithms: MSCAN (), Cluster-Buster () and STUBBMS (). We compared their performance in recovering validated cis-regulatory codes with versus without LOESS-fit correction. In general, LOESS-fit correction did not drastically change the AUC values, but tended to improve the statistical significance (reducing the q-value) of highly scoring code predictions (Supplementary Tables S12S14;). We note that
A.Aboukhalil and M.L.Bulyk(a)these results must be interpreted with care, as LOESS-fit correction cannot improve the intrinsic ability of any CRM prediction algorithm to identify true biological signals; however, LOESS-fit correction does effectively reduce artifactual length dependency of the resulting CRM scores.
DISCUSSIONDependence of the score of a biological sequence on the length of the sequence may confound or conceal true biological signals. Here, we have shown that this problem occurs for several well-known CRM prediction algorithms. We have presented a general method to adjust for length-dependence of a DNA sequence score. Our LOESS-fit approach is consistent in reducing the correlation between sequence length and score, not only in comparison to other methods (e.g. length division (LD), PCA-based methods and linear-log regression (LLR)), but also in absolute terms (; Supplementary). In the context of cis-regulatory code discovery, LOESS-fit correction allowed the Lever algorithm () to recover experimentally validated codes in two different biological contexts in D. melanogaster (). Compared with other normalization approaches, LOESS-fit performed favorably in recovering the validated codes (), and does not suffer from the artifacts that LLR and PCA may yield (Supplementary). In addition, LOESS-fit correction is useful in application to a variety of CRM prediction algorithms in analyses aimed at identifying putative cis-regulatory codes (). Our GSs were based on relatively stringent biological evidence. We focused on GSs comprising genes that are expressed in relatively homogeneous cell types, that were confirmed by in situ hybridization, and that have prior experimental evidence for a cis-regulatory code. GSs could be constructed alternatively to comprise genes with shared Gene Ontology (GO) annotation terms or pathway involvement. Some major advantages of LOESS, as compared with other regression methods, are that it does not call for a priori specification of a fitting function and that it is a flexible and simple fitting approach used for a wide range of purposes (). Our data points are generally dense (e.g.). However, potential limitations of the LOESS-fit method may arise in small or sparse datasets, where LOESS might overfit or inaccurately fit the data points. On another level, to avoid generating non-monotonic LOESS curves that might overfit the data, we have empirically chosen the value of the smoothing parameter to be robust across various motif combinations and GSs (Supplementary Figs S3 and S4). Potential artifacts might arise in a dataset with varying data density, such as around the extreme ends of a distribution, where LOESS interpolation might deviate from the sparse points that it tries to fit. We seldom encountered such deviations, which occurred mostly for genes with particularly short non-coding sequence lengths and with low gene CRM scores, where the LOESS curve could go below zero. To guard against such deviations, we implemented a small saturation threshold, t  0.01, so that the LOESS curve fit_LOESS = max(t, fit_LOESS) always remains >0 (or a small value, t, above 0). We considered the possibility of score inflation where the LOESS curve came close to zero. However, since the scores fit by the LOESS curve are also generally close to zero and of the same order of magnitude, their ratio will not be inflated. Of course, an outlier score that is much greater than the LOESS curve will be inflated; however;
LOESS correction in genomic sequence analysis(a)), and with LOESS correction (white bars). In general, LOESS correction improves performance as noted by a decrease in the FDR q-values. Although LOESS correction is effective in reducing score-length correlation, it cannot improve the intrinsic ability of CRM finders in identifying true biological signals. that could be the case of a short sequence containing a likely CRM. We control for potential low-score inflation in our Lever analyses, by first length-matching the foreground and background genes, and then transforming the scores into ranks to robustly assess enrichment of the foreground gene scores with respect to those in the background set, in the face of outliers. As originally applied in the context of protein similarity scores (), LLR did not encounter zero-scoring elements and thus did not lead to artifactual results analogous to those resulting from GS-based motif analysis of non-coding sequences. However, because of the structure of our data (i.e. the existence of zero-scoring genes and their biological interpretation as non-targets for a given code), PCA-based normalization methods () can produce similar artifacts as LLR, making both of these methods inappropriate in the context of GS analyses (Supplementary). Our use of gene CRM scores corrected by LOESS-fit normalization resulted in successful recovery in Lever analyses of both known and putative cis-regulatory codes for genes involved in embryonic somatic mesoderm development and in neural development in D. melanogaster. We have also used Lever with LOESS-fit correction to identify novel cis-regulatory codes involving other TFBS motifs for genes expressed in PCs and CCs, which were experimentally validated by; without LOESS-fit correction, no statistically significant codes could be obtained. Although here we focused on Drosophila GSs, we anticipate LOESS-fit correction of gene CRM scores to be useful for cis-regulatory code analyses in other organisms. The LOESS-fit length normalization method is general and may be useful beyond cis-regulatory code analysis, for other DNA, RNA or protein sequence analyses where a score might depend on another variable such as the length of the sequence. We anticipate that such improvements in controlling for length dependence in scoring of biological sequence data will lead to improved discovery of important biological sequence patterns in gene regulation and function.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
