Motivation: Single-cell RNA-sequencing technology allows detection of gene expression at the single cell level. One typical feature of the data is a bimodality in the cellular distribution even for highly expressed genes, primarily caused by a proportion of non-expressing cells. The standard and the over-dispersed gamma-Poisson models that are commonly used in bulk-cell RNA-sequenc-ing are not able to capture this property. Results: We introduce a beta-Poisson mixture model that can capture the bimodality of the single-cell gene expression distribution. We further integrate the model into the generalized linear model framework in order to perform differential expression analyses. The whole analytical procedure is called BPSC. The results from several real single-cell RNA-seq datasets indicate that $90% of the transcripts are well characterized by the beta-Poisson model; the model-fit from BPSC is better than the fit of the standard gamma-Poisson model in > 80% of the transcripts. Moreover, in differential expression analyses of simulated and real datasets, BPSC performs well against edgeR, a conventional method widely used in bulk-cell RNA-sequencing data, and against scde and MAST, two recent methods specifically designed for single-cell RNA-seq data.
IntroductionGene expression at single-cell level is a stochastic process affected by extrinsic and intrinsic noise. The extrinsic noise comes from the environment outside the cell such as hormones or drugs. The intrinsic noise involves intra-cellular factors such as transcription rate (burst frequency), the number of mRNAs (burst size) and degradation rate (). Previous studies () have introduced different models to capture the stochastic process due to the intrinsic noise. In general there are two main approaches to measure expression of genes in a single cell (i) targeted and (ii) whole transcriptome-based. The formere.g. using qPCR or immunohistochemistryis used tois the integration of gene expression from multiple single cells; the distribution is commonly modelled by the gamma-Poisson mixture model, or equivalently, the negative-binomial distribution. This model cannot capture the bimodality of gene expression in singlecell data (). Recentlybriefly introduced the beta-Poisson model to capture the bimodality as well as the long-tailed behavior in the distribution. As an attractive feature, unlike the purely empirical gamma-Poisson model for bulkRNA, the beta-Poisson model parameters introduce one biological interpretation in terms of burst size and burst frequency of the celllevel expression. However, due to computational problems with the beta-Poisson model, Wills et al. used an alternative discrete Poisson mixture, a less-parameterized version of the beta-Poisson model, to extract the information of the burst size and frequency. The model was applied for modelling of gene-level expression in qPCR-based datasets. Furthermore, no details of evaluation of modeling performance were reported. Another attempt of using the beta distribution to capture bimodality property of single-cell gene expression was introduced in the BATBayes model (). However, in this approach, instead of integrating it with the Poisson distribution, the beta distribution was combined with binomial distribution to mimic the partitioning process of RNA molecules into transcripts. Here we develop BPSC, an analysis tool based on the betaPoisson model for the single-cell gene expression data, and implement and apply it to several scRNA-seq datasets. BPSC addresses practical and realistic issues such as non-integer expression values or low expression values. Theoretically it is suitable for both transcript-level and gene-level expression, which is usually higher than the transcript-level expression. It is worth noting that the term 'transcript' herein includes both isoform and other types of splicing variants. The beta-Poisson model allows for control of the expression drop-off caused by technical noises or sequencing sensitivity. BPSC includes a generalized linear model (GLM) based on the betaPoisson model to perform differential expression analyses of singlecell RNA-seq data. Experiments using simulated and real datasets show that BPSC performs well against edgeR, an established method for bulk-cell RNA-seq, and against MAST and scde, two recent differential-expression analysis methods designed for single-cell RNAseq.
Beta-Poisson modelThe beta-Poisson model captures the burst frequency and burst size through the shape and scale parameters a and b, respectively. Large a indicates high burst frequency; large b means large burst size (). Instead of using a range, we consider the beta distribution inand scale it by k in order to avoid optimizing two boundary parameters a and b. We then extend the model with more parameters to increase its flexibility. We start with the simplest model with three parameters, then describe its extensions with four and five parameters.
Three-parameter beta-Poisson modelThe simplest beta-Poisson model is a mixture of Poisson distributions with mean v  ku, where k is a scale parameter, and u has a beta distribution with parameters (a,b). Thus, the probability distribution function (pdf) can be computed as follows:PX xjvf vdv:Using f(v)dv  f(u)du, we first replace v by u to getChanging the variable t 2u  1, so that u  (t  1)/2 and dt  2du, with some algebra we have:The integral (3) can be easily and rapidly computed by using the Gauss-Jacobi quadrature method (). Thus, similar to the discrete Poisson mixture model (), our first model requires only three parameters. However, in practice, this model proves inadequate for modeling single-cell transcript expression data. Therefore, we extended the model in the following sections.
Four-parameter beta-Poisson modelThe simple beta-Poisson model has a serious weakness in that its sample space contains non-negative integers only. Because of various preprocessing steps of the sequence data, expression values are generally not discrete counts. Transcript expression is typically estimated in the form of normalized indices such as fragments per kilo-base per million reads (FPKM) or counts-per-million reads (cpm).shows an example that the expression values (in FPKM) of a transcript are not discrete and small (mostly < 2.0). As displayed in the middle plot, this makes the three-parameter beta-Poisson model fail to capture the distribution. To address this problem, we introduce an extra parameter as follows. First we denote the three-parameter beta-Poisson model in a simpler form as BP 3 xja; b; k 1   Poissonxjk 1 Betaa; b:In this formula, we use k 1 in place of k in formula (1). Then, define the four-parameter beta-Poisson model with the extra parameter k 2 as BP 4 xja; b; k 1 ; k 2  k 2 BP 3 xja; b; k 1 :In practice we expect the parameter k 2 to be a small positive value less than one, so that the BP 4 model allows fractional values in its sample space. The pdf of the four-parameter beta-Poisson model can be computed using the following connection:The transcript expression inis now successfully modelled by BP 4 as presented in top-right plot of the panel. In this BP 4 model, the goodness-of-fit v 2 is 5.79 with 4 degrees of freedom (P-value  0.21), indicating the BP 4 model fits well and better than the BP 3 model.
Five-parameter beta-Poisson modelInterestingly, even without any explicit parameter, the four-parameter model is able to some extent capture the bimodality in the expression distribution due to a large proportion of unexpressed cells. This is illustrated in, where the standard gamma-Poisson fails. To show more formally that the four-parameter model is often adequate for the data, we will compare it to a final extension that explicitly models the proportion of cells with zero expression. Zero expression is expected to represent a true underlying biology for a fraction of the cells, although it might also be due to technical reasons such as the detection limit of sequencing machine.where I(x  0) is the indicator function. Transcripts that fail the BP 4 model can be successfully modelled by the five-parameter model, as shown inin Supplementary file. To summarize, in the original beta-Poisson model (), the two parameters of the beta distribution a and b represent the burst frequency and burst size in the transcription process. In our models, these burst parameters can be estimated by scaling a and b with k 1 for the three-parameter model, and further modified by k 2 for the four-parameter and five-parameter models. The fifth parameter p 0 controls the proportion of non-expressing cells.
Parameter estimationFor each transcript, our objective is to estimate the parameters of the beta-Poisson model given the expression data from n cells. From the pdf of the model, in principle we can compute the log-likelihood given the datawhere h is the vector of parameters, n(x) is the number of cells with expression equal to x, and p(xjh) is the probability of x. For the three-parameter model h  a; b; k 1 . To speed up the computation, we partition the data into K bins, so the log-likelihood iswhere n k is the number of cells in the kth bin, and p(kjh) is the probability of the kth bin. The latter is computed from the pdf of the model. To assess the estimated model we compute a goodness-of-fit test, described in more detail in Section 3.2. In practice we need to fit the model separately to each of >20 000 transcripts, thus requiring a fast, robust and reliable procedure. We select K  10 to obtain a fast performance, while flexible enough to capture a variety of shapes in the data distribution. To make the procedure robust to outliers, we exclude cells from the top 2.5% expression from each transcript. The break points are selected to create approximately equal-sized bins. If the data are highly skewed or have a very long tail, we get the break points with equal-sized bins in a log 2 scale; this is the case if most of the expression values are small but there exists a few high values so that the default break points in the original scale cannot properly capture information of the distribution. The optimization is implemented using the optim(.) function in the R software.
Initial values for model optimizationOne important step to achieve a fast and reliable estimation is the selection of starting values. Here we use the method-of-moments estimates from the observed data. We first focus on the starting value estimation for the three-parameter model, then extend it to the other models. Let E(X) and Var(X) be the marginal mean and variance of transcript-expression X. Then we have the following results:ab a  b 2 a  b  1 :Given k 1 , we can estimate a and b by inverting (8) and(9) to getand use the observed sample mean and sample variance for E(X) and Var(X), respectively. We select the initial estimate of k 1 to be the maximum of the data points. The starting value of k 2 in the four-parameter model is set to be 0.1  median if the median expression value <1.0 (thus at least half of the cells have fractional expression value), otherwise k 2  1.0. Then, we scale the expression values by dividing them with k 2 before estimating the initial values of the other parameters. The initial value of mixture parameter p 0 of the five-parameter(
Model evaluationIn order to evaluate how well the model fits the data, the observed and the expected frequencies from the model are compared using the goodness-of-fit statisticwhere n k is the observed frequency of the kth bin and e k is the expected frequency. Asymptotically, under the null hypothesis that the model fits the data, T has a v 2 distribution with (K  p  1) degrees of freedom, where p is the number of parameters. However, because of small samples, many bins at the tail of the distribution always have low expected frequencies, so the asymptotic distribution is not appropriate. We use a Monte-Carlo method to generate a more appropriate null distribution as follows: first 1000 random datasets are created, each containing n values from the estimated beta-Poisson model. Then we apply the estimation procedure to each random dataset and compute T* as the goodness-of-fit statistic above. The collection of 1000 T*s represents the Monte-Carlo null distribution, and the P-value is computed as the proportion of T*s greater than the observed T. We declare a transcript is well-fitted by the beta-Poisson model if its P-value !0.05. An example of the Monte-Carlo null distribution is shown inin Supplementary report.
Differential expression analysisIn this section we integrate the beta-Poisson model into the generalized linear model (GLM) framework, so we can easily perform differential expression analyses. In general, given response variable Y  y i ; i  1; ::; n and explanatory variable X  x j ; j  1; ::; k, a GLM consists of a linear predictorwhere the dependence of the expectation of the response variable l i  E(y i ) on the linear predictor is set by a link function g(l i )  g i. In this study, the distribution of the response variables is a betaPoisson model and we use the log-link function. In order to estimate the model parameters we use the iterative weighted least-squares (IWLS) algorithm (), which only requires a variance function that specifies the relationship between the mean and variance. For the BP 3 model, using / 1  a ab and / 2  b aab1 , from formula (8) and (9), with some algebra we have:Similarly, we extend the variance function for BP 4 with the additional parameter k 2 as follows:In group comparisons, we assume the mean l varies across groups, but the shape parameters k 2 and / 2 are fixed and estimated from control group. In our implementation we utilize the glm(.) function in R software for fitting the GLM based on the BP 4 model with variance function defined by (12). The whole analytic procedure including the differential-expression analysis will be called the BPSC, which is also the name of the resulting R package made available at https://github.com/nghiavtr/BPSC.
Datasets
Real datasetsThe first dataset in this study including 384 cells from a triple-negative breast cancer cell line (MDA-MB-231), half of which were treated with metformin. The cells were captured using the Fluidigm C1 system on a 96-well format. Two independent cell culture batches were used from which 2  96 untreated cells were captured, and similarly 2  96 treated cells. Sequencing libraries were prepared using the standard Fluidigm protocol based on SMARTer chemistry and Illumina Nextera XT kit. Library sizes of samples are in a range of 110 million. The second dataset consists of 96 cells from HTC116 cell-line extracted from a public dataset (). These single-cell RNA-seq libraries were also prepared with SMARTer cDNA synthesis using the C1 microfluidic system (Fluidigm), based on Nextera library construction (Illumina). The 96 libraries, divided into two pooled samples of 48 libraries, were put in two lanes for a Illumina HiSeq sequencing. More details about this dataset are given in the original paper (). Library sizes in this dataset vary from 0.1 to 4 million. There are various available transcript expression estimation methods that can be used for RNA-seq datasets. In this study, we selected a widely-used method Cufflinks () to estimate transcript expression in the MDA-MB-231 dataset, and Sailfish () to quickly extract transcript expression in the HTC116 dataset. The reference annotation was obtained from the most recent hg19 Homo sapiens reference built from UCSC data sources and extracted from igenomes website http://sup port.illumina.com/sequencing/sequencing_software/igenome.html (in folder archive-2014-06-02-13-47-56). For the distribution analysis, the MDA-MB-231 dataset contains 21 728 transcripts from 165 cells from the control group and the HTC116 dataset consists of 23 889 transcripts from 96 cells. The cells from treated group were excluded in order to avoid the confounding effects of the metformin treatment. For differential expression analysis, the MDA-MB-231 dataset includes also transcript-level expression of 162 cells from the treated group. Moreover, we use Htseq software () to generate gene-level expression of the MDA-MB-231 dataset. This dataset consists of 12 079 genes in total.
Simulated datasetsWe use two simulation settings to evaluate and compare the performance of BPSC in differential expression analyses. In each setting, the data consist of two equal-sized groups with 100 samples in each group and a total of 10 000 genes measured per sample. Five percent of the genes are set to be differentially expressed (DE) with fold-change 4.0, half of which are upregulated and the rest downregulated. The first setup bcSim simulates bulk-cell RNA-seq data. We use the simulation design of a recent study () to create a Beta-Poisson model for scRNA-seqbulk-cell RNA-seq dataset. In brief, a baseline distribution from the real dataset is used to generate relative proportion of expected counts of genes. To create biological variation of DE genes, we multiply their proportions by the fold-change. Then the proportion multiplies by library size to obtain expected count of gene. In this simulation, the library sizes of the samples are randomly selected in a range from 2 to 20 million. An inverse-chi-squared distribution is used to create dispersions in the simulation (). After that, the counts of genes are generated from the gamma-Poisson model with the specified mean and dispersion. The second simulation setup scSim is designed to mimic a singlecell RNA-seq dataset. We use the well fitted four-parameter beta-Poisson models from HTC116 (Monte-Carlo P-value !5%) as baseline distributions for the gene expression of the dataset. For each gene, the expression across samples in the control group and the treated group is generated from the same beta-Poisson model. To create biological effects for the DE genes, we multiply the parameter k 1 of one group by the fold-change, while the other parameters are kept fixed. We also scale the gene expression to the predefined library sizes of the cells, which are randomly sampled from a range of 13 million. This range is taken from the HTC116 dataset. In the analyses, we filter out genes whose total reads across all samples <10. We generate 100 replications for each setting, and the final results are based on these replications.
Results and discussion
Model fittingThe analysis results for the two real datasets are summarized in. In general, these two datasets have similar performances, where $90% of transcripts are successfully modeled (Monte-Carlo P-value !5%) by the BP 4 and BP 5 models. This proportion increases to 94% if we set the P-value threshold to 1% (data not shown). It is worth noting that the BP 4 model is only slightly worse than the BP 5 model. As illustrated in, the BP 4 model is already able to capture the proportion of unexpressed cells, so it appears sufficient for practical applications. The BP 5 model may need to be utilized only for the failed BP 4 models to improve overall performances. The poor performances of the BP 3 model in both datasets demonstrate the important effect of the k 2 fractional-scaling parameter in the BP 4 model. To demonstrate the value of the beta-Poisson model, we also compare its performance to the traditional gamma-Poisson (GP) model through their Akaike information criterion (AIC) scores. As shown inthe beta-Poisson model performs much better than the gamma-Poisson model for transcripts with many unexpressed cells. To have a more even comparison, hence harder for the beta-Poisson model, we compare the simplest model BP 3 and GP on a subset of high-abundance transcripts which are defined by the transcripts that have top 10% sums of expression across cells. From, for more than 80% of the transcripts in both datasets, the AIC of the BP model (AIC BP ) is less than the AIC of the GP model (AIC GP) , indicating the BP model has better performance than the GP model.shows the scatterplot of the AIC scores from the two models applied to the MDA-MB-231 dataset. A great majority of the points falls below the line of identity, indicating that the BP model has lower AIC than the GP model. To capture the improvement, we also compare the AIC of the BP 3 model with the AIC of the GP model up to a constant difference, i.e. we count the transcripts satisfying the condition AIC BP  c < AIC GP , where c  0, 2, 5 in. The proportion is $60% when we allow an AIC difference of 5. To investigate why the BP model still sometimes fails to fit the data, we bin the expression values of the MDA-MB-231 data into a high resolution histogram with 100 equal-size breaks. Then a hierarchical clustering is applied to investigate transcript similarities, and we identify 4 groups categorizing the failed models. These groups are shown inin Supplementary report. Most of the failed models are in groups 1 and 3, where the right tail of the distribution is marked by several extreme values. These values will be investigated further in our future study. To assess the sensitivity of the beta-Poisson model (BP 4 model) to sample size, we simulate datasets from scSim setup with different numbers of cells 100, 50, 25 and 20. The results (in Supplementary report) show that the proportion of genes that fits the beta-Poisson model (P-value !0.05) is higher than 85% for the dataset with at least 25 cells. Therefore, we recommend that BPSC should be applied for datasets with at least 25 cells. Besides, due to the requirements for computing the goodness-of-fit statistic, theThe entries in the table are the proportion of transcripts where AIC BP  c < AIC GP , where c represents the level of improvement in the AIC score. number of bins K also should be greater than p  1. For example, number of bins K of the BP 4 model is at least 6 for practical use.
Differential expression analysisTo evaluate the performance of BPSC for differential expression analysis, we use the four-parameter beta-Poisson model combined with the generalized linear model. We compare the results to edgeRglm of the edgeR software version 3.10.2 () as a representative of methods for bulk-cell RNA-seq data analyses based on the negative-binomial distribution or equivalently the gamma-Poisson distribution. The edgeR software is applied on the read-count dataset as the input requirements of the software, and a normalization step is integrated inside the software. We use the protocol in a recent study () for edgeR-glm implementation. We also compare BPSC to MAST version 1.0.1 (), a recent method for differential expression analysis in scRNA-seq data. In brief, MAST proposes to use a hurdle model () to capture bimodality of gene expression, then apply likelihood ratio to test for differential expression. BPSC works on the data normalized to library sizes from cpm function of the edgeR software (in the simulated datasets) or directly on the FPKM data (in the real datasets). In the original study, MAST was input from log 2 (TPM  1) expression matrix. Herein, TPM (or transcripts per million) indicates normalized expression data. In our implementation, we replace TPM by FPKM for the real dataset and cpm for simulated datasets. Default parameter settings of the software are applied. Finally, we extract the P-values from each method and report the false discovery rates (), called estimated FDR. In simulated datasets, we are also able to calculate the true FDR by comparing the top genes ranked by the P-values to the true status of DE genes. These FDR values are ranked in increasing order and used for method comparison in. In this figure, the method with a lower FDR at a certain number of top genes (transcripts) is better. We first compare BPSC, MAST and edgeR in the two simulation setups: bcSim and scSim. The bcSim uses the gamma-Poisson model to generate a traditional bulk-cell RNA-seq dataset, while scSim simulate a single-cell RNA-seq dataset from the beta-Poisson model. We report the average FDR values of 100 simulations, and for visual purposes we present the top 1000 genes for comparison. For the bcSim setting,shows that BPSC, MAST and edgeR have similar performances, both in terms of estimated FDR (left) and true FDR (right). The estimated FDRs from BPSC and MAST are close to the true FDR when the true value <0.2, and they slightly under-estimate when the value FDR > 0.2. These results indicate that BPSC is also able to work well on the conventional bulk-cell RNA-seq data in this experiment.shows that BPSC outperforms MAST and edgeR in both the true FDR (right) and estimated FDR (left). Moreover,of Supplementary report, a zoomed-out ofwith more genes and a larger FDR range, shows BPSC and MAST are more reliable than edgeR in the scSim setting: there is a large discrepancy between the estimated FDR and the true FDR curves of the edgeR method, which is in contrast to the curves from BPSC. Since we have shown above that the beta-Poisson model fits the single-cell data well, this is an indication that edgeR may not be suitable for single-cell RNA-seq data. For the MDA-MB-231 dataset, in(left plot) BPSC shows lower FDR than both MAST and edgeR. Moreover, in the zoomed-out version (of Supplementary report), the pattern is quite similar to the scSim simulation, so the most likely explanation is that the beta-poisson model is more appropriate than the gamma-poisson model in this single-cell RNA-seq dataset.(right plot) shows that the analyses at transcript-level and at genelevel expression produce similar results.presents the top 10 DE transcripts discovered by BPSC. The FDR values of these transcripts from the edgeR method in the last column expresses that they are also well differentially expressed by the method. Next we investigate the affected biological pathways using the Reactome tool () and the website of human gene database http://www.genecards.org. Many of the top DE genes (RPS17, RPL28, EIF6 and EIF5AL1) are involved in the mRNA translation processes, such as the eukaryotic translation initiation, eukaryotic translation elongation and eukaryotic translation termination. Since it is known that metformin can induce the downregulation of translation of some mRNAs (), the perturbation of metformin in this study may have a similar effect. We also discover two DE genes PRDX2 and PRDX3. These genes encode for peroxiredoxin (Prdx) proteins and are involved in the detoxification of reactive-oxygen-species pathway, which is previously shown to protect a breast cancer cell-line against doxorubicin-mediated toxicity (). A full biological analysis of the results is out of the scope of this current methodological study and will be done separately.We also compare BPSC to scde () version 1.99.0, a recent method for differential expression analysis of singlecell RNA-seq data using a Bayesian approach. Due to the heavy computation of the scde software (see more details inof Supplementary report), we keep the same number of cells in each group, but reduce the number of genes down to 3000 genes in both simulated bulk-cell and single-cell RNAseq datasets. Similar to edgeR, the scde uses read counts as input. Default parameter settings of the software are applied. Since the scde does not report P-values but use Z-scores for the differential expression analysis, we do not compare the methods in terms of estimated FDR. Instead, as suggested by the software tutorials, we use the top genes ranked by the absolute of their Z-scores, then compute the true FDR for comparison. We run the simulation 10 times (low number due to computational demands of scde), and the average results are shown in. The left panel shows that all methods are successful in the bulk-cell simulation setting (bcSim) and achieve the same FDR. However, for the single-cell setting (scSim), the BPSC method has better performance as compared to the scde, as shown in right panel of figure.briefly summarizes the performance of the methods on differential expression analysis for different benchmarks.
ConclusionsWe have presented a model for gene expression of single-cell RNAseq data based on the beta-Poisson mixture model. Experiments with real datasets show that our approach is able to correctly model a great majority of the transcripts. We also introduce an application of the model for differential expression analysis through a combination with the generalized linear model. The results of differential expression analysis in both simulated and real single-cell RNA-seq datasets demonstrate that the proposed method performs well against a traditional method commonly used in bulk-cell RNA-seq data and recent methods designed for differential expression analysis in single-cell RNA-seq dataset. The success of the model helps understand further the transcription mechanism of gene expression in single-cell level and opens opportunities for better analyses of single-cell RNA-seq data.
FundingThis work was supported by grants from the Swedish Science Council and the Swedish Cancer Foundation. Conflict of Interest: none declared.. True FDR evaluated in the bcSim (left) and scSim (right) simulation setting using the scde, edgeR and BPSC methods. The horizontal axis indicates the number of top-ranked genes obtained by the methods; the vertical axis presents the corresponding FDR values. The FDR value is the average from 10 simulationsThe methods are assessed as very positive ( ), positive (), not positive () or result not available (NA).
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
T.N.Vu et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Beta-Poisson model for scRNA-seq
