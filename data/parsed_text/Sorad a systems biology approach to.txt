Motivation: Signaling networks mediate responses to different stimuli using a multitude of feed-forward, feedback and cross-talk mechanisms , and malfunctions in these mechanisms have an important role in various diseases. To understand a disease and to help discover novel therapeutic approaches, we have to reveal the molecular mechanisms underlying signal transduction and use that information to design targeted perturbations. Results: We have pursued this direction by developing an efficient computational approach, Sorad, which can estimate the structure of signal transduction networks and the associated continuous signaling dynamics from phosphoprotein time-course measurements. Further, Sorad can identify experimental conditions that modulate the signaling toward a desired response. We have analyzed comprehensive phosphoprotein time-course data from a human hepatocellular liver carcinoma cell line and demonstrate here that Sorad provides more accurate predictions of phosphoprotein responses to given stimuli than previously presented methods and, importantly, that Sorad can estimate experimental conditions to achieve a desired signaling response. Because Sorad is data driven, it has a high potential to generate novel hypotheses for further research. Our analysis of the hepatocellular liver carcinoma data predict a regulatory connection where AKT activity is dependent on IKK in TGF stimulated cells, which is supported by the original data but not included in the original model. Availability: An implementation of the proposed computational methods will be available at
INTRODUCTIONBinding of the ligand on the cell surface receptor initiates a signaling cascade that is propagated via several parallel pathways through phosphorylation of specific amino acid residues in signaling proteins. Building a mechanistic understanding of signaling pathway dynamics from experimental data has remained challenging for several reasons. Although mass spectrometry based techniques have witnessed considerable progress recently, it is laborious to measure active forms of proteins in a highly quantitative and high-throughput manner. Furthermore, unraveling functional interactions between phosphoproteins demands a large number of experiments where the key signaling molecules are perturbed, or even co-perturbed, by using direct gene knockouts, gene knockdowns, specific inhibitors or other external stimuli. A number of different computational strategies have been proposed to model signal transduction. A methodology based on Bayesian networks for describing the interconnections between signaling proteins has been used to study T cell signaling (used an approach based on fuzzy logic, an extension to the two valued Boolean algebra, to study the downstream signaling of tumor necrosis factor, epidermal growth factor and insulin receptors. While logic-based approaches provide models that are easy to interpret and analyze computationally, they do not allow biophysically motivated mechanistic modeling approaches, which inevitably require the use of dynamic and continuous models of signaling networks (reviewed in). Ordinary differential equations (ODE), which represent the average of detailed chemical reaction models in a cell population, have thus become preferable in studies focusing on signaling dynamics. For example,constructed an ODE model to describe receptor-dependent mitogen-activated protein kinase signaling based on prior biological knowledge about the network structure, and also identified a novel regulatory motif. Reverse engineering of dynamic models of molecular networks has also been extensively studied in the context of transcriptional regulation, and several ODE modeling methods have been proposed (A  ijond LahdesmakiLahdesma). Our approach differs from the previous methods by using continuous non-parametric dynamics and, importantly, by providing a way to modulate network's response as described below. *To whom correspondence should be addressed. A far-reaching goal is to use mathematical models and computational methods to modulate signaling pathway responses in healthy and diseased conditions. For example,attempted to detect drug targets from phosphoproteomic data by identifying changes in a pathway induced by a treatment relative to an untreated control. Given the complexity of signaling pathway dynamics, accurate modulation strategies inevitably require the use of a mechanistic model of network dynamics. Modelbased intervention approaches have been studied in the context of probabilistic Boolean network models (), but there is an interest on how the intervention strategies can be implemented for continuous and dynamical models. Here, we present a flexible non-parametric ODE model and propose an efficient and scalable network structure learning algorithm to identify signaling pathways and their dynamics from phosphoprotein data. This modeling method, called Sorad, assumes the standard ODE formulation but alleviates the detailed parametric model specifications by using nonparametric functions. This has important consequences for the signaling pathway reconstruction as we have to estimate only the kinetic parameters and and the hyperparameters of the covariance function, but no parameters directly related to the regulatory functions. When applied to previously unseen stimuli, Sorad provides quantitatively accurate signaling pathway responses. More importantly, we show how Sorad can be used to design interventions for the modulation of said pathway's response and dynamics. This novel and unique method enabling the design of optimal stimuli (e.g. receptor stimuli, drug treatment) encourages the discovery of new methodologies for experimental design, drug discovery and therapeutic applications. To demonstrate Sorad's performance, we make use of the DREAM project, an initiative to foster collaboration between experimental and computational biologists (), and validate our predictions on independent experimental data from a human carcinoma cell line (part of DREAM4) originally published in ().
METHODS
A non-parametric and probabilistic model for continuous signaling pathway dynamicsFull description and derivation of the computational methods can be found from Supplementary Material. We model signaling pathway dynamics using first-order linear ODEs where the non-linear driving function for each phosphoprotein x i is unknown. The time-dependent phosphorylation level for each phosphoprotein is modeled using three components:where x i t is level of the ith i  1,. .. , N phosphoprotein at time t, _ x i t denotes the time derivative, i is the basal rate, which captures the constant (non-zero) part of the phosphoprotein data, i is the degradation rate, which models spontaneous decrease or degradation of phosphoprotein level, f i is the non-parametric regulatory function, which generates the dynamic changes in the phosphoprotein level by time (a.k.a. models the actual signaling mechanism). We set a Gaussian process prior over regulatory functions f i to prefer smooth functions. We assume that inactive form of the protein is not limiting the rate of phosphorylation. Traditional ODE modeling approaches typically encounter problems with parameter estimation and model structure comparison because neither of those have analytically tractable closed form solutions (except special cases). As is explained below, the analytical solution, which is inherited from the Gaussian process formulation, is one of our main motivations because we can thus avoid problems associated with parameter estimation steps, have an analytical model selection score and have a build-in regularization via the Bayesian analysis. Moreover, our chosen formulation also allows efficient experimental design.
Defining signaling network dynamicsFor a given (fixed) signaling pathway structure, the key challenge is to define the non-parametric functions such that the signaling network dynamics agree with experimental data. Previously, a similar estimation problem for non-parametric functions f i has been solved in the context of a discrete-time system () or using the first-order approximation of the derivative (A  ijond LahdesmakiLahdesma). Here, we develop a probabilistic estimation method for continuous dynamics using a two-step approach, as illustrated inside the topmost rounded rectangle in Supplementary. The first step is to identify the driving functions, including basal rate, degradation rate and regulatory function as a function of time only, f i t. This step is done independently for each of the measured phosphoproteins by solving the non-parametric ODE model in continuous time such that the obtained function x i t explain the measurements as accurately as possible, a step that only requires measurements of the corresponding phosphoprotein. Conceptually, when considered as a function of time, the non-parametric regulatory function tells for any time point the instantaneous rate of (de)phosphorylation needed to obtain the observed dynamics. The phosphorylation level of x i can be solved to yieldwhere c i depends on the initial condition at t  0. We assume that the time-dependent driving function f i is different for each experimental condition but phosphoprotein-specific kinetic parameters i and i (as well as hyperparameters of the Gaussian process) are shared over different conditions. The linear integral transformation applied to the function f i inpreserves the Gaussian process property of f i. Thus, the process x i is also a Gaussian process, i.e. x i t $ GPm xi t, k xi, xi t, t 0 , where the mean is m xi t  i i  c i exp i t  3 and the covariance function k xi, xi t, t 0  is shown in Supplementary Equation (24). The kinetic parameters i and i and hyperparameters are estimated by optimizing the (log) marginal likelihood of the data, which can be written as log px i jT,    1 2 x i  m xi  T K xi, xi  2 n, i I 1 x i  m xi   1 2 log jK xi, xi  2 n, i Ij  n 2 log 2 4where x i contains the phosphoprotein measurements for x i , T is a vector of measurement time indices, represents the parameters and hyper parameters, m xi is a vector of values of m xi evaluated at T, K xi, xi is the covariance matrix between x i and x i evaluated at T, 2 n, i denotes the measurement noise variance for x i , and n denotes the number of measurement time points. For partial derivatives of Equation (4), see Supplementary Equations (3641). Finally, the driving functions f i are estimated using the posterior means. In particular, predictive equations for f i can be written in the standard form (omitting the phosphoprotein index i in the following) f  jx, T, T  $ N f  , Covf  , wherewhere K f, x is the covariance matrix between f i and x i evaluated at T, f  denotes the points to be predicted and f  is our final estimate (see derivations in Supplementary Material and Supplementary Equation (11) for details). As a result, we get the estimated values for the kinetic parameters i and i and the condition-dependent functions f i for each phosphoprotein. The second step finds a mapping from measured phosphoprotein timecourse profiles of a specific set of regulatory proteins to the inferred timedependent regulatory function. This is done with the following regression model:where x reg i t  x i1 t,. .. , x ik t denotes the activities of k phosphoproteins at time t regulating the phosphoprotein x i and g i is an unknown non-parametric function with Gaussian process prior. Function g i is estimated using the Gaussian process regression at measurement time points. The s.c. final g i function will be refined during the validation step together with the construction of the final network structure. While f functions need to be estimated separately for each experiment, for the estimation of g we use all experiments together and find a mapping from regulatory phosphoproteins to the target protein that explains all the experimental (training) data. In other words, g functions represent the actual mechanisms that propagate signal through the network. A schematic diagram of the model and its inference is shown in Supplementary.
Unraveling signaling pathway model from dataThe above model inference applies for a given fixed signaling pathway structure, which is completely specified by the functions g i and their inputs x reg i. Fortunately, we can iteratively apply the second step to different combinations of regulatory signaling components x reg i to assess the confidence in each network structure. In this study, we use Bayesian and cross-validation approaches to rank different signaling network structures. In addition, we use the information included in f functions. In each of the cross-validation cycles, the alternative models are fitted to the training data and the corresponding prediction performances are assessed using the test data. Note that we use only the original training data for model fitting. For Bayesian analysis, we need the marginal likelihoods of different models, which for Gaussian processbased regression in Equation (5) can be written analyticallywhere represents the hyperparameters, and is again optimized by maximizing the marginal likelihood [see Supplementary Material and Supplementary Equations (4346) for partial derivatives]. In addition to the built-in regularization rising from the use of marginal likelihood, we noticed a need for penalizing the models, which are composed of many explanatory variables. We defined a prior distribution for the signaling networks in a similar way as in the Akaike information criterion that penalizes models based on the number of variables, i.e. pM / exp2k, where k is the number of directed connections in a network structure M, and k max is a maximum number of explanatory variables to be considered. As a result of cross-validation and Bayesian analysis, we obtain scores for different signaling networks, which can be summarized to pair-wise relationship between phosphoproteins by summing the scores of all model structures that contain a specific directed interaction. These scores can be used to rank links between proteins. The estimated functions f are also used to choose the signaling network structure for two reasons. First, cross-validation and Bayesian approaches depend on our choice of models of the perturbations (e.g. unknown dynamics of external cytokine and growth factor perturbations), whereas the analysis on f functions does not. Second, cross-validation and Bayesian approaches would fail to identify phosphorylation events that are active only in a single experiment. The f function represents the instantaneous rate of change of a phosphoprotein. If our method infers remarkably different dynamics for f in a single time-series experiment, that gives evidence for dependencies that are likely observable only under that particular condition. Thus, hierarchical clustering analysis is done using average linkage and the Euclidean distance over f functions to reveal dependencies between f functions and perturbations. Clustering can be interpret by looking at how different growth factor stimulations cluster separately if any of the clusters get higher or lower f values, and whether certain upstream inhibitions cause f functions to cluster into another cluster with lower/higher values than f functions in an uninhibited case under the same growth factor stimulation. The final dynamical system we obtain by interchanging the functions f i in Equation (1) with the functions g i can be expressed in a vector form as _ xt  gxt   diagxt  6 where xt  x 1 t, x 2 t,. .. , x N t T , gxt  g 1 x reg 1 t, g 2 x reg 2 t, .. . , g N x reg N t T and the kinetic parameters   1 , 2 ,. .. , N  T and   1 , 2 ,. .. , N  T. This system can be solved numerically over time given the perturbations and the initial activity levels of the phosphoproteins x0. Occasionally, predictions can be negative, which in this study were truncated to zero by biological reasoning.
Prediction of interventionsNote that given perturbations and initial activity levels of the phosphoproteins, it is a trivial task to simulate the behavior of the dynamic system in Equation (5) over time using, for example, Euler's method. However, a much harder problem is to estimate the perturbations given the desired behavior of a system over time. The problem can be stated as follows: Given a desired time profile of a target protein's activity level, estimate the time profiles of one or several of its regulatory proteins to achieve the desired signaling response. We propose a novel method to design interventions, which consists of two-step solution. First, given the desired behavior of the target protein x j , estimate the regulatory function f j t as explained above. Second, estimate the initial values of the inputs x reg j to the function g j in such a way that it approximates the ideal phosphorylation function f j t as well as possible. Because the analytically tractable Gaussian processes properties apply to the system state x i as well as to the regulatory functions f i and g i , our modeling framework is particularly well suited to design modulation strategies. The task of predicting interventions can be seen as an inversion of a Gaussian process. For the sake of simplicity, let us consider situation of a single test point t  2 R p , i.e. the inputs are p-dimensional, and the training data is composed of the training inputs T (i.e. phosphorylation time-course data) and outputs g. In that case, the predictive equation for a single test point is (where K g, g T, t   2 R 1N holds the covariances between N training points and the test point t . Now, if we turn the traditional situation the other way around, i.e. we assume that we know the desired output (denoted as ^ g  ) but we do not know the value of the test point t  (input). From Equation (7) we notice that the only term that depends on t  is the vector K g, g T, t  . Each of the elements in the vector K g, g T, t   are given by the covariance function k g, g , e.g. ith element is the covariance between the ith training input and the test point t . Using the mean square error criterion, we can then write the optimization problem for perturbations as arg min tIn other words, the optimal perturbation corresponds to the initial phosphoprotein levels t  , which minimize Equation (8). Additionally, the search for optimal perturbations in Equation (8) can be combined with the uncertainty of the predictions (see Supplementary Material for details). Overall, Sorad's computational complexity has two major steps. First, inference of dynamics, network structure and interventions all involve inversions of covariance matrices, which have no more than cubic asymptotic time complexity. Second, for each phosphoprotein, inference for dynamics and regulatory proteins need to be applied for all 2 N combinations of regulatory proteins. Thus, for large signaling networks, an upper bound on the number of regulatory proteins needs to be set, hence reducing the exponential term to a polynomial time complexity. Owing to the design of Sorad, however, the estimation of the f and g functions is an embarrassingly parallel problem and thus the combinatorially increasing computational load can be distributed.
RESULTS
Phosphoprotein time course from HepG2 cell lineIn our training dataset, previously published in (), four cytokines or growth factors (IGF1, TGF, IL1 and TNF) were individually used to stimulate hepatocellular carcinoma cell line HepG2. In addition, inhibitors for MEK1/2, p38, PI3K and IKK proteins were used to dissect the upstream regulators for the measured proteins, resulting in altogether 4  1  4  1  25 different conditions. The activity levels of seven phosphoproteins, namely ERK1/2, HSP27, JNK1/2, IKB, MEK1/2, p38 and AKT, were monitored in the 25 different conditions in a time-series manner, measurements being taken at 0, 30 and 180 min. For the test dataset, we use an independent time-course dataset from (), which includes the same set of seven phosphoproteins with 5  4  20 different perturbations: the inhibitions were five different pairs of individual perturbations, namely p38  MEK1/2, PI3K  MEK1/2, p38  PI3K, p38  IKK and PI3K  IKK, and the stimuli were IL1, IGF1, TGF and the pair TGF  IGF1.
Modeling HepG2 phosphoprotein dynamicsWe first estimated values of the and parameters for each of the seven phosphoproteins (Supplementary). For example, based on the model fitted to the data, HSP27 has the lowest basal rate. A closer manual inspection on the data supports this finding, i.e. the level of HSP27 is low overall and is only activated when stimulated with IL1 (Supplementary). Similar reasoning can be done for the low basal rates of ERK1/2, IKB, JNK1/2 and p38. The estimated regulatory functions f for AKT is visualized in(for other phosphoproteins see Supplementary Figs S3S8). A separate subplot is shown for each of the individual experimental settings, including the experiment-specific measurements, f function and the continuous profile of the phosphorylated AKT level. It is evident that the estimated functions are non-linear, and moreover, that they could not be approximated with linear functions without drastic effects, emphasizing the suitability of the presented non-parametric methodology. Recall that g is an approximation for the set of functions f, and it is a function of activity levels of regulatory phosphoproteins in contrast to functions f that were functions of time. It was found out that the behavior of f functions, e.g. for ERK1/2, are best explained by altogether three variables, TGF, MEK1/2 and ERK1/2 (see the next section). The estimated regulatory function g for ERK1/2 is shown in Supplementary. The topmost part of the figure illustrates the estimated outputs of f and g functions across the 25 different experiments, and the lower part visualizes the values of the explanatory variables. The initial boost in the activation of ERK1/2 is explained by the stimulation of TGF receptor, and its effect is mediated by MEK1/2.
Unraveling the cell-typespecific signaling networkAltogether three types of criteria were used to reveal the datasupported relationships between the phosphoproteins: prediction performance (cross-validation), fit of the model (marginal likelihood) and effects of individual perturbations (clustering of f functions). The data-supported confidences of the relationships for ERK1/2 are shown inand B. The marginal likelihood and cross-validation scores suggest that the changes in the activity level of ERK1/2 are well explained by the activity levels of ERK1/2, MEK1/2 and TGF. It is interesting to see that ERK1/2 is the strongest hit from the cross-validationbased analysis, i.e. has the lowest negative log-likelihood score among the possible regulators. As another example,and D shows the data-supported confidences of the relationships for IKB. In, both of the analyses suggest that the activation level of IKB and IKK and the perturbation status of IL1 are good predictors of the activation of IKB. The regulatory role of TNF is suggested by the marginal likelihoodbased analysis although it was less evident according to the cross-validation results. Moreover, the roles of IL1, TNF and IKK are supported by the results of the hierarchical clustering of f functions asthe measurements that were used to fit the model. The filled curves represent the continuous profile x that is estimated to produce the measurements. The unit of measurements is scaled/arbitrary. The leftand right-hand sided y-axes differ but remain the same between the subfigures and they cover the range from zero to the maximum value measured for AKT (the crosses and the filled curves) and from the minimum to the maximum value of the regulatory function (the solid orange lines) illustrated in, as the stimulation of either IL1 or TNF receptors discriminate f functions but this does not hold when IKK has been inhibited. Therefore, it can be concluded that IKB, IL1, TNF and IKK is the best set of explanatory variables that are used to predict the activity level of IKB. Some of the dependencies between the phosphoproteins are only observable in one condition, e.g. mediating role of p38 in the activation of HSP27 when IL1 is used for stimulation (see Supplementary). In these cases, the cross-validation fails because the dependency is only observable in the training data or test data but not in both. However, the marginal likelihood based approach and the clustering of f functions reveal these unique relationships and are hence used to supplement crossvalidation. The computational method for combining the marginal likelihood, cross-validation and clustering-based information is not fully automatic, although such an approach could be developed. Our view on the approach is such that, owing to the diversity of interactions between signaling proteins, it is better to produce useful and orthogonal data for the user and to allow partial manual control, combined with biological knowledge, to reason about the signaling events as demonstrated above. The data-supported network model of the signal transduction in the HepG2 cell line is shown inwhere no biological prior knowledge was used. In this study, the estimation of g functions cover all the models from a single explanatory variable up to the models consisting of six explanatory variables. Regulatory relationships downstream of proteins that forward the signal from the receptors to the pathway end points have been marked by dashed edges. Supplementaryhas been modified fromby drawing the arrows coming from the cytokines or growth factors only to the mediating upstream regulators. Most of the inferred interactions are supported by the literature. For example, the mediating role of p38 in IL1-induced activation of HSP27 was inferred correctly (). Interestingly, our model predicted donwstream signaling to be dependent on the original growth factor stimuli, whereas many models predict that signal is propagated in a similar manner in the network once it is initiated. However, it is really the case in cellular biology that initial stimuli can affect the outcome because each growth factor regulates differently the receptors and adaptor proteins that mediate the signal transduction. In principle it is possible to model this, but all the necessary information is not available at the moment. The fact that proteins can be regulated from several sites complicates their behavior even further. In addition, different signaling pathways can crosstalk together generating (in)activation effects on adjacent pathways. This all underlines the importance of modeling the signal transduction in stimulus-dependent manner.
Sorad provides accurate predictionsThe ability of Sorad to predict phosphoprotein activity levels in a signaling pathway is illustrated in Supplementary. First, the optimal model topology is inferred as described above, and its dynamics are learned from the whole training data. The model can then be initialized with different phosphoprotein levels and perturbation configurations, and the response of the system can be solved numerically. The third challenge in the DREAM4 was to unravel a signaling network based on experimental data, and the model fit was assessed by the prediction performance. The task was to predict the activity levels of the phosphoproteins at 30 min after the initiation of cytokine stimuli given the initial activity levels of the phosphoproteins and the information about the perturbations. The goal of the challenge is to find the best predictive model with the minimal number of connections in the signal transduction network.lists the results of Sorad and the four best performing teams from DREAM4. All the attributes listed inare computed as in DREAM4 and are explained in 'Performance metrics' section in Supplementary Material. Sorad performed well because it had the best prediction score as well as the smallest number of edges in the network. The best performer in the DREAM4 challenge used a methodology formulated within a Boolean logic framework (). The first step in their method statistically identifies whether a certain perturbation has an effect on the phosphorylation of a given protein (binary decision) and constructs a Boolean network model. In the second step, they link these inferred relationships withHere the marginal likelihood and cross-validation scores (in negative log scale) are summarized to represent the confidences between the pairwise relationships for the target protein ERK1/2. The relationships with small scores are more reliable and are preferred. (B) The hierarchical clustering of f functions of ERK1/2 for all perturbations (indicated on the left) in the training data. TGF-stimulated samples form a separate cluster with higher f function values, suggesting that TGF activates ERK1/2. However, the f function under TGF-stimulated MEK-inhibited conditions have lower values and clusters into another cluster, suggesting that MEK1/2 mediates the activating effects of TGF. According to all the results, TGF, MEK1/2 and ERK1/2 itself regulate ERK1/2 activity. Inhibition is denoted with the character 'i' at the end of the protein names (e.g. MEKi). (C and D) The same analysis when the target is IKB the experimental data by combining linearly the observed effects of the perturbations. The second top best performing team also developed a two-step approach: a parametric linear ODE model is first used to infer the topology of the signaling pathway and this model is used as the starting point for a predefined nonlinear ODE model that is fitted to the experimental data (The New York Academic of). The performance metric p-values show that the activity levels of AKT are the most challenging to predict. To study this more closely, we have visualized the test set measurements together with our predictions for AKT in. The largest differences between the measurements and the predictions are due to the underestimated stimulative effect of TGF and IGF1. As AKT lies downstream of TGF, IGF1, PI3K and IKK (), it is important that cooperative effects of the perturbations are estimated correctly.shows Sorad's predictions and the test set measurements for MEK1/2 across the 15 test conditions. The cooperative effect of TGF and IGF1 receptors is challenging for modeling because the stimulation of IGF1 growth factor alone is not sufficient to activate MEK1/2. However, Sorad can capture this non-linear co-operativity well. The corresponding predictions for other five phosphoproteins are visualized in Supplementary Figures S11S15. Taken together, we conclude that proposed non-parametric ODE model provides a predictive modeling framework that is generally quantitatively accurate.
Upstream regulators of AKTWe identified AKT as an interesting candidate protein for a more detailed analysis. We studied the effect of different perturbations on the activity level of AKT based on the training data (Supplementary). Interestingly, the model suggests that TGF or IGF1 stimulation induces approximately the same level of AKT activity. Similarly, we notice that the inhibition of PI3K has a greater negative influence on the activation of AKT than the inhibition of IKK, regardless of whether TGF or IGF1 stimulation is used, which is in accordance with the PI3Kdependent activation of AKT (). Strikingly, supporting a finding previously reported in (), AKT activation is dependent on IKK inhibition when TGF receptor is stimulated (Supplementary). High specificity of the inhibitor () and TGF-assiocated regulation suggests that the observed IKKAKT interaction is not caused by unspecific side effects.. Predicted behavior of (A) AKT and (B) MEK1/2 in the unseen perturbations conditions and their observed phosphorylation levels in real measurements. The leftmost bars are the provided values for 0 min time point for a given inhibition. They show the initial baseline for all the predicted and measured values at 30 min time point with the same inhibition (bars on their right side). The blue bars represent the measured phosphorylation level at 30 min and the orange bars show the predictions. Units are arbitrary (fluorescence levels), but y-axis is equal in all the subfigures for one predicted/measured protein covering the range from zero to the maximum value of the measurements of the corresponding proteinThe IKK-dependent activation of AKT on TGF stimulation is supported by both the training and the independent test data. For example, when TGF receptor is stimulated, AKT activity decreases only on inhibition of IKK, PI3K or both, whereas IKK-dependent activation of AKT cannot be observed in IGF1-stimulated cells (and 4A and Supplementary).
Computational design of interventions to generate desired signaling pathway responseNext we study the suitability of Sorad for predicting experimental conditions to acquire a desired signaling response, for which we again use the original partitioning of the training and test data. We study two different cases where the activation of AKT is controlled: either the activity level of AKT remains constant or it is strongly increased after the perturbations (150% of the maximum activity level of AKT in training data). The estimated perturbations that are needed for the desired AKT activity levels are shown inD. In each of the cases, we consider five different initially fixed perturbation conditions: none of the perturbations are fixed, TGF stimulation is either mandatory or not permitted, or IGF1 stimulation is mandatory or not permitted. The four regulators are partioned into two groups based on the experimental setting: TGF and IGF1 are regulators that can be used to stimulate the respective receptors, and PI3K and IKK are mediators that can be inhibited. As an example, consider the case where IGF1 receptor has been stimulated and the activity level of AKT is desired to remain constant (the top-left subfigure and the second bar chart group from top). When IGF1 receptor is stimulated, we get the estimated values for three free factors: TGF receptor should not be stimulated and PI3K and IKK should be inhibited. From the biological point of view, this finding is arguable and, in addition, from(bottom row, the third panel from left), we notice that the only condition where IGF1 receptor is stimulated and AKT is not further activated is the one where TGF receptor is not stimulated and PI3K and IKK are both inhibited, exactly as we estimated. A more sophisticated approach can weigh the predictions by the amount of uncertainty that is associated with it, which in principle should bias the estimated stimuli/inhibition levels from moderate to the ones used in the model construction. This is also a desired property from the experimental point of view because it would allow the use of the same experimental conditions as used already in the experiments to generate the training data.(corresponding to the case in) and(corresponding to the case in) show the estimated perturbations when we take into account the uncertainty of the estimations. It is clear that when the uncertainty in the estimations is taken into account, the estimated perturbations are closer to the perturbations that have already been used in the training data. For example, if it is desired to activate AKT () and it is given that either TGF or IGF1 receptor is stimulated, then the estimated perturbations are similar to those in the experiments producing the training data. Another example includes the case where AKT is not further activated (and B) under the stimulation of TGF receptor: in this case, the approach that tries to minimize the amount of uncertainty predicts an experimental condition that requires one perturbation less than the one that is achieved by minimizing the error between the desired and predicted behavior. This can again be validated based on the data shown in, as we notice that it is enough to silence PI3K (inhibition p38i  PI3Ki) under the stimulation of TGF receptor to keep AKT activity at the basal level. Because the predicted interventions to modulate the signaling response are validated by independent experimental data, we conclude that Sorad can be used to identify accurate modulation strategies.
Performance evaluation using in silico dataTo better demonstrate Sorad's performance in predicting dynamics and perturbations, we set up an in silico signaling scenario similar with the one in the HepG2 cell line. We define a hypothetical ODE model (Supplementary) where two proteins are responsible for the phosphorylation of a target protein and generate data from the model with additive Gaussian noise. Assuming the model structure is known, we first learn the dynamics of the model (functions f and g) together with and , and then apply it to independent test data to predict the response. As shown in SupplementaryD, Sorad is able to learn the unknown regulatory function as well as make accurate predictions of signaling dynamics over long time intervals. We also tested Sorad on a more challenging in silico problem where effectively less data are available to learn the
A C DB. Predicting the optimal perturbations to control the activation level of AKT in an unrestricted situation or under different preset conditions (stimulation with IGF1 or TGF is mandatory or not permitted). The levels of bars in the bar charts reflect the suggested levels (concentrations) of IGF1 and TGF growth factors as well as PI3K and IKK inhibitors, all of which can be used to acquire the desired activation level for AKT. The dashed lines mark at the levels of perturbations used in the training data. (A) In this prediction, it is desired that the activity level of AKT after 30 min is same as the initial activity level. (B) The situation is the same as in (A) but here the uncertainty of the prediction is taken into account in the optimization. (C) In this prediction, it is desired that AKT is fully activated after 30 min, i.e. the activity level of AKT is 150% of the maximum activity level of AKT in the training data. (D) Same situation as in (C), but here the uncertainty of the prediction is taken into account phosphorylation dynamics g. Nevertheless, as shown in Supplementary Figures S2AD, Sorad still makes relatively accurate predictions under uncertainty in estimated dynamics. To that end, we applied the estimated models (Supplementary Figs 1C and 2C) of phosphorylation dynamics to predict perturbations. First, we simulate the mathematical model and then, using the estimated dynamical model, estimated the optimal perturbation (or input) to obtain the observed model response. Results in Supplementary Figures S1E and S2E show how the estimated perturbation closely follows the (unknown) input used to generate the data, thus demonstrating Sorad's ability to predict dynamic perturbations over long time intervals.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
T.A  ij et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Quantitative modeling and modulation of signaling pathways at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Prediction P-values for different phosphoproteins, the number edges in a network, combined prediction score and the overall score for different methods.
DISCUSSION AND CONCLUSIONS The presented methodology, Sorad, combines dynamic models with a data-driven non-parametric component, which leads to a flexible and probabilistic dynamical modeling framework. The first main contribution of this study is the efficient methodology, which makes the use of ODEs easy in situations where the construction of a parametric network model beforehand is challenging, as is typically the case in practice. The second main contribution is the scheme for predicting required perturbations for modulating the pathway response, which we demonstrated with a proof-of-concept example using real phosphoprotein timecourse data. To validate Sorad, we carried out a comparison that demonstrated its applicability for modeling signal propagation even without prior biological knowledge. This is supported by the performance assessment of the predictions: Sorad produced the most accurate predictions with the smallest number of relationships between the phosphoproteins. In addition to modeling signaling pathways, Sorad is also applicable for modeling other types of biological processes and it can be applied to even larger networks and datasets because the computation can be easily parallelized. However, if one is interested in analyzing larger networks consisting of hundreds or thousands of phosphoproteins or, for example, transcripts, the manual clustering step for the search of individual conditions where a target protein or gene is regulated differentially will become a bottleneck. For large networks, this step could be automated by using, for example, model-based clustering methods, which provide a quantitative and probabilistic scoring framework. Also note that the estimation of f functions is analytically tractable as long as it is possible to write the solution of the ODE, which only contains linear operations on f function. A closer inspection of the pathway model that was inferred using Sorad pointed out a putative regulatory role for IKK in the activation of AKT in TGF-stimulated cells. AKT has been generally thought to regulate IKK, thereby suggesting a reverse regulatory interaction between the proteins (Manning and Cantley, 2007). Low levels of IKB phosphorylation in TGFstimulated cells imply that NF-B pathway is unlikely to mediate IKK-dependent AKT phosphorylation and we could not find any publications reporting IKK-dependent activation of ILK or mTORC2, the upstream kinases for AKT. Interestingly, IRS1 has potential to regulate AKT in HepG2 cells (Khamzina et al., 2005): increased IRS1 phosphorylation (Ser636/Ser639) decreases both IRS1-PI3K interaction and AKT phosphorylation after stimulation through insulin receptor. Furthermore, IKKs bind to IRS1 in a basal state in HepG2 cells (Gao et al., 2002). On TNF stimulation, IKK-IRS1 interaction is disturbed and IRS1 gets phosphorylated on Ser312, leading to decreased IRS1 activity in insulin-treated cells. IRS1 gets phosphorylated on Ser636/Ser639 residues after TGF (but not after IGF1) stimulation in the original dataset (Alexopoulos et al., 2010), which correlates with IKK-dependent AKT activation only in TGF-treated cells. Interestingly, MEK1/2 activation is also dependent on both PI3K and IKK after TGF stimulation, suggesting a similar type of upstream regulation. The data suggest that IKK might regulate AKT (and MEK1/2) phosphorylation through IRS1 and PI3K in TGF-treated cells. This idea can be addressed in adjacent biological studies. What comes to the prediction itself, it demonstrates how the data-driven nature of Sorad provides high potential to generate novel hypotheses for further experimental research.
