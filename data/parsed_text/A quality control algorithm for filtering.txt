Motivation: The quality control (QC) filtering of single nucleotide polymorphisms (SNPs) is an important step in genome-wide association studies to minimize potential false findings. SNP QC commonly uses expert-guided filters based on QC variables [e.g. Hardy–Weinberg equilibrium, missing proportion (MSP) and minor allele frequency (MAF)] to remove SNPs with insufficient genotyping quality. The rationale of the expert filters is sensible and concrete, but its implementation requires arbitrary thresholds and does not jointly consider all QC features. Results: We propose an algorithm that is based on principal component analysis and clustering analysis to identify low-quality SNPs. The method minimizes the use of arbitrary cutoff values, allows a collective consideration of the QC features and provides conditional thresholds contingent on other QC variables (e.g. different MSP thresholds for different MAFs). We apply our method to the seven studies from the Wellcome Trust Case Control Consortium and the major depressive disorder study from the Genetic Association Information Network. We measured the performance of our method compared to the expert filters based on the following criteria: (i) percentage of SNPs excluded due to low quality; (ii) inflation factor of the test statistics (λ); (iii) number of false associations found in the filtered dataset; and (iv) number of true associations missed in the filtered dataset. The results suggest that with the same or fewer SNPs excluded, the proposed algorithm tends to give a similar or lower value of λ, a reduced number of false associations, and retains all true associations.
INTRODUCTIONGenome-wide association studies (GWAS) have been shown to be a powerful and successful strategy in identifying genetic variants * To whom correspondence should be addressed. that influence common and complex diseases. Prior to the advent of GWAS in 2005, there were only a few robust, replicated associations identified, such as NOD2 for Crohn's disease (CD;), and PPARG, KCNJ11 and CAPN10 for Type 2 diabetes (T2D) mellitus (). With GWAS, there are now more than 30 loci identified for CD and almost 20 loci for T2D (). To date (), there are over 545 published studies reporting genetic variants responsible for more than 340 common diseases (; http://www.genome.gov/gwastudies). GWAS interrogate millions of single nucleotide polymorphisms (SNPs), and the large-scale genotype calling (which translates probe hybridization intensities into actual genotypes) must fully resort to automated clustering procedures (). Ideally, SNP genotyping yields three clusters of signals, and a subject's genotype can be assigned according to cluster membership (). In reality, the clustering methods are unavoidably prone to error, as imperfect clusters of signal clouds can arise due to experimental variation, DNA quality and nonspecific hybridization issues (). Common error patterns include missing calls for SNPs with overlapping genotype clusters (), homozygote heterozygote miscalls (), false homozygote calls in heterozygous individuals due to allelic dropout (), and erroneous assessment of monomorphic SNPs as polymorphic (). SNP quality control (QC) is commonly safeguarded by 'supervised' (i.e. expert-guided) filters to exclude low-quality SNPs. The 'supervised' expert filters aim to remove SNPs that fall into the extremes of QC variables including HardyWeinberg equilibrium (HWE), missing proportion (MSP) and minor allele frequency (MAF). The rationale is clear: extreme deviation from HWE is typically used to identify gross genotyping error (); a high MSP indicates poor genotype probe performance and low genotyping accuracy (); SNPs with low MAF are more prone to error, as fewer samples would be within a genotype cluster and most clustering-based calling algorithms do not perform well with rare alleles (). However, the implementation of expert filters tends to require arbitrary determination of cutoff values for the QC variables, and does not jointly consider all QC features. For example, in GAIN studies, the minimum SNP genotyping quality standards are HWE P-value >0.00033, average MSP < 3%,Page: 1732 17311737
M.Pongpanich et al.MSP maximum <10% and quality score and MAF greater than a pre-determined minimum level, which varies from study to study (GAIN Collaborative Research). For GWAS conducted by the Wellcome Trust Case Control Consortium (WTCCC), the criteria for retaining a SNP are: HWE P-value  5.7  10 7 , MSP  5% if MAF  5%, MSP  1% if MAF < 5% and MAF > 0.01 (WTCCC, 2007).included SNPs when the HWE P-value >0.001, MSP  5% and MAF > 0.01.included SNPs when the HWE P-value  10 6 and MSP 10%. Statistical methods have also been developed to identify, assess or incorporate genotyping errors in association studies (). Recently,introduced a calling algorithm to minimize the biases that occur when case and control DNA samples are from different sources and processed in different laboratories.investigated appropriate cutoff values for each of the QC variables (MSP, MAF, HWE and confidence score of genotype calls) by dividing and reshuffling healthy samples.assessed the stability of the assigned genotypes by introducing white noise to the fluorescent intensities of each subject and evaluating the agreement between the calls made with the noise-perturbed and original intensities. Finally, for family-based studies,developed a transmission test to measure the genotyping error rate of each proband. In this work, we take the rationale of the expert filters and propose an 'unsupervised' (i.e. algorithm-determined) filter to detect low-quality SNPs. Like 'supervised' expert filters, our filter also aims to identify QC outliers. Furthermore, our filter automates the QC threshold determination based on all QC features, and gives conditional cutoffs contingent on the values of other QC variables (e.g. different MSP thresholds for different MAFs). The algorithm is based on the premise that the majority of SNPs have sufficient genotyping quality with QC variable values in certain directions (e.g. low MSP and non-low MAF). SNPs with QC values deviating from the majority are considered outliers and are then labeled as problematic SNPs. The algorithm first performs principal component analysis (PCA) on the QC variables with an aim to separate good SNPs from problematic SNPs on a two-dimensional plane. It then uses Density Based Spatial Clustering of Applications with Noise (DBSCAN;) to identify the boundaries of good SNPs and define QC thresholds. We evaluate the performance of the proposed algorithm and demonstrate its utility using the seven WTCCC datasets () and the major depressive disorder (MDD) dataset from Genetic Association Information Network (GAIN) studies ().
METHODS
The proposed QC algorithmWe begin with a SNP dataset that has been cleaned using the criteria of quality score and HWE. That is, if an SNP does not reach the desired level of quality score, the genotyping result is specified as 'missing'. In addition, SNPs that show severe HWE violations in the control group (i.e. the P-value of the HWE test is smaller than a threshold appropriate for multiple testing) are excluded from the dataset. Quality score and HWE are used to pre-clean the dataset because they have clear definitions for good SNPs. While deviation from HWE has relatively low sensitivity in testing for genotyping error (), it has been shown that severe genotyping errors often do cause extreme HWE deviations (). With this pre-cleaned dataset, our algorithm aims to identify good-quality SNPs based on two basic QC features, MSP and MAF. Specifically, we consider six QC variables including MSP in case samples (denoted by MSPcs), MSP in control samples (MSPcn), MSP in the combined casecontrol samples (MSPall), logMAF in the combined samples (logMAFall), the ratio of MSPcs to MAFcs and the ratio of MSPcn to MAFcn. MAF is considered on the log scale to ensure a more careful QC examination with a low MAF than a high MAF. The interaction term between MSP and MAF is designed to allow for an adaptive MSP threshold with different MAF values, and is defined as MSP  (1/MAF). The adaptive thresholds ensure that SNPs with smaller MAF have a more stringent MSP threshold, as missing genotypes have a larger impact on frequency when occurring in low MAF than in high MAF. We use the ratio rather than the product of MSP and MAF, so that different low-quality features (e.g. high MSP and low MAF) will be retained rather than being cancelled out in the interaction terms. A higher interaction value indicates lower quality. There are two main steps involved in the proposed QC algorithm: (i) using PCA to separate the good SNPs from the bad SNPs based on the QC features on a two-dimensional plane; and (ii) using DBSCAN () to identify the boundaries of good SNPs on the plane. The PCA is performed on the six QC variables to separate good SNPs from bad ones on the plane of the first two principal components (PC1 versus PC2), which usually account for about >80% of the variation in the original QC variables. The use of PCA facilitates the task of modeling all of these QC variables that can be highly correlated. It also projects good SNPs into a concentrated corner on the plane and spreads out bad SNPs in opposite directions along the axes of the original QC variables (e.g. see the biplots shown inand 2a, and the expert SNP classification in Figs 1b and 2b). Different studies may result in different patterns of PC biplots, but the key common feature is that good SNPs are pushed toward a certain corner that represents desirable QC values: low MSP, high MAF and low MSP to MAF ratio. Given the PCA plots, we use DBSCAN () to define the boundaries of the good SNPs. DBSCAN is a density-based clustering algorithm, it performs efficiently on large-scale datasets, and most importantly, it can find clusters of arbitrary shape. Given a data space, it defines regions of high-density points as clusters and classifies regions of low-density points as noises (i.e. a noise is a point that does not belong to any clusters). DBSCAN requires that for each point in a cluster, there are at least a minimum number, K, of points in the neighborhood of a given radius r of the target point. Ester et al. recommended setting K to four, and to determine r from the data via the following steps. First, calculate the distance of each target point to its K-th nearest point. Next, plot the sorted K-th nearest neighbor (NN) distance (which is referred to as the sorted K-th NN graph). Finally, set r to the Y-axis value where a sharp jump occurs. We follow the suggestion of using K = 4. Instead of eyeballing the value for r as suggested by the original work, we solve for r by fitting a change point model as described in the Appendix A1. The r value determined by the change-point method should be viewed as an initial value, and should be further fine tuned until certain criteria are fulfilled. For example, tune r until the resulting 'good' SNPs yield a desirable  value (i.e. the inflation factor of the test statistics;), until maximum MSP is smaller than a desirable level, or until a certain percentage of SNPs are removed. With the suitable r value, we then use the largest cluster identified by DBSCAN to define the boundaries for good SNPs (e.g. see the borders of the blue area in). The boundaries represent meaningful thresholds with respect to the original QC variables. In the final output of the algorithm, an SNP is labeled as 'good' if (i) it is in the largest cluster, or (ii) it passes the identified thresholds of all QC features even if it is not in the largest cluster. Criterion (ii) ensures the monotonicity of the thresholding. That is, any SNPs located in the 'good SNP corner' (i.e. high logMAF, low MSP and low MSP/MAF) will be included even if they are not dense enough to be included in a cluster.Page: 1733 17311737
A QC algorithm for filtering SNPs in GWAS
Performance evaluations using real datasetsThe performance of the proposed QC algorithm was evaluated using the seven GWAS studies conducted by WTCCC, including bipolar disorder (BD), coronary artery disease (CAD), CD, hypertension (HT), rheumatoid arthritis (RA), Type 1 diabetes (T1D), and T2D (). In addition, we also assess the algorithm using the MDD dataset from GAIN studies (). For the WTCCC datasets, the association statistics were calculated using a stratified Cochran MantelHaenszel test in PLINK () to adjust for population substructure. For the MDD dataset, the trend test statistics were used because the samples are ancestrally homogeneous (). For (iii), an FP is defined as a significant signal found in the data analyses but not confirmed in the literature (i.e. neither in PubMed database nor the published GWAS catalog at www.genome.gov/gwastudies). For (iv), a TP is defined as a significant signal found in the data analyses and also confirmed in the literature (either in PubMed or the published GWAS catalog). A P-value threshold of 5  10 7 (following the WTCCC paper) is used to define significance. However, because there were no literature-confirmed signals that survived the 5  10 7 threshold for BD, HT and MDD, we used a less stringent threshold of 10 5 for the P-value in our analysis for these three diseases. A threshold of 10 5 is considered to be a moderate association in the WTCCC studies (WTCCC, 2007).
ImplementationWe have implemented a command-line-based software package to perform the proposed QC algorithm. The software runs PCA using the 'prcomp' function in R and runs DBSCAN using C++ code written by us for speed Page: 1734 17311737improvement. The software and instructions are available for download from the corresponding author's website.shows the results of our method and the WTCCC expert filter based on the four criteria. The specific numerical results are given in the Supplementary Tables 1 and 2. To illustrate, we report the results using the r value obtained by the change-point model for all eight diseases regardless of whether a further fine-tuning of r was carried out. Overall, the algorithm with change-point r removed from 2.8% to 14.6% fewer SNPs than the expert filters, and yet had either smaller or comparable  values, contained fewer or comparable FPs, and retained the same TPs (which were all the TPs in the genotyped SNPs). The maximum MSP retained in the datasets ranged from 4.44% to 5.55% for the WTCCC datasets and was 37.63% for MDD. Carefully examining Supplementary Tables 1 and 2, we saw that there were three diseases where the performance with the initial change-point r value was not as good as expert filters in some of the criteria: BD (having a larger expert filter. Because the resulting maximum MSP was too large (i.e. 37.6%) when we used the change-point r, we tuned r by decreasing its value till the maximum MSP was <10% (i.e. 9.7%). The  and FPs became 1.044 and 4, respectively, which were the same as the expert filters. The  and FPs stayed unchanged when we continued tuning r until we had removed the same proportion of SNPs as the expert filter. We also categorized the SNPs into four groups according to whether they were included (i.e. labeled as 'good SNP') or excluded (i.e. labeled as 'bad SNP') by our filter and the expert filter (). For all of the diseases, our algorithm and the expert filter have around 80% agreement in inclusion and around 12% agreement in exclusion on average. The majority of the disagreement between the two filters can be attributed to the use of adaptive thresholds in our filter. To illustrate, we show the boundary of good SNPs from our filter, the expert filter, and the overlay of the two on a two-dimensional PC plane using CAD () and MDD () (see Supplementaryfor other diseases). Instead of the step-like boundary of good SNPs in the expert filter, our filter gives a smoother boundary of good SNPs.further illustrates the disagreements on the axes of MSP versus MAF (instead of PC1 versus PC2) for CAD (see Supplementaryfor other diseases). The yellow dots represent SNPs that are labeled as 'good' by our algorithm but 'bad' by expert filters. One group of yellow dots occurred in the extremely low MAF and low MSP range, indicating that our algorithm would keep SNPs of MAF < 0.01 when their MSPs were extremely low. In contrast, the red dots represent the SNPs that are labeled as 'bad' by our algorithm but 'good' by expert filters. The big red area on the right side indicates that our algorithm gives a more stringent MSP criterion for good SNPs than the expert filter (i.e. MSP < 5%): our criteria ranged from MSP < 2% to MSP < 4%, depending on the MAF. Lastly, the two red and yellow triangles in the upper middle area show the impact of the 'smoother' threshold of our algorithm: it has a more stringent MSP threshold when MAF is 0.010.025, and a less stringent threshold when MAF is 0.0250.05.
M.Pongpanich et al.
RESULTS
A QC algorithm for filtering SNPs in GWAS
DISCUSSIONEnsuring the quality of genotype data is essential for drawing accurate and replicable conclusions (). In this work, we have introduced a QC algorithm to identify SNPs with low QC features using criteria determined through PCA and DBSCAN. The proposed filter is in essence an 'unsupervised' (i.e. algorithmdetermined) version of the 'supervised' expert filter to classify SNPs, and it aims to account for multiple QC variables, provides adaptive cutoff values and automates thresholding decisions. Specifically, we use PCA to jointly model the potentially highly correlated QC Page: 1736 17311737variables, and use DBSCAN to identify the borders of good-SNP clusters that have arbitrary shapes. The boundary of the good-SNP cluster can be translated directly to meaningful thresholds for the original QC variables. The proposed algorithm retains the rationale of the expert filter to identify QC outliers, avoids arbitrary decisions on cutoff values and gives contingent MSP thresholds for different MAF values. The data applications show that with the same or fewer SNPs discarded due to bad quality, the proposed algorithm has comparable or better performance than the expert filter for all diseases. The underlying rationale of our algorithm is that the majority of genotyped markers have sufficient genotyping quality, and hence low-quality SNPs can be treated as outliers and be identified by looking for SNPs with distinct QC features. To facilitate the implementation of the idea, we use PCA on the original QC variables. PCA consolidates the information from the many correlated QC variables, and projects SNPs onto a two-dimensional PC plane where good SNPs clump together into a corner of desirable QC values, whereas bad SNPs fan out in all directions. It is expected that the PC biplot may differ from one study to another: in our exploration, we have seen different patterns in the biplots for WTCCC datasets and for the MDD dataset. Yet all biplots have good SNPs lumped into a corner that corresponds to good QC features. We wish to point out that when using the proposed algorithm, it is important to monitor the features of the retained good SNPs and tune the neighborhood radius r to safeguard the basic QC criteria. This is because the thresholds for outliers are determined relative to the majority of the data. The tuning becomes particularly crucial if a big proportion of data points are of low quality. For example, in the MDD dataset, there were about 11.4% of SNPs with MSP > 10%, and our algorithm with the initial change-point r kept SNPs with MSP up to almost 38%. Tuning of r was thus continued until the maximum MSP dropped to < 10%. In practice, the smaller r is, the more stringent the QC criteria for 'good' SNPs will be, as a smaller r makes it harder to form a cluster in DBSCAN. We suggest starting with a value of r determined by fitting a change-point model to the sorted fourth nearest distances, and then further to adjust r until the specific goal is reached, so as to assure the  value, the maximum MSP, or the percentage of SNPs removed within reasonable ranges. In our explorations, we found that the change-point r often suggests a reasonable value (e.g. in CAD, CD, HT, T1D and T2D) or is at least a good upper bound (e.g. in BD, RA and MDD, judging by the resulting  values or the retained maximum MSP). Given the change-point r, one can reduce its value if a more stringent filter is needed, and increase its value if one wishes to remove only extreme outlier SNPs. When selecting which QC variables to include in the algorithm, we intend to avoid using MAFcs and MAFcn because they may obfuscate the true associations. For the rest of the QC variables, it is possible to make other choices for inclusion/exclusion, e.g. to exclude MSPall from the proposed QC variable set (i.e. to use five variables), or to include MSPall/MAFall to the proposed QC variable set (i.e. to use seven variables). While we expected that the performance would not change much, we carried out sensitivity analyses to evaluate the impact of using different QC variables in the proposed algorithm. The results are given in Supplementary Tables 1, 2 and 3. For comparability, we tuned the r values so that each analysis removed a similar proportion of SNPs to the original 6-variable analysis. As expected, the 7-and 5-variable analyses performed very similarly to the proposed 6-variable analyses, indicating the robustness of the proposed filter to the different choices of QC variables.
M.Pongpanich et al.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 1731 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
