Motivation: Clustering of chemical and biochemical data based on observed features is a central cognitive step in the analysis of chemical substances, in particular in combinatorial chemistry, or of complex biochemical reaction networks. Often, for reasons unknown to the researcher, this step produces disappointing results. Once the sources of the problem are known, improved clustering methods might revitalize the statistical approach of compound and reaction search and analysis. Here, we present a generic mechanism that may be at the origin of many clustering difficulties. Results: The variety of dynamical behaviors that can be exhibited by complex biochemical reactions on variation of the system parameters are fundamental system fingerprints. In parameter space, shrimp-like or swallow-tail structures separate parameter sets that lead to stable periodic dynamical behavior from those leading to irregular behavior. We work out the genericity of this phenomenon and demonstrate novel examples for their occurrence in realistic models of biophysics. Although we elucidate the phenomenon by considering the emergence of periodicity in dependence on system parameters in a low-dimensional parameter space, the conclusions from our simple setting are shown to continue to be valid for features in a higher-dimensional feature space, as long as the feature-generating mechanism is not too extreme and the dimension of this space is not too high compared with the amount of available data. Availability and implementation: For online versions of super-para-magnetic clustering see
INTRODUCTIONBiological organisms are able to fabricate intricate machineries from the molecular scale up to the macroscopic scale, without the obvious need to store and to explicitly handle the corresponding information. Synthetic biology, molecular programming and nucleic acid nanotechnology have thus become an experimental playground for the search for systems that carry out humandefined molecular programs, to input, output and manipulate molecular structures (). For chemistry to become the next information technology substrate, improved tools for designing, simulating and analyzing complex molecular circuits and systems are necessary. On the DNA nanotechnology model system, corresponding knowledge is presently quickly growing and the area of alternative computing paradigms starting to take shape. From a physics point of view, biological and physical processes start to converge, so that to describe biochemical computation, concepts from physics can be borrowed and applied (see e.g.;). As will be exhibited below (Figs 1 and 2), most real-world systems exhibit a non-trivial behavior of some observables in time. Many such processes exhibit periodicity (the circadian rhythm, the cell cycle, reproduction), which therefore has often been regarded as a key expression of the essential mechanisms of life. Conversely, irregular behavior is often related to abnormal stimuli or to a defect or disorder of the generating mechanism (the cortex, however, provides an example that shows that this does not necessarily have to be the case; see). Modern methods of measurements and modeling have now provided techniques that permit the observation of dynamical aspects of processes, which in the past, because of a lack of such technology, were described as steady state. Genetic expression processes are an example thereof (). Recently, it has been possible to measure down to single-cell expression, which revealed different kinds of rhythmic to irregular expression patterns (). In our study, we will put forward a generic model that demonstrates that regular and 'stochastic' expression may result from the same non-linear system and that the transition among these states may require small parameter changes only. In Section 5, we will exhibit how more general gene expression complexity may emerge from the generic model. A particular well-known example of regular behavior is the circadian clock. Decades ago, the circadian rhythm was believed to be singularly implemented by means of a central clockwork or pattern generator. It was, however, discovered that the mutation of a single allele of a single locus (called the 'per' gene) triggers Drosophila mutants with different circadian rhythms (). Many of the genes and proteins involved in this process have been evidenced in mammals as well, where the circadian clock arises from the temporally regulated activity of proteingene pairs (). A variety of tissues and cells containing functional autonomous clocks are *To whom correspondence should be addressed. able to maintain their oscillation when placed in vitro, removed from any external cues or signals originating from environmental clocks. This naturally leads to the hypothesis that the circadian rhythm, and more generally periodic dynamics, is dispersed in any living system, with potentially every cell containing a functional clock. From the genetic base, the circadian rhythm is implemented by means of a gene expression network hosting a delayed feedback loop that causes the transcripts to oscillate with an approximate period of 24 h. A recently found period doubling in the mouse () and oscillation bifurcations in the rat () hint at the nonlinear nature of this effect. Non-linearity is also at the heart of the phenomenon that we describe below. The aim of this article is to demonstrate how the distribution of regular and irregular systems is governed by a system's non-linearity in a generic manner and that from this, consequences for the system biology analysis of data may emerge. The two instances of system biological analysis that we discuss at the end of this contribution from this point of view are clustering on a system level and parameter inference. For biological systems, the identification of the areas in parameter space responsible for periodic behavior is therefore an important task.
HOW SYSTEMS ARE DISTRIBUTED IN PARAMETER SPACE: A COMMON PITFALLAreas in a parameter space that exhibit in some sense common features are usually determined by a clustering process. In a onedimension parameter space, the natural picture of systems displaying a certain periodicity would be given by parameters that are distributed across an interval, possibly according to a Gaussian (), where, for non-linear systems, these intervals would generally be finite. In higher-dimensional parameter spaces, following this reasoning, a Cartesian product of such intervals (i.e. in dimension two, a square or a circle, depending on the topology or distance function chosen) will be expected to guarantee the emergence of periodicity. This conclusion, which is the basis of many bioinformatics approaches (e.g. the popular k-means clustering), is wrong. For real-world systems, the generic parameter space domain for periodicity is a 'swallow-tail' or a 'shrimp'-like domain. Its convexconcave form was predicted by Shilnikov's theory (), and it was later discussed in more details by Gaspard, Kapral and Nicolis (). The emergence of shrimps has been evidenced in a number of models of physical systems. Most prominent examples are a model of the InabaNishio simple resistive electronic circuit () and a simple model of a CO 2 laser (). Although shrimps are easily detected in simulations, the experimental verification is more demanding, as because of their complex boundaries, a high experimental resolution is needed to pin them down. One of the firstat that time somewhat tentative example of an experimental shrimpwas provided for Chua's circuit (). Efforts focusing on the experimental verification of shrimps have continued ever since (). To highlight that shrimps can be observed in real systems, we focus on the InabaNishio resistive circuit. The InabaNishio circuit contains a linear negative resistance ('r'), a capacitance (C), two coils (L 1 , L 2 ) and a non-linear resistance introduced either by two diodes (D 1 , D 2 , 'symmetric circuit') or by one diode only (D 1 , 'asymmetric circuit'); see. Depending upon parameter (coding for a combination of the properties of resistance r, capacitance C and coil L 1 ) and (coding for the properties of both coils L 1 , L 2 ), the behavior of the system is characterized by a spiral of shrimps (;).3 EMERGENCE OF SHRIMPS IN PARAMETER SPACE How is this multitude of scaled versions of the same shrimp template generated? In the case of smooth systems, shrimps are the result of the interaction of two or more largely independent parameters in creating points with a full set of zero partial derivatives. From this observation, the shrimps phenomenon can be explained in a simple way, for flows [the R  ossler system (and for maps [the dissipative H enon map (H enon, 1976) in (. For simplicity of argument, we will consider the discrete formulation and follow the exposition given in. Note that the dissipative H enon map is the paradigmatic 2D discrete map accounting for the universality properties of dissipative non-linear systems. The H enon map can be written in its standard form as () f h : fx; yg ! fc  dy  x 2 ; xg. After cycling through the coordinates by means of two iterations, the 2D system can be condensed into the approximative 1D mapwhich incorporates the two parameters a, b for the offset and the leading term non-linearity in one equation. Stable k-periodic islands arise wheneverholds, where f k denotes the k-fold iterated map f, and the prime 0 denotes the derivative with respect to x. A superstable locus requires that m k = 0. More explicitly, we haveThis implies that all k-superstable solutions need to pass either through x k = 0 or x k = AE ffiffi ffi a p . For the case x k = 0, for k = 1, we obtain from b  a  x 2  2 =x the relation a= AE ffiffi ffi b p : For the case x k = AE ffiffi ffi a p , we obtain b= AE ffiffi ffi a p : By differentiability of f in the parameters a, b, this defines two parabolas in parameter space, which define the four legs of the main k = 1-shrimp; see. The two parabolas intersect at points {0, 0} and {1, 1}, giving rise to the 'head' and the 'navel' of the shrimp, respectively, manifested by two distinguished doubly superstable systems. Once more, by means of differentiability, an area around these lines is identified, within whichemerge. Restricting to values jj 1, we can identify the area of the period k = 1 shrimp in the {a, b}-parameter space. This area is bounded by period-doubling bifurcations (=  1) and tangent bifurcations ( = 1) on opposite sides from the loci of superstability. By representing Feigenbaum universality in higher-dimensional parameter space, the emergence of shrimp-like structures is thus a universal non-linear phenomenon, i.e. it must be expected to occur in any non-linear dynamical system. The placement of the copies is, however, determined by the specific system's properties ().
BIOLOGICAL MANIFESTATIONS OF SHRIMPSTo what extent such structures emerge in biological systems has mostly remained unexplored. This is a non-trivial question because vast areas in parameter space may not be occupied by typical real-world biological systems and processes. Here we focus on two domains where the dependence of the dynamics on system parameters is of special interest: Biochemical reactions and neural systems. Biochemical systems: For the field of biochemical reactions, we focus on an enzymic reaction, noting that periodic behavior is not exclusive to enzymic processes. We consider the celebrated Goldbeter reaction (), for which corresponding experimental evidence is available (). Enzymic periodicities are best described at the molecular level. On this level, thecross, we deal with non-ergodicity (). Secondary, non-generic, system properties can complicate this fundamental structure Goldbeter reaction can be represented as shown in: substrate S is injected at constant rate v and runs through a sequence of enzymic reactions comprising two positive feedback loops coupled in series. S is transformed by catalyzation by an enzyme E 1 , which is activated by its product P 1. A second enzyme E 2 uses P 1 as substrate and is activated by its product P 2. k s is the first-order rate constant for the removal of P 2. The two steps are necessary to generate, along with periodicity, chaotic behavior. The metabolite concentrations can be described by the following three ordinary differential equations:, and denote the concentrations of S, PThe two reaction steps are required to provide the system with the ability to produce irregular chaotic solutions. Althoughconsidered changes of k s and v, and reported no shrimps, we investigate here the behavior obtained by changing 1 and 2 , for which we observe an abundant emergence of shrimps (). Clearly, we find shrimp-like structures with stable periodic oscillations, starting from period 4 (dark gray) to 8 (green) to 16 (yellow) to 32 (ocher). Domains of chaotic behavior are in white. Neural systems: Neuron models share many structural properties of enzymatic reactions; the occurrence of shrimps in neuron models is therefore only surprising in light of the fact that so far, their existence has not been reported [discounting structures that vaguely resemble half-cuts of shrimps (. In a number of cases, a too low dimensionality of the model prevents chaotic behavior from occurring, whereas for other models, the huge number of coupled equations and parameters involved may be prohibitive for such a research (e.g. for Hodgkin-Huxley-like equations). The phenomenological neuron model elaborated by Rulkov () does not suffer from these limitations and has been repeatedly shown to accurately describe the dynamics of biological neurons (;) because of a versatility based on minimal modeling. The equations of this model are based on two parameters and , x n+1 = fx n ; y n ; 6 y n+1 =y n  x n +1+; 7. In the central part, we superimpose the observed periodicity of solutions. Chaotic motion generates infinite periodicity (white dots). Non-white dots correspond to finite stable periodicities. In the center of the figure, a perioddoubling route to chaos is exhibited (gray ! green ! yellow ! ocher). In the original work of Decroly and Goldbeter (1982), 1 = 2 = 10 were held constantwhere the first variable codes, in loose terms, for the inner (spiking) state of the neuron, and the second variable codes for a slower background state on which this dwells. The parameters and that we will focus on encode (again in loose terms) the non-linearity and the driving current of the neuron, respectively. It is easily verified that regular, periodically firing behavior occurs on shrimp-like domains of the parameter plane ().
DIFFICULTIES FOR CLUSTERING AND SOLUTIONFrom these examples, it is evident is that in non-linear biological systems, steady-state behavior will often be the exception rather than the rule. Moreover, the proposition emerges that many of the processes that are currently declared stochastic may be chaotic. Biological systems may exploit both behaviors, preferentially even in symbiosis: A large number of small chaotic or stochastic inputs to a neuron, e.g. will generate an optimally stable input current that will force the neuron to fire regularly, generally on a limit cycle. The closer the generated response is to stochasticity, the better an ensemble of such systems provides a reliable constant driving current to the neuron, leading to a stable firing pattern of periodicity one. From the interaction among such oscillators, more complicated periodic patterns emerge, the periodicities of which are organized along Arnol'd tongues (). In the context of the circadian rhythm, the observation of locking on an Arnol'd tongue has recently been reported, along with period doubling (). Both are manifestations of non-linearity, within or among individual entities. The former effect occurs when the coupling is relatively small; the latter effect occurs and dominates when the coupling is 'larger'. The manifestation in both cases is the emergence of non-trivial repetitive patterns. In the case of neurons, such periodic signals are easily read out and identified by other neurons and can, thereby, be used as code words. Self-similarity of the shrimp areas may simplify the tuning to stay on one code word for slowly changing parameters or to engineer, in a simple way, jumps from one code word to another, enabling in this way simple state-coding. Such a coding is closely related to the coding in terms of Arnol'd tongues for weakly coupled periodic systems (). There, the coding is easily seen to be invariant with respect to a uniform scaling of the firing frequencies (e.g. by changed driving input applied similarly to all involved neurons), and tongue size and stability is seen to scale with periodicity, which leads to a self-refining Huffman-like efficient code (). The particular arrangement of the shrimps in parameter space () might favor the biological implementation of such a coding scheme.) of Rulkov's neuron model (), three zoom levels (full white boxes). Black color indicates stable periodic systems, ocher unstable systems (generally chaotic). Shrimps-like domains (black) pertain on all levels, where crossing tails reflect non-ergodicity (hysteresis). Spike trains generated at the white dots (left to right corresponding to top to bottom) exhibit the generality of the modelTo relate these observations to bioinformatics, it is important to note that shrimps are of course not restricted to 2D parameter space, they also exist in higher dimensions (). Moreover, in many applications, objects may not be directly characterized by their fundamental parameters (these are often unknown) but by easily observable features. From parameter coordinates, we arrive at the feature space by means of a feature mapping, which most of the time is implicit. In a not too highdimensional feature space, feature maps of sufficient smoothness will closely reflect the situation that we have in parameter space [although a formalization of this expectation may require an advanced mathematical framework (. A pictorial example is provided by the transformation a; b ! a; Log1+jbj; ab from 2D into 3D space (). In what follows, we will exhibit how a severe clustering problem emerges from the shrimps-like parameter domain formed by systems displaying a regular response that most researchers will be unaware of if the data are not compromised by, e.g. wild projection methods.in () may represent such an experimentally observed case. Suppose that we now sample the parameter or feature space with the aim of identifying parameters that lead to a periodic system response. Whatever may be the sampling procedure and the test for periodicity, what will likely result is a situation like: candidate systems will be from primary shrimps or from lesser populated areas hosting smaller shrimps or systems for which the data appear periodic but are actually chaotic (unstable periodic orbits are generically embedded into chaos, and the systems' trajectories can follow such orbits for some time). Taking this situation as a toy example, we now proceed toward the clustering of the data into sets of similar behavior. To this end, we suppose that similar parameters generate more similar behaviors than dissimilar ones. The principle that clustering is thus based on is that the smaller the distance in space (parameter, feature), the more they are coupled and likely to be in the same cluster. The most commonly used clustering algorithms approach this problem based on this distance or similarity measure alone. As a consequence, they will end up with the 'noisy' data included into the clustering. Clearly, this should be avoided. Let us assume that by a magic 'noise-cleaning' algorithm, we got rid of the noisy part of the data. The interesting observation then is that even in this case, the most prominent clustering algorithms fail in the clustering of convexconcave-bounded sets such as our shrimplike domains, as they are implicitly based on a linear separability criterion. Although this is evident for the popular k-means algorithm, this also holds for hierarchical agglomerative Wards clusteringirrespective of what distance measure is used. That is, because non-local distances are introduced as soon as one deals with distances between a point and a set, or with distances between sets and sets. In view of the genericity of our situation, such a behavior is detrimental. The naive use of out-of-the-boxalgorithms leads to clustering failure in an important family of objects and obstructs the proper coding interpretation of parameter states. As we have pointed out above, this geometric situation largely persists in associated feature spaces. For any definition of the distance measure normally used, Wards clustering leads to a failure (see). Although Ward's clustering appears to be based on local distances, the method becomes intrinsically non-local as soon as the distance from a point to a set has to be evaluated. For an adequate clustering, a clustering algorithm must be used that is entirely based on local neighborhoods and avoids macroscopic notions such as the distance to a set. There is a solution to both of the problems (i.e. noise and convexconcave boundaries), using, e.g. the following neural networks-inspired algorithm () that is based on purely local notions of distance. The approach can be separated into four steps. In the first step, from a dataset S with N data items (as shown in), the pairwise similarities or distances d ij between items or pixels i and j are calculated, using an appropriate distance function d. In our toy case, we use the Euclidean distance, but could also embrace other qualities, for visual data clustering, e.g. pixel color or pixel size. For each item, we then determine for performance reasons the set of k nearest neighbors. By representing each item by a node and connecting each node with its k nearest neighbors, we obtain a basic graph. On this graph, each node's activity is represented as an integrate-and-fire (I&F) neuron, and each edge is a symmetric synaptic connection w ij of initial strength w ij =w ji =exp d ij =d 0  2 , where d 0 is a constant related to the average network activity. In the second step, I&F neuron site dynamics are implemented. The I&F neuron is modeled as a resistor-capacitor (RC) circuit that is driven by a current I=I ext +I inner. The external input I ext is assumed to be constant and equal for all neurons ('noisy driving'); input I inner describes the input relied over the ('stronger') connections that define the essential topology of the network [c.f. (. At each node, the obtained potential u(t) then follows thethe times of the firing events of the connected neurons. After the firing threshold has been reached, the state of the firing neuron is set to zero, and connected neurons are updated as ut 0 +=w j R. Until the next neuron of the population fires, neurons are updated as ut 0 =I ext R1  exp T k RC +utexp T k RC , where t 0 =t+T k with T k the time since the last spike. In a third step, a Hebbian-motivated dynamics of the topology of the network is implemented by doubling weights w ij connecting neurons that fire together in a sufficiently small time window (with a cutoff of the process at w = 1). This increase of weights is balanced by a weight decay , with ext as the firing period of the unconnected neurons. This simple rule finally gives rise to a self-organization and self-amplification mechanism acting on the network, where clusters emerge as sets of strongly connected and synchronous neurons (weights w ij = 1). Items that do not have any connections belong to no cluster and are discarded as noise. The method is autonomousno clustering level or number of clusters to be separated needs to be provided. For more details and for further illustrations, see (). The physics picture underlying this process was recently examined in (). For the result of suchIt is mostly in the realm of clustering where the shrimps property of non-linear systems is detrimental in the application of the most prominent and most widely used algorithms.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
F.Gomez et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Universal dynamical properties preclude standard clustering at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
a clustering process, see Figure 9c. In contrast to the application of the classical hierarchical Wards or the k-means clustering leading to result shown in Figure 9b, no noise cleaning preprocessing was necessitated. Spin-motivated clustering systems (e.g. Potts-spin clustering; Blatt et al., 1996; Murua et al., 2008; Ott et al., 2004) work similarly. They start with a ferromagnetic monobloc system that is then heated, upon which the original monobloc splits up into pieces that may then remain unaffected over a considerable temperature interval (and hence are identified as clusters). Upon further heating, they then split up into even smaller clusters and finally into singletons. It is easy to see that the process of heating requires extended computational effort, compared with the neuro-inspired approach. The question, to what extent the presence of these generic highly interwoven structures of dissimilar behaviors play a role in the parameter inference problem considered in systems biology and elsewhere, is an important and non-trivial one. In a Bayesian context, posterior distributions on parameter space are likely to differ vastly from normality. Therefore, standard inference methods such as the standard Metropolis algorithm could be expected to fail to converge within reasonable time, and that one might have to resort to more sophisticated methods such as genetic population algorithms. In particular, approximate Bayesian computation (ABC) methods (Toni and Stumpf, 2010) that are normally used for Bayesian parameter inference where the stochasticity of the model makes the calculation of the likelihood density prohibitively expensive, might be expected to fail, as the shrimp phenomena are caused by the non-linearities of the systems, and not by stochasticity. LotkaVolterra systems are often used to demonstrate the efficacy of ABC. These systems are, however, particular in the sense that they come equipped with a distribution of center solutions, a case that is more characteristic for linear than for non-linear systems, where both the parameter and the solution space are more complicated. A natural conclusion that one might draw is that the methods used for combinatorial problem optimization with many local minima (genetic algorithms, particle filters, Monte Carlo methods) have more potential than the ABC methods, and they will also be preferable to Kalman filters or to simple gradient descent estimators (Liu and Niranjan, 2012). To check these expectations, we performed a survey of applications of ABC methods on our parameter space, where (Toni et al., 2009; Toni and Stumpf, 2010) served as the references of models and methods. Our numerical experiments demonstrate that even in the context of the strongly fractionalized parameter spaces of non-linear systems, the ABC approaches perform well (see the for convenience displayed characteristic results in our Supplemental Material section). This is mainly due to the fact that they are ensemble based. Linear approximation schemes [e.g. singular values decomposition or the independent component analysis (ICA) methods used in source separation of sounds (Kern and Stoop, 2011)] usually performed for dimensional reduction or directly for a gradient descent step, tend to ignore or smear the local structures and are therefore far less suited. Seen in this light, generic data that we presented provide a justification for the superiority of ensemble-based parameter inference methods.
