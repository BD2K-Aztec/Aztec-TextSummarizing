Motivation: Several efficient gene–gene interaction tests have been developed for unrelated case– control samples in genome-wide association studies (GWAS), making it possible to test tens of billions of interaction pairs of single-nucleotide polymorphisms (SNPs) in a reasonable timeframe. However, current family-based gene–gene interaction tests are computationally expensive and are not applicable to genome-wide interaction analysis. Results: We developed an efficient family-based gene–gene interaction test, GCORE, for trios (i.e. two parents and one affected sib). The GCORE compares interlocus correlations at two SNPs between the transmitted and non-transmitted alleles. We used simulation studies to compare the statistical properties such as type I error rates and power for the GCORE with several other family-based interaction tests under various scenarios. We applied the GCORE to a family-based GWAS for autism consisting of approximately 2000 trios. Testing a total of 22 471 383 013 interaction pairs in the GWAS can be finished in 36 h by the GCORE without large-scale computing resources, demonstrating that the test is practical for genome-wide gene–gene interaction analysis in trios. Availability and implementation: GCORE is implemented with C þþ and is available at http://
IntroductionGenome-wide association studies (GWAS) have been widely used in complex disease studies to identify the association of single-nucleotide polymorphisms (SNPs) with the disease. Although GWAS have successfully identified many significant SNPs, most SNPs exhibit modest effects on the disease and can only explain a small proportion of the heritability of the disease (). As complex diseases are caused by the joint effects of multiple genes, genegene interactions may also play an important role in disease etiology. Significant genegene interactions have been identified for several diseases, such as Alzheimer's disease, autism and schizophrenia (). Therefore, it is important to develop powerful and efficient genegene interaction methods for GWAS. Two major challenges are faced when performing interaction analysis in GWAS. The first is the computational burden resulting from tens of billions of tests when considering all possible pairwise interactions between SNPs. Several computationally efficient algorithms have been developed for pairwise interaction analysis for casecontrol GWAS, such as the fast epistasis test implemented in PLINK (), SNPHarvester (), SNPRuler (), BOOST () and TEAM (). The second challenge is the multipletesting correction burden resulting from the extremely large number of tests. To achieve genome-wide significance for these interaction tests, a large sample size or strong interaction effects between SNPs are required. Several genegene interaction methods have also been developed for family-based association studies. For families with at least one V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com affected and unaffected child, conditional logistic regression (CLR) and logistic regression based on generalized estimating equations (GEE) () can be used for testing interactions (). CLR has further been extended to accommodate families with one affected child and two parents (i.e. trios), using the affected offspring as a case and 'pseudocontrols' created based on the parental genotypes (). UNPHASED is a likelihood ratio test that can be used for testing interactions by comparing the likelihoods of genotypes given the disease status with and without modeling the interaction (). Multifactor Dimensionality Reduction (MDR) (), a machine-learning method developed for casecontrol studies, has been extended to several family-based interaction tests, such as MDR-PDT (), PGMDR () and FAM-MDR (). A summary of tools available for genegene interaction analysis is shown inand a more detailed overview of these tools can be found in the Supplementary Materials. Also more comprehensive reviews of genegene interaction methods can be found in some review papers (). As shown in, current family-based interaction methods are applicable to only candidate gene regions. Iterative algorithms such as the NewtonRaphson method are used in parameter estimations in CLR or GEE, as well as in the likelihood ratio tests. MDR-based approaches use cross-validation for model evaluation and permutations to approximate the distributions of the test statistics. These algorithms require intensive calculations. Hence, these tests would not be applicable for analyzing genomewide interactions with tens of billions of tests. We developed an efficient genegene interaction test which considers correlations in trios (GCORE). The GCORE is extended from the fast epistasis test in PLINK. The GCORE statistic compares interlocus correlations at two SNPs between the transmitted and nontransmitted alleles. We used theoretical distributions to model the statistic and calculate the variance and covariance. Thus, the test does not use any iterative algorithms, ensuring that the test is fast and applicable to genome-wide interaction studies. We performed a comprehensive simulation study to evaluate the type I error rates for the GCORE and other genegene interaction tests capable of analyzing family data with available software, including GEE, UNPHASED and MDR-PDT. Simulations were also used to compare the power of the GCORE with the three tests under various scenarios. Our simulation results suggest that the GCORE can be used as a screening tool to efficiently identify the potential pairs of SNPs with interaction effects, and other tests with higher power such as the likelihood ratio test implemented in UNPHASED can be further used to evaluate the significance of the SNP pairs. Finally, we applied the GCORE to a familybased GWAS for autism to screen all possible pairs of SNPs within genes, and UNPHASED was used to further test the pairs of SNPs identified by the GCORE.
MethodsWe first reviewed the PLINK () interaction statistic in the Supplementary Materials and then introduced the GCORE test statistic.
The GCORE statisticAssume we have n trios, and we are testing the interaction for two SNPs M 1 , with alleles A and a, and M 2 , with alleles B and b. Here we loosely define a haplotype as a set of alleles at the two SNPs (e.g. AB, Ab, aB or ab), where the two SNPs can be on different chromosomes. Similar to the Transmission Disequilibrium Test (TDT) (), we calculate the transmitted (T) and nontransmitted (NT) haplotype statistics, as shown in. Each parent has two haplotypes, one that is transmitted and one that isn't. In, let each cell count be the number of parents who transmitted a haplotype and did not transmit another haplotype to the affected child. For example, n 11 is the number of parents with the transmitted haplotype AB and the non-transmitted haplotype AB. Since the sum of all cell counts is 2n andincludes all possible outcomes of the parental haplotypes, the cell counts infollow a multinomial distribution. In order to calculate the odds ratios for the T and NT statistics,is reorganized into 2  2 tables, shown in Tables 3 and 4, by taking the marginal count of the T or NT statistics for each haplotype. The T and NT statistics are used as cases and controls, respectively, in families. Based on Tables 3 and 4, the odds ratios between the two SNPs, M 1 and M 2 , for cases (i.e. T) and controls (i.e. NT) can be calculated as follows:B T : n 11  n 21  n 31  n 41 T: n 13  n 23  n 33  n 43 b T : n 12  n 22  n 32  n 42 T: n 14  n 24  n 34  n 44 OR case  n 11  n 21  n 31  n 41   n 14  n 24  n 34  n 44   n 13  n 23  n 33  n 43   n 12  n 22  n 32  n 42   ;OR control  n 11  n 12  n 13  n 14   n 41  n 42  n 43  n 44   n 31  n 32  n 33  n 34   n 21  n 22  n 23  n 24   :Similar to the PLINK approach, the GCORE statistic for the genegene interaction test compares the difference in the log odds ratios between cases and controls. Assume that ^ b 1 and ^ b 2 are the sample estimators for the odds ratios OR case and OR control , respectively. The GCORE statistic G is calculated as follows:As the GCORE requires phased data, Merlin was used to resolve haplotype phases in the trios for all the simulation scenarios. The haplotypes corresponding to the most likely gene flow pattern were used (with thebest option in Merlin). The type I error rates were first evaluated by selecting two unlinked loci on the two chromosomes with no interaction effects on the disease. We considered six different sets of minor allele frequencies (MAFs) for the two selected SNPs (i.e. 0.05, 0.05; 0.05, 0.2; 0.1, 0.1; 0.2, 0.2; 0.2, 0.4; and 0.4, 0.4) and three different numbers of trios (i.e. 500, 1000 and 2000). When interactions for two SNPs on the same chromosome are tested, there may be LD between the two SNPs. Thus, we also tested two SNPs in different degrees of LD (LD measures r 2  0.1, 0.3, 0.5 and 0.7) to evaluate the type I error rates. The presence of main effects but no interaction effects may inflate the type I error rates for interaction tests (). Therefore, we also evaluated the type I error rates in the presence of only main effects under different disease prevalences (0.01, 0.05 and 0.1) and disease models (recessive, additive and dominant models). We simulated a scenario where only one main effect (k 1  ln 2; k 2  0) was present, and a scenario where two main effects were present for two different effect sizes (k 1  ln 1:5; k 2  ln 1:5; k 1  ln 2; k 2  ln 2). Finally, we evaluated the type I error rates for the GCORE in the presence of population stratification. The details of the simulations can be found in the Supplementary Materials. Each type I error rate was calculated over 5000 replicates of simulated samples. For the power comparisons, we simulated two unlinked loci on the two chromosomes that have interaction effects on the disease. The power was calculated with significance levels of 0.). The default settings in our power simulations were 1000 trios, MAFs of 0.2 and 0.2 for the two disease loci, and
ImplementationAlthough the calculation of the GCORE test statistic is fast, using the GCORE to test tens of billions of SNP pairs for a GWAS dataset remains very time consuming. Two strategies were used to improve the analysis efficiency in the GCORE program. POSIX Threads (Pthreads) in UNIX are used to parallelize the tests running on a machine with multiple cores. Moreover, the user can specify the chromosome pair so that the GCORE will test SNP pairs only between the specified chromosomes. Therefore, tests for different chromosome pairs can be performed on different computers, such as in a cluster environment. At present, GEE is mostly implemented in R, which is not comparable for performance with the GCORE. Instead, we used the epistasis test in PLINK, which is also implemented in C  and is based on logistic regression, assuming that all samples were independent. The GEE procedure typically runs a regular logistic regression, assuming that all observations are independent, to obtain initial estimates of the parameters. Therefore, we expected that the run time for GEE implemented in C  would be longer than the PLINK epistasis test based on logistic regression. We estimated the run time for testing 4 500 000, 22 500 000 and 45 000 000 SNP pairs in 1000 trios on a LINUX server with Xeon 2.0 GHz CPU and 24 GB RAM. The run time for the GCORE included the time it took to run Merlin for resolving the haplotype phases, a Perl script to transform the Merlin output file to the GCORE input file, and the GCORE tests.
Results
Type I error ratesThe type I error rates under different simulation scenarios are shown in Tables 57 and their 95% confidence intervals are shown in Tables S4, S6 and S7 in the Supplementary Materials.shows the type I error estimates for different sets of MAFs at the two SNPs in 1000 trios at two significance levels (a  0.05 and 0.01), while the type I error rates for different sets of MAFs in 500 and 2000 trios are shown inin the Supplementary Materials. All of the tests had appropriate type I error rates that were close to the nominal levels when both SNPs had an MAF! 0.2. However, the type I error rates for GEE and UNPHASED were inflated for SNP pairs with MAFs < 0.2, while the GCORE was conservative in these scenarios. This is not surprising as GEE, UNPHASED and the GCORE all rely on the asymptotic assumption of a normal or chi-square distribution for hypothesis testing, and the assumption can be violated for small samples. In contrast, MDR-PDT maintained appropriate type I error rates across the whole spectrum of MAFs in our simulations, as the permutation test is valid for small samples.shows the type I error rates at different levels of LD between a pair of tested SNPs. GEE and MDR-PDT maintained appropriate type I error rates with different levels of LD. The GCORE maintained proper type I error rates when the LD was not strong (i.e. r 2  0.3 and 0.1); however, the type I error rates for the GCORE can be inflated if the LD r 2 between the two SNPs is !0.5. On the other hand, UNPHASED is liberal for all levels of LD. Therefore, the GCORE and UNPHASED are suitable for testing SNP pairs that are not in LD.shows the type I error rates for the GCORE, GEE and UNPHASED when the SNPs have main effects but no interaction effects under an additive model. The results for the dominant and recessive models are shown inin the Supplementary Materials. The type I error rate for MDR-PDT was not evaluated in this scenario as the null hypothesis for MDR-PDT includes the assumption that the two SNPs have no main effects (). If only one SNP had a strong main effect (k 1  ln(2), k 2  0), the type I error rates for the GCORE and GEE were generally close to the 0.05 nominal level across different disease prevalences and disease models, while the type I error rates for UNPHASED were somewhat inflated. Moreover, the type I error rates for the three tests can be inflated when both SNPs have strong main effects (k 1  ln(2), k 2  ln(2)), particularly under the dominant model, and. Type I error rates and their 95% confidence intervals for testing two SNPs with different degrees of LD in 1000 trios at the significant levels a  0:05 and a  0:01.An efficient genegene interaction testthe degree of inflation increased with higher prevalence. The results were consistent with previous findings for unrelated cases and controls that strong main effects of the SNPs being tested can inflate the type I error rates for interaction tests based on logistic regression or comparing odds ratios (). In the presence of population stratification, the GCORE maintained proper type I error rates, as shown inin the Supplementary Materials.shows the power comparison under different interaction effect sizes, numbers of trios and MAFs. Similar power patterns were observed in these scenarios. That is, MDR-PDT had the highest power, followed closely by UNPHASED. The power for the GCORE was lower than the power for MDR-PDT and UNPHASED, but higher than GEE. As expected, the power for all methods increased with larger effect size, larger number of trios and higher MAFs.shows the run time plot for the GCORE and PLINK. A clear advantage of the GCORE in terms of run time over PLINK can be observed in the plot. For example, the total run time of the GCORE for testing 4 500 000 pairs of SNPs was about 11 min, while the run time for PLINK was about 4 h 12 min. Therefore, the GCORE ran 20 times more efficient than a logistic regression based test for interaction. As GEE requires more time than the logistic regression test, the GCORE is expected to run more than 20 times faster than GEE. Moreover, when the GCORE tests were performed in parallel using 10 cores, the run time was 2 min and 22 s for testing the same number of SNP pairs as before. We did not compare the run time of the GCORE with UNPHASED, which is also implemented in C , because of its computational complexity. For example, UNPHASED required an hour and 10 min for testing only 1000 pairs of SNPs in 1000 trios.
Power
Performance comparison
A two-stage genome-wide pairwise interaction strategyA two-stage approach has been described in the PLINK user manual for a genome-wide genegene interaction study for casecontrol GWAS. That is, the PLINK fast epistasis test can be used as a screening tool for identifying a potential subset of interaction pairs of SNPs using a less stringent p-value threshold. Then a standard test such as the test based on logistic regression can be used to test the subset of SNPs, and the significance of the tests is determined based on the genome-wide significance threshold. Similarly, the GCORE can be used as a screening tool for a family-based genome-wide interaction study. The results from our power studies suggest that MDR-PDT is the most powerful test across different scenarios. However, a large number of permutations is required in MDR-PDT to obtain a small p-value (e.g. 10 10 ). In contrast, the p-value in UNPHASED is rapidly calculated from a chi-square distribution. Because UNPHASED shows comparable power to MDR-PDT in several scenarios, UNPHASED is suitable to be used in the second stage to evaluate the significant pairs identified by the GCORE.shows the power comparisons between the two-stage strategy using different P-value thresholds and UNPHASED. More details about the simulations can be found in the Supplementary Materials. As seen in the Figure, the power for the two-stage strategy based on the GCORE P-value threshold of 10 3 is close to the power for UNPHASED. However, the power for the two-stage strategy using the GCORE P-value threshold of 10 5 can be significantly lower than the power for UNPHASED.
Real data analysisWe applied the two-stage genome-wide interaction analysis strategy to a family-based GWAS for autism from the Autism Genome Project (AGP) (). The dataset contained nuclear families with autism spectrum disorder (ASD) sampled in two stages from Europe and North America. The stage 1 dataset consisted of approximately 1400 ASD families genotyped on the Illumina Infinium 1 M-single SNP array, and the stage 2 dataset consisted of 1301 ASD families genotyped on either the Illumina Infinium 1 M-single or the 1 M-duo array. The data from both stages were combined in our analysis. The same quality control (QC) procedures as described in) were applied to the data. Because UNPHASED can be a liberal test for testing SNP pairs with MAFs < 0.2, we removed the SNPs with MAFs < 0.2. After the QC, there were 1979 trios and 447 187 SNPs. We restricted our analysis to SNPs within genes. The hg18 gene annotations were downloaded from the UCSC genome browser website. Interaction tests for all possible pairs of SNPs that were not in LD between any two genes were performed using the GCORE, which resulted in 22 471 383 013 tests, and the number of independent tests was estimated as 738 771 507 using the method described in). As the simulation results suggest that the power for the twostage strategy using the GCORE P-value threshold of 10 3 was close to the power for UNPHASED, the threshold was applied to the analysis. A total of 21 899 953 pairs with the GCORE P-values < 10 3 were tested by UNPHASED in the second stage. The GCORE was performed in parallel on 10 nodes equipped with AMD Opteron 2.2 GHz CPU and 48 GB of memory, where each node ran 20 threads, for testing the 22 471 383 013 SNP pairs in a cluster environment. The analysis was finished in 36 h. The same resources were used for UNPHASED for testing the 21 899 953 SNP pairs in the second stage, and the analysis was finished in 7 days. However, if the same resources were used for UNPHASED for testing the 22 471 383 013 pairs of SNPs, more than 7000 days would be required. This again demonstrates the efficiency of the GCORE test.shows the five most significant pairs identified by the two stage approach. The marginal test P-values from the TDT are also shown in. The most significant interaction was between the SNPs in the neuron-derivedGWAS. The algorithms developed for rare variants, such as the burden test () or the sequence kernel association test (), may be extended for interaction tests that accommodate SNPs with low MAFs. To demonstrate that the two-stage strategy is computationally feasible in practice, we applied the strategy to the AGP GWAS dataset. The total run time suggest that this strategy is applicable to genome-wide interaction analysis in GWAS. Although the interaction pairs identified by the two-stage strategy were not significant when using the stringent genome-wide significance threshold, interestingly, the functions of some genes such as NDNF and neuroligin 1 (NLGN1) in the 5 most significant pairs are related to functions of neurons. NDNF is a neurotrophic factor derived from neurons. NDNF was exclusively expressed in neurons in a mouse model (). In addition, NLGN1 encodes a protein belonging to a family of neuronal cell surface proteins, which may play a role in the formation and remodeling of central nervous system synapses. More interestingly, copy number variations in NLGN1 have been founded to be associated with autism (). However, the interactions between the genes have not been reported in the literatures. Further studies are warranted to evaluate the roles of the interactions of these genes in ASD. In conclusion, the GCORE test has three promising properties: it properly considers correlations in families, shows comparable power with GEE, and is highly efficient. Therefore, the GCORE will be very useful for testing a very large number of pairs of SNPs in family-based genome-wide interaction studies.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
(3) Under the null hypothesis that there is no interaction between the two SNPs, log OR case   log OR control   0 when the two SNPs are in LE. When there is a correlation between alleles at the two SNPs, which can be caused by linkage disequilibrium (LD) or population stratification, log OR case   log OR control  6  0 under the null. Therefore, under the null, the GCORE statistic G follows a normal distribution with a mean of 0 and a standard deviation of 1. The PLINK statistic Z PLINK was designed for unrelated casecontrol data. Thus, the variance of the difference in the two log odds ratios is the sum of the variance for the individual log odds ratios. However, the odds ratios in the GCORE statistic are statistically correlated due to the correlation in families. Thus, the covariance between the two log odds ratios is considered in calculating the variance for the difference in the two log odds ratios. A similar approach to calculating the covariance of two correlated odds ratios as proposed in Bagos (2012) was used. The detailed derivation for the variance is given in the Supplementary Materials. Constructing Table 2 requires knowledge of the haplotype phases in the trios. There are several sophisticated and efficient haplotype phasing programs for trios, such as Merlin (Abecasis et al., 2002), BEAGLE (Browning and Browning, 2009) and SHAPEIT (Delaneau et al., 2012). One of these programs can be used to resolve the haplotype phases in the sample before running the GCORE. Moreover, the GCORE does not assume LE between SNPs, given that the haplotype phases are known, but assumes that the haplotype frequencies for haplotypes at the two SNPs are in HWE. Ueki and Cordell (2012) showed that inferring haplotype phases can introduce extra variance in the interaction statistic and ignoring the variance may cause the inflation of type I error rates for the interaction tests in unrelated case control data. Because the variance of inferring haplotype phases is not considered in the GCORE statistic, we used simulations to evaluate the type I error rates for the GCORE test when the haplotype phases were inferred based on the tested family data. 2.2 Simulations We conducted a comprehensive simulation study to evaluate the type I error rates and power for the GCORE and other interaction tests with available software, including the interaction test based on logistic regression with GEE, UNPHASED and MDR-PDT, under different scenarios. We used the simulation tool, SeqSIMLA2 (Chung et al., 2015), to generate trios. Note that there are other simulation tools such as genomeSIMLA (Edwards et al., 2008) and simuPOP (Peng and Amos, 2008) that can simulate genegene interaction effects of SNPs on disease in families. However, SeqSIMLA2 is flexible of adopting external reference haplotypes simulated under realistic human genetic structures. To produce the reference haplotypes, we used HAPGEN2 (Su et al., 2011) to simulate 10 000 haplotypes in two randomly selected 5 MB regions on chromosomes 1 and 2 similar to the allele frequencies and LD structures in the Utah Residents (CEPH) with Northern and Western European Ancestry (CEU) samples from the 1000 Genomes Project (Consortium, 2010) data. Using the 10 000 haplotypes, SeqSIMLA2 performed gene dropping to generate trios, while trios with affected children were ascertained. We selected the following logistic function as the penetrance function in SeqSIMLA2: PAffectedjX 1 ; X 2   exp q  k 1 X 1  k 2 X 2  k 3 X 1 X 2  1  exp q  k 1 X 1  k 2 X 2  k 3 X 1 X 2  (4) where X 1 and X 2 are coding of genotypes based on an additive, dominant or recessive model for the two disease SNPs, q determines the disease prevalence, k 1 and k 2 represent the effect sizes of the main effects for the disease SNPs, and k 3 determines the interaction effect for the two disease SNPs.
P.-Y.Sung et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
(BCO1) gene, with a P-value of 4:61  10 10 from UNPHASED. However, the test would not be significant after correcting for multiple testing of 738 771 507 tests using the Bonferroni threshold of 6:76  10 11. 5 Discussion We proposed an efficient genegene interaction test, GCORE, which considers correlations in trios. A comprehensive simulation study was conducted to evaluate the properties of the GCORE and other family-based interaction tests with software available. The comparisons of properties between these tests are summarized in Table S10 in the Supplementary Materials. Each test has its advantages and disadvantages. The main advantage of the GCORE over other tests is that it can be used to perform a genome-wide interaction study without large-scale computing resources. In contrast, based on our real data analysis for the AGP GWAS, thousands of computing nodes will be required for UNPHASED to finish the genome-wide interaction analysis within a month. The major disadvantage of the GCORE is that its power can be significantly lower than MDR-PDT and UNPHASED in some situations. However, since the significance threshold is less stringent for the GCORE used as a screening tool, the type II errors of failing to detect the true interactions can be reduced for the GCORE. Although LE for the two tested SNPs is not assumed in the GCORE, our simulation results showed that the type I error rates for the GCORE were inflated when the LD r 2 between the two SNPs was >0.3. Ueki and Cordell (2012) demonstrated that the variance for the interaction test statistic for casecontrol samples based on haplotype frequencies became larger with higher LD levels between the two SNPs. As haplotype phase inference is not considered in the variance estimator for the GCORE, this might explain why the type I error rates for the GCORE were more seriously inflated with the increase of LD levels between the two SNPs. Our simulation results suggest that the GCORE is robust to population stratification, which can cause LD between the tested SNPs. However, if ^ b 2 was not included in the GCORE statistic, which reduced the test to a case-only test, the type I error rates can be seriously inflated in this scenario (e.g. type I error rate was 0.72 at the 0.05 level for Scenario 1 in Supplementary Table S9 for SNPs with MAFs of 0.2). Therefore, ^ b 2 should be included in the GCORE statistic even for unlinked SNPs so that the type I error rates can be maintained in the presence of population stratification. The GCORE was shown to be conservative for testing SNP pairs with MAFs < 0.2 in samples of 500 and 1000 trios. However, the GCORE maintained proper type I error rates across different MAFs in 2000 trios, except that in a SNP pair with MAFs of (0.05, 0.05), the test was also conservative at the 0.01 significance level. Therefore, increasing the sample size will allow the GCORE to properly test SNP pairs with low MAFs. In contrast, UNPHASED and GEE were more liberal with larger sample size. Hence, the two tests are suitable for testing SNPs with MAFs ! 0.2. However, SNPs with MAFs lower than 0.2 may also have interaction effects on complex diseases. MDR-PDT, which maintained correct type I error rates across different MAFs, can be used for testing SNPs with MAFs < 0.2. As MDRPDT is computationally intensive, efficient interaction methods that consider SNPs with low MAFs with high power are desirable for
