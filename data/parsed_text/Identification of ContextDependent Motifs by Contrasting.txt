Motivation: DNA binding proteins play crucial roles in the regulation of gene expression. Transcription factors (TFs) activate or repress genes directly while other proteins influence chromatin structure for transcription. Binding sites of a TF exhibit a similar sequence pattern called a motif. However, a one-to-one map does not exist between each TF and motif. Many TFs in a protein family may recognize the same motif with subtle nucleotide differences leading to different binding affinities. Additionally, a particular TF may bind different motifs under certain conditions, for example in the presence of different co-regulators. The availability of genome-wide binding data of multiple collaborative TFs makes it possible to detect such context-dependent motifs. Results: We developed a contrast motif finder (CMF) for the de novo identification of motifs that are differentially enriched in two sets of sequences. Applying this method to a number of TF binding datasets from mouse embryonic stem cells, we demonstrate that CMF achieves substantially higher accuracy than several well-known motif finding methods. By contrasting sequences bound by distinct sets of TFs, CMF identified two different motifs that may be recognized by Oct4 dependent on the presence of another co-regulator and detected subtle motif signals that may be associated with potential competitive binding between Sox2 and Tcf3.
INTRODUCTIONA TF binds the promoter or enhancer region of a gene, and in turn regulates the expression of the gene. TF binding sites (TFBSs) have a similar pattern or a motif usually described by a positionspecific weight matrix (PWM) (). A PWM is a w4 matrix, = ( ij ) w4 , where each element  ij represents the probability of nucleotide j {A,C,G,T } being at position i {1,...,w} and w is the length of the motif. Each position is modeled independently and each row of a PWM sums to 1. Motif discovery can be regarded as a missing data problem in the sense * To whom correspondence should be addressed. that neither the locations of TFBSs nor the motif parameters (PWM) are known. Many computational methods have been developed for motif discovery (), with most fitting into two broad categories, those based on mixture models () and those based on discrimination (). Mixture models assume that a set of sequences consists of a mix of TFBSs and background nucleotides. While there are multiple approaches, most methods employ the EM algorithm or Gibbs sampling to identify TFBSs and estimate PWMs via iterative updating schemes. These iterative approaches tend to rely on two steps: first, sequences are scanned given an estimated PWM and background model to produce a set of predicted sites; secondly, the PWM is updated using the predicted sites. Under the mixture model, the counts of nucleotides from predicted sites can be used to estimate the PWM in a closed form. Discriminative motif finders (discriminators for short), on the other hand, use two sets of sequences, usually a bound set and an unbound control set, and attempt to find motifs that best distinguish between the two groups (). Most discriminators aim to maximize a measure of separation between the two sequence sets. For example, discriminating matrix enumerator (DME) () uses a measure based on likelihood ratio (LR) and FIRE () uses mutual information. Again, these methods utilize iterative approaches to update a PWM such that their measure of separation improves. However, even with TFBSs predicted there is generally no closed-form estimation of the PWM under a discriminative model. As such discriminators often discretize the parameter space of the PWM to render discovery computationally feasible and thus sacrifice accuracy in estimation. Recent improvements in genomic coverage by chromatin immunoprecipitation microarrays (ChIP-chip) and the coupling of ChIP with high-throughput sequencing technologies (ChIP-seq) have increased the number of bound regions identified while decreasing the width of such regions. This increase in accuracy and data size now enables many motif finders to easily identify the consensus motif of a TF. We hypothesize, however, that a TF may have context-dependent binding patterns and believe that the accuracy of newer ChIP datasets, along with the greater availability of such datasets, can be leveraged to discover these patterns. We are motivated by two possible context-dependent TF binding scenarios. The first is a co-regulation scenario where a TF binds DNA with a cofactor in some sequences and binds alone or with a different cofactor in other sequences. While the cofactor may haveits own motif, the motif recognized by the original TF might be different when binding occurs with and without its cofactor. The second is a competition scenario where two TFs share similar DNA binding domains that may compete for the same binding sites. Here, sequences can be split into two groups based on context (i.e. the two TFs compete for the sequence versus only one TF binding the sequence). Differences in the motifs between the two groups might provide insight into how each TF is targeted to its binding sites. Here, we propose a contrast motif finder (CMF) that aims to take advantage of multiple high-quality binding datasets to identify subtle regulatory signals, such as context-dependent motifs, within bound sequences. CMF is specifically designed to discriminate between two sets of bound sequences and provide a non-discretized estimation of PWMs. This method takes into account false positive sites when updating PWMs and other model parameters. In this article, we apply CMF to three recently published genome-wide binding studies of TFs in mouse embryonic stem cells (ESCs) (). Each study used ChIP-chip or ChIP-seq to investigate TFs thought to play a role in ESC pluripotency and self-renewal (, for details see Supplementary Materials).
Identification of Context-Dependent Motifs
METHODSWhile CMF is designed to contrast two binding datasets, S 1 and S 2 , it is useful to motivate our method with a more traditional scenario where S 1 is a ChIP dataset (bound sequences) and S 2 is a set of control sequences. Suppose we are predicting binding sites with a given PWM. For every segment s = (s 1 ,...,s w ), s i {A,C,G,T }, of length w in a given sequence we compute the LR:where the background model,  0 , is assumed to be a first-order Markov chain, i.e.  0 (s i1 ,s i ) is the transition probability from s i1 to s i. We then predict binding sites by finding those segments with LR(s) greater than some threshold, . In this application, predicted sites in S 1 are a mix of true sites and false positives, while all those found in S 2 are false positives. As such, we can use the false positives found in S 2 to both identify a proper threshold in predicting binding sites and to correct the contribution from false positives when estimating the PWM in S 1. As a concrete example,shows the distributions of normalized log-likelihood ratios, logLR(s), for all segments of length w in Oct4 bound sequences in the Chen study and in a set of control sequences, both scanned by the Oct4 PWM.shows the right tails of the two distributions with LR > = 100. Here, the two distributions diverge with the Oct4 bound sequences containing a higher density of sites with LR(s) > 100. One sees that predicted sites in the Oct4 bound sequences, S 1 , are made of a mix of true sites and false positives (shaded area in)
Seed creationMany motif finding methods use word enumeration to identify promising seeds (). Here, we develop a seeding scheme that finds words enriched in one set of sequences as compared with another set. Given two sets of sequences, S 1 and S 2 , we denote by L 1 and L 2 the total numbers of length-w segments in S 1 and S 2 , respectively. For every w-mer x = (x 1 ,...,x w ) in the two sets of sequences, we compute its z-score,wherewith C 1 and C 2 the numbers of occurrences of the w-mer x in S 1 and S 2 , respectively. We define a seed centered at a w-mer x by incorporating neighboring w-mers, where a w-mer y is considered a neighbor of x if it matches x with at most m mismatches (, All). For all results in the article, we use w = 7 and m = 2, unless noted otherwise. We further filter these neighbors by two biologically motivated constraints. First, we reason that only those neighbors y that are overrepresented in the same set of sequences as the center w-mer, x, should be included in the seed, i.e. {y : z(y)z(x) > 0} (, Dir). After this step, we further filter by considering subsets of y called sub-neighborhoods. We define a sub-neighborhood y J of the central w-mer x as those neighbors with the same mismatch position(s) J, where J is a size-m subset of {1,...,w}. For example, inif J ={2} then y {2} = {ATGCAAA,AcGCAAA, AgGCAAA} is the sub-neighborhood for mismatch position 2, where AaGCAAA is omitted since its enrichment direction differs from that of the center ATGCAAA. Considering sub-neighborhoods is useful since motifs do not exhibit great flexibility in each of their w positions; instead most motif positions are rather rigid (high information content) with a few positions being flexible. However, even when an initial seed is more rigid than it should be, the iterative updating step, to be introduced next, can modify the initial seed into a more degenerate PWM. For each subneighborhood y J we compute the z-score (2) with the counts C 1 and C 2 being the total numbers of occurrences of w-mers in y J. We use the best subneighborhood (, Best), i.e. the y J with the greatest z-score, to construct the seed. Each seed is summarized by two w4 count matrices, N2 , where N2 can be regarded as the expected count matrix constructed from false positive sites in S 1 .
Iterative updatingOnce the best sub-neighborhood of each seed is determined, we take an iterative approach to update the PWM for each seed whose sub-neighborhood z-score or exact z-score (i.e. the z-score of the center) ranks within the top M. The parameter M gives an upper bound for the number of motifs to be found. In general, we recommend a choice of M = 20; if the output motifs are highly similar we recommend increasing M in order to find any secondary motifs. Note that some seeds may share the same sub-neighborhood and thus their respective count matrices, N2 , will be identical. In this case we only use the seed with the most significant exact z-score. Recall that a seed is summarized by two count matrices N2. At iteration t (t = 1,2,...), denote the two count matrices constructed by predicted sites in2 contains length-adjusted counts and represents the expected count matrix of false positives inij ) w4 be the count matrix constructed by false positive sites predicted in S 1. If F t is given, the log-likelihood of isHowever, F t is unknown and thus we estimate by maximizing the expectation of l(ij replaced by its expectation N2,ij , subject to the constraints that  ij  0 and j  ij = 1. This leads to the use of a differential matrix2 ,0)in the estimation of , where N2,ij ,0) for all i and j. To prevent CMF from being trapped in a local mode, we then add 5% pseudocounts to each position in N (t) and normalize each row into probabilities to obtain the updated PWM, (t). Intuitively, subtracting off N (t) 2 mitigates the contribution that false positives would otherwise make to the PWM as motivated in. Given (t) and a threshold , we use the LR (1) to scan S 1 and S 2 to predict TFBSs. The false discovery rate (FDR) of the sites predicted in S 1 can be estimated by FDR(is the number of sites in S 2 and L 1 and L 2 are defined as before. We find the lowest  such that FDR() <, where  is an upper bound chosen by the user and  is discretized to  {100,200,...,2000} for computational efficiency. In practice, we employ  = 2/3. Once  is determined, denoted by  (t) , sites in S 1 and S 2 with LR(s) > (t) are used to create count matrix N, respectively. Note that by correcting for the influence of false positives in Equation (4) the algorithm becomes robust to the discretization of  and the choice of . At each iteration we also determine whether the motif should grow or shrink by 1 bp on either side based on the Bayes factors at the flanking positions (see Supplementary Materials for details). Lastly, we check whether the algorithm has converged by measuring the.01), we stop iterating. We summarize this iterative algorithm of CMF as follows.2 by seed creation. For t = 1,2,... and d (t) <<:2 by Equation(4);(3) Use sites with LR(s) > (t) to create N (t+1) 1 and N (t+1) 2 .
Contrasting two bound datasetsCMF provides an option to indicate whether the second set of sequences is a control set or a set of bound sequences, i.e. whether S 2 may contain enriched motifs. When two bound datasets are contrasted, seed creation is identical to the case when a ChIP dataset is contrasted to a control dataset, except that seeds with the most negative z-scores (the bottom M) are also updated into PWMs. For these seeds, PWMs are updated with the iterative algorithm described above but with S 1 and S 2 switched. In this case, CMF outputs two groups of motifs, one enriched in S 1 and the other enriched in S 2. When discriminating between two bound datasets, CMF not only corrects for false positives but also masks out dominant motif signals present in both datasets allowing weaker signals to be detected. For example, a consensus motif present in both datasets will not lead to an enriched seed and will lack stable differential counts when updating PWMs by Equation (4). Similarly, GC-rich motifs will not be produced when two bound sequence sets, both of high GC content, are contrasted.
RESULTS
A comparison of seeding methodsTo assess the validity of our seeding method, we compared our use of the best sub-neighborhood in seed construction to using all neighbors or using those neighbors that match the enrichment direction of the central w-mer. CMF was applied to a subset of 500 randomly sampled sequences of each Sridharan dataset () along with a set of control sequences created to match the binding data distributions of width and distance to nearest gene. Note that all subsequent sets of control sequences are created in a similar manner for each TF dataset.shows the consensus wmers of Oct4, Sox2, cMyc and Klf4 ranked according to z-scores computed from all neighbors (All Nhoods), from neighbors with the same enrichment direction (Dir Nhoods) and from the best subneighborhood (Best Nhoods). Here, one sees that using the best subneighborhood outperforms the other neighborhood constructions and often provides a higher ranking than using the exact match. For example, the ranking of the Oct4 consensus w-mer improves drastically with the best sub-neighborhood. It is ranked 4747th and 324th when using all neighbors and those neighbors with the same Page: 2829 28262832enrichment direction, respectively. Using the best sub-neighborhood it is ranked second, which is higher than the ranking of the exact match. Similar results were seen in the Chen and Marson datasets. Sox2 is the only TF for which the exact match outperforms the best sub-neighborhood, which can occur if the true motif has few low-information positions.
Identification of Context-Dependent Motifs
A comparison against popular motif findersWe compared CMF against three other motif finders: two discriminators, DME (version 2) () and FIRE () and a Gibbs motif sampler, BioProspector (), based on mixture modeling. Although there are many variants of Gibbs motif samplers, we chose BioProspector since its run time is similar to that of CMF. We ran DME using 50 seeds and w = 10. We ran FIRE using its default parameters, where w starts at 7 and grows automatically. We ran BioProspector with w = 10 and 40 randomized attempts and utilized its option to build a third-order Markov chain background model from the control sequences. For CMF we took the top M = 20 seeds with w = 7 and m = 2. In the case of Nanog, where the top 20 seeds of CMF produced similar Sox2 motifs for each dataset, we used 50 seeds to allow for other potential motifs. To conduct an unbiased comparison, we randomly split each dataset ininto training and test sets. Training sequences were composed of 80% of a TF binding dataset and a control dataset of 750 sequences. A test dataset consisted of the remaining 20% of bound sequences, S t 1 , and an independent control dataset of 4000 sequences, S t 2. Motifs were found by applying a motif finder to the training datasets. Identified motifs were then used to scan the test datasets for predicting binding sites. Denote by the number of sequences in S t 1. As a way to determine a proper LR cutoff,  , we chose the-th highest LR found in scanning S t 1 , under the assumption that each bound sequence should have one binding site on average. Then we estimated the FDR from the number of predicted sites in S t 2 with LR > :where L t 1 and L t 2 are the numbers of length-w segments in the test bound and control datasets, respectively. In this way, the total number of predicted sites in S t 1 was fixed to for every method so that our comparison on FDR was meaningful.shows the FDRs of each motif finder with the percent changes relative to CMF's FDRs in parentheses. CMF exhibited a lower FDR inFDRs are presented with the percent increase over the FDR of CMF in parentheses. NA indicates that the method was unable to find the motif. almost every dataset. Similar results were obtained for different choices of the LR cutoff . Some exceptions are seen in nMyc and cMyc from the Chen study where other methods showed a slightly lower FDR or the difference was negligible. However, there are many cases where CMF's accuracy was much higher (20%) than the other finders marked in bold text in. For example, the motifs found in all Oct4 and Sox2 datasets were much more accurate than those of the other finders, regardless of whether the consensus motif or the composite SoxOct motif was found. Oct4 and Sox2 often form a heterodimer that binds a Oct4 motif located adjacent to a Sox2 motif, called the SoxOct motif (). Furthermore, only CMF was able to find the Nanog motif, CCATTA (, Supplementary), in the Chen study. Note that Zfx, E2f1 and Smad1 from the Chen study are not included in, since Zfx has no known consensus motif and none of the methods found E2f1 or Smad1's consensus motifs. We repeated the same FDR comparison with simulated test control sequences, and observed consistent improvement of CMF over the other three motif finders (see Supplementary Materials for details). To ascertain whether CMF's decreased FDR was due to our seeding or PWM updating techniques, we applied the EM algorithm under the mixture model to update the PWMs initialized by the seeding method of CMF. This method produced inferior results in most cases (, mix MLE), suggesting that CMF's improved accuracy was not solely due to its seed creation. The results described above confirm the effectiveness of CMF in finding consensus motifs. Hereafter, we focus on applying CMF to identify context-dependent motifs by contrasting two sets of bound sequences. To understand the implications of finding motifs in this manner we considered ChIP-seq datasets in the Marson study, which contains data for four TFs, Oct4, Sox2, Nanog and Tcf3 (). Oct4, Sox2 and Nanog are key regulators of the main attributes of ESCs, pluripotency (the ability to differentiate into any cell type)and self-renewal (the ability to go through cell division an infinite number of times) (). Tcf3 is thought to temper the expression of genes bound by Sox2 and keep them from being highly expressed ().
Context-dependent motifs of Oct4Oct4 and Sox2 often form a heterodimer though both TFs also bind DNA as monomers. While the consensus motif of Oct4 is well characterized, some studies have suggested that it may bind other motifs in the presence of other cofactors (). We wanted to investigate the possibility of distinct Oct4 motifs occurring in the presence and absence of Sox2. To that end we contrasted sequences cobound by Oct4 and Sox2 (OScobound seqs) with those only bound by Oct4 (Oct4-only seqs) in the Marson study. Exact technical definitions of the two sequence sets are given in Supplementary Materials. While the consensus SoxOct motif, ATTTGCATAACAAAG, was found in OS-cobound seqs, a different motif, ATGCGCAT, was found in the Oct4-only sequences (). This new motif, which we term palindromic GCAT (pGCAT), consists of two palindromic GCAT half-sites first described in. This result can be replicated by contrasting similarly defined sequence sets from the Chen study. To investigate the biological implications of the two motifs, we checked the occurrences of the other 11 TFs in the Chen study () in the respective neighborhoods of the pGCAT motif and the consensus Oct4 motif. We scanned all Oct4 binding peaks in the Chen study for the two motifs and split them into two groups: those that only contain the Oct4 consensus motif, called Oct4-motif peaks, and those that only contain the pGCAT motif, called pGCAT peaks (see Supplementary Materials for details). We computed the proportion of Oct4-motif peaks that have a binding peak of another TF within 500 bp. We computed the same proportion for pGCAT peaks and determined the significance of the difference between the two proportions for every one of the 11 TFs (). We found that the Oct4-motif peaks and the pGCAT peaks were co-occupied by two distinct groups of TFs. Oct4-motif peaks are enriched for cobinding by Nanog, Sox2 and Smad1, which have been shown to regulate pluripotency genes, while pGCAT peaks are enriched for binding by nMyc, cMyc, E2f1 and Zfx, which regulate genes related to protein metabolism (). Furthermore, Stat3, Tcfcp2l1 and Esrrb also co-occupied more often with Oct4-motif peaks () and may be included in the first TF group. The two TF groups defined here have previously been shown to regulate two separate groups of genes (). For example,showed that cMyc, nMyc, E2f1 and Zfx function as activators in general while TFs in the other group can be either activators or repressors dependent on the target gene. Binding of these two groups of TFs together can explain much of the variation in gene expression in ESCs (R 2 = 0.65). Interestingly, in a similar comparison of enrichments based on binding peaks instead of motifs, the co-occupancy of the cMyc-group TFs is not significantly different between Oct4/Sox2 cobound peaks and Oct4-only peaks demonstrating the usefulness of the two motifs in classifying Oct4 binding peaks (see Supplementary Materials for details). The distinct sets of cofactors enriched near Oct4-motif peaks and pGCAT peaks suggest that the context-dependent motifs of Oct4 may be related to the combinatorial binding of the two TF groups. Target genes of Oct4 with only the Oct4 consensus motif include many known pluripotency related genes like Nanog, Dppa5a and Chd1 () while the pGCAT sites seem to regulate developmentally important genes (e.g. Id3, Hoxc5, Jmjd6). Supplementary Datasets 1 and 2 contain lists of target genes of Oct4 binding peaks that contain either the Oct4 consensus motif or the pGCAT motif.
Page: 2831 28262832
Identification of Context-Dependent Motifs
A B
Differences in motifs for HMG domainsSox2 and Tcf3 both have HMG-box domains that bind similar DNA patterns (). While both TFs are highly expressed in ESCs, Sox2 mostly activates its targets and Tcf3 tends to repress its targets (). Furthermore, many Sox2 and Tcf3 binding sites overlap, which suggests that the two TFs may compete for the same binding sites given their opposite regulatory roles. Approximately half of all Sox2 sites are bound by Tcf3 while about 2/3 of Tcf3 sites are bound by Sox2 in the Marson study. To investigate whether subtle signals might affect the targeting of the two proteins, we contrasted different subsets of sequences bound by Sox2 and/or Tcf3. Interestingly, we found that Sox2 consistently binds its consensus motif, ACAA[A/T]G (), in every subset of sequences bound by Sox2 regardless of whether Tcf3 binds the sequences (Supplementaryc). Tcf3, on the other hand, has different binding patterns depending on whether Sox2 also binds. The context-dependent motifs of Tcf3 can easily be found by contrasting two bound datasets.shows motifs found by CMF when contrasting Tcf3 bound sequences with and without Sox2 binding: we found the consensus Sox2 motif () in sequences bound by both TFs (ST-cobound), while sequences bound solely by Tcf3 (Tcf3-only) had a slightly different motif, TCAAAG (), which we call the Tcf3-specific motif. This result is consistent with the motifs identified by contrasting ST-cobound sequences, Tcf3only sequences or all Tcf3 bound sequences against control datasets (Supplementarye). Particularly, the motif found in all Tcf3 bound sequences is a mixture of the Sox2 motif and the Tcf3specific motif. The change from an adenine in position 2 in the Sox2 motif () to a thymine in the Tcf3-specific motif () is significantly associated with the cobinding of Sox2: the P-value for observing such an extreme difference by random partition of all Tcf3 bound sequences is practically zero (P < 510 8 ). This different nucleotide preference may prevent Sox2 binding while still permitting Tcf3 binding as it may recognize both motifs. Although this finding has not been experimentally validated, similar results have been found for Sox4 and Tcf1 by Selex (van de). Here, one sees that by contrasting subsets of bound sequences CMF can identify subtle signals with implications to functional binding. Many pluripotency genes bound by Tcf3 can be categorized by the context-dependent patterns. For example, Sox2, cMyc, Utf1 and Jarid2 have only the Sox2 motif in their promoters, while others like Klf2, Nr5a2 and Sall4 have the Tcf3-specific motif. Supplementary Datasets 3 and 4 provide lists of those targets bound by Tcf3 with either the Sox2 motif or the Tcf3-specific motif. It should be noted that DME and BioProspector can be used to find motifs enriched in one of two bound sequence sets by employing one sequence set as the background in order to find motifs enriched in the other and that FIRE can handle more than one bound sequence set. Using these approaches with the Oct4-only seqs and OS-cobound seqs, DME and BioProspector found motifs resembling the pGCAT motif but FIRE did not; for the Sox2 and Tcf3 datasets, FIRE and DME found the Sox2 and the Tcf3-specific motifs but BioProspector failed to detect either of them.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
DISCUSSION CMF yields PWMs that are corrected for false positives and outperforms PWMs found by other popular motif finders. When contrasting bound sequence datasets, CMF also mitigates the dominant signal of the consensus motif, enabling small differences from the canonical motif to be observed. Using CMF we detected context-dependent motifs of a few key TFs in ESCs, which demonstrates a concrete example for the use of large-scale ChIP-seq data to discover subtle and complex regulatory signals. The context in this work is defined by combinatorial or competitive binding of multiple TFs, which is different from the binding context studied in previous works that refers to the orientation, the location or the surrounding background nucleotides of a binding site (Beer and Tavazoie, 2004; Chen and Zhou, 2010; Huang et al., 2004; Nguyen and D'Haeseleer, 2006; Westholm et al., 2008; Yu et al., 2006). In future studies, we will develop a more principled approach to determine how many motifs CMF should output, in addition to the current use of an upper bound M. We also hope to adapt CMF to enable the discovery of motifs containing variably separated halfsites, such as Nrsf which can tolerate gaps that vary as much as 10 bp (Johnson et al., 2007). Furthermore, CMF does not take into account the interactions among binding sites in discriminating between S 1 and S 2. Incorporation of more sophisticated statistical models, such as classification trees and hierarchical mixture modeling (Zhou and Wong, 2004), in CMF should be helpful for finding interactive motif combinations and cis-regulatory modules.
