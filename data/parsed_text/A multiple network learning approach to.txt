Motivation: Condition-specific networks capture system-wide behavior under varying conditions such as environmental stresses, cell types or tissues. These networks frequently comprise parts that are unique to each condition, and parts that are shared among related conditions. Existing approaches for learning condition-specific networks typically identify either only differences or only similarities across conditions. Most of these approaches first learn networks per condition independently, and then identify similarities and differences in a post-learning step. Such approaches do not exploit the shared information across conditions during network learning. Results: We describe an approach for learning condition-specific networks that identifies the shared and unique subgraphs during network learning simultaneously, rather than as a post-processing step. Our approach learns networks across condition sets, shares data from different conditions and produces high-quality networks that capture biologically meaningful information. On simulated data, our approach outperformed an existing approach that learns networks independently for each condition, especially for small training datasets. On microarray data of hundreds of deletion mutants in two, yeast stationary-phase cell populations, the inferred network structure identified several common and population-specific effects of these deletion mutants and several high-confidence cases of double-deletion pairs, which can be experimentally tested. Our results are consistent with and extend the existing knowledge base of differentiated cell populations in yeast stationary phase. Availability and Implementation: C++ code can be accessed from
INTRODUCTIONAll cells on earth have the potential to sense and respond to different extracellular conditions defined by different environmental stresses, growth factors or cellular differentiation signals. Response to different conditions or condition-specific response is orchestrated * To whom correspondence should be addressed. by changes in the concentration of cellular components (mRNAs, proteins and metabolites) as well as the interactions among these components. Condition-specific networks capture the interactions among cellular components under different conditions, providing a system-wide view of condition-specific behavior. Understanding these networks can provide important insight into how organisms function, adapt and evolve. Although technological advances are allowing us to capture the concentrations of the system components, our ability to quantify the condition-specific interactions is still limited. Fortunately, network inference algorithms based on probabilistic graphical models that have been used successfully to infer a functional network from one gene expression (mRNA concentration) dataset (), provide a starting point for inferring conditionspecific networks. In principle, a probabilistic network for each condition could be inferred separately from each condition. In practice, however, such an approach is limited because it fails to recognize an important aspect of condition-specific network learning: this is a multiple-network learning problem, where the networks for each condition are related (with both shared and unique subnetworks). To extend existing network inference methods to infer conditionspecific networks, it is important to explicitly capture and exploit the shared information during network learning. In this article, we develop a novel approach, Network Inference with Pooling Data (NIPD), based on probabilistic graphical models that explicitly incorporates the shared information across conditions by simultaneously learning multiple, high-quality networks across a small number of conditions. NIPD treats the condition as an additional random variable, different values of which induce different network structures (). Edges in NIPD are statistical dependencies that abstract the true condition-specific, physical network (proteinprotein, proteinDNA interactions) and are inferred from condition-specific mRNA concentrations. Modeling the condition variable within the learning framework allows the condition information to directly influence which edges occur in the final inferred networks, and also the condition-specific roles of the edges. Existing network-based approaches for condition-specific responses can be grouped into module-centric and gene-centric approaches. Module-centric approaches identify transcription modules (set of transcription factors regulating a set of target genes) that are coexpressed in a condition-specific manner (Kimconditions, A and B. C represents conditions in NIPD. NIPD learns dependencies that are shared between A and B, as well as those unique to A or to). However, these approaches assume identical behavior for all genes within a module, and do not provide fine-grained interaction structure that explains the condition-specific behavior of individual genes. Further, condition-specific patterns are identified via a post-learning gene set enrichment analysis. Gene-centric approaches identify the set of condition-specific edges on a per-gene basis. Such approaches have been developed for capturing condition-specific behavior in diseases (), in yeast stress responses () and also in different species (). However, these approaches are not probabilistic in nature (), often rely on the network being known () and are restricted to pairwise coexpression relationships rather than general statistical dependencies (). Most of these approaches infer a network for each condition separately, and then compare the networks from different conditions to identify the edges unique or shared across conditions. The approach indoes integrate context more directly within a Bayesian network, but relies on an initial training set to learn model parameters (). Other approaches such as differential dependency networks () and mixture of subgraphs () construct probabilistic models, but focus on differences rather than both differences and similarities. The NIPD approach is a gene-centric approach with the following benefits: (i) infers general statistical dependencies including pairwise and higher order dependencies (dependencies among more than two genes); (ii) does not rely on the network being known; (iii) is probabilistic in nature, providing a system-wide description of the condition-specific behavior as a probabilistic network; (iv) simultaneously learns networks across multiple conditions allowing the learning procedure to be informed by the shared information across conditions; and (v) does not bias the networks toward only differences or similarities, thus identifying both conserved and unique aspects of condition-specific responses. Results on simulated data from known ground truth networks suggested that networks inferred by NIPD were of significantly higher quality than networks learned separately for each condition. Results on microarray compendia from two yeast cell populations, quiescent and non-quiescent, both under glucose stress (), demonstrated that NIPD identified dependencies capturing shared processes (respiration) that agree with the global starvation stress experienced by these cells, as well as populationspecific processes (chromatin modeling in quiescent), that are consistent with the physiological state of these cells. Finally, NIPD networks were used to extract candidates of double deletion experiments, that can lead to insight into this important stage in the life cycle of yeast, and for processes such as cancer and aging ().
Learning multiple networks
METHODS
Probabilistic graphical models for functional networksNIPD is based on the framework of probabilistic graphical models (). These models have been widely used for modeling biological networks (), because they can represent complex interaction patterns and also model noisy data, both typical of biological systems. A probabilistic graphical model has two components: a graph G and a set of potentials functions ={ 1 ,..., || } (). The nodes of G represent random variables, X ={X 1 ,...,X n }, encoding the mRNA expression level of genes. The edges of G represent pairwise and higher order (among >2 genes) statistical dependencies among random variables. Each  i specifies the mathematical form of the dependency between X i and its neighbors. The graph can have directed edges as in Bayesian networks () or undirected edges as in Markov random fields (). We focus on undirected models, because they can represent cyclic dependencies, which arise in biological networks and are difficult to represent in directed models. Learning in these models typically optimizes a likelihood-based score by greedily searching the space of candidate graphs (). In undirected models, because likelihood cannot be exactly computed, we use pseudo-likelihood to learn the structure (). Briefly, pseudo-likelihood decomposes as a product over conditional distributions per variable, P(X i |M i ), where M i denotes the immediate neighborhood or Markov Blanket of X i. To learn G, we need to find the best M i for each X i .
Learning multiple condition-specific networksAssume we have a set of k conditions, C. Let |D c |={x c1 ,...,x c|Dc| } denote the dataset for the c-th condition, 1  c  k. x cd ,1  d |D c |, denotes the mRNA expression values in the d-th microarray in condition c. The problem of condition-specific network learning is defined as: given k datasets,A simple approach for learning multiple networks is to learn each graph G c , independent of all G c ,c = c, using dataset D c only. We refer to this approach as the independent learner (INDEP). INDEP is a generalization of several existing approaches (), which can all be considered as instances of INDEP with a specific network learning algorithm. We use the Markov blanket search algorithm as the learning algorithm for INDEP, which finds the best Markov blanket of every node using a greedy search of edge additions ().
Exploiting shared information for learning multiple networks(NIPD): To motivate NIPD, let us first consider the 'condition' semantics of an edge for the two condition case C ={A,B}. An edge between two variables, X i and X j , can occur only in condition A but not in B, only in condition B but not in A, or in both A and B. Thus, edges in condition A's network are the union of edges that occur in the singleton set {A}, and the edges that occur in the set {A,B}. Our goal is to explicitly capture these condition subset semantics of each edge. Such information can be useful to characterize transcription factors that regulate overlapping target sets in different conditions (). An edge that occurs in a nonsingleton condition subset is a shared edge, and its parameters can be learned by pooling the data from all the conditions in the subset. Of course, bothPage: 1834 18321838
S.Roy et al.the edges and their condition-specific semantics are unknowns and must be inferred automatically from the data. NIPD uses a novel formulation of the conditional distribution,). The proportionality sign can be eliminated by dividing by a normalization constant. However, we work with the unnormalized product because it decomposes over condition subsets (Supplementary Material). Other formulations of P(X i |M ci ), such as a weighted sum of mixtures (), are not decomposable over condition subsets and did not have significant advantages in our preliminary experiments.  Ei is estimated by pooling the data for all non-singleton E, which in turn makes more data available for estimating these parameters. This enables NIPD to robustly estimate parameters, especially those of higher order dependencies, which are harder to estimate relative to pairwise dependencies.
Structure learning algorithm of NIPD in detail:Our structure learning algorithm maintains a conditional distribution for every variable, X i for every set E  powerset(C) and computes score improvement of adding an edge {X i ,X k } in every set E. This addition will affect the conditionals of X i and X j in all conditions e  E. The net score improvement of adding an edge {X i ,X j } to a condition set E is given by:whereBecause the edge {X i ,X j } is being added to M * E , all terms not involving E remain unchanged producing the score improvement:This score allows us to score an edge in condition sets in a decomposable manner. Our structure learning algorithm begins with k empty graphs and proposes edge additions for all variables, for all subsets of the condition set C (Algorithm 1). The outermost for loop (Steps 414 ) iterates over variables X i to identify new candidate MB variables, X j , in a condition set E. We iterate over all candidate MBs X j (12) and condition sets E (Steps 611) and compute the score improvement for each pair {X j ,E} (Step 10). If the current condition set under consideration has more than one condition, data from these conditions are pooled and parameters for the new distribution P(X i |M * Ei ) are estimated using the pooled dataset (Steps 79). A candidate move for a variable X i is composed of a pair {X j ,E } with the maximal score improvement over all variables and conditions (). After all candidate moves have been identified, moves are attempted in the order of decreasing score improvement (Step 15), to enable moves with the highest score improvements to be attempted first. A move connecting two variables, X i and X j , can fail if a previous move updated the neighborhoods of either X i or X j. The algorithm converges when no edge addition improves the score of the k graphs. Although we implement NIPD with undirected, probabilistic graphical models, the NIPD framework is applicable to directed graphs as well.
Dataset description
Microarray data from yeast stationary phase:Each microarray measures the mRNA expression of all yeast (Saccharomyces cerevisiae) genes in response to 100 genetic deletions from quiescent and nonquiescent populations, isolated from glucose-starved stationary phase cultures (), We first filtered the microarray data to exclude genes with > 80% missing values. We then considered only those genes whose expression changed significantly (|z|-score  4) compared with wild type, in either quiescent or non-quiescent populations. This resulted in a final dataset of 2639 genes exhibiting downstream knockout effects of 1 of the 88 deletions. Although we selected genes that were significantly affected by at least by one deletion, neither NIPD nor INDEP knew which genes were affected by which deletion.
Simulated data:We simulated data from six networks, one network per condition. One of these was a subnetwork of 99 nodes from the Escherichia coli regulatory network (). The other five were generated by flipping 10, 30, 50, 70 and 100% of the edges of the first network. A simulated dataset was generated per network, using a differential
Learning multiple networksequation-based simulator, by perturbing all transcription factor nodes and measuring the steady state of all genes (). This was repeated 1000 times per network.
Validation of network structure
Inferred from simulated data:We used three methods to infer networks on simulated data: NIPD, INDEP with a Markov blanket search algorithm () and GeneNet (). GeneNet also infers a network per condition independently by learning a shrinkage-based partial correlations graph, and is well-suited for sparse data situations. Note the GeneNet algorithm outputs a weight for every edge corresponding to the statistical significance of an edge. To obtain a network, one needs to specify an input number of edges. We used the number of edges from NIPD because this was when GeneNet had the highest performance. We compared the structure of the networks inferred by these algorithms to the true network structure using standard precision and recall of edge match, and also the neighborhood match of every node (Supplementary Material). For edge match, we report the F-score, which is the harmonic mean of precision and recall. We evaluate neighborhood structure quality by obtaining the number of nodes on which one approach was significantly better than another approach (t-test P < 0.05) in capturing node neighborhood as a function of training data size (See Supplementary Material). This comparison captures a more localized picture of the types of random variables that may be contributing most to errors. We partitioned each dataset into q equal partitions, where q  {3,4,5,6,7,8,9,10}. The training data size for each partition is N q and decreases with increasing q. For each q, we learned a network for each partition and report the average F-score.
Inferred from microarray data:Network inference from microarray data is known to be a notoriously difficult problem because of the relatively few samples (microarrays) compared with the number of genes. A concern that arises in this situation is distinguishing true from spurious dependencies. We took several measures to ensure the dependencies captured by our networks represented meaningful dependencies: (i) we use an MDL-based score that penalizes complex structures, (ii) genes were connected to only the 88 genes for which we had single deletion strains (this was done uniformly for both NIPD and INDEP), (iii) genes without deletions were not allowed to have more than eight neighbors (the 88 genes with deletion mutants were unconstrained), (iv) edges inferred by INDEP or NIPD were assigned a confidence score based on a well-known bootstrap analysis (), where we subsampled the data 20 times. We considered only those edges that had a confidence  , which in turn was determined based on the probability of observing an edge with this confidence by random (Supplementary). We selected  = 0.3 because this represented the point of most dramatic change in the probability for random edges. All GO Process enrichments were performed in Genatomy (http://www.c2b2.columbia.edu/danapeerlab/html/genatomy.html).
RESULTSThe goals of our experiments were as follows: (i) to compare our approach against independent network learning approaches, on simulated data from known ground-truth networks and (ii) to assess the value of our approach on real microarray data. For (i) we used two independent learners, INDEP with a Markov blanket search algorithm and GeneNet (). Experiments on simulated data allowed us to systematically compare the quality of the inferred networks and, therefore, assess the benefit of pooling data and sharing information across conditions versus learning networks independently. To address (ii) we applied NIPD and INDEP on microarray data from two yeast cell populations isolated from glucose-starved stationary phase cultures (). These data are good case studies for condition-specific network learning (hundreds of samples per condition), and the inferred quiescent and non-quiescent networks can provide potentially new insight into stationary phase, a process known to be intricately related to cancer and aging.
NIPD had superior performance on networks with known ground truthWe first evaluated overall network structure using two sets of networks, HIGHSIM and LOWSIM. Networks in HIGHSIM shared a large portion (75%) of the edges, and networks in LOWSIM shared a small (20%) portion of the edges. On HIGHSIM, NIPD performed significantly better than INDEP and GeneNet for all training data sizes (). On LOWSIM, NIPD was significantly better than INDEP, and comparable to GeneNet performing better on one network and at par on the second network. In addition to standard F-score, we also compared the algorithms based on how well neighborhoods of individual variables were identified (Supplementary Figs S5S8). These 'per-variable' scores provide a more granular understanding of algorithm performance. In particular, nodes with high degree may be contributing to the majority of the errors, but standard precisionrecall values will not be able to capture this. NIPD consistently outperformed other algorithms, especially when there is some sharing of structure between conditions. To demonstrate that NIPD is not specific to two conditions, we varied the number of conditions from two to six. We found that NIPD and GeneNet were generally better than INDEP, which does not handle sparse data conditions, and the performance margin between NIPD and GeneNet decreased with increasing number of networks (, Supplementary Figs S2S4). NIPD seemed to suffer most on networks with the fewest number of shared edges, whereas GeneNet suffered most when there were more shared edges. However, GeneNet did not significantly outperform NIPD in any case. Overall, our results show that when the individual condition-specific networks are similar, NIPD has a significantly better performance than other algorithms. When the underlying networks are different, NIPD performs at par with methods suited for small training data sizes.
Application to yeast quiescenceWe applied NIPD to microarray datasets from yeast quiescent and non-quiescent cell populations separated from stationary phase cultures (). The cell populations have experienced the same glucose starvation stress, but have differentiated physiologically (), suggesting that each population responds to starvation stress differently. Each microarray within each dataset measures the expression profile of 1 of 88 deletion mutants, selected based on existing knowledge of yeast stationary phase. We applied NIPD and INDEP approaches to learn quiescent and non-quiescent-specific networks, treating each cell population as a condition. One of the goals of our study was to further characterize these deletion mutants, many of which have no known phenotype. Hence, we constrained the networks such that only Page: 1836 18321838, 1 q , where 3  q  10. Top is for HIGHSIM (75% edges shared) and bottom is for LOWSIM (20% edges shared). The top and bottom graphs are for networks from the individual conditions. Higher is better.genes with deletion mutants are connected to the remaining genes. 1 The neighborhood of each deletion mutant determined by the network topology was analyzed for Gene Ontology (GO) process enrichment (FDR < 0.05), and the network quality was considered proportional to the number of unique GO processes enriched within a neighborhood.
S.Roy et al.
NIPD captures both common response as well as populationspecific starvation responses:To determine if one method was superior than another, we examined the GO process categories enriched in the neighborhood of every deletion mutant in the inferred networks. On quiescent, 21 of the deletion mutants were enriched in 68 different biological processes using the NIPD-inferred network, whereas using INDEP only 2 mutants were associated with a biological process, all of which were identified by the NIPD algorithm already (Supplementary Material 1). Similar behavior was observed on non-quiescent. To identify similarities and differences between the two populations, we asked which deletion mutants affect the same processes in both populations, and which mutants affect different processes (Supplementary). We found several processes that were affected by the same deletion in quiescent and non-quiescent populations, suggesting a conserved, starvation stress response (response to stimulus, cellular respiration). Both these processes were previously identified to be associated with quiescent cells (). NIPD also identified several processes that were associated exclusively with quiescent cells (purine metabolic process, cellular aging, chromatin modification). Although respiration was present in both populations, quiescent was associated with more processes related to respiration, consistent with our recent finding that quiescent cells exhibit higher rates of respiration (). The only process that we did not recover was signal transduction. This may be because of our per-mutant analysis, whereas previous work considered upregulated genes in the entire compendium of quiescent cells. In contrast, INDEP did not identify any shared process, and identified a small subset of these population-specific processes.
NIPD identified several deletion combinations:We next analyzed neighborhood genes of individual deletion mutants to identify pairs of deletion mutants that had more overlapping neighbors (Hypergeometric P<1E-3). Such combinations represent candidates for double deletion analysis, that are generally harder to experimentally test, but are necessary to identify genetic interactions and cross-talk between pathways. We found 18 and 21 deletion pairs in quiescent and non-quiescent populations, respectively. These numbers are significantly higher than in random networks with identical degree distributions (z-test, P < 1E-4, Supplementary). In quiescent cells, we found several deletion pairs likely to affect TCA cycle and aerobic respiration. In non-quiescent cells, several knock-out combinations involved fatty acid metabolism and aerobic respiration. Our predictions included genes either with known phenotypes in stationary phase or related to genes with such phenotypes. For example, QCR7, QCR8 and QCR10 are subunits of ubiqunol-cytochrome c oxidoreductase complex; QCR7 is essential for viability in stationary phase (), and both QCR8 and QCR10 were in our predictions. Our predictions also included ALD4 and ADH2, both dehydrogenases, which may affect population heterogeneity of non-quiescent cells and reproductive capacity of both cell types (A. Dodson, personal communication). Overall, 17 of the 39 genes in our predicted deletion combinations are required for viability and survival in stationary phase, which suggests these combinations are likely to have significant phenotypes.
DISCUSSION
Learning multiple networksof condition-specific responses. The crux of our approach is to recognize that condition-specific network learning poses a multiple network learning problem where the networks are related and, therefore, share information among them. NIPD solves this problem by simultaneously learning networks across all conditions using a novel score that allows the learning process to be aware of the shared information across conditions. Small training datasets, which are common for biological data, present significant challenges for any network learning approach. In particular, standard approaches that infer networks for each condition independently () suffer from low sensitivity because they miss shared dependencies that are too weak within individual datasets. In contrast, NIPD is able to recover these shared dependencies because by pooling data across conditions during network learning, NIPD effectively has more data for estimating parameters for the shared parts of the network. This allows NIPD to have more discovery power than INDEP, and our results confirmed that the additional dependencies inferred by NIPD represent shared, biologically meaningful dependencies. One of the strengths of NIPD was its ability to identify networks with the most biologically meaningful structure. This allowed us to characterize deletion mutants based on their affects on quiescent and non-quiescent cells, and also to predict combinations of such individual gene deletions. Several of these predictions are supported by literature, including genes that are known to have a phenotypic effect on stationary phase cultures (). Importantly, these predictions are a drastic reduction of the possible double deletion combinations of 88 single gene deletions and provide directions for future experiments. The probabilistic framework of NIPD can be easily extended to automatically infer the condition variable to handle situations with uncertainty about conditions. The run time of NIPD scales exponentially with the number of conditions (Supplementary) which makes the algorithm prohibitively slow for higher number of conditions. Another direction of future research is to incorporate condition hierarchies or temporally related conditions, to focus on a few, instead of all, condition subsets. NIPD can also be extended to integrate data from other levels of cellular organization such as the proteome, metabolome () and the epigenome (). An important feature of NIPD is that it is gene centric, allowing us to derive condition specificity of individual pairwise and higher order dependencies, which is feasible for conditions with enough samples for such a fine-grained analysis. While module-centric approaches have had much success in dissecting the regulatory program across diverse conditions, such approaches are amenable to situations where a fine-grained analysis is not possible. Thus, both approaches have their merits and the suitability of each approach is dependent upon the data at hand. Next-generation technologies are making large-scale transcript data per cell type and condition a near possibility. We expect our approach to be beneficial for interrogating these datasets and deciphering mechanisms of cell type and tissue specificity.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [14:59 8/6/2011 Bioinformatics-btr270.tex]
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
This is not a bi-partite graph because the genes with deletion mutants are allowed to connect to each other.
