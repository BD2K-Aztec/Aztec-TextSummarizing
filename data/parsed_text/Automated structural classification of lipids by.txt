Motivation: Modern lipidomics is largely dependent upon structural ontologies because of the great diversity exhibited in the lipidome, but no automated lipid classification exists to facilitate this partitioning. The size of the putative lipidome far exceeds the number currently classified, despite a decade of work. Automated classification would benefit ongoing classification efforts by decreasing the time needed and increasing the accuracy of classification while providing classifications for mass spectral identification algorithms. Results: We introduce a tool that automates classification into the LIPID MAPS ontology of known lipids with >95% accuracy and novel lipids with 63% accuracy. The classification is based upon simple chemical characteristics and modern machine learning algorithms. The decision trees produced are intelligible and can be used to clarify implicit assumptions about the current LIPID MAPS classification scheme. These characteristics and decision trees are made available to facilitate alternative implementations. We also discovered many hundreds of lipids that are currently misclassi-fied in the LIPID MAPS database, strongly underscoring the need for automated classification. Availability and implementation: Source code and chemical characteristic lists as SMARTS search strings are available under an open-source license at https://www.github.com/princelab/lipid_ classifier.
IntroductionLipids are a fundamental component of biological systems and perform diverse roles in many cellular pathways. They comprise several thousands of structurally distinct species whose diversity is preserved by dedicated cellular systems (). The lipid composition of a cell is linked to its function; hence lipids are excellent subjects for gaining insight into biological systems and predicting abnormalities (). Indeed, lipids are known to play a major role in diverse diseases afflicting millions, including obesity (), diabetes (), asthma (), hypertension (), arthritis () and cancers (). Lipidomicsthe analysis of the lipid composition, localization and activity of a cellular or physiological systemis a burgeoning field of research (). One major difficulty in studying lipids is dealing with their great structural diversity. To help address this challenge, the LIPID MAPS Consortium has created and is refining the LIPID MAPS Lipid Classification System (LMLCS), which has become the de facto ontology used in lipid research. With this ontology, the lipid research community is able to discuss predicted lipid properties and cellular functions in ways that would otherwise be impossible.Indeed, classification of biomolecules is a prerequisite to any systems biology approach (). This is particularly true in the area of mass spectrometry identification, where theoretical fragmentation spectra (used for matching with each experimental spectrum) are generated by different sets of rules based on a biomolecule's type (protein, metabolite, etc.). The principle holds true for lipids: nearly all existing identification approaches require that a lipid be classified (although sometimes implicitly) to generate a theoretical spectrum from a lipid's structure (). Classification makes possible restricted search space structural comparisons and even fundamental tasks such as representing lipids in a systematic fashion (). The benefits resulting from classification are definite, but these benefits are currently inaccessible to lipids, which have not been previously classified. In an enormous feat, LIPID MAPS has classified over 38 000 lipids over the last 15 years. Still, there are more than 120 000 lipid species () and probably more when considering oxidative modifications, yet undiscovered natural products and unanticipated future synthetic modifications. And, although automatic classification tools have been alluded to (), currently there is no publicly available software for the automated classification of lipids. Although classification can be performed manually, manual classification cannot be used in any automated software pipelines, does not scale well and may not always be accurate (). We present an approach to generate a classifier trained on the LMLCS, which can be used to classify novel lipids automatically and assist in manual classification workflows.
MethodsMore extensive methodology is given in the methods supplement. All models were classified upon the LIPID MAPS structural database (LMSD) as downloaded from lipidmaps.org.
Chemical language and identifying featuresWe used Rubabel, a cheminformatics software suite built upon the OpenBabel library, to provide programmatic representation of chemical structures (), which were searched by SMILES Arbitrary Target Specification (SMARTS) search strings to produce a list of chemically identifying structural characteristics, as detailed in Supplementary Table S1. Each identifying structural characteristic formed a binary variable indicating presence of a feature () or representing a numerical count of feature matches.
Classification by machine learningWEKA (version 3.7.11) machine learning algorithms () were compared by several numerical performance measures (see Supplementary Algorithm Selection). The J48 decision tree algorithm was selected based on performance, speed and interpretability. Classification accuracy was optimized upon a 15% subset of the LMSD. The WEKA-produced decision trees contain a rule-by-rule determination of lipid classification based on the identifying structural characteristics and were trained upon a randomized 90% sampling of the entire training dataset. Each lipid of the training dataset, which consisted of the entire LMSD, was structurally analyzed to produce a structure feature list, which was then split into the hierarchal levels of the LMLCS (see, panel A). Each feature list was then analyzed by WEKA to produce decision trees representing the classification steps at every hierarchical level. This generated hierarchy of classification trees were loaded into a programmatic classification system (see, panel B) implemented in Ruby, which classified each given lipid structure by (i) generation of a structural feature list and (ii) application of each hierarchical decision tree. The Ruby classification system was evaluated for accuracy across all hierarchical levels by examination of the entire LMSD. Each classification was considered a miss or hit in two categories, category classification and category-internal classification. These two scores present scores for both the complete classification and the relative importance of category selection. Classification model accuracy was confirmed by manual evaluation of all misclassified lipids and annotated any potential ontology changes. When the classification models assigned lipids to categories that were not indicated by their structure, we identified relevant structural features which could provide correct classification assignment. A B. Lipid classification workflow schematic. (A) A lipid classification is constructed from a training set of lipids with known classifications. Each lipid in the training set is analyzed structurally to produce a list of structural characteristics which can be used for machine learning analysis. These feature sets are split into hierarchal groups according to their classification. Machine learning analysis builds a distributed set of decision trees at each hierarchal level. (B) A novel lipid is analyzed structurally and then compared with the WEKA produced decision trees at each hierarchal level to generate a complete classification. Overlaid boxes highlight the contributions of each hierarchical layer to a complete classification
Evaluation of novel lipidsEvaluation of the trained classifier was performed upon an extracted subset of the LipidBank database (), which consisted of some 1195 molecules, many of which are similar to molecules which are contained in the LMSD. Accuracy was measured by manual evaluation to determine if these lipids were (i) properly categorized into and (ii) fit within the LMLCS. Hits and misses were only counted when the similar lipids were found in the LMSD.
Statistical considerations and model validationAlgorithm selection was performed by split-percentage validation at 66%. WEKA derived accuracy scores for these data were compared with the J48 model based on 90% of the training dataset with crossvalidation.
ResultsThe classification model for each dataset produces decision tree output for both manual interpretation and programmatic analysis as in.
Classifier model performanceThe comprehensive reference implementation in the Ruby language provides <1.2% error across all classification levels (see Supplementary Misclassifieds). An equivalent implementation trained on a 66% split percentage yields 3.0% error. At the category level, we reach 99.98% accuracy (as described in) when suggested improvements to the existing ontology are followed as outlined in the Supplementary Tables S2 and S3.
Novel lipid analysisEvaluation of classified lipids from the LipidBank database demonstrates the capability of this classification to handle novel lipid classes. In 780 novel lipids, we correctly classified 63% of the lipids, which were manually determined to be within the current LIPID MAPS ontology (see Supplementary Novel Lipid Analysis).
Ontology modificationsWe carefully inspected the results of the model built upon crossvalidation training and discovered 150 lipids that are misclassified in the LMSD (as detailed in the Supplementary Misclassified). The number of misclassified lipids indicates the difficulty of hand curating a database the size and complexity of the LMLCS. In addition, the ability of our classifier to find these misclassified lipids strongly supports the utility of our automated approach.
Discussion
Classifier design and performanceThe high degree of accuracy we achieved suggests that the LMCLS is a structurally coherent representation of lipid structural diversity. Despite an origin in synthetic pathways, the 2009 revision of the ontology is largely structurally derived, making an analysis like this successful. The chemical characteristics chosen provided robust machine learning attributes across a majority of potential classifier algorithms (see the Supplementary Algorithm Selection). The J48 algorithm was chosen because it provided nearly identical performance to the LMT algorithm but at 1/200th of the analysis time. Taken collectively, the 90% and 66% training set analyses and algorithm selection analysis suggest that the chemical features selected are robust attributes for classification. The neutral glycolipid class of the sphingolipid (SP) category remains a source of error as the current ontology fails to encompassCategory level errors represent misclassifications, which put a lipid into the wrong category and are excluded from 'within category' error counts. Within category, errors represent any misclassification of a lipid other than a category level error.
A B
Automated structural classification of lipids by machine learningthe diversity of these 3000 glycolipids. The classification of these lipids is dependent upon sugar oligomer length to differentiate nomenclature precedence. Thus, resolution of this issue will require (i) consideration of ontology changes to better reflect the diversity of neutral glycolipid structures and (ii) consideration of structural characteristics beyond the SMARTS systems currently employed, such as a longest-path finding algorithm. The current diversity of glycolipids within the LMSD fails to encompass possible diversity, as there are only a few sugar monomers contained therein, fucose, mannose, galactose and glucose. We suggest that future efforts investigate this diversity more fully and propose more sweeping ontology changes, such as subclasses, which allow for classification of unrepresented sugar monomers or subclasses, which only contain lipids with a specified sugar root structure.
Novel lipid analysisEvaluation of a novel lipid library demonstrates the capacity of our classifier to streamline novel lipid analysis. It further demonstrates a need for further refinements within the established ontology. Many missed lipids are likely missed due to the limited size of some subclasses. Additionally, many lipids which were not currently contained within the LMLCS would be very appropriately grouped into ontology not found in the LMLCS. The differential in performance between the novel analysis and the curated database was expected given that the current ontology does not endeavor to deal with edgecase lipids. Many of the tested lipids were much shorter than the chain lengths represented in the LMLCS and thus beyond the capability of our models to differentiate between them. This analysis provides an understanding of the limitations of the LMLCS in its current form and can guide future efforts in accommodating novel lipids.
Ontology modificationsMany of the misclassifications are due to small structural differences. Lipid LMGP04040006 is classified as a dialkylglycerophosphoglycerol. The structure contains an acyl group instead of an alkyl group, corresponding to our classifier's assignment for this lipid as a 1-acyl, 2-alkylglycerophosphoglycerol or LMGP0411. The fatty acid LMFA01010053, in the straight chain fatty acid class, is clearly branched, as classified by our analysis. The model excelled at assigning lipids that contain multiple structural features. Several fatty acids are both branched and unsaturated. These fatty acids are distributed among both the unsaturated fatty acids and the branched fatty acids even though they are structurally similar. The model followed the established ontology that branching takes precedence over unsaturation and assigned these lipids to the correct classification. In accordance with IUPAC guidelines (), neutral glycosphingolipids were assigned a group based on their root sugar chain, the first four sugars, and their linkage to the SP. LIPID MAPS suggested nine groups (or series, LMSP0501-09). There are several sets of distinct lipids within the Neolacto subgroup that do not fit into it nor any other group. These sets (LMSP0505DC-F and LMSP0505DM-N) contain 32 and 16 lipids with two unique roots. We suggest implementation of two new ontology groups for these distinct roots: gluco-globo (LMSP0510) and galacto-lacto (LMSP0511). Glucoglobo highlights the similarity to the isoglobo (LMSP0506) series, excepting the terminal N-acetyl glucosamine. Galacto-gluco associates with the Gala series (LMSP0509) in their shared repeated galactose monomers while highlighting the terminal glucose monomer.These new ontologies would represent the incorrectly classified lipids in their own ontology and improve classification of all neutral glycosphingolipids.
Future directionsFuture work should expand the classification system to classify nonlipids into general categories and improve upon some existing limitations of the extensive sugar nomenclature within the SP category. Future efforts will shorten analysis time per lipid. Future work should evaluate whether the need for an alternative ontology which enables multiple classifications for a given lipid exists, such as the aforementioned branching and unsaturation precedence. An alternative ontology derived from machine learning clustering analysis might provide a more natural fit and reduce the prevalence of 'other' classification categories.
FundingThis work was supported by BYU Institutional Funds, BYU Undergraduate Research Awards and BYU CHIRP Grant. Conflict of interest: none declared.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
R.Taylor et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
