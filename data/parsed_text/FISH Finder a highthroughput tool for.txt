Motivation: Fluorescence in situ hybridization (FISH) is used to study the organization and the positioning of specific DNA sequences within the cell nucleus. Analyzing the data from FISH images is a tedious process that invokes an element of subjectivity. Automated FISH image analysis offers savings in time as well as gaining the benefit of objective data analysis. While several FISH image analysis software tools have been developed, they often use a threshold-based segmentation algorithm for nucleus segmentation. As fluorescence signal intensities can vary significantly from experiment to experiment, from cell to cell, and within a cell, threshold-based segmentation is inflexible and often insufficient for automatic image analysis, leading to additional manual segmentation and potential subjective bias. To overcome these problems, we developed a graphical software tool called FISH Finder to automatically analyze FISH images that vary significantly. By posing the nucleus segmentation as a classification problem, compound Bayesian classifier is employed so that contextual information is utilized, resulting in reliable classification and boundary extraction. This makes it possible to analyze FISH images efficiently and objectively without adjustment of input parameters. Additionally, FISH Finder was designed to analyze the distances between differentially stained FISH probes. Availability: FISH Finder is a standalone MATLAB application and platform independent software. The program is freely available from:
INTRODUCTIONFluorescence in situ Hybridization (FISH) is a technique used to visualize the location of specific DNA sequences within the nucleus. FISH incorporates fluorescently labeled probes that bind only to the segment of the genome with which they have a high degree of sequence similarity. Thus, FISH provides a way to visually locate a gene within the nucleus using fluorescence microscopy. The process of manual data acquisition is time consuming and subjective due to inconsistency of an investigator's decisions. Therefore, to achieve high throughput and objectivity, the method of data acquisition * To whom correspondence should be addressed.should be standardized as well as automated so less manual work is required from the investigator and data are objectively acquired. One simple automated approach to extracting a cell from the background is achieved by setting a threshold value above the background level of fluorescent light intensity (): all pixels with light intensity values higher than the threshold are considered as part of the valid nucleus, while pixels with light intensity lower than the threshold are excluded as background noise. Another similar approach is to set a fixed signal-to-noise ratio, which incorporates a fixed threshold in order to isolate and extract the valid nuclear boundary (). When cells contain relatively homogenous 4 ,6-diamidino-2-phenylindole (DAPI) fluorescence signal intensities and have sufficient contrast relative to the background, these fixed threshold-based methods often produce biologically meaningful results. However, fluorescent light intensity values vary greatly between experiments and cell nuclei because artifactual fluorescence and cytological debris are usually present in FISH experiments as well as the fact that cells have inherent biological variations in shape, size and other properties. Due to non-uniform intensities found within cells as well as in the background of FISH images, fixed threshold-based segmentation methods have inherent limitations. As a result, common thresholdbased methods used by existing software programs often require manual modification from one sample to the next within the same experiment (). Moreover, other advanced segmentation methods such as dynamic programming (DP) or pattern recognition require user interaction and/or training data for producing optimum output (). To overcome these limitations, we have developed a highly automated graphical user interface software tool called FISH Finder, which is specifically designed to analyze FISH images effectively and objectively. The main contributions of FISH Finder are:(i) it segments fluorescently stained nuclei automatically using a statistical approach called compound Bayesian classifier to achieve contextual classification and segmentation; using this method, FISH Finder produced highly satisfactory results of radial positioning analysis in the study of subnuclear organization for seven genes (). (ii) FISH Finder automatically identifies up to two FISH signals per fluorescent channel and will compute the shortest distance from fluorescent signals to the nuclear boundary or to other fluorescent signals using the Euclidean metric. FISH Finder allows for selection of up to 10 different fluorescent signal channels to be processed. (iii) Processed images can be opened for editing or re-editing (i.e. add or remove FISH signals, removePage: 934 933938
J.W.Shirley et al.unwanted nuclear boundaries and add or adjust nuclear boundaries). (iv) Finally, it allows investigators to save the results in commaseparated values (CVS) file format that can be imported into other computational software such as R or Microsoft Excel.
PROGRAM FEATURES
User interfaceFISH Finder is platform independent and only requires a license of MATLAB 7.1 or higher in addition to FISH Finder's MATLAB code (which is freely available for download at http://code.google.com/p/fishfinder/downloads/list). FISH Finder's graphical interface was created using the MathWorks MATLAB programming environment. FISH Finder was designed for investigators who have little or no experience using MATLAB and have no background knowledge in computer programming languages. Furthermore, the functionality of FISH Finder's graphical interface is divided into two main phases. The first phase is the automatic processing mode, which requires the investigator to specify input data for processing. Once files are specified, the program produces the necessary outputs or results for the second phase, FISH Finder's editor window, which allows the investigators to verify, modify and export results.
InputThe FISH Finder input window allows users to specify images to be processed. To achieve the ability of reading in different types of input files such as Tagged Image File Format (.tiff) image stack or DeltaVision (.dv) images stack, LOCI Bio-Format toolkit is integrated into FISH Finder (http://loci.wisc.edu/software/bioformats). Furthermore, FISH Finder allows investigators to import a list of data folders containing multiple FISH images for processing. Investigators must specify the number of fluorescent channels to be analyzed and the order in which the DAPI channel was filtered during image acquisition before starting the image analysis process. However, the investigator does not need to specify or set any predefined values for nuclei segmentation. FISH Finder automatically determines optimal parameters for segmenting foreground from background.
Segmentation via contextual classification
Fluorescent probe signal extraction and positioning analysisA fluorescent probe signal can be determined objectively by analysis of pixel intensity values within an extracted nucleus. FISH Finder computes the average light intensity of the fluorescent probe signal channel, which then serves as the threshold for selecting fluorescent probe signals. Any notable bright spots identified with higher intensity than the threshold will serve as candidates for FISH signals. Then FISH Finder reduces the number of candidate signals by analyzing the size of the signal as well as comparing the intensities of candidate signals. To accommodate variation in fluorescent probe signal strength and quality, the minimum intensity for FISH signal detection can be optimized with adjustment of the threshold in FISH Finder's input window (note: the default setting of this adjustable parameter was determined during design and development of FISH Finder). Given the location of a FISH signal, FISH Finder determines the distance between the signal and the nearest point on the estimated nuclear boundary using the Euclidean distance measurement. FISH Finder then computes the radial distribution ratio, which is the peripheral distance of the FISH signal divided by the average radius from the estimated nuclear boundary. The average radius of a segmented nucleus is determined by finding the radius of a circle with the same area as the segmented nucleus.
Result verification and editingAfter processing image datasets, investigators can immediately choose to open FISH Finder's editing screen, which allows investigators to import folders of processed data (). The editing screen enhances the investigator's ability to edit the image data Page: 935 933938by allowing them to add or remove nuclei, to adjust a nuclear boundary and to add or remove FISH signals (3). FISH Finder incorporates two methods for redrawing boundaries of nuclei: polygon segmentation and ellipse segmentation. Polygon segmentation allows an investigator to manually select points around the nucleus to be segmented. The boundary points chosen by the user are not automatically smoothed, therefore accurate boundary segmentation is directly dependent upon the location and the number of chosen points (generally, a greater number of exact boundary points chosen results in more accurate segmentation). The ellipse segmentation allows an investigator to redraw a nuclear boundary by manipulating the size and shape of the boundary selection tool, which is restricted to the shape of ellipse. Generally, segmentation with the ellipse segmentation function is not as accurate to the actual nuclear border as the polygon segmentation function. However, the ellipse segmentation function is useful for quick segmentation studies that are not dependent upon accurate boundary segmentation, such as analysis of inter-probe distances. Finally, FISH Finder exports results of analysis as CVS files, which can be imported into many computer software programs (such as R and Microsoft Excel) for further analysis.
FISH Finder
RESULTSTo evaluate the performance of our adaptive threshold method of segmentation in comparison with a fixed threshold method, we compared FISH Finder with Nemo (). We tested both FISH Finder and Nemo using 64 FISH images containing 84 nuclei from a FISH experiment in which nuclei from mouse embryonic stem cells (ESCs) were stained with DAPI and a single bacterial artificial chromosome (BAC)-derived probe was hybridized to its complimentary DNA sequence withinnuclei. FISH images were acquired using Applied Precision's Delta Vision fluorescent light microscope producing images in the (.dv) format. FISH Finder and Nemo were both tested on a desktop computer running Windows Vista operating system with an Intel Core 2 Quad 2.5 GHz processor. The analysis of each program was conducted using default input parameters and settings. This comparison demonstrates Nemo's inability to accurately segment nuclear boundaries in all tested images in contrast to FISH Finder's high efficiency and accuracy of nuclei segmentation (). To compare the performance of FISH Finder and Nemo, we examined the unedited results of segmentation analysis from each program for the following categories: nuclei Identification, i.e. percentages of nuclei that are precisely identified as valid nuclei to be further analyzed; nuclei accurately segmented, i.e. percentages of nuclei with boundaries accurately segmented and not over-or underestimated; nuclei overestimated, i.e. percentage of nuclei with segmented boundaries larger than actual boundaries determined by eye; nuclei underestimated, i.e. percentage of nuclei with segmented boundaries smaller than actual nuclear boundaries determined by eye; nuclei ignored, i.e. percentage of nuclei that were not identified as valid nuclei to be analyzed; and nuclei adjoined, i.e. percentage of nuclei with adjoining segmented boundaries (). Using the same test image set, we also compared the results of accurate FISH signal identification and rate of false-positive FISH signal identification ().nuclei overestimated and nuclei adjoined. Additionally, the time required for analysis by FISH Finder was significantly less than that of Nemo, where processing with FISH Finder took 30 min compared with 5 days with Nemo. We next compared the edited results of FISH Finder's analysis to the results of manual analysis of radial positioning. Results from testing Nemo with the image set did not produce enough valid data points in order to fairly quantify and compare graphically. In order to produce valid data to compare, Nemo would require optimization of input parameters for each individual FISH image, in contrast to FISH Finder which does not require user-defined input parameters for automatic segmentation analysis. Using Applied Precision's Softworx program, manual analysis was conducted by measuring distance of each signal to the nuclear boundary as well as measuring the average diameter as judged by eye. The peripheral distances are then computed as a ratio of the average radius for each nucleus to determine the radial distribution of a target locus being studied.shows the cumulative distribution of radial ratios of FISH Finder results and manual analysis revealing a close correspondence. For our analysis, we were unable to fairly compare Nemo's results of image analysis due to the high percentage of inaccurately segmented nuclei as well as the high rate of false signal identification present in the processed image results. In addition to radial position analysis, FISH Finder will also compute the shortest distance between FISH signals of alternate fluorescent staining (). To compare FISH Finder's analysis of inter-probe distances to manual measurements, we analyzed twodetermined the distances between loci preserving organizational trends observed by manual data collection. FISH Finder was developed using FISH images acquired from experiments on ESCs from the species Mus musculus, which has an unusual distribution of heterogeneously compacted DNA revealing regions of dense and loose compacted DNA when stained with DAPI. In fact, FISH Finder was used to objectively analyze FISH experiments in a study of the effects of the histone methyltransferase G9a on the subnuclear position of seven genes (). To confirm FISH Finder's potential for application to othercell types or species as well as 2D and 3D FISH analysis, here we show in all cases nuclei segmented accurately to the edge of DAPI staining for 2D-fixed Chinese Hamster ovary (CHO) cells, 2D-fixed C127 mouse fibroblasts cells, 2D-fixed human lymphoblast cells with acute lymphoblastic leukemia (ALL) and 3D-fixed mouse ESCs (). We have also attempted to systematically compare FISH Finder with a tool proposed by. Since this tool was designed to analyze images collected at lower magnification containing a high density of aggregated cells, whereas FISH Finder was designed to analyze well separated cells at higher magnification, Page: 938 933938
J.W.Shirley et al.it was not possible to make a fair comparison of the performance of these programs.
CONCLUSIONFISH Finder is an important analysis tool capable of automatically extracting nuclear boundaries via compound Bayesian classifier, localizing FISH signals and saving data in the CVS format for future reference, significantly enhancing investigators' ability to verify data. Consequently, FISH Finder minimizes errors due to manual FISH analysis by reducing the cognitive bias of an investigators' judgmental process. More importantly, FISH Finder is a highly efficient user-friendly software tool capable of high-throughput FISH image analysis. The functionality of FISH Finder can be enhanced and extended in several ways. For example, it can be generalized to segment cell nuclei in three dimensions: one way is to segment the images in a Z-stack one by one; the resulting segmentation can then be combined into 3D models of nuclei by interpolating signed distance functions to the segmented nuclear boundaries. With 3D models, the distance from FISH probes to the nuclear boundary in the 3D space can be computed, leading to biologically more accurate results. While most biologists prefer using familiar tools for the analysis, common analysis tools can be readily incorporated into FISH Finder itself. Additionally, FISH Finder can be modified and adapted to analyze other fluorescent signal types such as chromosome territories or identification of doublets and singlets for replication timing analysis or identification of more than two FISH signals for evaluating aneuploidy. We have included a 'New Issues' tab on the program download web page where users can start a forum for problems or suggestions. While FISH Finder produces satisfactory results on all datasets we have used, it is based on a discriminative model, even though it is more robust and accurate than some other systems by employing a contextual classifier via compound Bayesian classifier. A fundamentally different approach is to adopt a generative modelbased approach (e.g.), that is, a model that can explain the observed pixel patterns. One such a model would be a parametric description of each nucleus and the number of nuclei in an image; for example, for the image shown in, an ideal result would consist of five nuclei with different shapes. Intrinsic advantages of a generative model would allow 3D measurements within a nucleus as well as modeling of interactions among nuclei, leading to more accurate results even when multiple nuclei are very close to each other. This is being investigated.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
The core component of FISH Finder is the automated nucleus segmentation algorithm, which requires no adjustment of segmentation parameters by an investigator. Instead of relying on a threshold-based segmentation algorithm, the problem is posed as a two-class classification problem. First, FISH Finder selects the most in-focus image using the DAPI staining channel from the image stack; this is usually the image with the highest overall intensity. Next, FISH Finder estimates the conditional probability distributions for the background and the foreground (i.e. the nuclei) pixel value distributions (i.e. the histogram of the DAPI-stained image), similar to threshold-based methods. However, classification based on the initial estimated probability distributions by thresholding is not sufficient to handle significant variations within cells and between experiments. To be robust and reliable, we use a compound Bayesian classifier to enhance the classification accuracy (Duda et al., 2000). The key difference between a threshold-based method and component Bayesian classifier is that the result from the former depends only the pixel value itself, while the result from the latter depends not only the pixel value itself, but also the values in a predefined neighborhood of surrounding pixels. In other words, the compound Bayesian classifier incorporates contextual information of pixels to be classified. Especially when variations within nuclei and in background are large, the contextual information is a key factor for more robust and accurate results. Additionally, FISH Finder iteratively re-estimates the class-conditional probability distributions based on the current classification to improve the classificationand therefore boundary accuracyuntil the improvement is not significant. Importantly, this entire process is shape independent. After segmentation through classification, FISH Finder extracts the nuclear boundaries. These boundaries are then analyzed automatically to detect incomplete nuclei. For example, if any nuclear boundary contains 20% (as set by default) or more pixels on the image boundary, then FISH Finder will consider that nucleus to be incomplete and it will not be analyzed. In cases where multiple nuclei merge together these can be manually segmented (discussed below) or can be ignored. To alleviate false segmentation of fluorescent nuclear debris occasionally seen in FISH images, the minimum cell size parameter can be optimized in FISH Finder's input window (note: the default setting of this adjustable parameter was determined during design and development of FISH Finder). For best results of segmentation with FISH Finder, we recommend that investigators analyze images of stained nuclei at a concentration in which cells are not overly clumped together.
