Motivation: Both gene expression levels (GEs) and copy number alterations (CNAs) have important biological implications. GEs are partly regulated by CNAs, and much effort has been devoted to understanding their relations. The regulation analysis is challenging with one gene expression possibly regulated by multiple CNAs and one CNA potentially regulating the expressions of multiple genes. The correlations among GEs and among CNAs make the analysis even more complicated. The existing methods have limitations and cannot comprehensively describe the regulation. Results: A sparse double Laplacian shrinkage method is developed. It jointly models the effects of multiple CNAs on multiple GEs. Penalization is adopted to achieve sparsity and identify the regulation relationships. Network adjacency is computed to describe the interconnections among GEs and among CNAs. Two Laplacian shrinkage penalties are imposed to accommodate the network adjacency measures. Simulation shows that the proposed method outperforms the competing alternatives with more accurate marker identification. The Cancer Genome Atlas data are analysed to further demonstrate advantages of the proposed method. Availability and implementation: R code is available at
IntroductionBoth gene expression levels (GEs) and copy number alterations (CNAs) have important biological implications. GEs are partly regulated by CNAs (). In the recent multidimensional studies, GE and CNA measurements have been collected on the same subjects, making it possible to study their regulation relationships (). Analysing the regulation of GE by CNA is challenging. In general, a CNA is positively associated with the expression level of its corresponding gene. Multiple studies have conducted bivariate analysis and focused on the dependence between a GE and its corresponding CNA. For example,proposed a procedure based on a modified correlation coefficient to search for driver genes of which both GEs and CNAs display strong equally directed abnormalities.). Thus, if we consider a regression framework, it should be multiple GEs against multiple CNAs. As we need to search for the regulation relationships among a large number of GEs and CNAs, with the often low sample sizes, regularized estimation and marker selection are needed. The analysis gets more complicated with correlations among GEs and among CNAs. Specifically, high correlations among CNAs have been observed in both coding and non-coding regions (). Co-regulated genes can have highly correlated expression levels. Recent studies under simpler settings have shown that accounting for correlations is critical for analysing genetic data (). A few studies have addressed the correlations among measurements. For example, Kim et al.(2009) developed the graph-guided fused Lasso method to address the dependency structure among responses.proposed the remMap method to identify master CNAs which affect most GEs. A common limitation of these studies is that correlation is only accounted for in one side of the regression model, and hence the analysis is not 'complete'. In addition, ineffective estimation approaches have been adopted. The goal of this study is to more effectively analyse GE and CNA data so as to better understand their relationships. To account for the fact that multiple CNAs can affect the expression level of a gene, we simultaneously model the joint effects of multiple CNAs. For the identification of important CNAs associated with a GE, an effective penalization approach is adopted. The most significant advancement is that networks are adopted to describe the correlations among GEs and among CNAs. When the correlations among GEs are taken into consideration, the analysis becomes a 'multiple GEs against multiple CNAs' regression problem. That is, both the responses and predictors are highdimensional. To accommodate the network structures, we propose a sparse double Laplacian shrinkage (SDLS) approach, which combines the power of penalized variable selection and Laplacian shrinkage. To the best of our knowledge, this study is the first to effectively accommodate correlations in both sides of the GE-CNA regression. It is noted that although our analysis focuses on GEs and CNAs, the proposed method is potentially applicable to other types of genetic measurements.
Data and model settingsConsider a dataset with n iid samples, each with m GE and p CNA measurements. Let Y  y 1 ;. .. ; y m  be the n  m matrix of GEs and X  X 1 ;. .. ; X p  be the n  p matrix of CNAs. We first process data so that the GEs are centered and the CNAs are centered and standardized with jjX j jj 2 2  n; j  1;. .. ; p. Although it is possible that CNAs regulate GEs in a non-linear way, non-linear modeling incurs prohibitively high computational cost, and the dominating majority of existing studies have focused on linear modeling. Consider the multivariate regression modelwhere e k s are the error terms, and b k  b k 1 ;. .. ; b k p  > is the regression coefficient vector associated with the kth gene. The p  m regression coefficient matrix is b  b 1 ;. .. ; b m   b 1 ;. .. ; b p  > .The expression level of a gene is regulated by at most a few CNAs, and one CNA affects at most a few GE levels. Thus, b is sparse.
Penalized identificationUnder the sparsity condition, we use penalization for estimation and identification of important associations. Consider the estimate ^ b  arg minwhere P is the penalty function, and k; c are parameters that define the penalty. A non-zero component of ^ b indicates an association between the corresponding CNA and GE. For the penalty function, first consider the MCP (minimax concave penalization;), where the penaltywith qt; k; c  k  jtj 0 1  x ck   dx. k is the tuning parameter, and c is the regularization parameter. The MCP has been shown to have performance comparable to or better than many other penalties including Lasso, adaptive Lasso and SCAD (). It conducts marker selection and regularized estimation but does not have a 'built-in' mechanism to accommodate correlations. Note that imposing P 0 is equivalent to analysing each GE separately but with the same tuning parameter for all GEs to ensure comparability.
Sparse double Laplacian shrinkage
Construction of network adjacency measuresGEs (CNAs) are 'connected' to each other. In this study, we adopt a network approach to describe the interconnections among GEs and among CNAs. In a network, a node corresponds to a GE or a CNA. A network contains rich information. Of special importance to this study is the adjacency, which is one of the most important network measures and quantifies how 'closely' two nodes are connected to each other (). Denote r ij as the Pearson's correlation coefficient between nodes i and j. Other similarity measures such as the Spearman's correlation can also be used. Based on r ij ,proposed several ways of constructing the adjacency matrix, whose (i, j)th element is a ij , the adjacency between nodes i and j. Notable examples include (i) a ij  sgnr ij Ifjr ij j > rg, where r is the cutoff calculated from the Fisher transformation (); (ii) a ij  r ij Ifjr ij j > rg; (iii) a ij  r a ij Ifjr ij j > rg, and (iv) a ij  r a ij. In (iii) and (iv), a is determined using the scale-free topology criterion (). We acknowledge that other approaches, for example the Gaussian graphical model (), can also be used to construct the adjacency matrix. As our goal is to demonstrate the incorporation of adjacency not to compare different constructions of adjacency, we focus on (iii) with a  5. Compared with the Gaussian graphical model and others, this construction has ignorable computational cost. The resulted adjacency matrix is sparse and easy to manipulate. a  5 ensures that a ij has the same sign as r ij. Note that it is straightforward to implement other adjacency measures. We compute the adjacency measures for GEs and CNAs in the same manner. Denote A  a ij ; 1 i; j p and B  b kl ; 1 k; l m as the adjacency matrices for CNAs and GEs respectively.
Penalized estimation and identificationConsider the penalized estimation framework specified in (2). We propose the SDLS penalty Pb; k; c  P 0 b; k 1 ; ck  k 1 ; k 2 ; k 3  is the vector of tuning parameters. sgn is the sign function. This penalty has been motivated by the following considerations. P 0  conducts selection using MCP, as described in Section 2.1. Two Laplacian type penalties () are introduced. Consider for example CNAs. If two CNAs are not connected with a ij  0, then the Laplacian penalty is equal to zero. If two CNAs have a large positive a ij , then they are tightly connected and have highly correlated measurements. The Laplacian penalty encourages their regression coefficients to be similar, with the degree of similarity adjusted by the degree of adjacency ja ij j. If two CNAs have a large negative a ij , then the Laplacian penalty has a form similar to ridge penalty, which conducts regularized estimation and shrinks the magnitudes of both regression coefficients. Similar rationale holds for GEs. If two GEs are tightly connected in a network, then their regression coefficient profiles should be similar. The first Laplacian penalty corresponds to the rows of the coefficient matrix, and the second corresponds to the columns. Each element of the coefficient matrix is possibly included in multiple penalties. k is adjusted data-dependently to avoid over-shrinkage. The two Laplacian penalties take quadratic forms and can be associated with the Laplacians for undirected weighted graphs. Take the first Laplacian penalty as an example. Let D  diagd 1 ;. .. ; d p , where d i  P p j1 ja ij j. We can rewritewhere L  D  A. The matrix L is associated with a labeled weighted graph G  V; E with the vertex set V  f1;. .. ; pg and edge set E  fj; k : j; k 2 V  Vg. It has been referred to as the Laplacian of G ().
ComputationWith the introduction of two Laplacian penalties, the existing algorithms are not directly applicable. We propose a two-layer coordinate descent (CD) algorithm. It optimizes with respect to one element of b at a time and cycles through all elements. Iterations are repeated until convergence. In this algorithm, the key is the update with respect to each element. Consider the overall objective function defined in (2). For k  1;. .. ; m and j  1;. .. ; p, given the parameters b k j (j 6  i) fixed at their current estimates, we seek to minimize the penalized objective function with respect to b k i. Here only terms involving b k i matter. This is equivalent to minimizingwhere c is a term free of b k i. The subscript ' i' denotes the remaining elements after the ith is removed. Let t k i  y k  X i b k i. u k i ; v k i , and w k i are defined asIt can be shown that the minimizer of Rb k i  in (6) isWith a fixed k, the two-layer CD algorithm proceeds as follows.; 8: end for 9: end for 10: s  s  1; 11: until the ' 2 difference between two consecutive estimates is smaller than a predefined threshold. 12: return the estimate of b at convergence. In the penalized objective function, the least squares loss function and two Laplacian penalties have quadratic forms. P 0 is the sum of mp terms, with one for each component of b. Following Breheny and Huang (2011), the CD algorithm converges to the coordinate-wise minimum, which is also a stationary point. In our numerical study, convergence is achieved for all simulated and real data. The SDLS method involves three tuning parameters k 1 ; k 2 ; k 3 and regularization parameter c. For c, Breheny and Huang (2011) and Zhang (2010) suggest examining a small number of values (for example, 1.8, 3, 6 and 10) or fixing its value. In our numeric study, we find that the results are not sensitive to c and set c  6. In practice, one may need to experiment with multiple c values, examine the sensitivity of estimates and select using data-dependent methods.
SimulationTo mimic GE and CNA data in a pathway, we consider the scenario with m; p  200 200. The proposed method is applicable to whole-genome data with a higher dimension. However, since the main objective is to accommodate interconnections among GEs and CNAs, it is reasonable to focus on a pathway, as genes within the same pathway are more likely to be co-regulated and have correlated measurements while genes in different pathways tend to be functionally and statistically uncorrelated. In the next section, we analyse The Cancer Genome Atlas (TCGA) data. In Supplementary, we show the histograms of processed CNA values for two randomly chosen genes. Motivated by, we simulate CNAs as a mixture of two normal distributions, one with a small and the other with a large variance. Both distributions have mean zero. For each normal distribution, we consider two correlation structures: (i) the block structure. CNAs belong to clusters. Those in different clusters are independent, while those in the same cluster have correlation coefficient q 1 ; and (ii) the auto-regressive (AR) structure. CNAs i and j within the same cluster have correlation coefficient q jijj 1. For both structures, there are 40 clusters, with 5 CNAs per cluster. CNA measurements take discrete values, and for whole-genome data, they often have a block-wise constant structure. The simulated data have a continuous distribution, which has been motivated by the processed TCGA data (Supplementary). In addition, the block-wise constant structure is not obvious when we focus on a pathway, as genes within the same pathway are not necessarily physically nearby. We generate the sparse coefficient matrix b as having a block diagonal structurewhere  denotes the element-wise product. W t and K t have dimension 5  5 for t  1;. .. ; 40. K t has entries with independent Bernoulli draws with a success probability of 0.8. W t is the effect size matrix with each entry independently drawn from a uniform distribution. Consider the following two examples.For both examples, we expect that there are a total of 20  5  5  0:8  400 true positives (20 clusters; 5  5 elements per cluster; and 0.8 probability of being non-zero for each element). The random errors are generated independently from N0; 0:5 2  ARq 2 , reflecting the fact that GEs are also regulated by other mechanisms, for example methylation, which can lead to further correlation. The GE values are generated from the linear regression model (1). In addition, to examine whether performance of the proposed method depends on the number of true positives, we also simulate two examples with 40 true positives. We analyse the simulated data using the SDLS method (which is also referred to as P GC , with Laplacian penalties on both 'G' and 'C'). In addition, we also consider (i) a marginal approach. This approach conducts the regression of one GE on one CNA. The P-values from all pairs are pooled, and then an FDR (false discovery rate;) approach with target FDR  0.05 is applied to identify important associations. (ii) P 0 , which is the proposed method with k 2  k 3  0. (iii) P C , which is the proposed method with k 3  0. It accommodates the network structure and so correlations among CNAs but not GEs. And (iv) P G , which is the proposed method with k 2  0. It accommodates the network structure and so correlations among GEs but not CNAs. We acknowledge that multiple methods can be used to analyse the simulated data. The first approach conducts the popular 'one GE against one CNA' analysis, and the last three have a penalization framework closest to the proposed and can establish the value of accounting for correlations among both GEs and CNAs in the most direct way. The identification performance is evaluated using the number of true positives (TP) and false positives (FP). In addition, we also measure prediction performance using the model error (ME), which is defined as ME ^ b; b  tr ^ b  b > R ^ b  b. Note that the marginal approach does not generate model errors. Simulation suggests the proposed method is computationally affordable. For example, for one data replicate under Example 1, P GC takes 445.3 seconds on a regular desktop. In comparison, P 0 , P C and P G take 50.0, 116.5 and 194.9 s, respectively. Summary statistics for Example 1 and 2 with 400 expected true positives are shown in Tables 1 and 2, respectively. Those with 40 expected true positives are shown in Supplementary Tables S4 and S5, respectively. Simulation suggests that the marginal approach is in general inferior. With weak correlations, it identifies fewer true positives. When there are strong correlations, it can have satisfactory performance in terms of true positives, however, at the price of a huge number of false positives. We have experimented with adjusting the target FDR value so that the number of true positives is comparable to that of the proposed method and found that the marginal approach has significantly more false positives (results omitted). For the penalization methods, when CNAs and GEs are only weakly correlated, performance of different methods is similar. For example, inwith the AR correlation structure and q 1 ; q 2   0:1; 0:1, the four penalization methods identify 385.6 (P 0 ), 385.5 (P C ), 388.2 (P G ) and 388.3 (P GC ) true positives, with 26.4, 25.9, 23.7 and 24.2 false positives, respectively. In addition, the prediction performance is also similar. However, when there exist moderate to strong correlations, the advantage of proposed method becomes obvious. For example inwith the AR correlation structure and q 1 ; q 2   0:5; 0:1, P 0 identifies 384.2 true positives, whereas P CG identifies 396.9 true positives, at the price of a few more false positives. When q 1 ; q 2   0:9; 0:9, P 0 only identifies 148.8 true positives, in comparison to 335.3 of P GC. In addition, P GC also has better prediction performance with ME equal to 8.00, compared to 38.13 of P 0. The block correlation structure andshow similar patterns. Supplementary Tables S4 and S5 suggest that the proposed method also has superior performance when there are 40 expected true positives.The inferior performance of the marginal approach is as expected, as a GE is jointly affected by multiple CNAs while the marginal approach analyses only one CNA at a time. It is interesting to note that the proposed P GC outperforms or is comparable to P 0 across the whole spectrum of simulation with different correlation structures. Thus it can be 'safe' to use it in practice when the true correlation structure is unknown. With weak correlations, P GC and P 0 perform similarly. P GC targets taking advantage of the interconnections among CNAs and GEs. When such interconnections are weak or do not exist, P GC cannot improve much over P 0. It is also observed that after accounting for the network structure of CNAs, accounting for that of GEs leads to small improvement. This is also reasonable as in the simulated data, the interconnections among GEs are largely caused by those among CNAs. However, as we do observe moderate improvement of P GC over P C under multiple scenarios, it is sensible to account for both networks. P GC may lead to a few more false positives, as the newly added Laplacian penalties have a squared form, are dense penalties, and tend to 'pull' zero coefficients towards correlated important ones. In the simulated examples, the block sizes are equal. We have also experimented with unequal sizes and found comparable results (details omitted).
Data analysisWe first analyse the TCGA (http://cancergenome.nih.gov/) data on glioblastoma (GBM). GE and CNA measurements are available on 479 patients. We download and analyse the processed level 3 data. The GE measurements were originally generated using the customAgilent 244K array platforms. The analysed data are the robust Z-scores, which are lowess-normalized, log-transformed, and median-centered version of gene expression data that take into account all of the gene expression arrays under consideration. The measurement determines whether a gene is up-or down-regulated relative to the reference population. The CNA measurements were originally generated using the Affymetrix SNP6.0 platforms. The loss and gain levels of copy number changes have been identified using the segmentation analysis and GISTIC algorithm and expressed in the form of log2 ratio of a sample versus the reference intensity. We analyse the apoptosis pathway. The set of genes is identified from Gene Ontology (GO) using the annotation package in GSEA (http://www.broadinstitute.org/gsea). Apoptosis is a regulated cellular suicide mechanism by which cells undergo death to control cell proliferation or in response to DNA damage. The apoptosis pathway is a hallmark of cancer (). For the GBM data, there are 298 GEs and 338 CNAs in this pathway.contains the heatmaps of the correlation coefficient matrices for both CNAs and GEs, after reordering the variables based on the hierarchical clustering so that highly correlated CNAs and GEs are clustered with block structures along the diagonal. The two plots show several blocks representing densely connected subgraphs for CNAs and GEs. The subgraphs for CNAs are further shown in.Beyond the marginal and four penalization methods as described in simulation, we also consider P uni , which regresses one GE on all CNAs at a time and applies penalized selection. For all penalization methods, the tuning parameters are selected using V-fold cross validation. For the 298  338 regression coefficient matrix b, 2747 (marginal), 3022 (P uni ), 2662 (P GC ), 1736 (P 0 ), 2206 (P C ) and 1917 (P G ) non-zero elements are identified. Different methods identify different sets of associations. For example, there are only 104 overlaps between the marginal approach and P GC. For P GC and P 0 , we show inthe positions of non-zero regression coefficients (represented by red pixels). The rows and columns have been rearranged corresponding to the upper panels of. Corresponding results under P uni are provided in Supplementary Appendix. More details on the other methods are available from the authors. P GC identifies more non-zero elements than P 0 , P C and P G , which is in line with the observations made in simulation. When more closely examining the identified CNAs, we find that several critical genes, including IFNB1, HIPK3, CASP3, TIAL1, MAP3K10, VEGFA and CDKN2A, have been associated with quite a few GEs. P GC employs Laplacian penalties, which encourage the similarity of regression coefficients. We evaluate the similarity of columns of the regression coefficient matrix. We sum over the off-diagonal elements in the correlation matrices of regression coefficients, and obtain 399.2 for P GC , 357.7 for P 0 and 177.5 for P uni , which suggests a higher level of similarity for P GC. As a representative example, we also take a closer look at the PTEN gene. PTEN acts as a tumor suppressor through the action of its phosphatase protein product. This phosphatase is involved in the regulation of cell cycle, preventing cells from growing and dividing too rapidly. The identified CNAs and their estimated regression coefficients are shown in. Under the five penalization methods, CNA PTEN has positive regression coefficients, and their magnitudes are the largest. However, the marginal approach misses this CNA. P GC identifies the most CNAs. Our analysis suggests that the expression of PTEN is associated with not only its corresponding CNA but also a few others. In, we also show the CNAs identified using different methods with respect to the subgraphs. For P GC , five subgraphs contain at least two identified CNAs. In contrast, P 0 identifies one such subgraph, and P uni identifies none (Supplementary Appendix). The apoptosis pathway is cancer related. In Supplementary Appendix, we also conduct two additional analyses which may serve as 'negative controls'. In the first set of analysis, we analyse the cellular localization pathway in the GBM data. The cellular localization pathway is biologically important. However, there is no evidence that it is associated with GBM or other cancers. In the second set of analysis, we analyse the gluconeogenesis pathway in the TCGA LIHC (liver hepatocellular carcinoma) data. The biological process regulated by this pathway is specific to liver and kidney in mammals. Detailed results are presented in Supplementary Appendix. The overall conclusions are similar to those drawn for the apoptosis pathway. In our analyses, we focus on specific pathways, with the expectation that different pathways have different biological functions. Some genes belong to multiple pathways. For such genes, analysing them in different pathways will lead to different sets of identified CNAs. One way to solve this problem is to expand the proposed analysis to multiple pathways, which may lead to increased computational cost.
DiscussionMultiple types of genetic, epigenetic, and genomic changes can happen on the human genome. It is important to understand their relationships. Using GE and CNA as an example, we have developed aSDLS method. This method uses effective penalization for marker selection and regularized estimation. Significantly advancing from the existing studies, it adopts two Laplacian penalties to accommodate the interconnections among GEs and among CNAs. It has an intuitive formulation and can be realized using an efficient CD algorithm. Simulations show that it has comparable performance as the alternatives when there are only weak correlations among GEs and CNAs. However with moderate to strong correlations, as has been commonly observed in practical data, it has significantly better identification and prediction performance. In data analyses, it identifies associations different from those using the alternatives. The estimated regression coefficient matrix has a higher level of row and column similarity. Manually examining the analysis results for a few representative genes suggests reasonable analysis results. To better accommodate finer data structures, the proposed method introduces new penalties with new tunings. The computational cost is thus higher than the alternatives, which is the price paid for better modeling data. However, as the Laplacian penalties are differentiable, the computational complexity is acceptable. To reduce computational cost, one may set k 2  k 3 , resulting in only two tunings. Our numerical experience suggests that three tuning parameters are also acceptable. As the main objective is to develop the new method, we have adopted only one adjacency measure. We acknowledge that there may exist other perhaps better adjacency measures. However, it is not our goal to compare and draw conclusions on the relative performance of different adjacency measures. Under multiple simulation settings, the proposed method has been shown to be superior. More extensive simulations may be conducted in the future. In data analyses, the proposed method identifies associations different from the alternatives. Simple examinations suggest that the results are reasonable. More extensive analyses are needed to fully validate the findings.For the marginal approach, a '' represents an identified association.
Deciphering the associations between gene expression and copy number alteration
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
X.Shi et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
