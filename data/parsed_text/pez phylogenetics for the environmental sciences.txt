pez is an R package that permits measurement, modelling and simulation of phylogen-etic structure in ecological data. pez contains the first implementation of many methods in R, and aggregates existing data structures and methods into a single, coherent package. Availability and implementation: pez is released under the GPL v3 open-source license, available on the Internet from CRAN (http://cran.r-project.org). The package is under active development, and the authors welcome contributions (see
IntroductionCommunity phylogenetics (or eco-phylogenetics) combines ecology and evolutionary biology, linking ecological phenomena with the evolutionary processes that generate species and their traits (see). This growing field has produced a number of statistical tools and software code to implement them (e.g.), but this code is disparate and handles data differently, making routine data analyses challenging. In many cases, published methods are not formally implemented in a software package and are available only as supplementary materials to papers. Without active (public) maintenance, these valuable techniques are effectively lost to the scientific community. Here, we present the pez R (R Core) package which provides an intuitive framework that merges existing tools and supports the development of the next generation of eco-phylogenetic methods. It is based around an R class (comparative.comm) that links phylogenetic, community, environmental and trait data in a single object. With a comparative.comm object, one can presently calculate over 30 phylogenetic and trait diversity metrics (described in the documentation for pez.metrics), including more than 10 that were previously unavailable in R. pez additionally implements statistical models () to infer the processes that underlie patterns in community phylogenetic and trait data. Users can also perform simulations under various community assembly and evolutionary processes, to help test hypotheses about the structure of biodiversity.). pez integrates and makes use of much existing R code (), and its comparative.comm class is directly compatible with all caper () code, easing comparative analysis of species trait data.
Description
Data manipulation and storage
MetricsFollowing the classification of, pez simplifies the calculation and comparison of over 30 metrics by grouping them into four categories: shape, evenness, dispersion, and dissimilarity. Shape metrics measure the structure of a community phylogeny, while evenness metrics additionally incorporate species abundances. Dispersion metrics are used to examine whether phylogenetic biodiversity in an assemblage differs from the expectation of random assembly from a given set of speciesa species pool. Finally, dissimilarity metrics measure the pairwise difference in phylogenetic biodiversity between assemblages. This classification links directly onto the kind of data the investigator has at hand: assemblage occupancy (shape), assemblage abundance (evenness), source pool (dispersion) and assemblage comparisons (dissimilarity). Other packages (notably picante;) allow for the calculation of some of the metrics contained within pez. pez unifies these metrics with other metrics not previously implemented under a common interface that can be extended to trait and transformed phylogenetic matrices (sensu). For example, pez provides the first implementation of the traitgram framework (), allowing direct comparison of the extent of phylogenetic and functional trait community structure. pez also contains a flexible metric estimation and null-model generation suite (the generic.metric family), that can be used to easily compare different metrics and perhaps generate new dispersion metrics. New null models based around species' trait values (using trait.asm), and expected mean pairwise phylogenetic and trait distances (using ConDivSim) can also be simulated. The speed and ease by which pez allows for the user to compare many metrics is important because different metrics reveal separate aspects of eco-phylogenetic structure ().
Statistical modelspez implements the Cavenderregression framework (fingerprint.regression), and extends it to include more metrics of trait evolution. While community phylogenetics has been criticised for relying on the assumption of niche conservatism to explain ecological assembly (e.g.), this early (yet previously unavailable) approach does not rely on niche conservatism. Instead, it regresses the correlation between species' trait similarity and observed degree of co-occurrence against summary statistics of the evolution of those traits. The approach goes beyond simply describing the phylogenetic or ecological structure of an assemblage, and instead draws links between how traits have evolved and how they play-out in their present-day ecological context. The pglmm family of functions permit regression modelling of community () and interaction network data () using the Phylogenetic Generalised Linear Mixed Model (PGLMM) framework. PGLMMs permit tests of the mechanisms that underlie ecological and evolutionary structure in multiple communities. By fitting random effect terms that account for phylogenetic and trait co-variance, the user can statistically estimate how likely similar and dissimilar species are to (co-)occur as a function of their traits, environmental conditions, and the presence of interacting species.
SimulationsHypothesis testing and the development of new eco-phylogenetic methods require simulation of data under known conditions, and pez contains functions to facilitate this. The scape family of functions (following Helmus and Ives, 2012) simulate species' distributions across environmental gradients. Species' environmental tolerances, range size and negative species interactions can be simulated to contain phylogenetic signal and generate patterns of phylogenetic structure at different spatial scales. The sim.meta.phy.comm family of functions simulate phylogeny, trait evolution and assemblage structure simultaneously across a landscape. Species' abundances across the landscape are proportional to the fit of each species' trait value to the conditions in each assemblage, and individuals migrate at random across the landscape. The sim.meta.phy.comm functions do not require the user to specify a phylogeny, and combined with the phy.sim family, provide a toolkit for the development of new simulation scenarios.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
