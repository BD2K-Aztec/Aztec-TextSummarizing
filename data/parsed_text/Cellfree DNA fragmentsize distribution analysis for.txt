Background: Non-invasive detection of aneuploidies in a fetal genome through analysis of cell-free DNA circulating in the maternal plasma is becoming a routine clinical test. Such tests, which rely on analyzing the read coverage or the allelic ratios at single-nucleotide polymorphism (SNP) loci, are not sensitive enough for smaller sub-chromosomal abnormalities due to sequencing biases and paucity of SNPs in a genome. Results: We have developed an alternative framework for identifying sub-chromosomal copy number variations in a fetal genome. This framework relies on the size distribution of fragments in a sample, as fetal-origin fragments tend to be smaller than those of maternal origin. By analyzing the local distribution of the cell-free DNA fragment sizes in each region, our method allows for the identification of sub-megabase CNVs, even in the absence of SNP positions. To evaluate the accuracy of our method, we used a plasma sample with the fetal fraction of 13%, down-sampled it to samples with coverage of 10X–40X and simulated samples with CNVs based on it. Our method had a perfect accuracy (both specificity and sensitivity) for detecting 5 Mb CNVs, and after reducing the fetal fraction (to 11%, 9% and 7%), it could correctly identify 98.82–100% of the 5 Mb CNVs and had a true-negative rate of 95.29–99.76%. Availability and implementation: Our source code is available on GitHub at https://github.com/ compbio-UofT/FSDA.
IntroductionPrenatal testing for genetic abnormalities (aneuploidies and copy number variations; CNVs) is a routine practice for pregnant women (). Complexities associated with traditional invasive prenatal diagnostic methods, such as chorionic villus sampling or amniocentesis, have led to research for safer non-invasive approaches. After the discovery of fetal cell-free DNA (cfDNA) in maternal plasma (), several studies examined the potential of using fetal cfDNA for non-invasive prenatal testing (NIPT). Their results showed that methods using next-generation sequencing were highly accurate for detecting aneuploidies (), leading to several companies (e.g. Natera, Verinata and Sequenom) offering clinical NIPT today. The two complementary approaches that use fetal cfDNA in plasma for detecting aneuploidies or smaller copy number variations (CNVs) are based on read coverage and single-nucleotide polymorphism (SNP) allelic ratios. In both cases, cfDNA is sequenced using next-generation sequencing technology. While earlier methods have generated this data via whole-genome shotgun sequencing (), more recent approaches oftentarget only the chromosomes or regions of interest to reduce the cost of sequencing (). In methods that rely on coverage, the copy count of chromosomes (for aneuploidies) and regions (for smaller CNVs) are predicted by comparing the proportion of fragments that align to the target compared to a set of controls. An orthogonal information source is the allelic ratios observed at SNP loci. Even though fetal-origin DNA is only a small fraction of total cfDNA [fetal fraction, also called the fetal content, is typically 612% depending on gestation age and maternal weight (, the presence of extra copies of fetal chromosomes changes the observed frequencies of the alleles at the SNP positions. While the change may be imperceptible at a single locus due to low fetal fraction, incorporating several SNPs can allow for accurate prediction of aneuploidies. For example,proposed a Bayesian maximum-likelihood method that uses allele counts at SNP loci together with genotype information of the parents to predict copy count in target chromosomes. In a recent article, we demonstrated that the information provided by allelic ratios and coverage approaches is complementary and can be unified within a single probabilistic framework, e.g. using hidden Markov models (). There are multiple issues which complicate the use of coverage and allelic ratios to uncover CNVs. There are significant number of known (e.g. GC content) and unknown biases that affect the coverage. Such biases are especially prominent in smaller regions, and extensive control datasets are required to fully model them. Allelic ratios at SNPs, while less affected by biases, are available only in a small fraction of the genome. Furthermore, they are not uniformly distributed across the genome, leading to 'blind spots' in the analysis. Finally, in some cases, analysis of such SNP sites requires the presence of a paternal sample, which is often not readily available. Several studies have shown that fetal-and maternal-origin cfDNA have distinct size distributions.first reported this by using amplicons of different sizes in a panel of quantitative polymerase chain reaction assays. Their results showed that fetal fragments are generally shorter than maternal ones. This result was confirmed bythrough high-throughput pairedend sequencing of the plasma. In a recent study,have used fragment-size distributions to predict aneuploidies using microchip-based capillary electrophoresis. However, their method is unable to detect shorter CNVs as it considers the fragment-size distribution of the whole genome rather than specific regions, and different regions can have different distributions due to epigenetic factors such as the position of nucleosomes (). In this work, we develop a novel method for identifying subchromosomal CNVs in a fetal genome from cfDNA fragment-size information. For a given target region, the method identifies a set of 'control' regions with similar fragment-size distribution characteristics and utilizes this set of controls for predicting the fetal copy number in the target region. We test our methods on multiple sets of simulated data and show that our method is able to identify submegabase CNVs with high accuracy, which increases with the fetal DNA fraction, depth of sequencing and length of CNVs being predicted.
Methods
OverviewThe fragment-size distribution analysis (FSDA) method is summarized in the following five steps. The underlying probabilistic model of fragment sizes is explained in Section 2.2, and subsequent steps are described in the corresponding sections. For our experiments, we used two cfDNA samples named I1 and G1, which we used as test and reference samples respectively, as explained in Section 2.6. 1. Using the SNP positions listed in dbSNP (), FSDA finds the SNP positions in the test sample where the mother is homozygous (only one maternal allele is observed) and the inherited paternal allele is different from maternal (there is a small fraction of reads with the alternate allele in the sample). The fetal-origin (paternally inherited) fragments at these positions are identified, and the distribution of fetal-origin fragments is estimated empirically from them (, details in Section 2.3). 2. To test CNVs for a specific (target) region of the test genome, the cfDNA fragments in the reference sample that are mapped to the target region are extracted and their size distribution is empirically estimated (, details in Section 2.4). 3. For all other regions of the reference genome, FSDA empirically finds their fragment-size distributions. Then it calculates the distance [KolmogorovSmirnov (KS) statistic] between these distributions and the distribution estimated for the target region in the previous step. The bins with a distance smaller than a prespecified threshold are selected as control bins (, details in Section 2.4). 4. The cfDNA fragments from the test sample that are mapped to the corresponding regions of the control bins are identified and their size distribution is empirically estimated (, details in Section 2.5). 5. Using the fetal distribution estimated in the step 1 and the control distribution estimated in the step 4, the method derives whether the maximum probability of observing the sizes of the test fragments mapped to the target region is achieved directly using the control distribution or with increased/decreased ratio of the fetal distribution. These correspond to the normal and duplication/deletion predictions, respectively (, details in Section 2.5).
Fragment-size model for plasma cfDNAOur prediction method is based on a model of fragment-size distributions for different genomic regions. In this model, for any region reg in the genome, we define D reg s as the probability of observing a cfDNA fragment with size s generated from region reg. Given the origin of a fragment in reg, we also define M reg s and F reg s to be the probability of it having size s, given the fragment is of maternal or fetal origin, respectively.illustrates the fragment-size distribution for I1 cfDNA fragments mapped to chromosome 1, as well as the fragment-size distributions after categorizing these fragments according to their origin (fetal or maternal). In our model we have assumed that the mother has a normal copy count in the target regions where we are predicting the fetal copy count. We define Dn reg as the difference of the fetal copy number in a region reg and the normal copy number (which is equal to two), where Dn reg 2 f1; 0; 1g for deletion, normal and duplication cases, respectively. We also define r as the fetal fraction for regions with normal fetal copy number and r reg as the fetal fraction in the specific region reg. The variables r and r reg have different values if and only if the fetus has an abnormal copy number at reg.describes the variables and the functions that are frequently used throughout this article. Using the notation introduced above, we can
Cell-free DNA FSDAexpress the corresponding probability D reg s of observing a fragment of size s as a mixture of M reg s and F reg s:We can derive r reg based on Dn reg and r as following:In the fraction above, the numerator corresponds to the fetal cfDNA and the denominator corresponds to the total cfDNA (including both fetal and maternal). If fetus has a normal copy count, then Dn reg  0 and the numerator and denominator would be r and 1, respectively; hence r reg  r. Each of the two fetal copies in a region with normal copy count account for r 2 of the total cfDNA, thus if Dn reg 6  0, the fraction of added or removed fetal cfDNA is equal to r 2 , which has to be included in both the numerator (fetal cfDNA) and the denominator (total cfDNA).
Estimating pure fetal fragment-size distributionThe pure fetal fragment-size distribution can be estimated by analyzing the read sequences mapped to SNP loci. If the mother is homozygous at a SNP locus and the fetus has inherited a different allele from the father, the fragments which support the fetal-specific allele are all fetal in origin. For our experiments, we found such fragments and empirically estimated their distribution. To reduce possible errors, we only considered the SNPs that have a minor allele frequency of at least 0.01 according to the 1000 genomes project panels (1000 Genomes Project Consortium, 2015). These SNPs can also be used to estimate the fetal fraction r, based on an allele ratio (reference allele count divided by the total allele count) equal to r 2 or 1  r 2 , depending on whether the fetusspecific allele is the reference or the alternative. However, in the following experiments we assume that this ratio is known, using either the previously determined dataset fetal fraction or the parameter used in the simulation (when we simulate data with a different r). While in our model we have allowed region-specific fragmentsize distributions of maternal-origin cfDNA, we simplify our model by assuming that the fetal origin fragments have the same size distribution across all regions of the genome. This simplification is used because it is not feasible to train the fetal distribution over a small region, as the source of a molecule is only known for reads that overlap specific SNPs. This assumption is more tolerable for fetalorigin cfDNA than the maternal-origin ones, because there are considerably fewer fetal-origin cfDNA fragments (typically r < 0.12), thus small differences in fetal distributions will not have a large impact on the combined distribution.
Fetal copy count predictionTo predict the fetal copy number in a particular (target) region of the genome, we designate multiple 'control' regions, selected to have similar fragment-size distributions. We employ the method explained in Section 2.4 to find these controls based on a reference sample and combine all the cfDNA fragments from the test sample mapped to these regions, into one merged control. Denote target the target region for which we want to predict the copy count and ctrl as the merged control region designated for it. Consider the fetal fraction is r and the fetal copy number difference in target is Dn target. Then based on Equations (1) and (2), the probability of observing a fragment with size s at target is as follows:(3). Empirical size distribution of the cfDNA fragments from chromosome 1 of plasma sample I1: for all fragments, pure maternal fragments and pure fetal fragments. To separate the cfDNA fragments based on their origin, we only picked fragments from regions that contain at least one paternal-specific SNP allele (for pure fetal fragments) or at least one maternal-specific SNP allele (for pure maternal fragments) inherited by the fetus. The number of fragments for learning the empirical distributions was 3 million, 2.2 million and 331 000 fragments for plasma, pure maternal and pure fetal distributionsThe probability of a cfDNA mapped to reg, to have a fragment size equal to s M reg s The probability of a maternal origin cfDNA mapped to reg to have a fragment size equal to s F reg s The probability of a fetal origin cfDNA mapped to reg to have a fragment size equal to s Dn reg Difference of the fetal copy number in reg and the normal copy number (Dn reg 2 f1; 0; 1g) T The vector of fragment sizes for the cfDNA fragments mapped to the target regionWe have assumed the controls have a normal copy number (Dn ctrl  0) and they were selected with the criteria of having a fragment-size distribution signature similar to target, thus the following can be concluded:D ctrl s  1  rM target s  rF target sBased on Equations (4) and (5), the fragment-size distribution D target s can be formulated as a mixture of D ctrl s and the pure fetal fragment-size distribution F target s:Denote T as the vector of fragment sizes, for the cfDNA fragments mapped to target. Accordingly, T follows a multinomial distribution with the parameter D target :The fragment sizes in T can be directly computed from the plasma sequencing data, while D target can be derived, as shown in Equation (6), based on D ctrl ; F target , r and Dn target. The distribution D ctrl is empirically estimated from size of the fragments mapped to ctrl, while the pure fetal fragment-size distribution F ctrl and the fetal fraction r, which we have assumed both to be invariable throughout all normal regions in genome, can be estimated by analyzing the reads mapped to the SNP positions across genome, as explained in Section 2.3.illustrates the Bayesian network for our model. We perform maximum-likelihood estimation to estimate Dn target , using the likelihood function pTjDn target ; D ctrl ; F target ; r, which is the probability mass function of the multinomial distribution in Equation (7), and its parameter D target can be derived from the Equation (6). In our experiments, we have considered an uniform prior for Dn target ; however, by using maximum a posteriori estimation instead of maximum-likelihood estimation, a non-uniform prior can be adjusted based on the required sensitivity for the application.
DataWe used the data provided by, retrieved from dbGaP with the accession number 'phs000500.v1.p1'. The dataset includes two different pregnancy cases denoted I1 and G1. For each pregnancy, this includes whole-genome sequencing data of maternal plasma cfDNA as well as whole-genome sequencing data of mother, father and the child after birth. When predicting fetal CNVs, our method solely uses the cfDNA data of the plasma sample alone and does not use the separate sequencing data of the parents or the child. The fetal fractions were reported to be 0.13 and 0.07 for I1 and G1 samples, respectively. In both cases, the fetus was a male. For our experiments, we used G1 as our reference to find the regions with similar fragment-size distributions and ran all of the prediction tests for I1. The data had been obtained by Illumina 100 bp paired-end sequencing and aligned to GRCh37 using BWA-0.6.1 (). The size of a DNA fragment is calculated from the position of the paired reads.
SimulationUsing our original plasma samples, we simulated samples with reduced fetal fractions, reduced coverage and with 'spiked' CNVs in different locations of the genome. Reducing the coverage was done by uniformly down-sampling the fragments to reach the target coverage (10X, 20X and 40X). We simulated samples with reduced fetal fractions to examine how well our method would perform if the fetal fraction was lower than what it really is in our original sample. Consider we intend to reduce the fetal fraction of a sample from r to r 0. If we knew the origin of the cfDNA fragments, we could reduce the fetal fraction by removing the fetal-origin fragments with the following rate:. The percentage of the bins in G1 (from a total of 2230 bins) for different thresholds of the KS value that have at least 1 and less than 5 controls, at least 5 and less than 10 controls and at least 10 controlsHowever, the origin of the cfDNA fragments is not known. As a result, we randomly remove the fragments based on their size, with the probability R plasma r!r 0 s for a fragment of size s:Where pfetaljs is the probability of a fragment with size s belonging to the fetus, which can be derived using Bayes rule:In the above equation psjfetal is the pure fetal fragment-size distribution probability for size s, analogous to F reg s, and pfetal is the prior for fetal fragments in plasma which is the fetal fraction and is analogous to r. Further, p(s) is the prior probability for cfDNA fragment size in plasma, which is empirically estimated by normalizing the count of fragment sizes for cfDNA fragments mapped to the region we are simulating and is analogous to D reg s. We simulate duplications by adding fragment samples drawn from the fetal fragment-size distribution and deletions by reducing the fetal fraction in the intended CNV region.
ResultsIn this section, we evaluate the performance of our method by performing tests using the cfDNA samples I1 and G1. In Section 3.1, we evaluate the performance of our method on cfDNA data with altered fetal fractions, reduced coverages and simulated CNVs of different types and sizes, as well as investigating the effects of choosing different thresholds for control bin selection. In Section 3.2, we compare the performance of our method with our own previous CNV detection algorithm that is based on combined allele ratio and coverage analysis.
Experiments on simulated dataWe tested our method on simulated data with different fetal fractions, from 7% to 13% and at 10X, 20X and 40X coverage. For selecting candidate control bins, we used the KS threshold of 0.003 and required at least one control bin. In each experiment, the target regions included every non-overlapping bin in the genome (excluding the sex chromosomes and the centromeres/telomeres) with the intended size that had at least one valid control bin. The number of these bins were 4368, 2221, 1105 and 425, for 500 kb, 1 Mb, 2 Mb and 5 Mb CNV sizes, respectively. For each target region, we tested for three cases of duplication, deletion and no simulated CNV. The results () show that our method has high recall and precision, especially with higher fetal fractions and larger bins. We also evaluated how using different KS thresholds and requiring multiple control bins affect the accuracy and coverage of the method. We tested this on a simulated sample with 7% fetal fraction, at 20X coverage and with 1 Mb size CNVs. The results () show that at KS threshold of 0.003, there is a significant jump in the fraction of genome for which controls are available, with a slight drop-off in accuracy. Further increasing this threshold has a smaller effect, while accuracy continues dropping.
Comparing with a previous methodWe compared the current FSDA method with our own previous SNP/coverage analysis-based method called 'fCNV' (). Both were tested on down-sampled versions of I1 sample (13% fetal fraction, with depth of coverage of 20X and 40X), using G1 as reference. To compare the sensitivity of fCNV to FSDA, using the simulation tool designed for fCNV we simulated 60 samples with CNVs,. Results of the experiments with different settings and data. The tables are in three main columns, from left to right showing the results for the sample with 10X, 20X and 40X coverage. The three main rows correspond to the type of the simulated CNV in the regions, which from top to bottom are normal (no CNV simulated), duplication and deletion. Inside each table, the columns correspond to the fetal fraction and the rows correspond to the size of the target region. The values inside the cells are the percentages of the correct predictions
Cell-free DNA FSDAincluding 20 deletions and 40 duplications, repeating this for different CNV size settings (500 kb, 1 Mb and 5 Mb). The comparison of the results to FSDA (detailed in Section 3.1) is presented in. As explained in Section 3.1, each experiment for FSDA includes 4368, 2221 or 425 samples, corresponding to the number of available bins with size 500 kb, 1 Mb and 5 Mb. The direct comparison of the specificity of the two methods is difficult because FSDA makes calls independently for each bin, while fCNV makes calls genome wide, which can start at any SNP position. Hence, we evaluate the specificity as the percentage of the genome identified as being part of a CNV of a specific size. On the 20X coverage whole genome with no implanted CNVs, fCNV falsely reported three CNVs of 500 kb and one CNV of 5 Mb; on the 40X coverage genome, five CNVs of 500 kb size and six CNVs of 1 Mb size were reported. To derive the specificity for fCNV, we calculated the false-negative rate as the ratio of the total length of false CNVs (separately for each category) by the total length of the effective input genome (3 Gb). The specificity results for FSDA are calculated as the ratio of bins called as CNV false positives by the total number of available bins (4368, 2221 or 425 depending on the size). The results () show that in all cases the new proposed method (FSDA) highly outperformed fCNV in sensitivity, which has difficulty due to the low sequencing coverage (it was designed for 80X coverage). However, the fCNV had slightly better performance in specificity for 1 Mb and 500 kb cases.
DiscussionIn this work, we introduce a novel method for accurate submegabase CNV prediction based on the fragment-size distribution of the cfDNA in maternal plasma. To overcome the challenge of variability of the cfDNA fragment-size distributions throughout genome, as described in Section 2.4 we noted that the regions that have similar distribution signatures are likely to be similar across different samples. Our method takes advantage of this by using an orthogonal, reference sample to find such regions. Depending on the application, it can be important to have fewer false-positives (calling wrong CNVs) or fewer false-negatives (missing actual CNVs). The prior on the fetal copy number, which we assumed to be uniform in our experiments, can be adjusted to change the CNV calling rate and the sensitivity/specificity trade-off. Our model has several shortcomings, which can be addressed in future work. First, while we model the length distribution based on combination of maternal and fetal genomes, we do not directly model the presence of small scale insertion/deletion (indel) variation, which also impacts the distribution of fragment lengths [see e.g.or CNVs in the maternal sample. While these events are rare and lead to changes of the fragment-length distribution that are different from changes by fetal copy count, they could compromise the accuracy of our method and hence should be modeled directly. The accuracy of our method depends highly on the fetal fraction r, which we assume is known. The estimation of r from real data is straightforward at higher fetal fractions and coverages, based on sites where the mother is homozygous for one allele, and the paternally inherited allele is different. As fetal fraction decreases and coverage falls this becomes harder due to allele dropout, and for coverages lower than 10X, we would need orthogonal methods for identifying such fragments. Effective methods for directly estimating r from NIPT data would improve the robustness of our algorithm. A general weakness of our experiments is in the simulation, where we assume that the size distribution of fetal-origin DNA is uniform across the genome. This makes our simulated data cleaner than a realistic sample. A better simulation framework, or availability of real samples with CNVs, would help the development of new methods in this field.
0.002
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from 2.4 Finding regions with similar fragment-size distribution signatures While different regions in genome may have different fragment-size distribution signatures, our analysis shows that if two regions have similar distributions in one sample, they are likely to also be similar in another one. We use the two-sample KS statistic as a measure of similarity for fragment-size distributions. Our results for two different samples show that there is a linear correlation between the KS statistic of the corresponding pairs, with an estimated slope and intercept of 1.012 and 3  10 4 , respectively (see Fig. 3). We divide the genome (excluding the sex chromosomes and the centromeres/telomeres) into bins of 1 Mb as a set of candidate control regions. Because of the mentioned consistency, we can use a reference plasma sample to find the candidate bins that are more likely to have a similar fragment-size distribution to a target genomic region in a new sample. For this purpose, we use a threshold on the KS statistic to decide which candidate bins are similar enough to the target region. Generally, the lower this threshold is set, the more similar the candidate bins would be to the region, leading to higher accuracy. However, an over-stringent threshold would also cause many regions to have none or very few control bins, thus reducing portion of genome we can make a prediction for (genome coverage). We also add an additional constraint that a control region must be >10 Mb away from the target region, so that they are unlikely to be impacted by same CNVs. Figure 4 shows the percentage of 1 Mb bins in G1, whose number of candidate bins are in specific ranges for different KS statistic thresholds. In our experiments, unless explicitly stated, we used a KS statistic threshold of 0.003, which covers 96.57% of the genome with 1 Mb sized bins.
A.Arbabi et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
