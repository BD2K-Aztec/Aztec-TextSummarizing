Motivation: Wide application of modeling of three-dimensional protein structures in biomedical research motivates developing protein sequence alignment computer tools featuring high alignment accuracy and sensitivity to remotely homologous proteins. In this paper, we aim at improving the quality of alignments between sequence profiles, encoded multiple sequence alignments. Modeling profile contexts, fixed-length profile fragments, is engaged to achieve this goal. Results: We develop a hierarchical Dirichlet process mixture model to describe the distribution of profile contexts, which is able to capture dependencies between amino acids in each context position. The model represents an attempt at modeling profile fragments at several hierarchical levels, within the profile and among profiles. Even modeling unit-length contexts leads to greater improvements than processing 13-length contexts previously. We develop a new profile comparison method, called COMER, integrating the model. A benchmark with three other profile-to-profile comparison methods shows an increase in both sensitivity and alignment quality. Availability and Implementation: COMER is open-source software licensed under the GNU GPLv3, available at https://sourceforge.net/projects/comer.
IntroductionProteins, large molecules, perform a huge number of functions within living organisms. Given that the three-dimensional (3D) structure of a protein determines its function, Structural Genomics centers aim and dominant programs such as the Protein Structure Initiative () aimed at the determination of the 3D structure for most proteins in nature to facilitate understanding of how living organisms function. With increasing coverage of protein fold space (), these efforts are greatly assisted by building protein models by homology to solved 3D structures (). Homology discovery founded on data of solved 3D structures, therefore, constitutes the foundation for homology modeling. Results of the Critical Assessment of Structure Prediction (CASP) experiments () reveal homology search methods as some of the most decisive intermediate means in protein 3D structure prediction. Based on alignments of sequence profiles (generalizations of protein sequence families), these methods (S ding and) can reliably establish homologous relationships even between proteins sharing nearly random (68%) sequence identity. Nevertheless, such relations are remotely homologous and are often missed. Increasing the sensitivity to remotely homologous proteins and the accuracy of alignments is accordingly of great practical importance. To improve the quality of the sequence profile and to obtain the probability distribution of amino acids (residues) more relevant to the sequence family, many efforts were put into the calculation of mutation (substitution) probabilities, including the development of the pseudo-counts (), composition-based statistics () and compositional adjustment () and mixing with many other sequence/structure-derived measures (see, e.g.). The advances in the calculation of substitution probabilities at each profile position have induced more accurate profile alignments and consequently, increased sensitivity to remote homologs (). Despite the apparent progress in developing profile-to-profile comparison methods, some problems remain. Alignment accuracy, one of the most important challenges in homology modeling (), seems to have saturated recently () and further improvements in alignment necessitate. Enhancing the description of substitution probabilities so that the probabilities accurately reflect a structure/sequence environment (context) addresses the problem. Biegert and S ding (2009) showed that generalizing substitution probabilities for each position by mixing them with a library of context profiles has increased the sensitivity of the profile-to-sequence alignment method PSI-BLAST () by more than 64%. The context profiles representative profile fragmentswere not derivatives of structure information but derived from clustering profile fragments. The rationale of using sequence-based contexts was that the profile fragments with different distributions of substitution probabilities could adopt similar local structures. If grouped together, these profile fragments would lose their specificity. Biegert and S ding (2009) modeled the profile fragment by using the product of weighted multinomial probabilities and optimized the substitution probabilities of each context profile with the Expectation Maximization algorithm. In that framework, the number of context profiles is a parameter whose value was found in a homology detection benchmark procedure. In this work, we aim at increasing the sensitivity of profile comparisons and the accuracy of alignments, addressing the issue of profile contexts (Supplementary) from a Bayesian nonparametrics perspective. We propose a hierarchical Dirichlet process mixture model to describe the distribution of profile contexts and apply the inferred mixtures to the problem of protein homology detection. The hierarchical Dirichlet process (HDP) is developed () for model-based clustering of grouped data, where each group is associated with a mixture model. The essential property of the HDP is that it employs a Dirichlet process (DP) for every group of data, where all the DPs share a base distribution which itself is drawn from a Dirichlet process. Such a construction enables sharing of clusters across groups and expresses the property of profiles (sequence families) of sharing common features. Considering profiles as separate groups, the HDP mixture model formalizes the purpose of finding characteristic clusters of contexts within each profile with sharing of the clusters among them. An important feature of the HDP mixture model is that the number of clusters is unknown and is to be inferred from the data in Markov chain Monte Carlo (MCMC) sampling. Overgeneralization of profile contexts leads to signal loss and reduced specificity, and this feature allows to avoid of selecting a particular number of clusters or placing an explicit parametric prior on it. To our knowledge, HDP-based non-parametric Bayesian models to define the distribution of profile contexts or substitution probabilities have not been considered in the literature., though, modeled multiple sequence alignment (MSA) columns with DP Dirichlet mixtures. They specified residue frequencies at single columns by a Dirichlet distribution and inferred the Dirichlet mixtures from MSA data. Although computationally convenient, such a specification has some limitations. One is that a multivariate random variable drawn from a Dirichlet distribution corresponds to a scaled vector of independently distributed gamma random variables. The Dirichlet distribution, therefore, lacks versatility to capture inter-component correlations as illustrated inof the Supplementary Materials. We build the model to handle profile data. The profile generalizes each MSA column with a vector of substitution probabilities, which depending on sequence weighting scheme, embody soft dependencies between adjacent columns. With these properties, substitution probabilities in our setting constitute an observation vector. To control correlations between residues, we model the distribution of substitution probabilities with a logistic-normal distribution (), which follows from the logistic transformation applied to a normal distribution and, to the best of our knowledge, publicly has not been considered to characterize probabilities in profiles. The context (Supplementary) comprises an array of such vectors and is a random variable whose distribution the proposed mixture model describes. The model is valid for contexts of any length. Although, in this work, we confine to the context of one position, Section 5 discusses how the model without any corrections adapts to longer contexts.
Methods
Bayesian mixture modelThis section defines the distribution of profile contexts. Let us consider, without loss of generality (see Section 5 for a discussion of the general case), a context of length one, i.e. consisting of a single vector of substitution probabilities. The positive real-valued substitution probabilities for all 20 residues sum to 1, but only A  19 of them are independent. We assume the A-dimensional vectorof substitution probabilities to be distributed according to a logistic-normal distribution, which is defined on the strictly positive simplex (). The requirement of strictly positive probability values is always met as profile substitution probabilities result from mixing observed residue frequencies with pseudo-counts (). The inverse logistic transformation applied to f ; logf =f A1 , produces a normally distributed variable g  Z 1 ;. .. ; Z A  T. We thus focus on the distribution of the normal variables. Let i indexes each context within a particular profile j, j  1;. .. ; R. Then, profile contexts g ji  Z ji1 ;. .. ; Z jiA  T are assumed to arise as draws from a normal distribution. We place prior distributions on the parameters of the mean vector l ji and covariance matrix R ji of the normal variable g ji. The prior distribution for the covariance matrix R ji is specified as an inverted Wishart distribution with n 0  A  1 (n 0 > A  1) degrees of freedom and scale matrix K 0 , and for the mean vector l ji as a normal distribution with mean vector l 0 and covariance matrix R ji =k 0 scaled by real k 0 > 0: R ji jn 0 ; K 0 $ IW A n 0  A  1; K 0 ; l ji jl 0 ; R ji ; k 0 $ N A l 0 ; R ji =k 0 :The parameter vector h ji  l ji ; R ji  of each profile context g ji can be regarded as being itself a random variable, and their values, in particular, are not necessarily distinct. Commonly, profiles share contexts (local features), including even those representing proteins or their families from different classes. Moreover, similar contexts can appear multiple times within the same profile, and the extent of similar contexts depends on and varies across profiles. To include these properties in our model, we first introduce a prior distribution G j for the parameters h j1 ; h j2 ;. . . of the corresponding context observations g j1 ; g j2 ;. . ., unique to each profile j. We assume that the parameters are conditionally independent given G j , and G j itself is a random probability measure distributed as a Dirichlet process (), DPt 0 ; G 0 , with concentration parameter s 0 and base probability measure G 0 for the parameters h j1 ; h j2 ;. . .. The discrete nature of the G j () allows context sharing within profile j by associating context observations with the same values of the parameters h ji. To permit sharing across profiles, the G 0 is modeled as a global random probability measure also distributed according to a DP with concentration parameter c and base probability measure F. Now, the base measure F provides the prior distribution for the parameters h ji across all profiles. According to this setting, known as the hierarchical Dirichlet process (), the distribution G 0 varies around the prior F and the G j around the G 0 , where the hyperparameters c and s 0 , respectively, control the amount of variability at the two hierarchical levels. Exactly this sharing of the parameter atoms (values) by both the global probability measure G 0 and the distribution G j assigned its own set of weights for those parameters at the profile level (Supplementary), that makes the HDP model different from the corresponding DP model that provides all profiles with a single global set of weights. We show in the simulation study in Section 2.3 that the HDP model significantly outperforms its DP counterpart. Under the assumptions above, we have the following HDP mixture model: G 0 jc; F $ DPc; F; G j jt 0 ; G 0 $ DPt 0 ; G 0 ; h ji jG j $ G j ; g ji jh ji $ N A h ji :As follows from the connection of the DP with a P olya urn scheme (), the probability for h ji to take an already observed value, given all the other random variables fh ji 0 g i 0 6 i and the base measure F, where the G j and G 0 have been integrated out, is proportional to the size of the cluster containing variables with the given value. We have the hierarchical arrangement of the DPs, and the clustering property exhibits at both levels. Consider, first, the top-level DP in (2.2). Let / 1 ;. .. ; / K denote iid random variables corresponding to K distinct values of the parameters fh ji g j;i , distributed according to F. Let also w j1 ;. .. ; w j;mj over all j be a P olya sequence () of random variables with parameter c and probability measure F, where m j is the number of these variables in profile j. Then, the conditional distribution of w jl given fw jl 0 g j;l 0 6 l and F is w jl jfw jl 0 g j;l 0 6 l ; c;where m k is the number of variables w jl 0 that are equal to / k over all j and l 0 6  l; m  (dots represent marginal counts) is the total number of variables over all j and l 0 6  l, and d x denotes the unit measure concentrating at x. The distribution (2.3) corresponds to the distribution w jl $ G 0 ; G 0 $ DPc; F, with G 0 integrated out. Each variable w jl takes on the value / k with probability proportional to m k and takes a new value from F with probability proportional to c (we refer the interested reader to, for a detailed description of the HDP). At the lower level of the DPs, in each profile j individually, we obtain the conditional distribution of the random variable h ji given fh ji 0 g i 0 6 i and G 0 , when G j has been integrated out, concentrated onfor all j, where n jl is the number of variables h ji 0 equal to w jl over all i 0 6  i in profile j, and n j is the total number of variables over all i 0 6  i in profile j. For each j, the variables h ji take on values w jl with probability proportional to n jl and take a new value from G 0 with probability proportional to s 0. Since G 0 is distributed as the toplevel DP, integrating it out gives the conditional distribution ofwhere n jk is the number of variables h ji 0 equal to / k over all i 0 6  i in profile j. Note that m jk is the counter associated with the variables w jl while n jlk with the h ji. Thus, m jk counts the number of local clusters associated with value / k in profile j while n jk records the overall number of h ji in these clusters in profile j. Local clusters are connected across all profiles through sharing the atoms / k that determine global clusters. In other words, according to the model (2.2), profile context observations g ji associated with parameters h ji group into clusters within each profile j, which are mutually connected among all profiles. This scheme of the HDP is equivalent to the Chinese restaurant franchise metaphor presented by Teh et al.Note that the iid variables fh ji g i are exchangeable and hence (2.4) and (2.5) are applicable for all i. We exploit this property in posterior inference.
InferenceLet us introduce the indicator variables f' ji g j;i and fK jl g j;l. The variable ' ji indicates local cluster l in profile j, with which the observation vector g ji is associated: ' ji  j; l implies h ji  w jl. Whereas K jl provides the index k of the global cluster involving local cluster l in profile j: K jl  k implies w jl  / k. Exploiting that the ' ji and K jl exhibit the same exchangeability properties as the corresponding variables h ji and w jl , our MCMC sampling scheme deals with the indicator variables. A single iteration of the posterior sampling algorithm consists of the following steps: 1. Update ' ji for all j and i. 2. Update K jl for all j and l. 3. Perform Metropolis updates repeatedly for a number of times. 4. Update the hyperparameters c, s 0 , j 0 and 0. Section S1 of the Supplementary Materials describes each step in detail, introduces a split-merge algorithm implementing the Metropolis updates in step 3, and presents a parallel MCMC sampling algorithm.
Simulation studySection S2 of the Supplementary Materials investigates the performance of the MCMC sampling procedure defined in Section 2.2. We constructed K  200 distinct clusters each containing n k  200 observations generated from a logistic-normal distribution. We grouped all observations into R  200 groups (profiles), initiated three MCMC sequences initialized with three different starting configurations, and performed convergence diagnostics. The MCMC sequences converged. We obtained a strong correlation between the estimated and true values of the parameters used to generate the data. Section S2 also demonstrates (Supplementary) the advantage of using the HDP mixture model over the corresponding DP mixture model for our experiments. We refer the reader to Section S2 for a detailed discussion of the experiments. the model parameters from the data. Then we apply the model to derive scores to be incorporated into a comparison of profiles. Lastly, we evaluate the effect of the model-derived scores on the sensitivity and alignment quality of the profile-to-profile comparisons. To accomplish all these steps, we developed profile construction and comparison applications which combined the main features of the methods COMA (Margelevi cius and Venclovas, 2010) and HHsearch (S ding, 2005). The features include the profile construction protocol and compositional adjustments of the first method, and transition probabilities in the context of hidden Markov model (HMM) and log-sum-of-odds scoring of the second one. We call the new method COMER (profile COMparER). The first two steps, that is how the profile context data were compiled and the inference process, are described in Section S3.1. We obtained a final set of R  49 332 profiles, where R also corresponds to the number of groups in the HDP mixture model. For each profile j  1;. .. ; R, a number of contexts, proportional to the profile length, were randomly sampled, contributing to a total of n   991 833 distinct observations. We ran the sampler on the data and found a maximum likelihood estimate of the state, c opt , with the number of global clusters K  1260 and the total number of local clusters m   962 446. The distributions of observations in most populated clusters, as expected, approach multivariate normal distributions. Supplementaryrepresents the most populated cluster. We emphasize that clusters are characterized by the parameters of the t-distribution, calculated purely from data (Appendix A.1). No fit of parameters to the data takes place. Note also that the numbers of clusters were inferred from the data. We employ the mixture model corresponding to the state c opt for deriving scores. (State samples around the maximum likelihood state c opt yielded similar results, meaning that c opt is stable with the majority of clusters being of high likelihood [Supplementary)
Derivation of scoresSince our evaluation system (see Section 4) is based on the assessment of the quality of generated protein 3D structural models, we aim at improving the accuracy of profile alignments by deriving the scores from structural information as follows. For each sequence from a subset of protein domains with known 3D structures from the SCOP database () (version 1.71) filtered to 20% sequence identity, we calculated profiles from MSAs obtained by running 2 iterations of HMMER3 () against the UniRef50 () sequence database. For every position of each of 4611 built profiles, the posterior distribution of cluster membership for the context g ? characterizing a single profile position was computed in this way: The posterior probability for g ? to belong to global cluster k is pK ?  kjg ? ; c opt ; H / pK ?  kjc opt pg ? jH k , where K ? is an indicator variable for g ? , H denotes the complete set of observations, H k is a matrix of the observations associated with cluster k, pg ? jH k  represents a t-distribution (see Section S1.1 and Appendix A.2 of the Supplementary Materials), and pK ?  kjc opt  is the prior probability of mixture component k. For n j does not vary greatly across all profiles j, we approximate n j  n  =R and calculate pK ?  kjc opt  by averaging the prior probability of mixture component k over all j. Then, using (2.5), we get (see Section S3.2 for the derivation)where k ? denotes an unrepresented (new) global cluster, and pg ?  is the prior probability of g ? distributed as the t-distribution (S1.7) defined in Section S1.2 of the Supplementary Materials. Note that while (3.1) predicts global cluster membership, the structure of local clusters is taken into account by the variables m jk. Next, the 4611 protein domains were compared all against all with DALI (), a method for pairwise comparison of protein structures. Using only statistically significant matches (DALI Z-score ! 3) of the pairwise structural alignments (duplicate pairs were removed), we derived MSAs for each domain and weighted () sequences within each MSA to reduce redundancy. Having computed by (3.1) the distribution predicting cluster membership for a context for each position of the sequences in the MSAs, we calculated weighted frequencies of cluster pairs that had arisen from the aligned sequences in the MSAs. Each sequence position, though, considered a single cluster determined by arg max v pK ?  vjg ? ; c opt ; H. In addition, to ensure a reliable subset of the data, we analyzed the aligned positions which had paired residues in a structural superposition and predicted clusters with probability at least 0.5. The score of having aligned clusters x and y was then calculated as logf xy  f yx =2g x g y , where f xy is the weighted frequency of occurrence for pair x, y and g x  P y f xy. We thus obtained a K  K score table (see Section S3.3 for more details and discussion of the validation of the scores). The comparison of a pair of profiles employs the score table for each pair of positions of two profiles, considered for producing an alignment, where a pair of cluster indices defined as described above selects an entry from the score table. The selected score is downweighted and is added to the total score used to score a pair of profile positions. We emphasize that while the posterior inference process is computationally intensive, the application of the scores is fast and does not take significant time in profile comparison.
ResultsTo evaluate the efficiency of the derived scores, we performed an extensive comparison of sequence profiles of protein domains. Protein domains served as an evaluation basis for two reasons. First, available 3D domain structures enable to assess reliably the accuracy of profile alignments, a major determinant in protein modeling. Second, domain sequences used to produce profiles reduce the probability of the homologous over-extension error () leading to a deterioration of the quality of profiles. Here, the dataset comprised the protein domains from the SCOPe database () (version 2.03) filtered to 20% sequence identity to challenge remote homology detection. The resulting domains excluding the members of class g of small proteins were divided evenly into training and test set of 4916 and 4915 representatives, respectively. Training set was used to optimize the application parameters (weights) for the score table, while the test set to assess the performance on previously unseen data. Multiple sequence alignments for the construction of profiles for domain sequences from both sets resulted from searching each sequence with PSI-BLAST () (version 2:2:28) using a sequence inclusion threshold of 10 5 and soft masking of) from the I-TASSER software package () and FFAS (). (We wanted to include more state-of-the-art methods into the benchmark, but most of them are designed as internet servers or do not distribute computer utilities to make profiles from user-supplied MSAs.) All the methods except FFAS exploit secondary structure (SS) predictions. The new method COMER and HHsearch incorporated SS predictions obtained by PSIPRED (). Whereas SS predictions calculated by PSSpred from the I-TASSER package accompanied the PPAS sequence profiles. For each method, we constructed profiles using the same set of MSAs, compared the profiles all against all, and evaluated the sensitivity of detecting related protein pairs and the accuracy of the produced alignments. We found that HHsearch performed better with the option of posterior probability threshold for maximum accuracy alignment set to 0.3 (-mact 0.3). The evaluation thus used this option value for HHsearch. In addition, as HHsearch employs 13 length contexts in comparison of profiles, we evaluated the effect of calculating contexts by both methods COMER and HHsearch. Each method was evaluated by considering top-ranked profile alignments sorted by reported their statistical significance. Only one of two alignments between the same pair of different domains, that with higher statistical significance, was retained. Alignments between identical domains were removed.
SensitivityAlthough the SCOPe database used here for the dataset of protein domains classifies domains into the families, superfamilies, folds and classes, we do not trust the classification blindly in our evaluation. Protein domains in SCOP(e) are classified according to the criteria of common evolutionary origin and structural similarity. However, the protein structure space, as a number of studies have shown (see, e.g.), is continuous, meaning that one could expect to discover many relationships between proteins, conflicting with those established in the classification. We thus consider a pair of aligned domains as a correct match (true positive, TP) if the domains belong to the same superfamily or their structural similarity by DALI is statistically significant (Z-score ! 2). Otherwise, the relationship implied by an aligned pair is considered spurious (false positive, FP).shows the number of true positives versus the number of false positives for each evaluated method. The new method COMER at a false discovery rate of 10% detects 103% more related pairs than PPAS, 16% than FFAS and 8% than HHsearch. By a permutation test for unpaired data (), the COMER curve in the figure differs significantly from the curves of the other methods at the 1% level. The scores derived from describing unitlength contexts by the model (2.2) increased the sensitivity of COMER for the top 60 000 alignments by 5.3%. In contrast, for the same amount of top alignments, HHsearch advanced by 2.5% by computing 13length contexts. Additionally, to prevent from any possible misinterpretations related to classifying pairwise alignments as false positives, we considered each aligned pair of structurally dissimilar (DALI Z-score < 2) domains from different superfamilies but from the same fold as being of unknown relationship. Ignoring these 'unknown' relationships ensures that possibly related pairs from the same fold, which by definition groups structurally similar superfamilies, are not wrongly classified as errors. The revised results, shown inof the Supplementary Materials, display no major change in sensitivity for the methods, meaning that among the top profile alignments, there are few aligned pairs belonging to different superfamilies but the same fold and for which DALI Z-score < 2. A more stringent criterion for a true positive, formulated as the requirement for a pair to belong to the same superfamily or to have a DALI Z-score ! 3, produced a similar picture (Supplementary). The first difference, not surprisingly, is that the methods identify up to 20% less true positives. Another change (Supplementary) is that under the alternative consideration of false positives (pairs from the same fold but different superfamilies, with DALI Z-score < 3 are ignored), the relative difference in sensitivity between the methods COMER and HHsearch becomes smaller. We observed from the analysis of the sensitivity and alignment quality that the inferred mixture model (2.2) particularly increased sensitivity to remote homology. This could account for the reduced difference between COMER and HHsearch when the definition for true positives is adjusted to closer homology. We now shortly discuss PPAS lagging behind the other methods by a large margin in all the TP-vs.-FP plots. PPAS is a semi-global alignment method, which aligns two sequences over their entire length and is primarily designed for modeling whole proteins. Since (semi-)global alignments are well known to be less sensitive than local alignments, this could be one of the reasons of the lag of PPAS.
Alignment qualityA reference-free evaluation framework based on structural models (Margelevi cius and Venclovas, 2010) was used to evaluate the quality of the profile alignments. According to this framework, an alignment between a pair of domains is considered to be of high quality if the most accurate of two 3D models generated for each domain (using the other domain as a template) is similar to the real structure. We used MODELLER () (version 9.4) to generate a 3D model based on a profile alignment and TM-score () to evaluate the structural similarity between the model and the real structure. TM-score ranges from 0 to 1 with values ! 0:4 indicating a statistically significant similarity and hence implying a high-quality alignment. A profile alignment is assumed to be of low-quality if TM-score < 0:2, a characteristic value for a random pair. Alignments generating TM-score values between 0.2 and 0.4 are considered of neither high-nor low-qualityBayesian modeling for homology detectionand are ignored. Yet, to evaluate all top-ranked alignments, we provide a complementary analysis. Importantly, the evaluation framework relies on two modes, local and global. The global mode evaluates the alignment with respect to the entire protein domain, whereas the local mode along the alignment extent. The global mode outweighs a performance gain in the local mode if profile comparison methods produce too short alignments, but it does not penalize over-extension of alignments. From the opposite position, the local mode counterbalances too long alignments tolerated by the global mode, but it allows underextension of alignments. Hence, the analysis only under both modes provides a comprehensive evaluation of the quality of alignments.(A,B) shows the number of high-quality versus low-quality alignments in the local and global evaluation modes for topranked alignments sorted by their statistical significance. The new method COMER at a rate of low-quality alignments of 1% in the local mode produces 366% more high-quality alignments than PPAS, 181% than FFAS and 35% than HHsearch. In the global mode, at a rate of low-quality alignments of 10%, COMER produces 2% more high-quality alignments than PPAS and 11% than HHsearch, but 4% less than FFAS. Calculating unit-length contexts increased the rate of high-quality alignments for COMER by 10% and 2% in the local and global modes, respectively. Whereas, by computing 13length contexts, HHsearch benefited from the 5% and 2% increase in the local and global modes, respectively. The figure reveals all the methods competing in the global mode. In the local mode, as FFAS and PPAS generate long alignments, their performance falls behind. Trying to equalize the conditions for all the methods, we set up the methods COMER and HHsearch (its option-mact 0) to extend their alignments maximally (FFAS does not provide such a control). This set up does not affect the sensitivity. The results are shown in(C,D). The picture is now opposite: The methods compete in the local mode (except PPAS) but in the global. In the global mode, at a rate of low-quality alignments of 10%, COMER produces 102% more high-quality alignments than PPAS, 90% than FFAS and 6% than HHsearch.demonstrates that COMER compares favorably with the other methods when either local alignment or (semi-)global alignment over the entire protein length is emphasized. Nevertheless, we reconsidered the alignments produced by the methods to include into the analysis those inducing TM-score values between 0.2 and 0.4. Particularly, we were interested in the rate of high-quality alignments (TM-score ! 0:4) against all other alignments (TM-score < 0:4), although shifting the threshold TM-score to a value of 0.45 or 0.35 yielded similar results. The results obtained without and with setting up COMER and HHsearch to maximally extend their alignments (Figs S12 and S13 of the Supplementary Materials, respectively) are similar to those shown in. However, in the local mode, COMER focused on local alignment (Supplementary) outperforms the other methods by a smaller margin than in. It means that COMER still produces a rather large amount of alignments falling into the TM-score interval 0:2; 0:4. This interval of TM-score values mainly corresponds to inter-fold relationships of proteins, some of which are remotely homologous or sharing local or global structural similarity.illustrates that some out of that amount of the COMER alignments represent those true positives.
Alignment quality of true positivesTo examine the alignment quality of true positives and the impact on it of the model (2.2) describing profile contexts, we plot inand (D), the methods COMER and HHsearch (-mact 0) maximally extend their alignments. A highquality alignment is that producing a structural model of TM-score ! 0:4. TM-score < 0:2 corresponds to a low-quality alignment. Alignments generating 0:2 TM-score < 0:4 are ignored. The thin straight line represents an error rate of 1% in the local mode (A,C) and 10% in the global mode (B,D). A nearly equal number of alignments are evaluated in both modes, the methods COMER and HHsearch (-mact 0) were set up to extend their alignments maximally. The thin line at TM-score  0:4 represents the limit of statistically significant structural similarity modes for the true positives out of the top 90 000 alignments of each method. The definition of true positives matches that in. The amount of true positives with a high-quality alignment (TM-score ! 0:4) the new method COMER produces in the local mode () constitutes 57% of the top alignments. This is 111% more than PPAS, 46% than FFAS and 8% than HHsearch. By calculating contexts, COMER increased the number of true positives attaining alignments of TM-score ! 0:4 and TM-score ! 0:2 by 3% and 4%, respectively (and B). The corresponding increase for HHsearch is 2%. Because of producing local alignment rather than (semi-)global, a large mass of the COMER alignments evaluated in the global mode () scores TM-score < 0:4. However, when COMER is set up to extend its alignments, in the global evaluation mode it yields 39% high-quality alignments, as illustrated in. This value is 50% greater than high-quality alignments produced by PPAS, 56% than that by FFAS and 5% than that by HHsearch (-mact 0). If we additionally take into the account the remotely homologous true positives that mainly come into the analysis at a lower statistical significance level and occupy the TM-score range 0:2; 0:4, then COMER's improvement with respect to PPAS is 60% more true positives aligned with TM-score ! 0:2, 34% with respect to FFAS and 10% with respect to HHsearch. Narrowing down the definition of true positives by increasing the DALI Z-score threshold to 3 provides a similar COMER's improvement in alignment quality over the other methods in the local and global modes (Figs S14 and S15 of the Supplementary Materials).
Homology examplesCOMER significantly detected a number of pairs of homologous protein domains that were not identified by the other three methods among their top 90 000 alignments. Here we provide two examples. The first pair involves the chain (SCOP ID d1rtwa ) of putative transcriptional activator and that of the ribonucleotide reductase R2 (d1mxra ). Although the chains are representatives of different SCOP folds a.132 and a.25, respectively, clearly they share the same topology (Supplementary). The homologous relationship between the two chains is confirmed by the ECOD evolutionary classification of protein domains (). ECOD assigns them to the same homology group and also to the same topology group of Heme oxygenase/Ribonucleotide reductase. The other example relates 2-keto-3-deoxy-6-phosphogluconate aldolase (d1wa3a ) to the uncharacterized protein YagE (d3n2xa ). SCOP (version 1.75) does not characterize the latter protein, but SCOPe categorizes both domains into the same superfamily of Aldolase, c.1.10. They exhibit the topology of TIM barrels (Supplementary) and share the same homology and topology groups in the ECOD classification.
Evaluation on the basis of changed inputsIn this section, we evaluate the methods given a different set of MSAs that originated from searching the same domain sequences with HHblits () (version 2.0.16) using default settings for three iterations against the UniProt20 database of profile HMMs (06/2015). Having MSAs built on pairwise comparisons of profile HMMs allows one to examine how the methods perform when they operate with the more accurate input MSAs. We evaluated the sensitivity of each method and the quality of the alignments produced by each method in the same way as described above and summarize the results below.
SensitivityCOMER at a false discovery rate of 10% (Supplementary) detects 84% more true positives than PPAS, 21% than FFAS and 14% than HHsearch.
Alignment qualityThe more accurate MSAs caused a substantial increase in alignment accuracy for the methods (Supplementary). We thus sum up at the following rates of low-quality alignments. COMER at a rate of low-quality alignments of 0.2% in the local mode (Supplementary) produces 300% more high-quality alignments than PPAS, 229% than FFAS and 60% than HHsearch. In the global mode having COMER and HHsearch set up to extend their alignments (Supplementary), at a rate of low-quality alignments of 1%, COMER yields 101% more high-quality alignments than PPAS, 86% than FFAS and 20% than HHsearch. The amount of true positives with a high-quality alignment (TM-score ! 0:4) COMER produces in the local mode (Supplementary) constitutes 65% of the top 90 000 alignments. This is 99% more than PPAS, 57% than FFAS and 7% than HHsearch. That amount in the global mode with the setup of extended alignments (Supplementary) is 50% of the top 90 000 alignments. This is 59% more than PPAS, 63% than FFAS and 6% than HHsearch (-mact 0).
A test on CASP targetsSection 4 has heretofore described the evaluation of the methods based on the protein domains from the SCOPe database. Some domains, however, represent a part of the protein chain, and some of them may inadequately reflect practical situations of structure prediction. We thus tested COMER and the other methods on fulllength sequences by a procedure similar to that applied for assessing structure prediction methods in CASP experiments. We used all 85 CASP11 (2014) regular target sequences with available 3D structures. 3D models of the targets were generated using structural templates identified by each method and evaluated with TM-score. A database of templates corresponding to a release of the PDB database () just before the start of CASP11 (05/01/2014), filtered to 20% sequence identity, equipped all the methods. Profiles for the target and template sequences were constructed according to the same operation as described in the beginning of Section 4, implying that the same set of MSAs supplied each method. The methods COMER and HHsearch were set up to extend alignments between profiles maximally. The results obtained by searching the target profiles against the template profile database and evaluating target 3D models generated from produced profile alignments are shown in. The. Average TM-score obtained by considering top N alignments per target for each method COMER HHsearch FFAS PPAS N  1 0:488=0:533 0:464=0:514 0:480=0:522 0:462=0:515 N  2 0:466=0:499 0:446=0:482 0:461=0:486 0:443=0:484 N  3 0:451=0:475 0:433=0:460 0:446=0:462 0:435=0:461 N  4 0:441=0:452 0:424=0:437 0:431=0:440 0:424=0:439 N  5 0:428=0:428 0:413=0:413 0:419=0:419 0:414=0:414Numbers following forward slashes represent the average TM-scores achieved after reranking top 5 alignments for each target according to TMscore a posteriori. The highest values are highlighted in bold. average TM-score of the COMER models is the largest, irrespective of the number of top alignments per target N (up to 5) considered. The differences between the average TM-score for COMER and those for the other methods are not large, but according to Wilcoxon signed-rank tests, the medians of the differences of the paired TM-scores for each number of top alignments considered deviate significantly from 0 at a confidence level of 95%. It means that the distributions of TM-scores obtained by using COMER differ from the distributions obtained by the other methods. In other words, the methods produce different alignments for the corresponding targets. Plotting the distribution of TM-scores for COMER against that for another method reveals (Supplementary) some points corresponding to low TM-scores for COMER alignments but higher for other method's alignments. The reason is that each method ranks templates differently, and the same template can be ranked, for instance, first by one method and third by another. Indeed, the bivariate distributions of TM-scores become more condensed after sorting the top alignments of each method according to TM-score a posteriori (Supplementary). Several outliers (colored dark red in Supplementary) for which COMER scores low correspond to the same target T0852 for which many templates can be detected at a statistically significant level. COMER ranked more closely related templates below the top 5. Clearly, better ranking of templates could improve all the methods (see, Supplementary Figs S20 and S21), but this is a complex problem that can be addressed in many different ways and is beyond the scope of this study. Interestingly, after reranking the top alignments, the distribution of TM-scores for COMER still differs significantly from those for the other methods at the 95% confidence level, irrespective of N  1;. .. ; 5, with the highest average quality of 3D models (). In the end, we emphasize that this test does not unveil how the methods would have performed in CASP11. A system specifically designed for protein homology modeling would require a more elaborate computational pipeline covering regular update of data, inspection of the quality of profiles, selection of appropriate templates given profile alignments, modeling by combining multiple templates, and other routines. This test just demonstrates the relative performance of the methods under equal conditions on the targets for which a limited number of templates are available.
DiscussionHighly important in many fields of biomedical research, protein homology modeling relies on protein sequence alignments. Alignments of high quality stimulate discovery of evolutionary related matches and thus are key to sensitivity to homologous proteins and, consequently, homology modeling itself. In this study, we have addressed the problem of protein remote homology detection by improving the quality of alignments between protein sequence families represented by sequence profiles. Modeling profile contexts, fixed-length profile fragments representing the environment of sequence families, previously undertaken by Biegert and S ding (2009), has been engaged to achieve this goal. We have proposed an HDP mixture model to describe the distribution of contexts, where a logistic-normal distribution is used to model substitution probabilities in profile contexts to capture dependencies between amino acids. We have inferred the HDP mixtures from a large set of profile context data by combining Gibbs sampling with Metropolis updates. The Metropolis updates exploited to overcome the inefficiency of Gibbs sampling were implemented by a splitmerge algorithm (), which we have adapted for the HDP mixture model. K  1260 distinct context clusters have been obtained by applying a parallel MCMC sampling algorithm developed to speed up posterior inference. We have developed profile construction and comparison computer utilities and, with respect to the inferred mixtures, derived scores, which we integrated into an extensive profile-to-profile comparison. Evaluating results by generating protein 3D models for each alignment between a pair of profiles and measuring the similarity between the model and the native structure, we have demonstrated that adding the scores increased the number of accurate 3D models, and consequently the number of accurate alignments, in both evaluation modes: with respect to the entire protein domain (global), key to protein structure prediction, and within the alignment boundaries (local), important to sensitivity. A benchmark of the new method COMER, available under the GNU GP License v3, with three other profile-to-profile comparison methods shows a significant improvement in both sensitivity and alignment quality, and an improvement from calculating unit-length contexts is twice that of the HHsearch method employing 13length contexts. Although this study confined to unit-length contexts, the HDP mixture model is applicable for longer contexts. The context consisting of S vectors of A substitution probabilities transformed by the inverse logistic transformation can be represented by an A  S matrix X. The random matrix X will have a matrix variate normal distribution with mean matrix M and covariance matrices R A  A and W S  S, or equivalently, vecX T  $ N AS vecM T ; R W. The mixture model (2.2) applied to g vecX T  will then describe the distribution of Slength contexts, where the conditional distributions and the MCMC sampling algorithms presented in the study remain valid. A model that allows for correlations not just between residues but also between context positions would impart much greater flexibility in modeling profile contexts and specificity in recognizing structural contexts. Integrated into comparison of profiles, the model would very likely increase the sensitivity and accuracy of alignments further. Accordingly, our further work will investigate how effective longer contexts under the HDP mixture model are.
M.Margelevi cius at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Model application The application of the mixture model (Section 2.1) to protein homology detection consists of several parts. First, we compose a large collection of non-redundant data of profile contexts. Next, we infer Bayesian modeling for homology detection
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
