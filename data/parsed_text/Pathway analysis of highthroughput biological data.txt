Motivation: Most current approaches to high-throughput biological data (HTBD) analysis either perform individual gene/protein analysis or, gene/protein set enrichment analysis for a list of biologically relevant molecules. Bayesian Networks (BNs) capture linear and non-linear interactions, handle stochastic events accounting for noise, and focus on local interactions, which can be related to causal inference. Here, we describe for the first time an algorithm that models biological pathways as BNs and identifies pathways that best explain given HTBD by scoring fitness of each network. Results: Proposed method takes into account the connectivity and relatedness between nodes of the pathway through factoring pathway topology in its model. Our simulations using synthetic data demonstrated robustness of our approach. We tested proposed method, Bayesian Pathway Analysis (BPA), on human microarray data regarding renal cell carcinoma (RCC) and compared our results with gene set enrichment analysis. BPA was able to find broader and more specific pathways related to RCC. Availability: Accompanying BPA software (BPAS) package is freely available for academic use at http://
INTRODUCTIONHigh-throughput biological data (HTBD) are generated in a variety of ways, including through deep sequencing and microarrays. These data can provide a snapshot of regulatory processes in the cell by inferring gene networks from experimental data. In particular, Bayesian network (BN) models have gained popularity for the task of learning biological pathways from microarray gene expression data (). In gene network modeling studies using BNs, nodes generally represent expression level of a gene and edges represent relationship between genes. BN models capture both linear and non-linear interactions between sets of random variables and handle stochastic events in a probabilistic framework accounting for noise. This results in the emphasis of only * To whom correspondence should be addressed. the strong relations in the observed data. BNs are, therefore, viable candidates for modeling gene regulation systems, where stochastic effects and large amounts of noise are expected. Furthermore, BNs are able to focus on local interactions, where each node is directly affected by a relatively small number of nodes and interactions defined by a BN can be related to causal inference (). These properties are similarly observed in biological networks justifying the use of BNs in exploring pathways in the setting of gene interaction networks, using HTBD. Arguably the most popular HTBD type is microarrays, where an identification of differentially expressed genes between two groups of samples initially relied on individual gene analysis (IGA). An alternative approach, called pathway analysis, functional enrichment analysis or gene set analysis (GSA) (), which focuses on directly determining predefined gene sets or classes that are significantly regulated, has received a great deal of attention. GSA methods score groups of genes and can identify genes that exhibit subtle changes at an individual level, but show concordant enrichment within a set (). Here we propose a new method of pathway analysis, which uses a graph theoretic approach and BN theory to evaluate whether a putative pathway successfully describes the underlying HTBD. Previously described GSEA () or Gene Ontology () based methods do not take into account the connectiveness of analyzed gene lists. There have been methods proposed to take into account the GO graph topology (), overlap between GO categories in the GO hierarchy () or modeling interactions between GO categories () in assessing the significance of enrichment of a GO term based on experimental data. However, none of these methods takes into account the network or structure defining the relation between the genes in each category. The proposed method [Bayesian Pathway Analysis (BPA)] considers the topology via which genes interact with each other when analyzing a group of genes. Using pathway information from global databases, we model each biological pathway as a BN after merging repeating entries and, if necessary, solving for cyclicity, while preserving the dependencies entailed by the original pathway. We consider the resulting BN, which is a graphical representation of gene interactions rendered by the given pathway, with non-informal, uniform belief priors. We quantify the degree to which observed experimental data fit this BN using Bayesian Dirichlet equivalent (BDe) score calculation, where the BN is updated with input data
S.Isci et al.
Fig. 1. DAGs are created from pathwaysin external databases, where, if necessary, multiple occurrences of same nodes are merged and cyclicity is resolved preserving dependencies entailed by the original pathway. Nodes in DAGs and microarray probes are mapped using gene annotation information. Multiple probes mapped to the same node are replaced by a robust average value followed by discretization of all signal values. A score metric, which is a measure of probability of data given the fixed network structure, is calculated. Significance of this score (p-value) is assessed by randomization of input data via bootstrapping. FDR values are calculated to account for multiple hypothesis testing. during score calculation. We assess statistical significance for the score of each pathway by testing it against datasets generated by applying randomization via bootstrapping. Results are evaluated in forms of nominal p-values and false discovery rate (FDR) values correcting for multiple hypotheses testing. Overall workflow used in BPA is depicted in. Renal cell carcinoma (RCC) is the sixth leading cause of cancer deaths in the United States and has no established biomarker for early detection or follow-up (). Most common histological subtypes of RCC are clearcell RCC (cRCC) and papillary RCC (pRCC) generally related to deficiencies in von HippelLindau, rapamycin complex 1 kinase (mTOR) and fumarate hydratase (). Treatment for metastatic RCC includes rather unspecific application of cytokine therapies (e.g. interferon- and interleukin-2) and more targeted use of receptor tyrosine kinase inhibitors (Sorafenib and Sunitinib), mTOR inhibitors (Everolimus and Temsirolimus) and monoclonal anti-vascular endothelial growth factor antibody therapy with Bevacizumab (). These therapies offer acceptable response rates (3040%), but are not beneficial in overall survival. Therefore, a more detailed analysis of molecular pathways underlying the RCC is essential. We have previously analyzed transcriptional profiling of various RCC subtypes and in a separate study obtained a predictive proteomic signature that distinguishes between interleukin-2 therapy responders and nonresponders (). Others have also used gene expression and proteomic approaches to gain insight into the molecular pathways governing RCC (). In addition to cRCC and pRCC, we used BPA to analyze the rare RCC subtype chromophobe RCC (chRCC) and other renal malignancies, such as transitional cell cancers of the renal pelvis (TCC) and Wilms' tumors (WT) or benign renal tumors such as oncocytomas (OC).
METHODS
Pathway information retrievalBiochemical network data of pathways were retrieved from KEGG (), NCI/Nature Pathway Interaction Database (), Reactome () and HumanCyc () representing molecular interaction and reaction networks for metabolism, genetic information processing, environmental information processing, cellular processes and diseases.
Construction of directed acyclic graphsA BN is a compact graphical representation of the joint probability distribution over a set of random variables in the form of a directed acyclic graph (DAG), where nodes represent random variables. The DAG encodes assertions of conditional independence, which are generally represented as a set of conditional probability tables (CPT). When modeling pathways as BNs, we first merge repeating entries (for example, Smad2/3 is present at several locations in the KEGG TGF pathway, see Supplementary Figures S1 and S2), as a single node in the DAG while conserving edge relations. Cyclic paths are eliminated using Spirtes' method (). In this procedure, graph representation of structural equation models (SEM) is converted to collapsed acyclic graphs such that d-separations in the collapsed graph entails the same independency relations defined by the model (). Cyclegroups (set of all cycles sharing at least one node) are found using Tarjan's algorithm (). For a given BN, all d-separations Page: 1669 16671674
Bayesian pathway analysisare conditional independencies and every conditional independency implied by the BN is identified by d-separations (). Therefore, our way of solving cyclicity preserves distributional features explained by the pathway after it has been converted to a DAG.
Microarray data preprocessing and discretizationBPA assumes normalized data as an input. First, IDs used in the array platform, corresponding to a given node in the pathway representation, are pooled and one representative signal value per node is calculated using the one-step Tukey's biweight algorithm (). Currently, BPA addresses experimental designs consisting of two groups of samples (e.g. cancer versus normal) though generalization of this framework to multiple groups is straightforward. For a given BN (converted from a pathway), we obtain observed fold changes (
Bayesian score metricFollowing discretization, the nodes in the BN model represent discrete random variables with a multinomial distribution. Dirichlet distribution is chosen as the conjugate prior to the multinomial distribution. For a given BN model, the probability of observing data is ():where N is the number of nodes,The equation above is used as a score metric and named Bayesian scoring criterion (BSC) (). Hyper-parameters, a ijk , can be determined using the equivalent sample size method (i.e. sum of the initial Dirichlet parameters, used at each node, have the same total), in which case the score is called the BDe (). Details of the scoring scheme are found in the Supplementary Material.
Estimation of score significance by randomization via bootstrapping
RESULTS
Identification of data fitting to networkWe tested our method to assign significance to BDe scores on eight synthetic binary BNs of different sizes and the wellknown Alarm and Asia BNs. The Alarm BN is designed to identify anesthesia problems with 37 nodes of 2, 3 or 4 states () and the eight-node binary Asia BN is designed to calculate the probability of a patient having tuberculosis ().
All 10 networksPage: 1670 16671674BN, we used two datasets to calculate BDe scores and their significance: one that follows the underlying CPT and one that does not. For a given BN, we randomly fixed Dirichlet hyper-parameters for each node and generated data that follow this CPT using the Bayes Net Toolbox (BNT) for Matlab (http://www.cs.ubc.ca/murphyk/Software/BNT/bnt.html). CPTs calculated from this data are considered ideal as they are based on data following the fixed CPT for a given BN. For inconsistent CPTs, we chose Dirichlet hyper-parameters to be equal for each node and obtained data using BNT. Therefore, the underlying CPTs calculated from this randomly generated data are considered to be the non-ideal CPT as they are not based on data reflecting dependency structure implied by the given BN. We used datasets with a size of 1000, the bootstrap test count was chosen to be 2000 and an equivalent sample size of 1 for Dirichlet hyper-parameters was used during BDe score calculation. The results summarized inshow that when the data following underlying CPTs are used, p-values indicate strong significance and are very close to zero (P < 510 4 ). Conversely, when data generated using CPTs not consistent with independencies entailed by the BNs are used, p-values are severely deteriorated. Therefore, datasets produced from inconsistent CPTs are quickly detected by BPA.
S.Isci et al.
Sample sizeIn real life microarray experiments, the number of samples rarely exceeds 100 due to technical and financial limitations rendering limited number of observations to assess change in expression of a given gene. In order to see the effect of this limitation on BPA, we tested BNs inand B. In case of ideal CPTs, p-values start to get lower after a small increase in the sample size with highest attainable significance (P < 10 3 ) at sizes >140. This is a dataset size that can be generated by the proposed method in an experimental setting, where one has 12 samples in each of the two groups). These results suggest that BPA can successfully be used with datasets commonly seen in real experimental settings.
Change in pathway structureBiological pathways may be incomplete as some of the nodes and/or edges for a given cascade of events may not have been identified yet. In order to test for the effect of missing edges and nodes on the significance ofthat the effect of node removal is more severe as when a node is removed so are all the edges connected to it. Robustness to node/edge removal is possibly due to the factorized scoring metric and the BNs ability to focus on local interactions, where each node is directly affected by a relatively small number of parent nodes and interactions. The synthetic networks tested follow average node/edge distribution in typical biological pathways and the removal of up to five nodes/edges is likely to be very high compared to the pathway error instances seen in real biological pathways, which makes application of BPA for pathway analysis possible.
Application to synthetic datasetsWe first looked at whether our method of solving cyclicity could create large cliques and inversely affect the BPA's overall performance. We generated 20 synthetic directed graphs containing cyclic paths following an SEM (), using TETRAD IV (http://www.phil.cmu.edu/projects/tetrad/tetrad4.html) (). The corresponding acyclic collapsed versions of synthetic cyclic graphs show 2.72.8 times the increase in number of nodes, number of edges, maximum degree, average degree and density of the networks, on average. The BPA was run on a 1000 size dataset with 1000 bootstraps and resulted in significant p-values (lowest attainable) in all cases when we generated data that follow SEMs. These results suggest that our method of handling cyclicity may generate large cliques; however, the BPA is not adversely affected by the proposed method of generating DAGs from biological pathways (for details, see Supplementary Material). We then compared performance of the BPA with GSEA v2 () and a model-based approach, GlobalTest () using Bioconductor v2.7, GlobalTest v5.4.0 package on synthetic datasets approximating real microarray data. We generated synthetic transcriptional regulatory networks and produced simulated gene expression data with noise using SynTReN v1.12 (). We created 60 synthetic Page: 1671 16671674discretization levels of 2 (i.e. if a gene's FC is above CO or below 1/CO, i.e. a gene is dysregulated, we insert a 1 in the observation data matrix D, otherwise we insert a 2) and 3 (i.e. we insert a 1, 2 or 3 in the observation data matrix D, if a gene's FC is above CO, below 1/CO, between CO and 1/CO, inclusive, respectively). These results suggest that BPA outperforms both GSEA and GlobalTest and there is no significant change in using two or three levels of discretization in BPA with a slight improvement in performance when a FC cutoff of 3 is used. We used two-level discretization with an FC cutoff of 2 when applying BPA to real datasets. A two-level discretization seems more natural as we do not keep activator/repressor information when modeling biological pathways as DAGs and an FC cutoff of 2 allows BPA to capture subtle changes.
Bayesian pathway analysis
Application to real RCC datasetWe applied BPA on real RCC datasets in order to identify the underlying molecular mechanisms of the disease (). In each experiment, every cancer subtype was individually compared to the normal samples generating 16 datasets in total. BNs corresponding to biological pathways are scored using BDe with an equivalent sample size of 1 for Dirichlet hyper-parameters and a selected subset of those that remain significant after 1000 bootstraps are shown in. We list CPU times for BPA in the Supplementary Material, which is 3010 min (average  SD) for the 16 analyzed datasets, where the time given is for the complete analysis of a single dataset. Running times range from 17 to 57 min. Analysis was performed on an Intel Core 2 Duo CPU E6550 2.33 GHz processor with Windows XP 32bit OS. We also analyzed the 16 datasets using GSEA and GlobalTest. In all three methods, the p-value and FDR cutoff values were chosen to be 0.05 and 0.25, respectively. In order to avoid the problem of pathway alignment that would arise if multiple pathway sources were used, we limited our analysis to the KEGG pathway database for this exemplary case. In case of GSEA and GlobalTest, Page: 1672 16671674
S.Isci et al.we used MSigDB v2.5 (group CP under C2). The complete list of significant pathways for each method and a comparative analysis are included in the Supplementary Material. Most of the pathways deemed significant by BPA agree with those found in the literature, using genomic and proteomic approaches. For example, arginine and proline metabolism, citrate cycle [tricarboxylic acid (TCA) cycle], purine metabolism, fattyacid metabolism, pyruvate metabolism, glycolysis/gluconeogenesis, valine, leucine and isoleucine degradation pathways have been shown to be important in RCC analyzed using a proteomic approach (). On the other hand, significant pathways found in different subtypes show notable agreement among datasets analyzed. Using BPA, we found 25 pathways significant in at least half of the datasets; this number was only nine for GSEA (see Supplementary Material). In BPA, on an average, 10.6 datasets were found significant by each of the 25 pathways (for a total dataset occurrence of 265), while GSEA's average was 9.3 significant datasets per pathway (for a total dataset occurrence of 84). When we considered pathways deemed significant for at least one dataset, we found 129 pathways discovered by BPA yielding 571 dataset occurrences in total and 121 pathways discovered by GSEA resulting in 390 dataset occurrences. BPA was able to find 63% of pathways discovered by GSEA. Overall, these results indicate that BPA found a greater pathway base related and specific to RCC as compared to GSEA. We believe this enhancement in performance is due to the ability of BPA to take into account connectedness of genes that make up a pathway; whereas in the GSEA analysis, such genes are only considered as a list and no topological information is incorporated into the analysis.for each pathway. We include complete results of GlobalTest in Supplementary Material as pathway selection with this method showed little specificity (97% of tested pathways found significant for 90% of the datasets). Similar behavior for GlobalTest have been observed previously by other studies potentially due to distributional assumptions (that regression coefficients for the genes come from the same normal distribution) and errors in empirical covariance estimates, made by this approach, leading to high false positive rates, especially in cases with small sample sizes (). Furthermore, GlobalTest loses significant power when a given gene list contains correlated genes, which holds true for genes in a given pathway (). Out of 12 pathways shown in, which were shown to be related to RCC using an experimental proteomic approach, BPA found 117 dataset occurrences for which these pathways were significant (61% of possible 1216 = 192 dataset occurrences), while GSEA could only identify 50 (26%) dataset occurrences. BPA was also able to yield high consensus among pathways found significant for a given RCC subtype. In, we show the overlap of pathways found significant for cRCC subtype in four different datasets. More than 70% of pathways found in four datasets are shared by at least two datasets, while eight pathways were common to all. Among these eight pathways, six of them (except for nicotine and folate pathways) have been shown to be activated in RCC based on a proteomic approach (). Results summarized input forth molecular mechanisms that are not only subtype specific, but also commonly seen in different RCC tumors. The complexity/relevance of some of these pathways can be exemplified by the activation of the insulin signaling pathway through the activation of the insulin growth factor receptor-1 that activates the PI3K/Akt signaling pathway. PI3Ks catalyze the conversion of phosphatidylinositol bisphosphate (PIP) 2 to PIP 3 (inositol phosphate metabolism). PIP 3 acts as a second messenger to activate Akt. Akt mediates the activation of mTOR that is responsible for its effects on cell growth. In addition to activating the PI3K/Akt/mTOR pathway, IGFR-1 also activates the Ras/MAPK/Raf/MEK/ERK mitogenic signaling pathway (MAPK signaling pathway). Subsequently, this leads to an activation of the cell cycle transition through stimulation of cyclin D1 (Cell cycle) and to increased cell proliferation. These prominent cellular pathways have been the objective for most of the targeted therapies now used in metastatic RCC. mTOR inhibitors act on PI3K/Akt/mTOR pathway leading to an inhibition of protein synthesis and cell cycle arrest, while some receptor tyrosine kinase inhibitors (Sorafenib) also affect Raf, blocking the MAPK mitogenic signaling pathway. In addition, both approaches inhibit angiogenesis that has a strong impact in RCC tumorigenesis and progression. Interestingly, further studies are underway analyzing possible composite or sequential therapies blocking these pathways for the identification of the optimal therapeutic approach. However, different targets within other pathways, described here, may lead to additional successful results and should be explored further. According to our analysis, one of these novel pathways could be the glyoxylate and dicarboxylate metabolism, which has been associated with lung cancer, but not with RCC (). Indeed, metabolism-related pathways have been shown to play a role in RCC progression and would therefore be reasonable targets for further in-depth analysis and in vitro testing.
Bayesian pathway analysis
DISCUSSIONWe described a method that models biological pathways as BNs and determines the fitness of given microarray data using BDe score. The proposed method overcomes representation, mapping, data discretization and cyclicity problems that arise in modeling pathways as BNs. We have chosen multinomial BNs with Dirichlet priors because: (i) their posterior can be efficiently calculated in closed form; (ii) they capture non-linear interactions; and (iii) they render a plain model requiring less parameter adjustment. Moreover, algorithms scoring mutinomial BNs have low time complexity. Alternative models such as linear Gaussian models, Gaussian process networks or regression models are usually preferred in the task of structure learning. Linear Gaussian models and regression models in BN setting can only detect linear dependencies between the child and parent variables. In Gaussian process BN models, Gaussian process priors are used as parametric families to model non-linear relations. However, the problem then becomes one of selecting the best fitting covariance function and the number of its hyperparameters in Gaussian process modeling, which requires various approximations and assumptions that may not be suitable in HTBD settings (). RCC represents a spectrum of genetically diverse epithelial tumors with a common derivation from the renal tubular epithelium and a variable clinical course. Approximately 30% of cases present with metastatic disease at initial diagnosis and 30% of initially organ confined cases develop metastases during later follow up. Since there are no reliable biomarkers available, patient management remains problematic despite improving understanding of the underlying molecular mechanisms. In particular, treatment of advanced RCC still poses a great challenge, as the RCC is resistant to chemoand radiation therapy and cytokine-based therapies offer only low clinical response rates with considerable toxicity. The advent of targeted therapy has brought exciting therapeutic options with promising clinical results, although the clinical benefit with respect to overall survival is only marginal. However, high-throughput technologies that analyze the entire genome and proteome promise to elucidate the heterogeneity of this disease and eventually enable a patient-tailored, individualized treatment. In contrast to the analysis of single genes, gene pathways enable us to see the context of complex interactions and to understand the biologic relevance Page: 1674 16671674
S.Isci et al.of their expression. The plethora of pathways presented in our manuscript mirror complex biologic processes in kidney tumors and is often closely intertwined. Overall, we believe the proposed approach provides a unique perspective that merges BN theory and HTBD analysis. Most BN models employed on HTBD use time series experimental designs in order to increase the size of the observed data. We have overcome this bottleneck and provided a tool that can be used with most common experimental settings interpreting the results within the context of known biological pathways. Moreover, existing BN approaches on HTBD generally focus on building networks from input data, which makes these approaches applicable on a few dozens of genes due to the complexity of structure learning algorithms. Given the fact that high-throughput platforms generate data for tens of thousands of genes, the proposed approach makes use of relevant experimental information and is applied to the complete dataset within the context of known biological pathways. Our simulations on synthetic and real datasets show that BPA is able to successfully find molecular mechanisms that best describe underlying HTBD.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [12:32 30/5/2011 Bioinformatics-btr269.tex]
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
At this point, we have BNs converted from pathways, a data matrix D for each BN representing observed, discretized FC values for genes (nodes) represented in the BN and BDe score calculated for the BN using the observed D matrix. We assess statistical significance of the BDe score, S n , calculated for n-th BN by using randomization via bootstrapping. We use a data-generating process and estimate a distribution of the score S given the null hypothesis that scores are the result of pure chance. For a one-tailed test with a rejection region in the upper tail, the bootstrap p-value for S n , P(S n ), is estimated by the proportion of randomized samples that yield a score > S n. If we have B randomized datasets, then P(S n ) = 1 B B  k=1 I(S k > S n ) where I is the indicator function yielding 1 if the Bayesian score is better than the original network score and 0 otherwise and S k is the score of the BN using k-th randomized dataset. As B goes to infinity, the estimated p-value will tend to the ideal p-value and the error in estimation will be kept minimal (Davison and Hinkley, 1997; Efron and Tibshirani, 1993). The process for generating the randomized samples is as follows: suppose dataset D is composed of M cases for a total of N genes and can be considered as an MN matrix where l-th row d l =[d l1 , d l2 ,..., d lN ], 1lM and d li is the value of the i-th node (gene) in the l-th instance of input data. For each node X i , we sample with replacement M instances from the i-th column, [d 1i , d 2i ,..., d Mi ] T , of the original data matrix D and obtain the newly formed column of the bootstrapped data matrix D k. The BDe score for this new data matrix is calculated and the whole process is repeated B times. The approach we adopt here has previously been described and applied to phylogeny reconstruction using molecular sequences (Brown, 1994; Davison and Hinkley, 1997). Bootstrap alone, which is generally used to establish confidence, would not be fitting to assess significance in the current setting. Therefore, we provide randomization via bootstrapping, which provides an approximation of the null distribution. When scoring a BN, the rows of D, which hold information reflecting the dependency relation between nodes of BN, are considered sequentially in order to update the parameters of each node on the BN. We randomize rows of D by changing the structure of columns of D via sampling with replacing each column of D separately. Querying each pathway database that holds few hundreds of networks generates a multiple hypothesis testing problem (utilized KEGG database contributes over 200 pathways). We address this issue by calculating FDR, using BenjaminiHochberg procedure, applied on p-values calculated for each pathway (Benjamini and Hochberg, 1995). The overall complexity of the BPA is O(N 2 +E 2 +BC 2 G), where N is the number of nodes, E is the number of edges, G is the number of genes, C is the number of samples and B is the number of bootstrap datasets. Modeling of pathways as DAGs is quadratic in N and E for Spirtes' algorithm and linear in N and E for Tarjan's algorithm. Data discretization is quadratic in C and linear in G. BDE score calculation is O(BN 2 G). Modeling pathways as DAGs is done off line, which does not lead to the computational time of a single analysis.
