With the increasing amount of newly discovered non-coding RNAs, the interactions between RNA molecules become an increasingly important aspect for characterizing their functionality. Many computational tools have been developed to predict the formation of duplexes between two RNAs, either based on single sequences or alignments of homologous sequences. Here, we present RILogo, a program to visualize inter-and intramolecular base pairing between two RNA molecules. The input for RILogo is a pair of structure-annotated sequences or alignments. In the latter case, RILogo displays the alignments in the form of sequence logos, including the mutual information of base paired columns. We also introduce two novel mutual information based measures that weigh the covariance information by the evolutionary distances of the aligned sequences. We show that the new measures have an increased accuracy compared with previous mutual information measures. Availability and implementation: RILogo is freely available as a stand-alone program and is accessible via a web server at http://rth .dk/resources/rilogo. Contact:
INTRODUCTIONAn increasing amount of functional non-coding RNAs (ncRNAs) has been identified in recent years and computational predictions of possibly functional structured RNAs yield vast amounts of candidate RNA genes (). Typically, RNA molecules interact with proteins or with other RNA molecules (including messenger RNAs) by forming intermolecular duplexes. Computational predictions of RNARNA interactions usually follow the thermodynamic energy models for the secondary structure prediction of a single RNA sequence. Algorithms for the simultaneous prediction of intra-and intermolecular structure between two given sequences have a higher prediction accuracy, but also have a high time complexity (). Another class of algorithms only focuses on the prediction of intermolecular duplexes between two RNA sequences, while neglecting possible intramolecular base pairings, and achieves linear time complexity in the best case (). When several homologous sequences are available, consensus structure prediction methods can also be applied for predicting intermolecular base pairs. For example, PETcofold () first predicts intra-molecular pairing and afterwards intermolecular pairing in the previously unpaired regions. Another approach also based on multiple sequence alignments is ripalign (), which computes inter-and intramolecular base pairs simultaneously using a partition function algorithm. The sequence pattern of a given multiple DNA or protein alignment is easily visualized by sequence logos (). Each alignment column is represented by a stack of letters from the DNA/protein alphabets, where the overall height of the stack denotes the Shannon information content of that position and the size of a letter denotes its frequency in that column. The most frequent letter is placed on top of the stack. Several programs were developed to automatically create sequence logos from a given input alignment (). When studying RNA alignments, the secondary structure of the RNAs needs to be considered. Structure logos () include the annotation of base pairing and the mutual information (MI) of two paired alignment positions in the logo itself. Single or consensus RNA structures are usually plotted in a circular planar graph (), e.g. VARNA () or R2R (). RNALogo () combines a planar plot of the consensus secondary structure with stacks of letters for each base and displays the MI of base pairs. 3D logos are plotted by Correlogo (). However, these programs do not include RNARNA interactions. RNA structures and interactions can be visualized by arcs or lines connecting pairing bases in their primary sequences, e.g. in. Here, we introduce RILogo, which combines sequence logos with an arc representation of the secondary structure of both intra-and intermolecular base pairs of two interacting RNA genes. Additionally, the MI of base pairs is calculated and included in the logo by colouring the arcs or adding an 'M' character on top of the letter stacks, with a height corresponding to the MI. It has been suggested that measures including phylogenetic information are the most powerful (). However, the widely used measures ignore information from the phylogenetic relationships between the sequences (). Thus, we introduce two novel mutual information based measures, which use pairwise evolutionary distances between sequences in order to give different weights to the *To whom correspondence should be addressed.  The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com. covariance information contained in individual sequences from the alignment. An early version of RILogo was previously used to display structure predictions in the PETcofold web server (). Here, we make the enhanced version of RILogo available both as a stand-alone program and via a web server. It now includes our new evolutionary mutual information measures, customization options and is freely available under the GNU LGPL.
IMPLEMENTATION AND RESULTS
RNA interaction logosThe input to RILogo is a pair of multiple structural RNA alignments or single sequences, including a consensus secondary structure annotation, which is allowed to contain pseudoknots. From the input alignments, two sequence logos are calculated and plotted one above the other, with the second logo displayed in 3 0-to 5 0-orientation (). Intramolecular base pairs are displayed by arcs in each logo. The arc representation of an RNA secondary structure is formally a graph with bases represented as nodes and base pairings as edges, where the nodes are displayed alongside each other while the edges are drawn as connecting arcs. Pseudoknots can easily be spotted as crossing arcs. Each arc is coloured by a gradient that denotes the MI of the underlying base pair. Intermolecular base pairing is displayed by straight lines between the respective columns of the two sequence logos. Both logos are horizontally arranged in a way, so that the average distance between interacting bases is minimized. RILogo's native output is an SVG file. The web server additionally provides other vector and bitmap output formats.shows an example for the interaction of the bacterial sRNA OxyS and its target site in the fhlA mRNA.
Evolutionary-based MI measureRILogo implements two novel measures for covariance of base pairs. The standard measure, an adaptation of the Kullback Leibler divergence to base pairs, is defined for two alignment columns i and j aswhere O ij is the frequency of observed base pairs and E ij of expected base pairs (). The frequencies of canonical base pairs at columns i and j are counted aswhere S is the set of all sequences, N  jSj and s i is the ith base in sequence s. The term C s is the phylogenetic distance to the other sequences described below in equation (3). s i ; s j  is 1 if s i ; s j  is a canonical base pair and 0 otherwise. s i  is 1 if s i is equal to any t i that forms a canonical base pair t i ; t j  where t 2 S and 0 otherwise. We define canonical base pairs as G:C, C:G, G:U, U:G, A:U and U:A. Note that MI ij strictly speaking is not a mutual information measure, but a distance between the quantities O ij and E ij measuring observed and expected covariance of base changes between columns i and j. Here, we do not strictly distinguish between 'mutual information' and 'distance'.compared MI with other alternative measures and showed that MI W}P is the best measure that does not include the structural context of base pairs. MI W}P uses only canonical base pairs and includes gap penalties by replacing the second summand in equation (1) with the term N G ij  (see Supplementary material). Other types of gap corrections have been applied as well (). By adding this ad hoc gap correction, the MI ij can be 50 when columns i and j contain many gaps. Thus, it is not a strict information measure in the classical sense, and we refer to it as an approximate mutual information measure or approximate Kullback Leibler distance. However, the gap correction has empirically been shown to increase the accuracy of the MI ij () and in practical applications, as also done in RILogo, a negative MI ij will be set to zero. Without gap correction and in the special case with equiprobable background frequencies for all base pairs, MI ij reduces to a classical Shannon style information content. A known drawback of MI and MI W}P is that structurally neutral substitutions of one base within a base pair (e.g. G:C to G:U) do not contribute to the mutual information. Additionally, a phylogenetic bias in the sequence alignment can distort the individual contributions from each sequence. For example, compensatory base pair changes between sequences of high evolutionary distance are likely to happen. In contrast, compensatory substitutions in closely related sequences are less likely and, thus, contribute more information. Hence, we introduce two new measures, treeMI and treeMI W}P , which weigh the base pair frequencies using averaged pairwise phylogenetic distances. While C s  1 for all s in MI and MI W}P in equation (2), we define C s in treeMI and treeMI W}P aswhere d avg s is the average pairwise distance from sequence s to all other sequences in the tree and N d is defined asThis gives a higher weight to sequences that are phylogenetically proximal to all other sequences and less weight to more distant sequences. The normalization by the number of sequences N in equation (2) results in treeMI40 also for fully conserved columns, which would not be the case if N  P s C s. Both MI W}P and treeMI W}P give values in the interval {1.0, 2.0}, with 1 when each base pair for a given column contains one gap. The maximum of 2.0 bit is achieved when exactly the six possible base pairs are present. The MI is displayed by an additional letter M (with height MI ij =2 in the sequence logos, as in. The total height of a letter stack (y-axis) can exceed 2 bit, since it sums up two measures, Shannon Information and (approximate) mutual information. An alternative (and more rigorous way of) display could be a 3D plot with the measures on respective axes. For evaluation, we compared treeMI and treeMI W}P with MI and MI W}P based on how well they discriminate between true and false base pairs. For this comparison, we selected a set of 961 structure-annotated RNA alignments from Rfam 10.1 (), by keeping only those with at least five sequences, average pairwise sequence identity (PID) 90%, and removed redundant sequences with ! 99% similarity. Phylogenetic trees were inferred from the alignments with FastTree2 (), which were then used to calculate d avg in treeMI and treeMI W}P. Like, we calculate the best Matthews Correlation Coefficient (MCC;) for each alignment, where the best MCC is derived from the MI score that differentiates most accurate between annotated base pairs and unpaired bases. Both treeMI and treeMI W}P identified annotated base pairs better than MI and MI W}P , with an average MCC of 0.238 for treeMI and 0.241 for treeMI W}P , compared to an average MCC of 0.181 for MI and 0.217 for MI W}P .shows that treeMI captures the covariation within most alignments better than MI which results in better predictions (higher MCCs) of the annotated base pairs. By excluding those alignments with very low base pair prediction accuracy (MCC 50.1), the information gained by phylogeny even increases: average MCC (MI)  0.315, average MCC (treeMI)  0.395. Additionally, we observed that treeMI gives better results than treeMI W}P for MCC40.3, while treeMI W}P is better than treeMI for lower MCC (), due to the little covariation in these alignments. In contrast, MI W}P gives higher MCCs than MI, as already observed in(see Supplementary). The average PID is negatively correlated to the alignment covariance, and thus, to the information that can be gained by the MI measure. By taking weights for evolutionary distances into account, however, treeMI W}P improves MI W}P in alignments with higher average PID, where less covariance is available (see Supplementary Table 1 and). In contrast, alignments with highly divergent sequences carry more covariance information, so that there is less improvement by including evolutionary distances. Supplementaryshows that treeMI performs better than treeMI W}P for alignments with low average PID, because it also includes non-canonical base pairing in the mutual information measure.
CONCLUSIONRILogo visualizes two RNA sequence alignments by sequence logos, their intra-and intermolecular base pairing and the mutual information of base pairs. It also introduces two novel mutual information based measures: treeMI and treeMI W}P , that perform better than previous measures by including additional information from evolutionary distances. RILogo is accessible via a web server and its output can easily be customized. We publish the stand-alone version of RILogo under the GNU LGPL license, i.e. it is allowed to be explicitly integrated in other software/servers to display RNARNA interactions and sequence logos.. Intramolecular (arcs) and intermolecular (lines) base pairs are coloured by their mutual information using treeMI W}P in log-scale. The yaxes show the summed information content (in bits) of the conservation for each position (the relative entropy) and its contribution to the (approximate) mutual information
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
P.Menzel et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
RILogo: Visualizing RNARNA interactions at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
