Binding free energy calculations obtained through molecular dynamics simulations reflect intermolecular interaction states through a series of independent snapshots. Typically, the free energies of multiple simulated series (each with slightly different starting conditions) need to be estimated. Previous approaches carry out this task by moving averages at certain decorrelation times, assuming that the system comes from a single conformation description of binding events. Here, we discuss a more general approach that uses statistical modeling, wavelets denoising and hierarchical clustering to estimate the significance of multiple statistically distinct subpopulations, reflecting potential macrostates of the system. We present the deltaGseg R package that performs macrostate estimation from multiple replicated series and allows molecular biologists/chemists to gain physical insight into the molecular details that are not easily accessible by experimental techniques. Availability: deltaGseg is a Bioconductor R package available at
INTRODUCTIONFree energy calculations are extensively used to understand intermolecular interactions. Among the several free energy estimation methods (), the MMGB(PB)SA (molecular mechanics with generalized Born and surface area solvation) has gained popularity because of its fast performance and its ability to predict trends in affinities (). Traditionally in MMGB(PB)SA, one performs molecular dynamics simulations (MDs) and selects a set of representative snapshots from a stretch of the trajectory that is deemed to be at equilibrium (or converged). The MDs are often replicated multiple times (typically from 3 to 6), each time with slightly different starting conditions. Of primary interest is the calculation of the relative free binding energy G  G complex  G receptor  G ligand , which is estimated from the replicated MDs of the complex, receptor and ligand terms. The average G across the set of selected snapshots is then reported as the net free energy, which is subject to large variation. All average-based methods assume that the G series originates from a single conformation description of binding events. They are designed to minimize autocorrelation and estimate the series on appropriate (de)correlation times (otherwise the statistical error would be underestimated) via the method of statistical inefficiency or block-averaging (). It has been discovered that this approach is sensitive to the drift during the course of the simulation and, especially in long simulations, gives exponentially increased correlation times (). The unappealing consequence of the monotonic relationship between the correlation and the simulation times is that longer simulations lead to less data points for reliable inference. Our new deltaGseg methodology relaxes the restrictive 'single conformation' assumption and estimates multiple distinct subpopulations, reflecting potential macrostates upon experimental validation, within a series and its replicates (). Rigorous statistical modeling avoids the correlation time estimation without compromising the statistical validity of the estimates.
APPROACHWe present the main functions of the deltaGseg R package that implements and enriches with alternative options our original MMPBSA_segmentation algorithm () for macrostate estimation in these steps: (i) data visualization and adjustment for preprocessing, (ii) data segmentation via change-point analysis for initial subpopulations estimation, followed by wavelets denoising for series estimation and (iii) hierarchical clustering for the macrostates estimation. Theoretical results () and deltaGseg diagnostic plots (function diagnosticPlots) show the estimated series and its insignificant autocorrelation coefficients. Our approach is not only limited to binding energies between protein-ligand systems, but can be also used to analyze different conformational spaces in the folding of peptides or protein by identifying different energetic states along the simulation.
METHODS
Visualization and preprocessingThis task is carried out by the parseTraj function. We load each time series X r t t  1,. .. T; r  1,. .. Rt denotes the time and r the replicateand, initially, we test whether each X r t is weakly (trend) stationary by estimating the augmented DickeyFuller P-value (). If the assumption is not satisfied, we visualize and split the series. Each generated subseries is once again tested for stationarity and, if passes, it is further analyzed independently (see next steps). Our experience with *To whom correspondence should be addressed. MD simulation data indicates that weak stationarity holds for splitted series. If the problem persists, series differentiation is suggested by calculating of the first differences, X r t  X r t  1. Differentiation is appropriate for subseries with an apparent trend, which will be effectively removed.
Series segmentation and denoisingThese tasks are performed by the denoiseSegments function. Each subseries X r t of Section 3.1 undergoes statistical multiple change-point analysis by the Binary Segmentation method of Auger and Lawrence (1989). Binary Segmentation automatically splits X r t into Q r segments, Q r 2 2, maxQ. The user sets the initial parameter maxQ (e.g. maxQ  15 for a series of T  5,000; case study below), and the algorithm estimates the significant Q r segments at level  0:01. Subsequently, the X r t, q data of each segment q r , q r  1,. .. , Q r , is modeled and smoothed by 1D wavelets via wavethresh (). The user may adjust various modeling and smoothing parameters such as the degree of smoothness, the wavelet family (default is the Haar wavelet with step smoothing function) and the minimum length, L q , for a segment q to be accepted (L q 0:
Data summarization and macrostate identificationFinal estimation is carried out by the function clusterSegments. Here, the wavelet smoothed X r t, q are summarized into a vector of quantiles V r q ('identity' vectors). All P Q r segments are simultaneously analyzed by feeding the Euclidean distances among the V q r into hierarchical clustering. The clustering can be performed either by the pvclust algorithm () that assesses the significance of each cluster / subpopulation where potential macrostates can be derived from (see case study below) or by simple average linkage clustering and a user-defined number of subpopulation to be identified. Both options imply manual (subjective) selection of the final subpopulations but the deltaGseg interactive plots aid the user in this decision. The pvclust provides an additional statistical assessment measure.
CASE STUDYWe applied deltaGseg to the interaction data of the ErbB2 receptor, a member of the growth factor receptor tyrosine kinase family, and adenosine triphosphate, a natural ligand to ErbB2 (Pereira et al., submitted for publication). Snapshots from three replicates (5000 time points each) were used (). The data preprocessing algorithm suggested splitting the third replicate at t  2775 (vertical dotted line). Segmentation, denoising and summarization were performed for each of the four subseries. The pvclust was used to estimate the significance of each cluster at each tree node (). We estimated six distinct subpopulations at significance level  0:01. Structural characterization of these ensembles can determine if they represent few different binding modes between ErBB2 and adenosine triphosphate that could arise from the exploration of different conformational spaces as it has been observed for an inhibitor of these kinases (). Ideally, every single population should be characterized by specific structural determinants which might be difficult to prove experimentally. Our approach has the advantage of applying statistical methods to identify subpopulations in the bound state of a system, providing a more efficient manner to characterize quantitatively residues that contribute either in a transient fashion or permanently in a given conformational space. The analysis carried out here suggests the existence of two apparent binding modes with a difference of $36 kcal/mol between them. Of the three replicates, the first extensively explores the looser conformation, the second preferentially explores the tighter binding mode and the third appears to oscillate between the two modes. When these different binding modes can be detected with experimental methods, they will be assigned to different macrostates that can be observed at the macroscopic level.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
D.H.P.Low and E.Motakis at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
