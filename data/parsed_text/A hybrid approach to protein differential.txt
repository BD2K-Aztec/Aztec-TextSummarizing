Motivation: Quantitative mass spectrometry-based proteomics involves statistical inference on protein abundance, based on the intensities of each protein's associated spectral peaks. However, typical MS-based proteomics datasets have substantial proportions of missing observations, due at least in part to censoring of low intensities. This complicates intensity-based differential expression analysis. Results: We outline a statistical method for protein differential expression, based on a simple Binomial likelihood. By modeling peak intensities as binary, in terms of 'presence/absence,' we enable the selection of proteins not typically amenable to quantitative analysis; e.g. 'one-state' proteins that are present in one condition but absent in another. In addition, we present an analysis protocol that combines quantitative and presence/absence analysis of a given dataset in a principled way, resulting in a single list of selected proteins with a single-associated false discovery rate.
INTRODUCTIONA key goal of quantitative mass spectrometry-based proteomics is statistical inference on differential protein expression. Quantitative information is derived from spectral peak intensities that are identified as having come from one of a protein's constituent peptides. Statistical procedures for differential protein expression are naturally constructed in the context of regression or ANOVA, or as a 'rollup' problem (). However, intensity-based procedures are challenged by the presence of widespread missing intensities. It is typical for 2040% of the total collection of attempted measurements to be missing; that is, in a matrix with all identified peptides in the rows, samples in the columns, 2040% of the matrix cell entries are empty. With standard regression or ANOVA procedures, peptides with missing values must either be removed from the analysis, or their missing values must be imputed. There will typically be very few peptides with no missing values, so filtering peptides in this way results in a * To whom correspondence should be addressed. much less informative dataset. Furthermore, previously-published reports indicate that the vast majority of missing values are the results of censoring of absent or low-abundance peptides (). This means that simple imputation routines are not appropriate (). Parametric imputation and other specialized methodology can be employed to enable intensity-based inference with lessened information loss (). However, some information loss is inevitable. In particular, 'one-state' (or nearly so) peptides, those for which there are many observed intensities in one comparison group but few in another comparison group, are not amenable to an intensity-based analysis; not limited to the twoclass problem. As a result, such peptides are typically filtered out of an intensity-based analysis. A protein that is always present in a diseased state, say, and never in the healthy state would be of great biological interest, so it is unfortunate if our statistical methodology cannot identify such a protein. An alternative to an intensity-based analysis is a 'presence/ absence' analysis, in which peak intensities are digitized into binary measurements depending on whether a peak was observed or not. This is analogous to the spectral counting approach in MS/MS studies (), where a peptide is quantified by the number of fragmentation spectra assigned to it. Data collected in our laboratory do not necessarily have MS/MS fragmentation data associated with it, instead being obtained according to the accurate mass and time tag pipeline (). Still, we have information on whether or not a particular peptide was observed in each sample. While presence/absence analysis is better-suited to finding one-state proteins, it necessarily has less statistical power to detect abundance differences in proteins with little to moderate missingness. Ideally, protein differential expression analysis would simultaneously target proteins of both types, resulting in a single list of differentially expressed proteins, with a single-associated false discovery rate (FDR). A hierarchical Bayesian model would be well-suited to this purpose, but such techniques are complex, computationally intensive and less amenable to high-throughput pipelines. We present a hybrid analysis protocol that consists of two stages:(i) intensity-based analysis, and (ii) a presence/absence analysis. The results of each are merged to create a single collection of 'interesting' proteins, to which we use novel methodology to apply a single FDR. This enables the researcher to extract more information from a quantitative proteomic dataset than would be achievable by either approach alone, while still maintaining an interpretable measure
A hybrid approach to protein differential expressionof overall statistical confidence. For the proposed hybrid analysis protocol, we demonstrate the following: (i) resulting FDR estimates are conservative; (ii) one-state proteins are consistently selected as differentially expressed; and (iii) the number of differentially expressed proteins selected at a specified FDR exceeds that either intensity-based or presence/absence analysis alone.
METHODS
Data
DiabetesThese data are as previously described, containing labelfree proteomic measurements on human patients with and without Type II diabetes ().
Filtering based on peptide detectabilityTo minimize the number of sibling peptides with large missingness proportion differences, we use PeptideSieve () to filter peptides whose amino acid sequences are unlikely to be detected by MS. In all 554 peptides are filtered out before carrying on any further analysis.
SimulationWe carried out simulation studies as follows, to investigate the operating characteristics of our methodology at both peptide and protein levels. Peptide-level data were generated from a Binomial model, under the same conditions as the diabetes data (two comparison groups with 10 samples in each); the Binomial model is appropriate, since presence/absence data can be viewed as success/failure of independent Bernoulli trials. Presence probabilities in group one took the values on p 1 = 0.2,0.3,0.4,0.5. Half of the group-two peptides were assigned the same presence probabilities as their group-one counterparts. In the other half, differential presence probabilities were created, with probability differences (comparing group two to group one) of p d = p 2 p 1 = 0.1,0.2, ,0.9p 1. Separate simulations were carried out for each of the group-one presence probability values with even replications on different p d settings. Similarly, for protein-level data, the number of peptides per protein was randomly selected to range between 1 and 30. Protein-level presence probabilities also took the values p 1 = 0.2,0.3,0.4,0.5 and p d = p 2 p 1 = 0.1,0.2, ,0.9p 1. For each constituent peptide, the group-one peptidelevel presence probability equaled the protein-level probability multiplied by a randomly-selected number between 0 and 1 (to allow for different levels of detectability for peptides of the same protein). Peptide-level differential presence probabilities were handled as described for the peptide-level simulation above. Finally, to simulate data for use by the hybrid method, with both peak intensities and presence/absence indicators, we randomly generated intensities from a Normal distribution with parameters chosen to mimic the diabetes data. Missingness proportions took the values 10, 20, 30 and 40%, with missingness created by censoring the lowest corresponding percentages of peptide intensities. As in the above simulations, half of the peptides/proteins were given differential expression, now defined in terms of mean intensity levels. Differential intensity magnitudes took both lowmagnitude values of 1, 2, as well as high-magnitude values of 5, 10, all on the log scale.
Logistic model for protein presence/absenceLogistic regression is a natural analysis method for presence/absence data, given their binary nature. Specifically, let Y ijkl be the indicator for whether a peak was observed for peptide j of protein i in comparison group k and sample l. Then, we can say Y ijkl  Binomial(1,p ijk ) for l = 1,2,...,n k , where n k is the number of samples in comparison group k. A simple logistic regression model would then be logit( p ijk ) = Prot i +Pep ij +Grp ik .Here, Prot i represents the overall (across all comparison groups) log odds of peak presence for protein i, Pep ij is the effect of peptide j of protein i (assumed to be the same across all k comparison groups), and Grp ik is the protein-level effect of comparison group k in protein i. Usual sumto-zero constraints apply; namely, m i j=1 Pep ij = 0 and K k=1 Grp ik = 0 for i = 1,2,...,M, where M is the total number of proteins in the data. For the purposes of comparing protein presence probabilities across comparison groups, the parameters of interest are the Grp ik , i = 1,2,...,M. For example, in the diabetes data, K = 2, with k = 1,2 corresponding to the diabetic and control groups, respectively. Hence, Grp i1 Grp i2 is the log odds ratio for protein i, comparing diabetics to controls. Testing for a difference in presence probabilities corresponds to testing the null hypothesis that Grp i1 Grp i2 = 0; given the model's sum-to-zero constraints, this is equivalent to the null hypothesis that Grp i1 = Grp i2 = 0. Of course, the model is not restricted to the two-class case and can naturally be generalized to the K-class case, in which the corresponding null hypothesis is that Grp i1 = Grp i2 =  = Grp iK. Unfortunately, logistic regression is not well-suited in practice to the analysis of presence/absence data. In particular, biologically-interesting proteins are liable to be missed entirely, due to inherent limitations of the methodology. Consider a 'one-state' protein, present in all samples for one comparison group, absent in all samples for the other comparison groups. From a biological perspective, this would be a very interesting protein. However, in logistic model, the p-value for such a protein will tend to be reported as nearly equal to one, meaning that the protein would not be selected as differentially expressed under any reasonable criteria. A simple scenario illustrates this problem. Consider a 'one-state' protein with just a single peptide. In logistic regression, the assumed variancecovariance matrix for regression coefficients is (X WX) 1 , where X is the model matrix, and W is diagonal with entries p k (1p k ), with p k the presence probability in comparison group k, k = 1,2. For comparison groups in which no peaks were observed, the estimated value of p k is zero, making the corresponding entry in W equal to zero. This results in an overestimation of the standard error for the group effect model term, hence an understatement of statistical significance for that protein's group effect. In the diabetes data, for example, 'one-state' proteins are assigned p-values of one.
Exact peptide-level testsIn light of the logistic regression limitations, we propose an exact procedure for testing for differences in presence/absence between two comparison groups. Let y jk = n l=1 y jkl be the number of observed peaks for peptide j in comparison k, k = 1,2. We use T j =|y j1 y j2 | as the peptide-level test statistic. Based on the Binomial probability model, the exact sampling distribution of T j under the null hypothesis H 0 of no difference in presence probabilities can be written aswhere B(m;n,p) is the Binomial PMF at m, with n trials and probability of success p and p j0 is the shared probability of peak presence for both groups. Thus, based on an observed statistic of t j , the p-value is ttIn practice, we need only to estimate the shared presence probability under the null hypothesis, p j0 , to approximate the p-value for a given peptide. We estimate p j0 with a pooled sample proportion, resulting inp in inp j0As an example, consider a 'one-state' peptide, present in all samples of one group but in no samples of the other group, in the diabetes data. Whereas logistic regression reports a p-value of one, the exact test correctly highlights the peptide as statistically significant. Specifically, the test statistic
X.Wang et al.T j equals 10, andpand andp j0 = 0.5, so the p-value is computed as 2B(10;10,0.5) B(0;10,0.5) < 0.0001
Bootstrap protein-level testsFor inference at the protein level, there is the added challenge of multiple peptides belonging to the same protein. To incorporate all sibling peptides into a single test for differential presence probabilities, we use the following test statistic:where i is protein index, j is peptide index and k is comparison group index, i = 1,2,...,M, j = 1,2,...,m i , k = 1, ,K, K = 2. The statistic in (2) is a weighted average of observed presence difference on each sibling peptide. For the weighting term  ij , we use  ij = y ij / j y ij A parametric bootstrap procedure () is used to approximate the sampling distribution of the T M i under null hypothesis setting as follows. First the Binomial parameters p ijk are estimated, for which two approaches are considered. The first approach simply uses the sample proportion for peptide j of protein i in comparison group k being present, which needs 2m i parameter estimation per protein. Alternatively, we approaching the problem by inducing some structure between the p ijk , assuming that p ijk = p ik d ij , where p ik is the overall presence probability for protein i in comparison group k, and d ij is the 'detectability' probability (the probability that a particular ion species is detected by the LC-MS instrument) for peptide j of protein i. This assumption of structure translates to an assumption that the detectability of a peptide does not differ between comparison groups. Since detectability is a function of chemical composition rather than abundance (), this seems a reasonable assumption. After introducing the structure assumption the number of parameters per protein to be estimated reduces from K m i to K +m i. With the second approach, the presence probability p ik of protein i in group k is estimated by averaging the presence proportion of its top 10% most prevalent peptides (rounded up to the nearest integer number of peptides).The rationale here is that, for these most prevalent peptides, the detectability probability will be close to one, making p ijk  p ik. ThenpThen Thenp ik is used to estimate, wher p ijk andpand andp ik are the sample presence proportions. Clearly, this estimation approach will work best for proteins with several peptides detected; with few peptides, the above calculation may be based on the single most-abundant peptide. Still, we point to the Results section as evidence of adequate performance overall. Since we hav p ik anddand andd ij , according to the equation p ijk = p ik d ij , the null sampling distribution of our test statistic could be generated by parametric bootstrap. Under the null hypothesis setting, the presence probabilities of protein i across K comparison groups are the same and set to be p i0. In two group case,Thus, for peptide j of protein i in group k, n k zeroes or ones are generated from the Binomial distribution with probabilitypprobability probabilityp ijk,2. We run B bootstrap iterations and compute the test statistic (2), T M b in each iteration. The p-value is then computed as the proportion of bootstrap test statistic values being as or more extreme as our observed T M i value:
FDR estimationThe FDR associated with a list of features selected at a p-value cutoff c p () is the expected number of false positives F out of the total number of selected features S:The denominator can be replaced simply with the observed number of selected features. The traditional approach to estimate the numerator is to exploit the expected uniform sampling distribution of the null p-values (). In particular, we can estimate E F cp by M    0 c p , where M is the total number of features andand and 0 is the estimated proportion of null features out of the total M features. However, as our test statistic is discrete, its null sampling distribution is not necessarily Uniform. As an example,shows a simulated null sampling distribution for peptide-level test statistics, in which the shape of the null sampling distribution is quite non-Uniform and could depend on many factors, including the number of peptides of a protein, the sample size of each comparison group and the overall number of observed peaks of a protein. With discrete test statistics, standard FDR estimates will tend to be conservative (;). There is some published work aimed specifically at FDR estimation with discrete test statistics ().
Peptide-level FDR estimationA more general way to describe the estimate of the numerator in Equation (3) is as a weighted sum of calculations from the estimated null p-value distribution:where w j is a weight (number between 0 and 1), and CDF j0 is the estimated cumulative distribution function (CDF) for null features. In the case of a continuous test statistic, the null p-value distribution is known to be U(0,1), so no actual estimation of CDF j0 is required. Since the right-tail probability of the U(0,1) distribution at c p is equal to c p , we would simply have CDF j0 (c p ) = c p for all j. The weights w j would ideally be selected in a way to give prominence to (take values closer to one for) null peptides. With a continuous test statistic, since CDF j0 (c p ) = c p for all j, we can replace the w j with an estimate of the number of null features, rather than having to weight each feature individually. Thus, with the traditional estimate of the numerator in Equation (3), the w j are replaced with M    0. Again, our challenge in the present context is that our peptide-level test statistic is not continuous. With this in mind, we derive a peptide-level FDR estimate by proceeding from the more general formulation above. Specifically, we specify peptidespecific weights w j and use the assumed
A hybrid approach to protein differential expressionThe estimate of CDF j0 is derived from an estimate of the null probability mass function (PMF) for peptide j, which is assumed to be Binomial:Pr(Y j1 |p|p j0 )Pr(Y j2 |p|p j0 ),is a pooled estimate of presence probability for peptide j under the null hypothesis that p j1 = p j2. For the w j , we use
if otherwiseThis corresponds to calling a peptide null if its estimated null PMF is greater than its PMF estimated without restricting that the null hypothesis be true. We therefore estimate the peptide-level FDR asIn what follows, we refer to an 'unweighted' FDR estimate as that resulting from setting all w j equal to one.
FDR estimates for multi-peptide proteinsOur simulation studies indicate that for most settings, the p-value of the test statistic for multi-peptide protein (2) is approximately uniformly distributed under null hypothesis setting, especially when there are moderate overall levels of presence (data not shown) and moderate number of sibling peptides in a protein. Because of this, we use the standard () method for FDR estimation. 'Namely, at p-value cutoff c p , we estimate the FDR as which could also be seen as a uniform weight across proteinswhere M is the total number of proteins, andand and 0 is the estimated proportion of null proteins, We estimate  0 by fitting a smooth lowess curve to the values ofof of 0 () = #{pvalues >}/M(1), then choosingchoosing choosing 0 as the fitted value of the smooth curve as   1 ().
Weighted FDR estimation for mixed single and multi-peptide proteinsIn practice, both single-peptide proteins and multi-peptide proteins are usually mixed in a dataset, for which we have developed p-value and FDR estimation separately. The two sets of p-value are left as is whereas a unified FDR estimate needs to be generated based on the pooled set of p-values. The numerator of FDR for mixed case is given by summing up the estimation of expected number of false positive features for single-peptide protein and multi-peptide proteins, as indicated in the above two sections, and the denominator is the number of selected features based on the p-value pool.where p
values s are the p-values for single-peptide proteins and p-values mare those for multi-peptide proteins; the '#' notation is used to indicate 'number of'.
Hybrid analysis incorporating both presence/absence and intensity measurementsThe above methodology has dealt only with presence/absence data, from which peak intensity measurements are excluded. The rationale for simplifying peak intensity measurements to presence/absence is that it better enables discovery of 'one-state' (or similar) proteins. However, statistical information is lost by throwing out intensity measurements, which would translate to decreased statistical power to detect differentially expressed proteins that differ in terms of abundance but not presence/absence. Thus, we would ideally incorporate both peak intensity and presence/absence information into a differential expression analysis. One simple way to do this is to carry out separate intensity-based and presence/absence-based analysis, select proteins at a specified FDR from each analysis, then report the union of the two resulting protein lists. However, while we might intuitively expect a small FDR for the resulting list of proteins, we will not generally be able to assign an actual FDR estimate. In what follows, we derive a FDR estimate for the union list of differentially expressed proteins. Thus, taken together, the methodology presented here allows the researcher to select a list of differentially expressed proteins, some based on intensity and others based on presence/absence, to which an overall FDR estimate can be assigned. We use a single p-value threshold c p for both intensity measurements and presence/absence; so, a protein is selected if either of its intensity-based and presence/absence p-values are less than c p. Intensity-based p-values are derived from regression models and censored likelihoods from our prior work (). Let pvalue b and pvalue p correspond to the binary presence/absence and peak intensity measurements, respectively. The FDR for a hybrid analysis can then be estimated byWe set the weight w i equal to the average of the binary weight and the uniform weight derived from Storey and Tibishirani's FDR estimation scheme in the intensity-based method ().shows Type I error and power for the proposed presence/absence methodology applied to simulated single-peptide and five-peptide proteins. As would be expected, we have greater power to detect differential expression when there are multiple peptides in a protein. The pool of number of peptides of a protein is 5,10,15,20,25, the presence probability of proteins take value among
RESULT
Simulation datapeptide detectablity is set to vary among 0.9,0.7,0.5,0.1,0.01.shows the number of significant single-peptide proteins versus FDR, based on the proposed peptide-level presence/absence methodology. The particular simulation scenario displayed in the figure has p 1 = 0.3, with a random mixture of differential presence/absence, ranging over p d = 0.1,0.2,...,0.6. The unweighted FDR estimate is very conservative, resulting in many fewer significant peptides at a given FDR estimate, relative to the true FDR curve. The binary weighting improves this somewhat, resulting in greater power while maintaining conservative FDR estimation. In the Supplementary Materials, we include similar figures for a variety of p1 and pd values. We also include simulation-based comparisons with the Benjamini Hochberg estimator () and that of Pounds and Cheng (); the simulations suggest that our proposed FDR estimates are more powerful across the board, likely the result of our estimators having been developed specifically for the presence/absence problem.. Peptide-level error rates and power with p 1 = 0.2,0.3,0.4,0.5 and p d = 0.0,0.1,...,0.7 No. of pep = 1. Numbers of significant single-peptide proteins versus FDR for the proposed peptide-level methodology, on simulated data with p 1 = 0.3 and a mixture of differential presence/absence levels. The weighted FDR estimate is conservativeshows the number of significant five-peptide proteins versus FDR, based on the proposed protein-level presence/absence methodology. The simulation scenario in this figure is similar to that in, now with each protein having five constituent peptides. In this case, 'weighting' is carried out using the standard standard standard 0 estimate, again resulting in conservative FDR estimation. The pictures for different values of p 1 , as well as for different numbers of constituent peptides, are not qualitatively different (data not shown). Furthermore, the StoreyTibshirani FDR estimator on which theseresults are based has been shown to be quite powerful relative to other estimators, including the BenjaminiHochberg estimator (). Our final simulation contains a combination of single-and multipeptide proteins, a variety of differential expression magnitudes, with a sample size of 10 in each of the 2 comparison groups. In this case, peak intensities were simulated, from which presence/absence data were obtained, to reflect the intended real-world setting in which both intensity-based and binary presence/absence information is available.compares the proposed hybrid approach with both our 'qualitative' (presence/absence-based) and previouslypublished 'quantitative' (intensity-based) () methodology. The table shows numbers of differentially expressed proteins at an estimated FDR of 0.05, for a variety of simulation settings (varying the proportion of missing data as well as the amount and magnitude of differential expression). The hybrid approach consistently results in greater numbers of significant proteins, ata given FDR, than either of the presence/absence-or intensitybased approaches. Thus, by combining a traditional intensity-based analysis with a presence/absence analysis, we are able to supplement our findings with additional proteins of interest; these would potentially include 'one-state' proteins.
X.Wang et al.
A hybrid approach to protein differential expression
Diabetes dataThe original dataset is comprised of 177 proteins and 1396 peptides.compares the proposed hybrid approach with presence/absence-and intensity-based approaches. The hybrid approach consistently results in greater numbers of differentially expressed proteins, at a given FDR. In this case, this is largely due to the presence/absence method supplementing the intensity-based method with proteins that were filtered out of the analysis due to too many missing values. Seventeen proteins were selected by the presence/absence method but not by the intensity-based method. Of these, several have known relevance to diabetes: a ketohexokinase isoform (IPI00216136.1) (), a clusterin isoform (IPI00291262.3) (), a c8 beta chain complement component (IPI00294395.1) (), apolipoprotein E (IPI00021842.1) (), apolipoprotein C-III (IPI00021857.1) (), and apolipoprotein C-I (IPI00021855.1) (van der).
DISCUSSIONThe proposed presence/absence-based methodology is designed to enable the detection of 'one-state' (or similar) proteins that are not amenable to traditional intensity-based methods. Furthermore, we have proposed a hybrid approach that combines both intensity-and presence/absence-based analysis of a dataset, together with FDR estimation of the combined list of differentially expressed proteins. The proposed hybrid approach was demonstrated to outperform either of the intensity-or presence/absence-based methods alone. An obvious limitation to our work is its applicability to only two comparison groups. A regression-based implementation would be more generalizable, and we intend to pursue this in our future work.The choices of weights in the peptide-level and hybrid methods could undoubtedly be improved upon as well; all FDR estimates are quite conservative.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
