Motivation: Cancer is well known to be the end result of somatic mutations that disrupt normal cell division. The number of such mutations that have to be accumulated in a cell before cancer develops depends on the type of cancer. The waiting time T m until the appearance of m mutations in a cell is thus an important quantity in population genetics models of carcinogenesis. Such models are often difficult to analyze theoretically because of the complex interactions of mutation, drift and selection. They are also computationally expensive to simulate because of the large number of cells and the low mutation rate. Results: We develop an efficient algorithm for simulating the waiting time T m until m mutations under a population genetics model of cancer development. We use an exact algorithm to simulate evolution of small cell populations and coarse-grained Ï„-leaping approximation to handle large populations. We compared our hybrid simulation algorithm with the exact algorithm in small populations and with available asymptotic results for large populations. The comparison suggested that our algorithm is accurate and computationally efficient. We used the algorithm to study the waiting time for up to 20 mutations under a Moran model with variable population sizes. Our new algorithm may be useful for studying realistic models of carcinogenesis, which incorporates variable mutation rates and fitness effects. Contact
INTRODUCTIONCancer is a genetic disease caused by mutations in cancer susceptibility genes, including oncogenes, tumor suppressor genes and genetic instability genes (see e.g.for a review). Mutations that activate oncogenes can confer a selective advantage to the cell when one of the two alleles is mutated, but typically involve specific amino acid changes at specific residues of the protein. Mutations that inactivate both alleles of a tumor suppressor gene also lead to fitness benefits to the cell, and such mutations do not have to be specific as many mutations in a gene can * To whom correspondence should be addressed. disrupt its normal function (). Genetic instability refers to a diversity of changes in the genome on the nucleotide or chromosomal levels. The former is caused by mutations in the DNA repair pathways and involves substitutions, insertions or deletions of one or a few nucleotides. The latter includes gains or losses of whole chromosomes as well as inversions, deletions, duplications and translocations of large chromosomal segments. Mutations in genetic instability genes may cause increased mutation rates in the cell, leading to the so-called 'mutator phenotype' (). For example, p53 mutations may impair the detection of and response to DNA damage. Many cancers have a mutator phenotype that results from mutations in genes involved in DNA mismatch repair. It is now generally accepted that the rate-limiting step in the process of carcinogenesis is the accumulation of new mutations. Both fitness advantages and increased mutation rates can significantly shorten the waiting time until the required number of mutations. The relative importance of selection followed by clonal expansion versus raised mutation rates is somewhat controversial.argue based on a computer simulation that advantageous mutations and clonal expansion were sufficient to initiate tumor without increased mutation rates. However, if more than two mutations in tumor suppressor genes are needed for carcinogenesis, increased mutation rates appear to be an important factor. The number of mutations required for tumorigenesis depends on the type of cancer.used age-specific cancer incidence data to estimate the number of mutations necessary to develop colon cancer to be about 6.inferred from an analysis of the incidence of retinoblastoma in children that the cancer is caused by mutations to the two alleles of a gene (which was later identified to be RB1, the first tumor suppressor gene), one of which may be in the germline and inherited.analyzed data from 1022 colorectal cancers from nine hospitals in Finland and estimated that about five to six oncogenic mutations are required for hereditary cancers or seven or eight mutations for sporadic cancers. In contrast to those early studies which suggested that a handful of mutations were sufficient to cause cancer, recent efforts using next-generation sequencing technologies to identify mutations in protein-coding genes in common tumor types have in general identified far more genes (). For example, SjblomPage: 838 837843analyzed >13 000 protein-coding genes in breast and colorectal tumors, and found that individual tumors accumulate an average of  90 mutations. Only a small subset of those mutations may be 'drivers', which offer the cell a selective advantage and are responsible for carcinogenesis, while the others are 'passengers', which provide no fitness benefits to the cell but hitchhike to fixation by chance.estimated that as many as 14 mutations may be required to initiate colon cancer and as many as 20 may be involved in breast cancer (seefor an updated analysis). The early work of Armitage and Doll (1954) and Knudson (1971) has prompted a large body of theoretical work, which uses population genetics models to describe mutation, drift and selection and to study the waiting time until the accumulation of m mutations.studied a two-stage model for a population of cells evolving according to the Moran model. By assuming that the first mutation is either neutral or deleterious while the second mutation is advantageous, they studied an interesting scenario called stochastic tunneling, in which a population fixed for cells of no mutation can reach fixation for the second mutation without ever reaching fixation for the first mutation. Schweinsberg (2008) andderived the asymptotic distributions of the waiting time until m mutations. Due to the complexity of the problem, they assumed selective neutrality and a constant mutation rate. Numerical simulations were conducted to confirm analytical results, but only for small populations (10 3  10 4 ).studied the waiting time until m mutations under the WrightFisher model with large population sizes (10 6  10 9 ). With numerical simulation, they were able to show how varying population size, mutation rate and selection affect the waiting time. As pointed out by, the Moran model is more natural than the WrightFisher model for describing the evolution of somatic cells. However, simulation under the Moran model is expensive, even more expensive than under the Wright Fisher model. The large population sizes and small mutation rates mean that one has to simulate many transitions, which change the compositions of the population only slightly. In this article, we develop an approximate algorithm to simulate the waiting time until m mutations under the Moran model. We explore the similarity of the model of cancer initiation to a chemical reaction system and develop simulation algorithms that have been studied in that context. The evolutionary process of mutation, drift and selection under the Moran model is described by a variable rate Markov chain, as is a chemical reaction system. The process can be simulated using standard algorithms by generating exponential waiting times until the next event and then deciding what event has happened. This is the so-called Gillespie algorithm (). However, with a large population size, simulation using this exact algorithm is prohibitively slow. The -leaping algorithm () was proposed to speed up the simulation by leaping over a time interval  in which changes to the state and rates of the chain are expected to be small. However, this coarse-grained approximation does not work well for our problem, because of the existence of cell types whose population sizes may be small. Here we develop a hybrid algorithm that can efficiently simulate the evolutionary processes of large populations. We use the exact algorithm to simulate transitions involving small populations, which may introduce substantial changes to the rates, and coarsegrained -leaping algorithm to simulate transitions within each large population, where transitions are unlikely to cause large changes to the state and the event rates. We test our new hybrid algorithm against the exact simulation in small populations and against asymptotic results in large populations. The results suggest that the hybrid algorithm is reliable and computationally efficient. The fast simulation algorithm may be useful for studying realistic carcinogenesis models that allow different cell types to have different finesses and different mutation rates.
T.Zhu
METHODSWe consider a population of N cells, evolving according to the Moran model (). Each cell's life span is an independent exponentially distributed random variable with parameter 1. When a cell dies, it is replaced by a new cell whose parent is chosen at random from the N cells in the population (including the one being replaced). We distinguish cells by the number of mutations that have accumulated, so that a type j cell has j mutations, and a new mutation in a type j cell changes the cell to type j +1. Initially all cells are of the wild type, i.e. type 0. The mutation rate depends on the cell type, and is  j for cells of type j. Thus models of mutator phenotypes can be accommodated using the model by assuming large u j s for large j. Genes are clonally inherited, so that the daughter cell inherits the mutations of the mother cell. This process continues until a cell has accumulated m mutations, when cancer develops. We are interested in the waiting time T m until the appearance of the first type m cell. Note that cells of different types may have different fitness. In particular, new mutations may increase the fitness, so that a type j cell may be fitter than a type (j 1) cell. Each type j cell is characterized by its mutation rate  j and fitness 1+s j .The evolutionary process of the cells is described by a Markov chain. The state of the chain at time t is X(t) = (x 0 (t),x 1 (t),...,x m (t)), where x j (t) is the number of type j cells at time t. There are in total m+1 cell types. The initial state is X(0) = (N,0,...,0), and the process stops when x m (t) > 0. Suppose there are K possible events that can change the state of the chain. Note that some events do not change the system state (such as a type j cell being replaced by another type j cell), so we do not need to simulate them. Let the rates of the events be a j (X(t)) for j = 1,2,...,K, and they cause the state of the chain to change by  j. In the language of chemical reaction (), a j is the reaction rate and  j the state-change vector corresponding to reaction j. With this characterization, the Markov chain is described by the Kolmogorov forward equation (or master equation),where the transition probabilityUnder the Moran model, two kinds of events are possible in each generation:(1) A type j cell is replaced by a type j cell, with j,j = 0,...,m1, j = j. This event occurs with rate a jj = x j (1+s j )x j / m1 l=0 (1+s l )x l. Here x j cells of type j die at rate x j , and the new born cell will be of type j with probability (1+s j )x j / m1 l=0 (1+s l )x l. The state-change vector is:  jj =  j  j , where  j is a vector with the j-th element being one and others zero.(2) A type j cell mutates into type (j +1), with j = 0,...,m1. This occurs at rate a j =  j x j , and the state-change vector isWe would like to simulate the trajectories of X(t) until appearance of the first cell of type m. There are a total of m(m1)+m = m 2 possible events, and we index them as k = 1,2,...,m 2. Below we review two algorithms developed for simulating such a system: the exact simulation algorithm () and the approximate -leaping algorithm (), before describing our new hybrid algorithm.Page: 839 837843
Efficient simulation of carcinogenesis
Exact simulation algorithmOne can generate the exponential waiting time  until the next event using the total event rate, and then sample the event among all possible events in proportion to their rates.
Algorithm 1. Exact algorithmInitialization: set t = 0 and initial value X(0) = (N,0,...,0). Store the statechange vector  k ,k = 1,...,m 2 .(2) Generate the waiting time  until the next event, which is an exponentially distributed random variable with parameter a total = m 2 k=1 a k .(4) Update time as t = t + and state as X(and stop. Otherwise go back to step 1 with t = t. This algorithm is called the 'direct method' by Gillespie (1976). Some variations are possible, and furthermore, smart bookkeeping can lead to considerable improvement in its computational efficiency (). However, all those exact algorithms are prohibitively slow when the cell population sizes are large (in the order of 10 6 10 9 , say), because a total is of order N and the expectation of the waiting time between two successive events is of order 1/N.
The -leaping algorithmTo illustrate the idea of -leaping, consider the Moran model with only two cell types. The state vector is X(t) = (x 0 ,x 1 ), with N = x 0 +x 1 1. Suppose there are no mutations ( j = 0) and no selection (s j = 0), so that the model is a pure drift model. Two kinds of events drive the evolution of the population.(i) A type 0 cell is replaced by a type 1 cell with rate a 1 = x 0 x 1 /N; (ii) A type 1 cell is replaced by a type 0 cell with rate, so that the average step size in the exact algorithm (the average waiting time until the next event) is 2/N 1. However, note that each event changes X, and hence a 1 and a 2 , only by a tiny proportion. The -leaping approximation is to consider the rates a 1 (X(t 0 )) and a 2 (X(t 0 )) to be constant in a time interval t [t 0 ,t 0 +), so the numbers of occurrences of the two kinds of events over the time interval are approximately Poisson distributed with parameters a 1 (X(t 0 )) and a 2 (X(t 0 )). The leaping time  can be chosen reasonably large so that many events can be updated in one step, and yet small enough so that the changes to the rates over the time interval are small to achieve good accuracy. A widely used leaping condition () isfor all i and a small , say, in the range 0.01  0.1. The -leaping algorithm may not be reliable if any x i is small. In our model of cancer development, it is common to have some x i  O(1) (e.g. the occurrence of mutation creating a new cell type), and thus the -leaping approximation cannot be applied directly.
A novel hybrid algorithmThe exact method is very inefficient as the step size is of O(1/N). However, the -leaping algorithm is not directly usable as there may exist cell types with very small population sizes. Naive use of the -leaping algorithm may even lead to negative population sizes. We thus implement a hybrid algorithm. We partition the cell types into two subgroups depending on the population size. We then use the exact algorithm to simulate events that involve any small population, and -leaping approximation to simulate events within each large population. Similar ideas have been used to speed up the simulation of multiscale chemical reaction systems (). A cell type i belongs to the major set if x i (t) > N c , where N c is a threshold value, or to the minor set  otherwise. We set N c = 10 in our implementation. We further partition the possible events into the non-critical set , which changes only the major cell types, and the critical set , which changes at least one minor cell type. The algorithm is as follows:Algorithm 2. The hybrid algorithm Initialization: Set t = 0 and initial state X(0) = (N,0,...,0). Store the statechange vector  k ,k = 1,...,m 2 .(1) Compute rates a k = a k (X(t)),k = 1,...,m 2 .(2) Partition the cells into the major and minor sets and .((7) Update time t = t +h. If x m (t ) > 0, set T m = t and stop. Otherwise go back to step 1 with t = t. We determine the -leaping step length  by applying the -leaping condition] to the non-critical events. The rate at which x i decreases by one is x i (1x i /N)+x i  i. [x i cells of type i are dying with rate x i , and the probability that the new born cell is of the same type is x i /N. Meanwhile x i cells of type i mutate to type (i+1) cells at rate x i  i .] The rate that x i increases by one is x i (1x i /N)+x i1  i1. [N x i cells whose types are not i are dying with rate N x i , and the probability that the dying cell is replaced by a type i cell is x i /N. Meanwhile x i1 cells of type (i1) mutate to type i cells at rate x i1  i1 .] Because mutation events usually occur slowly ( i 1), we ignore them here. For a similar reason, we ignore selection here. Then x i increases or decreases by one with rate (N x i )x i /N. This rate may be assumed to be approximately constant in the time interval [t,t +] when  is small. Letbe the numbers of events that increase and decrease type i cells in the time period [t,t +), respectively. Then we haveThus, Equation (1) is satisfied as long as   /2. In all of our numerical examples, we choose = 0.04 so that the leaping step length is  = 0.02.Page: 840 837843. Parameters used in(
T.Zhu et al.
RESULTS AND DISCUSSION
The performance of the hybrid algorithm
AccuracyIn the first experiment, we examine the accuracy of our new hybrid method by comparison with the exact method for small N, and with an asymptotic result for large N. The parameters are shown in. For cases (a) and(b) ofwith N = 10 3 or 10 4 , the estimated probability density functions using the hybrid method are indistinguishable from those produced using the exact method (and b). For case (c) with N = 10 6 , the exact method is too slow to produce many samples, so we compare the hybrid method with an asymptotic result given in, which states that for a constant mutation rate and neutral evolution,(Schweinsberg, 2008: Theorem 3 or case   AN 1 on p. 1451).shows that the hybrid method and the asymptotic approximation produced nearly identical results. N = 10 4 is apparently too small for the asymptotic approximation to be reliable, as the approximation produced quite different (much shorter) waiting time compared with the exact and hybrid algorithms in.
Computational efficiencyWe compared the computational efficiency of the hybrid and exact methods, by simulating 100 samples using both methods and measuring their computational time and average step sizes. The range of population size N is from 10 3 to 10 6. Other parameters are fixed atThe results are shown in. As N increases, the time taken by the exact method increases much faster than by the hybrid method. For the exact method, the average step size is of order O(N 1 ), while for the hybrid method it remained nearly constant.
A variable population size Moran modelTo model the growth of a benign tumor (adenoma), we develop a Moran model of variable population size, with the total population size growing deterministically. The evolutionary process is described by a birthdeath process. Three kinds of events are possible in the system:(1) A type i cell mutates into a type (i+1) cell, with rate a m(2) A type i cell dies with rate a d i = x i and state-change vectorThe density functions are estimated using kernel density smoothing in R, with 210 5 ,210 5 and 10 5 samples for (a), (b) and (c), respectively. The parameters used are listed in.Moran model sampled by the exact method and under the variable population size Moran model sampled using both the exact and hybrid methods. The population size isNis isN(t) = N = 1000. The mutation rate  i = 10 3 and there is no selection (s i = 0). The densities are estimated using kernel smoothing with 10 5 samples.
Efficient simulation of carcinogenesis(3) A type i cell is born with rate a bHereNHere HereN(t) is not the real population size but the real population size N(t) fluctuates closely aroundNaround aroundN(t). To see this, note that when N(t) <  N(t), the total birth rate [which equalsNequals equalsN(t)] will be larger than the total death rate [which equals N(t)], so that N(t) will increase. Otherwise, N(t) will decrease. Note that even ifNif ifN(t) = N is a constant, the new model still differs from the original Moran model. In the latter, the real population size is strictly constant, where in the new model it fluctuates aroundNaround aroundN(t). There are 3m event types in the new model compared with m 2 in the original model. When m is large, the new model is faster to simulate than the original Moran model as determining the type of event requires fewer comparisons. We note that a slightly different variable population size Moran model was described by, in which new individuals are added into the population at a certain rate. Two numerical examples are presented, to show (i) that the variable population size Moran model approximates the original model well whe N(t) = N and (ii) the real population size can be controlled effectively byNby byN(t). In the first example, we letNlet letN(t) = N and use the exact algorithm to simulate under the original Moran model, and both the exact and the hybrid methods to simulate under the variable population size Moran model. The estimated densities for the waiting time T 3 are indistinguishable among the three methods (). The variable population size Moran model approximates the original model very well. In the second example, we demonstrate thatNthat thatN(t) can effectively control the population size. We letNlet letN(t) grow logistically from 10 4 to 10 6 withNwith withN(t) = KN 0 e rt /(K +(N 0 e rt 1)) with N 0 = 10 4 , K = 10 7 and r = 0.001.gives one sampled trajectory, sampled every 100 days. We can see thatNthat thatN(t) and the real population size N(t) are indistinguishable.plots the step sizes for the exact and hybrid algorithm. For the exact method, the step size is of order 1/N, so that the step size gets smaller as the population size increases. For the hybrid method, the step size remains at the leaping step size  = 0.02.(b)conducted computer simulations to study the waiting time to m = 20 mutations in a WrightFisher model of growing population size. The model mimics a colonic adenoma composed of 10 6 cells (1 mm 3 ) initially that grows exponentially to reach a size of 10 9 cells (1 cm 3 ) in about 12 years. Based on the data of, it is assumed that cancer will develop as soon as a cell accumulates m = 20 mutations in any of the 100 susceptible genes. Mutations occur in unmutated genes at the rate of  g = 10 7 per gene, with no back mutation. If any i of the 100 genes experience mutations, the cell will be of type i. The fitness of a type i cell is 1+s i = (1+) i , where  = 0.01.used the WrightFisher model as it allowed fast simulation even for large populations although the Moran model seemed more natural for cancer progression. Here, we use the new hybrid algorithm to simulate a similar process under the variable population Moran model. We useNuse useN(t) = N 0 exp(  t), where  = 0.0015 controls the growth rate and
Traveling waves of genetic adaptationis the average fitness of the population. A simulated trajectory is shown in, which shows a pattern of traveling waves of clonal expansion. This is because a type i cell created by a new mutation in a population of type (i1) cells has greater fitness and is thus driven to fixation by naturalPage: 842 837843The total population size is growing exponentially from 10 6 to 10 9 in about 12 years. Cell types with many mutations and thus high fitness are taking over the population successively in a pattern of traveling waves. The mutation rate is  g = 10 7 per gene and there are 100 susceptible genes, so that a type i cell mutates into a type (i+1) cell at rate  i = (100i) g. The fitness for type i cells is 1+s i = (1+) i , with  = 0.01. The parameters used here are from).and selection coefficients (s i ), estimated using kernel smoothing from 10 5 samples. The parameters used are as follows:
T.Zhu et al.selection, until the next mutation creates an even fitter type (i+1) cell. This interesting phenomena is described earlier byin a model of asexual evolution and has recently been investigated analytically by Durrett and Mayberry (2009).shows the probability density functions of T 20 , the waiting time for 20 mutations. The model used is similar to that in, but here we fixNfix fixN in the variable population size Moran model at 10 5 or 10 7. The selective benefit of each new mutation is  = 0.01 or 0.001, and the mutation rate for each of the 100 susceptible genes is  g = 10 5. While the waiting time is much shorter for largerNlarger largerN, selection has much greater impact on the waiting time.
CONCLUSIONS AND PERSPECTIVESWe have developed a new hybrid algorithm for simulating the Moran model of carcinogenesis through accumulation of mutations. We use the algorithm to study the waiting time until m mutations for a range of population sizes. For small population sizes, our algorithm produces results nearly identical to those from the exact algorithm. For large populations, the exact method is too slow but the hybrid method still works accurately and efficiently. We implement a new Moran model of variable population size, which can effectively control deterministically changing population sizes. Our simulation model is general, allowing for arbitrary mutation rates and selective coefficients for different cell types. Those features of the algorithm indicate that it may be useful for studying complex and realistic evolutionary models of cancer initiation, which may be analytically intractable. Our new hybrid simulation algorithm may be extended to accommodate more complex models of carcinogenesis. In particular, the evolutionary model we have implemented assumes a wellmixed tissue compartment without any spatial structure, in which all cells are in direct reproductive competition with each other. For certain types of cancer, it may be more realistic to model cellular differentiation and spatial structure explicitly, with stem cells generating somatic cells that undergo apoptosis in different compartments.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
