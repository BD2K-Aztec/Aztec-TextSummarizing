Ability to generate large RNA-Seq datasets created a demand for both de novo and reference based transcriptome assemblers. However, while many transcriptome assemblers are now available, there is still no unified quality assessment tool for RNA-Seq assemblies. We present rnaQUASTâ€”a tool for evaluating RNA-Seq assembly quality and benchmarking transcriptome as-semblers using reference genome and gene database. rnaQUAST calculates various metrics that demonstrate completeness and correctness levels of the assembled transcripts, and outputs them in a user-friendly report. Availability and Implementation: rnaQUAST is implemented in Python and is freely available at
IntroductionNext-generation sequencing technologies have raised a challenging problems of de novo genome and transcriptome assembly from short reads. As a result, multiple assembly tools were developed in the last decade. Even though most papers describing novel assembly approaches provide benchmarking of various tools, no unified methods for assessing assembly quality were developed until recently. While multiple tools for both reference-based and reference-free genome assembly evaluation were developed () and later used in various genomic studies (), no tool have set a standard for assessing quality of transcriptome assemblies. Although several studies provided evaluation methods () or performed independent benchmarks of RNA-Seq assemblers (), in papers describing novel transcriptome assembly software the resulting transcripts were evaluated using different in-house methods (), therefore making it difficult to compare the results across various publications. We present rnaQUASTa quality assessment tool for transcriptome assemblies, which utilizes reference genome and gene database. rnaQUAST takes assembled transcripts as an input and maps them to the reference genome using either BLAT () or GMAP (). By comparing the resulting alignments with the gene database, rnaQUAST calculates various statistics and generates a summary report. Below we describe methods implemented in rnaQUAST, present an example of summary report and compare rnaQUAST with DETONATE software ().
Methods
rnaQUAST pipelineTo evaluate quality of the assembled transcripts, rnaQUAST takes a reference genome in FASTA format and optionally its gene database in GFF/GTF format. A user can provide either a FASTA file with transcripts, which will be aligned to the given reference genome using GMAP () or BLAT () (can be selected by the user), or alternatively align transcripts to the reference genome using software of his choice (e.g. Splign () and provide alignments in PSL format. The alignments are analyzed to calculate simple metrics and then are matched against the isoforms from the gene database in order to obtain statistics that represent completeness and correctness levels of the assembly. In addition, rnaQUAST is capable of estimating gene database coverage by raw reads using STAR () or TopHat2 (). For de novo quality assessment when reference genome and gene database are unavailable, the transcripts are analyzed using BUSCO (Sim~ ao et al., 2015) and GeneMarkS-T (). To compare several transcriptome assemblies, rnaQUAST is capable of taking multiple FASTA (or PSL) files as an input.
Metrics and alignment analysisrnaQUAST calculates various metrics without using alignment information, e.g. length distribution and N50 of the assembled transcripts. Additionally, rnaQUAST computes the following statistics for the gene database: the total number of genes and isoforms, isoform and exon length distribution, average number of exons per gene, etc. To analyze transcripts' alignments, rnaQUAST firstly filters out short partial alignments (shorter than a user-defined threshold, default value is 50 bp). Such short alignments are typically caused by genomic repeats and thus are ignored. Afterwards, rnaQUAST selects the best-scored spliced alignment for each transcript. If a transcript has more than one alignment with the highest score, it is reported as multiply aligned. Otherwise, it is considered to be uniquely aligned. If the best-scored alignment is discordant (e.g. the transcript has partial alignments that are either mapped to different strands or to different chromosomes) the transcript is classified as misassembled (see the Supplementary Material for the details). Transcripts without misassemblies are analyzed to calculate such metrics as average transcript alignment fraction and mismatch rate. For the simplicity of explanation, transcript is further referred to as a sequence generated by the assembler and isoform denotes a sequence from the gene database. rnaQUAST matches best-scored alignments of non-misassembled transcripts to the isoforms' coordinates and analyzes them to estimate how well the isoforms are covered by the assembly. rnaQUAST computes such metrics as database coverage (the total number of covered bases of all isoforms divided by the total length of all isoforms) and the number of 50%/95%assembled isoforms. An isoform is considered to be x%-assembled if it has at least x% covered by a single transcript. Vice versa, to evaluate how well the assembled transcripts are covered by the isoforms, rnaQUAST estimates the number of unannotated transcripts (that align to the genome, but do not match to any isoform) and the number of 50%/95%-matched transcripts (that have corresponding fraction mapped to an isoform). Indeed, the thresholds described above (50% and 95%) can be varied by the user. Complete list of metrics reported by rnaQUAST is described in the user manual, available at http://bioinf.spbau.ru/en/rnaquast.
ResultsIn this section we demonstrate assembly quality metrics calculated by rnaQUAST and compare them with scores computed by REFEVAL and RSEM-EVAL from DETONATE software package version 1.10 (). To perform the comparison we assembled M. musculus RNA-Seq paired-end library using the following transcriptome assemblers: Trans-ABySS 1.5.3 (), IDBA-tran 1.1.1 (), SOAPdenovo-Trans 1.03 () and Trinity 2.1.1 (). IDBAtran and Trinity were run with the default parameters (k  20; 30; 40; 50; 60 for IDBA-tran and k  25 for Trinity). As for Trans-ABySS and SOAPdenovo-Trans, we ran both tools using various k-mer lengths and selected the best assemblies for the comparison. We used the number of 95%-assembled isoforms, number of misassemblies and database coverage reported by rnaQUAST as the main criteria for selecting optimal assemblies. We also included contigs produced by SPAdes 3.6.1 genome assembler (), which was run in single-cell mode (due to uneven coverage of RNA-Seq data) with the default k-mer lengths (k  21, 33, 55). Although SPAdes was not designed as a transcriptome assembler, it turned out to show decent results on RNA-Seq data. We included the most important metrics from the reports produced by rnaQUAST and DETONATE and presented them in. rnaQUAST was launched with the default parameters; REF-EVAL and RSEM-EVAL were run as recommended in the user manual (http://deweylab.biostat.wisc.edu/detonate/vignette.html). Command lines that were used to run all tools are provided in the Supplementary Material. Although there is no direct connection between rnaQUAST metrics and scores reported by the DETONATE software (seefor the details),shows that they mostly have a good correlation. To ease the comparison with DETONATE, we also added the number of 99%-assembled isoforms, since REF-EVAL uses the 99% threshold for calculating contig scores.demonstrates that Trans-ABySS assembly has the largest number of 50%-assembled isoforms and the highest database per nucleotide coverage, and at the same the highest contig recall value. On the other hand, Trans-ABySS has the largest fraction of unaligned (10%) and unannotated (25%) transcripts, which correlates with the lowest contig precision reported by REF-EVAL. IDBA-tran assembly, conversely, has the highest fraction of 50%/95%-matched transcripts (76% and 82% respectively), but the lowest database coverage, which correlates with the highest contig and nucleotide precision, and rather low contig, nucleotide and k-mer recall values. SOAPdenovo-Trans generates an accurate assembly in terms of number of misassemblies, mismatch rate and nucleotide precision, but its assembly appears to be rather fragmented (almost 77% of transcripts are shorter than 500 bp, the smallest number of 50%/ 95%/99%-assembled isoforms). Similarly, Trans-ABySS assembly also contains a lot of short sequencesabout 83% of assembled transcripts are shorter than 500 bp. Trinity and, surprisingly, SPAdes have relatively high database coverage and recall metrics, and the same time assemble the largest number of 95%/99%-assembled isoforms. However, both tools generate rather high number of misassembled contigs with SPAdes having approximately twice more misassemblies than Trinity. Elevated number of misassembled contigs in SPAdes assembly can be explained by the fact that SPAdes is a genome assembler and has no specific algorithm for detecting transcripts in the de Bruijn graph during assembly.
rnaQUASTWhile Trinity fairly has the best RSEM-EVAL score, high k-mer recall and k-mer compression score, IDBA-tran is the outsider according to these metrics, which may be explained by the small absolute number of transcripts matching to the isoforms and thus, lack of genomic k-mers in the assembly. At the same time, both TransABySS and SOAPdenovo-Trans also have decent k-mer recall, k-mer compression and RSEM-EVAL scores, but produce rather fragmented assemblies comparing to Trinity and SPAdes. Since sequence continuity is an important characteristic for the de novo transcript reconstruction, such metrics as k-mer recall, KC score and RSEM-EVAL score (which strongly correlates with k-mer scores ()) do not provide the whole picture of the evaluated assemblies. Even though rnaQUAST metrics do not have a perfect correlation with all DETONATE scores, it is important that both tools provide similar assembly ranking. While DETONATE provides quantitative assessment of the assembled transcripts by calculating different scores, rnaQUAST computes large variety of metrics leaving the decision for the user, which may prioritize metrics depending on the goals of his particular project. More statistics calculated by DETONATE and rnaQUAST on various RNA-Seq datasets (including strand-specific), as well as examples of plots generated by rnaQUAST are provided in the Supplementary Material.
Funding
.98M. musculus gene database () contains 38924 genes (22572 protein-coding) and 94545 isoforms (47394 protein-coding). In each row the best values are indicated with bold italic. For the transcript metrics (rows 39) we highlighted the best relative values i.e. divided by the total number of transcripts in the corresponding assembly.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
E.Bushmanova et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
