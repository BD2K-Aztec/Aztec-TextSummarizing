Motivation: Blood cell development is thought to be controlled by a circuit of transcription factors (TFs) and chromatin modifications that determine the cell fate through activating cell type-specific expression programs. To shed light on the interplay between histone marks and TFs during blood cell development, we model gene expression from regulatory signals by means of combinations of sparse linear regression models. Results: The mixture of sparse linear regression models was able to improve the gene expression prediction in relation to the use of a single linear model. Moreover, it performed an efficient selection of regulatory signals even when analyzing all TFs with known motifs (>600). The method identified interesting roles for histone modifications and a selection of TFs related to blood development and chromatin remodelling. Availability: The method and datasets are available from
INTRODUCTIONBlood development in mammals is an ideal system to study cell differentiation and proliferation. All blood cells arise from a single multipotent hematopoietic stem cell (HSC). This stem cell can differentiate in lymphoid and myeloid progenitors, which will give rise to erythrocytes and immune cells such as monocytes, megakaryocytes, B and T cells (). The different cell types are distinguishable by specific cell surface proteins and can readily be obtained from the blood of adult individuals through cell sorting. For the purified cell populations, cell type-specific expression profiles and DNAprotein interactions can subsequently be obtained using microarrays and chromatin immunoprecipitation (ChIP) assays (). Blood cell development is thought to be controlled by a circuit of transcription factors (TFs), that determine the cell fate through activating cell type-specific expression programs (). * To whom correspondence should be addressed.In addition, there is an increasing awareness of the role of chromatin structure in regulating expression during development (). In particular, the presence or absence of posttranscriptional histone modifications (HMs), termed the 'histone code', modulates the affinity of histones to DNA and thus determines whether a DNA region is accessible for the transcriptional machinery (). For instance, the histone marks H3k4me3, H3k79me and H3kac are known to be associated with genes that are either actively transcribed or whose transcription is readily activated upon stimulus while promoters bearing the histone marks H3k27me3 and H3k9me3 tend to be inactive. Understanding the interplay between particular HMs and TF binding is crucial for uncovering cell differentiation processes. To shed light on the interplay between histone marks and TFs during blood cell development, in this study we model gene expression by means of combinations of linear regression models. The main idea behind this approach is to combine all regulatory signals to explain the expression pattern of the genes, as TFs and HMs can act in a multi-functional manner, conveying both transcriptional repression and activation depending on their location with respect to the transcription start site (TSS) and the presence of other TFs in the surroundings (). The value of the regression coefficients thereby indicates not only the importance of a particular regulatory signal () but also whether a signal activates or represses transcription. We have recently shown that combining more than one regression model in a mixture, where each of the regression models explains the expression of a particular group of genes, improves the expression prediction and identification of important regulatory players (). Previous works were however based on the analysis of only a small subset of possible regulatory signals (<100) (), as standard linear regression suffers from over-fitting on high-dimensional space (). In addition, regulatory signals tend to be correlated, with a given subset of TFs and/or HMs being present on the same group of promoters. Although it is important that the model indicates all regulatory signals that are important to a particular cell type, standard regression models give arbitrary coefficients for correlated (or co-linear) variables, failing to give a proper interpretation of all important variables (). Here, we propose a novel methodology, mixture of sparse linear regression models, to describe the expression of genes. Sparse linear models perform a time efficient selection of important features even in the presence of a high number of regression variables. The sparse model is determined. The elastic net displays the so-called grouping effect, that is, co-linear variables are simultaneously included in or excluded from the model and all grouped variables have equivalent regression coefficients (). Therefore, our method is not only capable of analyzing all TFs with known motifs (>600) but also allows to identify all regulatory signals (co-linear or not), which play an important role in a particular cell type.
Related workThe use of linear regression methods for predicting gene expression from TF binding sites were first proposed in, and regarding HMs, in, the problem of the dimensionality was approached with a computationally expensive backward feature selection.performed the prediction of gene expression on stem cells from a few TF binding sites derived from genome wide chromatin immunoprecipitation assays. Later, Park and Nakai (2011) proposed an extension of this work by integrating HM and DNA methylation data. The method was based on an initial discretization of histone marks to detect epigenetic states and indicated an advantage in combining both data types. Recently,proposed a methodology for predicting the expression over genomic regions, as measured by RNA-Seq, for >50 regulatory signals during Caenorhabditis Elegans development. Regression predictions were based on a Support vector machine (SVM), which can deal with high dimensionality but did not indicated feature importance.
METHODS
Sparse linear regressionHere, we propose the use of a mixture of sparse linear models for modeling the expression of genes given their regulatory signals: presence of HMs or TF binding sites in the promoter region of a gene. Let y i be the gene expression level of gene i (the dependent variable), and x i = (x i1 ,...,x iP ) be a vector with the P regulatory signals (the regressor variables) of gene i, where i = 1,..,N. A single linear regression model can be defined aswhere B is a vector (b 1 ,...,b P ) T representing regression coefficients and i is an error term (we ignore for simplicity the b 0 coefficient). We use an Elastic Net estimation for obtaining a sparse linear model (). For a given data X and Y, where X is a set on N observations x i and Y a vector with N observations y i , the elastic net is based on finding B, which minimizes the criterion ()where |B|= P j=1 |b j | and |B| 2 2 = ( P j=1 b 2 j ). The last two terms on the right are the L 1 and L 2 penalizations. The L 1 penalty, also denoted as lasso penalty, performs feature selection by shrinking some of the coefficients until reaching zero (). The L 2 penalty shrinks coefficients towards zero and is equivalent to the ridge regression (). However, the L 2 penalty does not perform feature selection as it is unable to assign zero values to coefficients. The parameter  1 gives the stringency of the penalizations and  2 , which varies from 0 to 1, balances between the L 1 and L 2 penalties. The main advantage of the elastic net is the so-called 'grouping effect', that is, highly correlated variables tend to be either included or excluded from the model in groups (). Such an effect is not present in the lasso penalization alone, which tends to include only one of the correlated features in the model.
Bayesian elastic netWe use a Bayesian interpretation of the elastic net. Therefore, we can easily plug in the models in a mixture model framework. Assuming the error in equation (1) follows a Normal distribution with variance  2 , the linear regression model has the following distribution:As pointed out by (), the L 1 and L 2 penalization terms are equivalent to a Laplace and Gaussian distribution, respectively, with mean 0,
Inferring epigenetic and transcriptional regulationthat iswhere 0 P is a P-dimensional vector with entries equal to 0 and I P is a P P identity matrix. We use a gamma distribution as prior to regularize  2 ()where a and b are hyper-parameters. Maximum-a-posteriori (MAP) estimates of the regression parameters can be determined by maximizing the posterior distributionIt is straightforward to see that the log of the posterior distribution is equivalent to equation (2) forTherefore, the minimization of B for fixed  2 ,  1 and  2 is equivalent to the Elastic net and any algorithm for solving the Elastic Net can be applied.
Mixture of sparse linear modelsA mixture of linear regression models is obtained by a convex summation ofwhere  = ( 1 ,..., K ) are the mixture coefficients such that  k  0, K k=1  k = 1 and are the model parameters (,B 1 ,...,B K , 2 1 ,..., 2 K ). For given data X and Y, where X is a set on N observations x i and Y a vector with N observations y i , the mixture of sparse linear models is estimated with a (MAP) version of the expectationmaximization (EM) algorithm (). The EM algorithm finding estimates that maximize the posterior distribution over the data X and Y ,where Z is the vector of hidden variables with z i {1,...,K} indicating which linear model an observation i belongs to and P(Y ,is the complete data likelihood. P() is the prior distribution over the model parameterswhere P() follows a Dirichlet distribution and P(B k ) and P( 2 k ) are equal to the Elastic Net priors defined in equation (6). The EM algorithm works by iteratively estimating the posterior probabilities that an observation belongs to a linear model and the parameters of the linear models until convergence. Let r ik be the posterior probability (or responsibility) () that observation i belongs to the linear model k:Considering the linear model parameters,  2 k is estimated as follows:where a and b are hyper-parameters. This is an approximation of  2 k , which is independent of the shrinkage of B k , and yields good empirical results (). The estimator of B k is analogous to the Elastic Net. Here we use an efficient implementation of the algorithm based on gradient descent described in, where observations are weighted by their posterior probabilities to give estimates for each mixture component.
Data
TF affinityIn this work, we use the Transcription factor Affinity Prediction (TRAP) approach () to predict the binding affinity of a given TF to a given promoter sequence. The TRAP method computes a continuous score estimating the expected number N of TFs bound to the promoter. As input, TRAP takes for each TF a position frequency matrix (PFM) suitable for computing mismatch energies and a DNA sequence of interest (seefor details). PFMs represent how often a given base occurs at a given position within a set of aligned known binding sites of a TF. In our study, we use 599 PFMs from the Transfac database version 11.1 (). To minimize the number of false-binding predictions, we limit the analysis to proximal promoters covering the first 200 bp upstream of the TSSs of the genes. In the end, we obtain a matrix X containing the TF binding predictions, where x i,j corresponds to the affinity of TF j to the promoter of gene i.
Blood gene expression and HM dataAffymetrix mRNA expression data were obtained from the Gene Expression Omnibus (GEO) database for HSCs, multipotent progenitors (MPPs), megakaryocyte/erythrocyte progenitors (PreMegE) and CD4+ T cells (TCD4) in Mus musculus (GEO accession number GSE18669). We use the MAS5 normalized data provided by the authors (). Final expression values are computed by taking the median of replicates followed by a log transformation. In addition, for each of the above cell types, we also obtained the binding location of the histone marks H3K4me3, H3K79me2, H3ac, H3K9me3 and H3K27me3 (). These HM data were measured with mini ChIP-chip experiments and are available from GEO (accession number GSE18734). For computing the histone mark profiles, we use the MA2C program () using a window-size of 1000 bp at P-value cutoffs of 0.5 and the minimum number of probes required in the sliding window to be 5. The choice of a high P-value is based on the fact that we want continuous location measurements over the most possible genes regardless of the presence of a peak. Bound regions are annotated with the CEAS program (). All analysis are based on the genome version NCBI36/MM8. As 'regulatory signal', for each gene and histone mark, we compute the sum of the binding signals in the region  1000 bps around the respective TSS. HM values are incremented by a small value (0.0001) to avoid zeros and then log-transformed. For subsequent analysis, we excluded genes for which less than two histone were measured. Previous studies have shown that CpG rich promoters tend to be active in many tissues and contain few cell type-specific TF binding signals while CpG depleted promoters are often active in a cell type-specific manner and have cell type-specific TF binding sites close to their TSS (). We therefore restrict our analysis to those 4089 genes which have CpG-depleted promoters (normalized CpG content < 0.5). Finally, each binding signal is normalized to have mean equal 0 and standard deviation equal 1 across all genes.
ES gene expression, HM and TF dataAs a second test case, we obtained a gene expression dataset from murine embryonic stem (ES) cells (). In addition, we downloaded ChIP-Seq binding location data for the histone marks H3K4me3, H3K36me3, H3K9me3, H4K20me3 and H3K27me3 from () as well as for the TFs E2f1, n-Myc, Zfx, c-Myc, Klf4, Tcfcp2l1, Esrrb, Nanog, Oct4, Sox2, Stat3 and Smad1 from Park and Nakai (2011) (GEO accessions GSE18734, GSE12241 and GSE11431). For normalization of the data, we applied the same pipeline as describe above.
Experimental designWe perform mixture estimation for modeling expression in four hematopoietic cell types (HSC, MPP, PreMegE and Tcd4) and one ES cell. We use in each scenario either TF affinities, HM and their combination (HM/TF). We vary the number of linear models from 1 to 10, the parameter  2 is set to 0.5 and  1 is varied within (0,0.01,0.05,0.1,0.5,1.0). The choice
T.G.do Rego et al.of  2 represents the most parsimonious parametrization: L 1 and L 2 penalty are equal. The choice of  1 , which is the main parameter controlling model sparsity, varies from no sparsity (0) to very high sparsity (>1). We use the Bayesian Information Criterion (BIC) as defined in () to indicate the best  1 parameterization. BIC is a model selection procedure that indicates which models present the best tradeoff between fit of the data and model complexity. A mixture with several models and using all regulatory signals can yield a good fit to the training data, but due to its complexity will most likely over-fit the data. To evaluate the performance of the best  1 parameterization as indicated by the BIC criteria, we perform a costly but more powerful 10-fold cross-validation procedure and measure the normalized mean squared regression error (NMSE).Lastly, we use a statistical test proposed byto identify the regression coefficients which are significantly distinct from 0. This test takes into consideration the penalization imposed by the Elastic Net and sample size. The method implementation is based on Pymix () and is freely available at http://www.cin.ufpe.br/igcf/SparseMix.
RESULTS AND DISCUSSIONIn the following, we apply our method for predicting gene expression using HM data, TF or HM data in combination with TF (HM/TF) binding predictions as input. The quality of the expression predictions made by our algorithm relies on identifying the appropriate number of regression models to be used as well as on the optimal model parameter  1 which determines how many regulatory signals will be used in the predictions. The larger the  1 , the smaller is the number of regulatory signals used in the model.
Predicting gene expression in blood cellsWe apply our regression model to four mouse blood cell types () for which both mRNA expression data as well as histone binding data are available (). To identify the optimal settings for our algorithm, we apply the model selection criteria BIC (see Section 2.5 for details). BIC indicates that using two regression models and  1 = 0.05 for HM data,  1 = 0.1 for TF and  1 = 0.01 for HM/TF data are optimal to predict gene expression over all cell types. We base the further analysis on these model selections. For predicting gene expression in HSC cells and HM data alone using two linear models, the algorithm selects four histone marks out of five available while for the highly dimensional scenario with TF data only 67 regulatory signals out of 599 were selected. For HM/TF data, 39 regulatory signals out of 604 are selected. As desired the feature selection is more stringent when providing also TF data. This indicates that HM signals are more predictive of gene expression and as expected not all TFs are relevant for the cell types analyzed. Another interesting aspect is the robustness with which specific regulatory signals are selected by the mixture with different number of linear models. For HSC cells with HM and TF combined, the number of selected regulatory signals for 1 to 10 models are 4, 29, 51, 54, 55, 55, 55, 55, 55 and 55, respectively. We observe that more regulatory signals are retained when more linear models are added. Importantly, the signals selected by the simple mixtures are thereby retained in the more complex ones, demonstrating a high degree of robustness (see Supplementary Material for complete data).To further evaluate the appropriate number of regression models, we perform a cross-validation procedure using the optimal values of  1 as indicated by BIC. As shown in, compared with the single linear model NMSE improves significantly when two models are used (paired t-test P-value <0.01). However, no significant difference was found when comparing the NMSE from two linear models with that of three or more linear models. Interestingly, the two linear models always separate the data into high and low expression genes on all blood cells. For instance, on HSC and HM data, the high expression module has a mean expression of 4.9 (1.6 std) over 790 genes and the low expression a mean of 2.5 (0.85 std) over 3297 genes (see supplement for a histogram with expression distributions). Similar results are found for all cell types or with TF data. Note that some genes belonging to the low expression models also display some level of expression and we cannot make assumptions about their activity. A close look at the relation between the main regulatory signals controlling HSC expression reveals that mixture models improve the prediction by capturing non-linearities. As exemplified in, in HSCs the repressive histone mark H3k27me3 is found on all low expression genes with similar frequency while for high expression genes, the amount of H3k27me3 is inversely proportional to expression level. As shown in, the use of combined HM/TF data results in the smallest NMSE in all cell types. A paired t-test (P-value <0.05) indicates a significant NMSE improvement for HM/TF data in several cases (see * marks in). In Sections 3.3 and 3.4, we will look at predictions for individual histone marks and TFs based on the HM/TF data. An alternative to use NMSE for evaluating the gene expression prediction is to compute Pearson correlation coefficients. For HM data on HSC, we obtain a correlation coefficient of 0.54 for one model and 0.75 for two models. This correlation coefficient is smaller than reported in, which was 0.72 for low CpG genes for a single linear model based on H3K4me3 and H3K79me2 histone markers on T CD4 cells. We stress however that the T CD4 data used inwere based on ChIP-Seq, which yield more precise histone location signals than the mini-ChIP-Chip protocol used in the blood cells.
Inferring epigenetic and transcriptional regulation
Predicting gene expression in ES cellsAs a second and independent test case for validating the expression prediction power of the proposed method, we applied the mixture of sparse linear models to an embryonic stem ES cell dataset, which contains gene expression and ChIP-Seq measurements for five HMs and 12 TFs (). For this dataset, BIC indicates that two models with  1 = 0.01 are optimal, while NMSE obtained after cross-validation indicates three models to be optimal. Pearson correlation coefficients for 1, 2 and 3 models are thereby 0.68, 0.76 and 0.89, respectively, demonstrating a clear improvement of the mixture models over a single linear regression model. Similarly to what was obtained for blood cells, the mixture consists of a low expression model capturing 3312 genes and, in this case, two high expression models capturing the expression of 451 and 476 genes. This again suggests that there exist distinct modes of regulatory control for lowly and highly expressed genes (for detailed results see supplement).
Inferred role of histone marks in blood cellsIn this section, we analyze the specific effects of the HMs H3K4me3, H3K79me2, H3ac, H3K9me3 and H3K27me3 on gene expression in blood cells as indicated by the optimal model obtained in Section 3.1 (two linear models and  1 = 0.05). The relevance of a particular modification can be estimated from the regression coefficients of the optimal linear model. That is, we apply a statistical test () that indicates how significantly a particular coefficient deviates from zero for each of the regression models. In, we display the significant coefficients of the HMs as obtained for the models for lowly and highly expressed genes across all blood cell types. For highly expressed genes, H3k79me2 shows significant positive association with gene expression levels across all cell types while H3ac and H3K4me3 have significant positive association in MPP and T cells. For genes with low expression, H3K4me3 is positively associated with expression in MPP and T cells and H3k79me2 in HSC and PreMegE cells. These findings are mostly in accordance with previous works (), where these modifications are related to active promoters and expressed genes. Considering repressive marks, we observe that for genes with high expression both H3k9me3 and H3k27me3 have negative coefficients in HSC, MPP and T cells. For PreMegE, only H3k27me3 has a significant negative coefficient. For the group of lowly expressed genes, only H3k9me3 in MPP cell obtained a significant negative coefficient.Importantly, the selection of histone marks and their regulatory role indicated by the models is highly robust against changes in the complexity of the mixture model. The only exceptions are the positive correlation between H3ac and H3k79me2 with expression in MPP cells which was only detected with the mixture model as well as the association of H3k4me3 in HSC and PreMegE which was only detected with the single model. Therefore, the simple linear model and the mixture model appear largely equivalent with respect to correctly inferring the role of histone marks on expression, despite the clear advantage of the mixture model for predicting gene expression levels.
HM
Inferred role of TFs in blood cellsIn addition to the modifications of histones, we also observe the effects of TFs in the four blood cell types (two linear models,  1 = 0.01 and HM/TF data). Out of the 600 TFs, 31 had a statistical significant coefficient (P-value <0.05) in at least one condition (seefor the list of TFs). Out of the 31 TFs, 15 were related to development on hematopoietic system (E2F1, Foxj2, Nf-E2, Nrf2, Cp2, Foxd3, Hif1, Evi1, Mzf1, Gzf1, Gfi1, Arp1, Hox9Meis1B, Pax1 and Lrf), 5 with chromatin structure remodeling (Fac1, Hsf, Kaiso, Sp1 and Egr-1), 7 embryonic development (Pax6, Axl4, Pbx, Pax4, Rbpjk, Rfx1 and ChCh) and only 3 had no relation to hematopoiesis (Cap1, Lxr and Cdx-1). See supplement for an detailed discussion of these factors. This indicates a clear enrichment of recovering TFs related to chromatin reorganization,hematopoiesis and development. Moreover, the results with a single linear model had none TF with a significant regression coefficient value. These indicates the power of the mixture of sparse linear models in recovering interesting TF candidates from hundreds of candidates. We concentrate our discussion on TFs with potential chromatin remodeling function. Of the selected TFs, 11 are involved in the activation process of expression in genes associated with high expression (top). The TF FAC1also known as Bptfis present in the process of gene activation in HSC, MPP and T-cell. This gene is a component of the NURF complex, which is known to promote trimethylation of the H3 lysine 4 and gene activation in mammals (). Another protein that has been related to immune cell development is HSF (), which acts as a activator of expression in HSC and PreMegE cells. This protein has been recently implicated with histone acetylation and gene activation in mammals (). On the other hand, 15 TFs were involved in the repression of expression in genes associated with high expression (top). Of those, Kaiso is a known chromatin remodeling factor. Kaiso is known to bind to methylated DNA and the recruitment of H3 lysine 9 methylation and gene repression (). Regarding the five TFs related to group of low expressed genes, the method detects two chromatin-related proteins Sp1 and Egr-1 (seebottom). Sp1, which is indicated to be active in all cell types, has a known role in chromatin modeling by interacting with HDAC enzymes or p300 for either repressing or promoting gene expression (). Another gene with a putative chromatin remodeling role is Egr-1 (Krox). This gene was detected as an activator of gene expression in HSC and MPP cells. It interacts with EP300 and CBP, which are known to promote histone acetylation and activation of expression (). These examples demonstrate the recovery of a TFs with chromatin remodeling roles and the accurate prediction of their functional role (repression or activation). Note that most of these predictions were not previously characterized in hematopoiesis.
CONCLUSIONWe have developed a novel method for predicting gene expression that combines the use of linear mixture models with an efficient way to select the relevant predictor variables from a large set of regulatory signals. The approach is ideally suited to integrate high-dimensional data normally not applicable in standard linear regression analysis. For instance, when provided the full set of binding affinities from vertebrate TRANSFAC matrices together with HM data to model gene expression in blood cells, the algorithm performed a sparse selection retaining only 29 out of over 600 input variables. The resulting sparse linear mixture models not only significantly improved gene expression predictions by capturing non-linear relations with the retained regulatory signals but also allowed to readily identify and characterize the relevant regulatory signals. In particular, the model predicted known roles of HMs and could select a small set of TFs related to development and hematopoiesis to particular developmental stages. The proposed method has three main parameters to be optimized (K,  1 and  2 ) and at the moment cannot make use of the regularization paths () together with the EM algorithm. Further work will thus be required to develop efficient methods for optimizing the parameters. In addition, TF binding affinities can accurately be predicted only for proximal promoters and well-conserved upstream elements. The addition of epigenetic information, which can further characterize distal enhancers and active promoters (), is likely to improve the TF binding predictions and is current work in progress. Large consortia such as the Epigenetic Roadmap, ENCODE and Blueprint Epigenome are releasing expression, epigenetic and binding data on an unprecedented scale. Although our approach offers a new way to integration such large-scale datasets it remains a big challenge to further unravel the regulatory mechanisms underlying the developmental processes shaping the human body.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
