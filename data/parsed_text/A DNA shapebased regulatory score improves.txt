Motivation: The position-weight matrix (PWM) is a useful representation of a transcription factor binding site (TFBS) sequence pattern because the PWM can be estimated from a small number of representative TFBS sequences. However, because the PWM probability model assumes independence between individual nucleotide positions, the PWMs for some TFs poorly discriminate binding sites from non-binding-sites that have similar sequence content. Since the local three-dimensional DNA structure ('shape') is a determinant of TF binding specificity and since DNA shape has a significant sequence-dependence, we combined DNA shape-derived features into a TF-generalized regulatory score and tested whether the score could improve PWM-based discrimination of TFBS from non-binding-sites. Results: We compared a traditional PWM model to a model that combines the PWM with a DNA shape feature-based regulatory potential score, for accuracy in detecting binding sites for 75 vertebrate transcription factors. The PWM Ã¾ shape model was more accurate than the PWM-only model, for 45% of TFs tested, with no significant loss of accuracy for the remaining TFs. Availability and implementation: The shape-based model is available as an open-source R package at that is archived on the GitHub software repository at https://github.com/ramseylab/ regshape/.
IntroductionBinding of a transcription factor (TF) to its cognate binding site in DNA is a fundamental mechanism in gene regulation. Computational recognition of TF binding sites (TFBSs) within the noncoding genome is both a powerful source of mechanistic insights from gene expression data () and a central problem in bioinformatics. Experimentally, the binding sites for a TF can be mapped genome-wide using a ChIP-seq assay (), but applying ChIP-seq for each of the $2000 mammalian TFs or starting from rare cell populations is infeasible due to the need for high-affinity antibodies and/or due to the significant amount of chromatin required (). In comparison, in silico TFBS recognition is unmatched in terms of the breadth of potential TF regulators that can be simultaneously considered. A cornerstone of computational strategies for TFBS recognition is the encoding of a TF's binding site sequence pattern (learned from representative TFBS sequences) in a position-weight matrix (PWM) (). Uncharacterized noncoding DNA sequence is then scanned to identify high-scoring matches to the PWM, which are taken as probable TFBSs. The PWM is efficient for scanning, but as a standalone predictor it has high false-positive rates () because of the cell type-orcondition-dependent local epigenetic state (), limited representative binding sites for PWM estimation () and the fact that TFTFBS affinity can depend on combinations of nucleotides within the site (). Frameworks that are used to integrate such correlates include logistic regression (), the support vector machine (), Bayesian networks (), data fusion (), linear threshold model (), hidden Markov model () and Random Forest (). Extensions of PWM-based methods have been proposed that incorporate features that correlate with the probability that a basepair (bp) position coincides with a regulatory element (). Such correlates include phylogenetic conservation, (), TFBS co-localization (), nucleosome positioning (), histone acetylation (), motif conservation and TFBS co-localization () and chromatin signatures (). Methods that directly incorporate a PWM are valuable because for many TFs, a PWM is available but representative binding site sequences in the genome are not, such as for PWMs obtained from protein-binding arrays () or from structural modeling of the proteinDNA complex (). A new potential correlate, local DNA 'shape,' is suggested by the demonstration that TF binding site specificity depends on the sequence-dependent, three-dimensional shape of DNA (). Improvements in Monte Carlo-based modeling and in molecular dynamics-based modeling of DNA structure have enabled the development of DNAShape, a model that predicts local structural shape parameters for the DNA double helix (in a standardized reference frame and coordinate system;) from sliding pentamer DNA subsequences (). Here, we report the development of a classifier ('DNA shape classifier') for predicting whether a short (832 bp) DNA sequence from the noncoding genome is a TFBS for any TF, or whether it is a non-binding-site sequence. This generic classifier is based on a novel proceduredescribed hereinfor extracting sequence lengthindependent features from bp-level DNA shape parameters within the binding site. We then combined the DNA shape classifier score with the TF-specific PWM log-likelihood score () into an integrated model for TFBS prediction. Importantly, beyond the dependence of the PWM on representative binding site sequences, the model does not require any TF-specific training or parameter estimation. We compared the accuracy of the PWMshape model versus a PWM-only model for discriminating TF-specific binding sites within noncoding promoter model sequences, and we found that the shape classifier improved the positive predictive value (PPV) for TFBS recognition, for 34 out of the 75 TFs that we tested; for the remaining TFs, the PPV of the PWMshape model was not significantly lower than that of the PWM model.
Methods
TFBS and noncoding sequencesRepresentative binding site sequences St for each vertebrate TF t 2 {1,...,75} (jStj ! 45, 8t, and jS t j t  11 200) were obtained from the JASPAR (release 5.0) and TFBSShape () databases. For identifying non-regulatory genomic regions within 5 kb of transcription start sites, PeakSeq-processed () peak files in UCSC BED format for 457 human ChIP-seq experiments (spanning 119 TFs and 77 cell types) were obtained from the January 2011 data release of the ENCODE Project (). A BED feature file of all regions of noncoding DNA in the human genome within 65 kb of transcription start sites (TSSs) of all RefSeq NM transcripts was constructed from exon, transcript, and UTR features obtained from Ensembl release 74 (GRCh37 assembly). All TFBS peaks were combined (basepair-level union) into a single feature file that was used to mask the noncoding regions to obtain a feature file of all noncoding, TFBS-depleted, TSS-proximal ('NCTDTP') regions. DNA sequence was obtained for the NCTDTP feature file ('NCTDTP sequences') using the UCSC Genome Browser (GRCh37.p10). Unknown (i.e. 'N') basepairs were treated as sequence gaps. For TFBS recognition for a TF with a PWM of length l (which ranged from 8 to 32 bp over the set of 75 TFs), the length l sequences from the core of the multiply aligned set of representative binding sites for the TF was used as the positive set of cases and as negative cases we used length-l subsequences from the NCTDTP sequences (sampled as described in Section 2.3).
Quantification of local DNA shape of TFBSNon-gap-spanning pentamer subsequences were obtained for each TFBS or NCTDTP sequence (for the latter, pentamers were sampled, see Section 2.3). Using the DNAShape model, absolute shape parameters were obtained for the central bp of each pentamer (propeller twist  ProT, minor groove width  MGW) and for the shape changes between central basepairs of two pentamer sequences that are shifted by one bp (helix twist  HelT, roll; 'stepped' parameters). Because binding site PWMs for different TFs have different bp lengths, bp-level shape parameter values for each TFBS sequence were reduced to length-independent summary statistics. Specifically, from the l  3 values for a 'stepped' shape parameter for a sequence of length l (or l  4 values for an 'absolute' shape parameter), five l-independent features were extracted, as shown in: ('max value', 'min value', 'max width', 'max height' and 'average').[Features are defined as follows: 'max value' indicates the maximum value for the shape parameter over all bp in the sequence, 'minPerformance comparison for three classifiers for discriminating TFBS sequences (in general, not specific to a particular TF) from non-binding-site, noncoding sequences (see Section 2.3). SVM, support vector machine (); AUC, area under the sensitivity versus False-positive error rate curve (i.e. 'ROC curve'); ADA, additive logistic regression (). AUC of an unbiased random classifier would be 0.5. (C) Data integration strategy value' indicates the minimum value, 'max width' is the maximum number of base pairs covered by one peak. 'max length' is a feature describing the maximum difference between peak and bottom, 'average' is the average parameter value for this sequence.] Thus, each sequence was reduced to 20 shape summary values.
DNA shape-based regulatory sequence classifierA local DNA shape-based classifier was developed for discriminating short (832 bp) TFBS sequences (of any kind) from short non-TFBS, noncoding, TSS-proximal sequences. A set of 10 000 representative binding site sequences across all 75 TFs was used as the universal set of positive cases, and a universal set of 10 000 negative cases was obtained from sequences (non-gapped, and with equal length distribution to the positive cases) that were sampled from random locations and strand orientations from the NCTDTP sequence file. For each case, 20 sequence length-independent, local DNA shape-based feature values were obtained (see Section 2.2). The positive and negative cases were each randomly divided into training (1/2) and test (1/2) sets. An ensemble decision tree classifier [Random Forest (), with 500 trees and four features/ tree] was trained on the training case features. The ensemble classifier's voting fraction f(s) was used as a DNA shape-based regulatory score ('shape score') for each sequence s. Random Forest was selected because it outperformed (by area under the sensitivity versus false-positive rate curve) the other supervised classifiers (support vector machine with radial basis kernel; additive boosted logistic regression) tested on this dataset (). For performance evaluation of the TF-specific, integrated (PWM  shape) TFBS recognition model (Section 2.5), the shape-based classifier was trained for each TF while excluding all representative binding site sequences for that TF from the training dataset. The test cases were used for evaluating the TF-specific, PWM-based TFBS recognition models (Section 3), and the twofold cross-validation procedure was repeated 20 times to obtain samples of method performance. The source code for the shape score classifier, including the trained Random Forest decision trees on which it is based, are available as an open-source R software package entitled regshape, that can be downloaded and installed within an interactive R session as shown:Complete installation instructions and usage instructions are provided in the online supplementary material.
PWM scoring and threshold determinationFor each TF, the multiple alignment for the positive test cases (representative binding site sequences) corresponding to that TF (Section 2.3) were compiled into a l  4 position probability matrix (PPM) W (of 'compiled from the NCTDTP sequences. Following (), the PWM score S(W,s) for a string s of length l givenof the PWM score distribution on negative-case sequences (each of length l) from the training set, was used as the score threshold. Thus, a threshold-exceeding PWM score would be encountered on average once per 2.5 kb in sliding-window, double-stranded PWM scanning of the NCTDTP sequences.
Integrated predictions; performance evaluationFor a given TF with PPM W of length l and a given sequence s of length l, two models were used to predict whether s is a binding site for the TF or not: in the 'PWM-only' model, the sequence s is predicted to be a binding site if and only if its PWM score S(W,s) exceeds the threshold h(W) that was estimated from the distribution of PWM scores from a set of sequences of length l from the NCTDTP (Section 2.4). In the 'PWMshape' model, which does not require training, the voting fraction f(s) for the sequence is obtained from the regulatory score classifier (Section 2.3), and the sequence s is predicted to be a binding site if and only if both S(W,s) > h(W) and f(s) > 0.5 (). As a negative control, a random model was used in which the DNA shape score was sampled from the uniform distribution on. To enable exploration of the models' TFBS recognition performances on sets of positive and negative cases (l-mer sequences) with varying degrees of overlap of their PWM score distributions, the negative case sequences were composed of two setsa 'low' set of lmer subsequences selected at random NCTDTP sequence locations, and a 'high' set of l-mer subsequences of NCTDTP with high PWM scores (exceeding h(W)). The ratio r of the size of the 'low' set to the size of the 'high' set was varied between r  4 (meaning 20% of negative cases had 'high' PWM scores) and r  10 000 (meaning $0.01% of negative cases had 'high' PWM scores). The negative case set composition approach is diagrammed in.. For the model promoter analysis, 100 bp subsequences of the NCTDTP were sampled at random locations and in random orientations (without replacement), and concatenated to produce Nt sequences, each of length 1 kb. For each TF t, Nt of the 1 kb sequences were selected [where Nt  min(jStj, 450)] and Nt representative TFBS sequences were sampled from the test set (without replacement) and overwritten (one TFBS per sequence) into the Nt onekilobase sequences at random positions.
ResultsFor each of the TFs, representative binding site sequences were obtained (from databases compiled from high-throughput studies; Section 2.1) and partitioned into equal-sized training and test sets.From the training-set TFBS sequences, a PWM was estimated for each TF (Section 2.4). For each l  4 PWM W, a score threshold h(W) was obtained from the distribution of PWM match scores S(W,s) of a training set of 10 000 l-mer subsequences of noncoding, non-TFBS, TSS-proximal DNA (NCTDTP; Section 2.4). For each sequence s, a score f(s) 2representing the TF-generic, DNA shape-based regulatory score, was obtained using a random forest classifier; the classifier was trained on features extracted from local DNA shape parameters corresponding to test-case DNA sequences (Section 2.2). The PWM  shape model was then compared to the PWM-only model for TFBS recognition (Section 2.5) on both PWMlength sequences (Experiment 1) and on in silico promoter sequences into which test-set representative TFBS sequences were overwritten at random locations (Experiment 2).
Experiment 1: PWM-length sequencesFor each 4  l PWM, the performance of the PWM  shape model was compared to the PWM-only model using test-set l-mer sequences (i.e. sequences that were not included in the classifier training; Section 2.3). The test-set sequences comprised (1) half the representative binding sites for the TF (positive cases) and (2) 10 000 l-mer subsequences of noncoding, non-TFBS, TSS-proximal DNA (NCTDTP, negative cases) of which 8 000 were sampled at random locations in the NCTDTP sequence, and 2 000 were 'chance occurrences of PWM matches' selected from among l-mer subsequences of the NCTDTP that had PWM scores exceeding h(W). The performance of the two models for discriminating positive and negative test-set cases was assessed using a per-sequence positive predictive value statistic (PPV  TP/(TP  FP); TP  true-positive cases, FPs  false-positive cases). Because the more discriminating model (PWM  shape) is expected to have a lower FP rate than the PWMonly model, the PWM-only model was also compared to a combined model using random scores from the DNA shape classifier ('PWM  random'; Section 2.5). For 53 out of 73 (i.e. 72%) of TFs tested, the PWM  shape model had a higher average PPV than the PWM-only model (; Welch's t-test with a  0.05), whereas there was negligible difference in PPV between the PWM  random model and the PWM-only model. As expected, the per-sequence PPVs of the PWM  shape model and the PWM-only model were indistinguishable when the negative-case set of test sequences was entirely selected at random from the NCTDTP (i.e. when chance high-scoring matches occurred at their empirical background frequency; Supplementary); for the case of high-scoring matches occurring at their background frequency, a per-promoter PPV is a more useful measure of TFBS recognition performance, as described in Section 3.2.
Experiment 2: in silico promoter analysisTo assess the relative performance of the PWM  shape and PWMonly models for TFBS recognition on a promoter-wide basis, Nt noncoding sequences, each 1 kb in length, were sampled from NCTDTP sequences (Section 2.5). For each TF t (whose PWM length is denoted by l), 45 Nt 450 representative sequences were randomly selected from the test set of TFBS and were overwritten into an equal number of the one-kilobase sequences at random positions and orientations (one TFBS per kb sequence; Section 2.5;). In this manner, sets of Nt 'TFBS-containing' (positive) and Nt NCTDTP (negative) in silico promoter sequences were obtained, each containing 2(1000  l  1) subsequences for which PWM scores and DNA shape classifier scores were obtained (Section 2.3, 2.4). For each in silico promoter sequence p j (where j 2 {1,. .. , 2 N t } identifies the in silico promoter), the promoter-level PPV, denoted PPV(p j ), was computed across all 2(1000  l  1) subsequences (including the reverse complement), where each subsequence was treated as an individual classification case.. Combined PWMshape model improves PPV for discriminating TFBS from non-binding-site sequences, over the PWM-only model, for 53 out of 73 TFs. Bars, standard error (SE, N  20). Asterisk denotes rejection of null hypothesis of equal means, with a  0.05 (Welch's t-test)For each TF, the overall performance of each model (PWM  shape and PWM-only) was computed by averaging across the in silico promoters, i.e. by computing < PPVp j  > j. The PWM  shape model had a higher average PPV than the PWM-only model (at P < 0.05, Welch's t-test), for 34 out of the 75 TFs that were analyzed (); in no case did the PPV have a statistically significant reduction in the PWM  shape versus PWM-only model. To quantify the trade-off between sensitivity and specificity in the PWM  shape versus PWM-only model, for each TF (PWM length  l), the sensitivity and false-positive error rate for TFBS classification was computed across all l-subsequences of all of the in silico promoters. For the median over all 75 TFs, the false-positive error rate for the PWM  shape method was 12.1% lower than for the PWM-only method, while the sensitivity of the PWM  shape method was only 5.8% less than the PWM-only method (, Supplementary;).
Example of DNA shape association with TFBSA fundamental limitation of the PWM model is that the nucleotide probabilities at each nucleotide position within the PWM are independent of those in the other nucleotide positions. Thus, the PWM cannot accurately model TF-DNA binding that depends on specific nucleotide combinations at two or more positions within the binding site. In contrast to the PWM, local DNA shape in general depends on combinations of nucleotides at nearby positions. Thus, the DNA shape score can capture multi-base dependencies within a binding site sequence that can affect physical proximity to DNAcontacting residues of a TF. For example, the PWM of TF Znf263 has a purine-rich 3 0 region (positions 1921;). The frequency at which sequence 'AAA' appears in the flanking positions 1921 within a set of 15 235 representative binding site sequences (compiled from a ChIP-seq experiment;) is 1.42-fold lower than would be expected based on the PWM constructed from the representative sequences (), indicating that Znf263 has lower affinity for binding to sites that have flanking 'AAA,' than to sites containing other combinations of purines. While the PWM for Znf263 is unable to detect the lower affinity for binding to sequences containing the flanking 'AAA' despite being trained on the same set of binding site sequences (; Supplementary), the TF-general DNA shape classifier assigns lower voting fraction scores (by an average 13%) to sequences containing the flanking 'AAA'versus representative binding site sequences (P < 10 15 , Welch's t-test), despite the fact that it was not trained using representative binding site sequences for Znf263 ().
DiscussionWe report the first implementation of a TF-generalized classifier based on local DNA shape parameters that improves PWM-based TFBS prediction. For both short sequences and in silico promoters, the proposed approach significantly improved the PPV for most TFs versus the traditional PWM method. This improvement was obtained with a simple shape score-based filtering criterion that did not require any training. Overall, filtering on DNA shape score decreased type I error by more than it increased type II error. It seems likely that TFBS recognition performance could be further improved by varying the voting fraction cutoff or by considering more sophisticated methods of combining features. General TFBS recognition performance by the shape-based classifier will likely be further improved as more TF ChIP-seq datasets are added to the training dataset, both by providing a more complete set of positive TFBS cases and by further eliminating false-negative cases from the NCTDTP sequences used in training the classifier. The use of TF-agnostic regulatory correlates, such as the novel shape score reported here, complement approaches that require TF-specific training using representative TFBS sequences (), with the two approaches addressing different problem domainsTFBS enrichment screening using the broadest collection of PWMs available, versus TF-specific TFBS recognition using a substantial set of representative training cases.
FundingThe work was supported by National Institutes of Health award (HL098807 to S.A.R.), the Oregon State University Center for Genome Research and Biocomputing and the Oregon State University College of Veterinary Medicine. Conflict of Interest: none declared.. The DNA shape score is sensitive to multibase dependencies that are not captured by the PWM. (A) TFBS sequence logo for TF Znf263. (B) PWM submatrix from position 19 to 21 for TF ZNF263 (red box in A). (C) PWM scores for Znf263 before and after 'AAA' replacement (here, the suffix 'AAA' is under-represented among true binding sites). The same PWM model is used for both sets of oligomers. Bar, box and whiskers: median, interquartile range (IQR) and median 6 1.5 IQR. (D) DNA shape score for Znf263 before and after 'AAA' replacement. The same model is used for both sets of oligomers
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.Yang and S.A.Ramsey at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
