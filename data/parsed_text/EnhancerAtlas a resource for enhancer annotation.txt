Motivation: Multiple high-throughput approaches have recently been developed and allowed the discovery of enhancers on a genome scale in a single experiment. However, the datasets generated from these approaches are not fully utilized by the research community due to technical challenges such as lack of consensus enhancer annotation and integrative analytic tools. Results: We developed an interactive database, EnhancerAtlas, which contains an atlas of 2,534,123 enhancers for 105 cell/tissue types. A consensus enhancer annotation was obtained for each cell by summation of independent experimental datasets with the relative weights derived from a cross-validation approach. Moreover, EnhancerAtlas provides a set of useful analytic tools that allow users to query and compare enhancers in a particular genomic region or associated with a gene of interest, and assign enhancers and their target genes from a custom dataset. Availability and Implementation: The database with analytic tools is available at http://www.enhan ceratlas.org/.
IntroductionEnhancers are distal regulatory DNA elements that regulate transcription levels of target genes. They play an important role in development and diseases (). Unlike promoters, enhancers often regulate expression of their target genes independent of their relative location, distance or even the gene orientation (). Furthermore, enhancers are often tissue-or cell type-specific (). Due to the relative location and tissue specificity, it is challenging to identify enhancers. Recently, many technologies were developed to map the enhancers on a genome scale. (i) Clusters of transcription factor (TF) binding sites often represent regulatory elements (), and chromatin immunoprecipitation followed by sequencing (ChIP-seq) or ChIP-chip can be used to identify the binding sites of various TFs or other regulatory factors; (ii) A few enhancer-specific factors have been used to identify enhancers. For example, EP300, a histone acetyltransferase, activates transcription via acetylating the histones. Therefore, the binding sites of EP300 were often used to predict enhancers (); (iii) It was reported that RNA polymerase II (RNAPII) binds to thousands of enhancers (). Therefore, binding sites of POLR2A, the largest subunit of RNAPII, are considered to be the active regulatory regions; (iv) DNase I hypersensitivity sites (DHS) represent the open chromatin regions, many of which cover the enhancers (); (v) Formaldehyde Assisted Isolation of Regulatory Elements (FAIRE) coupled with sequencing is another method to identify large numbers of active regulatory elements including enhancers (); (vi) Some histone modification patterns reflect different chromatin states. For example, the combination of H3K4me1 and H3K27ac is a widely used mark for enhancers (); (vii) The DNA sequences of enhancers could also be transcribed and these transcribed enhancer RNAs (eRNAs) are an indicator of active enhancers (); (viii) Approaches to determine the threedimensional conformation of chromosomes (e.g. 5C and ChIA-PET, Capture-C) are able to provide enhancer-promoter interactions (). These above approaches have been demonstrated as powerful tools to detect enhancers on a genome-wide scale, and they have been applied to many cell types or tissues. However, the datasets generated by these approaches are not fully utilized by the research community due to several technical challenges. First, these datasets are often disseminated in different databases. A centralized data portal is still lacking that is specially designed for enhancer analysis. Second, enhancer annotations based on different technologies showed large discrepancies. A consensus of enhancers will provide more reliable annotation of enhancers. Third, although several genome annotation databases (e.g. UCSC Genome Browser) are currently available to visualize various datasets, they do not provide useful tools for enhancer analysis, such as comparing enhancers across different cell types, generating network views for enhancertarget interactions, and predict enhancers for a custom dataset. The goal of our work is of two-fold. First, we combined a large number of available datasets in each cell/tissue type to produce a 'consensus' of enhancers that represent the most reliable prediction of enhancers. For this purpose, we develop an unsupervised learning approach to evaluate the quality of each dataset in one cell type and generate a consensus for more reliable enhancer identification. Using this method, we produced enhancer predictions for 76 cell lines and 29 tissues. These enhancer predictions have high quality compared with single dataset. Second, we constructed a userfriendly, interactive online database, EnhancerAtlas.org, to facilitate the analysis of enhancers for different cell types. A series of analytic tools were developed to extract, compare and visualize the enhancers in different cell types.
Materials and methods
Data sourcesWe used a total of eight types of experimental approaches (i.e. tracks) to identify enhancers. They include DHS, FAIRE, eRNA, P300 binding sites, POL2 binding sites, histone modifications, TF binding sites and CHIA-PET. These tracks represent distinct experimental approaches to detect enhancers. Note that some tracks could contain multiple datasets. For example, replicates sometimes exist for the same experiments that were performed by different labs. The 'TF-Binding' track includes all ChIP-Seq datasets for different TFs in a given cell type. The 'histone' track includes the datasets for H3K4me1 and H3K27ac. To make a reliable enhancer annotation, we only used cell lines and tissues with at least three tracks. In total, 76 cell lines and 29 tissues were included. We processed and integrated 3785 high throughput datasets (). All sequencing data were mapped to the hg19 genome assembly. Since some approaches (e.g. DHS) detect all active regulatory regions, promoter and exon regions were removed in our analysis. Here promoters were defined as the region 5 kb upstream of the transcription start sites based on a location analysis of known promoters (Supplementary). In addition, matched RNA-seq data were used for predicting enhancer target genes, which were collected from UCSC genome browser, GEO database and Epigenome Roadmap data portal. In total, 48 cell lines and 22 tissues have available RNA-seq data.
Track normalizationThere are a few steps to normalize the datasets. First, to make datasets comparable, we take fold enrichment of each region as the signal intensity and normalize it in each dataset. For each genomic window of 10 bp, the normalization for each data set is defined as:Where s i and l i are the score and length of peak i (1 i n), respectively. Second, many tracks, including DHS, EP300, POL2, FAIRE, may have two or more replicates. We summed the signal intensities in normalized files into one file using bedtools () and normalized the merged file again. Furthermore, the 'TF-binding' track may contain many ChIP-seq datasets from different TFs, and 'histone modification' track contains two different modifications (H3K4me1 and H3K27ac). We also merged different TFs or modifications into one track.
Generation of consensus tracksA basic assumption of our approach is that if two datasets are of good quality, they should have a good correlation of the predicted enhancers. On the other hand, if one dataset is of low quality, it will have low correlation with other datasets. By comparing the correlations between different datasets, we obtain the relative quality for each dataset. For two given tracks A 1 and A 2 , the voting score of A 2 on A 1 was defined as the Pearson Correlation Coefficient (PCC) between A 1 and A 2 :Where Score A1 i and Score A1 represent the score at genomic position i and the mean of all position scores in track A 1 , respectively. Then a PCC matrix can be obtained from a cell line or tissue with m tracks:Based on the matrix, the weight of track A t (t 2 1; m) was set as:Note that the relative weights are not sensitive to the correlation metrics we used. For example, rank-based Spearman yielded almost identical relative weights as Pearson correlation (Supplementary). To combine all tracks, we defined the score of combined track at genomic position i as:By doing so, the score at each genomic positon in the consensus track came from reasonable weight assignments of all tracks.
Validation of enhancer predictions using the VISTA enhancer databaseTo evaluate our consensus track using experimentally validated enhancer documented in the VISTA database (), we first grouped enhancers according to their tissue types. We selected two tissues (i.e. brain and heart) with the largest number of enhancers. The brain and heart have 809 and 96 validated enhancers, respectively. Our evaluation is at base pair level. The Sensitivity S n and Specificity S p were defined as below:S n  TP TP  FN and S p  TN FP  TN
Enhancer-target gene predictionWe used a recent developed algorithm Integrated Method for Predicting Enhancer Targets (IM-PET) to predict enhancer targets (). IM-PET predicts enhancer-promoter by integrating four features using a Random Forest classifier. Features are derived from transcriptomic, epigenomic and genome sequence data, including enhancer and promoter activity correlation, TF and promoter activity correlation, enhancer and promoter sequence co-evolution and enhancer-to-promoter distance. We showed that IM-PET achieved significant improvement over other state-of-the-art methods. Further, based on our validation experiment using 3C-qPCR we showed that IM-PET has a comparable accuracy to that of the experimental 5C technology. Here, the input data for IM-PET included the genomic positions of predicted enhancers, RNA-Seq data and H3K4me1, H3K4me3, and H3K27Ac ChIP-Seq data for 48 cell lines and 22 tissues. Enhancer targets were predicted using a false discovery rate cutoff of 0.01.
Implementation of the toolsThe visualization tools in EnhancerAtlas were implemented by using html5 canvas element and PHP. The online service of EnhancerAtlas was implemented with Linux-Apache-MySQL-PHP-HTMLJavaScript-Perl and could be run on most PCs (Windows, Mac OSX or Linux). The <canvas> element of HTML was employed to draw the genomic graph and display the datasets for different approaches or cell/tissue types. In the graphic display, a jQuery UI slider widget with two handles was used to zoom in or out on the genome region. We used the plug-in, cytoscape.js, for analysis and visualization of enhancer-gene network in a given cell/tissue type. Links in the graphic presentation or tables were implemented by JavaScript or php functions.
Results
Selection of available datasetsMany approaches have been developed to map enhancers in cells. Although enhancers identified by different approaches have an overall agreement on the enhancer annotation, they showed discrepancies in many genomic regions (). A consensus of enhancers based on multiple experimental evidences will provide a more reliable enhancer annotation. In this work, we collected eight types of genome-wide experimental datasets (i.e. tracks) to identify the enhancers (). To obtain reliable enhancer annotation, we only focused on the cell/tissue types with at least three independent experimental tracks for enhancer identification (). A total of 105 cell/tissue types were collected for the enhancer annotation in the study. Note that some tracks could contain multiple datasets (e.g. replicates, multiple histone modifications for 'Histone' track or multiple TF binding datasets for 'TF-Binding' track). On the other hand, we kept the tracks for EP300 and POLR2A binding sites separated from the 'TF-binding' track, because these two proteins are important indicators for enhancers. We manually collected and integrated 3785 high throughput experimental datasets () mainly from six resources including UCSC genome browser (), NCBI GEO (), Cistrome database (), ENCODE project data portal (), Epigenome Roadmap data portal () and eRNA (). These datasets will be used to generate consensus enhancers for 105 cell/tissue types.
Unsupervised learning approach for enhancer identificationTo build a consensus of enhancer annotations from multiple datasets, one obvious option is supervised learning approach, which requires a set of validated enhancers as a gold standard. By comparing each dataset to the gold standard, we are able to assess the quality of each dataset and then assign the relative weight to each dataset. An ideal gold standard would be a set of enhancers determined by an in vivo activity-based approach. The VISTA database contains 1746 enhancers identified using comparative genome analysis and validated using mouse transgenic reporter assay (). However, since enhancers are cell type specific, a gold standard is needed for each cell type. In that sense, the dataset in the VISTA is not large enough to serve as a gold standard for most of the cell types. To overcome this challenge, we employed an unsupervised learning approach to derive the consensus of enhancers from multiple experimental evidences. Our approach evaluates the quality of each dataset by cross-validation. The underlying assumption of our approach is that if two datasets are of good quality, they should have a good correlation among the predicted enhancers. On the other hand, if one dataset is of low quality, it will have low correlations with other datasets. By comparing the correlations between different datasets, we will obtain the relative quality for each dataset. Here, we used K562 cell line as an example to elucidate our approach (). The K562 has eight tracks available for enhancer annotation, including 'DHS', 'FAIRE', 'EP300', 'POL2', 'Histone', 'TF-Binding', 'CHIA-PET' and 'eRNA'. Among them, 95 TF ChIPseq datasets in this cell type were available and used to obtain the 'TF-Binding' track. First, we normalized the signal intensity in each track to make the tracks comparable (see Section 2 for details). Next, we calculated pairwise Pearson correlation coefficient (PCC) of enhancer signals among the eight tracks. Some tracks have very similar enhancer signals (e.g. locations of EP300 and DHS, with a PCC of 0.490), while other tracks have relatively low similarity (e.g. signals between ChIA-PET and eRNA, with a PCC of 0.019). Next, we summed the correlation coefficients of each track with the other seven tracks. The sum of correlation coefficients for the eight tracks is normalized to obtain the relative weights (). Finally, we obtained the consensus track based on the weighted sum of the signals from individual tracks ().
Assessment of relative weights for different tracksAs illustrated by the example of K562, we can see that some tracks such as DHS have relatively high weights, while other tracks such as eRNA have relatively low weights. Note that the weights obtained for one particular cell type do not necessarily reflect the quality of the experimental platform in general, because the same experimental approach might be used to generate datasets with different qualities by different laboratories. We sought to assess the quality of each dataset, rather than an experimental approach. Therefore, the relative weights derived by our approach are specific to each cell type (). For instance, the relative weight for the track of 'TF-Binding' varies significantly among the cell/tissue types. In MCF-7 cell line the relative weight of 'TF-Binding' is 0.252, while the weight for the same track becomes 0.176 in HelaS3 cell line. Similarly, while eRNA has a small weight (0.03) in K562, it has a relatively high weights in other cell types. For example, the weights for eRNA in adult heart and bronchia epithelial are 0.40 and 0.20, respectively. The dynamic changes of each track among the cell/tissue types reflect the data quality of the specific dataset and the total number of tracks in the cell/tissue type of interest (). To confirm that the relative weight indeed reflects the data quality, we performed a simulation on TF binding track in K562 (). Total 95 TF ChIP-seq datasets were used for 'TF-Binding' track in K562. We assumed that the quality of track increases with more TF ChIP-seq datasets. While keeping the datasets of other tracks unchanged, we randomly removed certain numbers of TFs in the TF binding track and calculated the relative weight for the TF binding track. We found that the average relative weight decreased with fewer TFs included in the track, suggesting that relative weight of a track indeed correlated with the quality of the track (). Interestingly, we found that both repressors and activators contributed to the enhancer prediction. If we separated the TFs into activators and repressors based on their known function, we obtained 33 activators and 37 repressors with ChIP-seq data in K562. We found that the weights for both sets increased with increasing number of TFs, although the repressors' contribution was less significant than activators ().
Enhancer calling based on weighted consensus trackTo determine enhancers in the consensus track, we first performed simulation to determine the cutoff for enhancer signal intensity. For a given cell/tissue type, we shuffled each track by generating random starting positions within the same chromosome. Using the same relative weights determined as described above, a combined track based on the shuffled tracks was generated and the scores of all positions in this track were sorted. The score at the top 99.5% was selected as the cutoff. Only the peaks in the consensus track with score higher than the cutoff were called as enhancers. In addition, we had three extra criteria to determine the enhancers in the consensus track. (i) Peaks within 5 kb upstream of the transcription start sites of protein coding genes were removedbecause they are more likely to be promoters; (ii) We required that more than half of the tracks have non-zero values to call an enhancer. This filtering removed the enhancers that were only supported by one or very few experimental evidence. In other words, this criterion ensured that there were multiple independent lines of experimental evidence to support the annotation of an enhancer. (iii) We removed the enhancers smaller than 50 bp. Using the above approaches, we identified an atlas of 2 534 123 enhancers for 105 cell/tissue types ().
Validation using VISTA enhancer databaseWe next evaluated the performance of our approach. We extracted tissue-specific enhancers from the VISTA database. For example, 809 and 96 validated enhancers were found for fetal brain and heart. The other tissue types have very small number of enhancers available and are not suitable for the validation. The enhancers annotated in VISTA are grouped as a positive set. The union of the peaks in all tracks is the entire prediction space and the regions not overlapping with the positive set are considered as the negative set. We calculated the sensitivity and specificity of the consensus enhancers in the unit of base pair. For heart enhancers, the area under the receiver operating characteristic (AROC) for the consensus is 0.89, while the AROC for individual tracks are all under 0.84, suggesting that the consensus have the better enhancer annotation than any individual track. Because only binary data are available for the tracks of 'EP300', 'eRNA' and 'POL2' in heart (), they do not have an ROC curve. They showed quite good specificity (>0.95) relatively low sensitivity (<0.01) (). Similar results were observed for brain enhancers (). We also compared the performance using voting approach in which each track was assigned with uniform weight. The AROC for the fetal brain and heart were 0.70 and 0.86 using uniform weight, respectively, which were lower than the performance using our crossvalidation derived weights.
Enhancer-target gene relationshipsWe predicted the target genes of enhancers using a recent developed algorithm, namely Integrated Method for Predicting Enhancer Targets (IM-PET) (). IM-PET predicts enhancerpromoter by integrating four features using a Random Forest classifier. Features are derived from transcriptomic, epigenomic and genome sequence data, including enhancer and promoter activity correlation, TF and promoter activity correlation, enhancer and promoter sequence co-evolution and enhancer-to-promoter distance. The input data for enhancer-target prediction included the gene expression dataset (RNA-seq) and genomic positions of predicted enhancers, histone modification data for 48 cell lines and 22 tissues. Overall, we predicted 2 488 394 enhancer-target relationships for the 70 cell/tissue types. On average, one enhancer is associated with 2.4 target genes, and each gene is associated with 4.1 enhancers in one cell/tissue type.
Web serverEnhancerAtlas is accessible to the research community in the web server (http://www.enhanceratlas.org/). The database has the following features to facilitate the usage of enhancer annotation. First, users are allowed to select a particular genomic region and examine the consensus enhancers within the region. In the meantime, we also show the experimental data (individual tracks) that support the consensus. Second, users can identify the enhancers that associated with a gene of interest. Similarly, both the consensus and all the experimental tracks are shown. Third, users can compare the enhancers across different cell/tissue types. Such comparison will allow users to identify the enhancers that are conserved or specific to cell/tissue types. Fourth, we allow users to upload their own custom data and annotate the potential enhancers for their datasets. Specifically, we designed six modules to facilitate the enhancer analysis within the EnhancerAtlas (): (A) Search enhancers by region. This module would graphically display enhancers of any genomic region of interest in a selected cell/tissue type. The 'consensus' track summarizes all information, while the individual tracks are the experimental datasets from independent high-throughput approaches (). We also provide a link to the Epigenome browser () for an alternative display. (B) Search enhancers by gene name. This module would graphically show the enhancers that are associated with a given gene of interest in one special cell/tissue type. Multiple input options are provided for the gene ID, including Ensembl, EMBL, UCSC, PDB, RefSeq and UniProt (). (C) Compare enhancers across cell/tissues. Using this module, users could easily compare the enhancers across multiple selected cell/tissue typesA resource for enhancer annotation and analysisin a given genomic region and identify possible specific or conserved enhancers. If users click on one cell/tissue type in the display, supporting experimental evidence will be shown for the cell/tissue type (similar to module (A)) (); (D) Compare enhancers of genes across different cell/tissues. In this module, a common scheme often observed was that one gene is associated with different clusters of enhancers in different cell/tissue types (). By comparing enhancer-gene interactions across 105 cell lines, conserved enhancer-gene interactions can be identified. When clicking on individual cell/tissue type, users can view the detailed experimental evidence in this cell/tissue type (similar to module (B)); (E) Generate enhancer-gene network. We provide a Cytoscape network presentation between enhancers and associated. Relative weight of 'TF-Binding' track with varying number of TFs in K562. (A) Simulation results of relative weight of 'TF-Binding' track in function of number of TFs included. The weight of track decreased with fewer number of TF ChIP-seq datasets included in the track, suggesting that the relative weight reflects the data quality. (B) Simulation results of relative weight of repressors and activators. In total, 33 activators and 37 repressors with ChIP-seq data in K562 were classified by their known functions. Although the repressors have smaller weight than activators, the weights for both sets increased with increasing number of TFs. Evaluation of the consensus enhancer annotation. We used experimentally validated enhancers from VISTA database as the gold standard. Sn is the sensitivity, which represents the percentage of enhancers from VISTA recovered by different tracks. Sp is the specificity, which represents the percentage of negative regions in the prediction space (i.e. not in VISTA enhancers) that are correctly predicted as negative by the tracksgenes in a given genomic region and a cell type. Interactions that are specific to the cell type or conserved in other cell types are marked with different colors (); (F) Predict target genes in defined genomic regions. After a user has identified a set of potential cisregulatory regions (e.g. peaks identified by ChIP-seq for a TF), the user can upload the regions in bed format and select the cell types that are most relevant to the cell type of interest. This module will compare uploaded regions with the enhancers in the selected cell types and obtain the target genes of the enhancers in these cell types. If some of the uploaded regions are in promoters, the module will also provide the flanking target genes of the regulatory regions ().
Conclusions and discussionsIn this work, we developed an unsupervised learning approach to derive the consensus enhancers by integrating a variety of experimental datasets. Application of the approach to 105 cell/tissue types yielded an atlas of 2 488 394 enhancers. These consensus enhancers were of better quality than individual dataset. To facilitate the usage of the enhancer annotation, we developed EnhancerAtlas, an online database, which is specifically designed for enhancer annotation and analysis. A set of analytic tools was provided in the database. We noticed that some tracks have relatively small weights such as those for eRNAs and ChIA-PET. The main reasons are that eRNA signal often marks much less enhancers than other tracks and that the resolution of ChIA-PET is often very low. On the other hand, it is not completely surprising that eRNA and ChIA-PET have a much lower correlation with such tracks, since eRNA and ChIA-PET capture a completely different layer of genome regulation. eRNAs typically mark active enhancers, while other tracks might include all types of enhancers including active and poised enhancers. In the future, we plan to classify enhancers so that the eRNA information will be fully appreciated. While the IM-PET method showed great performance, its effectiveness has not been tested across such a diverse collection of cell types and tissues. Since it is a supervised model, the training cell types may have a significant effect on the performance of the model in different cell types. We used newly reported enhancer-promoter interactions as the gold standard to assess the quality of our IM-PET prediction (). The performance of predictions in these new cell types (AUC 0.9) are similar the predictions we evaluated in the original IM-PET prediction (). Since enhancers only occupy a tiny fraction of genome, the number of positive is much smaller than the number of negative. The imbalanced data will yield an inflated estimation of the performance. However, we are focusing on the relative performance by comparing the consensus track and each individual track. Therefore, even though the absolute AUC values might be overestimated, the relationship of relative performance should still hold. An alternative measurement would be using precision to estimate the performance. Because only a handful enhancers were validated and vast majority of enhancers were not tested, those untested enhancers are currently included in the negative set. Therefore, many corrected predicted enhancers are called as false positive and thus a deflated precision will be obtained. For example, the precision for the consensus and EP300 tracks in fetal heart are 0.00093 and 0.00013, respectively, which we do not believe reflect the quality of the datasets. A comprehensive enhancer database is always a moving target. Therefore, the database will be updated routinely as new datasets become available. For example, recently several high-throughput enhancer screens (e.g. STARR-seq) () have been reported. Similarly, more hi-C based datasets are also available for different cell types. We plan to include these new data types in the next version of the database.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
T.Gao et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
