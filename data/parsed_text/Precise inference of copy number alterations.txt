Motivation: The accurate detection of copy number alterations (CNAs) in human genomes is important for understanding susceptibility to cancer and mechanisms of tumor progression. CNA detection in tumors from single nucleotide polymorphism (SNP) genotyping arrays is a challenging problem due to phenomena such as aneuploidy, stromal contamination, genomic waves and intra-tumor heterogeneity, issues that leading methods do not optimally address. Results: Here we introduce methods and software (PennCNV-tumor) for fast and accurate CNA detection using signal intensity data from SNP genotyping arrays. We estimate stromal contamination by applying a maximum likelihood approach over multiple discrete gen-omic intervals. By conditioning on signal intensity across the genome, our method accounts for both aneuploidy and genomic waves. Finally, our method uses a hidden Markov model to integrate multiple sources of information, including total and allele-specific signal intensity at each SNP, as well as physical maps to make posterior inferences of CNAs. Using real data from cancer cell-lines and patient tumors, we demonstrate substantial improvements in accuracy and computational efficiency compared with existing methods. Availability: Source code, documentation and example datasets are freely available at http://sourceforge.net/projects/penncnv-2.
INTRODUCTIONCopy number alterations (CNAs) refer to the copy number change of a chromosomal segment that is of somatic origin, often observed in tumor tissues (). In contrast to inherited copy number variants (CNVs) present in the germline, CNAs tend to be longer and occupy a significantly larger proportion of the genome. The recent application of single nucleotide polymorphism (SNP) genotyping arrays has led to the characterization of genomic aberrations associated with cancer development and prognosis (), and some studies have investigated CNAs in cancer cell lines () and tumor subtypes (). The comprehensive characterization of CNAs in cancer genomes is critical for understanding disease etiology and for advancing the development of targeted therapies for individual cancer patients (). A number of methods have been proposed to detect both CNVs and CNAs using SNP genotyping array-based technologies such as those from Affymetrix or Illumina. Compared with array-comparative genomic hybridization (CGH) platforms, which measure only the total intensity at each marker, SNP arrays report both the overall intensities of the probe hybridization reaction for each SNP, as well as the ratio of the intensities between the two alleles. Recent versions of high-density SNP arrays have incorporated non-polymorphic markers to better interrogate genomic regions for which SNP information is not adequate or not available. By leveraging signal intensity data from SNP arrays, statistical methods can measure both total copy number and allelic states with high resolution due to the high density of SNPs featured on these microarrays (typically ranging from 500 000 to 42.5 million markers across the genome). Dozens of computational algorithms have been developed for CNV detection on SNP arrays, and these methods have already been widely used in human genetics research (). However, the problem of CNA detection is considerably more difficult than CNV detection for several reasons. First, whereas germline CNVs can be inferred based on the assumption of a baseline copy number of two, calibration of the baseline in tumors is not obvious, as tumor cells may be aneuploid (i.e. have an abnormal number of chromosomes). A second complication, known as stromal contamination, arises from the fact that samples derived from malignant tissue are often contaminated with adjacent normal tissue. Simply modeling the copy number state of the tumors may lead to inaccurate estimates, as the true copy number state is distributed as a mixture of normal and one or more tumor cells populations. Third, intra-tumor heterogeneity is now appreciated as a common feature of cancer genomes (), and subpopulations of cancer cells may harbor distinct copy number changes. Fourth, although CNAs and CNVs can both be recurrent events, CNA boundaries may be more variable in a region across samples, so sensitivity may be an issue for CNA methods. Continuous time hidden Markov Models (HMMs) are traditionally favored for modeling the underlying state space (i.e. copy number and allelic state) for CNV/CNA *To whom correspondence should be addressed. inference, as they integrate over all parameters in the model, including the spatial relationship between SNPs along the genome, allowing one to obtain both point estimates and their confidence intervals for the parameters of interest. In the current study, we present an HMM-based solution to CNA detection that addresses each of the issues specific to tumor genomes. Because several previously published methods have also considered some of these complications, we compare these with our approach and highlight its advantages.
METHODS
OverviewOur CNA calling algorithm, PennCNV-tumor, is an HMM-based method that is loosely based on the model used in PennCNV (), an algorithm developed specifically for germline CNV detection. Later in the text, we describe the key features that are unique to the proposed method. For each sample, we include global parameters that model stromal contamination () and aneuploidy (via a correction factor ), and SNP specific parameters that model intra-tumor heterogeneity ( i ), allelic imbalance (bac i ) and copy number (cn i ) at each SNP i. Aneuploidy estimation is an essential a component of chip-wide normalization in tumor samples so that a baseline Log R ratio (LRR) of 0 is assigned to SNPs whose CN corresponds to the overall DNA index (which may not equal 2 as in hypo-or hyper-diploid tumor samples). Formally, stromal contamination is the overall fraction of normal cells among a mixture of tumor and normal cells. In contrast, we characterize intratumor heterogeneity, at each SNP i, based on the fraction of subclones in addition to the dominant tumor clone. Such events may suggest functionally important somatic events during tumor progression. Allelic imbalance provides information as to which germline allele is more likely to have somatic gain/loss at heterozygous sites, offering biological insights into the functional role of germline mutations (). Furthermore, unlike CNVs that typically represent single-copy deletions or duplications, tumor CNAs often involve amplification of multiple copies. Finally, our current HMM accommodates the fact that CNA events are more prevalent and usually much larger than CNVs in cancer samples.
Estimation of stromal contaminationAlthough stromal contamination and CNA calls can in principle be simultaneously estimated, our analyses on real data suggest that CNA calls are more reliable if we first estimate stromal contamination () in a preprocessing step. The parameter can then be used in the HMM for CNA detection. To estimate , we apply a maximum likelihood estimation procedure at each contiguous k non-overlapping window (e.g. 100 markers) across the genome. We exclude non-polymorphic markers, as well as SNP markers in the sex chromosomes and mitochondria from the estimation procedure. The method leverages the fact that at regions where there is a single copy number loss or an amplification event, a mixture of tumor and stromal samples will likely shift the B allele frequency (BAF; i.e. the ratio of intensities between the B allele and both alleles) distributions for heterozygous SNPs. By default, half of the windows with the lowest average LRR values are considered. Our model assumes a baseline average heterozygosity level for the genome is already known, derived from empirical evidence (e.g. h  0.3 for Illumina 550 K array for any given Caucasian sample). For this model, rather than using the BAF, we consider the B minor allele frequency (BMAF), which is equivalent to BAF for BAF5.5 and 1-BAF in all other cases. Suppose that s is the index of the first marker of a window. We consider w candidate values for k ranging from 0 to 1 (e.g. w  50 candidates provide a resolution for k of 0.02). At each candidate c (c  1, 2,. .. , w), we compute the log-likelihood kc at a sliding window with m markers and finally choose c that maximizes the expression:where j() is the density function of a univariate Gaussian distribution. Assuming that higher BMAF values have higher variance, kc is assigned from a linear interpolation of homo and het , the standard deviations of BMAF for homozygous and heterozygous SNPs, respectively (both parameters are pre-specified in PennCNV for Illumina or Affymetrix arrays). For windows where tumor and normal copy numbers are concordant (e.g. CN  2), k is not informative and is uniformly distributed across the set of candidate values c. For informative regions however, k will be consistent. Hence, we select the mode of k , taken across all windows, as our estimate of the global parameter. The standard deviation parameters homo and het can also be estimated from the data, but from our experience, these estimates do not vary substantially from pre-specified values. Similarly, choosing alternative values for h between 0.1 and 0.5 has little impact on estimation of. These findings suggest that our procedure for estimating is robust to prior assumptions. expected signal intensity value based on the GC percentage in the 1 Mb window around the marker. The adjusted signal intensity value is then simply calculated as the observed LRR value minus the expected value (residual in the regression model).
Hidden states in HMMThe hidden states of our HMM model copy number counts, LOH status and intra-tumor heterogeneity. Typical CNV algorithms for SNP arrays model copy number ranging from 0 to 4, but higher level values may also be discernable for large CNAs. Unlike other software tools, we consider tumor copy numbers ranging from 0 to 4 by default but make this parameter user-adjustable. For copy numbers of zero and two copies, we do not model intra-tumor heterogeneity levels ( i ) for the reason of identifiability. However, we include an additional LOH state for two copy numbers. For all other copy numbers, we include additional states that consider values for i ranging from 0 to 1, in increments of .25 by default. Supplementary Table S1 recapitulates our state definition, but we emphasize that this is merely an example, and users have the flexibility to adjust the models based on prior beliefs.
Emission probabilityFor tumor samples, the observed LRR i and BAF i values are assumed to arise from an unobserved mixture distribution of normal cells (stromal contamination) and tumor sub-clones. We denote the true underlying CN-aware genotypes of the tumor and the contaminating normal cells at each marker as g t,i and g n,i , respectively. CN-aware genotype refers to the genotype call that takes into account of allelic copy numbers, such as A (copy  1), ABB (copy  3) and AABB (copy  4). To accommodate stromal contamination () and intra-tumor heterogeneity ( i ), we define the latent distribution as a Gaussian mixture with means that reflect contributions from stromal and tumor tissue. At any SNP i, we define the expected value of the R ratio (RR) aswhere the function cn() counts the total number of copies for a genotype, and rmean() maps a copy number to an expected RR (based on linear interpolation of the observed RR at copy number of 0, 1, 2 and 3 from real datasets). The intra-tumor heterogeneity measure can essentially be considered as a refinement parameter that is locus specific. When i  0, there is no heterogeneity, and all tumor cells have the same copy number at each marker in the population of tumor cells. The standard deviation of RR i , s r,i , at each SNP is assigned from a linear interpolation of the observed RR at copy number of 0, 1, 2 and 3 from real datasets, given the composite copy number of tumor and normal cells asthe emission probability of the RR is modeled as a mixture of a uniform and Gaussian distribution:where () is the density function of a Gaussian distribution with mean r,i and standard deviation s r,i , and l i is a vector for the state parameters (i.e. g t,i , g n,i , , i ). The uniform distribution r accommodates the random fluctuation of signal measures in chemical assays and possible genome mis-annotation. By default, r is assigned as 0.01. We now discuss the component of the likelihood that involves the observed BAF signal. In our method for CNA detection, the main challenge lies in accurately defining b,i in the model. For germline CNV calling, the peaks of these distributions are fixed at given intervals: for example, the peaks of the BAF distribution are located at 0, 0.33, 0.67 and 1 for three-copy regions. For CNA calling, the numbers need to be modified: for example, when  0.2 and i  0, the peaks of the distribution becomes 0, 0.29, 0.71 and 1 for three-copy regions (assuming paired germline sample is not available, or g n,I  2). In the simpler case where homozygous genotypes (AA or BB) in normal tissues are observed, the mean b,i is constrained to be 0 and 1, respectively, as it is reasonable to assume that it is extremely rare for a new allele to arise de novo. In the case of a heterozygous genotype, we model the conditional BAF mean ( b,i ) for a given SNP i as: b, i  1   i bacg t, i     i bacg n, i  1   i cng t, i     i cng n, i  4 where bac() counts the number of B alleles for a CNV-aware genotype (e.g., bac(''AAAB'')  1 and bac(''ABB'')  2). For copy numbers greater than zero, we define the emission probability for BAF i as a mixture of uniform and a Gaussian distribution conditioned on b,i. We review the model first described by the original PennCNV article (). Let I() be an indicator function so that when BAF i is 0 or 1, we multiply the binomial likelihood density BN() by a mixture of point mass M at 0 or 1, respectively, and a truncated Gaussian distribution.is the probability of observing g copies of allele B, and p B is the population frequency of the B allele, estimated from a large ethnically matched reference panel. As indicated in we integrate over all possible genotypes for any copy number state greater or equal to two. Because there is no contribution to signal from tumor cells when copy number is zero, in the case of copy number zero, we define the emission probability for BAF i simply as PBAF i jl i   b  1  b b; :5, :5  7 As mentioned earlier, our method can account for tumor heterogeneity, which manifests as values of i that differ from the global stromal contamination value. To calculate the emission probability for a particular value of i , we assume a Gaussian density function centered at :The final emission probability (likelihood) is simply the product of the RR, BAF and tumor heterogeneity emission probabilities.
Transition probabilityFor whole-genome SNP arrays, the transition probabilities can be calculated in the same manner as in PennCNV by considering the distance between SNPs on the array. We estimate the transition matrix that defines all possible pairs of states by applying the forward-backward and BaumWelch algorithms.
Incorporating datasets with tumor-normal pairsIt is reasonable to assume that in some cases, detection of CNAs in tumor cells is confounded by copy number changes mapping to the same regions in the germline. For instances where germline and tumor DNA is available on the same individuals, one can easily disentangle CNAs that are unique to tumors versus those shared with germline. Statistically, information from germline DNA is straightforward to incorporate, as has been done in other software tools (). In this case, where paired samples are available, site-specific copy number counts enter through the parameter cn(g n,i ), whereas in the more general case when the germline component in unavailable, we simply fix the parameter at value 2.
Posterior inferenceThe Viterbi algorithm, used by programs such as PennCNV, infers copy number by tracing the most likely state path across all markers. However, this approach can be unsatisfactory in some cases (such as when stromal contamination levels are high), as several candidate models can plausibly explain the data. To account for this uncertainty, in the method proposed here, we use the posterior probabilities derived from the forwardbackward algorithm. Copy number calls and model parameters are therefore posterior averaged values. The HMM reports absolute copy number for tumor samples, which can be divided by aneuploidy levels to obtain a relative copy number, which is usually more informative.
RESULTSIn this section, we report comparisons between PennCNV-tumor and existing software for calling CNAs, namely, ASCAT (Van), GAP (), GenoCN (), OncoSNP () and GPHMM ().
Estimating stromal contaminationStromal contamination is commonly observed for tumor samples, as the sample collection procedure may inadvertently result in the inclusion of normal cells. To evaluate CNA detection methods under varying levels of stromal contamination, we examined a previously published () dilution series, which includes 12 samples with mixtures of known proportions of the normal cell line HCC1395BL and the paired breast carcinoma cell line HCC1395 for a variety of values (0, 10, 14, 21, 23, 30, 34, 45, 47, 50, 79, 100). Stromal contamination estimates made using GAP and GPHMM have been previously reported in (), and these results were incorporated into our comparison. For other programs, we ran the software using recommended settings. Program settings and full output for each method in this analysis can be downloaded from https://sourceforge.net/projects/penncnv-2/files/supplemen tary_files/. This comparative analysis demonstrated the superior performance of our method over other competing approaches.shows the plot of expected versus actual estimates for each method. Both GPHMM and our estimation procedure were able to recover known stromal contamination levels across a broad range of values (correlation coefficient of r  0.99). GAP produced accurate estimates at higher levels of stromal contamination, but over estimated at lower levels (r  .28). The remaining programs overall did not recover the true values as well: OncoSNP (r  0), GenoCN (r  .23) and ASCAT (r  .02). We also note that other programs that require userspecified priors do not perform as well either. For example, PICNIC () can be overly sensitive to user-specified priors such that they significantly influence the final computational predictions. In summary, our maximum likelihood method resulted in the accurate estimation of stromal contamination, which is essential for the optimal detection of CNAs in subsequent steps.
CNA calling on tumor samples with known aberrationsTo evaluate our ability to call CNAs, we compared our method and others on the breast cancer cell line SUM159. These data were generated on the Illumina CNV370-Duo array and were previously characterized extensively on four different technical platforms (). SUM159 is known to harbor CNAs at multiple different scales on chromosome 5, including a whole-arm amplification of the p-arm, a megabase-level deletion at $100 Mb, and two kilobase-level complex duplication toward the telomere of 5p (). Supplementaryillustrates a comparison of copy number estimates using different methods. For large events, inference was nearly identical in terms of localization of aberrations (albeit some differences in their magnitude) for GenoCN, OncoSNP, ASCAT, GPHMM and PennCNV-tumor. However, different algorithms yielded discordant calls for small CNAs, perhaps reflecting the different sensitivity of each algorithm under default settings.
CNA inference in the presence of stromal contaminationTo further evaluate the sensitivity and consistency in calls using different methods, we tested the concordance rate of CNAs calls on the breast cancer dilution series. As we do not know the true CNA profile, for each algorithm, we treat the calls generated on the tumor cell line HC1395 as the reference and tested how many of these calls can be recovered for each diluted sample in the face. PennCNV-tumor achieves better correlation (r  0.99, L1norm  0.05, L2norm  0.06) with experimental data than most other methods of noise from stromal contamination (Supplementary). We ran each program using the recommended settings except for GAP, which we were not able to successfully run. However, we integrated into our comparison previously published results (specifically CNA calls for this data made using GAP, which are available at http://bioinfo-out.curie.fr/projects/snp_gap/.) For each program, we calculate the proportion of calls concordant with the reference sample. An ideal method would have high concordance, and the concordance is expected to monotonically decrease as a function of stromal contamination. Qualitatively, PennCNV-tumor performs most similarly to GAP and GPHMM. The other programs show a noticeable drop in concordance across various levels of stromal contamination. It is also important to note each method's sensitivity to detect aberrations across various levels of stromal contamination. A method that is not sufficiently sensitive may call nearly every site copy neutral for a pure tumor sample, which in turn can artificially produce perfect concordance when applied to samples with higher levels of stromal contamination. Supplementaryillustrates the distribution of percentage of sites aberrant across different stromal contamination levels. The figure indicates that sensitivity levels for the methods were calibrated similarly. Finally, we were also interested in how these methods compare in terms of concordance and percentage aberration when considering only large CNA events. We filtered results across methods on only CNAs greater than 10 MB and plot the comparison of concordance and percent aberrations in Supplementary Figures S4 and S5. Interestingly, the programs appear to diverge in their distribution of percentage sites aberrant when only large (410 MB) CNA events are considered in contrast to all sized events. Finally, we also tested a dilution series dataset simulated by CnaGen (), as the ground truth is known. The dataset contains 11 samples, with tumor purities ranging from 0.01 to .99. Each sample contains a region with intratumor heterogeneity of 80%, and PennCNV-tumor correctly identified the region from those samples with tumor purity450%. In contrast, other methods were not able to predict stromal contamination with reasonable accuracy, as summarized in Supplementary Table S2.
CNA inference in presence of intra-tumor heterogeneity
Computational efficiencyOne dimension of performance for CNA calling that is often overlooked is computational efficiency. As the availability of large multi-dimensional datasets (e.g. The Cancer Genome Atlas) increases, the ability to complete analyses in a timely fashion is becoming more important. We recorded run times and memory usage across the programs GenoCNA, OncoSNP, GPHMM, ASCAT and PennCNV-tumor.highlights the computational demands of these programs for the analysis of 12 samples used in the dilution series analysis across more than 370,000 SNPs. One should keep in mind though that these are based on default settings, which we have assumed the authors have suggested to give a good balance between accuracy and run time performance. ASCAT and GenoCN required 66 and 72 times more memory, respectively, than PennCNV-tumor. However GPHMM and ASCAT were slightly faster than PennCNV-tumor.
DISCUSSIONOver 10 software tools have now been published for identifying CNAs from SNP arrays. Most are based on HMMs, but several use segmentation algorithms. Our proposed algorithm uses SNP genotyping arrays to identify CNAs and estimate their magnitude in tumor samples, while accounting for intratumor heterogeneity, stromal contamination and aneuploidy. When compared against other popular methods, our approach performs comparably in terms of the detection and estimation of CNAs but shows marked improvements in the estimation of stromal contamination and runtime efficiency. Later in the text, we discuss the
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.3 Adjustment of signal intensity by aneuploidy and genomic waves For SNP genotyping arrays, values for the LRR i and BAF i at each SNP can be generated from the Illumina GenomeStudio software for Illumina arrays or from the PennCNV-Affy pipeline for Affymetrix arrays at each SNP (indexed by i in our notation). LRR i is a normalized measure of total signal intensity of two alleles (i.e. sum of A and B allele intensities) and BAF i is a normalized measure of allelic intensity ratio. Further details can be found in (Wang et al., 2007). We now describe our pre-processing procedure, which adjusts observed LRR i values to account for both aneuploidy and genomic waves. Tumor samples may have large-scale duplications and deletions of one or more chromosomes, so the average ploidy levels cannot safely be assumed to be two, as is the case for germline samples. After evaluating several aneuploidy estimation methods, we adopted a straightforward method of exploiting the empirical LRR i distribution for SNPs with BAF i values within a narrow range. The approach is an integral part of the PennCNV-tumor algorithm. We estimate the aneuploidy correction factor by taking a weighted average of all possible copy numbers at sites where BAF i is near .5 (e.g. j BAF i .5j5.01), where the weight is the emission probability (described in the following section) at the HMM state associated with the copy number. The expected intensity value associated with is then added to the LRR i at each SNP, which is similar in spirit to previously described methods (Attiyeh et al., 2009; Yau et al., 2010). In addition to aneuploidy adjustment, a second adjustment procedure eliminates the phenomenon known as 'genomic waves' (Diskin et al., 2008; Marioni et al., 2007). Genomic waves refer to the variation in hybridization intensity that is related to the genomic position of the clones. In practice, real datasets usually exhibit genomic waves and would result in erroneous CNA calls (see examples later in the text). Our solution entails fitting a regression model where GC content is included as a predictor variable (Diskin et al., 2008). This technique complements our aneuploidy adjustment procedure. Briefly, given M markers in a genotyped sample, we collect all the m autosome markers that are at least 1 Mb away from each other. For each of the m markers, we collect its LRR value as L j (j  1,. .. , m) and the average GC percentage in the 1 Mb window around the marker, then fit a linear regression model: L j   G j  " j. After obtaining these estimated regression parameters, for each of the M marker in the genotyping array, we then calculate the
Precise inference of CNAs at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
G.K.Chen et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
We assessed the ability of PennCNV-tumor to call tumors in the presence of intratumor heterogeneity, which is characterized by proportions of normal cells that can differ across sites. We are not aware of existing datasets in which the true profile of intratumor heterogeneity is known, so we evaluated the performance of our program and others through the same simulated datasets, which have previously been described earlier for evaluating stromal contamination. For each scenario (modeling a specific level of stromal contamination), we simulated intratumor heterogeneity in random regions covering 12% of the genome, where each of these regions span $15 Mb. We compared the accuracy of CNV calls against other methods, where OncoSNP was the only other competing program that could account for intratumor heterogeneity. Supplementary Table S2 lists the L1 errors for estimates of tumor copy number and intratumor heterogeneity, calculated as the sum of the absolute value of deviations between the true and estimated values, taken across all sites. PennCNV-tumor generally had better concordance with respect to copy number estimates as compared with OncoSNP, whereas OncoSNP had slightly better accuracy in estimating intratumor heterogeneity when stromal contamination levels were lower. Additionally, OncoSNP has better performance to predict stromal contamination when the values are below 50%. Interestingly, ASCAT performed well for CN inference, but was not able to complete analyses for tumor purities outside the range of .4 to .9. GPHMM appeared to have the lowest sensitivity, calling most sites as copy neutral.
G.K.Chen et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from major differences between various algorithms and potential avenues for future improvements. (i) Capability of integrating multiple sources of 'prior' information in the likelihood calculation step. To our knowledge, only OncoSNP and our program PennCNV-tumor comprehensively account for stromal contamination, tumor heterogeneity, aneuploidy and genomic waves when inferring CNAs, whereas other tools consider only a subset of these issues. (ii) A unique but simple approach for estimating stromal contamination. Although we estimate the global (stromal contamination) and the aneuploidy offset parameter in a data pre-processing step, in principle, it should be possible to estimate these parameters in an integrated analysis (e.g. learning the HMM parameters). However, our preliminary results have suggested that for reasons of identifiability, it is difficult to get consistent estimates: for example, disentangling global from local (intratumor heterogeneity) estimation when both are included as free parameters in the model. As domain knowledge is critical in most statistical learning problems, we incorporate an a priori heterozygosity rate for each given sample in our pre-processing step. A good approximation of this fixed parameter can lead to superior accuracy over competing methods, as demonstrated in the real breast cancer dataset with known dilutions of stromal tissue. Our simulation study suggested that this method might not be optimal in certain contexts however. For instance, when we simulated a large proportion of sites that had tumor heterogeneity, our stromal contamination estimates did not perform as well as in the real breast cancer data. Because this example was based on simulated data, it is possible that the simulated data did not properly reflect realistic distributions of intratumor heterogeneity, CNAs or other phenomena. Furthermore, these simulation study results should be balanced against our program's ability to make predictions that were more robust across the entire spectrum of stromal contamination levels (other methods we tested were unable to make reliable estimates beyond 50% stromal contamination). Inference of high stromal contamination levels can be of great interest in certain cancer contexts. In late stages of pancreatic cancer, typically malignant cancer cells represent only 25% of the cells in the tumor on average (Boyd et al., 2009). The authors of GPHMM found that among fresh breast cancer biopsies, 'About 91% tumor samples (87 of 96) are mixed with 450% normal cells, of which 60 have normal cell proportions larger than 0.7, and 12 have normal cell proportions greater than 0.85' (Li et al., 2011). (iii) The need for some users to fine-tune calling algorithms to achieve the desired resolution and granularity: We have provided users with flexibility in specifying the state space in the HMM. Previous studies show that copy number states up to 6 can be readily discerned by eye in the signal intensity plots (Attiyeh et al., 2009). It is possible that even higher copy number can be detected by sophisticated computational means, though they may not have much practical value. Among the features described earlier in the text, (ii) is unique to our algorithm, to be best of our knowledge. Several further improvements may be made to the proposed method. For instance, different researchers have varied requirements for the sensitivity and specificity of CNV calling, depending on their research needs. Many software tools, including PennCNV-tumor, rely on post-calling QC to control sensitivity and specificity (e.g. minimum number of probes thresholds and the log likelihood threshold). However, it is possible to directly control the sensitivity within the HMM model by arbitrarily setting a different set of noise parameters and transition parameters. CNV filtering may also be introduced post hoc using a suitable ethnically matched reference. We plan to introduce tools in our software that can automate parameter tuning by applying supervised learning procedures on 'gold standard' datasets. Third, it is a known problem that HMM-based algorithms tend to over-segment the data, resulting in long CNV regions being broken into several small calls. This depends on the HMM parameters, so it cannot be directly adjusted from the algorithm per se. However, several post-calling adjustment procedures have been developed before; for example, PLINK and PennCNV both have CNV-processing steps that merge neighboring CNV calls if the 'bridge' between the two neighboring calls are less than a certain threshold (such as 20%) of the total combined call. For tumor CNA calling, this post-processing procedure can also be used. Fourth, our current approach estimates stromal contamination in a pre-processing step, rather than treating it as a parameter in the HMM. We have previously attempted to discretize alpha (e.g. from 0 to 1 in increments of 0.1) and estimate it in HMM; however, this increases the HMM states by $11-fold, but the estimation per marker is highly unstable. Finally, we wish to stress that a variety of genome-wide approaches, and technical platforms have been developed for CNV detection (Alkan et al., 2011). Although next-generation sequencing may soon replace SNP arrays in certain areas, it is still cost-prohibitive for genome-wide screening. In addition, the accurate detection of CNVs/CNAs from sequencing data is nontrivial, dependent on sequencing depth, and represents an area of ongoing development. Hence, SNP arrays remain a cost-effective and popular approach to interrogate CNAs, as evidenced by recent large-scale oncogenomic profiling studies such as TCGA (TCGA, 2012) and METABRIC (Curtis et al., 2012).
