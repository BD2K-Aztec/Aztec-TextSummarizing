Motivation: The Affymetrix GeneChip microarray is currently providing a high-density and economical platform for discovery of genetic polymorphisms. Microarray data for single feature polymorphism (SFP) detection in recombinant inbred lines (RILs) can capitalize on the high level of replication available for each locus in the RIL population. It was suggested that the binding affinities from all of the RILs would form a multimodal distribution for a SFP. This motivated us to estimate the binding affinities from the robust multi-array analysis (RMA) method and formulate the SFP detection problem as a hypothesis testing problem, i.e. testing whether the underlying distribution of the estimated binding affinity (EBA) values of a probe is unimodal or multimodal. Results: We developed a bootstrap-based hypothesis testing procedure using the 'dip' statistic. Our simulation studies show that the proposed procedure can reach satisfactory detection power with false discovery rate controlled at a desired level and is robust to the unimodal distribution assumption, which facilitates wide application of the proposed procedure. Our analysis of the real data identified more than four times the SFPs compared to the previous studies, covering 96% of their findings. The constructed genetic map using the SFP markers predicted from our procedure shows over 99% concordance of the genetic orders of these markers with their known physical locations on the genome sequence. Availability: The R package 'dipSFP' can be downloaded from
INTRODUCTIONIn the past decade, Affymetrix GeneChip microarrays have provided an important and versatile tool for many genome studies. This technology uses hybridization probes which are comprised of hundreds of thousands of 25-mer oligonucelotides chemically synthesized on a solid substrate. Typically, these probes (or features) are grouped into different probe sets for different target genes * To whom correspondence should be addressed.(see Affymetrix 2001 for more details). Since its introduction by, Affymetrix GeneChip microarrays have been used extensively for genome-wide gene expression analysis. Recently, Affymetrix GeneChip microarrays have also been used for identifying genetic polymorphisms on a variety of genomes in a highly parallel manner (). Such genetic polymorphisms, including single nucleotide polymorphisms (SNPs) and small insertion/deletions, are detected by single probes on the array and, therefore, are called single feature polymorphisms (SFPs). The idea is that the sequence mismatch between a 25-mer perfect match (PM) probe on the array and its target sequence will significantly alter hybridization and attenuate that probe's signal. Therefore, the presence of sequence polymorphisms in some PM probes will lead to detectable differences in those probes' hybridization signals between the two different accessions, one of which has similar sequences as the probe sequences on the array. Since hundreds of thousands of probes can be analyzed at the same time, the Affymetrix GeneChip microarrays are currently providing one of the most highly parallelized and economical platforms for genetic polymorphism discovery, facilitating the increasing need of highresolution genetic and physical maps for genetic studies (). For relatively small genomes, such as yeast, arabidopsis and rice, microarray hybridization of genomic DNA samples has been a successful route to detect SFPs (). For more complex genomes, such as barley and cowpea, cRNA samples have been successfully used as surrogates for DNA samples to detect SFPs (). In most of the microarray-based SFP detection studies, usually only two or three biologically replicated DNA or RNA samples are extracted from each accession under comparison. With so few replicates, SFP detection suffers from either low detection power or high false positive rate. However, increasing biological replicates simply for the purpose of SFP detection is generally cost prohibitive. Since RIL expression microarrays are often available for expression quantitative trait locus analysis,proposed to use such data, without extra cost, for simultaneous SFP detection and RIL genotyping. They developed a metric for the binding affinity called SFPdev, and assumed that the SFPdev values of a SFP fromPageall of the RILs would form a bimodal distribution, where each peak represents a parental genotype. Then for each probe, they sorted the SFPdev values in an increasing order and performed an empirical brute force search for a gap value greater than two in the ratios of every two consecutive SFPdev values. If such a gap was found for a probe and all SFPdev values of one parent fall on one side of the gap and all SFPdev values of the other parent fall on the other side of the gap, then this probe is called a SFP. Obviously, a simple ratio of two consecutive SFPdev values cannot fully characterize the distribution of SFPdev values from all of the RILs, and the searching method also lacks the statistical justification of false positive control. Moreover, it has been reported in the literature () that most of SFPs predicted from the SFPdev-based analysis are gene expression level polymorphisms rather than the genuine sequence polymorphisms, suggesting that the SFPdev is not independent of the gene expression level. In this article, we formulate the SFP detection problem as a hypothesis testing of unimodality versus multimodality, and propose a bootstrap testing procedure to predict SFPs based on the estimated binding affinity (EBA) values from the robust multi-array analysis (RMA) method.
METHODS
Probe binding affinity indexThe PM intensity value obtained from the microarray is a compound of multiple effects.proposed to decompose the PM values of the probes within one probe set as following:where  k is the binding affinity between the target sequence and the k-th probe,  j the gene expression level of the probe set on the j-th array, kj the random error and B kj represents the background noise. SFP detection emphasizes on the sequence polymorphism prediction, which is reflected by the different binding affinities between target sequences bearing and not bearing sequence polymorphism(s) when hybridized on the same probes on the arrays. For the robustness of SFP detection to the major variation in the gene expression data, it is essential to have an index that can measure the binding affinity and is independent of the gene expression level.developed a metric, called SFPdev, to estimate the binding affinity from the PM values. For probe i, it is calculated by '|PM intensity for probe i-average of PM intensities for the remaining 10 probes in the same probe set|/PM intensity for probe i'.proposed three indexes incorporating the mismatch (MM) probe values, which are I 1 = log(PM/MM), I 2 =(PMMM)/PM and I 3 =(PMMM)/MM. In this article, we use the EBA from model (1) as the measurement of the true binding affinity  k. The EBA values of the probes in a given probe set can be calculated by the Tukey's median polish method from the background corrected (), quantile normalized () and log-transformed PM values on the replicated arrays. The obtained EBA values are then summarized in a matrix {X ij } mn , where each row corresponds to one probe and each column corresponds to one RIL. Further SFP detection procedures are performed on the dataset {X ij } mn .
Hypothesis testingAccording to, in the homozygous RIL population, the distribution of the binding affinities is bimodal for an SFP and unimodal for a non-SFP. More generally, it could also be trimodal for a SFP locus if the RIL population is heterozygous and rarely multimodal if a mutation had occurred during generation of the RILs. In other words, X ij in each row could follow either a multimodal distribution or a unimodal distribution depending on whether the row corresponds to a SFP or not. Therefore, the problem of determining whether a probe, e.g. probe i, is a SFP or not can be formulated as testing the following hypothesis: H i0 : f i (x) is unimodal versus H i1 : f i (x) is multimodal,where f i (x) is the underlying density function of the i-th row in the matrix {X ij } mn. For testing hypothesis (2), several statistics have been proposed in the literature, among which the most commonly used and intensively studied are the Silverman critical bandwidth statistic (), the dip statistic () and the excess mass statistic (). Although the Silverman test is heavily cited and has been called 'ingenious' (), previous studies suggested three major drawbacks of the critical bandwidth statistic: (i) it has poor distributional properties; (ii) it is very sensitive to outliers; and (iii) it makes no distinction between tiny, 'negligible' modes and large, 'important' modes. For 1D data, the dip statistic and the excess mass statistic are equivalent (). Therefore, we choose the dip statistic for the multimodality test of the distribution of X ij obtained from all of the RIL microarrays. Given a random sample X 1 , X 2 , ..., X n from an unknown probability density function f (x), the dip statistic is defined as the maximum difference between the empirical distribution function and the unimodal distribution function which minimizes that difference. It mathematically can be written as (),where U is the class of cumulative distribution functions with unimodal densities andFand andF n (x) the empirical cumulative distribution function. When f (x) is uniform on (0,1), the dip statistic D is obtained given G(x) being uniform on (0,1) and the asymptotic distribution of dip statistic D can be derived. The percentile points of D in the finite sample size can also be tabulated via simulation (). However, when f (x) is unimodal but not uniform, the asymptotic distribution of D is not known. To obtain the null distribution of the dip statistic D under the unimodal distribution assumption, we employed the smooth bootstrap algorithm () and the modified critical bandwidth (). The smooth bootstrap is equivalent to re-sampling from a kernel density estimate. For the random sample X 1 , X 2 , ..., X n from the probability density function f (x), the kernel density estimate f h (x) = n j=1 K h (x X j )/n, where K h (.) = K(/h)/h is a re-scaling of the kernel function K, which is chosen to be the standard Gaussian probability density in this article, and h is the bandwidth. Given the tuning parameters  0 and m 0 , the modified critical bandwidth h k inis the minimal bandwidth at which f h k (x) 0 has k 'major' modes whose masses are larger than m 0. Specifically, the density f h 1 is the kernel density estimate with one 'major' mode that is closest to the data and h 1 is called the critical bandwidth for one mode. As suggested by, the modified critical bandwidth can address the drawbacks (ii) and (iii) of the critical bandwidth that we mentioned earlier. It is reasonable to use f h 1 to estimate f (x) under the assumption that f (x) is unimodal. However, f h 1 has to be rescaled to have variance equal to the sample variance. Denote the rescaled f h 1 by g h 1. Because of the convenient form of the Gaussian kernel estimate, drawing samples from g h 1 can be easily done. Denoting the observed data by x 1 ,x 2 ,...,x n , we can samplePage. Solid: N(,  2 ); dashed: gamma(k, ); dotted: T (); dotdash: log-normal (,  2 ). Corresponding parameter stands for  or  for N(,  2 ), k for gamma (k, ),  for T () and  for log-normal (,  2 ).
SFP detection using RIL microarray data3. For each probe i, draw B bootstrap samples of size n from g h 1i using(4) and calculate dip statistics,2,...,m. 4. Approximate P-value of probe i by,2,...,m;k = 1,2,.
..,B} mB5. Adjust P-values p i , i = 1,2,...,m, using the false discovery rate criterion (). Given a pre-determined , probes with adjusted P-values smaller than  are selected as SFPs.Cheng and Hall (1998) studied the asymptotic property of the dip statistic and concluded that, under condition (2.2) outlined in their paper, the asymptotic null distribution of the dip statistic is independent of the unknown f (x) except for a factor c = f (x 0 ) 3 /|f (x 0 )| 1/5 , where x 0 is the unique mode of f (x). The specific formulas of factor c for normal, gamma, t and log-normal distributions are listed in Supplementary Table S1.provides the graphic illustration of how the value of c changes as the dependent parameters change. As can be seen, if f (x) is a normal density, then c = (2) 1/5 is a constant and reflected by a flat line in. This means for any two normal densities with different means and variances, their dip statistics converge to the same asymptotic distribution as the sample size n goes to infinity. Although for gamma and t densities, the corresponding factor c depends on one of their density parameters, such dependency quickly diminishes as the value of dependent parameter increases. Moreover, with moderately large values of dependent parameters (shape parameter for gamma density and degrees of freedom for t density), the values of factor c and, therefore, the asymptotic null distributions of the dip statistics are very close to that of normal density. For log-normal density, when  2 is small, the values of factor c and the asymptotic null distributions of the dip statistics are still close to that of the normal density. However, as  increases, the values of factor c and, therefore, the asymptotic null distributions of the dip statistics are farther away from that of the normal density, although the dependency between  2 and c quickly disappears. For this case, we suggest to perform a log-transformation on the observed data before bootstrap resampling in Step 3 and then take the exponential function on resampled data to calculate the bootstrap version dip statistics. Supplementaryshows the distributions of the dip statistics when f (x) is normal, gamma, t or log-normal density with varying parameters. The densities are plotted based on 10 000 replicated dip statistic values, each of which was calculated through 100 observations sampled from f (x). As shown in Supplementary, the distributions of the dip statistics weakly depend on the corresponding density parameters that are moderately large for gamma and t densities and small for log-normal density. Throughout the article, for all of the probes we assume the distributions of the EBA values from all of the RILs follow the same family of unimodal distributions under the null hypotheses. The above results provide us the ground to assume a common null distribution for dip statistics D 1 ,D 2 ,.
..,D
RESULTS
Simulation StudyA series of simulations were performed to assess the performance of our proposed algorithm. In each simulation study, the sample size n is always set to be 100 and the total number of probes m = 10 000, among which there are 500 SFPs generated from the mixtures of two distributions from the same family with the mixing probability p. Tuning parameter  0 is set to be 0, m 0 = 0.003 as suggested by. The number of bootstrap replications B is set to be 20 in all simulation studies. Five commonly used density families, including normal, gamma, t, log-normal and uniform, are examined in the simulation studies (see Supplementaryfor the detailed density functions of these density families used for data generation). The first simulation is to evaluate the performance of the bootstrap procedure in estimating the null distribution of the dip statistic. We considered five scenarios corresponding to the five density families mentioned above. The parameter settings in five scenarios are given in Supplementary Table S3. In each scenario, P = 0.2, 0.3, 0.4, 0.5 and 0.6 were considered. Note that for all non-SFPs, data were generated from the same unimodal distribution. For SFPs, data were generated from the mixtures of distributions from the same family with the density parameters varying randomly in order to reflect different levels of separation in two modes of the underlying distributions among SFPs. The true and estimated null distributions of the dip statistics are presented in. Since the estimated null distributions with different P settings are very similar, only the estimated null distribution with P = 0.5 are plotted in. It can be seen that the null distributions of the dip statistics are well estimated by our proposed bootstrap procedure for normal density, gamma and t densities with moderately large dependent parametersRecall(TPR) Precision. PR curves calculated from our proposed algorithm when  = 0.01,0.05,0.1,0.15 and 0.2 in the case that the null underlying density f i (x) is normal, gamma, t, log-normal or uniform density. and log-normal density with small . The estimated null distribution of the dip statistic for t density has a positive bias from the truth when the degrees of freedom are small (data not shown), and the estimation bias becomes smaller and smaller as the degrees of freedom increase. We observed a similar behavior for the log-normal density, except the bias reduces as the parameter  decreases and it is more sensitive to the change of dependent parameter values. For the uniform case, the bias is obviously negative and we suggest to use the percentile table into determine the significances of dip statistic values and, therefore, exclude it in the following simulation. The second simulation is to evaluate the false discovery rate (FDR) and detection power of the proposed algorithm. To reflect the real situation that for different non-SFPs, the underlying density functions f i (x) could be in the same family but with different parameters, the data in this simulation are generated under the parameter settings in Supplementary Table S4. The precisionrecall (PR) curves of eight scenarios described in Supplementary Table S4 are plotted inwhen  = 0.01,0.05,0.1,0.15 and 0.2, where the precision (=1FDR) is the proportion of true positives among total number of rejections, and the recall (=1Type II error rate) is the ratio of the number of true positives to the total number of true positives and false negatives. In the context of SFP discovery, 'Precision' measures the fraction of probes classified as SFPs that are truly SFPs, while 'Recall' measures the fraction of total true SFPs that can be discovered. As shown in, the FDR of our procedure is controlled under the desired level. With consideration of the conservativeness of the FDR control procedure of, they are still in reasonable range except for Scenario 1 of t and log-normal densities, where the actual FDRs are much smaller than . In these two cases, the degrees of freedom of the t density are set to be quite small and the  parameters of lognormal density are set to be large, resulting in positive estimation bias of the null distribution of the dip statistic and, therefore, larger P-values. The detection power of our procedure depends on the separation of two modes in the mixture distributions of SFPs. Within each density family, the two modes of SFPs in the second scenario are better separated than that in the first scenario, resulting in higher detection power of Scenario 2 (dashed) than Scenario 1 (solid) at the same level of FDR control. To evaluate the performance of our procedure for SFP detection in the population with distorted segregation ratios, four more scenarios, Scenario 36, are considered for each density family. The parameter settings are listed in Supplementary Table S5. As shown by the PR curves in Supplementary, for SFPs with small modes in the bimodal distributions (Scenario 3 of the normal, gamma and t densities), our detection power is very low. In those cases, it is hard to say whether the small mode appearing in the data is randomly generated from a unimodal distribution or caused by a bimodal distribution. Although this feature reduces the detection power, it justifies the robustness of our procedure to the outliers which is often an issue in the real data analysis. In Scenario 6 of the log-normal density where much flatter modes are generated for some SFPs compared to the others in the bimodal distributions, our procedure treats the flat modes like heavy tails and classifies them as non-SFPs, which also results in a low detection power.
Real data analysisThe gene expression microarray dataset consisting of two biological replicates of 148 Bay-0Sha F9 RILs of Arabidopsis thaliana and 8 parental accessions (4 from Sha and 4 from Bay-0) was obtained from. We only used the PM values. After background correction and normalization, the replicated data are stored in 150 matrices, of which, 148 are of m2 corresponding to 148 RILs with two replicates each and 2 are of m4 corresponding to two parental controls with four replicates each, where m = 249 975 indicates the number of probes on the arrays. Note that only the probe sets containing 11 probes were considered in the analysis. The EBA values are then obtained and summarized in the matrix (X ij ) m148 as described in Section 2.1, where each row represents a probe and each column corresponds to a RIL. Given  = 0.01, 0.001, 1e-5 or 1e-10, the number of SFPs predicted from our procedure is 7851, 6534, 5492 or 5225, respectively. The adjusted P values of the majority of predicted SFPs are smaller than 1e-10, which actually equals to zero. Therefore, we set the nominal FDR control  = 1e-10, resulting in 5225 predicted SFPs. To assess our SFP detection results, we retrieved the probe sequences from the Bioconductor package ath1121501probe and mapped them onto chromosome sequences. The results were compared with the known SNPs of the genotypes Sha and Bay-0 (from ftp://ftp.arabidopsis.org/Sequences/JGI_ Resequencing_Data) by searching those probes containing SNPs. In total, 231 880 probes mapped to chromosome locations, covering 255 065 positions. To obtain unambiguous results, only the probes with unique mappings were considered in this study. Moreover, we only considered SNPs that occurred either in Sha or Bay-0 relative to Col-0, since it is still not clear what the hybridization profile of heterozygotes or mixed genotypes (SNP in both) is on microarrays. Among 220 184 uniquely matched probes, 15 856 probes cover SNPs. For 5225 SFPs predicted from our procedure, 4745 (distributed in 2730 probe sets) are uniquely located on chromosomes. Their overlap with the probes covering SNPs is 2989, resulting in 37% actual FDR.showed that the false positive SFPs can result from SNPs adjacent to probe binding regions. Of 1756 false positives, there are 499 probes whose flanking) and the EBA values of parental controls used to determine which parental genotype each group belongs to. If the EBA value of Sha is larger than that of Bay-0, then the RILs clustered in the group with larger EBA values are all genotyped as Sha and the RILs in the other group are all genotyped as Bay-0. Otherwise, the genotypes are assigned reversely. Note that a genotype is assigned to a RIL only if its probability of being in one of the two clusters is greater than 0.7 which is calculated from the fuzzy clustering procedure, otherwise, the genotype is assigned as missing. Second, for the probe sets containing multiple SFPs, one SFP with the minimum missing genotype scores is selected per probe set. Third, the redundant SFPs are filtered using the MadMapper software (http://cgpdb.ucdavis.edu/XLinkage/MadMapper/) and removed from further analysis. SFPs with 25% or more missing genotype scores are also removed. The MSTmap software clusters the resulted 2697 SFPs into five linkage groups, and within each group, the SFPs are grouped into genetic bins and sorted according to their genetic orders. The numbers of SFPs and genetic bins in each linkage group are presented in, together with the length of the constructed genetic map and the average genetic distance between bins in each linkage group. The SFP markers we detected offer more complete genome coverage than that of. In the previous sequence analysis, all the uniquely matched probes were located on the chromosomes. We plotted the physical locations versus genetic positions of predicted SFPs from the MSTmap analysis (). As shown in, there are 3, 1, 8, 3 and 9 SFPs in five linkage groups whose genetic positions are not consistent with their physical locations (Supplementary). In other words, we observed over 99% concordance of the genetic orders of the predicted SFPs with their known physical locations on the genome sequence. There are four inconsistent SFP markers found in, which are all included in the above 24 inconsistent SFPs. Among the remaining 20 inconsistent SFPs, 6 belong to the probe sets that correspond to multi-gene families.
SFP detection using RIL microarray data
DISCUSSIONOur simulation studies show that our procedure can reach a satisfactory detection power with FDR controlled at the desired level when there are sufficiently strong signal intensities from the microarray hybridization. They also show that our procedure is robust to the unimodal distribution assumption, which allows the broader application of our procedure. Our analysis of the RIL datadetected more than four times as many SFPs, covering 96% of that of. The constructed genetic map using the predicted SFPs showed over 99% concordance of the genetic positions with their known physical locations on genome sequence. To account for the binding affinity from the PM intensity value, we proposed the EBA, which is estimated by the Tukey's median polish method from the RMA model (1). However, in the real data analysis, we obtained the EBA by dividing the PM value by the estimated expression level, since there were only two replicates for each RIL and the estimate for the binding affinity might not be reliable. The performance of the EBA was investigated in the real data analysis. Compared to the low detection power of SFPdev and high FDRs of indexes proposed in, the EBA showed the advantage of high detection power and competitive FDR control. Because of the conservativeness of the FDR control procedure of, the actual FDR from our procedure is usually smaller than the nominal FDR. However, in the real data analysis, a seemingly larger FDR was obtained. This phenomenon has also been reported in the literature. In additional to the binding affinity and the gene expression level, many factors could affect the signals on the arrays and result in the SFP like probes that cannot be validated by the sequence polymorphisms (). In our simulations where f i (x) is multimodal if and only if the probe i is a SFP, our algorithm works well and the FDR is controlled at the nominal level. Note that the detection power highly depends on the separation of two modes in the bimodal distribution. The low detection power in our real data analysis are mainly due to the poor bindings of the target sequences that perfectly match to the probe sequences on the array, resulting in the modes not separatable. The on-going efforts on SFP technology (), including complexity reduction and gene enrichment of the target DNA, can potentially improve the detection power of SFP detection. This article is motivated by the SFP detection predominantly for homozygous RIL populations, where there are only two genotypes at most loci. Rejecting the null hypothesis directly implies the sequence difference between those two genotypes. In other settings, there might be more than two possible genotypes, resulting in bimodal, trimodal or multimodal distribution of the EBA values for a SFP. The number of modes is of great interest for genotype identification, which can then be formulated as the following hypothesis testing:
X.Cui et al.where j is the number of modes of f i (x) and k = 1, 2, 3 or more.proposed a statistic T k for this hypothesis testing and used the smooth bootstrap method to generate the null distribution of T k to measure the significance of the statistic. To determine the number of modes for SFPs, we can apply this procedure for k = 1, 2, 3, ... until the null hypothesis is accepted. The k at which the null hypothesis is accepted is an estimate of the number of modes. Funding: The National Science Foundation DBI 0646024 (to X.C. and N.Y.).
Conflict of Interest: none declared.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 1983 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
/  2 ) 1/2 (y * j y * +h 1 j ), j = 1,2,...,n, (4) where y * is the mean of y * 1 ,y * 2 ,...,y * n ,  2 the plug-in estimate of variance of the data and j the standard normal random variables. Putting all of these together, our bootstrap hypothesis test for SFP detection using dip statistic D is summarized as following: 1. Calculate the dip statistic D for each probe i using formula (3), and denote it by D i. 2. Calculate the critical bandwidth h 1 for each probe i, denoted by h 1i , i = 1,2,...,m.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
bp sequences cover SNPs, reducing the previous seemingly large FDR to 26%. A bit smaller FDR (24.4%) was reported in Xie et al. (2009). However, it was calculated based on a subset of predicted SFPs and the FDR for the whole set of predicted SFPs is not known. The expression level polymorphism also might cause the false discovery. Luo et al. (2007) concluded that SFPs predicted from the Affymetrix microarrays mainly (64%) represents the polymorphisms in cis-or trans-acting regulators rather than the sequence polymorphisms in the barley genome studies. If there are multiple probes identified as SFPs in one probe set, they are more likely due to the expression level polymorphisms rather than the sequence polymorphisms. The remaining 1257 false positives distribute in 805 probe sets, among which 16 probe sets contained six or more SFPs, covering 108 (8.6%) false positive probes. SFP detection is built on the idea that the target sequences bearing polymorphism(s) will bind poorly to the corresponding probes, resulting in significantly lower hybridization signal intensities compared to that of the target sequences that are highly similar to the probe sequences. Sometimes, however, even if the target sequences are highly similar to the probe sequences, we could still observe poor bindings, making the SFP detection infeasible for those probes. We used the 90 percentile of the PM values of one probe as the measurement of the hybridization signal intensities of this probe, and compared that of the 2989 probes that bear SNPs and were detected by our procedure with that of the 12 589 probes that bear SNPs but were not detected by our procedure. The 20 percentile of the former (153) is even larger than the 80 percentile of the later (130), suggesting the majority of probes bearing SNPs were missed by our procedure due to the poor bindings at these probes. The detection power is also related to the SNP locations in the probes. For the probes bearing multiple SNPs, we only count the SNP closest to the middle (the 13th base) of 25-mer sequence. Using our procedure, the detection rate of SFPs whose SNPs locate in the middle is 27%, while the detection rate of SFPs bearing SNPs in the edge (the 1st and 25th bases) is 2.5%. To compare the performances of different binding affinity indexes, we re-ran the proposed procedure with all of the indexes mentioned in Section 2.1. The numbers of predicted SFPs, the detection power and the FDRs with and without consideration of flanking SNPs under the same nominal FDR control ( = 1e-10) are listed in Table 1. As shown in Table 1, the EBA reaches the highest detection power with the actual FDR controlled at the comparable level with the SFPdev, whose actual FDR is the lowest. West et al. (2006) identified 1257 SFPs, of which 1148 probes (distributed in 895 probe sets) are uniquely matched on the chromosomes. It is worth mentioning that
