Motivation: Analysing next-generation sequencing (NGS) data for copy number variations (CNVs) detection is a relatively new and challenging field, with no accepted standard protocols or quality control measures so far. There are by now several algorithms developed for each of the four broad methods for CNV detection using NGS, namely the depth of coverage (DOC), read-pair, split-read and assembly-based methods. However, because of the complexity of the genome and the short read lengths from NGS technology, there are still many challenges associated with the analysis of NGS data for CNVs, no matter which method or algorithm is used. Results: In this review, we describe and discuss areas of potential biases in CNV detection for each of the four methods. In particular, we focus on issues pertaining to (i) mappability, (ii) GC-content bias, (iii) quality control measures of reads and (iv) difficulty in identifying duplications. To gain insights to some of the issues discussed, we also download real data from the 1000 Genomes Project and analyse its DOC data. We show examples of how reads in repeated regions can affect CNV detection, demonstrate current GC-correction algorithms, investigate sensitivity of DOC algorithm before and after quality control of reads and discuss reasons for which duplications are harder to detect than deletions.
INTRODUCTIONCopy number variations (CNVs) are an important and abundant source of variation in the human genome, encompassing a greater proportion of the genome, as compared with singlenucleotide polymorphisms (SNPs); an estimated 1.2% of a single genome differs from the reference human genome when considering CNVs, as compared with 0.1% by). In the past several years, SNP arrays and array comparative hybridization (aCGH) are commonly used for detection of CNVs, albeit with relatively low resolution, especially in terms of breakpoint determination. Sanger sequencing of paired reads, often seen as the gold standard for CNV detection, is able to detect CNVs with higher accuracy and resolution, to detect balanced rearrangements such as inversions and translocations and to detect CNVs in regions where probe density of other platforms, such as SNP arrays, is low. However, the technique is not feasible for a large number of genomes because of time and budget constraints. Next-generation sequencing (NGS) or also known as high-throughput sequencing attempts to combine the benefits of array technology and sequencing. The biggest advantage of NGS over traditional Sanger sequencing is the ability to sequence millions of reads in a single run at a comparatively inexpensive cost (). However, because of the complexity of the genome and the short read lengths (usually 35400 bp) from NGS technology, there are still many challenges associated with the analysis of NGS data for CNVs, no matter which method or algorithm is used. The growing popularity and success of NGS are evident from large-scale projects such as the 1000 Genomes Project (http:// www.1000genomes.org/), which aims to sequence at least 1000 individuals from different populations around the world to construct a detailed map of genetic variations in the human genome (). Thus far, in its pilot phase, the project has identified $15 million SNPs, 1 million short indels and420 000 structural variations (SVs), most of which were previously unreported ($61% of deletions and 89% of duplications are novel). The average SV size detected by the study was 8 kb, approximately four times smaller than a recent SV detection study using tiling CGH array (). SVs include dosage-altering variants such as CNVs (usually defined as deletions and insertions larger than 1 kb) and shorter indels, as well as dosage-neutral variants such as inversions and translocations. Nevertheless, current analytical methodologies to analyse NGS data for CNVs are not yet mature, and there are no well-established pipelines/protocols/quality control measures. Broadly, there are four methods for CNV detection using NGS data, namely (i) depth of coverage [DOC, or also known as read-depth (RD) methods], (ii) paired-end mapping (PEM, or also known as read-pair methods), (iii) split-read-(SR) and (iv) assembly-based (AS) methods (). The different methods are usually complementary to one another, as the underlying concepts excel at detecting certain types of variants, and a large proportion of discovered variants remain unique to a particular approach (). For example, in the 1000 Genomes Project CNV analysis, the group applied various variations of the four methods, with a total of 36 call sets with *To whom correspondence should be addressed. vastly varying degrees of false discovery rates (FDR51089%), as well as notable differences in terms of genomic regions ascertained, CNV size range and breakpoint precision among the different methods (). This review article highlights and investigates the challenges encountered when analysing NGS data for CNVs. In particular, we focus on issues pertaining to (i) mappability, (ii) GC-content bias, (iii) quality control measures of reads and (iv) difficulty in identifying duplications. As the characteristics of CNVs in germline and tumour cells are different, we caution that this review focuses largely on CNVs in the germline, and issues unique to tumour CNVs (also known as copy number alterations) are not discussed.
FOUR CLASSES OF METHODS FOR CNV DETECTION USING NGSWe describe each of the four methods for CNV detection using NGS data, namely (i) DOC, (ii) PEM, (iii) SR and (iv) AS methods. Except for the latter, the other three classes of methods require first mapping the sequenced reads to a known reference genome. We summarize a list of commonly used software for CNV detection using NGS data in. Readers may refer to seqanswers website: http://seqanswers.com/wiki/Software for a more comprehensive list. The underlying concept of identifying CNVs using DOC is similar to that of using intensity data: a lower than expected DOC/intensity indicates deletion and a higher than expected DOC/intensity indicates duplication. Most DOC methods count the number of reads that fall in each pre-specified window of a certain size (). The algorithm relies heavily on the assumption that the sequencing process is uniform, i.e. the number of reads mapped to a region is assumed to follow a Poisson distribution and is proportional to the number of copies. However, certain biases such as GC-content and mappability cause this assumption to be unrealistic. Regions of the genome may be), whereas there are others that use ratios between reads from the target and reference genome and claim to mitigate the need for GC-correction if the two data sets are prepared in the same way (). Other algorithms also exploit SNP heterozygosity information or also known as 'B allele frequency' to call CNVs and loss of heterozygosity (LOH) regions (). DOC algorithms usually detect large CNVs and are unable to detect copy neutral events such as inversions and translocations. Single-end or paired-end data may be used for this analysis. PEM methods require the reads to be paired (). The concept is that the fragments of deoxyribonucleic acid (DNA) from which the reads are to be sequenced have a fragment length (or also known as insert size) of a certain distribution. When the sequenced ends of the fragment map to the reference at a distance longer than expected, it is indicative of a deletion in the studied genome. Vice versa, when the sequenced ends of the fragment map to the reference at a distance shorter than expected, it is indicative of an insertion in the studied genome. Based on the patterns from which the paired reads are mapped to the reference, PEM can also detect inversions and translocations (see Xi et al., 2011 for a review of the different SV signatures in PEM). For example, if the two ends of a fragment are mapped with a wrong orientation, it could be an indication of an inversion (). The size of CNVs detected using PEM is limited by the insert size, and as a result, PEM often detects smaller CNVs. SR methods focus on pairs of reads where one read is mapped uniquely to the reference, whereas the other read failed to be aligned (). The idea is that the location of the unmapped read may span the breakpoint of the CNV. The mapped read is used as an anchor to narrow down the search space for the SR alignment of the unmapped read. SR analysis has the advantage of being able to pinpoint the location of the breakpoints. AS methods, on the other hand, do not align the reads to a known reference but construct the genome piece-by-piece; this is also known as de novo sequencing. Some AS methods still use the reference genome as a guide to resolve repeats. This is known as comparative assembly (). AS methods can discover new non-reference sequence insertions. AS methods work best for small genomes such as bacterial genomes and are less widely used in NGS sequencing of humans because the short reads from NGS makes assembly in repeat regions difficult (). Most AS algorithms for NGS data are extensions of the method described by, which uses de Bruijn graphs. It is difficult to judge which method is superior, although the methods developed more recently such as SOAPdenovo (), claims faster computation time and longer contig size and assembly accuracy when compared with earlier methods such as ABySS () and velvet (). Cortex () is capable of assembling multiple genomes simultaneously.In the 'Phred score filtered dataset', we further remove 7% of the reads whose mapping quality is 530 (but not zero). Approximately 14% of the reads have a mapping quality of zero. These multi-reads are reads that cannot be uniquely aligned to a single position in the genome, meaning that there exists more than one location where the read can be mapped to equally well. We observe the patterns of multi-reads in regions with known CNVs to investigate how these reads can affect CNV detection., were used to generate a new map of CNV locations. Subsequently, a customized Agilent CGH-platform composed of 105 000 oligonucleotide probes was used to detect the loci, and the genotypes were estimated for 450 HapMap samples using a Bayesian algorithm with stringent selection for optimal normalization and cluster locations for every locus (see Supplementary Methods infor more details). In total, for individual NA12891, there are 517 deletions (copy number 52) and 253 duplications (copy number42). It should be noted, however, that a true gold standard reference list for CNVs is not available, and this list does not have 100% sensitivity and specificity.
Reference CNVs
SNP array intensitiesWe download SNP array intensities for the Affymetrix 6.0 array for individual NA12891 from the HapMap 3 project raw data database (ftp://ftp.ncbi.nlm.nih.gov/hapmap/raw_data/ hapmap3_affy6.0/). We use the PennCNV algorithm () to obtain log R ratios (LRRs), using samples from the third phase of the HapMap project as the reference panel.
High-confidence regionsTo investigate the reasons for the discordance between the reference regions and DOC data, we plot DOC data for specific regions and observe patterns in the data. To narrow down our search for interesting regions, we limit this analysis to high-confidence regions, which we define as follows: a deletion region from the reference list is considered 'high-confidence' if it also shows an average LRR of 5log(0.5) $ 0.7. A duplication region is considered 'high-confidence' if it shows an average LRR of 4log(1.5) $ 0.4. There are 60 high-confidence deletions and 8 high-confidence duplications. The regions range from 1 to 156 kb, and the number of SNP markers range from 1 to 73.
REPEAT REGIONS AND MAPPABILITY ISSUESNGS technology produces mainly short reads, and this poses a challenge in the alignment to the reference genome because reads that fall in repetitive regions in the genome cannot be mapped unambiguously. Furthermore, mutations or sequencing errors in one or two locations may also cause reads to be mapped wrongly (). In the 1000 Genomes trios Project, $20% of the reference genome was considered inaccessible (defined as regions with many ambiguously placed reads or unexpectedly high or low numbers of aligned reads). The resulting low sensitivity in detecting CNVs in repeated/segmental-duplicated regions is a serious problem because there is an observed enrichment of CNVs in segmental duplicated regions, and many breakpoints lie in duplicated regions (). This class of CNVs is one of the most poorly studied variants, as previous technologies for CNV detection such as aCGH and SNP arrays also have problems resolving them. For AS methods, repeat regions create challenges because if the read length is shorter than the repeat region, it is not straightforward to decipher the original sequence because overlap between the reads or contigs will be ambiguous (). For other methods that require mapping to a reference, there are different alignment strategies for dealing with multi-reads, such as (i) discarding the reads, (ii) choosing a position at random out of all equally good match positions and (iii) reporting all possible positions. The first strategy limits the analysis only to unique regions of the genome, and may miss many CNVs. Moreover, when using DOC methods, excluding multi-reads may cause the identification of false deletions, i.e. regions with a large number of multi-reads will be falsely detected as a deletion if these reads were removed. This is illustrated in, which shows a region in Chromosome 20 where several deletions would be falsely identified if multi-reads are excluded. This phenomenon was also observed by, whose algorithm picked up ten times as many deletions when multi-reads are discarded. Placing a multi-read at random (Strategy 2) is also not ideal: for example, a true deletion may exist in a region where there exist similar sequences elsewhere in the genome, causing multi-reads to be mapped to the deletion region where there is supposed to be less or none, thereby diluting the signal (). This suggests that the alignment strategy of discarding multi-reads or random placement of multi-reads is inadequate for detecting duplications in repeated regions. A better strategy incorporating other alignment methods and other kinds of data is needed to identify these regions.developed a new algorithm for tandem CNV reconstruction in repeat-rich regions that considers all locations of possible mappings and uses information on PEM and DOC.developed a new alignment method, mrFAST; the aligner maps short sequence reads to a repeat-masked reference genome, meaning that all loci with known high-copy common repeats were first masked before alignment, and reports all mapping locations for multi-reads. It also keeps track of mutation in multi-reads. This method has been shown to be able to predict absolute copy number and multi-copy differences.also uses a similar approach to identify and genotype CNVs within segmental duplications. However, these approaches seem to work only for deeply sequenced data (420), and more has to be done to extend these methods for lower coverage data (). Longer read lengths from third-generation sequencing (TGS) may partially solve the problems with repeats, but even with a read length of 1 kb, there still remains $1.5% of the human genome sequence that is non-unique ().
GC-CONTENTIt has been observed that DOC has a unimodal relationship with GC-content (), where regions with high or low GC-content have decreased DOC.also observed that unique sequences present at equimolar quantities in library generation end up being sequenced at vastly different DOC. This bias causes problems in all methods. For example, in PEM or SR methods, a region of low DOC may have insufficient reads for enough evidence to discern the variants at that location. For AS methods, regions with low coverage may also result in insufficient information to infer a continuous sequence (). The problem can however be solved by increasing the overall sequence depth. The most affected of four methods by GC-content bias is the DOC method. DOC algorithms rely heavily on the assumption that the sequencing process is uniform, so that the DOC can be assumed to be proportional to the copy number. However, when there are biases that cause sequencing depth to differ for reasons other than the change in copy number, it makes differentiating true deletions/duplication from under/over-sampled regions in the genome difficult. Previous published algorithms correct for GC-content by adjusting the DOC in the window using the GC-content of the window (). This method of correction may be inadequate as the choice of bin size is often arbitrary. Moreover, several studies have observed that it is the GC-content of the full DNA fragments, not only the reads, that causes most of the bias (). A recently developed algorithm for GC correction considers the GC-content of the fragment and can produce base pair resolution predictions of GC-content bias (). We applied the method on this data set but observed an increase in overall variance of DOC after correction. Hence, we did not use the results of this correction for subsequent comparisons (see Supplementary Materials for more details). We download the GC-content per five bases from the University of California, Santa Cruz genome bioinformatics website: http://hgdownload.cse.ucsc.edu/goldenPath/hg18/gc5 Base/. We correct for GC-content bias in a similar fashion as described by. The GC-corrected DOC was calculated using the following equation:where i is the bin index, RD global is the average DOC over all bins in the chromosome (we used a trim mean, omitting 5% of bins from both extremes), RD i raw is the DOC for the i th window before correction and RD gc is the median DOC of all windows with the same GC-content. As there are few windows with GC 520 or 475, for robustness, we set the lower/upper limits for GC in a window to 20 and 75, respectively.(left) plots the DOC of the windows versus the GC percentage of the windows. We observe a similar unimodal relationship between DOC and GC-content, as reported by previous articles. In AT-rich regions, coverage increases with increasing GC, and in GC-rich regions, coverage decreases with increasing GC. The peak coverage can be different for different data sets and different chromosomes but is usually located betweenshows that GC-content bias is removed after correction. However, it is worth noting that even though GC-content bias is removed, the variance in DOC remains rather large, meaning that not all local variations in DOC are associated with GC-content and thus cannot be removed by the GC-correction. The cause of GC-content bias is speculated to be largely because of polymerase chain reaction (PCR) amplification step in NGS (). As PCR amplification is not required in TGS, bias observed in DOC because of PCR may be resolved (). The longer read lengths of TGS will also improve challenges caused by the short read lengths of NGS. However, as TGS technology is still new, it is premature to comment on its performance, and too soon to judge whether TGS can fulfil its promises of advancement over NGS.
PHRED-SCORE FILTERINGThere has been little documentation on how read mapping quality affects CNV calling. Most algorithms state a default filtering criteria without any substantial evidence for the choice. For example, PEM algorithm, BreakDancer, uses a default filter of mapping quality 410 (), whereas DOC algorithm, Rdxplorer, uses a default filter of mapping quality 430 ().
COMPARISONSWe perform sensitivity analysis to investigate the effects of GC-correction and Phred-score filtering. We compare three methods: (i) GC-corrected and Phred-score filtered, (ii) GC-corrected but not filtered by Phred-score and (iii) Phredscore filtered but GC-uncorrected. For each CNV in the reference list, we use the t-statistic to determine whether the DOC in the region is significantly increased/decreased. For each deletion region i, we calculate the t-statistic as such:where x i is the average DOC in the region, ^ g is the global average DOC for the chromosome where the region lies, ^ i is the standard deviation of the DOC in region i, n i is the number of windows in the region and c is a constant that we vary from 0.5 to 0.8. For each duplication region j, the t-statistic is calculated in a similar fashion:where k varies from 1.2 to 1.6. For each set of tests, we account for multiple comparisons using the FDR. A region is identifiable if the FDR is 50.01.shows that there are little differences in sensitivities for all three methods, suggesting that both GC-correction and Phred-score filtering do not seem to be crucial in the sensitivity of detection of CNVs. It should be noted however that this analysis does not investigate the specificity of CNV detection. Overall, GC-correction and Phred-score filtering lowers the variance of DOC, indicating the potential of minimizing the number of false positive regions identified. However, this is a simple and limited analysis, and further studies are needed to discern the benefits of GC-correction and filtering by Phred-score.
INSERTIONS ARE HARDER TO DETECT THAN DELETIONSFor all methods, identifying duplications has been acknowledged as more challenging as compared with identifying deletions. With regards to PEM methods, the bias against detection of insertions is because PEM detects insertions when the mapped reads are at a distance shorter than the fragment length, and hence, it is unable to detect insertions larger than the insert size of the reference library, or more specifically the length upper bound of an insertion detected is the average fragment length minus the length of the reads (). This is evident in detection of CNVs using PEM of the diploid Asian 'YH' genome, where 2441 deletions were identified as compared with 33 duplications (). In DOC methods, we observe that the sensitivity of detecting deletions and duplications is $89 and 25%, respectively, for the best case scenarios (). This observation is similar to that observed in, who estimated that $90% of deletions identified by aCGH or SNP arrays are DOC accessible, whereas only 2030% of duplications are DOC accessible. This may be because of the lack of sensitivity of DOC methods in distinguishing a change in number of copies from N to N  1, especially if N is large. For example, suppose a sequence is repeated twice in the reference genome (N  2) at locationsA and B, although the studied genome has an additional copy (N  3). Then, assuming an average of 20 coverage, locations A and B would have an average of 60 reads shared among both locations (following strategy of random placement of multireads), meaning an average of 30 reads at both A and B, a 50% increase in DOC. If we increase N to 5 in the reference and 6 in the studies genome, then each repeated location in the reference would have an average of 120/5  24 reads, only 20% more than the average, and likely to be undetectable because of the high variance in DOC. In the list of high-confidence regions (see section 'High-Confidence Regions'), all 60 deletions can be found in at least one release set from Mills et al. (2011), but four of the regions were not detected by DOC methods. When we plotted the read depth in these regions, we observed that two regions have obvious decreased DOC (shown) and should have been detected, whereas the other two were not detected most likely because of the presence of multi-reads diluting the deletion signal (see). On the other hand, all eight duplications are not identified in any of the release sets (seeand Figs S18 in Supplementary Materials). This is partly because of the fact that most release sets infocus mainly on deletions, with few sets reporting duplications/insertions. Even then, of the 8 regions, only Regions 2 and 5 show distinct elevated DOC; these regions have little or no multi-reads. Among the other six regions that do not show obvious increase in DOC, four of them overlap with known segmental duplication regions (segmental duplicated regions as defined in http:// humanparalogy.gs.washington.edu/). This is also supported by the presence of multi-reads in these regions; neither keeping nor removing multi-reads result in strong DOC signal of the presence of duplication.
DISCUSSIONNGS, with its ability to perform massive parallel sequencing in a single run, is becoming increasingly popular. This brings with it an unprecedented opportunity to sequence many genomes at a relatively inexpensive cost (as compared with using Sanger sequencing). However, with billions of reads generated per individual, the sheer and exponentially increasing amount of data demands for better bioinformatics support and computers with larger storage and higher computing powers. No less important than the production of the data is the information technology infrastructure, and bioinformatics team needed to analyse it, with speculations that the costs associated with handling, storing and analysis of the data could be more than the production of the data. Analysing NGS data for structural variants is a relatively new and challenging field, with no standard protocols or quality control measures. The four methods of CNV detection are complementary. Comparing DOC, PEM and SR methods used in the 1000 Genomes Project, each approach uniquely discovered 30 60% of the CNVs (). These three methods require first mapping the sequenced reads to a reference genome. As the mapped reads are used in all downstream analysis, this first step of alignment is extremely crucial. As has been shown in the article, how the aligner or subsequent algorithm deals with reads in repeat regions is important for detecting variants that lie in these regions. Currently, the problem of CNV detection in repeated regions is still not completely solved. Using real data from the 1000 Genomes Project, this article highlights and investigates challenges associated with current methodologies and areas of potential biases encountered when analysing NGS data for CNVs. In particular, we focus on issues pertaining to (i) mappability, (ii) GC-content bias, (iii) quality control measures of reads and (iv) difficulty in identifying duplications. We feel this is a timely critical review that would aid researchers in a much needed well-validated pipeline for the analysis of structural variants.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
S.M.Teo et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Some algorithms use a combination of methods for more accurate detection of CNVs. For example, CNVer (Medvedev et al., 2010), HYDRA (Quinlan et al., 2010) and SVDetect (Zeitouni et al., 2010) supplements DOC with PEM information. Genome STRiP combines information from DOC, PEM and SR, as well as other features of sequence data at population level (Handsaker et al., 2011). Genome STRiP is one of the highest performing methods used in the 1000 Genomes pilot Project, indicating that there is benefit in combining different approaches (Mills et al., 2011). 3 DATA SETS For the purpose of gaining insights to the issues we are about to discuss, we download sequenced data of individual NA12891 that was deeply sequenced (420 coverage) by the Illumina Genome Analyzer platform as part of the 1000 Genomes pilot Project (The 1000 Genomes Consortium, 2010). The reads are paired, 36 bases in length and aligned to the human reference build 36 (hg18) using the MAQ aligner (Li et al., 2008). The aligned reads are downloaded in BAM format from http:// www.1000genomes.org/. MAQ calculates a Phred-scaled quality score for each read/ pair of reads that is equal to minus ten times the common logarithm of the probability that a read is wrongly aligned; a quality score of 30 indicates a 1 in 1000 probability that the read is incorrectly mapped. When a read can be mapped equally well to more than one location, a random position is chosen out of all equally possible positions, and the reads are assigned a quality score of zero; these reads are termed multi-reads (Harismendy et al., 2009; Treangen et al., 2012). Different aligners have different approaches of dealing with multi-reads. For example, the aligner 'micro-read fast alignment search' (mrFAST) reports all suitable positions of multi-reads (Alkan et al., 2009). 3.1 Estimating DOC We estimate DOC by counting the number of reads, based on their start positions, in non-overlapping windows of 100 bases. This is the current strategy of most DOC algorithms (Abyzov et al., 2011; Yoon et al., 2009). 3.2 Pre-filtering criteria For DOC calculation, we keep only reads that are flagged properly aligned, termed 'read mapped in proper pair' in Picard (http://picard.sourceforge.net/explain-flags.html), and reads that are not paired (i.e singletons). Approximately 67% of the reads are flagged properly aligned and $23% are singletons. We exclude reads that are technical duplicates, paired reads where one read in the pair is unmapped and other reads that are not 'mapped in proper pair'. Singletons are reads where only one end of the fragment is sequenced either because of library preparation or sequencing failure of one the reads in a pair (A.Abyzov, personal communication, Nov 2011). It should be differentiated from reads that are paired but where only one of the reads in the pair is mapped to the reference. Singletons are informative and should not be filtered. This is illustrated in Figure 1, which shows obvious signal of decreased DOC using only singleton reads in a region validated to be a deletion by Mills et al., 2011.
Statistical challenges with detecting CNVs with NGS at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
