Motivation: Elementary flux mode (EFM) is a fundamental concept as well as a useful tool in metabolic pathway analysis. One important role of EFMs is that every flux distribution can be decomposed into a set of EFMs and a number of methods to study flux distributions originated from it. Yet finding such decompositions requires the complete set of EFMs, which is intractable in genome-scale metabolic networks due to combinatorial explosion. Results: In this article, we proposed an algorithm to decompose flux distributions into EFMs in genome-scale networks. It is an iterative scheme of a mixed integer linear program. Unlike previous optimization models to find pathways, any feasible solutions can become EFMs in our algorithm. This advantage enables the algorithm to approximate the EFM of largest contribution to an objective reaction in a flux distribution. Our algorithm is able to find EFMs of flux distributions with complex structures, closer to the realistic case in which a cell is subject to various constraints. A case of Escherichia coli growth in the Lysogeny broth (LB) medium containing various carbon sources was studied. Essential metabolites and their syntheses were located. Information on the contribution of each carbon source not obvious from the apparent flux distribution was also revealed. Our work further confirms the utility of finding EFMs by optimization models in genome-scale metabolic networks.
INTRODUCTIONImmediately after the success in genomics, the next step is to fill the gap between genotypes and phenotypes to have a full picture of biological systems. The genome-scale metabolic network has been playing this role and has been found useful in answering biological questions (). During the past decade, various methods have been proposed to analyze metabolic networks and the constraint-based modeling approach is exceptionally prominent (). One object of particular importance and increasing interest in the approach is the elementary flux mode (EFM). EFM is an important theoretical concept as well as a practical tool in metabolic pathway analysis. Theoretically, it is the minimal operational unit * To whom correspondence should be addressed. at steady state in metabolic networks satisfying the thermodynamic constraint regarding the reversibility of each reaction (). Practically, EFMs have been applied in a variety of studies: investigating network structures like network robustness (), dynamic properties of pathways (), pathway efficiency () and modularity (), exploring new pathways () and hence suggesting rational strain design (;), predicting mutants' behavior (), identifying interactions with other networks (), etc. (reviewed in). An important interpretation of EFMs is that every flux distributioncan be decomposed as a positive sum of a subset of EFMs {e j } with the 'no cancelation' property that all e j have a particular component being zero wherever v has that component being zero (). That is,) for all j where Z(v) ={i|v i = 0} is the index set for the zero components of v. The 'no cancelation' property is unique compared to other generating sets of the flux space like extreme pathways (EPs) (). In many studies, flux distributions are analyzed by similar decompositions. The first attempt is the spectrum to determine the range of attainable weights for each EP (). This approach is also applicable to EFMs. Later, decomposing flux distributions with minimum sum of weights has been proposed () and applied to study yeast glycolysis (). Decompositions with respect to other objectives have also been adopted to investigate particular cases, for instances, maximum number of active EFMs (), minimum relative error (), maximum yield rate () and maximum entropy (). There are also other studies analyzing flux distributions by decompositions into EFMs (e.g.). These approaches based on decomposing flux distributions, despite the insights they have provided, have their capabilities limited because the calculation always requires the complete set of EFMs in prior given a metabolic network, whose computation is notoriously hard due to the combinatorial explosion when the network size grows. This drawback was first studied in Klamt and Stelling (2002) and has been mentioned in many literatures (e.g.).Page: 2257 22562262
Elementary flux modeTo overcome the difficulty, efforts have been put to improve the computational speed and memory demand for computing EFMs. The first algorithm was presented in. Improvements have then been made continuously by introducing the nullspace approach to reduce computational cost (); the binary approach to save a great deal of memory and allow bit operations (); the elementary testing by matrix rank to accelerate computations (); the bit pattern trees to hasten elementary testing () and the latest recursive enumeration approach based on bit pattern trees (). Software implementing these approaches has also been engineered, including METATOOL (), FluzAnalyzer (), CellNetAnalyzer (), EFMtool (). Despite these improvements, these algorithms still cannot cope with genome-scale metabolic networks reconstructed recently, usually consisting of at least a thousand of reactions and metabolites (e.g.). One characteristic in common of the mentioned approaches to calculate EFMs is that they all compute the complete set of EFMs given the network stoichiometry and this is the major reason of the computational infeasibility in genome-scale networks, because the size of the full set grows extremely fast (). As an alternative, recently there have been attempts to find specific metabolic pathways from stoichiometric information by optimization modeling. They are able to cope with the scale and furthermore to identify pathways with specific requirements. Beasley and Planes (2007) found pathways matched with literature by balancing 'low presence' compounds and minimizing the number of reactions involved and ATP consumed. Later by further considering connectivity of compounds, linear pathways were located (). Also, the K-shortest EFMs in genome-scale networks have been calculated successfully by an optimization model (). More recently, the K-shortest generating flux modes, a subset of EFMs, have also been investigated by a similar model (). In this article, we present an algorithm to find a set of EFMs that decomposes a given flux distribution in a genome-scale metabolic network without finding the complete set of EFMs in prior. The algorithm solves optimization models recursively with data stored in a stack structure. Its implementation is highly dynamic. By editing the model being solved, a set of EFMs with certain properties can be found. In addition to the basic decomposition, the algorithm can approximate the EFM with largest contribution to a particular objective reaction in a given flux distribution.
METHODSGiven the network stoichiometric matrix S, a flux distribution or equivalently a flux mode, is a vector v satisfying the steady-state assumption with its irreversible reactions having non-negative fluxes, i.e.An EFM by definition is a flux mode unable to be decomposed as the sum of two other flux modes, whose active reactions are proper subsets of those of that flux mode (). This is called nondecomposability, elementarity or genetic independence. Mathematically, a flux mode e is an EFM if there are no flux modes v 1 , v 2 such thatIn this article, if for a flux mode e, such v 1 , v 2 exist, they are said to be bounded by e. The algorithm proposed exploits this decomposability. In what follows, first, an optimization model to check the decomposability of a given flux mode is formulated, followed by the algorithm integrating the model to decompose flux distributions. Then, modifications of the algorithm to approximate EFMs of largest contributions are presented.
Decomposability checkSuppose there is a metabolic network consisting of m metabolites and n reactions with stoichiometric matrix S =Each reaction is assigned with a binary integer variable a j specifying the on/off condition by the following constraints: a j  p j for j = 1,...,n (2)p j  M j a j for j = 1,...,n (3)where M is a large positive number and  j = 1 if v j > 0 and  j = 0 otherwise. If a j = 0, from(3), we have p j = 0 and thus reaction j is not involved, else if a j = 1, from(2) we have p j  1 and reaction j must has a positive flux. Constraints similar to (2)and(3) have been employed to find pathways before (). The difference of our approach lies in the introduction of  j. If  j = 0, a j and p j are forced to be zero by (2) and (3). In other words, if v j = 0, p j = 0. This implies Z(v)  Z(p), necessary for p to be bounded by v. For the large number M, it can be interpreted as the greatest stoichiometric ratio allowed within the flux mode p, so it should be sufficiently large to allow all flux modes bounded by v to satisfy (2) and (3). To ensure p is non-trivial, i.e. has at least one non-zero flux, we have:For p to be properly bounded by v, the number of non-zero fluxes in p must be less than the number of non-zero fluxes in v, so we have:Finally, since all reactions are irreversible, all fluxes must be positive:Constraints
S.H.J.Chan and P.Jithe biomass composition, and turning these coefficients into integers will make them too large in magnitude and inconvenient for computation.
Decomposition of flux distributionsThe algorithm to decompose flux distributions is an iterative scheme of DC. Flux modes involved are stored in a stack structure. The decomposability of the given flux distribution is first examined by DC. If it is decomposable, the flux mode bounded by it that is returned by DC will be stacked up and become the current flux mode. Else if it is non-decomposable, an EFM is reached and it leaves the stack. The EFM found is then used to update each intermediate flux mode by subtracting a scalar multiple of the EFM. After updating, intermediate flux modes unable to contribute to the first flux mode are removed. This procedure is repeated until all flux modes leave the stack. A set of EFMs decomposing the flux distribution is then obtained. Let N be the number of flux modes in the stack, K be the number of EFMs found. The s-th flux mode in the stack is denoted as fm s with the flux of the j-th reaction being fm sj. efm k and efm kj are similarly defined for the k-th EFM. The steps of the algorithm can be summarized as follows:Step 4. For s = 1,...,N 1,Step 5. Remove fm N from the stack. If N > 2, for s = 2,...,N 1, check if Z(). If no, remove fm s from the stack. Set N to be the current size of the stack. Go to Step 1.The algorithm can be interpreted as decomposing fm 1 repeatedly until fm 1 becomes an EFM. Step 1 checks the decomposability of the current flux mode fm N. If a feasible solution exists, the flux mode is not an EFM and it is replaced by a new flux mode bounded by it which is found by DC as indicated in Step 2. The procedure is repeated until an EFM is reached. Once an EFM is found, in Step 3, first we check whether it is the only flux mode in the stack. If it is, this means it is the last EFM and the algorithm is terminated. Otherwise, it will be used to update all flux modes in the stack as in Step 4. Note that after each updating step, fm 1 is the flux mode remaining to be further decomposed. This updating process serves to eliminate the largest possible fluxes that are able to be contributed by the EFM found in each preceding flux mode. The number of non-zero entries in each flux mode is diminished. This step can accelerate computations because there are less non-zero entries needed to be dealt with in each flux mode. In practice, Step 4 can be efficiently performed by matrix multiplications. After updating flux modes, some intermediate flux modes may have positive entries that have become zero in fm 1. The 'no cancellation' property states that these flux modes cannot contribute to fm 1 anymore, so they are removed from the stack in Step 5, which is carried out by bit operations. In fact, they can still contribute to v, but it turns out that Steps 4 and 5, besides saving memory and computational cost, guarantee that the finally resulting set of EFMs has the following four nice properties. The first two properties are the 'denseness' and 'uniqueness' of the solution. No EFM found is redundant and each EFM has a unique positive weight in the decomposition. The other two properties of greater theoretical interest are the linear independence and systemic independence of the solution set, i.e. the set of solution EFMs forms a linear basis as well as a convex basis for the flux distribution. These four properties, which follow from the fact that our algorithm decomposes a flux distribution by stepwise finding an EFM and reducing the flux mode, also hold in the original flux space in which a reversible reaction is not transformed into two irreversible reactions. They together give an exact role for each EFM in the solution. The cooperation between different pathways can be clearly revealed. This brings more exact biological interpretations. These properties are proved and explained with an example in detail in the Supplementary Material. There are two major differences of the proposed algorithm compared with previous optimization models to find pathways. First, it is an iterative scheme to solve optimization models instead of solving a single optimization model. Second, any feasible solution can finally become an EFM and optimality is not necessarily needed. Every optimization objective works. In what follows, we propose one for a specific application.
Approximation of EFMs of largest contributionsIn flux balance analysis (FBA), cellular metabolism is assumed to achieve an optimal state with respect to an objective like the maximum growth rate () and ATP production (reviewed in). Conversely, for a flux distribution (maybe experimentally measured, or simulated by methods other than FBA), if a biologically reasonable objective of the cell can be assumed, it will be insightful to decompose the flux distribution into EFMs that have considerable contributions to that objective. By 'contribution', we mean the flux of the objective reaction provided by an EFM in the flux distribution. Finding largest contributing EFMs can reveal principal operational modes in cells. We applied our algorithm to approximate such decompositions with only two modifications required. The first is the replacement of objective (7) by:where j 0 is the objective reaction that we are interested. The resulting solution flux mode then has the greatest flux at reaction j 0. Nonetheless, the flux mode can possibly contribute little to fm 1. This comes to the second modification which replaces constraint (3) by:Here  j is replaced by fm 1j. This takes the flux values of fm 1 into account. Intuitively, the solution flux mode should have a better contribution because upper bounds for fluxes are not the same but proportional to the fluxes of fm 1. In fact, the stepwise solution has the maximum contribution to the objective reaction flux in fm 1 among all flux modes bounded by fm 1. This also forms the rationale of applying the algorithm to approximate EFMs with largest contributions: in each step, the best flux mode bounded by the current flux mode is found until an EFM is reached. Hence, it is a greedy approach. For the large number M , it should be chosen large enough to properly scale fm 1 to allow all feasible flux modes.
ImplementationsBoth versions of the optimization model DC [Version 1: objective (7) subject to constraints (16); Version 2: objective (7 ) subject to constraints (12),were solved by ILOG CPLEX. As for the algorithm, all the data and operations other than solving optimization models were processed in MATLAB. For hardware, all computations were performed in a desktop computer with a 2.67 GHz CPU and 24 GB of RAM.
RESULTSWe applied our algorithm to three metabolic networks of different sizes. The first is the sample network used to demonstrate regulatory FBA () and study -spectrum (). The second is the core metabolic network of E.coli K-12 MG1655 iAF1260 (). It is more realistic with a size considerably larger than the first one. The two networks were used as benchmarks to validate our algorithm. To highlight the usefulness of our algorithm complementary to existing methods, a computational experiment was then conducted.
Elementary flux modenetwork () were used to compare the performance of our algorithm and EFMtool (), which should be the most efficient algorithm to find full sets of EFMs up to the best of our understanding. Finally, a flux distribution simulating the growth of E.coli in the LB medium (, b) was studied.
BenchmarksFor each of the two networks for benchmarks, we first randomly sampled 2000 flux modes (), implemented with the COBRA Toolbox () and decomposed them by our algorithm. We then checked whether the solutions were true EFMs able to be located by EFMtool. For the approximation of EFMs of largest contributions, we chose the biomass production or equivalently growth rate as the objective reaction. We checked the rankings of the EFMs found among the full set of EFMs. The detailed test procedure can be found in the Supplementary Material.
Sample metabolic networkThere are 20 reactions and 19 metabolites in the sample network. The number of EFMs found by EFMtool was 82, the same as in. In their paper, an algorithm for EPs was used, but since each reversible reaction was treated as two irreversible reactions, the result coincides with the set of EFMs (). In average, Version 1 of the algorithm took 5 s to decompose a flux distribution and Version 2 took 6 s. It was verified that all solutions belong to the set of EFMs computed by EFMtool. For Version 2, in 98% of the 2000 samples, EFMs of maximum contributions to the growth rate in the flux distributions are the first EFMs found. The corresponding percentage for Version 1 is only 15%. All other solutions by Version 2 except one contain EFMs of the second or third largest contributions.
Core E.coli K-12 MG1655 iAF1260 metabolic networkThe core E.coli metabolic network contains 95 reactions and 72 metabolites. By restricting substrates for uptake of glucose, phosphate, CO 2 , H + , H 2 O, NH 4 and O 2 only, over 100 000 EFMs were found by EFMtool. The number is comparable to previous studies with similar configurations (). One issue complicating the computation is the fractional stoichiometry in the biomass reaction estimated from molecular content (). Magnitudes of coefficients in the reaction highly vary. The ratio of the greatest to the smallest is 840. In average, Version 1 of the algorithm took 12 s to finish and Version 2 took 18 s. All solutions were verified to be true EFMs. For Version 2, the greatest contributing EFMs were first found in 97% of the 2000 trials. Among all, 80% of the remaining solutions contain EFMs whose contributions rank top 10%. The success rate is significant in view of the number of different contributions by all EFMs in each sample, which is over 7000 in average. The benchmark results for the two networks different in size show that our algorithm can decompose flux distributions into sets of EFMs. Furthermore, it is capable of approximating the best contributing EFM in a flux distribution with respect to a reaction.
E.coli K-12 MG1655 iAF1260 metabolic networkThe complete E.coli K-12 MG1655 iAF1260 genome-scale metabolic network reconstructed byis a huge
Computational experimentIn cell culture experiments, minimal media containing one carbon source and necessary inorganic compounds only are often preferred due to the ease in analysis. Correspondingly, flux distributions of optimal growth rate simulating these cases consist of only few EFMs regardless of the network complexity. In this case, existing tools are able to find the set of EFMs that contributes to a flux mode by considering the subnetwork formed by the active reactions in the flux distribution (called subnetwork of a flux distribution). Realistic metabolic fluxes are, however, shaped by factors like gene regulation and in particular heterogeneous nutrients (). Structures of flux distributions are thus more complicated and existing tools may not cope with them. To test the capability of our algorithm to analyze these cases, we performed a computational experiment. In the E.coli MG1655 iAF1260 metabolic network, there are 299 possible uptake substrates. In each trial, in addition to inorganic compounds necessary for growth, a random set of carbon sources, whose uptake rates  1 mmol gDW 1 h 1 , was available and a flux distribution of optimal growth rate was determined. It was then decomposed by Version 2 of our algorithm with growth rate as the objective. Meanwhile, we tried to find the full set of EFMs of the subnetwork of the flux distribution by EFMtool. In the computational experiment, the number of active reactions N r , partially reflecting the complexity of a flux distribution, increases with the number of carbon sources consumed N c linearly. In general, when N c  30, EFMtool was unable to find the full set of EFMs of the subnetwork of the flux distribution. In contrast, our algorithm succeeded to decompose every test flux distribution. In certain cases with large N r in the flux distributions but a small number of contributing EFMs in the solution found, N efm (<50), EFMtool was unable to find the sets of EFMs of the subnetworks while our algorithm could find EFMs decomposing the flux distributions in relatively short time (, '+'s with small N efm ). This corresponds to the situation in which a flux distributionMelibiose (melib) l-Methionine (met-l) d-glucosamine (gam) l-serine (ser-l) l-Rhamnose (rmn) Trehalose (tre)
S.H.J.Chan and P.JiAbbreviations adopted fromare written in brackets. having an enormous number of contributing EFMs can actually be represented as a convex sum of only a few of those EFMs. Our algorithm is very useful and efficient in this case. Moreover, the memory demand is not expensive as the most complicated cases in the computational experiment can also be solved by our algorithm in a computer with 2 GB memory only. The complexity of our algorithm was also examined. The computational time increases with N efm as well as N r (). Regression indicates a satisfactory linear relationship between the computational time and the product N efm N r (R 2 = 0.97). The computational experiment showed that our algorithm is more advantageous than existing methods in analyzing flux distributions with complex structures, which are closer to realistic cases in which a cell is subject to complicated factors. Details of the test and test results are provided in the Supplementary Material.
A case of growth in the LB mediumThe LB medium, or usually called Luria-Bertani medium, is one of the most common complex media used in bacterial growth. It is composed of tryptone, yeast extract and NaCl. In their studies,monitored the utilization of sugars, alcohols, organic acids () and amino acids, peptides, nucleotides () indirectly by transcriptional microarrays during the growth of E.coli MG1655 in the LB medium. Interestingly, during about 35 h of fermentation, simultaneous assimilation of a set of carbon sources was observed (). Combining the result in, a large number of sugars, amino acid and other carbon sources were absorbed during the time period. We simulated a flux distribution describing the metabolism of E.coli under such conditions by optimizing the growth rate in FBA and allowing the list of carbon sources inand some inorganic compounds for uptake. Maximum oxygen uptake rate (18.5 mmol gDW/h) and ATP maintenance (ATPM) cost (8.39 mmol gDW/h) under growth condition determined experimentally inwere adopted. All maximum uptake rates of carbon sources were set to be 0.5 mmol gDW/h for simplicity because information on enzyme capacities was not given. We denote the simulated flux distribution by f 0 to avoid confusion in the following discussion. f 0 consists of 493 reactions and consumes all 25 carbon sources. To understand the complexity and the difference of f 0 due to multiple sources, we found the maximum flux contribution of each individual carbon source to f 0 by maximizing the sum of fluxes, setting f 0 as the upper bound and allowing only that source for uptake (Supplementary Material for details). Surprisingly, only three non-zero flux modes consuming l-fucose, d-lactate and l-lactate, respectively, were resulted, each verified to be EFMs by EFMtool. They together provide the whole ATPM flux in f 0 and no single carbon source is independently consumed for growth. Meanwhile, we tested whether each carbon source can be metabolized into biomass by maximizing the growth rate and allowing the uptake of one source only. All carbon sources except l-histidine and l-methionine can generate growth independently. From these two results, we concluded that first, more efficient growth can be achieved by the simultaneous assimilation of the carbon sources inif they are the only sources available. This may suggest a possible reason for the switch of the mode of assimilation from a sequential one to a simultaneous one as observed in. Second, f 0 cannot be simply decomposed into flux modes of individual carbon sources. f 0 was then simplified into f 1 by subtracting the three EFMs found. We tried to find the set of EFMs of the subnetwork of f 1 by EFMtool but it was unsuccessful due to insufficient memory. We then decomposed f 1 by Version 2 of our algorithm. In all, 22 EFMs were found, all verified to be true EFMs by EFMtool. The first EFM found, also the one with the largest growth rate in the solution, accounts for 19% of the growth rate. All EFMs of growth consume multiple sources simultaneously, at least 12. The EFMs consist of quite similar sets of reactions. In fact, among the 482 active reactions in f 1 , 376 reactions were found to be shared by all EFMs, called the 'backbone' reactions (). They can be important reactions for optimal growth on the medium. The structures are complicated, as expected from the detailed biomass composition containing 63 metabolites. Various biochemical pathways are involved: glycolysis, pentose phosphate pathway, non-mevalonate pathway, cell envelope biosynthesis, glycerophospholipid metabolism, lipopolysaccharide biosynthesis, biosynthesis of different amino acids, cofactor and prosthetic group, etc. They are connected by branch point metabolites like pyruvate and chorismate. Interestingly, in the backbone, besides the uptake of eight extracellular carbon sources, some cytosolic metabolites are always synthesized in each EFM and then enter into the backbone acting as source nodes, including l-aspartate, l-serine, d-glucosamine 6-phosphate, glyceraldehyde 3-phosphate, d-glucose 6-phosphate, pyruvate, alpha-d-ribose 1-phosphate, uridine, d-xylulose 5-phosphate. Meanwhile, outside the backbone, no single extracellular carbon source is used by all EFMs.This means that these cytosolic sources of the backbone must be first synthesized regardless of the carbon sources. Hence, the ability to synthesize them may reflect the efficiency of the cell's growth. Of the five EFMs with the largest growth rate (accounting for 80% of the growth rate in total), the reactions outside the backbone are shown in, from which different pathways to synthesize those necessary cytosolic metabolites entering the backbone can be seen. All EFMs are in general different arrangements of these pathways to strike delicate balance to produce biomass. We further looked into the contribution of each carbon source. The 'marginal relative contribution' of each carbon source was calculated by summing up the relative contribution by that source in each EFM (Supplementary Material). The carbon source with largest relative contribution to biomass is N-acetyl-glucosamine with over 5.4% and l-histidine has the lowest contribution with only 0.9%. The information cannot be obtained from f 0 or f 1 alone in which nearly all uptake fluxes of carbon sources are equal. The value of the marginal relative contribution, however, seems to change with the non-unique decomposition by EFMs. A further analysis will be needed to formally address this issue.It is remarked that the above analysis focuses on f 0 and f 1. Indepth studies are required to prove the claims from it. For example, alternative optimal flux distributions and different maximum uptake rates chosen may alter the results on the dependence of carbon sources and the necessity of certain metabolites. Still, the resolution brought by the present decomposition has revealed some information not observed from the apparent flux distribution.
Page: 2261 22562262
Elementary flux mode
CONCLUSIONIn this article, we presented an algorithm which solves MILPs iteratively to decompose a flux distribution into EFMs in genomescale metabolic networks. One advantage of the algorithm is the elementarity of solutions independent of the optimality of MILPs. The objective function can then be used for other purposes and we suggested approximating the largest contributing EFMs in flux distributions. We demonstrated the ability of the algorithm to decompose flux distributions into EFMs and approximate EFMs with largest Page: 2262 22562262
S.H.J.Chan and P.Jicontributions to flux distributions in genome-scale metabolic networks. In particular, complementary to existing methods, it can find EFMs of flux distributions with complex structures. The case of growth of E.coli on the LB medium gives an exemplary flux distribution with a complex structure in which a simultaneous mode of assimilation of carbon sources is seen. By our algorithm, essential reactions and metabolites, contribution of carbon sources of the flux distribution were studied under the resolution of the decomposition by EFMs. We conclude that the algorithm can facilitate metabolic pathway analysis in genome-scale metabolic networks. It provides an analytic method that prepares for the future breakthrough in experimental techniques to measure in vivo fluxes in a huge scale.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
