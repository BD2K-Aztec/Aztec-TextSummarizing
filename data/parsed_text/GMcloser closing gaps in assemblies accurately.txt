Motivation: Genome assemblies generated with next-generation sequencing (NGS) reads usually contain a number of gaps. Several tools have recently been developed to close the gaps in these assemblies with NGS reads. Although these gap-closing tools efficiently close the gaps, they entail a high rate of misassembly at gap-closing sites. Results: We have found that the assembly error rates caused by these tools are 20–500-fold higher than the rate of errors introduced into contigs by de novo assemblers. We here describe GMcloser, a tool that accurately closes these gaps with a preassembled contig set or a long read set (i.e. error-corrected PacBio reads). GMcloser uses likelihood-based classifiers calculated from the alignment statistics between scaffolds, contigs and paired-end reads to correctly assign contigs or long reads to gap regions of scaffolds, thereby achieving accurate and efficient gap closure. We demonstrate with sequencing data from various organisms that the gap-closing accuracy of GMcloser is 3–100-fold higher than those of other available tools, with similar efficiency. Availability and implementation: GMcloser and an accompanying tool (GMvalue) for evaluating the assembly and correcting misassemblies except SNPs and short indels in the assembly are available at https://sourceforge.net/projects/gmcloser/.
IntroductionNext-generation sequencing (NGS) technologies allow the low-cost and high-speed construction of unknown genome sequences by de novo assembly. The assembly of reads produces contigs, but the extension of these contigs frequently stops at sites with repetitive regions, heterozygous alleles, sequencing errors or low read coverage, causing assembly fragmentation (). Hence, for large eukaryotic genomes with highly repetitive and/or polymorphic sequences, the lengths of the contigs generated by short read assembly are generally short. Contig fragments are then further linked with paired-end (PE) or mate-pair (MP) reads, which are generated by sequencing both ends of DNA fragments with a range of sizes, to form scaffolds. Scaffolds contain many gaps, with a range of sizes, which are estimated from the fragment sizes of PE or MP reads. Closing the gaps in scaffolds is an important finishing process in assembly construction. Because the gap regions correspond not only to repeat sequences, which are often found in intergenic regions, but also to gene-encoding regions, which could not be assembled because of low read coverage or heterologous sites, the effectiveness and accuracy of gap closing significantly affects downstream analyses, including gene annotations for the constructed assemblies. Connecting the contigs (non-gapped DNA segments split by gaps in scaffolds and hereafter referred to as 'subcontig') encompassing a V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com gap in a scaffold by closing the gaps increases the length of the subcontigs and its capacity to include the encoded genes to be annotated. Gap closing has traditionally been performed by manually or semi-automatically sequencing PCR-products generated with primers that encompass the gaps (). However, recently developed gap-closing tools that use NGS reads, GapCloser (, b), IMAGE (), GapFiller () and FinIS (), have replaced the laborious manual gap-closing process. The former three tools use a similar strategy to close gaps: (i) alignment of PE reads to the contig regions of the scaffolds; (ii) collection of unmapped mates when the other read of a pair is aligned to a region neighboring a gap; (iii) local assembly of collected unmapped reads based on de Bruijn graphs; and (iv) the iteration of processes (iiii). IMAGE is usually only applicable to assemblies of small genomes (). GapCloser is designed for use as a finishing process of a SOAPdenovo assembler, but can be used as an independent tool. GapFiller is unique in that it assembles only reads that are partially aligned to span a gap, and considers the consistency between the gap lengths and the lengths of the sequences used to fill the gaps to increase the accuracy. FinIS closes gaps by constructing local assembly graphs using reads that were not used for the assemblies and pre-built contig-graph information. FinIS can only be applied to assemblies from some specific assemblers (i.e. Velvet and SOAPdenovo). Another tool to close the gaps in assemblies is PBJelly (), which use PacBio long reads instead of short NGS reads. PBJelly closes gaps and corrects errors in the closed sequences that are derived from PacBio reads by adopting consensus sequences of the multiple reads aligned to the gap regions. Additionally, assembly-merging tools, PCAP.REP (), GAM-NGS (), GAA (), GARM (), CISA (), FGAP (), MAIA (), Minimus2 () and Mix () can potentially close the gaps by merging the assemblies, although they are intended for assembly extension rather than gap closure. In this study, we demonstrated that all the existing gapclosing tools cause a high rate of misassembly at gap-closing sites. To develop a gap-closing tool with a lower error rate, we adopted a strategy with which gaps are closed with a set of preassembled contigs or long reads. Our strategy involves the selection of the correct alignments between scaffolds and contigs (or long-reads) by measuring the likelihood ratios of the true alignments. We demonstrate that this likelihood-based method allows the efficient and accurate connection of contigs and is applicable to other technologies that involve the merging or assembly of contigs or long reads.
Methods
Sequence read sets and reference genomes usedSequence reads and reference genome sequences were obtained from several websites, and simulated read sets were generated using a pIRS (), SimSeq (https://github.com/jstjohn/SimSeq), 454sim () and PBSIM () simulators (Supplementary). PacBio reads were error-corrected using the PBcR (pacBioToCA) component of the Celera assembler ver. 8.1 () or proovread (). A detailed explanation for this section is described in detail in Section S2.1 of Supplementary Methods.
Generation of genome assembliesTo generate contigs Illumina paired-end read sets were assembled using iterative de Bruijn graph-based assemblers, SOAPdenovo2 ver. 2.23 (), IDBA-UD ver. 1.1.0 () and ALLPATHS-LG ver. 45879 () or an FMD-index-based assembler, Fermi ver. 1.1 () and 454 reads were assembled using an overlap-layout-consensus-based assembler, Newbler ver. 2.7 (). Scaffolds were generated with Illumina paired-end and mate-pair read sets using SOAPdenovo2, ALLPATHS-LG or SSPACE premium ver. 2.3 (; http://www.baseclear.com/landingpages/ba setools-a-wide-range-of-bioinformatics-solutions/sspace-premium/; Supplementary). The de novo assembly was conducted with options K  4555 m  7090 d  3 D 3 L 200 C  2.5 for SOAPdenovo2 and with the default settings for other assemblers. Scaffolding of Caenorhabditis elegans Newbler contig set and Arabidopsis SOAP contig set was performed with SSPACE premium with options m  50 and z  500. To evaluate the performance of FinIS, Illumina reads were assembled with SOAPdenov ver. 1.0.5 (), and the resulting contigs were scaffolded with paired-end and mate-pair reads using Opera ver. 1.3 (). Mycobacterium abscessus assembly sets generated with Illumina HiSeq reads were obtained from the GAGE-B website (http://ccb.jhu.edu/gage_b). For all the contig sets obtained, contigs with <200 bp were filtered. To create error-free assemblies, we split the scaffolds at misscaffolded sites and corrected or deleted misassembled (sub)contigs using our program, GMvalue (which is included in the GMcloser package). Although GMvalue does not correct SNPs or short indels, it creates an assembly set with no misassembly, which is hereafter referred to as 'error-free' assembly. The statistics for the resulting error-free assembly sets are shown in Supplementary Table S2.
Statistical analysis of the alignments generated between contig sets and between contigs and PE readsThe error-free rice or C.elegans contig sets generated with SOAPdenovo2, FERMI and Newbler were reciprocally aligned with Nucmer, and end-to-end alignments were extracted. The aligned contig pairs were merged and the merged fragments were aligned to the respective reference genome. Based on the reference alignment data, alignments with !95% identity and !95% contig coverage were classified as 'true' alignments and the others as 'false' alignments. Finally, we statistically evaluated the frequencies of the lengths and the identities of the alignment overlap regions of the true and false alignment fractions (Supplementary, B; Supplementary Table S4). We also conducted a statistical analysis of the PE-read alignments with the contigs. A set of experimentally obtained PE reads of rice (24  coverage) was aligned to the assembled error-free contigs. We computed the rates of the aligned read pairs that supported the true or false contigcontig alignments in the total number of reads aligned to the contigcontig segments (Supplementary; Supplementary). The likelihood ratios were calculated according to the following Equation (I).where L(Tja) and Ta represent the likelihood ratio and frequency of the true alignments, respectively, for a range 'a' in an alignment factor (e.g. alignment identity); Fa indicates the frequency of false alignments for a range 'a' in an alignment factor; and TA and FA indicate the total number of true and false alignments, respectively.where O(Tja) and P(Tja) represent the posterior odds and the Bayesian posterior probability of the true alignments for a range 'a' in the alignment factor, respectively. Therefore, the Bayesian posterior probabilities were calculated according to the following Equation (IV). PTja  LTja  Ta=TA  Ta 1  LTja  Ta=TA  TaA detailed explanation for this section is described in detail in Section S2.2 of Supplementary Methods.
Algorithm of GMcloserGMcloser is executed in the following five steps: (i) alignment of a contig (or long read) set to the subcontigs in the scaffold; (ii) alignment of PE reads to both sets of contigs (or long reads) and subcontig; (iii) likelihood-based selection of the correct contigsubcontig alignment pairs using contig-and read-alignment statistics; (iv) filling and closure of the gaps with the selected and assigned contigs (or long reads); and (v) connection of subcontig pairs that encompass a gap.
Alignment of contigs (or long reads) to scaffoldsThe scaffolds are split into subcontigs and the subcontigs are aligned with another preassembled contig (or long read) set using MUMer/ Nucmer ver. 3.23 (). This alignment can be performed with another aligner, BLASTn, which is suitable for the alignment of assemblies of large genomes, by optional selection. After alignments separated by short indels are connected, the alignments covering the entire region or either terminus of the subcontigs (end-to-end) are stored.
Alignment of PE short readsThe first and second read sets of PE short reads with 300800 bp fragment size and with 20100 coverage are aligned separately to both the contig (or long read) and subcontig sets with Bowtie2 in the single-end mode. Short reads with more than one mismatch with a haploid genome or two mismatches with a heterozygous diploid genome are filtered using the filtering function of Coval (), and then the positions, directions and names of the aligned short reads are recorded for the two short read sets and for the two assembly sets.
Selection of the correct contigsubcontig alignmentsTo ascertain whether the contigsubcontig (or long read-subcontig) alignments are correct, a likelihood-based estimate is made using predetermined likelihood ratios for true test alignments. The likelihood ratios for the alignment overlap length, overlap identity and PE-read mapping rate were determined with true and false contig contig alignment data for rice (Supplementary). The three likelihood ratios for each contigsubcontig alignment are multiplied together to compute an alignment score. When the calculated score for an alignment is equal to or larger than the threshold score, the alignment is deemed to be true. The threshold score will deviate from the standard score, depending especially on the quality and/or sequence length of the assembly sets and PE reads to be used. To set a threshold score to be optimized for the input data, we added a data-specific constant (C) to a standard threshold score. The dataspecific constant is calculated by subtracting the mean score for the rice standard alignment data from the mean alignment score for the sample alignment data. The formulae used to calculate the alignment score (Sa) and threshold score (THa) are:where L(Tji), L(Tjl) and L(Tjm) are the likelihood ratios of true alignments corresponding to the predetermined ranges for alignment overlap identity, alignment overlap length and PE-read mapping rate, respectively; THs is the standard threshold score (i.e. 2.5); Sm is the mean alignment score for the rice alignment data; and n is the total number of alignments in the sample data. When a contig set is used as a query and multiple contigs are aligned around a single gap, GMcloser selects the single contig whose alignment overlap length is the longest. When a single contig is aligned around multiple gaps in different assemblies, GMcloser selects the single alignment with the longest alignment overlap length. in the long-read mode. GMcloser assumes that the coverage of a long read set is ! 2 and that of a contig query set is < 2. When using a contig set with ! 2 coverage, the job can be run in the long-read mode. Three iteration processes can often achieve almost maximal gap-closing efficiency when using a query set with $15 coverage.
Gap closing with gap-closing toolsFor GMcloser, PCAP.REP (), GAM-NGS () and GAA (), gaps in errorfree scaffolds were closed with an error-free contig set or an intact contig set. GMcloser was executed using an option that connects neighboring subcontigs (c), unless otherwise stated, and PCAP.REP used an option (m) specifying the minim identity of overlap option, which was set to 97. For GapCloser ver. 1.12 () and GapFiller ver. 1.9 (), gap closure was performed with PE read sets and the default options, except that the option specifying the minimum overlap length (p for GapCloser and m for GapFiller) was set to 31 unless otherwise stated. Gap closure with IMAGE ver. 2.33 () was performed with options iteration  1, all_iteration  10 and kmer  61 (or  kmer  51 for the Arabidopsis data). Gap closure with FinIS ver. 0.3 () was performed using a real scaffold set generated with Opera ver. 1.3 () and the assembly data generated with SOAPdenovo ver. 1.0.5 (). For PBJelly ver. 14.9.9 (), gap closing was conducted with errorcorrected or intact PacBio read set and the default options. The specified options for each tool achieved the most accurate gap closure while retaining !90% of the maximal gap-closing effectiveness for most assembly sets.
Evaluation of gap-closing resultsThe accuracy of gap-closed assemblies were evaluated using GMvalue and Quast (). In evaluating the accuracy of assemblies with GMvalue, we regarded as true only those exhibiting !99% contig coverage, !97% identity and !200 bp alignment length in the overlaps with the references, and permitted SNPs and short indels with 100 bp in the assemblies. The detailed explanation for assembly evaluation is described in Section S2.3 of Supplemental Methods.
Results3.1 Current gap-closing tools display a high rate of misassembly in the gap
closing processThe currently available gap-closing tools, including IMAGE, GapCloser and GapFiller, close gaps in scaffolds using k-mer-based local assembly of PE reads that are aligned around the gap regions. De novo assemblers also use a similar k-mer-based (de Bruijn graph) strategy to assemble NGS reads. We compared the error (misassembly) rates of these gap-closing tools with those of de novo assemblers (). The same sets of PE reads from C.elegans, Arabidopsis, and rice were used to execute gap closers (IMAGE, GapCloser and GapFiller) and assemblers (SOAPdenovo2and FERMI). To accurately assess the misassembly rates of the gap closers, we generated error-free preassembled scaffold sets (see Supplementary Methods and Supplementary), and used for gap closing. To measure the misassembly rate for each tool, the assembled contigs or subcontigs that were split from the gap-closed assemblies were aligned to the corresponding reference genomes using MUMmer/Nucmer aligner (). Misassembly events were counted (allowing single-nucleotide polymorphismsand short insertions/deletions) with a method (GMvalue) related to that used for the GAGE assembly evaluation () and the Quast tool (), because the available assembly evaluation tools cannot be applied to assemblies of large genomes and lack the options to specify misassembly definitions. The number of misassemblies per closed or assembled sequence length (Mb) for each tool and each species indicated that the gap-closing tools caused 25500-fold higher rate of misassembly than the de novo assemblers (). This result demonstrates that the current k-mer-based gap-closing tools incorporate misassembled fragments into the assembly gap regions at a considerably high rate.
Selection of correct contigcontig alignments with the likelihood ratios for the three alignment factorsTo obtain alignment data for contigs, we prepared three rice contig sets generated with SOAPdenovo2, FERMI and Newbler assemblers. These three contig sets were reciprocally aligned between each other with Nucmer, and the resulting alignment data were categorized into 122,133 true and 2584 false alignments using GMvalue (see Supplementary Methods for detail). A statistical analysis of the contig alignment data showed that the likelihood ratios calculated for the alignment overlap length, alignment identity and mapping rate of the PE reads provide good classifiers for selecting the correct contig alignments (Supplementary; Supplementary). The likelihood ratios for the three factors in the rice data were similar to those for the C.elegans alignment data (Supplementary), and similar to the posterior probability based on Bayes' theorem (Supplementary). To make a combined alignment score from the three alignment factors, we multiplied likelihood ratios for the three alignment factors for each alignment. From the multiplied scores for each true and false alignment datasets, we calculated the mean log score for each true and false alignment dataset (true data,4.5; false data, 5.2). A receiver operating characteristics (ROC) curve analysis of the likelihood-based selection using the rice contig alignment data showed that selection with several threshold scores accurately discriminated between true and false alignments (Supplementary; Supplementary). We specified a threshold score of 2.5, which accepted 87% of the true alignments and rejected 97% of the false alignments.
Development of the gap-closing tool, GMcloserWe developed the gap-closing tool, GMcloser, by introducing a strategy to select correct contig alignments, as described above. An outline of the gap-closing processes of GMcloser is shown schematically inand Supplementary, and the detailed algorithm is described in Methods. First, the target scaffold sequences are split into subcontigs and the subcontig set is aligned with another set of query contigs or long reads using MUMmer/ Nucmer or BLASTn, and both the end-to-end alignments and alignments that are completely covered by a query sequence are extracted. The target subcontig set and the query sequence set are aligned separately with PE short reads. The PE read sequences themselves are not used to fill the gaps, but are used only as evidence when selecting the contigs/long-reads to fill the gaps. From the extracted end-to-end sequence alignments, the potentially correct alignments are selected with a threshold score that is set based on the alignment likelihood ratios, as described in the previous sections. Using the selected alignment data and query sequence information assigned to the gap regions of the scaffolds, the scaffolds are reconstituted and the gaps are filled. We compared the gap-closing performances of GMcloser and a simple merging method using a modified version of GMcloser omitting both the PE read alignment and the likelihood-based alignment selection steps. To define only errors occurring at the gap-closing step, we used error-free scaffold and contig sets of C.elegans, Arabidopsis, and rice, which are shown in Supplementary. GMcloser closed the gaps in assemblies with 312-fold less misassemblies than the simple merging method, while their gap-closing effectiveness was similar.
Comparison of the performances of GMcloser andother tools using rice, Rhodobacter sphaeroides, Saccharomyces cerevisiae, C.elegans, Arabidopsis, sorghum and foxtail millet assemblies We tested the performance of GMcloser using assemblies from rice, Rhodobacter sphaeroides, Saccharomyces cerevisiae, C.elegans, Arabidopsis, foxtail millet and sorghum. For each organism, we prepared error-free scaffolds and closed the gaps in the error-free scaffolds with GapCloser, GapFiller, IMAGE and GMcloser. We designated error-free assemblies as assemblies that are not different from the sequences of the corresponding reference genome. To evaluate the performance of GMcloser, we used two types of contig sets: an error-free contig set and a real contig set containing misassemblies. By using error-free contig sets, we can determine the number of misassemblies that are introduced by GMcloser itself. We computed the total lengths of the sequences that were newly added to the gap regions of the input scaffolds and the total numbers of gap-closing/assembly errors observed in the output gap-closed scaffolds. Because the input scaffolds lacked assembly errors, all the observed errors correspond to the errors generated by the individual gap-closing tools. Evaluation of the output assemblies showed that the gap-closing accuracy of GMcloser was considerably higher than that of the other tools, whereas its gap-closing effectiveness varied from 61 to 440% of the effectiveness of GapCloser or GapFiller (; Supplementary, also see Supplementaryfor their ROC-like plots). In most cases, over 80% of misassembly events were observed in independent subcontigs. The increased errors (73% increase on average) in GMcloser assemblies generated with real contig sets were probably derived from assembly errors contained in the input contigs. Relatively high numbers of assembly errors observed for sorghum and foxtail millet are probably because the reference genomes were constructed using de novo assembly with short reads. The gaps were efficiently closed even when the same assembler was used for the constructions of the contig set and scaffold set (i.e. ALLPTHS-scaf/ALLPATHS-contig in), indicating that the sequences that cover the gaps in a scaffold set are not. Outline of the gap-closing process of GMcloser. Scaffold sequences in which gaps are to be closed are split into subcontigs, and the subcontigs are aligned with another set of preassembled contigs or long reads using Nucmer or BLAST to find their end-to-end alignments. Each set of subcontigs and contigs is aligned with PE short reads using Bowtie2. To select the correct subcontigcontig alignments, the predetermined likelihood ratios for the alignment overlap length, overlap identity and PE-read mapping rate are multiplied together, and the log values are assigned as the alignment scores for the individual alignments. Alignments with scores lower than the threshold score, which is calculated with a predetermined standard score and a dataspecific constant, are discarded as incorrect alignments. The scaffolds are reconstituted and the gap regions in the scaffolds are filled with the assigned contigs (or long reads). Finally, the closure of any gaps that remain unclosed is attempted using a local pairwise alignment of a subcontig pair that encompass the gap. For a contig or long-read set with ! 2 coverage, the entire process can be iteratively implemented in the long-read modeGap closing with GMclosernecessarily underrepresented in a contig set that is generated with the same assembler. Evaluation of the misassemblies in the gapclosed sequences with the Quast tool () showed that the results of Quast correlated roughly with those of our evaluation method (GMvalue), although it is difficult to quantitatively compare between these results because the definition of 'local misassembly' differs between the two methods. The Quast program could not be applied to assemblies from relatively large genomes, including those of rice, foxtail millet and sorghum (Supplementary). We tested the performance of another gap-closing tool, FinIS (). This tools is limited to assemblies generated with the Opera scaffolder () and the Velvet or SOAPdenovo ver. 1 contig assembler. Because this tool is incompatible with user-generated scaffold sets including error-free scaffold sets, we generated another scaffold sets using Opera and SOAPdenovo ver. 1 to compare the performances of FinIS with those of the other tools. Our evaluation indicated that FinIS caused the highest number of misassemblies of all the gap-closing tools tested, despite its similar effectiveness (Supplementary). We also tested the gap-closure performances of scaffoldcompatible assembly-merging tools, PCAP.REP, GAM-NGS, GAA, GARM and Mix using preassembled error-free scaffold/contig sets. Although PCAP.REP and Mix exhibited a moderate level of the gap-closing effectiveness, they introduced a considerably higher number of misassemblies than the other tools (Supplementary). GAM-NGS and GAA closed the gaps in the tested scaffold sets negligibly (the results of GARM could not be obtained because of an error in the program; Supplementary). We measured the running time and memory consumption of each gap-closing tool (). The runtime of GMcloser was longer than that of GapCloser but shorter than those of GapFiller and IMAGE. The maximal memory of GMcloser was comparable to those of GapCloser, but larger than the other tools.
Sequential treatment of scaffolds with GMcloser closes more gapsA scaffold set in which the gap had been closed with GMcloser was treated again with GMcloser with another preassembled contig set. The gap regions of the resulting scaffolds for the datasets from rice, C.elegans and Arabidopsis were further reduced relative to those in the input scaffold sets, although the assembly errors were slightly increased in proportion to the closed gap lengths (Supplementary Figs S10 and S11; Supplementary). An additional treatment with another contig set (i.e. AP contig sets) further reduced the gap regions of the assemblies (see SP:FM:APe and SP:FM:APe; Supplementary). These results indicate that different assemblers generate contigs that cover different gaps in a scaffold set, in addition to contigs that cover the same gaps. Successive treatments of GMcloser-treated scaffolds with GapCloser increased the number of misassemblies, and the number of misassemblies and the lengths of closed gaps were close to those found when treated with GapCloser alone (Supplementary), indicating that GapCloser has a relatively constant error rate for similar datasets., respectively) were used for gap closing. The total length (Kb for R.sphaeroides and S.cerevisia and Mb for the others) of the gaps filled with sequences and the total number of misassembled/mismerged events for each tool are shown with blue (left scale on the y-axis) and red bars (right scale), respectively
Gap closure with Pacific Biosciences RS readsWe attempted gap closure with Pacific Biosciences (PacBio) RS CLR reads from R.sphaeroides, S.cerevisiae and C.elegans using GMcloser. The real PacBio RS reads for R.sphaeroides and the W303 strain of S.cerevisiae were obtained from the public websites (Supplementary), and the simulated PacBio reads for C.elegans and the S288c strain of S.cerevisiae were generated with PBSIM (). The potential sequencing errors in these read sets were corrected with Illumina short reads using PBcR (pacBioToCA;) or proovread (only for C.elegans reads;; Supplementary), and the resulting read sets had 3.5, 7 and 14 coverage for each organism, respectively. Error-corrected PacBio reads of the yeast W303 strain were obtained from the corresponding website. For R.sphaeroides and S.cerevisiae W303, GMcloser and PacBio reads with 7 coverage closed 7.8-fold and 1.7-fold longer length of gaps in the assemblies than GapCloser, respectively, while the number of misassemblies was similar to that generated with GapCloser for R.sphaeroides and was only 7% of that of GapCloser for S.cerevisiae W303 (, Supplementary, Supplementary). For S.cerevisiae S288c and C.elegans, although the lengths of the gaps closed with GMcloser were similar to those closed with GapCloser, the observed misassembly events were 18$25% of those in observed for GapCloser (and D, Supplementary, Supplementary). In all the assemblies tested, GMcloser with error-corrected PacBio reads closed the gaps more effectively than that with preassembled contig sets. Notably, sequential treatments of the assemblies with contig and error-corrected PacBio read sets allowed more efficient and accurate gap closing than the treatments with PacBio reads alone. We then compared the performances of GMcloser and PBJelly. Gap-closing tests using PBJelly with intact or error-corrected PacBio reads with 14-to 50-fold coverage showed that PBJelly introduced a 9-to 260-fold higher number of errors into the gap-closed assemblies than GMcloser, while the effectiveness of gap-closure was similar to GMcloser or GapCloser (, Supplementary, Supplementary). The gap-closed assemblies generated with PBJelly contained a number of assemblies containing incompletely error-corrected PacBio reads, many of which were measured as local-misassembly events, as represented in Supplementary. Overall, these results indicate that GMcloser can close the gaps more accurately than other gap-closing tools. The efficient and accurate gap-closing ability of GMcloser with a low coverage of PacBio reads should improve the closing of gaps in assemblies.
Statistical evaluation of the gap-closing resultsFor the gap-closed assemblies shown in the gap-closing results above, we measured how many numbers of subcontig termini or gaps in the scaffolds were extended or closed (Supplementary). The percentage of extended subcontig termini or closed gaps correlated with the total length of the closed gaps in many cases. In six out of the eight experiments for different organisms, the ability of GMcloser to extend the subcontigs was higher than or similar to those of the other tools (Supplementary). We classified the misassemblies observed in the gap-closed assemblies into four classes, local misassembly, relocation (local misassembly with the break-point distance of !1 Kb), translocation and inversion. Local msassembly was the major class for all the tools, and GMcloser tended to produce fewer errors of translocation and inversion (Supplementary). This observation is supported by the Quast evaluation results (Supplementary), although the definition of 'local misassembly' differs between Quast and GMvalue. In GMvalue, local misassemblies are considered to occur when separate segments from a contig are aligned to an identical chromosome of the reference and their break points occur at a distance of >100 bp (corresponding to the maximum allowable size [i.e. 100 bp] of indels), whereas local misassemblies in Quast contain only the relocated contig segments with break points at a distance of <1000 bp. Because the minimum threshold value for the break-point distance and the alignment coverage/identity of the contigs are not stipulated in Quast, it is difficult to quantitatively compare the results for local misassembly in GMvalue and Quast. This local-misassembly event was observed more frequently when the maximum allowable size of indels (or the distance between the break points of a local misassembly) was lowered (Supplementary). However, the specified values for the maximum allowable size of indels/local misassemblies usually generated similar ratios for the number of misassemblies between the gap-closing tools, as shown in Supplementary. We also measured the N50 values and the corrected N50 values (i.e. N50 values for assemblies split at misassembly sites) for the gap-closed assemblies (). The results indicate that GMcloser produced higher values for the corrected scaffold N50s than the other tools. GMcloser also gave similar or higher values for the corrected subcontig N50s in many cases, but the corrected N50 metrics, especially for subcontigs, may not be useful for evaluating gapclosing performances because they do not effectively reflect the assembly error rates in an assembly set. Instead, they were almost constant, even when $50% of the sequences in an assembly set were split at randomly selected sites, as shown in Supplementary Table S12.
DiscussionCurrent gap-closing tools use a strategy that aligns PE-reads, followed by the k-mer-based local assembly of the reads aligned around the gap regions. Although this strategy efficiently closes gaps, itGap closing in C.elegans SSPACE scaffolds. For S.cerevisiae S288c and C.elegans, simulated PacBio reads were generated with PBSIM, and errorcorrection was conducted using pacBioToCA and Proovread, respectively. Gap-closing results for GapCloser and GMcloser with a real contig set (FM  e or SP e) are shown for comparison. Results of successive treatments using GMcloser with a real contig set and PacBio reads are also shown (FM  e:14). The bars are as in. The data are from the assembly results of GMcloser at iteration 3. The minimum alignment overlap identity to measure misassembly events with GMvalue was set to 92%, because the PacBio reads could be incompletely error-correctedGap closing with GMcloserintroduces a large number of errors (). The high misassembly rates of the k-mer-based gap-closing tools probably arise because the gap-closing process involves assembly at genomic sites that are difficult to assemble with de novo assemblers. Because the current gap-closing tools use only PE reads that are mapped to gap-flanking regions for local assembly, misassembly could occur frequently at repeated regions in which reads can be incorrectly aligned. These hardto-assemble sites include repetitive regions and regions of highly polymorphic sequences that are attributable to sequencing errors or heterozygosity. Nevertheless, assembly tools are likely to generate many contigs that cover gaps in the scaffolds, because the gaps present in scaffolds generated with an assembler can be efficiently closed with a contig set generated with the same assembler. Therefore, our gap-closing strategy, based on the alignment of a preassembled contig set, allows accurate and efficient gap closing. The assemblies in which the gaps were closed with GMcloser and with an intact contig set still contained a number of errors. However, most of these errors were derived from misassembly errors contained in the preassembled input contigs. Thus, the use of preassembled contig sets generated with accurate assemblers, such as SOAPdenovo2, should ensure accurate gap closing with GMcloser. The high accuracy and high effectiveness of GMcloser for gap closing are also due to the likelihood-based selection of the correct alignment between a contig and a subcontig of a scaffold. This selection method uses likelihood ratios for three alignment factors: the alignment overlap length, the alignment overlap identity and the mapping rate of PE reads, which are determined statistically from true and false alignment datasets. Although likelihood-based algorithms or Bayesian probabilistic approaches have been adapted to estimate genotypes, short read alignments and assembly errors (), no likelihood-based method has been developed to select the correct alignment of DNA fragments such as contigs. Our selection method of contig alignment should be applicable to the development of tools involving the alignment of DNA sequence sets, such as assemblers of long reads or contigs. After a successive treatment of different contig sets with GMcloser, a number of gap regions are still barely filled, and these gap regions seem to correspond to genomic regions with low read coverage. Sequencing reads generated with the PacBio RS platform have long read lengths (mean: 10 kb, max: 50 kb) and relatively constant coverage across the sequenced genome, although the sequencing error rate is high ($15%;). The errors in PacBio RS reads can be effectively corrected with short reads () or with a multiple-alignment strategy between the PacBio reads (). In this study, we have demonstrated that the gaps in assemblies can be efficiently and accurately closed with a low coverage of error-corrected PacBio reads using GMcloser, and that the gap-closing accuracy of GMcloser is better than that of another gap-closing tool with PacBio reads, PBJelly (). This feature of GMcloser should also offer economical benefits, especially for assemblies of large genomes. However, the accuracy of the gap closing with PacBio reads is lower than that with preassembled contig sets, and many of the misassemblies are attributable to incomplete error-correction of PacBio reads (Supplementary Tables S8 and S12). Thus, the future development of more complete methods for error-correction of PacBio reads would allow a more accurate gap closure with GMcloser.
FundingThis work was supported by KAKENHI from the Ministry of Education, Culture, Sports, Science and Technology of Japan
S.Kosugi et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.4.4 Filling gaps in scaffolds Using the selected contigsubcontig alignment data, the gaps present in the scaffold dataset are filled and the scaffold termini are optionally extendable. For filled but not completely closed gaps, a pairwise alignment between the subcontigs that encompass the gap is performed using the YASS aligner (Noe and Kucherov, 2005), and the gap is closed only when the 3 0-terminal segment of the upstream subcontig is aligned to the 5 0-terminal segment of the downstream subcontig. If the pairwise alignment gives no significant result and the contig segment extended to fill the gap is longer than 1.5 times the gap length, the contig assigned to the gap is not used to fill the gap. We chose 1.5 times the gap length as the threshold is because the standard deviations of the fragment sizes of the PE reads and MP reads are generally $20% of their fragment sizes. 2.4.5 Connection of neighboring subcontigs We observed that a significant number of connectable, neighboring subcontig pairs that encompass a gap were originally present in input scaffolds before the gap-closing treatment (Supplementary Table S3). The rate of connectable subcontig pairs in the total subcontig pairs varied from 0.2 to 46%, depending on the assemblers and read datasets used. Because the overlapping lengths between the subcontig pair are relatively short, the connection of the subcontig pair with simple filtering (e.g. !95% identity and an overlapping length of !20 bp) could lead to a high rate of gap-closing errors (i.e. false positive rate of 344%; Supplementary Table S3). To accurately connect the connectable subcontigs preexisting in scaffolds, GMcloser uses the three alignment factors (i.e. the alignment overlap length, alignment identity and mapping rate of the PE reads) to select the correct subcontig pairs. This function is optionally selectable. When using long reads (e.g. error-corrected PacBio reads) as the query, the entire gap-closing process can be iteratively implemented Gap closing with GMcloser
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
