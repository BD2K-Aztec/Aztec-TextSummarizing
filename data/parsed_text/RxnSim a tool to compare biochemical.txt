Quantitative assessment of chemical reaction similarity aids database searches, classification of reactions and identification of candidate enzymes. Most methods evaluate reaction similarity based on chemical transformation patterns. We describe a tool, RxnSim, which computes reaction similarity based on the molecular signatures of participating molecules. The tool is able to compare reactions based on similarities of substrates and products in addition to their transformation. It allows masking of user-defined chemical moieties for weighted similarity computations. Availability and implementation: RxnSim is implemented in R and is freely available from the Comprehensive R Archive Network, CRAN (http://cran.r-project.org/web/packages/RxnSim/).
IntroductionReaction similarity is used to classify biochemical reactions (), assess enzyme similarity (O'), plan molecular syntheses (), search reaction databases () and annotate new function to enzymes (). These methods were developed analogous to molecular similarity () wherein presence of key molecular signatures is encoded as bits in a feature vector and compared to compute similarity. For reaction similarity, signatures of transformation pattern are encoded into a reaction fingerprint (or feature vector) and used to compute similarity (; ChemAxon Docs; Daylight Theory Manual). Present approaches evaluate reaction similarity by comparing transformation patterns. Comparison with respect to substrates requires additional assessment. RxnSim evaluates reaction similarity by comparing molecular signatures of individual molecules involved in the reactions. Molecular signatures implicitly encode transformation patterns. Accuracy of such approaches is limited by presence of large chemical moieties, such as ATP (). To overcome this, RxnSim provides methods to mask user-defined moieties for weighted similarity computations.
MethodsRxnSim is designed to compute biochemical reaction similarity by comparing molecular signatures of input reactions. Each reaction is associated with a set of binary fingerprint vectors, denoted by F, derived from signatures of constituent molecules. This set is constructed using three methods capturing molecular signatures at different levels of granularity. The first method extracts molecular signatures at a level of individual molecules. The set of fingerprints, F M , contains a fingerprint vector corresponding to each molecule in the reaction. F M  ff a ; 8a 2 S; f b ; 8b 2 Pg, f a represents fingerprint of molecule a, S and P represent the substrate set and product set of reaction, respectively. The second method constructs a set, F S;P , containing two fingerprint vectors, one each for the substrate and product side. Each fingerprint records molecular signatures obtained from all molecules that are part of the substrate and product set,these sets of fingerprint vectors to compute reaction similarity based on four algorithms, namely, msim, msim_max, rsim and rsim2. msim and msim_max infer reaction similarity with respect to individual molecules and use F M for similarity computations. rsim is based upon similarities of the substrate and product sides while rsim2 considers the reaction as a whole for similarity assessment. They use F S;P and F R for similarity computations, respectively. msim pairs each substrate (product) in one reaction with a substrate (products) in the other based on pair-wise molecular similarity values (computed using similarity metric such as Jaccard coefficient) using a greedy algorithm. Reaction similarity is computed by averaging molecular similarity values of identified pairs while considering a '0' value for each unpaired molecule. A modified version of this algorithm, msim_max, ignores unpaired molecules while computing the reaction similarity. rsim computes reaction similarity as the average of the substrate and product side similarities. rsim2 directly uses reaction fingerprints to compute the reaction similarity. For reversible reactions, the substrate and product sides are also cross compared and the maximum of the two similarity values is reported. For brevity discussion in the text is limited to use of fingerprints. The method may be extended to user defined feature-vectors.
Features and descriptionRxnSim is implemented as an R package (R Core Team, 2015, http://www.R-project.org/). It imports chemoinformatic functionality from the rcdk and fingerprints packages (). Input reactions are accepted in the form of reaction SMILES (RSMI) or MDL RXN files. The tool can compute similarity between a pair of reactions or list(s) of reactions that are provided as input. It implements fingerprint caching to reduce computation time on large datasets. The tool provides four algorithms to compute reaction similarity, viz., msim, msim_max, rsim and rsim2. Performance of these algorithms was measured based on their ability to identify similar reactions (following method of). Reactions sharing similar EC number at level 3 were considered similar. Allby-all comparison of 4828 reactions (with EC number assigned) drawn from the Rhea database (v.59,) was performed. Distributions of reaction similarities () show a median score of 0.2 for msim and rsim algorithms. msim shows a prediction accuracy of more than 95% for a cut-off of 0.55 and the area under ROC curve (AUC) was found to be 0.90 (). The shape of the distribution and the accuracy for msim is comparable to that of the 'reaction center metric' of EC-BLAST (). AUCs for rsim and rsim2 were found to be 0.84 and 0.74, respectively. rsim and rsim2 are more useful for analysis of datasets that are known to have common features, such as, catalysis by same enzyme or having same transformation. The nature of assessment and data govern the choice of fingerprints and similarity metrics (). RxnSim allows various customizations for similarity computations as described below. It also allows choice of fingerprints and similarity metric. Within the tool, 12 fingerprints (10 bit and 2 count feature vectors) and 20 similarity metrics are provided (see Section S1 of supplementary materials).A detailed demonstration of the features is available through R's demo utility (section S2)
Substructure masking and reaction similarityMolecules involving large moieties that are inert to reaction process (not participating in the reaction), may adversely influence the similarity values (). An approach to overcome this is to reduce their weightage towards similarity computation. RxnSim implements a method that masks user-defined chemical substructures, provided as SMARTS or SMILES, present in a molecule. Section S3 discusses the impact of masking on similarity values, considering 50 molecules with Coenzyme A (CoA) moiety. As reaction similarity is based on molecular signatures of individual molecules, this effect also percolates to reaction similarity (see Section S4). The presence of large cofactor molecules such as ATP, have similar effect on reaction similarity computations using the rsim and rsim2 algorithms. Masking such molecules would have a similar effect on reaction similarity computations as seen for the molecular similarity (see Section S4).
Querying partial or unbalanced reactionsEnzyme identification for biochemical pathways often requires comparing partial or mass unbalanced reactions. Similarity computations based on the reaction transformation patterns usually require mass balanced reaction and are of limited use. msim_max computes reaction similarity based on the similarity of molecules in the input and is particularly designed to address such scenarios (see Section S5). rsim and rsim2 may also be used along with cofactor masking.
User-defined reaction databaseRxnSim can compare input reactions against a customized database of biochemical reactions provided as a flat-file. The search on this database can also be restricted based on the EC number range. This feature is helpful in assessing alternate enzymatic pathways. The proposed tool provides a flat-file containing biochemical reactions extracted from the Rhea database (). Conflict of Interest: none declared.
Bioinformatics, 31(22), 2015, 37123714 doi: 10.1093/bioinformatics/btv416 Advance Access Publication Date: 17 July 2015 Applications Note at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
