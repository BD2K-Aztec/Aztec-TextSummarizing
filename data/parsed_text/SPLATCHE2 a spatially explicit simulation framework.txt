SPLATCHE2 is a program to simulate the demography of populations and the resulting molecular diversity for a wide range of evolutionary scenarios. The spatially explicit simulation framework can account for environmental heterogeneity and fluctuations, and it can manage multiple population sources. A coalescent-based approach is used to generate genetic markers mostly used in population genetics studies (DNA sequences, SNPs, STRs or RFLPs). Various combinations of independent, fully or partially linked genetic markers can be produced under a recombination model based on the ancestral recombination graph. Competition between two populations (or species) can also be simulated with user-defined levels of admixture between the two populations. SPLATCHE2 may be used to generate the expected genetic diversity under complex demographic scenarios and can thus serve to test null hypotheses. For model parameter estimation, SPLATCHE2 can easily be integrated into an Approximate Bayesian Computation (ABC) framework. Availability and implementation: SPLATCHE2 is a C++ program compiled for Windows and Linux platforms. It is freely available at www.splatche.com, together with its related documentation and example data.
INTRODUCTIONSPLATCHE2 (for SPatiaL And Temporal Coalescences in Heterogeneous Environments, version 2.0) is derived from the program SPLATCHE released in 2004 (). This coalescent-based program has been developed to model complex and spatially explicit demographic scenarios, such as range expansions, in a heterogeneous and dynamic environment, and to simulate the resulting molecular diversity of sampled individuals at arbitrary locations. It thus makes it possible to realistically model the environment in order to study the impact of ecological factors on the genetic structure of populations. This approach has already proved * To whom correspondence should be addressed.  The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors. invaluable to study the patterns of genetic variation in spatially explicit contexts () or the genetic consequences of range expansion (). Many improvements and new functionalities have been added here as compared to the original version of SPLATCHE, allowing the simulation of a much wider range of evolutionary scenarios. Some of these new features have already been used in published studies, such as the simulation of admixture and competition between populations () or the possibility of defining multiple source populations (). Those extensions have now been incorporated into SPLATCHE2, together with the ability (i) to simulate linked or partially linked loci, (ii) to have multiple coalescent events per generation and (iii) to generate single-nucleotide polymorphism (SNPs). Moreover, SPLATCHE2 is also available as a non-graphical console program that can be used on computer clusters. Here, we briefly describe the main features of SPLATCHE2, noting that a more detailed description can be found in a user manual.
METHODS AND IMPLEMENTATION
Demographic simulationSPLATCHE2 begins by simulating the demography of one (or two overlapping and interacting) subdivided population(s) made up of haploid individuals. The population demes are arranged on a 2D lattice and each population can expand from one or several sources. Local deme density is logistically regulated, and migration can occur between a deme and its four nearest neighbors. Directional constraints for migration can be defined through a friction parameter. Deme carrying capacity and friction can be set to arbitrary values in every deme and changed at any generation to simulate environmental heterogeneity and its fluctuation over time. Competition between two populations (or species) can also be simulated, potentially leading to the extinction of one of them. An admixture parameter  may be used to simulate gene flow between the two populations (or species). The intensity of inter-population gene flow can vary between 0 (no admixture) and 1 (full interbreeding).
Coalescent simulationThe second phase of the simulations uses the demographic history simulated in the previous forward step (population sizes, admixture and migration events) to generate the genetic diversity for a set of samples drawn from thePage: 2994 29932994
N.Ray et al.population. A backward, discrete coalescent model () including recombination based on the ancestral recombination graph (as in the program SIMCOAL2,) is implemented. Under the coalescent approach, only the genealogy of sampled lineages needs to be reconstructed, which results in an enormous gain in term of computation time. The coalescent tree obtained after such a simulation is then used to generate molecular diversity for the set of samples. Various commonly used genetic markers can be simulated, such as full DNA sequences, SNPs, short tandem repeats (STRs) and restriction fragment length polymorphism (RFLP). Various combinations of independent, fully or partially linked loci may be simulated. Note that despite simulating haploid genes, diploid individuals can be simulated by combining pairs of alleles or chromosomes under the assumption of HardyWeinberg equilibrium. Other coalescent simulation programs can generate genetic data under an island model (). Moreover, other forward simulation programs can also generate data under complex demographic models (). To our knowledge, SPLATCHE2 is currently the only coalescent simulation program that can integrate a dynamic and spatially explicit environment.
Outputs and integration into an approximate Bayesian computation frameworkThe main outputs of SPLATCHE2 are a set of ARLEQUIN files () including the resulting genetic diversity of the simulated samples. These files can thus be analyzed by ARLEQUIN to compute a wide array of summary statistics on the data. Moreover, many aspects of the coalescent process may be directly visualized, either as a tree (NEXUS format) or as the geographic locations of coalescent events. When simulating two interbreeding populations, one can output the resulting final levels of genetic introgression between populations (). In the Windows graphical interface, various aspects of the demography and genetics can also be visualized (e.g. bitmaps of deme densities, migration intensities, movement of genes during the backward simulation). The command-line version of SPLATCHE2 has been developed to facilitate the parallelization of the simulations, such as to allow one to estimate population parameters [e.g. Approximate Bayesian Computation (ABC);. Indeed, SPLATCHE2 can be easily integrated into the ABCtoolbox framework () allowing one to get posterior distributions of various demographic and genetic parameters.
CONCLUSIONSPLATCHE2 can be used to simulate complex and realistic demographic models and to generate the associated molecular diversity of sampled individuals. Alternative population or environmental histories can be modelled and compared through their impacts on resulting genetic diversity. Due to its explicit handling of spatial information and of environmental and temporal heterogeneities, SPLATCHE2 is particularly well suited for studying spatially distributed population samples over relatively short evolutionary time scales (i.e. a few thousand generations).
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
