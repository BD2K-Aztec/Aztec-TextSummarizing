Motivation: Methylation of cytosines in DNA is an important epigen-etic mechanism involved in transcriptional regulation and preservation of genome integrity in a wide range of eukaryotes. Immunoprecipita-tion of methylated DNA followed by hybridization to genomic tiling arrays (MeDIP-chip) is a cost-effective and sensitive method for methylome analyses. However, existing bioinformatics methods only enable a binary classification into unmethylated and methylated gen-omic regions, which limit biological interpretations. Indeed, DNA methylation levels can vary substantially within a given DNA fragment depending on the number and degree of methylated cytosines. Therefore , a method for the identification of more than two methylation states is highly desirable. Results: Here, we present a three-state hidden Markov model (MeDIP-HMM) for analyzing MeDIP-chip data. MeDIP-HMM uses a higher-order state-transition process improving modeling of spatial dependencies between chromosomal regions, allows a simultaneous analysis of replicates and enables a differentiation between unmethy-lated, methylated and highly methylated genomic regions. We train MeDIP-HMM using a Bayesian Baumâ€“Welch algorithm, integrating prior knowledge on methylation levels. We apply MeDIP-HMM to the analysis of the Arabidopsis root methylome and systematically investigate the benefit of using higher-order HMMs. Moreover, we also perform an in-depth comparison study with existing methods and demonstrate the value of using MeDIP-HMM by comparisons to current knowledge on the Arabidopsis methylome. We find that MeDIP-HMM is a fast and precise method for the analysis of methylome data, enabling the identification of distinct DNA methylation levels. Finally, we provide evidence for the general applicability of MeDIP-HMM by analyzing promoter DNA methylation data obtained for chicken.
INTRODUCTIONMethylation of genomic DNA is one of the best characterized epigenetic modifications catalyzed by DNA methyltransferases that methylate cytosines at their carbon-5 position (). In mammals, DNA methylation is found exclusively in the CpG dinucleotide context, except in embryonic stem cells, where a small proportion of cytosines in other contexts (CpA, CpT and CpC) are also methylated. In plants, DNA methylation is found in symmetric CpG and CpHpG and in asymmetric CpHpH contexts (H  A, T or C). Generally, DNA methylation plays important roles in regulation of gene expression () and silencing of transposons (;). Despite recent developments of next-generation sequencing approaches for determining methylomes at single base pair resolution (e.g.), methylomes of different organisms or cell tissues are also frequently analyzed using whole-genome tiling arrays (e.g.), which provide cost-effective alternatives. Most array-based studies are done based on methylated DNA immunoprecipitation coupled with hybridization to a tiling array (MeDIP-chip) (). MeDIP-chip enables to analyze the methylome of a genome at a resolution of few hundred base pairs, which in most applications is sufficient to draw biologically meaningful conclusions. The analysis of MeDIP-chip data puts similar challenges on bioinformatics methods, as identified for the analysis of closely related array-based chromatin immunoprecipitation data (ChIP-chip). Different methods for the analysis of ChIP-chip data were proposed over the last years. Especially, methods based on hidden Markov models (HMMs) (e.g.) and on mixture models (e.g.) were shown to enable reliable predictions of chromosomal target regions of transcription factors or histone modifications. A common characteristic of all these methods is the modeling of two different populations of measurements to differentiate non-enriched genomic regions from enriched ones. Main conceptual differences exist in the *To whom correspondence should be addressed. way of modeling dependencies between adjacent measurements on a chromosome, in handling of replicates and in training algorithms. From these methods, only approaches based on HMMs integrate dependencies between directly adjacent measurements on a chromosome. Some methods only enable a separate analysis of replicates (e.g.), whereas others try to improve the analysis by simultaneous modeling of replicates (e.g.). Mixture models are typically trained by specifically designed expectation maximization (EM) algorithms (). HMM-based methods except TileMAPHMM () and HMMs byuse a BaumWelch training (), representing a special case of an EM algorithm. TileMAPHMM is based on data-dependent ad hoc settings, and HMMs byenable the integration of prior knowledge on measurements using a Bayesian BaumWelch algorithm. All these methods are useful tools for the analysis of ChIP-chip data. Additionally, some methods like ChIPmix () and a mixture-model approach byhave already been applied to the analysis of MeDIP-chip data. One general limitation of all these methods in the context of MeDIP-chip data analyses is that they only enable a binary classification into unmethylated and methylated regions. MeDIP-chip data is known to be more complex, showing differences in methylation levels of individual chromosomal regions as, for example, revealed for Arabidopsis thaliana having moderately methylated genes and highly methylated transposons (). To address that, a three-state HMM specifically designed for the analysis of Arabidopsis MeDIP-chip data has been developed in a companion work by. This approach uses Arabidopsis-specific ad hoc settings and enabled a better interpretation of MeDIP-chip data using a classification of methylation states of genomic regions according to the underlying three states. Generally, organism-specific ad hoc settings can only be hardly transferred to MeDIP-chip data of other organisms. Thus, there is still a great demand of having a general method that is able to differentiate between different methylation levels without being dependent on a specific organism. Moreover, a systematic performance evaluation of different methods for analyzing DNA methylation data has not been carried out up to now, and current HMM-based methods only focus on standard first-order HMMs. Here, we present MeDIP-HMM, a method specifically designed for the analysis of MeDIP-chip data. MeDIP-HMM utilizes three states to differentiate between unmethylated, methylated and highly methylated regions overcoming limitations of typically used ChIP-chip methods only enabling a binary classification into unmethylated and methylated regions. Additionally, MeDIP-HMM can perform a simultaneous analysis of replicates and integrates prior knowledge on measurements to improve the identification of methylated genomic regions. Moreover, MeDIP-HMM can also take advantage of higher-order hidden Markov chains to improve spatial modeling of dependencies between neighboring regions. This has recently been found to improve the analysis of comparative genomics data () and provides a valuable option for improving the analysis of MeDIP-chip data. We apply our MeDIP-HMM to the analysis of the Arabidopsis root methylome and systematically evaluate the influence of using higher-order Markov chains on the identification of methylated genomic regions. We further perform an in-depth comparison study to widely used existing methods and demonstrate advantages of using MeDIP-HMM based on comparisons to current knowledge on the Arabidopsis methylome. We also show that MeDIP-HMM can be applied to non-Arabidopsis data by performing an additional study on promoter DNA methylation data obtained for chicken ().
METHODSIn this section, we initially describe our root methylome data. Then, we provide the mathematical background of MeDIP-HMM. Finally, we consider publicly available data for model evaluations.
Arabidopsis root methylome datasetWe performed a MeDIP-chip experiment to identify genomic regions that are methylated in root tissue of the accession Col-0 of the flowering plant A.thaliana according to the experimental protocol described by. The dataset is publicly available from GEO (GSE36750). This dataset represents log ratios of fluorescent intensities of immunoprecipitated methylated DNA versus reference input DNA measured for T : 711320 genomic regions in two biological replicates. We applied quantile normalization () to the log ratios of both replicates and summarized the resulting normalized log ratios of each replicate in chromosome-specific methylation profiles. This leads to a methylation profile ~ ok : ~ o 1 k,. .. , ~ o Tk k for each chromosome k 2 f1,. .. , 5g containing chromosome-specific measurements ~ o t k : o 1 t k, o 2 t k of both replicates in increasing order of their chromosomal positions. Thus, each methylation level ~ o t k of a region t 2 f1,. .. , T k g is represented by the corresponding normalized log ratios o 1 t k and o 2 t k measured in replicates 1 and 2, respectively. A histogram of average methylation levels is shown in. Measurements of both biological replicates are highly reproducible, reaching a Pearson correlation coefficient of 0.92 (Supplementary).
MeDIP-HMM: HMM for MeDIP-chip analysesWe use a three-state HMM with state-specific multivariate Gaussian emission densities to analyze methylation levels of chromosomal regions in methylation profiles. Motivated by the distribution of methylation levels in, three states S : f 0 U 0 , 0 M 0 , 0 I 0 g are defined to model distinct classes of methylation states. State 0 U 0 models unmethylated regions characterized by log ratios of about or much less than zero. Highly methylated regions having log ratios much greater than zero are modeled by state 0 M 0. Methylated regions having log ratios in between unmethylated and highly methylated genomic regions are modeled by state 0 I 0. These states are the basis of the fully connected three-state architecture of the HMM shown in Supplementary. More formally, the state of a region t on chromosome k is denoted by q t k 2 S. To account for correlations between measurements of closely adjacent regions on a chromosome, a state sequence ~ qk : q 1 k,. .. , q Tk k underlying a methylation profile ~ ok is modeled by a homogeneous Markov model of order L (e.g.). Thus, the state-transition process of an HMM of order L ! 1 is parameterized by an initial state distribution ~ :  i  i2S with initial state probability i 2 0, 1 and a set of stochastic transition matrices A : fA 1 ,. .. , A L g. The initial state distribution fulfills the constraint P i2S i  1. Each transition matrix A l : a ij  i2S l , j2S 2 A with 1 l L specifies the transition probability a ij 2 0, 1 for each transition from the current state i l of a state-context i  i 1 ,. .. , i l  2 S l to a next state j 2 S. Thus, this means that, for l41, transitions from i l are depending on its l  1 predecessors i 1 ,. .. , i l1. Hence, a transition matrix A l with 1 l5L is used for the transition from the current state q l k to the next state q l1 k under consideration of the l  1 predecessor states q 1 k,. .. , q l1 k. The transition matrix A L 2 A is used for each transition from q t k to q t1 k for all regions t ! L in dependency of the complete memory on L  1 predecessor states q tL1 k,. .. , q t1 k. Finally, each A l 2 A also fulfills the constraint P j2S a ij  1 for each i 2 S l. Practically, only small model orders should be considered due to an exponential increase of transition parameters with increasing model order, leading to higher computational complexities and potentially overfitted models. Thus, different studies in other domains mainly focused on second-order HMMs (e.g.) or developed different strategies to obtain parsimonious models (e.g. du). For our approach, the most parsimonious model is obtained for L  0. This reduces the HMM to a mixture model (e.g.) that does not model dependencies between measurements. Generally, the state sequence ~ qk underlying a methylation profile ~ ok is unknown. To enable the inference of a state sequence, measurements contained in a methylation profile must be integrated into the HMM by making use of state-specific emission distributions. The usage of univariate Gaussian emission distributions represents a common choice for HMM-based analyses of single ChIP-chip experiments (e.g.). Similar to, we extend this assumption by using multivariate Gaussian emission distributions, enabling the simultaneous analysis of replicates of an experiment. Thus, a methylation level ~ o : o 1 ,. .. , o d  that represents the log ratios of a region measured in d replicates is modeled under state i 2 S of the HMM by the state-specific Gaussian emission distribution b i ~ o :with mean vector ~ i 2 R d and covariance matrix AE i 2 R dd. Here, the determinant of the covariance matrix is denoted by detAE i , where AE 1 i represents the inverse of the covariance matrix, and the transpose vector of ~ o  ~ i  is given by ~ o  ~ i  T. The emission parameters of all states of the HMM are summarized by B :  ~ i , AE i  i2S. All parameters of the HMM are denoted by : ~ , A, B. The underlying state-space model highlighting dependencies modeled between states and emissions is illustrated in Supplementaryfor a second-order HMM. To quantify the methylation status of a genomic region, the HMM is used to compute the probability that a region t in methylation profile ~ ok is modeled by a state i 2 S. The corresponding state-posterior probability k t i : P q t k  i j ~ ok,  is computed by the forward-backward algorithm adapted to higher-order HMMs (e.g.). These state-posterior probabilities allow to decode the most likely underlying methylation state of each region. Additionally, the state-posterior probabilities enable a ranking of genomic regions according to their probabilities of being methylated ( 0 I 0 or 0 M 0 ) using the probability 1  k t  0 U 0  as score.
Integration of prior knowledgeThe integration of prior knowledge on the distribution of measurements enables a problem-specific characterization of model parameters. Especially, the modeling of prior knowledge on emission parameters can substantially improve HMM-based predictions compared with predictions of HMMs ignoring prior knowledge during training (). For that reason, a prior distribution for an HMM : ~ , A, B is defined bygiven specific hyperparameters  :  1 ,  2 ,  3 . This prior represents a product of independent conjugate priors for each class of model parameters, enabling analytical parameter estimations and integration of prior knowledge during model training. Following the usual choice of prior distributions for initial state and transition parameters (e.g.), the prior D 1  ~ j  1  for the initial state distribution is given by aDirichlet distribution, and the prior D 2  A j  2  for the set of transition matrices is specified by products of Dirichlet distributions. Appendix A of the Supplementary Material provides details to both prior distributions and chosen hyperparameters. For the state-specific multivariate Gaussian emission densities enabling simultaneous modeling of measurements of replicates of an experiment, we use a GaussianWishart prior to integrate prior knowledge on different methylation levels. This choice is motivated byintroducing this prior into HMM-based speech recognition. We transfer this to HMM-based modeling of multivariate MeDIP-chip data. Thus, the prior distribution for the emission parameters is a product of state-specific independent GaussianWishart distributions defined byHere, ~ i 2 R d specifies an a priori mean vector for methylation levels modeled by state i 2 S, and i 2 R  defines a corresponding scaling factor of the a priori mean vector weighting its strength of influence on the state-specific mean vector ~ i during training. Similarly, i 2 R dd is a positive definite scale matrix for the covariance matrix AE i of state i, and r i 4d  1 is a scaling parameter for AE i. Additionally, tr i  AE 1 i  specifies the trace of the matrix product i  AE 1 i. The influence of the emission prior on the estimation of emission parameters is shown in the following section. Details to chosen prior
Bayesian BaumWelch trainingThe adaptation of the HMM parameters to the MeDIP-chip data is done by a Bayesian BaumWelch training outlined infor HMMs with univariate Gaussian emission distributions. This training algorithm is a special case of an EM algorithm (), enabling the integration of prior knowledge. Based on a choice of initial model parameters, the Bayesian BaumWelch algorithm iteratively maximizes the posterior density (product of likelihood and prior distribution) of the model parameters given a dataset, reaching at least a local optimum in dependency of the initial parameters. This is usually done in log space by successively computing updated HMM parameters h  1  arg max Q j h   logP j     maximizing the sum of Baum's auxiliary function Q j h  (see Appendix B, Supplementary Material) and the logarithm of the prior distribution P j   in Equation (1). This enables an iterative estimation of the new HMM parameters h  1 under consideration of current parameters h (for h  1 initial HMM) until the log posterior grows less than a predefined threshold. Here, we use a threshold of 10 3 for two successive iterations. Details to the estimation of initial state and transition parameters are given in Appendix B of the Supplementary Material. Since we make use of state-specific multivariate Gaussian emission densities in combination with a GaussianWishart prior, estimation formulas of the state-specific mean vector ~ i and the corresponding covariance matrix AE i are given in the following. Detailed derivations of these formulas are outlined in Appendix B of the Supplementary Material. Considering the iteration step h of the Bayesian BaumWelch training, the mean vector of the multivariate Gaussian emission density of state i 2 S is given bywith respect to the measured methylation level ~ o t k, the state-posterior probability k t i : P q t k  i j ~ ok, h  under the current model h, and the state-specific a priori mean vector ~ i with its scaling factor i specified by the GaussianWishart prior. The corresponding state-specific covariance matrixis computed based on the state-posterior k t i under the current model h and two state-specific matricesThe a priori mean vector ~ i , the scale matrix i and the scaling factor r i are specified by the state-specific GaussianWishart prior. The obtained parameter estimation formulas for the mean vector and the covariance matrix generalize the estimation formulas for multivariate Gaussian emission densities typically used in the standard BaumWelch training that does not enable the integration of prior knowledge (e.g.). A computational scheme summarizing the main steps of the Bayesian BaumWelch training is given in Appendix B of the Supplementary Material.
Model initializationTo enable the identification of distinct DNA methylation states from MeDIP-chip data, an initial HMM is specified in a data-dependent manner. We use the following heuristic approach to set the initial model parameters. Initially, the user has to specify the model order L and rough estimates of expected proportions 0 U 0 2 0, 1 and 0 M 0 2 0, 1 of unmethylated and highly methylated genomic regions in an experiment. Here, a histogram or a cumulative density plot of measured methylation levels helps to select these proportions. Alternatively, these proportions can also be chosen based on prior knowledge from previous experiments. Based on that, the initial state distribution is set toAdditionally, the initial transition matrix A 1 : a ij  i, j2S is defined to have a stationary distribution identical to ~ by using state-specific diagonal and non-diagonal elements a ii : 1  s= i and a ij : s=2 i  with respect to s 2 0, minf0 U 0 , 0 I 0 , 0 M 0 g for controlling the state durations (default s  0:05). For transition matrices A l : a ij  i2S l , j2S with 15l L, we initially set a ij : a ilj for each state-context i : i 1 ,. .. , i l  to the value of the corresponding transition probability a ilj defined for A 1. These settings realize that the state-transition process of the initial HMM is modeling the specified proportions of unmethylated and highly methylated genomic regions. In addition to this, the states of the initial HMM need to be characterized by specific Gaussian emission densities to enable the differentiation of methylation levels. For realizing this, average methylation levels of genomic regions are initially computed based on all replicates of an experiment. The resulting distribution of average methylation levels is further divided into three parts by computing data-dependent quantiles Q 0 U 0 and Q 0 U 0 0 I 0 for the corresponding initial proportions 0 U 0 and 0 I 0. These two quantiles are used to obtain the following partitioning in which unmethylated genomic regions are assumed to have average methylation levels less than Q 0 U 0 , highly methylated genomic regions are assumed to have average methylation levels greater than Q 0 U 0 0 I 0 and less strongly methylated genomic regions are assumed to have average methylation levels between Q 0 U 0 and Q 0 U 0 0 I 0. For these three groups, the mean values 0 U 0 , 0 I 0 and 0 M 0 , and the standard deviations 0 U 0 , 0 I 0 and 0 M 0 are computed for the corresponding averaged methylation levels. Additionally, Pearson's correlation coefficients R0 U 0 v, w, R0 I 0 v, w and R0 M 0 v, w of methylation levels between each pair of replicates v, w with 1 v, w d and v 6  w are computed for the three groups. Based on these precomputations, the initial mean vector ~ i of each state i 2 S is set to ~ i :  i ,. .. , i  using the precomputed mean value i. The corresponding covariance matrix AE i :  i v, w with 1 v, w d is specified by diagonal elements i v, v : 2 i and by non-diagonal elements i v, w : 2 i  R i v, w based on the precomputed standard deviation i and the correlation coefficient R i v, w. These initial emission parameters realize an appropriate characterization of the three HMM states for identifying distinct classes of methylation levels. All initially chosen model parameters are further refined during the Bayesian BaumWelch training using precomputed data-dependent prior knowledge. This is done by setting each a priori mean vector ~ i : ~ i for modeling the methylation levels under state i 2 S to the initially computed state-specific mean vector ~ i. The corresponding scaling factor is specified by i : i  T representing the number of measurements initially assumed to be modeled by state i. The scale matrix of the covariance matrix of state i is set to i : T=100  AE i in dependency of the precomputed covariance matrix AE i weighted by 1% of the total number of measurements. The corresponding scaling parameter is set to r i : i  T. The approach for setting the initial parameters of the HMM and for specifying the parameters of the prior distribution has been tested on different MeDIP-chip datasets of root and shoot tissue for varying user-specified proportions 0 U 0 and 0 M 0. The performance of the resulting identification of methylation levels by HMMs trained based on these initial settings was found to be robust (e.g. Supplementaryfor four different initializations on root data). Some more general hints considering the initialization are summarized in Appendix C of the Supplementary Material. Motivated by the mapping of candidate regions of DNA methylation fromto our tiling array, we use 0 U 0  0:8 and 0 M 0  0:1 for all studies and investigate models of order zero up to four.
Publicly available data for model evaluationsThe methylome of Arabidopsis roots has initially been studied on a genome-wide scale by. This study used a tiling array with 382 178 tiles, which is less dense than the tiling array platform that we used for our experiments. Still, genomic regions quantified as being methylated in this study provide a useful resource for evaluating the performance of different methods for MeDIP-chip analyses, because they also analyzed the accession Col-0. For that purpose, we downloaded the corresponding two DNA methylation profiles from GEO (GSM307382, GSM307384) and applied quantile normalization to the log ratios of both experiments. We then averaged both log ratios measured for each genomic region and determined all chromosomal segments, consisting of successive genomic regions with an average log ratio greater or equal than one. This restrictive log-ratio cutoff ensures that only strongly enriched genomic segments are considered as potential targets of DNA methylation. This led to 18 061 potential candidate segments of DNA methylation widespread across all chromosomes of A.thaliana. These segments were mapped back to the 711 320 genomic regions present on our tiling array. Based on this mapping, each genomic region that was at least partially covered by one of the candidate segments has been labeled as a putative candidate for DNA methylation in root tissue. This resulted in 156 091 genomic regions being potential candidates for DNA methylation (22% of regions present on our tiling array). The remaining 555 229 genomic regions are potential candidates for being unmethylated. To demonstrate the value of using this public dataset to evaluate potential candidates of DNA methylation in our root methylome data, the distribution of measured methylation levels of genomic regions labeled as being methylated is shown in(see Supplementaryfor a bivariate density plot). Most of these genomic regions have log ratios clearly greater than zero peaking at about 2.0. Thus, genomic segments identified as being potential candidates of DNA methylation in thedata are also present in our root methylome dataset and can be used as a useful resource for comparisons of different MeDIP-chip analysis methods.
RESULTS AND DISCUSSIONIn this section, we first investigate the effect of using higher-order MeDIP-HMMs for analyzing the Arabidopsis root methylome. We next perform a systematic comparison study to existing methods and analyze predictions of MeDIP-HMM in the context of the Arabidopsis genome annotation. Finally, we show an application of MeDIP-HMM to publicly available promoter DNA methylation data obtained for chicken.
Comparison of MeDIP-HMMs of different model ordersTo compare the influence of different model orders on the identification of methylated genomic regions by MeDIP-HMMs, we analyzed our root methylome dataset with respect to methylated regions from. We initially trained
Comparison of MeDIP-HMM to existing methodsTo compare the second-order MeDIP-HMM against other existing methods, we again utilize our root methylome dataset and known potential candidate regions of DNA methylation obtained from. In recent years, especially,) and methods based on HMMs (e.g.) were developed for the analysis of ChIP-chip data to enable reliable identifications of chromosomal target regions of transcription factors or histone modifications. Because the analysis of ChIP-chip data is closely related to that of MeDIP-chip data and Johannes et al. (2010) have already shown that mixture models can be used to analyze DNA methylation data, we compare the identification of known candidate regions of methylation against these different methods. We also include the three-state HMM specifically developed for the analysis of Arabidopsis MeDIP-chip data described in a companion work byinto the comparison. This model uses the observation that introns of protein coding genes are usually unmethylated in Arabidopsis. Based on that, MeDIPchip data is rescaled and state-specific emission functions are estimated with respect to biological constraints customized for Arabidopsis. Two state-specific Gaussian emission densities with fixed means and equal variances are used to model probes with high or low methylation levels, whereas a mixture of 30 Gaussians with fixed variances is used to model unmethylated probes based on the measurement distribution obtained from intronic probes. The estimation of 30 Gaussians is done externally, and the obtained parameters are used as fixed emission parameters for the unmethylated state. This approach cannot be directly transferred to other organisms like human, where introns are usually found to be methylated (). The first four columns ofprovide more detailed information about the considered methods. Conceptionally, our MeDIP-HMM is specifically designed for the analysis of MeDIP-chip data by making use of three distinct states to enable the differentiation between different degrees of methylation. Except for CortijoHMM (), this cannot be realized by all the other methods that only perform a binary classification into unmethylated and methylated regions. Additionally, MeDIP-HMM also enables the modeling of higher-order dependencies, which has not been addressed by other methods so far. All methods listed inwere analyzed for their ability to identify the potential candidate regions of DNA methylation in our root methylome dataset. The methods were adapted to the data using their standard initialization and training algorithms. User-defined settings were required to obtain an initial StandardHMM () and an initial JohannesModel1 (). For both models, the initial parameter settings of the first-order MeDIP-HMM have been transferred by taking into account that these models only differentiate between unmethylated and methylated regions. This was done using average initial parameter values of states 0 I 0 and 0 M 0 modeling methylations in MeDIP-HMM to initially specify the state representing methylated regions in StandardHMM and JohannesModel1. The settings for the state modeling unmethylated regions were directly transferred. The time and memory complexity for analyzing a methylation profile of length T by a MeDIP-HMM of order L during one training step is given by OT  N L1  with respect to N  3 states. For each of the T measurements, all possible N L1 state transitions must be considered. Thus, the complexity is mainly dominated by the extended state-transition process involving the last L predecessor states to determine the next state (e.g. Supplementary). This time and memory complexity can also be transferred to the mixture models (L  0) and the first-order HMMs (L  1) in. To quantify the potential of genomic regions of being methylated, corresponding scores based on state-posterior probabilities were provided by each of the different methods. A score close to one indicates that the corresponding genomic region is aThe methods are compared based on their identification of methylated DNA-regions in the root methylome dataset. The 'Method' column contains the shortcuts of the different methods. The 'Model' column specifies the basic model of the corresponding method. This is either a HMM or a mixture model (MixMod). The 'SIM' column specifies whether a method considers all replicates of an experiment simultaneously. The 'Training' column specifies the algorithm used for adapting the corresponding method to the data. For an HMM-based method, this is either a Bayesian BaumWelch training (Bayesian BW), Viterbi training (Viterbi) or a standard BaumWelch training (BW). For methods based on a mixture model, specific versions of the EM algorithm are used. The 'Reference' column provides the link for getting more information about a specific method. The methods are compared based on different criteria, considering the TPR reached at a fixed FPR of 1%, AU-ROC, AU-PRC and the run time in seconds required for the complete analysis of the dataset. The run time was measured on a standard desktop computer with 2.6 GHz and 4 GB of memory, except for CortijoHMM evaluated on a cluster node with 3 GHz and 8 GB of memory. For MeDIP-HMM only, results obtained by the second-order model are shown. Corresponding ROC and PRC curves of all methods are shown in Supplementary. An additional summary for MeDIP-HMMs of order zero up to four is given in Supplementary Table S3.potential candidate of being methylated, while a score close to zero specifies that this region is potentially unmethylated. For methods that do not allow the simultaneous analysis of both replicates of our root methylome dataset, average state-posterior probabilities obtained from separate analyses of replicates were considered as scores.Based on these scores, the identification of candidate regions of methylation was evaluated for the different methods. For each method, we computed the TPR at a fixed FPR of 1%. To enable a more global performance comparison, we also computed the area under the receiver-operating-characteristic curve (AU-ROC) and the area under the precision-recall curve (AU-PRC). Because run times of methods can also be important for the analysis of high-density tiling array data, we additionally measured the time required by each method for performing the analysis of our root methylome data. All results are summarized in. Corresponding ROC and PRC curves are shown in Supplementary. An additional summary for MeDIPHMMs of order zero up to four is given in Supplementary Table S3. The best performing methods in terms of accuracy of identifying methylated regions are the proposed MeDIPHMM, CortijoHMM () and tileHMM (). In comparison to CortijoHMM, which has been specifically developed for the analysis of Arabidopsis MeDIP-chip data, MeDIP-HMM reaches the same performance without being dependent on organism-specific settings. As expected, the second-order MeDIP-HMM required longer for performing the analysis than the first-order CortijoHMM. The first-order MeDIP-HMM reaches nearly identical AU-ROC and AU-PRC values but could not reach the level of TPR at 1% FPR as CortijoHMM (Supplementary). Thus, at the price of a slightly higher run time, the second-order MeDIPHMM is able to compensate Arabidopsis-specific ad hoc settings required by CortijoHMM. Compared with tileHMM, MeDIPHMM reaches a higher TPR at 1% FPR. Additionally, MeDIP-HMM is faster than tileHMM and provides the possibility to differentiate between different methylation levels due to the usage of the three states. StandardHMM is also reaching a good performance, but has a smaller TPR at 1% FPR compared with MeDIP-HMM, CortijoHMM and tileHMM. Generally, all these four methods reach comparable global performances as indicated by nearly identical AU-ROC and AU-PRC values. Comparing all six tested HMM-based methods, TileMAPHMM () reaches the lowest performance potentially because this method does not use a training algorithm, which also leads to the fastest run time among all tested methods. More generally, MeDIP-HMM, CortijoHMM, tileHMM, StandardHMM and ChIPmixHMM are reaching clearly higher TPRs at 1% FPR and higher AU-PRCs than methods based on mixture models. This is again obtained due to the modeling of dependencies between measurements of directly adjacent chromosomal regions, which cannot be realized by mixture models. Further support to this is given considering all ChIPmix-based methods () for which ChIPmixHMM clearly outperforms multiChIPmix and ChIPmix that are both using a mixture model. The best method based on a mixture model is JohannesModel1 reaching an accuracy comparable with that of TileMAPHMM but requiring nearly 81 times longer for the analysis. Generally, also these comparisons indicate that the second-order MeDIP-HMM is well suited for the identification of methylated regions. This model reaches a high accuracy, has a low run time, does not depend on organism-specific settings and additionally enables to differentiate between different levels of DNA methylation. Additionally, considering more stringent validation data from Zilberman et al. 2008 than utilized for this comparison, the second-order MeDIP-HMM is clearly outperforming all other tested methods (Supplementary).
Functional analysis of DNA methylation states identified by MeDIP-HMMtransposons. Generally, the prevalence of methylated regions in euchromatin is significantly enriched, comprising about 53% of methylated regions (Supplementary), which is much less stronger than observed for unmethylated regions because transposons identified as being methylated are mostly located within the heterochromatic regions. Regions identified as being highly methylated are clearly enriched in transposons, whereas only very small fractions of genic regions, 5 0 and 3 0 UTRs, are highly methylated (). About 27:2% of all transposons and only about 2% of all genes are highly methylated over their whole tiled sequences (Supplementary). This coincides with previous findings (). Overall, we find that highly methylated regions modeled by state 0 M 0 are preferentially located in heterochromatin. We identified a significantly enriched proportion of 86:3% heterochromatic regions compared with only 13:7% euchromatic regions (Supplementary). We further analyzed identified DNA methylation states of transposon superfamilies using the extended TAIR8 transposon annotation of. We observe clear tendencies that especially unmethylated or methylated transposons of the superfamilies LTR/Gypsy, LTR/Copia, LINE/L1 and DNA/ En-Spm are much smaller in size than highly methylated members of the same superfamily (Supplementary). Shorter sizes and less strong methylation are known to be indicative of non-functional transposon relics (). These dependencies can only be observed so explicitly using the three-state decoding of MeDIP-HMM. Summing up, predictions by MeDIP-HMM are in good accordance with current knowledge on the Arabidopsis methylome assembled in previous studies using tiling array and bisulfite sequencing experiments. Moreover, differentiations between unmethylated, methylated and highly methylated regions are only possible with MeDIP-HMM and cannot be achieved using standard methods for ChIP-chip analysis designed to discriminate between two populations of measurements. Thus, MeDIP-HMM allows a more detailed analysis and potentially a more advanced interpretation of results.
Application of MeDIP-HMM to non-Arabidopsis dataTo illustrate the general applicability of MeDIP-HMM, we analyzed publicly available promoter DNA methylation data of brain tissue of domesticated White Leghorn (WL) and wildtype Red Jungle fowl (RJF) chickens (). We downloaded processed data for parents and offspring chickens from ArrayExpress (E-MTAB-648 and E-MTAB-649) and created a small dataset containing measurements of tiles in corresponding promoter regions for two selected genes ABHD7 and PCDHAC1 shown to have a stable transgenerational methylation profile. This dataset includes four replicates (females and males each with high and low fear behavior) for WL and RJF. We trained a second-order MeDIP-HMM with four-variate Gaussian emissions on this dataset using initial proportions of unmethylated and highly methylated tiles like those applied for the Arabidopsis root methylome data. Finally, we performed a state-posterior decoding into the most likely underlying methylation states. The results are shown in Supplementary.We developed a three-state MeDIP-HMM for the analysis of DNA methylation data from high-density tiling arrays, enabling the identification of distinct methylation levels. MeDIP-HMM enables a simultaneous analysis of replicates and improves modeling of spatial dependencies between chromosomal regions using a higher-order state-transition process. We carefully evaluated our model and existing methods for ChIP-chip analyses on DNA methylation data of Arabidopsis root tissue. Compared with these methods, MeDIP-HMM reached an overall good performance in combination with a fast run time. This also revealed that HMMs modeling spatial dependencies between chromosomal regions are generally better suited for the analysis of MeDIP-chip data than mixture models ignoring these dependencies. Besides this, moderately higher-order MeDIP-HMMs were identified to be more precise than the first-order MeDIP-HMM and other existing first-order HMMs. This is in good accordance with a previous study in comparative genomics (). Generally, we identified that a second-order MeDIP-HMM is working best on the root methylome data, reaching a performance comparable to a three-state first-order HMM specifically developed for the analysis of Arabidopsis MeDIP-chip data in a companion study by. The companion approach uses the observation that introns in Arabidopsis are typically found to be unmethylated for estimating the emission parameters of the unmethylated state. This cannot be directly transferred to other organisms like human, where introns are usually found to be methylated (). Our results indicate that the second-order MeDIP-HMM is able to compensate Arabidopsis-specific ad hoc settings required by the companion approach. Moreover, we also showed that our MeDIP-HMM can be applied to the analysis of non-plant data as well. Overall, MeDIP-HMM is more versatile by being independent of organism-specific settings, using a higher-order statetransition process and enabling simultaneous analyses of replicates. Generally, the differentiation between unmethylated, methylated and highly methylated regions by MeDIP-HMM enables an improved interpretation of predictions compared with existing ChIP-chip analyses methods only enabling a binary classification into unmethylated and methylated regions. Moreover, the predictions of MeDIP-HMM were in good accordance with current knowledge on the Arabidopsis methylome. All these findings clearly indicate that MeDIP-HMM is a useful method for the analysis of DNA methylation data. Given that MeDIP-HMM is independent of organism-specific settings, it should be applicable to the analysis of methylomes of plant and non-plant species equally.
HMM-based analysis of DNA methylation profiles at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.Seifert et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
MeDIP-HMMs of orders zero up to four on our root methylome data. For each model, we next ranked all genomic regions according to their probabilities of being methylated ( 0 I 0 or 0 M 0 ) as described in the methods section. Based on that, we computed for each MeDIP-HMM the corresponding true-positive rates (TPRs) of identified methylated regions reached at different levels of fixed false-positive rates (FPRs). The performance of the different MeDIP-HMMs at small FPRs is shown in Figure 2. The largest improvement in the identification of known candidate regions of DNA methylation is achieved by the transition from order zero to order one. The zeroth-order MeDIP-HMM represents a mixture model of multivariate Gaussians that does not enable the modeling of dependencies between measurements in close chromosomal proximity. This is overcome by the first-order MeDIP-HMM capable of modeling dependencies between measurements of directly adjacent chromosomal regions. Moreover, an additional increase in performance is reached by the second-order MeDIP-HMM that extends the first-order model by realizing dependencies between two directly adjacent regions to identify the state of the next region. This is exemplarily shown in Figure 2a for a fixed FPR of 1.5% and also observed among the small FPRs considered in Figure 2b. MeDIP-HMMs of order three and four did not reach the performance of the second-order model. These two models identified methylated regions only slightly better than the first-order MeDIP-HMM potentially due to overfitting caused by exponentially growing numbers of transition parameters. All these findings are also supported by performance evaluations based on different training and test sets (Supplementary Table S2). In summary, the transition from a mixture model to an HMM has led to the largest improvement in the identification of methylated genomic regions. Overall, the second-order MeDIP-HMM reached the best performance among all considered models. We focus on this model in the following studies.
The Arabidopsis Information Resource (TAIR8) genome annotation (Rhee et al., 2003) enables us to analyze whether predictions by the second-order MeDIP-HMM are targeting specific functional units of the genome and to which extent these findings are in accordance with current knowledge on the Arabidopsis methylome. We initially assigned each genomic region to its most likely underlying state (unmethylated, methylated or highly methylated) of the MeDIP-HMM using state-posterior decodings. This resulted in 463 877 652% unmethylated, 143 017 201% methylated and 104 426 147% highly methylated regions. Thus, 65:2% of regions are unmethylated, whereas 34:8% of regions are targeted by methylation, which is in good agreement with previous studies for aerial and root tissues by Zilberman et al. (2007, 2008). We next classified all regions according to the genome annotation and identified under-or overrepresentations of specific functional categories by sampling the same numbers of unmethylated, methylated and highly methylated regions randomly from all regions on the tiling array using 500 repeats (Fig. 3). Regions identified as being unmethylated are enriched in genic categories (gene, mRNA, protein, exon and CDS), and 5 0 and 3 0 untranslated regions (UTRs), whereas transposons are clearly underrepresented (Fig. 3a). About 62.4% of all genes and 21.2% of all transposons are identified as being unmethylated over their whole-tiled sequences (Supplementary Fig. S5). This is in good agreement with results of previous studies (e.g. Ahmed et al., 2011; Cokus et al., 2008; Zilberman et al., 2007). Furthermore, using the chromatin classification by Bernatavichute et al. (2008), we find that 72.8% of unmethylated regions are located in euchromatin, which is in agreement with these regions being gene-rich and transposon-poor (Supplementary Table S4). Regions identified as being methylated include a large fraction of genic regions and a small fraction of 5 0 and 3 0 UTRs (Fig. 3b). About 35:6% of genes are at least partially methylated (Supplementary Fig. S5). This is in good accordance with previous findings of gene body methylation (Cokus et al., 2008; Zhang et al., 2006; Zilberman et al., 2007). Additionally, regions identified as being methylated are clearly enriched in transposons. This is expected and coincides with the three previous studies, because methylation of transposons is a known mechanism to silence these elements (Law and Jacobsen 2010; Teixeira and Colot 2010). Overall, the fraction of methylated regions modeled by state 0 I 0 targeting genic regions is greater than that of
