Motivation: Sequencing capacity is currently growing more rapidly than CPU speed, leading to an analysis bottleneck in many genome projects. Alignment-free sequence analysis methods tend to be more efficient than their alignment-based counterparts. They may, therefore, be important in the long run for keeping sequence analysis abreast with sequencing. Results: We derive and implement an alignment-free estimator of the number of pairwise mismatches, π m. Our implementation of π m , pim, is based on an enhanced suffix array and inherits the superior time and memory efficiency of this data structure. Simulations demonstrate that π m is accurate if mutations are distributed randomly along the chromosome. While real data often deviates from this ideal, π m remains useful for identifying regions of low genetic diversity using a sliding window approach. We demonstrate this by applying it to the complete genomes of 37 strains of Drosophila melanogaster, and to the genomes of two closely related Drosophila species, D.simulans and D.sechellia. In both cases, we detect the diversity minimum and discuss its biological implications. Availability: pim is written in standard C and its sources can be downloaded from
INTRODUCTIONThe study of sequence diversity within natural populations provides a powerful link between raw sequence data and functional knowledge. Such population genetic studies have traditionally been centered on a few transcribed loci. However, the exponential decay of sequencing costs over the past two decades has recently made it possible to carry out population genetics on a genome scale. In a comprehensive early example of such studies,surveyed the resequenced genomes of six Drosophila simulans lines with the closely related D.yakuba serving as outgroup. They described the large-scale patterns of within population diversity and between species divergence along the three major D.simulans chromosomes. While diversity declined toward the telomeres and centromeres, where recombination rates are low, divergence, and thus mutation rates, remained constant across the chromosomes, which is a classical hallmark of selection at linked sites (). * To whom correspondence should be addressed.Similar genome-wide studies of population genetic processes are poised to become the norm. There are currently several projects under way aimed at sampling 1000 genomes of single model species. This shift to genome-scale sequence comparison has sparked interest in new population-centered sequence analysis methods. These fall into two categories: alignment-based and alignment-free. As to alignment-based methods, a number of recent studies have focused on the problem of estimating population mutation and recombination rates from aligned shotgun reads (). The main challenge in this work is to account for variable coverage and the errors introduced by the diverse chemistries of next-generation sequencing approaches. In contrast, alignment-free methods of sequence comparison usually start from finished genomes or contigs. Given two homologous sequences, the most popular approaches are based on one of two kinds of measurements: the correlation between the frequencies of short 'words' such as 5mers found in each sequence (), and the lengths of matches between sequences (). In Bioinformatics, such methods have a long tradition due to their superior computational efficiency when compared with sequence alignment (). However, until recently a disadvantage of alignment-free sequence comparison was that word frequencies or match lengths could not be transformed into mutation rates. In order to combine the computational efficiency of alignmentfree sequence comparison with the biological relevance of alignment-based divergence estimation,have derived and implemented a moment-based estimator of the substitution rate from match lengths. This estimator can be used to rapidly compute meaningful phylogenies from closely related genomes ranging in size from 10 4 to 10 8 bases (Domazet). Here, we extend this work by deriving a maximum likelihood estimator of pairwise nucleotide diversity that can be computed without alignment. We explore the accuracy of this estimator using simulations. In addition, we survey the genetic diversity along the chromosomes of 37 strains of D.melanogaster and the genome-wide divergence between D.simulans and D.sechellia.
APPROACH AND DATA
Derivation of estimator (  m ) without recombinationOur estimator of nucleotide diversity,  m , is based on the distribution of the lengths of exact matches between a pair of DNA sequences. Following the previous description of these exactPage: 450 449455
B.Haubold et al.matches (), we label one member of such a pair query, the other subject. For each suffix in the query, we look up the length of the shortest prefix that is absent from the subject.designated these absent prefixes SHortest Unique subSTRINGS (shustrings) and showed how to look them up efficiently using an enhanced suffix array (). In our analysis, we assume that the shustring in the query is homologous to the corresponding substring in the subject. Note that we do not need to know the position of the homologous substring. To express diversity as a function of shustring lengths, let  be the number of mismatches per site between a pair of sequences. Under the infinite sites model, where each mutation affects a hitherto unchanged site,  is a proxy for the rate of mutation per site. In the absence of recombination, the probability of observing a shustring of length X = x is therefore the probability of observing a mutation terminating a shustring preceded by x 1 constant positions : e (x1) .We generalize this to calculate the probability of the shustring lengths found at every position in a query,where we ignore dependencies between shustrings at different positions, and where X i is the (random) shustring length at position i. Equivalently, log(P{X i = x i i})  i log (x i 1).To find the value of  that maximizes this expression, we differentiate with respect to which leads to our maximum likelihood estimator of ,where |Q| is the length of the query sequence. Notice that  m is approximately the inverse of the average shustring length. As a consequence of the ergodic theorem [e.g., Section 6],  m   for large |Q|.
m with rcombinationHere, we derive the basic property that  m is downwardly biased in the presence of recombination. For this, we use the approximation that the single nucleotide polymorphisms (SNPs) are generated by a Poisson point process in the absence of recombination and tend to cluster in the presence of recombination.shows 100 SNPs distributed along a single pair of sequences of arbitrary length simulated with or without recombination. In the absence of recombination, the time to the most recent common ancestor is constant along the sequences and hence the SNPs are distributed according to a constant rate Poisson process (). In contrast, with a rate of recombination that is similar to the mutation rate, which is the case in most eukaryotes, the time B Ato the most recent common ancestor varies widely along the sequence (). As a consequence, young, long segments contain fewer SNPs than old segments, which have had more time to both mutate and recombine, and SNPs cluster along the sequence (). For our exploration of the mathematical properties of  m with recombination, we assume that the SNPs arise at (random) positions, we find X i = Z k+1 i+1. We denote by W = Z i+1 Z i the waiting time between two SNPs (which by homogeneity does not depend on i). Any random site in the DNA is located between two SNPs separated by some distance W. The distribution of W is given by the size-biased distribution of W , since there is a higher chance to pick a site between two distant SNPs [see e.g.]:Moreover, given W , X is uniformly distributed between 1 and W. Therefore,Assume
Alignment-free diversity estimationergodic theorem,This explains why  m is downwardly biased under recombination. Moreover, it shows that the size of the bias is determined by the deviation of Vfrom 1/ 2. However, the function that relates Vto the rate of recombination is unknown.
Algorithm and implementationWe have implemented the computation of  m based on a publicly available software library for text indexing (). The resulting program, pim, can compute  m for two closely related, unaligned DNA sequences in FASTA format. In addition, it efficiently carries out the sliding window analyses described in the Section 3. The software is written in standard C, runs on the UNIX command line and its documented source code is freely available from http://guanine.evolbio.mpg.de/pim/
SimulationsWe simulated samples of DNA sequences according to the following protocol:(1) Use the coalescent simulation program ms () to generate a set of haplotypes conditioned on the number of segregating sites and the rate of recombination.(2) Convert these haplotypes to DNA sequences using our program ms2dna, which is freely available as part of our collection of sequence analysis tools, biobox: http://guanine.evolbio.mpg.de/bioBox/(3) Calculate  m and in many cases also  from the simulated sequences.  was computed using the program gd, which is also part of biobox.
Raw data and data analysisAt the time of our analysis, the Drosophila Population Genomics Project had released version 1.0 of its dataset. This contained the following 37 strains collected in Raleigh, NC, USA: RAL-301_1, RAL-303_1, RAL-304_1, RAL-306_1, RAL-307_2, RAL-313_1, RAL-315_1, RAL-324_1, RAL-335_2, RAL-357_1, RAL-358_1, RAL-360_1, RAL-3 62_2, RAL-365_1, RAL-375_1, RAL-379_1, RAL-380_2, RAL-391_2, RAL-399_1, RAL-427_1, RAL-437_1, RAL-486_1, RAL-514_1, RAL-517_1, RAL-555_1 , RAL-639_1, RAL-705_1, RAL-707, RAL-714_1, RAL-730_1, RAL-732_1, RAL-765_1, RAL-774_1, RAL-786_1, RAL-799_1, RAL-820_1, RAL-852_1. We downloaded the corresponding aligned sequence data from http://www.dpgp.org. For the comparison between D.simulans and D.sechellia, we used the data released as part of the 12 Drosophila species genome sequencing project () at: http://rana.lbl.gov/drosophila/caf1/all_caf1.tar.gz Tajima's D () was computed using a program by
RESULTSIn the following sections, we apply  m to simulated data with and without recombination and to two empirical datasets: 37 genomes of D.melanogaster and the genomes of the two closely related Drosophila species D.simulans and D.sechellia.
Simulations
Without recombinationWe started our exploration of the properties of  m by simulating pairs of 500 kb sequences with a fixed number of mismatches.shows that when the mutation rate is close to the inverse of the sequence length,  m overestimates , while for mutation rates >0.03 it underestimates . However, for population genetically relevant intermediate values of , the theory closely approximates the simulations.
With recombinationThe population recombination rate is expressed as  = 2N e c, where N e is the effective number of chromosomes in the population and c is the probability of a recombination affecting a given stretch of sequence per generation. As explained in Section 2,  m is based on the distances between pairs of mutations. Recombination causes these distances to deviate from uniformity (), which makes  m sensitive to recombination. In agreement with these theoretical considerations,shows that even low rates of reciprocal recombination lead to strong underestimation of  due to an 'excess' of long, young tracts of low diversity. This means that  m in its current form is not generally suitable as a global measure of the number of pairwise mismatches. However, as we demonstrate in the next paragraph, it is still useful as an indicator of local fluctuations in .
Sliding window analysisWe began our study of the local properties of  m with a sliding window analysis of one pair of 500 kb sequences without recombination. In, the average value of  m is 1.007  10 2 , which is close to the average value of , 1.001  10 2. In addition,  m closely tracks the true diversity (Pearson's correlation r = 0.76; root mean square error, Page: 452 449455
B.Haubold et al.
Genetic diversity in a sample of D.melanogasterWe carried out a sliding window analysis of  m along the five chromosomal arms of the 37 D.melanogaster strains contained in the sample from Raleigh, NC, USA. It is important to realize that in an alignment-free sliding window analysis sequence coordinates can only refer to a single query sequence. As a result, of the 37 2 possible pairwise comparisons only 36 comparisons between an anchor sequence and the other members of the sample can be carried out. We arbitrarily used the first sequence in the dataset, RAL-301_1, as this anchor query, but apart from numerical detail our results are unaffected by the choice of anchor sequence [see () for a more thorough discussion of shustring-based metrics].shows the distribution of the  m values compared with the corresponding  values computed from the aligned original dataset. As expected from, the two distributions clearly differ with  m having a meanSD of 0.00410.0001 and  a mean of 0.00560.0017. However, the tails of the two distributions are remarkably similar with almost identical ranges (0.00085   m  0.001,0.00097    0.001). In our subsequent analysis, we concentrated on the lower tail of the distribution and located the global minimum of  m at the telomeric tip of chromosome 3L ().diversity minimum with  m = 7.810 4 centered on nucleotide 199 799. Significantly, the lowest of the corresponding  values was exactly centered on the homologous region located using  m. We analyzed 5 kb around this point from all 37 strains and identified 37 segregating sites in the region. Of these, 31 were singletons. Since a completed selection event (selective sweep) is characterized by an excess of singletons, we quantified the deviation from neutrality by computing a statistic commonly used to test the null hypothesis of neutral evolution called Tajima's D, D T (). It is proportional to the difference between the average number of pairwise differences and the normalized number of SNPs in a sample of DNA sequences. Under neutrality, these two quantities are equal and hence the neutral expectation of D T is zero, while after a complete selective sweep D T is expected to be transiently negative.In our case, D T is significantly negative (D T =2.54;P = 0.00013). Since 9 of the 31 singletons were due to strain RAL-427_1, we recalculated D T in its absence and found a still significant value of D T =2.42 (P = 0.00045). The D.melanogaster genome sample is released in aligned form. This allowed us to check the accuracy of  m by comparison to its alignment-based analogue, . However, it does does not make a compelling case for alignment-free analysis and we therefore go on to demonstrate bona fide alignment-free genome comparison in the next section.
Page: 453 449455
Alignment-free diversity estimation
Comparison between D.simulans and D.sechelliaDrosophila simulans has diverged from D.sechellia for only approximately 1 million years (). In the Comparative Assembly Freeze 1 of the 12 Drosophila genome sequencing project, the genome of D.simulans was released in fully assembled form while the genome of D.sechellia consisted of 14 730 contigs. The combined size of these two datasets was 308 982 892 bp. We analyzed these data with D.simulans serving as query in a 150 kb sliding window analysis of divergence from D.sechellia. This took 22 min and 44 s on an AMD Opteron 2.3 GHz processor. In order to compare this to the time requirement of the equivalent alignment-based analysis, we aligned these two genomes using the fast genome aligner MUMmer () on the same machine, which took 1 h, 32 min, 42 s. Again, we focus our analysis of the sliding window scan on regions of exceptional similarity between the two genomes andshows the sliding window analysis for chromosome 2L, which contains the global minimum of  m at position 13 965 000. In contrast to the diversity minimum (), the divergence minimum is far from either the centromere or the telomere. In, we zoom into this region and show in addition to the 150 kb sliding windows 10 kb sliding windows, which reveal a number of conserved regions. The most highly conserved of these regions intersects with the protein-coding gene pickpocket (ppk), A Bwhich is involved in larval locomotion and development (). To investigate whether the D.sechellia 12 genomes ppk reference allele is typical for D.sechellia, we compared it to the allele from an unrelated D.sechellia line (SynA, provided by E. Earley and C. Jones). The nucleotide divergence between the two D.sechellia lines is 6.410 3 (14 unambiguous SNPs in a 2198 bp alignment), which is higher than expected for D.sechellia in general (), but is still much lower than typical of divergence between D.sechellia and D.simulans (). This confirms that there is no reason to suspect that the ppk allele we identified in the D.sechellia reference genome is the result of an assembly error.
DISCUSSIONMuch has recently been written about the impressive speed of next-generation sequencing equipment (), which is driving the current generalization of population genetics to population genomics (). However, technology change in sequence analysis algorithms has been equally remarkable. A substantial portion of these advances is based on the progressive abstraction of suffix trees () to enhanced suffix arrays () and, more recently, to highly memory efficient FM indexes ().
Page: 454 449455
B.Haubold et al.
ABHere we point out that the distances between SNPs can quickly be looked up using suffix tree and that these distances are connected to the number of mismatches by Equation (1). This suggests our new estimator of pairwise genetic diversity,  m , given in Equation (5). Our implementation of this estimator is based on an enhanced suffix array. The efficiency of the resulting software is best judged by comparing it to an alignment tool that uses the same data structure, such as MUMmer (). As we report in the Section 3, pim is four times faster than MUMmer when applied to the genomes of D.sechellia and D.simulans. This comparison ignores that the MUMmer result would still need to be processed to yield the desired diversity values. It should also be borne in mind that alignmentfree approaches are bound to outperform alignment-based methods as the latter need to carry out far more steps than the former. The important question about an alignment-free estimator such as  m is therefore how useful it is for quantifying genetic diversity in real genomes. We show through simulations that for mutation rates greater than the inverse of the sequence length and less than 0.03, our estimator is very precise (). This is the range of mutation rates relevant for analyzing genomes sampled from populations or closely related species. Recombination causes fluctuations in the time to the most recent common ancestor along a chromosome, which results in clustering of mutations (). As a consequence, the aggregate shustring length increases, which leads to an underestimation of  in the presence of even low levels of recombination () and for biologically relevant recombination rates (  ), the effect on  m is rather strong. While this makes  m unsuitable for the estimation of global  in recombining genomes, our sliding window analyses of simulated sequences demonstrate that  m accurately tracks local fluctuations in nucleotide diversity () and is reasonably robust to the choice of window length (Figs 6B and 7B; see also Supplementary Material). We have compared the results of our alignment-free estimator to the corresponding alignment-based measure wherever possible. The sequences published by the Drosophila Population Genomics Project allowed this comparison to be made for a substantial empirical dataset, as the newly released genomes are distributed aligned with respect to the reference genome. Such a comparison comfirms that  m tends on average to underestimate , while preserving the range of true diversity values (). However, there is a reassuring correspondence between the empirical distributions of  and  m () and the simulation with recombination (): we surmise that the regions where  m   are those of exceptionally low recombination, like the subtelomeres, and those of exceptionally high recombination. In between these two extremes,  m is less than  and in Section 2.2 we show that the difference between  and  m is determined by the degree to which the variance in inter-SNP distance (V) exceeds its theoretical minimum of 1/ 2. In agreement with this interpretation of our statistic, we correctly identified the global diversity minimum at the telomeric tip of chromosome 3L (). This region is also known to have reduced genetic diversity and recombination in D.simulans (). The region of lowest diversity intersects the gene Enhancer of bithorax, E(bx) (). Not only is this gene among the most monomorphic in the genome, it also contains a significant excess of rare mutations, as expressed by the highly significant rejection of the standard neutral model (P = 0.00013). Our interspecific genome comparison identified a highly conserved gene (ppk), which may be closely tied to a behavioral peculiarity of D.sechellia: on its native islands, the Sychelles, it feeds on the toxic fruit of the non-native Indian mulberry (Morinda citrifolia), while its sister species D.simulans and most other fruit files avoid this plant (). It is therefore likely that D.sechellia has recently undergone a shift in its breeding environment (). This biological background makes it intriguing that the region that is most similar between D.sechellia and D.simulans, and is thus a candidate for recent introgression, contains a gene that affects larval foraging behavior. Population genomics projects tend to be based on a well-curated reference genome that serves as the subject sequence to which new reads are aligned. This is certainly the approach of the Drosophila Population Genomics Project. Given such data, there might appear to be no case for alignment-free methods when dealing with samples of genomes drawn from closely related individuals. However, resequencing is often only a first step on the way toward full de novo assembly. Moreover, our divergence scan of D.simulans versus D.sechellia shows that unaligned genomes from closely related species can be compared efficiently and used to rapidly identify diversity outliers for further investigation. There are many such Page: 455 449455
Alignment-free diversity estimationgenome pairs both among eukaryotes and bacteria, and given the current rate of sequencing, this number is set to increase.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
