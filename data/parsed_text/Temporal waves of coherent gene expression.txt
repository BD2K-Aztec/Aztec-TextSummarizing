Motivation: Animal development depends on localized patterns of gene expression. Whole-genome methods permit the global identification of differential expression patterns. However, most gene-expression-clustering methods focus on the analysis of entire expression profiles, rather than temporal segments or time windows. Results: In the current study, local clustering of temporal time windows was applied to developing embryos of the fruitfly, Drosophila melanogaster. Large-scale developmental events, involving temporal activation of hundreds of genes, were identified as discrete gene clusters. The time-duration analysis revealed six temporal waves of coherent gene expression during Drosophila embryogenesis. The most powerful expression waves preceded major morphogenetic movements, such as germ band elongation and dorsal closure. These waves of gene expression coincide with the inhibition of maternal transcripts during early development, the specification of ectoderm, differentiation of the nervous system, differentiation of the digestive tract, deposition of the larval cuticle and the reorganization of the cytoskeleton during global morphogenetic events. We discuss the implications of these findings with respect to the gene regulatory networks governing Drosophila development. Availability: Data and software are available from the UC Berkeley web resource
INTRODUCTIONDrosophila embryogenesis has been divided into 17 separate stages, each stage marked by global changes of embryo morphology, such as cellularization, gastrulation, germ band elongation (GBE), germ band retraction (GBR) or dorsal closure (DC). Different parts of an embryo might undergo simultaneous morphological changes. Parallel developmental events, such as DC and head involution, might begin at the same time (stages 1415), but terminate at different stages. Based on the time and the duration parameters, * To whom correspondence should be addressed. the parallel events can be mapped to a 2D parameter space and separated. Thus, parallel and temporally overlapping events can be separated and analyzed (locally) with respect to distinct time and duration parameters. These parameters are convenient for the classification of peaks of gene expression observed in the global time series data. Presence of temporal peaks of expression with similar time/duration properties might indicate a functional link between genes, even if the genes' expression profiles are not similar. Complete expression data have been obtained for the entire developmental time course of Drosophila melanogaster using both expression () and tiling microarrays (). Previous analyses of these datasets have shown that the vast majority of genes exhibit at least 4-fold expression changes during embryogenesis () and most genes have two or more major temporal peaks of expression during the life cycle. Such reengagement of genes and gene networks has recently been demonstrated during the development of the mosquito embryo, Anopheles gambiae (D.Papatsenko, M.Levine and U.Goltsev, personal communication). These studies suggest that morphologically distinct and temporally separated developmental events, such as formation of the serosa and cuticle, depend on the deployment of coherent gene batteries. A recent study by Hooper and co-workers (2007) identified a number of time points during fly development when clusters of genes coherently change their expression levels. Using an approach initially introduced for the analysis of development in Dictyostelium (), Hooper and co-workers have identified several coherently switching classes of genes in Drosophila, including maternal (off switch), activated (on switch) and transient (peak) expression types. This clustering strategy () relies on local similarities (coherent on/off switches) in the global expression data. The time-duration analysis of fly development described in this study represents an unsupervised learning algorithm [a supervised method was introduced earlier (, similar to the temporal-clustering method implemented by Hooper and co-workers (2007). Technically, the method can be classified as a query-driven, local clustering of time series expression data (). In this study, the search patterns (queries) were temporal sequences corresponding to two major types of gene activity: 'peak' (transient type) and 'switch' (activated type). The search patterns were matched to the expression profiles locally (time windows), in orderPage: 2732 27312736
I.Papatsenko et al.to retrieve genes with locally coherent patterns of expression. The duration parameter was incorporated by scaling each search pattern to a range of time windows. This method identified nearly a dozen distinct, large-scale developmental events during Drosophila embryogenesis, each involving coherent expression of hundreds of genes. Based on gene annotation enrichment, many of the identified events were attributed to known morphological changes, such as formation of the nervous system, digestive tract, deposition of cuticle or reorganization of the cytoskeleton during morphogenetic movements. This method successfully identified discrete temporal events from global time-series expression data. The approach can be applied to the analysis of a variety of dynamic biological processes.
METHODS
Microarray data and data treatmentTime-series data for the Drosophila developmental course was taken from thestudy. Low-level microarray data treatment involved standard quintile normalization of microarrays () and Z-score normalization of time points (). Microarray data were filtered based on variation between biological triplicate's points using standard ANOVA analysis with very mild thresholds (P < 0.05). These procedures produced 7052 gene expression profiles. Finally, the data has been upsampled to 100 points and smoothed using Gaussian filter with standard deviation equal to 5 points (after upsampling).
Local clustering algorithmThe algorithm inputs included a query pattern (sequence of values) and a time-series data. The query patterns were rescaled (resampled and smoothed) to a range 550% with respect to the number of time points in the input time series data (duration parameter j) and then matched to every time window of the microarray data set A. Pearson correlation r and standard deviation  were calculated for every window position in every gene expression profile. In the next step, for each expression profile and each combination of time i and duration j parameters, a matching score S was calculated as:In this formula, the parameter h captures relative amplitude of the signals (i.e. peaks). For h = 0.5 (selected in the case of peak matching), only the highest 50% of all peaks were considered for a given window size j. The h = 0.9 (highest 10%) has been selected for the 'switch' query pattern. Correlation values (r) were translated to conditional P-values in order to obtain scores, which were comparable for different values of the duration j (window sizes). Parameter  is a pseudocount limiting maximal value of the score S ( = 0.0001 in this study).Clusters were identified as local peaks on the time/duration parameter space, in other wordsparameter combinations that produced a large number of genes with scores S above an arbitrarily chosen score cutoff (S = 1). Genes, producing S > 1 were extracted from each cluster and annotated. Notice that this procedure returns overlapping clusters as any part of a given temporal expression profile can be associated with different clusters.
Annotation term enrichment analysisGO slim version of gene annotations (), containing terms related to protein function and biochemistry and so-called 'controlled vocabulary (CV)' annotations describing morphological parts of fly embryo were used in this study (). The enrichment analysis was performed using custom software 'GO-piper' (available upon request), based on using binomial statistics to calculate term enrichment. The P-values were adjusted using multiple test correction (correction Bonferroni).Page: 2733 27312736
RESULTS
Biological assumptions and selection of input search patterns
Temporal waves of coherent gene expressionof embryogenesis) than other similar datasets (). Whole-genome tiling array datasets have much lower noise levels, but include fewer time points (12 time points for 24 h) (J.R.Manak, time-series tiling array expression data, personal communication, 2005). Comparison of the datasets shows that time resolution is critical for time-duration analyses (Supplementary). The unreliable profiles can be removed based on their ANOVA P-values, while the information in the missing time points could not be recovered even by the use of data interpolation methods. Side by side comparisons of gene expression profiles from the expression and tiling array data indicate that the tiling arrays capture no more than 1 data point per event (peak) lasting 24 h, while the expression array data captures up to 3-4 points for the same event. Alternative methods of handling the input data were also investigated. Performance of the time-duration analysis has been tested on both normalized data and smoothed data. Upsampling (linear interpolation, see Section 2) and Gaussian smoothing parameters were selected in order to remove noise, corresponding to point-by-point variation. This noise filtering increased the resolution and revealed more events (clusters) in the expression array data (Supplementary).shows the results of the time-duration analysis applied to the normalized and upsampled/smoothed Drosophila expression array data (). Altogether, the four search patterns (peak, switch and their reversed variants) identified 45 distinctive temporal clusters of genes, with the largest clusters containing up to 1300 genes and the smallest clusters containing 100 genes; the majority of clusters contain 400500 genes. Certain clusters exhibit extensive overlaps (Supplementary), and are presumably engaged in the same developmental processes (Supplementaryand E). For this reason, the actual number of the identified events was estimated to be lower (1520 events) than the total number of distinctive clusters. Out of 7052 profiles in the input dataset, 3128 (44%) were shared by three or more clusters, 1295 (18%) were shared by two clusters, 1239 (17.5%) profiles were not shared (unique) and 1390 (20%) profiles were not present in any cluster. As expected, the time-duration analysis allowed clear discrimination of slow and fast events (compare clusters #6 and #7 in). Annotation term enrichment analysis was used to determine the biological function shared by genes in each cluster (van den). Two types of annotations were used: Gene Ontology (GO-slim) () and Drosophila CV for morphological parts of the embryo (). GO-slim terms associated with genes indicate their biochemical functions, while CV terms identify embryonic tissues in which the genes are expressed (expression patterns). Most of the gene clusters contain specific classes of enrichment in the GO and CV terms (Supplementary). A strong agreement has been found between the temporal sequence of known developmental events and the timing of events associated with the identified clusters. For instance, the CV term 'maternal' has been enriched in cluster #1 (), containing genes expressed at the beginning of embryogenesis. CV terms 'Dorsal ectoderm' and 'Pairrule' were enriched in cluster #4, with the peak time of expression at3.8 h, while GO term 'cuticle' and CV terms including 'epidermis' were enriched in cluster #13 with a peak of expression at 18 h. The relevant temporal sequence of events predicted by the analysis, along with the enriched annotation terms, suggested that the identified clusters coincide with many of the key developmental processes taking place during fly embryogenesis. Examples of expression profiles and the corresponding gene expression patterns are shown in Supplementary. Detailed description of each cluster and lists of genes are available from the UCB online resource.
Identified clusters reflect temporal sequence of known developmental events
Time-duration analysis and conventional clustering methodsThe results of local time-duration cluster analysis were compared with more conventional clustering methods-hierarchical clustering, k-means clustering () and Principal Component Analysis (PCA) (). Conventional clustering was carried out using Cluster 3.0 program with the default parameter settings (). Supplementaryshows that hierarchical,
I.Papatsenko et al.common processes, such as maternal genes and cuticle/epidermis genes. In some cases, the different methods produce gene clusters that share >50% of the expression profiles (Supplementary). Annotation enrichment levels were comparable for all three clustering methods using GO and CV annotation (Supplementary). However, a distinctive feature of the local method was its ability to retrieve pure local components of gene expression, matching the search patterns. For example, a major component of cluster #9 (see the arrow in Supplementary) is also present in clusters produced by the other methods (clusters #1 and #6, Supplementary), but in these latter clusters contain additional signals as well. Sensitivity and selectivity of different clustering methods were compared based on their receiver operating characteristics (ROC space, see Supplementary). The local time duration clustering method consistently produced lower false-positive rates and somewhat lower true positive rates than the other two methods. The most striking difference is observed for 'maternal' gene clusters (Supplementary). 97% of all genes in cluster #17 (Supplementary) are associated with this term, although a large fraction was lost due to the lower sensitivity of this method. Each clustering method produced a list of enriched annotation terms not found or poorly enriched by the other two methods. Some interesting terms, such as 'pair rule' (CV, id = 262) or 'neuroblasts of ventral nervous system' (CV, id = 172) were selectively enriched by the local clustering method (Supplementary). The results of local clustering were also compared with the results of PCA (Supplementary). Interestingly, the first four principal components (PC1PC4) were quite similar to some of the local clusters, but the fifth component and additional components are quite distinct (Supplementary). As in the case with the hierarchical and the k-means clustering, PCA failed to retrieve the local signals, such as the signal in the largest cluster #9, produced by local clustering (Supplementary). Benchmarking tests based on annotation term enrichment have shown that the local time-duration clustering method performed nearly as well as the conventional clustering methods. A distinctive feature of the local clustering was its ability to retrieve local signals, matching the search patterns, such as the peaks corresponding to clusters #6, #7 or #9. Technical differences among the different clustering methods are summarized in the Supplementary.
Coherent waves of gene expression often precede major morphogenetic eventsTemporal clusters of gene expression might be linked to changes in embryo morphology. The most dramatic morphological changes include gastrulation, germ band extension (GBE), GBR and DC. To investigate the possible connection between these processes and coherent waves of gene expression, the average values of expression for the largest local clusters (average profiles) were superimposed on a timescale of major morphogenetic events (). The most extensive gene clusters do not coincide with morphogenesis, but rather, they occur either before or after these events. For instance, the maternal genes (cluster #1) have a peak of expression before gastrulation and GBE, ectodermal genes (cluster #6) peak between GBE and GBR, and brain-related genes between GBE and DC(cluster #7) (). Thus, gene expression waves appear to be linked to major morphogenetic events. For instance, GBE separates the maternal wave of expression from the wave associated with the specification of the nervous system (). Similarly, DC separates the gene cluster associated with the nervous system from those associated with the differentiation of the epidermis (). Many of the coherent gene expression waves identified in this study have been observed previously. Thus, Class IIa transcripts reported by Hooper and co-workers (2007) correspond to clusters #7 and #43 in this study. Shutdown of class IIa expression coincides with the activation of classes IIb and IIIa, which is consistent with co-temporal shutdown of the neural genes (cluster #43) and activation of epidermal genes (cluster #34) (). Classes of transcripts corresponding to local clusters #6 (ectoderm) and #9 (digestive tract) identified in this study were not previously reported. There is a lag between the timing of coherent expression waves and morphogenetic movements. This lag is consistent with a stepwise mechanism of embryogenesis, whereby tissue specification precedes morphogenetic movements. Specific examples have been extensively documented in the literature, including mesoderm specification followed by invagination of the ventral furrow during gastrulation (). Tissue specification coincides with the deployment of extensive gene networks.
Page: 2735 27312736
Temporal waves of coherent gene expression
Re-engagement of genes and gene networks in embryogenesisSome genes have multiple peaks of expression during embryogenesis. Such re-engagement of gene batteries has been previously reported (). For instance, many 'maternal' genes are shut down at 3 h (stage 6), but are reactivated by 4.5 h (after GBE, stage 10). Some of these 'maternal' genes are shut down again at 8 h and activated again at 11 h (after GBR, stage 14). Every time, such 'maternal' expression coincides with other waves of gene expression, associated with different developmental events (compareand B). However, the annotation term 'maternal' is significantly enriched only in the earliest peak of expression (). This suggests that the fraction of 'maternal' genes in the later peaks of expression is significantly smaller. Multiple engagements have been detected in the case of genes associated with the term 'brain' (), while the 'brain' genes were significantly enriched only in one temporal cluster (cluster #7,). Altogether, (see more examples in Supplementary) these observations suggest that similar, but not identical gene networks participate in distinct events. Known association of the same CV annotation terms with many genes tested by in situ hybridization supports this view (). There are also examples of gene clusters with a single engagement during embryogenesis. For example, most genes associated with the GO term 'cuticle' had only one peak of expression () and this peak occurs late in embryogenesis, just before the secretion of the larval cuticle (). Interestingly, in the mosquito, A.gambiae, these genes are engaged twice in development due to the secretion of a serosal cuticle at earlier stages of development; this cuticle is absent in Drosophila (). Examples of genes with multiple peaks of expression were retrieved as profiles shared by clusters #7, #16 (86 genes) and the profiles shared by clusters #6, #9, #16 (30 genes). The profiles shared by the maternal (#16) and the neural (#7) clusters contained genes associated with DNA replication (Supplementary). Early expression of these genes may correspond to pre-blastoderm mitotic cycles 19 and blastoderm cycles 1013. The pause in expression seen at 3 h coincides with cellularization. The second peak in expression occurs during the time when mitotic cycles are reinstated during gastrulation. Genes shared by three local clusters (#6, #9, #16, three engagements) were associated with multiple GO/CV terms and had multiple functions (pleiotropic genes). For instance, Daughterless (da) (Supplementary) is a class I HLH protein that forms heterodimers with class II HLH proteins to activate transcription (). Daughterless has both maternal and zygotic functions, including sex determination, neurogenesis, and the growth of imaginal discs (). Pellino (pli) family proteins are regulators of kinase activity, components of the Toll and Toll-like receptor signaling pathways (). In Drosophila, Toll-receptor signaling is involved in dorsal-ventral patterning () and the innate immune response (). The gene pelota (pelo) is required for the progression of the cell cycle (), and for maintenance and self-renewal of germline stem cells (). The gene shark (Supplementary) is a tyrosine kinase that regulates the c-Jun N-terminal kinase (JNK) pathway (). This pathway influences a number of developmental processes, including DC ().
Gene networks involved into cell motility and morphogenesisWhile the most extensive waves of coherent gene expression were observed in the time intervals separating major morphogenetic events, two waves, containing relatively few genes, were observed at the time of GBE (cluster #3) and DC (cluster #10). Genes expressed during these morphogenetic movements might be expected to play a role in the reorganization of the cytoskeleton and regulation of actin polymerization. Indeed, cdc42 exhibits peak expression at the time of both GBE and DC (Supplementary). It encodes a GTPase involved in the regulation of actin filament polymerization. Major morphogenetic events, such as GBE and DC involve large-scale reshaping of cells and cell movements. Neurotactin (Nrt) and Ecdysone-induced protein 28/29kD (Eip71CD) were among other genes expressed at the time of GBE and DC (Supplementary). Both genes are expressed in invaginating mesodermal cells (Supplementary, G and H), while Eip71C is expressed in the dorsal epidermis during DC (Supplementary). Presumably, Eip71C (Ecdysoneinduced protein 28/29kD) is downstream of EcR, a receptor for Ecdysone that regulates many morphogenetic events, including DC, cuticle synthesis, and molting (). Another component of ecdysone signaling, ecdysonless (ecd) () also peaks at the time of GBE and DC.
Page: 2736 27312736
I.Papatsenko et al.
CONCLUSIONSThe application of time-duration analysis to Drosophila embryogenesis identified a link between coherent waves of gene expression and specific morphogenetic processes such as GBE and DC. We also presented evidence that the re-engagement of pleiotropic genes is associated with common features of these different processes, such as reorganization of the cytoskeleton. We suggest that local clustering analysis can be used to supplement conventional clustering methods, such as hierarchical or k-means clustering.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 2731 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Previous analyses of fly and mosquito embryogenesis pointed to the presence of temporally local characteristic patterns of gene activity, such as on/off switches (activation/repression type) (Hooper et al., 2007) and peaks of expression (transient type) (Goltsev et al., 2009). These features are shared by many genes that are coherently expressed at certain time intervals. It is reasonable to assume that such coherent expression profiles might precede or coincide with major morphogenetic events. Perhaps, such a straightforward 1D interpretation of the time-series data is too simplistic as there are unrelated, parallel developmental events that overlap in time (e.g. DC and head involution). The application of both time and duration parameters should help resolve such developmental events (including parallel events) and provide a clear foundation for functional analysis. In theory, any type of temporal expression pattern can be of interest; in this study, however, the search patterns for the timeduration analysis were limited by the two previously described types: local on/off switches and transient peaks of gene expression. The peaks and the switches also represent one of the simplest possible and biologically reasonable temporal expression patterns. The particular shapes of the search patterns were adapted to the format of the time series data. In this study, the original data have been upsampled and smoothed using a Gaussian filter, in order to minimize measurement errors for the neighboring time points (see Section 2). Therefore, Gaussian shapes were accepted for the selected input search patterns (peaks and switches) and all their scaling variants (Supplementary Fig. S1). The upsampling step (linear interpolation) changed the number of time points in the dataset by inserting additional time points between the original ones (20:100), thus preventing information loss during the consequent data treatment. 3.2 Resolution limits and selection of input time-series data Developmental gene networks can include hundreds of genes, comprising 1% or more of the entire Drosophila genome. These considerations dictate sensitivity limits for the time-duration analysis. To test whether these limits are met, an artificial temporal data set was generated, containing 10 000 random temporal profiles. Coherent signals (peak type) with defined start time and duration time were introduced in some of the profiles from the simulated dataset. In this benchmarking test, the method demonstrated reliable detection of signals, introduced into 100 profiles (1% of total, see Supplementary Fig. S2). It was possible to achieve even better sensitivity when the introduced signals were highly coherent. Sensitivity of the time-duration analysis also depends on the type of input data. There are several global time-series expression datasets currently available for Drosophila embryogenesis. One such dataset was generated using expression arrays (Hooper et al., 2007). It has rather high levels of noise (higher ANOVA P-values, see Section 2), but contained more time points (30 time points for 24 h
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
