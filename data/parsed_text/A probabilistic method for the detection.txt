Motivation: High-throughput sequencing technologies have made population-scale studies of human genetic variation possible. Accurate and comprehensive detection of DNA sequence variants is crucial for the success of these studies. Small insertions and deletions represent the second most frequent class of variation in the human genome after single nucleotide polymorphisms (SNPs). Although several alignment tools for the gapped alignment of sequence reads to a reference genome are available, computational methods for discriminating indels from sequencing errors and genotyping indels directly from sequence reads are needed. Results: We describe a probabilistic method for the accurate detection and genotyping of short indels from population-scale sequence data. In this approach, aligned sequence reads from a population of individuals are used to automatically account for context-specific sequencing errors associated with indels. We applied this approach to population sequence datasets from the 1000 Genomes exon pilot project generated using the Roche 454 and Illumina sequencing platforms, and were able to detect a significantly greater number of indels than reported previously. Comparison to indels identified in the 1000 Genomes pilot project demonstrated the sensitivity of our method. The consistency in the number of indels and the fraction of indels whose length is a multiple of three across different human populations and two different sequencing platforms indicated that our method has a low false discovery rate. Finally, the method represents a general approach for the detection and genotyping of small-scale DNA sequence variants for population-scale sequencing projects.
INTRODUCTIONSmall insertions and deletions (150 bp) represent the second most frequent class of variation in the human genome after single nucleotide polymorphisms (SNPs). Although indels exhibit greater potential to disrupt functional elements than SNPs, indels have * To whom correspondence should be addressed. been characterized to a significantly lesser extent, and are greatly underrepresented in public variation databases. There are two main reasons for this: (i) SNPs are more abundant in the genome and are easier to genotype using arrays and (ii) indels are more difficult to detect reliably using sequencing data. Sequencing of the first individual genome using the Sanger method bydemonstrated that short indels are frequent in the human genome. Previously,performed a populationscale characterization of short indels in the human genome by resequencing 330 genes in 47 individuals using the Sanger method.generated a genome-wide map of indels by analyzing Sanger resequencing data. In recent years, several highthroughput DNA sequencing technologies have emerged that are able to generate gigabases of DNA sequence data in a single instrument run. These next-generation sequencing (NGS) methods offer greater potential to detect indels compared with Sanger sequencing since each allele is sequenced independently multiple times. Indeed, whole-genome shotgun sequencing of several individuals using high-throughput platforms has demonstrated the presence of several hundred thousands of short indel variants per genome (). Indels can be identified from sequence reads by performing gapped alignment of reads to a reference sequence. Several alignment tools developed for next-generation sequencing data allow gapped alignments () [seefor a survey of. After reads have been aligned, the presence of multiple reads that support the same insertion/deletion event can be used to call indels. However, it can often be challenging to identify moderately long indels from short sequence reads since each read is aligned independently to the reference genome. Further, reads that span an indel event close to the ends of a read are difficult to align with gaps and can potentially be misaligned resulting in false SNPs (). The problem of misaligned reads can be alleviated by locally realigning reads using information from reads that are informative about the presence of an indel. Many tools for doing local realignment of short reads have recently been developed (). Once reads have been aligned to a reference sequence as accurately as possible, the next challenge is to distinguish true indels from sequencing errors and alignment artifacts. Several methods have been developed to detect single nucleotide variants using sequence data generated from individual genomes and
V.Bansal and O.Libigersuccessfully applied to identify millions of SNPs from wholegenome sequencing projects (). Most of these methods utilize the base quality values for each individual base-call within a Bayesian framework to calculate the likelihood of an individual being heterozygous or homozygous for a variant allele at each site. Distinguishing true indels from sequencing errors is difficult since there are no accurate sequencing error models for indel errors. For example, base qualities for Illumina reads represent the accuracy of each individual base call but are not informative about indel errors. It is well known that insertion/deletion errors are dependent on the local sequence context, e.g. the 454/Roche sequencing platform is prone to sequencing errors in homopolymer runs (). The Illumina sequencing-by-synthesis technology reads individual bases in each sequencing cycle and is, therefore, less susceptible to insertion/deletion errors. However, non-sequencing artifacts such as polymerase slippage during PCR amplification of DNA molecules can result in insertion/deletion sequencing errors in homopolymer stretches as well as microsatellites (). DNA insertion/deletion polymorphisms are known to be more frequent in such regions for primarily the same reason. Recently,developed a Bayesian method called Dindel to detect indels from short read sequence data generated using the Illumina sequencing platform. Dindel uses a probabilistic realignment model along with estimates of indel error rates from the 1000 Genomes project to distinguish indels from sequencing errors. Accurately detecting indels from NGS data while accounting for indel errors that are dependent on the local sequence context and the sequencing platform remains difficult. In this article, we describe a probabilistic method that leverages sequence reads from a population of diploid individuals (sequenced using the same sequencing platform) to accurately detect indel variants. Highthroughput sequencing technologies are increasingly being used for sequencing the genomes of populations of individuals with the goal of identifying rare and common DNA sequence variants. The availability of population-scale sequence data not only poses new challenges for variant detection methods, but also creates opportunities for the development of new approaches to variant detection. For indel detection, we reasoned that given aligned sequence reads from a population of individuals at any given site: (i) the context-specific sequencing error rate should be similar across all individuals; (ii) individuals who are homozygous for the reference allele should be informative about the average sequencing error rate; and (iii) for individuals who carry one or two copies of the variant allele, the fraction of the reads that support the variant allele should be significantly greater than the background sequencing error rate. We model the unknown sequencing error rate and the population genotypes at each position and calculate the likelihood of the population sequence data conditional on the population genotypes by integrating over the error rate. To quantify the evidence for the presence of a variant allele at a position, we compare the likelihood of the most likely genotype configuration in the presence of a variant allele with the population likelihood in the absence of a variant allele, i.e. when all individuals are homozygous for the reference allele. Positions for which this likelihood ratio is above a threshold are identified as variant sites. Additionally, information about the distribution of reads on the forward and reverse strands is used by modeling the sequencing error rates independently to further improve the accuracy of detecting variants. Unlike previous methods for indel detection, our method does not require prior knowledge of context-specific indel error rates and is applicable to population sequence data from different sequencing platforms. To demonstrate the accuracy of our method, we utilize population sequencing datasets generated by exon sequencing in the 1000 Genomes project using the Roche 454 and Illumina sequencing platforms. Across 7 population sequencing datasets, our method identified 261 distinct indels, significantly greater than the number of indels reported in the 1000 Genomes project variant calls (). Comparison of our indel calls to indels identified in the 1000 Genomes project demonstrated a high sensitivity of 95100% across different populations. Analysis of the distribution of lengths of indels revealed an excess of indels whose length is a multiple of 3 (3n) across multiple populations and the two sequencing platforms. This increased frequency of 3n indels and the consistency in the number of indels detected across multiple populations and two different sequencing platforms suggest that our method has good specificity.
METHODSShort indels can be detected by performing gapped alignments of reads to a reference sequence and various tools for doing this are available. Most alignment methods align each read independently to the reference sequence. The presence of multiple reads supporting the same insertion/deletion variant can be used to distinguish real indels from sequencing and alignment artifacts. However, reads that contain an indel (with respect to the reference sequence) near the beginning or the end of the read are typically aligned without gaps resulting in alignments with multiple mismatches. To improve the alignment of reads that span indels, one could use a realignment method to improve the initial alignment with respect to indels. Realignment of reads can make a significant difference in the subsequent detection of indels for short read sequence data but is likely to be less important for longer reads. Our objective is to utilize aligned sequence reads from a population of individuals to identify sites that harbor an insertion/deletion variant. Therefore, we assume that the reads for each individual have been aligned to the corresponding reference sequence as accurately as possible.
Probabilistic model for population indel detectionWe consider a set of genomic loci that have been resequenced in a population of n diploid individuals. Our objective is to identify positions in the sequenced region for which at least one of the 2n haplotypes harbors an insertion/deletion of one or more bases. For each site, we denote the reference allele by A 0 and the alternate allele A 1. If there are multiple potential variant alleles, we evaluate each allele individually. Given aligned sequence data from n individuals, we denote the ordered set of population genotypes by. Assuming two alleles, A 0 and A 1 , we denote the three possible genotypes as (A 0 A 0 ),(A 0 A 1 ) and (A 1 A 1 ). In the absence of a variant allele,the genotype configuration in which each individual is homozygous for the allele A 0. Similarly, we define. The aligned sequence reads for all individuals at each site represent the observed datais the set of aligned reads that cover the given site for individual i. Given the population sequence data D at each position in the genome, we can write Pr(
Detection of indels for population-scale sequencing dataWe define a likelihood ratio statistic as the ratio of the likelihood in the presence of a variant to the likelihood in the absence of a variant:In order to compute the likelihood ratio statistic, we need to define the conditional probabilities Pr(D|G ) and the prior probability Pr(G ) for each genotype configuration G. If base quality values or sequencing error probabilities for each base-call are available, we can calculate the conditional genotype probabilities using these sequencing error probabilities (see e.g.). However, for indels, such error rates are typically not available. In order to compute the conditional likelihoods, we introduce the parameter e 01 which corresponds to the probability of (incorrectly) reading the reference allele A 0 as the alternate allele A 1. One can think of this parameter as the average context-specific sequencing error rate at this particular position. For example, in a homopolymer run of 4 'T's where the alternate allele is 'TTT', this parameter would represent the probability of reading the reference allele 'TTTT' as 'TTT' due to sequencing errors. Similarly, we define the parameter, e 10 as the probability of reading the allele A 1 as the reference allele A 0 due to sequencing errors. If all individuals have been sequenced using the same sequencing platform, the context-specific sequencing error rate is expected to be similar from individual to individual. To calculate the conditional likelihoods, we integrate over the unknown sequencing error rates as follows:where e = (e 01 ,e 10 ), (e|G ) is the prior distribution of the sequencing error rates given the population genotype vector G and the integral is a double integral over the two variables e 01 and e 10 (0  e 01  1 and 0  e 10  1). Since the sequencing error rates are independent of the presence of a variant, we can write (e|G ) = (e) = (e 01 )(e 10 ). Further, since sequence reads for each individual only affect the genotypes for that individual, we can writeNext, we describe how to calculate the conditional likelihood Pr(D i |G i ,e) for an individual.
Conditional likelihoods for an individualConsider the set of reads D i covering a site in an individual i. We summarize the data as r i0 and r i1 , the number of reads that support the two alleles A 0 and A 1 , respectively. For a diploid individual, we consider the likelihoods for the three genotypes:). Assuming independence between sequencing errors from multiple reads, we can define the conditional probabilities for the three genotypes as:where h is the probability that an aligned read was sampled from the chromosome with the reference allele and h = h(1e 01 ) + (1h)e 10 is the probability of observing a read with the A 0 allele given the genotype). For SNPs, it is reasonable to assume equal probability of sampling the two chromosomes, i.e. h = 0.5. For indels, especially for long indels, reads that cover the insertion/deletion variant near the start or the end of the read are likely to be misaligned or not aligned. To account for this bias in favor of observing the reference allele, we set h = 0.5 + where is estimated using the length of the variant allele and the average length of sequence reads (see Supplementary Material for details).
Conditional data likelihoods for population of individualsNow that we have defined the conditional likelihoods for each individual, we can calculate the probability of the population data D conditional on a population genotype vector. For G = G 0 , G i = (A 0 A 0 ) for all individuals and from Equation (3) we have:To calculate Pr(D|G 0 ), we need to integrate the above expression as defined in Equation (2). Since, the expression does not depend on the variable e 10 , the integral reduces toFor the error rate e 01 , we choose a beta prior with parameters  and .and the integral can be written asFor G = G 0 , the integrand involves both parameters e 01 and e 10 and it is infeasible to evaluate the integral analytically. Therefore, we approximate it numerically by summing the value of the integrand over a 2D grid (see Supplementary material for details of the numerical integration and accuracy of the approximation). For a given genotype G, the conditional likelihood
Modeling strand-specific sequencing errorsSystematic sequencing errors, such as those that depend on the local sequence context, are likely to be strand specific, i.e. overrepresented on one of the two strands. Since the local sequence context on the two strands is different, we model the sequencing error rates on each strand using independent parameters. Therefore, we can rewrite Equation (2) as:where D f represents the sequence reads for the population of individuals that align to the forward (+) strand and D r represents the set of sequence reads aligned to the reverse () strand. Also,) f ) represents the sequencing error rates on the forward strand and e r represents the error rates on the reverse strand. Since the sequencing error rates on one strand do not affect the conditional likelihood for the reads on the other strand, the above integral can be written as the product of two conditional likelihoods, one for each strand:Each of the two stranded conditional likelihoods can be calculated as before by using the data for the corresponding strand and integrating over the
V.Bansal and O.Libigerstrand-specific error rates. Later, we show how the strand-specific conditional likelihoods can be used to filter out false variants for which virtually all the evidence for the presence of a variant allele is present on the reads from one strand.have also demonstrated the utility of a strand-based filter to substantially reduce the number of false positive variants in analysis of mitochondrial DNA sequencing data.
Prior probabilities for population genotypesGiven a genotype configurationfor n individuals, we want to calculate Pr(G), the prior probability of the genotype configuration. Let n 1 be the number of A 1 alleles in the genotype G and Pr(n 1 ) be the probability of observing n 1 alleles of type A 1 in a sample of n diploid individuals. Let  be the population-scaled mutation rate. Using the allele frequency spectrum of a neutrally evolving population under the standard coalescent (), we can write (see also):For a genotype configuration G, let n 00 , n 01 and n 11 be the number of individuals with genotypesUnder the assumption of HardyWeinberg equilibrium, the probability of observing n 01 heterozygotes in a sample of n diploid individuals with n 1 A 1 alleles is [see Equation (1) (Since there are n n 00 n 01 n 11 distinct genotype vectors with n 01 heterozygotes, the probability of each such genotype vector is:
Calculating likelihood ratio statisticFor each potential variant site, we want to evaluate the likelihood ratio defined in Equation (1). Using Equations (9) and (10), we can calculate the prior probability for any genotype G. The conditional likelihood Pr(D|G 0 ) for the reference genotype G 0 can also be calculated analytically using Equation (7). However, the numerator involves summing over the conditional likelihoods for an exponential number of possible genotypes. Further, calculating the conditional likelihood for an individual genotype is computationally expensive since it involves a numerical integration over two variables. To avoid summing over a large number of genotypes, we assume that the posterior genotype likelihood is concentrated around the most likely genotype configuration. Therefore, we can approximate the sum by max G Pr(D|G )Pr(G ). This is a reasonable approximation if each sample has sufficient sequence coverage but could reduce the power to detect variants when coverage is low. In order to determine the genotype configuration G max for which Pr(D|G )Pr(G ) is maximum, we use a simple greedy algorithm where we start from an initial genotype configuration and iteratively update the genotype configuration until the genotype likelihood can be increased. Sites for which the likelihood ratio statistic is above a threshold are identified as candidate variants. To filter out potentially false variants for which the evidence for the presence of a variant allele is strand specific, we compute the ratiosfor the forward and reverse strands. Variants for which either of the two ratios is less than 1 are likely artifacts of strand-specific sequencing errors.
Algorithm for population indel detection and genotyping (piCALL):(1) For each position and each potential variant allele:(a) determine the allele counts for each individual i for the two alleles A 0 and A 1 and the two strands(b) Compute an inital genotype configuration G start by calculating the posterior genotype likelihoods Pr(d) while updates > 0:(f) if LLR >= thresh:@BULLET if strandfilter > 0.5: output variant
RESULTS
Sequence data from 1000 Genomes projectWe assessed the performance of piCALL using population sequencing data generated by the 1000 Genomes project (exon sequencing) (). In this project, 8140 exons from 906 randomly selected genes were captured using multiple target capture technologies and subsequently sequenced at high coverage using the Roche 454 and Illumina GA sequencing platforms in 697 individuals. We utilized a subset of the sequence data from individuals of European (CEU), East Asian (CHB and CHD), and African (YRI) ancestry. For each individual, we downloaded aligned sequence reads (in BAM format) from the 1000 Genomes web site (ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/pilot_data/data/). For samples sequenced using the 454 technology, we utilized alignments generated using the SSAHA aligner (), while for samples sequenced on the Illumina GA, we used the MAQ () alignments. The Illumina samples were sequenced using a mix of read lengths (ranging from 35 to 100 bp) and both single-end and paired-end reads. For samples sequenced using only single-end reads, we aligned the reads to the reference human genome using BWA () to allow for detection of indels. Further, to improve the alignment of reads that span insertion/deletion variants, we utilized the realignment module of the Genome Analysis Toolkit (GATK) () to realign the reads for each individual. The realigned BAM files for each sample were used for indel detection.
Page: 2051 20472053
Detection of indels for population-scale sequencing data
Comparison to indel calls in 1000 Genomes projectTo assess the sensitivity of our indel calls, we compared our data with indel calls downloaded from the 1000 Genomes project web site. Since the 1000 Genomes project calls were made for each population by combining data across multiple platforms, we merged the indels identified by piCALL for each of three populations: CEU, YRI and Asian (CHB + CHD) across the two platforms. For the CEU population, 22 of the 24 indels reported by the 1000 Genomes data were also called by piCALL. Similarly, for the YRI population, 34/38 indels were identified. For the Asian samples, 33 of 39 indels were detected. We further examined the 12 indels called in the 1000 Genomes data that were missed by piCALL. Of these, three were confirmed in validation experiments, four did not validate while the remaining five indels were not evaluated (). We also compared indels detected from the CEU and YRI populations sequenced using the Roche 454 platform to indel calls in the trios sequenced by the 1000 Genomes project. The individuals in the YRI trio (NA19240, NA19238 and NA19239) and the CEU trio (NA12878, NA12891 and NA12892) were sequenced using the Roche 454 platform. For the YRI trio, 17 indels overlapped the genomic regions targeted in the exon population sequencing. In all, 16 of these were identified by piCALL in the YRI Roche 454 dataset. The one indel that was missed was in an exon that had low coverage in the population sequence data. Similarly, for the CEU trio, all nine indels that overlapped the sequenced exons were identified. Overall, these results demonstrated the high sensitivity of our method. The number of indels identified by piCALL for the 1000 Genomes datasets was significantly greater than reported by. The 408 indels identified across the seven population datasets correspond to 261 distinct insertion/deletion variants. In all, 62 of these matched indels identified in the 1000 Genomes exon project. An additional 24 indels were detected in two or more populations. While it is difficult to estimate the false discovery rate without experimental validation, the increased frequency of 3n indels and the consistency in the number of indels detected across different populations and two different sequencing platforms suggest that our method has high specificity.
Page: 2052 20472053
V.Bansal and O.Libiger(a) ( b)) and several thousand exomes are being sequenced for the comprehensive discovery of coding genetic variation and to identify rare disease susceptibility variants. In coding regions, accurate and sensitive detection of indels is important since missed indels can reduce power to detect the functional mutations while false indels increase the number of candidate mutations that could be functional. However, this requires (i) comprehensive identification of candidate indel variants from sequence reads, (ii) accurate alignment of all reads that support an insertion/deletion event and (iii) probabilistic method to discriminate true indels from indels that are artifacts of sequencing or alignment errors. We have presented a probabilistic method for the accurate detection and genotyping of indels from aligned population sequence data that automatically accounts for context-dependent sequencing errors. Application of this method to population sequence data from the 1000 Genomes project demonstrated the sensitivity and specificity of our method. The method does not realign reads unlike indel callers such as Dindel which combine realignment with indel detection. Therefore, the accuracy of our method depends on the quality of the initial alignments. The read lengths for the Illumina sequencing platform are increasing and with longer reads, it should be easier to align reads with gaps and substantially reduce the impact of misaligned reads. A key feature of our method is that it does not require prior knowledge of the context-specific sequencing error rates, although prior information about the error rates can be easily incorporated in the model. As new sequencing platforms emerge, methods for indel detection that can automatically account for the platform-specific sequencing error profiles will be very useful. The probabilistic model underlying piCALL uses the number of reads supporting each allele for calculating the likelihoods. It is feasible to incorporate information about base quality values and read mapping quality in the calculation of the conditional genotype likelihoods. This would further improve the accuracy of indel detection but would be even more important for calling single nucleotide variants using the same model. Also, as currently implemented, the method evaluates each potential variant allele at each site individually. Although this allows for the detection of multiallelic variants, a more accurate approach would be able handle all potential variant alleles simultaneously. In the future, we plan to extend the model and implementation of piCALL to incorporate base quality values and analyze multiple variant alleles simultaneously. We have implemented piCALL in C for computational efficiency. The method is compatible with data from different sequencing platforms but requires all samples to be sequenced using the same sequencing platform. In addition, the method requires sequence data from a sufficient number of samples in order to accurately estimate the population genotypes. The running time of piCALL is proportional to the number of individuals and the number of candidate indels evaluated using the likelihood ratio statistic. To call indels for the seven population datasets from the 1000 Genomes project, piCALL took 4 h on a 8 core linux machine.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.2 Detection of indels using piCALL To analyze aligned reads from multiple samples using piCALL, we generated pileup files (distinct from the samtools pileup format) that represented the aligned bases covering each position. For indel detection, we only considered reads with a mapping quality of 20 or more. For each position, we determined candidate indels using the aligned reads for all samples in a population and evaluated each candidate indel using the algorithm piCALL as described in the Methods. For the beta prior on the error probabilities e 01 and e 10 , we used parameters  = 1 and  = 30. We also ran piCALL with different values for  (25, 50) and  = 1 and observed only minor changes in the set of the indels identified by piCALL. For the log-likelihood ratio statistic, we used a threshold of four to identify indels. Choosing a lower cutoff for the statistic is expected to increase the sensitivity and decrease the specificity of the indel calls. In the absence of a dataset with perfect knowledge of the indel variants, we used a higher threshold to increase specificity. Candidate indels for which the log-likelihood ratio statistic was above the threshold value and for which the evidence from the two strands was not conflicting (strandfilter) were retained. The number of indels that were identified in each population are reported in Table 1 along with the number of samples. For the CEU and CHB population samples sequenced using the Roche 454 platform, the number of identified indels was unusually large compared with other populations. Further analysis of the indels in these populations revealed an excess of 1 bp indels in homopolymer runs. For each indel, we calculated the mean estimate of the sequencing error rates e 01 f and e 01 r (see Section 2.3) using the final genotype configuration. Indels for which the sequencing error rate e (average of the two strand-specific error rates) was above a threshold were removed. The number of indels in each population that passed this additional filter are also shown in Table 1 (e  0.03 and e  0.02). The number of indels detected for the Illumina sequenced datasets was virtually unaffected by this filter while the number of indels for the Roche 454 datasets was considerably reduced. However, the total number of indels detected across different populations and sequencing platforms was more consistent, suggesting that this filter removed false single base pair indels called from Roche 454 data. In total, 408 indels were identified by piCALL across the seven population datasets (e <= 0.02). In coding regions, short insertions and deletions that cause a frameshift are likely to affect gene function. Therefore, coding indels whose length is not a multiple of 3, i.e. the length of a codon, are expected to be under purifying selection. The 204/408 (50%) indels had a length that was a multiple of 3 (see Fig. 1a for distribution of indel lengths for the two sequencing platforms). This bias in favor of 3n indels was consistent with previous studies of coding indels (Bhangale et al., 2005; Ng et al., 2009) and indicated that the set of indels did not contain many false positives. Interestingly, the proportion of 3n indels for the YRI population detected on both the Illumina (57%) and Roche 454 (63%) sequencing platforms was higher than in the CEU and Asian populations (Fig. 1b). The higher proportion of 3n coding indels in African populations is consistent with the finding of Lohmueller et al. (2008) that European populations harbor a greater proportion of non-synonymous SNPs as compared with African populations.
CONCLUSIONS AND FUTURE WORK Insertions and deletions represent an important class of smallsequence variation that can be identified from high-throughput sequencing data. Hundreds of exomes have been sequenced (Li
