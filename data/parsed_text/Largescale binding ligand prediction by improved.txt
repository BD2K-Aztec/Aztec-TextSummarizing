Motivation: Ligand binding is a key aspect of the function of many proteins. Thus, binding ligand prediction provides important insight in understanding the biological function of proteins. Binding ligand prediction is also useful for drug design and examining potential drug side effects. Results: We present a computational method named Patch-Surfer2.0, which predicts binding ligands for a protein pocket. By representing and comparing pockets at the level of small local surface patches that characterize physicochemical properties of the local regions, the method can identify binding pockets of the same ligand even if they do not share globally similar shapes. Properties of local patches are represented by an efficient mathematical representation, 3D Zernike Descriptor. Patch-Surfer2.0 has significant technical improvements over our previous prototype, which includes a new feature that captures approximate patch position with a geodesic distance histogram. Moreover, we constructed a large comprehensive database of ligand binding pockets that will be searched against by a query. The benchmark shows better performance of Patch-Surfer2.0 over existing methods. Availability and implementation: http://kiharalab.org/patchsurfer2.0/
IntroductionSmall molecules, such as metabolites and drugs, have important interactions with protein receptors, regulating many different processes in biological systems. Therefore, predicting binding ligands can provide important information for elucidating protein functions. Predicting binding ligands for proteins can also provide useful information for computational drug discovery, drug side effects and protein design. By combining computational screening with experiments, proteinligand interaction networks can be revealed (). In principle, ligands for a protein can be predicted by identifying a global or local structure similar to known proteins. FINDSITE () and GalaxySite () use a modeled structure by threading to predict binding ligands for a target protein. Global structure-based methods capture distant evolutionary relationships that provide powerful information for function prediction; however, such methods have difficulty for cases where proteins of largely different global structures bind the same ligand molecules. Local structure-based methods aim to identify similarity between a target pocket and known binding sites. Local structure can be compared at different structure levels. Catalytic Site Atlas () and AFT () compare a few functional residues in binding sites, where similarity is quantified with the root-mean-square deviation (RMSD) of the residues. Pseudocenters of residues () as well as atom-level representation were also used (). However, cases have been reported where binding site residues for some ligand types are not always well conserved ().Alternatively, surface representations have been used for describing binding pockets. Surface representations do not explicitly specify residue/atom positions in pockets and thus are coarser representations. The advantage of a surface representation is that it can attenuate a certain level of differences in pocket shapes, which are commonly observed in pockets of the same ligand type. eF-Seek () constructs a triangle mesh to represent protein surface.used a histogram of distances between nodes in a triangle mesh that represents a protein surface. SMAP performs pocket alignment using Delaunay tessellation and amino acid residue comparison (). ILBind () combines FINDSITE and SMAP for inverse ligand binding protein prediction. Besides binding ligand prediction methods discussed earlier, there are methods that predict binding pocket location in proteins using various pocket descriptions. Those descriptions include grid representation (), atom triangles () and a-shape (). COACH () takes a consensus of multiple programs. Mathematical moment-based approaches have been identified to be suitable for molecular surface representation. Moment-based methods can naturally control the resolution of the surface description, and physicochemical properties on the surface can be represented in the same way as surface shape. Thornton and her colleagues used spherical harmonics for describing binding pockets (). In our earlier works, Pocket-Surfer, global pocket shape and the surface electrostatic potential are represented using 3D Zernike descriptors (3DZD;). Subsequently, we proposed Patch-Surfer, which represents a pocket as a set of small local surface patches, each of which is described by 3DZD (). The local patch representation of pockets enables the method to identify corresponding regions in pockets even if the global shapes of pockets are different. Although Patch-Surfer compared favorably against the existing methods in terms of prediction accuracy, it was tested on small datasets with a limited number of ligand types. In this work, we compiled a large dataset of over 6000 non-redundant pockets with 2707 different ligands with which our method was tested. Moreover, the algorithm was significantly improved in four more aspects: First, we introduced a new feature of a patch called the approximate patch position (APPS) that describes the relative position of the patch in a pocket. Second, we use geodesic distance rather than Euclidean distance for computing distance between patches in a pocket. Third, the procedure to identify corresponding patches in two pockets was revised so that the selected patch pairs are guaranteed to yield the minimum (i.e. best) score. Finally, we also consider similarity of ligands when scores for each ligand are computed. On the large dataset, we show that Patch-Surfer2.0 shows overall higher accuracy than the previous version as well as existing methods.
Methods
Non-redundant binding pocket databaseA non-redundant database of pockets with bound ligands was constructed based on the protein-small-molecule database (PSMDB;). Starting from 5438 proteinligand complexes from PSMDB, we selected a non-redundant set of 2444 different ligand types in the 6547 pockets by careful examination of ligandprotein interactions. One hundred seventeen ligand types have more than five pockets. The selection procedure and the list of the 117 ligands are provided in Supplementary Material (Supplementary).
The Patch-Surfer2.0 algorithmThe original Patch-Surfer algorithm was described in our previous papers (). Here we outline the algorithm with an emphasis on the new implementation. In Patch-Surfer, a query pocket in a protein is segmented into overlapping local patches, each of which fits within a sphere of 5.0 A  radius. A surface patch is characterized with four features: geometric shape, surface electrostatic potential, hydrophobicity and concavity, each of which is described with 3DZD. A query pocket is compared with pockets of known binding ligands in a database, and binding ligands will be predicted from the list of pockets ranked by the similarity to the query. To compute the similarity of two pockets, corresponding patches in the two pockets are identified, and a similarity score is computed based on geometric and physicochemical similarity of paired patches.
3D Zernike descriptors3DZD is a series expansion of a 3D function that allows a compact and rotationally invariant representation of a 3D object (). 3DZD has been successfully applied for various biomolecular surface representations (). To compute 3DZD for a pocket patch, a voxelized shape representation was created by mapping atoms of the patch onto a 3D grid and assigning each voxel a value of 1 if it is overlapped atoms and 0 otherwise. To represent physicochemical values, i.e. electrostatic potential, hydrophobicity or concavity, the values are mapped onto the grid instead of 1. The value-mapped 3D grid was considered as a 3D function, f(x). This f(x) is expanded into a series in terms of Zernike-Canterakis basis defined as follows:whereWe used order n  15, which corresponded to 72 invariants. Y m l #; / is the spherical harmonics and R nl r is the radial function. Then, the 3DZD, F nl , is calculated as norms of vectors X nl. The norm gives rotational invariance to the descriptor:The distance of two 3DZDs is quantified with the Euclidean distance (L2 norm) of the vectors of F nl. The distance of two patches, pd3DZD, is a weighted average of 3DZDs of four features mentioned earlier. The weights were taken from our previous work ().
Approximate patch positionAPPS is a new term introduced in Patch-Surfer2.0. The APPS is a histogram of geodesic distances between the center of a patch and the other patch centers in the pocket. The geodesic distance is the distance measured along the surface. The histogram tells a rough position of a patch in the pocket, e.g. near an edge or around the center. Geodesic distances were binned into 40 with a 1.0 A  interval. APPS for two patches is quantified by the L2 norm of their histograms.
Geodesic relative position difference(s A i , s B j ) denotes a pair of patch centers in pocket A and B, respectively, to be examined, m A,B is a list of corresponding patches between pockets A and B, and j m A,B j is the number of corresponding patches. j m A,B j is at most the number of either of the size of pocket A or B (i.e. the number of patches in the pocket), whichever smaller. The corresponding patch in pocket B for patch k in pocket A is denoted as s B mA,B(k). G2 is the geodesic distance between two patch centers. In the original Patch-Surfer, we used the Euclidean distance, but we revised it to the geodesic distance in PatchSurfer2.0.
Combined scoresThe three scoring terms mentioned earlier are combined into a composite score. Two terms, the patch physicochemical distance using 3DZD termed pd3DZD and APPS, are combined with a weight factor,The first term n A /jm A,B j is for penalizing when the number of matched pairs jm A,B j is smaller than the number of patches in the query, n A. The smaller the score is the more similar the pockets are.
Auction algorithm for identifying corresponding patchesTo compute the scores, the correspondence of patches between two pockets A and B, m A,B , is identified with a modified auction algorithm (), which optimizes a target score by matching patches. In the original Patch-Surfer, only pd3DZD was optimized, and after the correspondence was established, the other terms were added to 'reevaluate' the matches. In PatchSurfer2.0, the final score (7) is used as the target function. Thus, the optimality of the matching pairs in terms of the total score is guaranteed.
Ligand-type prediction scoreA query pocket will be compared with all the pockets in the database, and the pockets in the database will be ranked by avgTScore.Based on the ranked pocket list, predictions of binding ligands will be made using Pocket_Score w , which is the score of a query pocket P for a ligand type F:In essence, this is a type of k-nearest neighbor (where k is the number of top matches counted in computing the score), but distinguishes itself by three important enhancements for this particular problem. First, a retrieved pocket at rank i contributes to the overall score with a decreasing score of log(n/i) as the rank decreases, where n is the number of pockets in the database. w l(i),F is a similarity score of two ligands, the ligand of the retrieved pocket at rank i and the ligand F, computed with SIMCOMP (). SIMCOMP uses a graph matching algorithm to compare chemical structures of two molecules. Its score ranges from 0.0 to the highest score, 1.0. If the raw SIMCOMP score was less than 0.72, we set w l(i),F  0. The second term expresses the enrichment factor of ligand F within the rank k. The ligand similarity score w l(i),F is newly used in Patch-Surfer2.0. In the original Pocket_Score (), we simply considered only the same ligand as the query, i.e. d l(i),F , which is 1 when l(i) equals to F and 0 otherwise. The entire procedure of Patch-Surfer2.0 is illustrated in.
Results
Analysis of score componentsIn Patch-Surfer2.0, three parameters, w 1 , w 2 (5 and 6) and k (8), must be determined. The optimization was performed on a subset of the non-redundant binding pocket database, which contains pockets for seven ligand types: adenosine monophosphate (AMP), adenosine triphosphate (ATP), flavin adenine dinucleotide (FAD), flavin mononucleotide (FMN), glucose (GLC), heme (HEM) and nicotinamide adenine dinucleotide (NAD). First, we determined the w 1 that optimizes MScore. Values of w 1 were explored from 0.0 to 1.0 with an interval of 0.1 with a combination of different k, which was changed from 25, 50, 100, 200, 300, 400, to 500. Each pocket of the seven ligand types was selected as query and compared with all the remaining pockets in the database.Then, binding ligands were predicted by Pocket_Score w from the ranked list of pockets.shows the average Top 10 and Top 15 accuracy of the seven ligand types with different combinations of w 1 and k (more results on Top 5, 20 and 25 accuracy are provided in Supplementary). The Top X accuracy indicates the frequency of queries whose correct ligand is predicted within the Top X predicted ligands ranked by score. The accuracy increases as k increases and nearly plateaus at k  200. We selected 0.4 for w 1, because the accuracy was the highest when averaged over all the values of k for Top 5, 10 and 15 accuracies. We selected 200 for k. With the w 1 values decided earlier, we used the same process to determine w 2 for TScore (Supplementary). These plots show a similar trend to; the curves in general plateaued at k  200. We chose 0.8 for w 2 , because that gives the maximum average accuracy over k for Top 5, 10, 15 and 20. k was set to 200 where the accuracy peaked with w 2  0.8.summarizes the accuracy of MScore and TScore using the determined parameter values as well as individual terms, pd3DZD, APPS and GRPD, and the original Patch-Surfer. TScore showed higher accuracy than Mscore and all the individual scores and original Patch-Surfer for all Top 5 to Top 25 accuracy. Among the individual scores, APPS, the newly added term in this work, outperformed the other two individual scores. APPS showed even higher accuracy than the original Patch-Surfer. MScore that combines pd3DZD and APPS was more accurate than using either one of the scores individually.examines the effect of considering the ligand similarity weight, w l(i),F , in Pocket_score w (8). The motivation of using the weight is to give credit when a pocket is retrieved, whose natural ligand is the same as the query but has been crystallized with a different molecule (e.g. a drug). Since a bound molecule to a pocket is usually similar to its natural ligand, the weight can provide a partial score to the query's natural ligand. Top 5 to Top 25 accuracies obtained by two scores were compared, ones computed with Pocket_score w with w l(i),F and those obtained with Pocket_score with d l(i),F. Overall, the accuracies improved by using the w l(i),F weight. An improvement of larger than 0.05 for Pocket_score w over Pocket_score was observed for 14 cases while a decrease in accuracy by more than 0.05 was observed for four cases. In the development stage, we have also incorporated a scoring term that evaluates the pocket size difference between a query and a retrieved pocket into MScore as in the original of Patch-Surfer. However, it did not show an improvement in accuracy. This may be because the new APPS term, which is a histogram, already contains the pocket size information (data not shown).
Prediction on the remaining ligand typesUsing the optimized parameters in the previous section, we benchmarked Patch-Surfer2.0 for the rest of the ligand types in the binding pocket database.shows the average accuracies for the remaining 110 ligand types. Top 10 and Top 15 average accuracies are 0.417 (0.438) and 0.526 (0.547). In the parentheses, the average accuracy for all the 117 ligand types are shown, since these are the accuracy that will be experienced in practical prediction situations by users. Although these accuracies are lower than the results on the training set in, considering that the large number of pockets and ligand types stored in the ligand database these accuracy values are useful in practical applications. Indeed as we see later in more detail, Patch-Surfer2.0 outperformed existing methods. In, we also show the results when similar ligands are grouped by SIMCOMP. The cutoff values used (0.720.50) make modest and reasonable grouping of ligands. Even a SIMCOMP score of 0.50 clusters only ligands with up to a few atom changes: for example, monosaccharides including glucose and mannose are grouped but not combined with sucrose or phosphono-fructopyranose, and NADH is grouped with NADP but not clustered with ATP. Thus, biologically meaningful separation of ligands is still maintained with a lower cutoff value of grouping. When ligand groups are considered, ligands in the same group are considered as 'identical' molecule when accuracy is computed. With the ligand grouping with a SIMCOMP score of 0.5, Top 5 and Top 10 accuracy reached 0.46 and 0.63, respectively. Until now we reported average accuracy over different ligand types. Next we take a closer look at the results for different ligands. Prediction accuracy can vary considerably from ligand to ligand. Among the 117 ligand types, 28 ligands (25.5%) have an accuracy of over 0.7 in Top 10 accuracy, while it was 0.0 for 15 ligands (13.6%).shows five ligands that were predicted well and four that were predicted poorly. The five well-predicted ligands are diverse in structures and functions, including natural ligands and their analogs, and drug molecules. These include not only rigidligands but also flexible ones with multiple rotatable bonds and are observed to bind different targets in different conformations. We examined whether the prediction accuracy deteriorates for binding pockets for flexible ligands. We define the ligand flexibility ratio as the number of rotatable bonds per heavy atom. Overall, we see a weak trend; the correlation coefficient between the ligand flexibility ratio (Supplementary) is 0.45 and 0.50 for Top 10 and Top15 accuracy, respectively. Ligand binding is difficult to predict if ligands are too flexible as the four failed cases in. In particular, 1PG and 12P are extreme: they have 14 and 37 rotatable bonds and ligand flexibility ratio of 0.82 and 0.92, respectively (by comparison, the ligand flexibilities of 017, GNP and NDP, are 0.32, 0.25 and 0.27, respectively). However, 1PG and 12P are polyethylene glycols, which are precipitants in sample preparation for X-ray crystallography and are not relevant to biological functions of the proteins. We found other polyethylene glycols, 2PE, P33, PE4, 1PE, P6G, 15P as well as two similar molecules, C8E and PG6, have a flexibility ratio over 0.8 and have poor prediction accuracy of below 0.125 for Top 10 accuracy (except for C8E whose accuracy was 0.375). The other two poorly predicted ligands, TAM and 1PS, are molecules commonly used as buffers. Thus, the poor prediction results for the four ligand molecules may be reflecting the fact that the molecules in precipitant or buffer bind non-specifically to proteins. Removing flexible ligands increases the prediction accuracy. In, we show the accuracy when 10 ligands with a flexibility ratio over 0.8 are excluded from the queries. Compared with the results in, Top 10 accuracy has improved from 0.438 to 0.472 for the all 107 ligands and 0.628 to 0.663 when ligands were grouped with SIMCOMP score of 0.5. Because the extremely flexible ligands are not relevant to biological functions of target proteins and also grouping with SIMCOMP score of 0.5 only groups similar ligands, the last row ofis the accuracy that is most relevant to practical use of Patch-Surfer2.0. In Supplementary Table S2, the accuracy was computed after further excluding flexible ligands, which have a flexibility ratio over 0.7, 0.6 and 0.5. The accuracy improved after more ligands were excluded but the largest improvement was observed when the 10 ligands with the flexibility ratio >0.8 were excluded.
Prediction for apo proteinsWe have further compared Patch-Surfer2.0's performance on 32 apo proteins with their counterpart of the holo proteins in the binding pocket database (Supplementary). The results (; Supplementary Table S3 and) show that the accuracy for apo target proteins was not deteriorated, rather, higher than the results for holo proteins. This is interesting but consistent with our previous work ().
Comparison with other existing methodsIn our previous papers, we have reported that the accuracy of the original Patch-Surfer is higher than Pocket-Surfer () and four other similar pocket descriptors, 2D and pseudoZernike descriptors, Legendre moments and spherical harmonics (). Moreover, Patch-Surfer also showed better prediction performance than the four existing methods eFseek, SiteBase, PROSURFER and XBSite2F (area under the curve, AUC, was 0.86 for Patch_Surfer, and 0.49, 0.60, 0.57 and 0.55 for the four methods, respectively;). Additionally, in, Patch-Surfer2.0 was compared with eF-Seek and a recently developed method, APoc (). Fifteen ligands were used for this comparison. Patch-Surfer2.0 showed higher relative partial AUC () than eF-Seek for all but one ligand. In comparison with APoc,Accuracies were calculated for ligand groups clustered with a SIMCOMP similarity score of 0.72, 0.65, 0.60, 0.55 and 0.50. All 117 ligand types were used.. Ligand types that were predicted with high or low accuracies. The first five ligands, 017 to NAG, have over 0.9 Top 10 accuracy. The latter four ligands, 1PG to 1PS, have an accuracy of 0.0 at Top 25 or Top 20 accuracy. Ligands are specified with the PDB codes: 017, darunavir; NDP, NADPH Dihydro-Nicotinamide-Adenine-Dinucleotidephosphate; SF4, iron-sulfur cluster; NAG, N-acetyl-D-glucosamine; 1PG, methoxy-polyethylene glycol; TAM, tris-aminomethane; 12P, dodecaethylene glycol; 1PS, 3-pyridin-1-ium-1-ylpropane-1-sulfonate
Large-scale binding ligand prediction by Patch-Surfer2.0Patch-Surfer2.0 showed higher AUC for 13 ligands and a tie for NAD. The average relative partial AUC and AUC by PatchSurfer2.0 for the latter 10 ligands (ACR to PMP) were not lower than those for the first five (AMP to NAD), which were used for parameter optimization.
Examples of predictionsFinally, we show several examples of Patch-Surfer2.0 predictions. In Supplementary Table S4, we show a typical example of a search result. The query was a NAD binding pocket (glucose dehydrogenase, 1gco_A). Among the top ten matched pockets, four of them bind NAD, three of them bind nicotinamide-adenine-dinucleotide phosphate (PDB code: NAP) or nicotinic acid adenine dinucleotide (DND), which are similar to NAD with SIMCOMP score of 0.88 and 0.87, respectively. The rest of the three ligands are BEI (Inhibitor Bea322) and two cases where multiple small ligands bind to the pockets. BEI is similar to NAD in size and has two aromatic rings as NAD does. The latter two cases show similarity to NAD in terms of size when the total size of ligands in the pockets is considered and has common local structures.shows examples of ligand binding pockets identified at a high rank for query pockets.and B are binding pockets for S-adenosylmethionine (SAM). B1 is an example of retrieved pocket that has a similar global structure as well as similar pocket shape to the query protein. In contrast, B2 is a case that the retrieved protein is not structurally similar and also the ligand binds in a different conformation from the query, which indicates that the pocket shape is different to the query. In the second example,and D are NAD binding pockets. Both of the two retrieved pockets, D1 and D2 are from different global structures. TM-score () is less than 0.5 for both proteins to the query. The first one () has a similar pocket shape with an RMSD of NAD of 1.0 A  , while the second one () binds NAD in a different conformation. These examples illustrate that Patch-Surfer 2.0 identifies pockets of the same ligand type that have different overall shapes and locate in a protein of globally different structures.
Discussion and conclusionWe have presented Patch-Surfer2.0, which compares a query pocket to known ligand binding pockets and predicts binding ligand molecules for the query. Among the five major technical improvements that have driven the method to achieve substantially higher accuracy than the original Patch-Surfer, APPS had the largest contribution to the highest accuracy among the individual score components. APPS captures not only positions of patches in a pocket but also reflects the size of the pocket. By using a patch representation of pockets, PatchSurfer2.0 recognizes pockets for the same ligand by identifying common local regions in pockets, even if the global folds of the proteins are different and the pockets do not share a common global shape.
FundingThis work was supported by the National Institutes of Health; National Science FoundationThe number of query pockets used for the comparison with eF-Seek (left) and Apoc (right). The numbers are different because common entries between the pocket databases by Patch-Surfer2.0 and eF-Seek were used as queries. Only one number is shown when the number were the same for eF-Seek and Apoc. The average AUC of receiver operator characteristic of the number of queries are shown. bFor the performance comparison with eF-Seek, we computed partial AUC (pAUC) that is the AUC computed up to the maximum false-positive rate (FPR) against the pAUC of the random retrieval up to the same FPR. Thus, rel_pAUC  pAUC/pAUC random where pAUC  AUC/(1.0*maxFPR). cAPoc was run locally using the same database as Patch-Surfer2.0.. Examples of identified pockets. A is the query, 2plw-A that binds SAM. B1 and B2 are retrieved pockets for 2plw-A at the rank 1 and 6, respectively, 3dou_A and 1zq9_A. The TM-Scores between the query and the two proteins are 0.86 and 0.56, and the RMSD values of ligands are 0.65 A  and 1.75 A  , respectively. C, a query, 1gco_A. D1 and D2 are retrieved pockets for 1gco_A at the rank 1 and 8, 1lj8_A and 2jhf_A. TM-scores between the query is 0.40 and 0.38, and RMSD of ligands are 1.00 A  and 2.28 A  , respectively
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
X.Zhu et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
