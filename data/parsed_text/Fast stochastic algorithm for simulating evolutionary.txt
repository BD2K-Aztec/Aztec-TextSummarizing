Motivation: Many important aspects of evolutionary dynamics can only be addressed through simulations. However, accurate simulations of realistically large populations over long periods of time needed for evolution to proceed are computationally expensive. Mutants can be present in very small numbers and yet (if they are more fit than others) be the key part of the evolutionary process. This leads to significant stochasticity that needs to be accounted for. Different evolutionary events occur at very different time scales: mutations are typically much rarer than reproduction and deaths. Results: We introduce a new exact algorithm for fast fully stochastic simulations of evolutionary dynamics that include birth, death and mutation events. It produces a significant speedup compared to direct stochastic simulations in a typical case when the population size is large and the mutation rates are much smaller than birth and death rates. The algorithm performance is illustrated by several examples that include evolution on a smooth and rugged fitness landscape. We also show how this algorithm can be adapted for approximate simulations of more complex evolutionary problems and illustrate it by simulations of a stochastic competitive growth model.
INTRODUCTIONNatural evolution is an inherently stochastic process of population dynamics driven by mutations and selection, and the details of such evolutionary dynamics are increasingly becoming accessible via experimental investigation (). The importance of stochasticity comes from the fact that populations are always finite, mutations are random and rare, and at least initially, new mutants are present in small numbers. This realization prompted intensive studies of stochastic effects in evolutionary dynamics (). Most of the models in these studies consider a reproducing population of individuals which are endowed with * To whom correspondence should be addressed. genomes that can mutate and thus affect either reproduction or death rate, as with the classical WrightFisher () and Moran models () which describe a fixed population of replicating individuals. Specific models vary in the details of fitness calculation and mutation rules, but recent theoretical studies of even relatively simple models lead to non-trivial predictions on the rate of evolution as a function of the population size and the details of the fitness landscape (). However, the complexity of more realistic evolutionary models makes them analytically intractable and requires researchers to resort to direct numerical simulations in order to gain quantitative understanding of underlying dynamics. On the most basic level, an evolutionary process is a Markov chain of discrete reactions of birth, deaths and mutations within a population of individuals. A direct and exact way of computing individual evolutionary 'trajectories' is to use the stochastic simulation algorithm (SSA;) or its variants (), in which birth, death and mutation events are treated as Markovian 'reactions'. Unfortunately, for realistically large population sizes, direct stochastic simulation of even simple models becomes prohibitively expensive. Hence, there is an acute need for developing accelerated methods of stochastic simulations of evolutionary processes. Such methods usually involve approximations to the exact stochastic process based on certain small or large parameters that characterize the problem (for example, population size or mutation rates). Several approximate methods have been developed in recent years in the context of stochastic biochemical kinetics (). Recently,proposed an approximate hybrid algorithm suitable for simulation of evolutionary dynamics by combining the -leap algorithm () appropriate for abundant sub-populations that do not change their sizes much between individual events, and the direct SSA algorithm for small sub-populations. This method allows one to use large time steps during which multiple birth and death reactions may have occurred. However, it slows down dramatically after a new mutant has been produced, since the algorithm resorts to the direct SSA for all events in which the new mutants are involved until the population of the new mutant class reaches a pre-defined threshold.
BNB algorithm for evolutionary dynamicsHere, we develop a novel exact algorithm for simulation of evolutionary dynamics of a multi-species population undergoing asexual reproduction, death and mutation. Unlike the direct SSA, it only samples the evolutionary process at the times of mutations. Stochastic contributions from mutation, birth and death are included exactly, which is especially important for new species that initially contain a population size of one. We call this algorithm BNB (binomial-negative binomial), since as the name indicates, a population update requires sampling binomial and negative binomial pseudorandom variables with specific weights. This can be done efficiently using techniques similar to those used in the next reaction method (). If the mutations are rare compared with other (birth and death) events, this algorithm offers a significant speed advantage with respect to the SSA. Indeed, in most organisms, the mutation rate is much smaller than the birth and death rates, e.g. the probability of mutation per division for the genome in bacteria is  g  10 3 (). Thus, only a small (compared to the population size) number of new mutants appear in each generation. Even in viruses that generally are characterized by a high mutation rate  g  1, most mutations are neutral and thus do not strongly influence the population dynamics. In the following, we begin with a general approach to the stochastic simulation of a system of reactions that are arbitrarily divided into 'fast' and 'slow' reactions. We then specialize to the evolutionary model in which the mutation rate is assumed to be much smaller than the birth and death rates. We present examples that illustrate the accuracy and power of the proposed algorithm for models describing evolution of a population regulated by serial dilution. Then we discuss a modification of the algorithm that allows for its use in more complex situations when the exact algorithm is not applicable. Finally, we illustrate the approximate method by a simple example of co-evolving species competing for a common nutrient source.
ALGORITHMThe BNB algorithm is a stochastic updating rule for the state of an evolving set of species, which are defined by their internal state ('genotype') that in turn determines the birth, death and mutation rates for each species. This algorithm is exact when the birth, death and mutation rates (not the propensities!) remain constant between consecutive mutations. A single iteration of the BNB algorithm updates the state of the system to the time just after the next mutation has occurred. By applying this updating rule multiple times, the dynamics of the evolving system can be sampled by 'jumping' from one mutation to the next. In case when the rates are changing slowly between mutations, an approximate variant of the BNB can be applied (see below). The core of the BNB algorithm is based on an exact solution for a stochastic model of dividing, dying and mutating discrete populations of cells. A single iteration of the BNB algorithm uses this solution to rapidly perform the following steps: (i) determine from which species and at what time a new mutant cell is generated; (ii) update the populations of all species to the time just prior to this mutation; (iii) generate a new mutant cell that either establishes a new species in the simulation or is added to a species already contained in the simulation; and (iv) update the time of the simulation to the time of this mutation. This section contains the derivation and the detailed description of the BNB algorithm.
Stochastic simulation of a two-scale stochastic processWe consider the general case of a continuous time and discrete state stochastic system that is subject to a set of reactions among which some are 'fast' and some are 'slow'. We designate them as fast and slow operationally, for a given state of the system (e.g. abundances of each species) at a given time. Typically, the mean time interval between two consecutive fast reactions will be much smaller than the mean time interval between two consecutive slow reactions. Our goal is to jump directly from one slow reaction event to the next and exactly sample the state of the system at the time of slow reaction. Let us lump all slow reactions into one that we call 'mutation' and consider the dynamics of the system between two consecutive mutations. For simplicity, we assume that the propensities for each possible mutation are proportional to each other for a given system state, such that we can select the type of mutation independently of when a mutation occurs. If the probability of mutations were zero, the probability p i (t) for being at state i at time t satisfies the master equation that only includes fast reactionsR ij and other R ij  0 .Now, suppose that mutations occur with rate  i at state i. We can introduce the probability P i (t) that the system is at state i at time t and a mutation has not yet occurred. It is easy to see that P i (t) satisfies the 'leaky' master equationThe probability Y i (t) that at least one mutation has occurred while the system was at state i before time t satisfies the following equationNote that Y i (t) = 0 at initial time t = 0. Define the probability P(t)  i P i (t) for no mutation to have occurred by time t and Y (t)  i Y i (t) for some mutation to have occurred at least once at any state by the time t. By construction, Y (t)+P(t) = 1, and therefore dP dtThus, P(t) is strictly non-increasing in time, as expected. Knowledge of P(t) allows us to sample time to the next mutation t m. We also need to know which state of the system is mutated. It is easy to show that the probability  i (t) that the system is at state i at the time of a mutation isThus, assuming we can solve for P i (t), we can formulate the following algorithm for updating the stochastic system at mutation times:((3) Sample the next mutation time according to the cumulative probability P(t). This can be done via the inversion method, such that the next time t m = P 1 (r), where r is a uniform random variable between 0 and 1.(4) Add t m to the current time.(5) Sample the distribution  i (t m ) to generate the new state i m just before the mutation (slow reaction).(6) Choose the specific mutation according to their relative propensities and update the state of the system after the state update in Step 5.(7) Return to Step 1 until finished.Of course, to complete this algorithm, we should be able to solve for or otherwise compute the dynamics of the probabilities P i according to Equation (2). While this may be difficult in general to do analytically, it may still be much simpler that solving the full system. In particular, as we discuss in the following section, the problem can be solved exactly when the fast reactions include only birth and death whereas the slow reactions include only mutations.
Generating function solution for a single-species birth/death/mutation modelThere exists a vast literature on the analysis of statistical properties of the so-called linear birthdeath processes. The analytical treatments usually involve solving the corresponding master equation via the generating function method (). Exact solutions have been found for several models including pure birthdeath systems as well as systems with immigration and emigration (). Here, we will follow the same general approach, but since we are interested in the statistics of mutating species, we will add the mutation 'reaction' in the model which manifests itself through leakage of probability. We begin with the case of a single class of species. The number of individuals n can fluctuate due to statistically independent birth, death and mutation reactions. Birth has propensity gn, death has propensity n and mutation has propensity n. As before, we are only interested in the interval of time between two subsequent mutations, so the resultant state of the mutated individual is irrelevant. Thus the mutation is simply defined as the creation and subsequent departure of a single individual from the class. Define P n (t) to be the probability that the system is at state n at time t and that a mutation has not yet occurred. The generating function G(s,t) =  n=0 P n (t)e sn can be computed for an initial population n 0 at time t = 0 by (see Supplementary Material for details)R  (g) 2 +(2g+2 +) and W = g+ +. Using a uniform random number r distributed between 0 and 1, the next mutation time is thenwhich exists forWhen Equation (12) is not satisfied, this indicates that the population will go extinct before a mutation occurs if the population is unperturbed for infinite time. The time to extinction, t x , can then be sampled by inversion of the extinct state probability P 0 (t),(13)
BNB expansionAfter computing the time to the next mutation, we need to generate a sample number of individuals at the time of mutation. The number of individuals conditional on no mutation at time t is distributed according to the generating function G(s,t) given by Equation (6). Here, we show that this seemingly complicated distribution can be exactly sampled by drawing two random numbersone binomial, and one negative binomial. Many popular software packages, e.g. (), contain fast algorithms for generating these random numbers (note that negative binomials can be generated by Poisson random variates with a Gamma-distributed parameter). Equation (6) can be recast via a binomial expansionSince an integer power of a geometric generating function corresponds to a negative binomial generating function, Equation (14) can be interpreted as a generating function of a process in which the system either has mutated by time t with probability 1p M (t) n 0 , or if the system has not yet mutated, then it is in a statestatestate whose distribution is a binomial superposition of n 0 negative binomial distributions. While Equation (14) does not directly provide the probability to be in a particular state at the time of a mutation, it provides the probability P n (t) at an arbitrary time t conditional on no mutation. We can then generate a sample of the
BNB algorithm for evolutionary dynamicspopulatio n conditional on no mutation at time t by the following procedure.
Algorithm 2(1) Generate a binomial random numbermnumber numberm, with success probability 1(p E (t)/p M (t)) and n 0 terms.(2) IfmIf Ifm = 0, then the system at time t is in the extinct statestatestate = 0.(3) Otherwise, generate the new state variablevariablevariable:) is a negative binomial number of ordermorder orderm and probability of success p B (t). We are also interested in the probability  n (t) for a system to be in the state n at the mutation time. It is easy to see that. To compute these probabilities, we introduce the corresponding generating functionAfter straightforward algebra, we obtain from Equation (6)which has the binomial expansionEquation (16) has the same form as Equation (14), and thus,  n can be also sampled. Specifically, the algorithm for computing the state of the system just before the next mutation (at time t m ) for the single species reads as follows.
Algorithm 3(1) Generate a binomial random numbermnumber numberm,(2) Generate the updated statestatestate at the mutation time:) is a negative binomial number of ordermorder orderm and probability of success p B (t). Note that the system will never be in the extinct state, which reflects that an extinct population cannot mutate.
Simulating multiple co-evolving species: first mutation methodIn this section, we return to the original problem of an evolving population of multiple species. We enumerate species by index i, with n i (t) individuals in each species. We are interested in sampling the set {n i (t m )} at mutation times t m. We assume that the system parameters (birth, death and mutation rates) do not change between mutations unless the algorithm is ended early between two mutations. At the time of mutation, one individual is created from mutating class i m and, depending on the type of mutation, is either added to one of the other existing classes (if such a class already exists) or becomes the founding member of a new class.The algorithm for generating a sample stochastic evolution trajectory, which we call First Mutation BNB, is as follows.
Algorithm 4(1) Initialize the system with N classes of species at time t = 0. Specify populations of all classes n i ,i = 1,...,N. Each class has its own set of birth, death and mutation rates(2) For each class, generate N random numbers r i uniformly distributed between 0 and 1. For each i = 1,...,N, generate a time t i to the next mutation by Equation (11). When Equation (12) is not satisfied, set t i =.Find the minimum mutation time t m = min(t i ) and the corresponding class i m. Update the time t  t +t m .(4) Update the population for the mutated class i m using two random numbers (one binomial and another negative binomial) according to the Algorithm 3.(5) Update the populations of all other classes according to Algorithm 2.(6) Select the specific mutation that occurs. If the mutation generates a member of a non-existent class, create a new class N +1 with n N+1 = 1 and its own set of parameters g N+1 , N+1 , N+1. Otherwise, add 1 to the corresponding existing class.(7) One or several of the non-mutated classes may have zero population and are thus extinct. Remove extinct classes from the list and reduce the number N of classes accordingly.(8) Return to Step 2 until the algorithm has completed.To end the algorithm at a specific time rather than at a mutation event, all populations can be updated according to Algorithm 2 with the time duration t * t, where t is the current time, and t * is the prescribed end time. This update would be done just after Step 2 when t * < t +min(t i ) first occurs. Ending at a specific time is useful for a number of purposes, such as if the population is reported or modified at fixed time intervals, or if rates are adjusted at fixed time intervals. The Algorithm 4 is analogous to the first reaction method used for stochastic simulation of reaction networks (), in that the simulation of a system with N classes of co-evolving species generates 3N random numbers in order to step to the next mutation. This algorithm can thus become inefficient as the number of classes becomes large. To remedy this shortcoming, an optimized and only slightly more complex version of this algorithm is presented in the next section.
Simulating multiple co-evolving species: next mutation methodIn fact, the number of random variables generated for each mutation in Algorithm 4 is excessive. Different species evolve independently between mutations, and even at the mutation time, only two classes are coupled, due to the mutating population generating and then contributing a single member
W.H.Mather et al.be statistically independent at all times, and we could simulate all species independently using only three random numbers per mutation event. This line of reasoning leads to a similar but optimized algorithm (see Supplementary Material for the algorithm and further justification), where the populations and next mutation times of species are re-sampled only for the two species that are coupled via a mutation event, whereas population sizes and next mutation times of all other classes are not re-sampled. Validity of the algorithm hinges on the statistical independence of species that are uncoupled by a mutation. The method is analogous to the next reaction method (), so we label the algorithm Next Mutation BNB. The optimized scheme reduces the typical number of new random variables required per mutation to only six after the first iteration, independently of the total number of classes N. Only initialization and finalization of the algorithm have a computational cost of order N, so efficiency of the algorithm primarily depends on how frequently the algorithm is restarted, as is the case whenever the whole population is sampled for observation. The Next Mutation BNB algorithm is always as fast or faster than the First Mutation BNB. We thus use Next Mutation BNB (or just BNB) exclusively for the simulation examples of this article.
Approximate simulation method using BNBOne major benefit of the BNB algorithm is that binomials and negative binomials rapidly generate an update for the evolving system with linear propensities for birth, death and mutation in a non-interacting population. While this situation is typically the case for cells kept in log-phase growth, the cases when species are interacting or when propensities deviate from a linear law are also of interest. Because of this, we outline how the BNB algorithm can be adapted to approximately, but accurately, simulate more complicated systems. The basis of the BNB algorithm is the generating function solution Equation (6), and it is straightforward to show from the short time form of this generating function that the BNB algorithm applied for sufficiently short time increments, during which birth, death and mutation rates are considered constant, can simulate systems with population-dependent rates. Between BNB updates, all of these rates can be updated in a state-dependent manner. This approach is similar to the -leap approximation to stochastic systems, which is often used to accelerate simulations of chemical reaction networks (). The basis of -leap is that the propensities for reactions can be considered approximately constant during some time interval, such that the update scheme for -leap assumes each reaction occurs a Poisson-distributed number of times. Simulation error magnitude in -leap is closely associated with how well propensities are kept constant during a given time interval, and based on this connection, a few prescriptions for the step size have been suggested (). In contrast, BNB as an approximate updating scheme assumes that the propensities are approximately linear with respect to population, i.e. having constant rates. Deviation from the linear law is the primary factor influencing simulation error in BNB updating. An important aspect of an approximate BNB updating method is that large and small species populations are treated uniformly, such that the same updating scheme applies to both situations with equal speed and relative accuracy. This may be contrasted to -leap methods, which due to large relative fluctuations of the propensity for small populations are no longer valid except for very short time steps.introduced a hybrid -leap method which simulates species lower than a given population (the 'cutoff') using direct Gillespie algorithm. The tradeoff for the increased accuracy is a much-increased workload, since Gillespie algorithm simulates each reaction event individually. New species, which start as single cells, or species that naturally exist in low abundances are especially susceptible to an increase in workload for finite cutoff.
RESULTS
Exact simulationsIn this section, we will apply the BNB algorithm to examples that can be exactly simulated using BNB. These examples deal with modeling the evolution of heterogenous cell populations in a hypothetical bioreactor designed to maintain exponentially growing cultures. We illustrate several phenomena that have been explored previously in analogous situations, e.g. for populations of fixed size, though we pursue these phenomena in the regime where large fluctuations in total population size (10-fold in most of our simulations) are routine. The following models assume that cells are kept sufficiently dilute in culture such that limiting nutrients and other cellcell interactions are not a factor. These cells thus grow and divide freely. The bioreactor prevents cell cultures from growing too dense by measuring the population size periodically (after every time duration t) and diluting the culture by binomial sampling to the mean population size n min once the population has exceeded the population size n max. In the simulations, we advance time directly from one mutation to the next or until the system has evolved longer than the maximal time duration t, at which point cells may be diluted if the population has exceeded n max. It is also straightforward to simulate a bioreactor that continuously dilutes cultures to stem population growth, where the rate of media turnover and, correspondingly, cell 'death' is controlled, but we do not consider such an case here. An analysis in the Supplementary Material demonstrates that performance of BNB for these situations can far exceed that for direct Gillespie and -leap methods. Abrupt dilution events can greatly enhance the effect of stochasticity, since there is a corresponding reduction in genetic diversity associated with each sub-sampling of the population. The smaller population after a dilution event will be heavily influenced by the particular individuals retained, leading to a form of the founder effect (). Even in light of this fact, we show that many phenomena found for fixed population sizes, e.g. wave behavior for population fitness, also occur using a dilution protocol that might occur experimentally.
Linear fitness modelSuppose that species are characterized by a positive integer index m that is a measure of fitness. Birth rate g m is a linear function of m, g m = 1+(m1). Death rate  m is constant across species. Mutation rate is proportional to growth rate (faster growing species also mutate faster),  m = g m. During a mutation of species with index m, a new member of species with index m1 or m+1 is created, as chosen uniformly at random. If a species withfitness model with t = 0.1, = 10 3 ,  = 10 3 and n min = n max /10. The instantaneous distributions of the populations over the species index normalized by n max as a function of time are shown for n max = 10 4 (A) and n max = 10 5 (B). Wave-like behavior is evident in both cases, though the smaller population leads to a noisier and slower wave. Panels (C) and (D) show the corresponding probabilities averaged over 800 realizations. The wave velocity, by a least squares linear fit to the ensemble mean fitness, is 0.9310 3 and 2.110 3 indices per unit time for (C) and (D), respectively.The wave velocity (indices per unit time) of the linear fitness system has a slow (logarithmic) dependence on the population size set by n max , in agreement with theoretical results () (parameters are the same as in). Blue dots represent individual velocity measurements based on least squares fitting of a line to the last half of the mean index trajectory. Red line shows the least squares fit of the velocity as a linear function of lnn max over the range n max > 10 4. The velocities fromand D are plotted as green squares and diamonds, respectively. (B) Same as (A) for = 10 4 and  = 10 2. The weaker fitness gradient leads to a noisier distribution of velocities.
A B
(For a colour version of this Figure see Supplementary Data online).index m = 1 mutates, a new member of the species with index 2 is always created. It has been demonstrated for >0 in the case of a constant total population that evolution on a linear fitness landscape leads to traveling population waves (), such that the mean fitness of the population linearly grows in time. However, the finite-size stochastic system can only be treated heuristically (), asymptotically (A B C D) derived by least-square fitting of the mean index m across species as a function of time. The model with deterministic alternating fitness and n max = 10 4 (A) or n max = 10 5 (B) leads to a smooth decay of wave velocity with respect to the perturbation amplitude . In contrast, a model with quenched disorder in fitness and n max = 10 4 (C) or n max = 10 5 (D) exhibits an abrupt decrease in wave velocity suggesting a phase transition. In all cases, n min = n max /10,  = 10 3 , = 10 2 ,  m = 0.1, and t = 0.02. The red curve indicates trend lines generated by a SavitzkyGolay filter.
(For a colour version of this Figure see Supplementary Data online).2007;), or under certain specific modeling assumptions (). Thus, exact numerical simulations of large evolving populations in linear fitness landscapes are useful for testing the existing theories. Simulations indeed produce wavelike behavior (). The wave velocity scales linearly with the logarithm of the population size, as predicted (). We used similar simulations to study the effects of quenched fitness fluctuations on the propagation of traveling evolution waves. This problem is qualitatively analogous to the models of transport in systems with quenched disorder that are known to exhibit phase transitions (), and we expect similar behavior for evolution in a linear model with quenched disorder in the growth rate law. We assumed that the fitness as a function of the species index m has a fluctuating piece in addition to the linear dependence. Specifically, we consider growth rates that vary as gm = 1+(m1+Rm1+ m1+R m ), where   0 provides the scaling of noise, andRand andR m [0.5,0.5] are independent uniform random numbers. In the case when <1, an increase in m always leads to an increase in growth rate, and wave propagation should proceed but with moderately reduced velocity. The case with >1 is qualitatively different, since an increase in m need not imply an increase in fitness. In this regime, it is possible to form rare but wide barriers due to fluctuations in the fitness, and these barriers when they exist can trap the system for an exponentially large time. This case can be contrasted against a potential with similar but deterministic variation g (a) m = 1+(m 1+((m mod 2)0.5)), which for >1 has fitness barriers only a single species wide.shows that quenched disorder exhibitssubstantially different behavior than the case when fitness contains regular variation. The system with quenched disorder in particular exhibits a sharp decrease in wave velocity as disorder is increased to >1, akin to a phase transition.
W.H.Mather et al.
A B
NK model simulations Dueto the general way the BNB algorithm treats mutations, it can be applied to more complicated evolutionary models. We used a variant of the NK model () to simulate evolution on fitness landscapes with various degrees of ruggedness. Despite large fluctuations in population, we could reproduce classical results for NK models, including state-dependent wave speed for smooth fitness landscapes, and punctuated evolution for rugged landscapes. Results and analysis of this model are found in the Supplementary Material.
BNB as an approximate algorithm: evolution in nutrient-limited environmentsBNB can also be applied as an approximate algorithm for systems with state-dependent growth rates. Propensities may deviate from the linear law assumed in the BNB algorithm, but the BNB algorithm may still approximate a system with non-constant birth, death and mutation rates by evolving the system with a BNB step restricted to a short duration . Rates are then updated using the new populations before integrating the system with another BNB step, and so on. Validity of this process depends on self-consistency of the assumptions in the BNB algorithm, especially that propensities for reactions are independent of other species and proportional to population (see Supplementary Material for details). We checked performance of this approximate algorithm for a system in which several species compete for a common nutrient that is supplied at a constant rate. Different species can consume this nutrient with different effectiveness, which provides selective pressure. Specifically, we suppose a linear fitness model for species,, with species index m,  = 10 3 , and a scaling factor = 1. In contrast to the other simulations in this text, birth rates are coupled in such a way that the total population in the system autonomously relaxes on average to a fixed value  n  10K 0 without the need of dilution events triggered by the population. The evolution of the system is linked to the ratio of growth rates g m1 /g m2 = a m1 /a m2 , which indicates that species with a higher index m tend to grow faster than those with lower index. Due to this effect, the system exhibits wave-like behavior ().. Simulation accuracy for the model with competition. Using BNB (red), hybrid -leap (dashed blue) or direct SSA (light green), the model (with K 0 = 1000 and initial population = 100) was simulated over 10 5 realizations. As a measure of error, statistics of the population of the first mutant (index=2) were examined at time t = 50. (A) The histogram (bin width= 250) of this population for simulations using step size  = 5. BNB matches direct simulation closely, while hybrid -leap with cutoff 10 suffers from major inaccuracies. (B) L 2 error between the histogram of direct SSA simulation and that of either BNB or the hybrid -leap normalized by the minimal expected statistical deviation, see Supplementary Material for details. (C) Same as (B), but as a function of the cutoff value for the hybrid -leap algorithm with  = 5. (D) Mean workload of the hybrid -leap and the approximate BNB algorithms, normalized by the workload for the BNB algorithm, as a function of the cutoff value.
A B C D
(For a colour version of this Figure see Supplementary Data online).The recurrent creation and subsequent growth of new species in the competition model suggests that BNB could maintain better accuracy than -leaping schemes, since BNB faithfully simulates arbitrarily small populations and also exponential growth. We tested this for short-time simulations, and we found that in this context that BNB can provide consistently increased accuracy when compared to a hybrid -leap algorithm ().
DISCUSSIONIn this article, we have proposed an algorithm, which can be used to sample exactly co-evolving species that do not interact between mutations, and faithfully approximate the evolution of weakly-interacting species. BNB algorithm not only accounts for the stochastic fluctuations that arise due to the random nature of genetic mutations, but it also accounts for the small-number fluctuations due to the growth of new species that are spawned as single cells. Each iteration of the BNB algorithm generates the time of the next mutation and the abundances of all species just after the mutation. This algorithm is exact when the birth, death and mutation rates do not change between consecutive mutations. Although similar in spirit to approximate leaping schemes developed for modeling stiff stochastic chemical kinetics (), it differs significantly by providing an
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
