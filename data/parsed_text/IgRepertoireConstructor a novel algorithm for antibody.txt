The analysis of concentrations of circulating antibodies in serum (antibody repertoire) is a fundamental, yet poorly studied, problem in immunoinformatics. The two current approaches to the analysis of antibody repertoires [next generation sequencing (NGS) and mass spectrometry (MS)] present difficult computational challenges since antibodies are not directly encoded in the germline but are extensively diversified by somatic recombination and hypermutations. Therefore, the protein database required for the interpretation of spectra from circulating antibodies is custom for each individual. Although such a database can be constructed via NGS, the reads generated by NGS are error-prone and even a single nucleotide error precludes identification of a peptide by the standard proteomics tools. Here, we present the IGREPERTOIRECONSTRUCTOR algorithm that performs error-correction of immunosequencing reads and uses mass spectra to validate the constructed antibody repertoires. Availability and implementation: IGREPERTOIRECONSTRUCTOR is open source and freely available as a Cþþ and Python program running on all Unix-compatible platforms. The source code is available from http://bioinf.spbau.ru/igtools.
IntroductionUntil 2009, the computational analysis of antibodies had been performed via proteomics techniques () and had not utilized DNA sequencing technologies.were the first to demonstrate the power of DNA sequencing for analyzing antibody repertoires and to open a 'next generation sequencing (NGS) era' in antibody analysis (). Although this study was quickly followed by many other immunosequencing (Ig-seq) studies (); until 2012, there were no attempts to integrate NGS and mass spectrometry (MS) approaches for antibody analysis. Such integration (immunoproteogenomics) is important since it represents a bottleneck for an emerging approach that promises to transform the antibody industry from focusing on single (monoclonal) antibodies, toward analyzing polyclonal antibodies.pioneered a new immunoproteogenomics approach for identification of circulating monoclonal antibodies from serum that enables high-throughput antibody development. Although sequencing purified monoclonal antibodies has now become routine (), sequencing multiple antibodies from a complex sample represents a breakthrough with great biomedical potential. The important conclusion in
i53This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.comshould combine NGS and MS to infer antibodies interacting with a specific antigen (see also). In particular,showed that the most well represented transcripts in the antibody repertoire (revealed by NGS alone) may not be the most biomedically relevant. Thus, immunoproteogenomics is the key ingredient of the emerging new technology for antibody analysis. However, no publicly available immunoproteogenomics software is currently available. An antibody repertoire (rather than a set of all DNA reads as in previous immunoproteogenomics studies) represents a sensible choice of a database for the follow up MS/MS searches. However, construction of an antibody repertoire is a difficult problem since antibody genes in antigen stimulated B-lymphocytes are not directly encoded in the germline but are diversified by somatic recombination and mutations (). Therefore, the protein database required for the interpretation of mass spectra from circulating antibodies differs between individuals. Moreover, even a single error in an error-prone NGS read precludes identification of a peptide (spanning the erroneous position) by the standard proteomics tools. We emphasize that construction of antibody repertoires is a different problem than the well studied VDJ classification () and CDR3 classification () problems. In fact, VDJ classification, CDR3 classification and repertoire construction are three different clustering problems with increasing granularity of partitions into clusters and different biological applications: @BULLET VDJ classification refers to classifying reads into 225  30  13 clusters (since human genome has 225 V, 30 D and 13 J functional and complete antibody gene-segments). There is currently a multitude of VDJ classification tools, e.g. Bonissone and Pevzner (2015) report 94.5, 99.1 and 99.4% accuracy for V, D and J gene segments, respectively. @BULLET CDR3 classification is a more granular clustering that refers to classifying reads according to their CDR3 region, the most biologically important segment of an antibody. @BULLET Full length antibody repertoire classification is the most granular clustering of antibodies that extends the above two clustering approaches by accounting for somatic hypermutations (SHMs). It is arguably the most biologically relevant clustering and a prerequisite for the future studies of antibody evolution.The antibody repertoire can potentially subpartition each VDJ class/CDR3 class into thousands of subclusters based on the identity of CDR regions and hypermutations. Because various antibodies often share similar segments, the computational challenge of antibody clustering is not unlike the computational challenge of classifying repeats in a genome. From this perspective, the VDJ classification corresponds to distinguishing between different families of repeats (e.g. between Alu and MIR repeats in the human genome), while constructing antibody repertoires corresponds to a very different algorithmic problem of classifying different subfamilies within the same repeat family, e.g. distinguishing between AluJ and AluY repeat subfamilies () on the challenge of the repeat subfamily classification). Until recently, there were no attempts to cluster full length antibodies since it was nearly impossible to derive an accurate antibody repertoire with previous experimental approaches based on errorprone and low coverage 454 sequencing technology. MiGEC () is the only tool for the full length repertoire analysis that, however, is not applicable to standard Ig-seq protocols since it requires a special barcode-based sample preparation.(a) An overview of immunoglobulin (Ig-seq) sequencing. Briefly, B-cells are isolated; transcripts are purified; antibody chains are amplified by PCR; and finally, paired-end sequencing of the Ig variable region is performed on the amplified Ig transcript molecules. (b) An antibody repertoire containing five different antibodies (shown on the left) is characterized by a set of pairs <sequence, abundance > (shown on the right). For example, the abundance of the 'red' antibody is 3. (c) The varying levels of sequence information. First, the paired reads are stitched together to form contiguous reads. These reads are then compressed to unique reads with count information, and finally clustered reads. E.g. the red and blue unique reads (with counts 3 and 1) are clustered into a single cluster with count 4 because they represent reads (with errors) derived from the same antibody. (d) Reads are partitioned according to identical CDR3 sequences (shown in the black rectangles). Each resulting cluster of antibodies is referred to as a clone i54 Y.Below we summarize the new contributions of this work to immunoproteogenomics: @BULLET The crucial distinction between the previous Ig-seq studies () and the one presented [with a notable exception of], is the number of reads. Our Ig-seq runs capture %3.8 million reads, compared with the thousands of reads obtained with 454 sequencing technology that dominated Ig-seq prior to 2014. This allows for greater depth in characterizing the repertoire and immunoproteogenomics analysis, but comes with its own set of computational challenges. @BULLET Although Ig-seq studies have been rapidly developing in the last 5 years, the error-correction techniques from genome sequencing () have not been applied to Ig-seq yet and the previous immunoproteogenomics studies have not attempted to construct antibody repertoires for the follow up MS/MS searches. Some other studies did perform a simple variant of error correction in the context of VDJ labeling (). However, since these studies addressed a relatively simple task of VDJ classification rather than repertoire construction, they have limited ability to correct errors in the most important CDR regions that do not contribute to VDJ classification. IGREPERTOIRECONSTRUCTOR is the first tool for generating antibody repertoires from standard Ig-seq protocols. @BULLET In addition to the problem of constructing an antibody repertoire, there is also a challenge of validating this repertoire. Indeed, since there is no gold standard that represents a curated and verified antibody repertoire, it is not clear how to validate the accuracy of the constructed repertoires (on real rather than simulated data). We show that immunoproteogenomics allows one to resolve this Catch-22 and to evaluate the accuracy of the antibody repertoire (due to the complementary nature of errors in DNA reads and in peptides identified by MS). @BULLET Immunoproteogenomics analysis of circulating antibodies requires searches of all spectra against a highly repetitive database derived from millions of Ig-seq reads.found surprisingly few Peptide-Spectrum Matches (PSMs) from spectra they analyzed suggesting that many spectra evaded the identification either due to errors in NGS reads or due to statistical artifacts of searches in a highly repetitive database. Recently,discussed the challenge of peptide identification in large highly repetitive database of antibodies that is further amplified by the limitations of the target-decoy approach (). We argue that construction of the antibody repertoire enables a new multi-layer approach to immunoproteogenomics searches (each layer corresponds to antibodies with abundances falling into specific intervals) that significantly boosts the number of identified PSMs [% 22% of spectra are identified at 1% false discovery rate (FDR) as compared with % 6% at 2% FDR identified in. @BULLETraised a concern about the lack of correlation between genomics-based and proteomics-based quantification of antibodies (that far exceeds the commonly observed limited correlation in traditional proteogenomics studies (). However, since previous immunoproteogenomics studies were based on low-coverage 454 technology, it was not clear whether this lack of correlation represents sampling artifacts or reflects the fact that previous immunoproteogenomics studies did not correct sequencing errors. Our analysis of Illumina datasets (orders of magnitude increase in coverage as compared with previous immunoproteogenomics studies) revealed an even more alarming lack of correlation between two approaches to quantification: more than half of identified peptides come from antibodies that are represented by a single read in the antibody repertoire! However, we show that switching from quantification of individual antibodies, to quantification of antibody clones, partially restores correlation between genomicsbased and proteomics-based quantification.
Methods
Antibody repertoiresIf we view an antibody as a center of a cluster formed by reads derived from this antibody, then construction of a repertoire corresponds to a difficult clustering problem with many closely located centers so that the radius of a cluster may exceed the distance from one cluster to another one. Because the standard clustering techniques (like k-means clustering) are not applicable to such problems (), we have designed IGREPERTOIRECONSTRUCTOR, a novel algorithm for constructing antibody repertoires. Each antibody in an antibody repertoire is characterized by its sequence and abundance; estimated by the number of reads derived from this antibody (). The complexity of the antibody repertoire mirrors the complexity of the immune system, e.g. clonal selection leads to a highly uneven distribution of abundances of antibodies (). Abundant antibodies mutate and yield new antibodies that share the same VDJ recombination pattern, but differ only by SHMs. As a result, the antibody repertoire contains a mixture of closely related antibodies with differing abundances. The abundances of % 2:3 million antibodies in our dataset vary from 1 to % 33; 000 with the most abundant antibody representing % 1% of all reads (all examples below refer to the heavy chain Ig-seq dataset described in the 'Section 3.1'). The major challenge in constructing antibody repertoires is the identification of all reads that are derived from a single antibody. If reads were error-free, we would simply group together reads that are identical (up to small shifts) into unique reads to generate an antibody repertoire. In reality, reads are error-prone necessitating errorcorrection of reads prior to any analysis. IGREPERTOIRECONSTRUCTOR error-corrects reads; partitions them into clusters; and computes the consensus sequence and abundance of each antibody.depicts the different levels of clustering performed by IGREPERTOIRECONSTRUCTOR. First, we computationally stitch pairedend reads of Ig molecules to derive the contiguous Ig-seq reads. Subsequently, the Ig-seq reads are grouped together to provide unique Ig-seq reads. Finally, the unique reads are clustered to obtain clustered Ig-seq reads (antibodies). In addition, we can represent antibodies according to the somatically recombined B-cell from which they originate, i.e. their clonality. We define an antibody clone as the set of all antibodies in the repertoire with the same CDR3 sequence [as determined by IgBlast (.diagrams this clone identification process. A clone is trivial if it consists of a single cluster and non-trivial otherwise. The sharp distribution of clone sizes (Supplementary) can be attributed to B-cell response to an antigen, i.e. clonal selection ().
Limitations of existing error correction toolsAt first glance, it appears that the problem of error-correction in Ig-seq is not unlike the problem of error-correction in genome assembly (). However, popular error-correction IgRepertoireConstructor i55 tools, e.g. Quake () or BayesHammer (), that were optimized for genome assembly, are not suited for Ig-seq data. Indeed, Ig-seq data contain a large number of sequences differing by very few mismatches or indels, and feature the extremely uneven coverage of various antibodies by reads (since abundances of antibodies differ by orders of magnitudes). Both Quake and BayesHammer start by identifying solid k-mers in reads (that are likely to be present in the genome) and use them to correct reads. However, to find solid k-mers, Quake uses the read coverage, an approach that is not applicable in the case of Ig-seq with highly variable abundances. In contrast, BayesHammer (part of the SPAdes assembler,) was designed to assemble single cell sequencing data with uneven coverage. However, it is also not applicable to Ig-seq since an antibody repertoire yields numerous similar, correct, k-mers from different antibodies (Supplementary). BayesHammer is unable to distinguish these correct k-mers from similar incorrect k-mers derived from the same antibody.
Hamming graph for analyzing Ig-seq dataIGREPERTOIRECONSTRUCTOR uses the idea of the Hamming graph for error correction () to correct Illumina reads. With the emergence of longer (250 nt) Illumina reads in 2013 (until 2013, Illumina technology generated shorter reads that did not fully cover the variable region of antibodies), it is now possible to interrogate repertoires using accurate highthroughput Illumina technology. The Hamming distance ds 1 ; s 2  between sequences s 1 and s 2 of equal length is defined as the number of positions where the symbol in s 1 differs from a symbol in s 2 (Supplementary). We extend the concept of Hamming distance to any two sequences (including sequences with different lengths) by considering all sufficiently long overlaps between sequences s 1 and s 2 (longer than the default value d), and computing the Hamming distance between the overlapping parts. We define ~ ds 1 ; s 2  as the minimum of such distances (Supplementary). We define the Hamming Graph HG(Strings) as the complete weighted graph whose vertices correspond to a collection of sequences Strings and the weight of the edge (s 1 , s 2 ) is equal to ~ ds 1 ; s 2 . The Bounded Hamming Graph, denoted HGStrings; s, is a subgraph of the Hamming Graph where edge (s 1 , s 2 ) exists iff ~ ds 1 ; s 2  s. The time-and space-efficient construction of large Hamming Graphs is a challenging problem that was addressed inand adapted in IGREPERTOIRECONSTRUCTOR. Note that compared with Hammer () and BayesHammer (), we construct the Bounded Hamming Graph on the entire reads (rather than on k-mers) and use the generalized Hamming distance.
Repertoire construction and search for dense subgraphsWe construct an antibody repertoire by partitioning reads into clusters that correspond to the same antibody. Our goal is to place reads differing by sequencing errors into the same cluster, while placing reads corresponding to different antibodies into different clusters. This becomes difficult since the number of errors in a read from a given cluster may be larger than the number of differences between antibodies from different clusters. We define the antibody sequence as the consensus of reads in a cluster, and its abundance as the number of reads in a cluster. Because Illumina reads have a small indel rate, the generalized Hamming distance between reads from the same cluster should be low. We thus construct the Bounded Hamming Graph HGReads; s from all reads. Our analysis revealed that the generalized Hamming distance for most Ig-seq reads, originating from the same antibody, does not exceed 3 and that many antibodies form complete, or nearly complete, subgraphs of the Bounded Hamming Graph with s  3 (Appendix A). Ideally, we would like to choose s in such a way that HGReads; s is a clique graph, i.e. a graph where each connected component is a complete subgraph (clique). In reality, the large connected components of the Bounded Hamming Graph often have a more complex structure. Given a connected component with m edges and n vertices, we define its edge fill-in as the ratio of the number its edges (m) to the maximal possible number of edges in the graph on n vertices). Additional analysis of the connected components reveals that the nearly all of them (98.6%) consist of dense (complete or nearly complete) subgraphs connected by very few edges. Most vertices in these dense subgraphs correspond to error-prone reads derived from a single antibody or from highly similar antibodies differing from each other by a small number of SHMs.Thus, the first step in constructing an antibody repertoire is solving a very large instance of the Corrupted Cliques Problem: finding the smallest number of additions and removals of edges that transform the Bounded Hamming Graph into a clique graph. Although there exist a number of algorithms for solving the Corrupted Cliques Problem (such as CAST;), they are too slow for the Bounded Hamming Graphs with many vertices. We thus developed a different approach for analyzing the Bounded Hamming Graph that is based on transforming it into a triangulated graph (i.e. a graph where every cycle of length longer than three has a chord) rather than a clique graph using the Minimum Fill-in Problem ().
Repertoire construction and minimum fill-in problemThe minimum fill-in edge-set for a graph is the edge-set of minimal size whose addition turns this graph into a triangulated graph. We are interested in triangulated graphs because maximal cliques in these graphs can be generated in polynomial time () and because maximal cliques in the triangulated Bounded Hamming Graph help to reveal dense subgraphs of the original Bounded Hamming Graph (Appendix B for details). Although the Minimum Fill-in Problem is NP-complete (), there exist efficient approximation algorithms for solving it, e.g. METIS algorithm (). The METIS algorithm is based on the equivalence between triangulated graphs and perfect elimination orderings. A perfect elimination ordering in a graph is such an ordering of its vertices that, for each vertex v, v and the vertices following it in the order, form a clique (Supplementary). A graph is triangulated if and only if it has a perfect elimination ordering (). METIS finds an ordering that generates an approximation of a minimum fill-in edge-set and this ordering can be used for finding cliques in the triangulated graph (). As we mentioned earlier, these cliques correspond to dense subgraphs in the original graph. To construct maximal dense subgraphs, we additionally merge subgraph connected by many edges. IGREPERTOIRECONSTRUCTOR solves the Minimum Fill-in Problem in the Bounded Hamming Graph using METIS and converts its solution into a list of dense subgraphs in the original Bounded Hamming Graph. Note that some of the resulting dense subgraphs may share vertices forcing us to assign these shared vertices to one of the dense subgraphs. To assign a vertex v to a single dense subgraph, we select a subgraph with maximum number of vertices adjacent to v. Thus, dense subgraphs generated by METIS provide us with a vertex decomposition of the Bounded Hamming Graph. A vertex decomposition of the graph inis shown in(top right). Analysis of all found subgraphs in the decomposition of the Bounded Hamming Graph reveals that the lion's share of them have high edge fill-ins (the average edge fill-in is 0.94), thus confirming that IGREPERTOIRECONSTRUCTOR indeed finds dense subgraphs of the Bounded Hamming Graph. The histogram of edge fill-in for all subgraphs in this decomposition is shown in Supplementary. Dense subgraphs correspond to clusters of Ig-seq reads representing either identical or very similar antibodies (i.e. antibodies differing by very few substitutions). However, to construct the antibody repertoire, we need to further partition some of the dense subgraphs (that correspond to multiple antibodies) into subgraphs corresponding to single antibodies. To illustrate this challenge, consider the SHM-triggering patterns RGYW/WRCY () and define an edge in the Bounded Hamming Graph as anIgRepertoireConstructor i57 SHM-edge if at least one mismatch on this edge conforms to the RGYW/WRCY motif.(bottom left) shows the Bounded Hamming Graph where the SHM-edges are highlighted in orange. This coloring reveals that the yellow dense subgraph in(upper right) corresponds to two similar antibodies rather than to a single one. Indeed, the multiple alignment of reads corresponding to the yellow subgraph shows a mismatch in the CDR1 region which separates reads into two groups (right panel of). Thus, we need to split the constructed dense subgraphs using detected SHMs. The final solution is shown in(bottom right) and illustrated in. See Appendix C for more details on splitting dense subgraphs, and Appendices D and E on benchmarking of IGREPERTOIRECONSTRUCTOR on real and simulated antibody Ig-seq datasets.
<-CDR1-> 100
Immunoproteogenomics searchThe previous immunoproteogenomics studies () conducted searches on a database of unique Ig-seq reads that we refer to as unique reads database. We argue that a better option is the antibody repertoire database (formed by centers of clusters constructed by IGREPERTOIRECONSTRUCTOR) as it eliminates many sequencing errors. Furthermore, to assess the divergence from reference gene-segments, a dataset of canonical V, D and J gene-segments was searched; this database is termed the canonical VDJ database. In order to obtain peptide identifications from the constant region, we also included all 41 intact variants of the constant region, obtained from the IMGT repository (). These sequences are concatenated to the VDJ database. Proteomic searches were conducted using MS-GF () on partially digested peptides (e.g. for trypsin, semi-tryptic peptides were considered). The FDR was controlled by selecting a MS-GF threshold of spectral probabilities such that we maintained a 1% FDR. Supplementaryshows the distribution of spectral probabilities for the target and decoy datasets. Blind modification searches were performed using MODa (), allowing for a single modification with mass between 200 and 200Da. Peptides with at least one enzymatic end were considered and a 1% FDR was enforced. As discussed in, immunoproteogenomics searches require new algorithmic and statistical approaches since the standard peptide identification algorithms were not designed for searches in large and highly repetitive immunoproteogenomics databases. We argue that yet another key difference between the standard and immunoproteogenomics searches is that, in the latter case, after constructing the antibody repertoire, we have information about antibody abundances. Because higher-abundance antibodies are more promising candidates for spectral searches than lowerabundance antibodies (despite limited correlation between genomics-and proteomics-derived abundances), we partition all antibodies into layers according to their abundances. The rationale for such partitioning is that higher-abundance antibodies form much smaller protein databases than lower-abundance antibodies. For example, there are 1564, 10 782 and 48 564 antibodies with abundances in the intervals from 100 to 30 000, from 10 to 99 and from 2 to 9, respectively. This contrasts with 2 267 863 singleton antibodies with abundance 1. Thus, since E-values of PSMs rapidly deteriorate with the increase in the database size (), we partition all antibodies into four layers (according the abundance intervals specified earlier) and employ a separate 1% FDR control, for each layer, based on selecting a spectral probability threshold in MS-GF. Note that our multi-layer approach is very different from the two-stage MS/MS search approach with logical dependencies between two stages. Because there are no such dependencies in the multi-layer approach, the controversy about the statistical foundations of the two-stage approach () does not extend to our multi-layer approach.
Discussion
DatasetsWe have benchmarked IGREPERTOIRECONSTRUCTOR on multiple Mi-Seq and Orbitrap datasets. Below we only describe the results for a single heavy chain dataset. Similarly to BayesHammer, the running time of IGREPERTOIRECONSTRUCTOR is dominated by the construction of the Bounded Hamming graph (% 5 h for the heavy chain dataset). All further steps (finding and splitting dense subgraphs, etc.) took > 30 min on a single thread. MS searches and subsequent cluster/clone peptide assignments took % 8 h.
Ig-seq datasetThe Ig-seq library contains overlapping paired-end reads that cover the variable region of heavy chain (3.83 million 250-nt long reads with average insert size 366 nucleotides). We pre-process the Ig-seq library by merging overlapping paired-end reads, and removing contaminants as described in Appendix F. After pre-processing, IGREPERTOIRECONSTRUCTOR generated 2 925 095 unique reads, 2 406 121 clustered reads and 586 341 clones. See Appendix G for the analysis of contaminants.
Spectral datasetWe analyzed CID tandem mass-spectra generated using the following digestive enzymes; AspN (21 385 spectra), chymotrypsin (24 956 spectra), trypsin (26 740 spectra) and elastase (20 604 spectra). Enzymes with differing cleavage specificity improve coverage over the length of the antibody sequence. We searched spectral datasets against the protein databases derived from the antibody repertoire. Three-frame translations were created for each antibody in the repertoire, and any frames containing a stop codon were discarded; 165 675 antibodies (%7%) had a stop codon in all frames.
Analysis of antibody repertoiresBelow we compare the repertoires formed by unique reads and by IGREPERTOIRECONSTRUCTOR. To compare the repertoires, we used various metrics measuring cluster sizes [# clusters, # singletons (single-element clusters), max cluster size, # clusters of size exceeding X (where X is a parameter)] as well as metrics based on CDR3 analysis (see Appendix H for more details).illustrates that IGREPERTOIRECONSTRUCTOR generates a rather different (more compact) representation of antibodies than the set of unique reads used in previous immunoproteogenomics studies.shows the number of identified peptides and PSMs. Modified peptides are considered identical to those without modifications should their sequences be the same; and hence are not counted when considering unique peptides. Note the large number of peptides identified only with modifications (i.e. unmodified versions of these peptides were not identified) suggesting that future immunoproteogenomics searches should include search for posttranslational modification (PTMs). Overall, we identify nearly 13% of all spectra when performing restrictive PTM searches at 1% FDR. The number of identified peptides is further boosted when employing a multi-layer strategy, noted by the 'layer' column in the table. Blind modification search was performed on the trypsin dataset only (since MODa is not designed for spectral datasets generated with other digestive enzymes). MODa identified 3334 PSMs with modifications, corresponding to 970 peptide IDs; 815 of which were identified only by the blind modification search. It brings the total percentage of identified spectra to % 22:6% at 1% FDRidentified 6% of spectra at 2% FDR]. See Appendix I on specific modifications found by our blind search.shows the breakdown of the origin of each identified peptide.
Peptide identifications
Assigning peptides to multiple antibodiesInterestingly, only 67 124 antibodies (2.6% of all antibodies) did not encode any identified peptide. Moreover, as expected, these are mainly antibodies with minimal abundance 1 (total abundance of these 67 124 antibodies is 73 764 and maximal abundance is 300). This (surprisingly) low number of antibodies with no peptide evidence is due to the fact that many identified peptides map to multiple antibodies. As a result, the number of antibodies A in a repertoire R encoding a peptide P is often large. We define exclusivity score of a peptide as exclusivity P; R  1/number of antibodies in R encoding P and exclusivity score of an antibody as exclusivity A; R  X all peptides P mapping to A exclusivityP; R. The exclusivity score distribution of the antibodies, seen in, shows few antibodies having peptides exclusive to them alone [onlyThe number of peptide identifications at an 1% FDR cutoff for each spectral dataset. For example, a 1% FDR cutoff corresponds to a spectral probability cutoff of 1:4e08 for AspN, 2:3e10 for chymotrypsin, 7:5e10 for trypsin and 3:8e10 for elastase datasets, when searching antibodies with the constant region appended, and restrictive PTM search. The total column shows the number of total peptides, or PSMs, across the four different MS datasets. The total % column shows the percentage of identified spectra, among all spectra. The 'layer' column denotes the type of search; single layer (s), or multi-layer (m). The restrictive MS-GF searches for PTMs were conducted by searching for carbamidomethyl (C  57) as a fixed modification, oxidation of methionine, oxidation (single and double) of tryptophan, and N-terminal pyroglutamate (Q-17, E-18) as optional modifications.and CDR3 shown in gray as determined for a single cluster. Coverage is normalized for shared peptides using their exclusivity scores. (c) Origin of identified peptides. For each identified peptide, a representative cluster sequence was used to determine from which reference segment it originated; V, D or J. Each peptide is classified as V-, D-or J-peptide depending on whether it overlaps with segments marked as V, D or J regions for the heavy chain sequence (peptides spanning more than one region, e.g. V and J, are classified as both V-peptides and J-peptides)The avg. clone divergence metric is computed as the fraction of the number of columns in the multiple alignment of all antibodies in a clone that have mutations or indels. The avg. non-trivial clone divergence shows the average clone divergence computed over all non-trivial clones.
IgRepertoireConstructor i591472 antibodies with exclusivity A; R > 1:0].shows the peptide coverage over the position of each clone. Supplementaryillustrates the peptide coverage of a single clone.
Correlation between Ig-seq and MS/MS abundancesTo compare the relation between peptides and their Ig-seq counterparts, we introduce the notions of total Ig-abundance and maximal Ig-abundance of a peptide. Total (maximal) Ig-abundance of a peptide is the total (maximal) abundance of antibodies that encode this peptide. Supplementaryshows the relation of the total Ig-abundance for each peptide to its spectral count (number of PSMs). Supplementaryshows a histogram of spectral peptide counts binned over maximal Ig-abundance for each peptide. A strikingly large number of peptides, 2702, can be attributed to singleton antibodies. The remarkable lack of correlations between genomics-based and proteomics-based abundances further amplifies the concern first expressed in Cheung et al. (2012). Supplementaryshows the correlations between clone abundances measured by MS/MS and Ig-seq (compare with Supplementarythat measures antibody, rather than clone, abundance). These plots show the difference when considering the unit of a repertoire (antibody), and the unit of antibody evolution (the clone) raising the concern that Ig-seq data do not adequately represent antibody abundances. When considering only the antibodies, there is no correlation with the MS evidence, as previously reported by. However, when considering the amalgam of antibodies forming each clone, a moderate correlation emerges (q  0:5687614). One possible explanation is that certain antibodies, within highly expressed clones, are not captured by MS.
ConclusionOur study is the first to validate the constructed antibody repertoires (by using complementary proteomics data) that confirmed that IGREPERTOIRECONSTRUCTOR generates accurate repertoires. With an accurate tool for constructing antibody repertoires, we can move to studies of evolution of antibody repertoires, the analysis that has not been possible in the past. Because analysis of antibody repertoires is not unlike analysis of repeat subfamilies, the existing algorithms for analyzing repeat evolution () can be applied to study evolution of antibodies. We also addressed the problem of peptide identification in large and highly repetitive databases by designing multi-layer immunoproteogenomics search algorithm. Finally, we revealed an alarming lack of correlation between NGS-based and MS-based quantitation of antibodies
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Y.Safonova et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
