Motivation: Gene set analysis is a popular method for large-scale genomic studies. Because genes that have common biological features are analyzed jointly, gene set analysis often achieves better power and generates more biologically informative results. With the advancement of technologies, genomic studies with multi-platform data have become increasingly common. Several strategies have been proposed that integrate genomic data from multiple platforms to perform gene set analysis. To evaluate the performances of existing integrative gene set methods under various scenarios, we conduct a comparative simulation analysis based on The Cancer Genome Atlas breast cancer dataset. Results: We find that existing methods for gene set analysis are less effective when sample heterogeneity exists. To address this issue, we develop three methods for multi-platform genomic data with hetero-geneity: two non-parametric methods, multi-platform Mann–Whitney statistics and multi-platform outlier robust T-statistics, and a paramet-ric method, multi-platform likelihood ratio statistics. Using simulations, we show that the proposed multi-platform Mann–Whitney statistics method has higher power for heterogeneous samples and comparable performance for homogeneous samples when compared with the existing methods. Our real data applications to two datasets of The Cancer Genome Atlas also suggest that the proposed methods are able to identify novel pathways that are missed by other strategies. Availability and implementation: http://www4.stat.ncsu.edu/ *jytzeng/Software/Multiplatform_gene_set_analysis/
INTRODUCTIONHigh-throughput genome-wide assays, such as microarray and next-generation sequencing, have become more reliable and affordable. With the ever-increasing throughput and the scale of omics studies, more and more projects choose to measure multiple genomic features (e.g. gene expression, methylation, gene mutation, copy number, promoter binding and protein expression) on the same samples. Evaluating multiple genome features can lead to a better examination of functional responses and provide a comprehensive understanding of the underlying biological mechanisms. In recent years, well-known large-scale projects, such as The Cancer Genome Atlas (TCGA) (2012), the Cancer Cell Line Encyclopedia and the Encyclopedia of DNA Elements, have generated genomic profiles across multiple platforms. In addition, more and more recent projects in the Gene Expression Omnibus contain multi-platform data. With diverse data types from different platforms, it becomes challenging to properly integrate, analyze and interpret the results to obtain biological insights. Gene set analysis is a powerful strategy developed to analyze large-scale profiling data. Instead of studying one gene at a time, gene set analysis focuses on a set of related genes, such as genes in one Kyoto Encyclopedia of Genes and Genomes pathway () or those related to the same Gene Ontology () term. Joint analysis of genes in a set often improves power, especially when the signals of individual genes are moderate. Because the set itself often has biological meanings, gene set analysis also facilitates the interpretation of experiment results and helps to identify important biological findings (). Many methods have been developed to perform gene set analysis in a single platform, for example, Gene Set Enrichment Analysis (GSEA) (), GSA () and Globaltest (). Several review articles have been published that discuss the performances of different gene set methods (). Gene set analysis on multi-platform genomic data is gaining momentum. Approaches can be roughly classified into three different categories, characterized by how the multi-platform information is integrated. The first type performs a gene set analysis on each platform and then combines the single platform information, such as P-values (e.g.). Such a strategy is commonly used when the multi-platform data are from similar, but not identical, samples. The second strategy, such as that used in the SumZ approach of, first sums the gene-specific association score of each platform to compute a multi-platform score for each gene and then uses the gene scores to perform gene set analysis. The third strategy is similar to the second except that it directly derives the multi-platform gene scores using data from all platforms simultaneously. One representative approach is the integrative (INT) approach proposed by, *To whom correspondence should be addressed. which uses a logistic regression with all multi-platform values of a gene as predictors and takes the model deviances as the gene scores for downstream gene set analysis (). Bayesian methods have also been developed to analyze multi-platform genomic data, e.g. iBAG () and PARADIGM (). Compared with traditional gene set methods, Bayesian methods often use extensive knowledge of the biological relationships among different data platforms and/or the interactions between studied genes. Sample heterogeneity refers to molecular and cellular differences among biological samples. Such differences are commonly encountered in complex diseases like cancer, where cases with different genotypes, genomic copy numbers or expression patterns often lead to different disease progressions and treatment strategies (). Several methods have been developed to address sample heterogeneity, e.g. cancer outlier profile analysis (), outlier sum (), outlier robust t-statistics (ORT) (), cancer likelihood ratio statistics (LRS) () and non-parametric change-point statistics (). Although the superiority of these methods over ordinary analysis has been demonstrated with heterogeneous data in a single platform, to the best of our knowledge, there are no corresponding gene set approaches for multi-platform heterogeneous data. The impact of sample heterogeneity on multi-platform analyses can be more substantial than on single platform analyses. First, the level of heterogeneity can be different from platform to platform, e.g. platforms such as somatic mutations and DNA methylation have much higher diversity (heterogeneity) among individuals and samples than DNA copy number (). In addition, the heterogeneous subsets can be different from one platform to another, e.g. some samples might have changes on platform A but no changes on platform B, whereas different subsets of samples have changes on platform B but not on platform A. Such a scenario may lead to power loss due to the attenuation of signals when the association is evaluated across platforms. In contrast, a multi-platform method that can tackle platform-specific heterogeneous data would be able to identify the signals when integrating information across platforms. In this study, we perform simulation studies to systematically evaluate different integrative methods under a range of scenarios. We observe that the true-positive rates (TPR) and the truenegative rates of existing multi-platform gene set methods decrease dramatically when heterogeneity exists. These results motivated us to construct three methods to account for sample heterogeneity in multi-platform gene set analysis: multi-platform MannWhitney statistics (MPMWS), multi-platform outlier robust T-statistics (MPORT) and multi-platform likelihood ratio statistics (MPLRS). We use simulations and real data analyses to demonstrate the utility of these methods under various conditions.
METHODS
TCGA datasetsWe downloaded the TCGA breast cancer data from the National Cancer Institute ftp site in January 2013. We focused on the level 3 gene summary data from RNA sequencing (RNA-Seq), methylation and copy number variation (CNV) and extracted 530 common samples (480 case samples and 50 control samples) and 10 371 common genes shared among the three platforms. For RNA-Seq data, the log2 reads per kilo base per million were used as gene expression values. Before the log2 transformation, a minimal value (0.0001) was added to prevent infinite values. For methylation, the mean beta values of all of the probes mapped to a gene were first computed and then converted into an M value for each gene (). The CNV values were provided in log2 format. Within each platform, the data were standardized to have mean 0 and standard deviation 1. The TCGA breast cancer data were used to perform simulations and a real data analysis. We also performed a data analysis on the TCGA Kidney Renal Clear Cell Carcinoma (KIRC) dataset, for which we applied the same procedures of data processing and obtained 486 common samples (463 case samples and 23 control samples) and 11 182 common genes shared among the three platforms of methylation, CNV and RNA-Seq data.
Simulations designWe generated simulated data based on the TCGA breast cancer dataset, which contains 480 cancer samples and 50 control samples (i.e. the case proportion  91%). First, we created 207 non-overlapping gene sets by randomly drawing genes from the 10 371 genes without replacement. The sizes of the 207 gene sets were randomly determined based on the size distribution of the MSigDB canonical pathways (). The genomic data for cases and controls were simulated using the scheme described in the Tyekucheva study (). In short, we first shuffled the casecontrol labels to remove any association that may exist in the original data. Then, we randomly selected 10 gene sets as causal gene sets and 'spiked in' signals into the causal gene sets as detailed below. We performed 300 replicates for each simulation scenario. (A) Simulation with homogenous samples. Given a causal gene set, we randomly selected % (25, 50 or 75%) of the genes as causal genes. For each causal gene, one platform was randomly selected as causal and k was added to the genomic values of the causal platform for cases. The value of k was derived such that the two-sample t-test between cases and controls had power (0.2, 0.4, 0.6, 0.8 or 0.9). (B) Simulation with heterogeneous samples. We considered two scenarios (referred to as Scenarios B1 and B2) to simulate datasets with sample heterogeneity. In Scenario B1, we followed the simulation scheme for Scenario A, except we randomly selected % (20, 40, 60, 80, 90 or 100%) of the case samples as 'true' cases for each causal gene. In other words, we only 'spiked in' k signals into the (randomly selected) causal platform of the causal gene for the 'true' cases. Because the causal platform of a causal gene was randomly selected, the causal genes in a platform are different from each other (although there may be some overlaps). In Scenario B1, there is only a single causal platform for each causal gene for the 'true' cases. In real biological situations, we often see genes that have changes in multiple platforms. To account for these scenarios, we considered Scenario B2, in which each causal gene is allowed to have changes in more than one platform. Specifically, let w be the number of causal platforms of a casual gene; then, the probability of w  1, 2, 3 is (4=8, 3=8, 1=8), respectively. That is, we first determined the number of causal platforms from binomial (3, ) and then converted w  0 to w  1. We then added k values to the genomic data of the causal platform(s) of a causal gene for the 'true' cases. from the R/Bioconductor package 'limma' () and obtained P-values for each gene set. The ranks of the gene scores were used instead of the actual scores (). We selected different thresholds of P-value cutoff and computed the TPR, i.e. the percentage of the causal gene sets truly identified, and the false-positive rate, i.e. the percentage of non-causal gene sets falsely identified as causal gene sets. We plotted the receiver operating characteristic (ROC) curves to compare the performances of the different methods using R. Below; we describe how different methods obtain the multi-platform gene scores considered in the simulation study. Integrative (INT) analysis (): For each gene, regress the disease status on the genomic variables from all platforms using a logistic regression model. The multi-platform gene scores are computed by taking the differences of the deviances between the null models (excluding genomic predictors) and the full models (including all genomic predictors). Hotelling's T2 (HT2): For each gene, perform the Hotelling's T2 test to conduct a case control comparison using the genomic variables from all platforms (). The multi-platform gene scores are the Hotelling's T2 statistics. SumZ (): For each gene at each platform, calculate the association score (tstatistics). Next, use permutations to obtain the null distribution of the t-statistics within each platform. Then, standardize the t-statistics of each gene based on the null distributions. Finally, for each gene, obtain the gene scores by taking the sum of the standardized values across different platforms.Deviance summarization: For each gene at each platform, fit the logistic regression under the null model (i.e. excluding the genomic variable) and under the full model (i.e. including the genomic variable). Next, obtain the deviance difference between the two models. Finally, for each gene, take the average of the deviance difference across platforms as the multiplatform gene scores (referred to as AveD). The method of MaxD is obtained in the same manner except that the maximum is used rather than the average. Single platform method (benchmark): For each gene at each platform, perform the same analysis as described in 'deviance summarization'. Then, obtain the single-platform gene scores by taking the deviance difference between the null model and the full model. We applied this strategy on methylation, CNV and RNA-Seq expression platforms and referred to the corresponding methods as Methy, CNV and Exp, respectively.
Multi-platform methods for gene set analysis accounting for sample heterogeneityWe constructed three multi-platform methods to address sample heterogeneity. Specifically, we extended two current methods designed for single platform analysis to the multi-platform setting, i.e. MPORT [based on ORT of] and MPLRS [based on LRS of. We also developed a non-parametric method, MPMWS, which obtains the gene scores based on the MannWhitney statistics and does not assume symmetric distributions for the genomic variables. The general procedure of multi-platform heterogeneous methods is as follows. Assume that there are M genes and L platforms measured from n 0 control samples and n 1 case samples (i.e. in total, n  n 0  n 1 samples). Let x im' be the observed value of the genomic variable for gene m and platform ' of sample i. For each gene, use the single platform method to compute association statistic T m' for platform '. Next, similar to the SumZ method, use permutations to obtain a null distribution of the statistics for platform '. Finally, calculate the standardized gene statistics within platform ', denoted by T 0 m' , using the mean and standard deviation (denoted by T ' and S ' , respectively) obtained from the permuted null distribution, i.e.As is done in the SumZ implementation, these scores are made positive by adding a constant, c l , that is the absolute value of the most negative score across the platform. This translation makes all of the T 0 m' values positive but does not change the shape of their distribution. Then, the sum of the standardized gene statistics from each platform defines the multi-platform gene scores:The MPORT, MPLRS and MPMWS methods differ only in how T ml is obtained. We show the formula for computing T m' when detecting 'upregulated' genes. (Here, the term 'upregulated' indicates the increase of numerical values rather than the biological 'turning on' of the gene.) The approaches can be extended to detecting downregulated genes by reversing the signs of the observed values. MPORT: T m' is computed using the ORT method (). For each gene at each platform, calculate the mean absolute deviancewhere IA is an indicator function of event A, q 75case is the 75th percentile of x im' for the case samples and IQR case is the interquartile range of the case samples. MPLRS: T m' is computed using the LRS method (). For upregulated genes, the genomic data are sorted from the smallest to the largest under the constraint that all controls are ranked lower than cases.MPMWS: T m' is computed using the non-parametric Mann Whitney change point detection method implemented in R package CPM (). The genomic data are sorted from the smallest to the largest under the constraint that all controls are ranked lower than cases; the MannWhitney U statistic, U k, m' , for each case sample is computed; and T m' is selected as the largest U k, m' ., where n 0  1 k5n: 7
Real data analysisWe performed real data analysis using the methods that have the best performances in the simulation studies (i.e. MPMWS and INT). The 1452 pathways in MSigDB were tested using both the breast cancer and the KIRC datasets, which comprised genomic data from methylation, CNV and RNA-Seq platforms.
RESULTS
Multi-platform methods for gene set analysis with homogenous samples (scenario A)We evaluated the abilities of AveD, MaxD, INT, SumZ and Hotelling's T2 (HT2) to correctly identify causal gene sets under various parameter settings. Single platform methods Methy, CNV and Exp were used to benchmark the performances of the multi-platform methods.shows the ROC plots under different proportions of causal genes in a causal set, i.e.  75, 50, and 25% forC, respectively, while fixing (power) at 0.8 and (percentage of case samples) at 0.91. The corresponding areas under the curves (AUCs) are summarized in Supplementary Table S1A. From, it is clear that multi-platform methods outperformed single platform methods. Among the multi-platform methods, Hotelling's T2 and INT had similar performances, and these methods had the best performances among all methods. AveD and MaxD had slightly lower TPRs than INT, and SumZ followed closely. Inand C, the relative performance among different methods stayed the same as in, except that the TPRs decreased when decreased. The same patterns were observed for  0.6 (Supplementary; Supplementary).shows the ROC plots under different levels, i.e.  0:9, 0:8, 0:6, 0:4, and 0:2 when  75% and  0.91. (The AUC values are shown in Supplementary). The patterns for the relative performances of different methods were observed to be similar to those of. As expected, all methods performed better when the difference between case and control became larger (i.e. larger ). The case proportion, , is known to affect the power of statistical methods (). We repeated the studies for  0.5 (Supplementary) and 0.1 (Supplementary); similar results were observed under these scenarios.
Multi-platform methods for gene set analysis with heterogeneous samples (Scenarios B1 and B2)To evaluate the performance under sample heterogeneity, we simulated datasets by randomly selecting % of case samples to be 'true' cases. We focused our comparisons on the two represented approaches from Section 3.1 (i.e. INT and SumZ) and the three proposed methods for sample heterogeneity, i.e. MPLRS, MPORT and MPMWS. The results of Scenario B1 are shown inand the percentage of 'true' cases among all cases varies, i.e.  (100, 90, 80, 60, 40 and 20%). The corresponding AUC values are presented in Supplementary Table S1B. We see that INT and SumZ, which are designed for multi-platform homogeneous data, quickly lost power as decreased. In contrast, MPLRS and MPMWS retained good power when decreased. However, the relative performance between MPLRS and MPMWS depended on. When was low (e.g. 40%), MPLRS performed the best; when was 60%, MPLRS and MPMWS had similar power. However, when was high (e.g. ! 80%, MPLRS had less TPRs than MPMWS, sometimes even less than INT. MPORT performed inferior to MPLRS and MPMWS, and its power advantages over INT and SumZ did not show until became small, i.e. $2040%. Because is unknown in practice, MPMWS appears to be the most robust choice; it yielded the highest or the second highest TPRs regardless of the values. Although the method is designed to account for sample heterogeneity, it had similar power to INT when samples were homogeneous (  100%). This behavior is likely attributable to the fact that the genomic variables of certain platforms tended to deviate away from normal distributions, e.g. methylation values, and the non-parametric MPMWS is robust against non-normality. Finally, the improved TPR obtained using MPLRS and MPMWS with heterogeneous samples was observed when we repeated the analysis for  50% and  0.5 (Supplementary) and 0.1 (Supplementary). By design, INT is good at identifying pathways with systematic changes, whereas MPMWS has robust power to detect pathways involving sample heterogeneity. In, we show the number of significant pathways and the number of true-positive (TP) pathways identified by INT and MPMWS. We observe that both methods identified many common significant/TP pathways. In addition, there was a high percentage of TPs among the common significant pathways, especially when the heterogeneity level was not extremely high. The results also show that each method identified some unique significant/TP pathways that were missed by the other method. For INT, the proportion of TPs among the unique pathways became smaller as the heterogeneity increased. For MPMWS, the corresponding TP proportion stayed roughly constant until severe heterogeneity (e.g.  20%). The analyses above were performed under Scenario B1, where each causal gene only had one causal platform. We repeated the same analyses under Scenario B2, where each causal gene had at least 1 causal platform. We obtained similar results as observed in Scenario B1 (Supplementary).
Real data applicationWe first considered the TCGA breast cancer dataset containing methylation, CNV and RNA-Seq measurements. We performed multi-platform gene set analyses on the 1452 MSigDB pathways using MPMWS and INT (i.e. the top two methods from Scenarios B1 and B2). Unlike the simulated gene sets, pathways in MSigDB often share common genes and can have significant overlaps.shows the number of pathways identified by each method and their overlaps at false discovery rate (FDR) 0.05 using the Benjamini and Hochberg's FDR procedure(). The numbers of significant pathways identified by INT and MPMWS were 116 and 78, respectively. Comparing the significant findings from MPMWS and INT, we found that a majority (58 and 74%) of the pathways were shared between the two methods (Supplementary). This includes many well-known pathways related to breast cancer, e.g. PKL1 () and the cell cycle pathway (). As was observed in the simulation study, there were quite a few overlaps between MPMWS and INT. However, some significant pathways that were identified by one method had large P-values in the other method. For example, the pathways of DNA replication and DNA strand elongation are important for breast cancer (); they were identified by INT but missed by MPMWS (Supplementary). In contrast, the BRG1-associated factor complex (), the wellknown tumor suppressors and the G1 pathway (), a known breast cancer-related pathway, were found to be significant by MPMWS but not by INT (Supplementary). These results agree with the observations in the simulation study: INT and MPMWS appear to identify different types of signals and can be used together in real practice. We applied multi-platform gene set analyses on a second TCGA dataset, i.e. the KIRC dataset. We observed similar results as for the breast cancer data and reported the detailed results in Supplementary Table S4.
DISCUSSIONIn the presented work, we compared different multi-platform methods for gene set analysis using extensive simulated studies. First, when there is no sample heterogeneity, we found that INT and Hotelling's T2 method had the best performances compared with other methods. INT might have wider applicability compared with Hotelling's T2 because it can accommodate covariates. Second, to account for sample heterogeneity, we proposed and tested three different strategies, MPMWS, MPORT and MPLRS, for multi-platform gene set analysis. We found that the non-parametric MPMWS method had satisfactory TPRs and robust performance regardless of the degree of heterogeneity. Finally, based on the results of the simulations and the real data applications, we recommend using both MPMWS and INT: the significant gene sets identified by both methods are more likely to be true positives, while each approach is able to identify orthogonal, yet relevant, biological gene sets. It might be worth following up with these orthogonal findings combining with additional biological information so to minimize the false positives. We performed the tests assuming that genes are uncorrelated within and across platforms. This assumption may not be valid in real practice, especially for genes within the same gene sets. Inter-gene correlation is known to inflate the FDR of singleplatform gene set analysis, and several methods have been proposed to address this issue (). In addition, the genomic variables of a gene from different platforms can also be highly correlated with each other. For example, copy number change can lead to a change of transcript level, and a high methylation level of the gene promoter region often leads to downregulation of transcription. It is worth future studies to evaluate how inter-gene and inter-platform correlations will affect multi-platform gene set analysis. In our analysis, we ignored the issues of missing values by focusing on genes with complete observations in all platforms. In reality, missing data are commonly observed in large-scale studies because of the experimental conditions, individual sample differences or platform constraints. When a considerable amount of data are missing, removing all the samples or genes with missing data could lead to substantial loss of information.Ten of 207 gene sets were selected as causal, and the results were averaged over 300 repeats.To address this issue, imputing can be used to fill in the missing values. Performing self-contained gene set analysis tests is another strategy (). Further research is needed to characterize the patterns of missing data on different platforms, understand their impact on the gene set analysis and develop the proper statistical methods for missing data. The R code for all of the methods and test datasets are available on the Web site: http://www4.stat.ncsu.edu/*jytzeng/ Software/Multiplatform_gene_set_analysis/
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.3 Multi-platform methods for gene set analysis without sample heterogeneity The general steps of integrative gene set analysis start with computing genespecific association scores (gene scores in short) of multi-platform data and then using these scores to perform gene set analysis. For the gene set analysis, we conducted the gene set tests using R function 'geneSetTest'
J.Hu and J.-Y.Tzeng at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Integrative gene set analysis of multi-platform data with sample heterogeneity at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
