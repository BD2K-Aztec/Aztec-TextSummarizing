Motivation: Chromatin Immunoprecipitation followed by sequencing (ChIP-seq) detects genome-wide DNAâ€“protein interactions and chromatin modifications, returning enriched regions (ERs), usually associated with a significance score. Moderately significant interactions can correspond to true, weak interactions, or to false positives; replicates of a ChIP-seq experiment can provide co-localised evidence to decide between the two cases. We designed a general methodological framework to rigorously combine the evidence of ERs in ChIP-seq replicates, with the option to set a significance threshold on the repeated evidence and a minimum number of samples bearing this evidence. Results: We applied our method to Myc transcription factor ChIP-seq datasets in K562 cells available in the ENCODE project. Using replicates, we could extend up to 3 times the ER number with respect to single-sample analysis with equivalent significance threshold. We validated the 'rescued' ERs by checking for the overlap with open chromatin regions and for the enrichment of the motif that Myc binds with strongest affinity; we compared our results with alternative methods (IDR and jMOSAiCS), obtaining more validated peaks than the former and less peaks than latter, but with a better validation. Availability and implementation: An implementation of the proposed method and its source code under GPLv3 license are freely available at
IntroductionChromatin immunoprecipitation followed by next-generation sequencing (ChIP-seq) is the most commonly used method to study genome-wide chromatin modifications or proteinDNA interactions. Computational tools like MACS () or ZINBA () are applied on aligned ChIP-seq reads to detect enriched regions (ERs) over the genome (often called 'peaks'), where the local accumulation of sequencing fragments exceeds that of a background distribution, typically estimated from randomly fragmented chromatin or by performing the ChIP-seq protocol with a control antibody (). As the protocol is subjected to multiple sources of noise (), some low-intensity accumulation of reads is possible even in absence of a true interaction with the target. These low-intensity peaks, which are usually present in large amounts, contain therefore a mixture of false positives and true, although weak, interactions; they are typically discarded when stringent thresholds on the peak call are used. This approach leads to the discovery of the strongest interactions only, and might distort the genome-wide picture of the genomic locations of the transcription factor binding sites or histone modifications of interest.Given the intrinsic noise of the ChIP-seq protocol, it is good practice to repeat every experiment at least twice, as the guidelines of the ENCODE project indicate (). The information contained in replicates can then be used to assess the validity of the peaks obtained from a single sample, especially of those with low-intensity. In this paper, we propose a novel method to rigorously combine the results of peak calls in ChIP-seq replicates and to obtain new, sample-specific, peak lists taking into account their combined evidence. Our method takes as input, for each replicate, a list of enriched genomic regions and a measure of their individual significance in terms of a P-value. Starting from a permissive call, we divide the initial ERs in 'stringent' (highly significant) and 'weak' (moderately significant), and we assess the presence of overlapping enriched regions across multiple replicates. Non-overlapping regions can be penalised or discarded according to specific needs. The significance of the overlapping regions is rigorously combined with the Fisher's method to obtain a global score. Finally, this score is assessed against an adjustable threshold on the combined evidence, and peaks in each replicate are either confirmed or discarded (a schematic view of our method is given inand a visualisation of the results of the method on data from the ENCODE project is shown in). In other words, we are able to 'rescue' weak peaks, which would probably be discarded in a singlesample analysis, when their combined evidence across multiple samples is sufficiently strong. We applied our method to ENCODE datasets from ChIP-seq experiments of the Myc transcription factor in K562 human cells, for which multiple samples with replicates are available. As Myc preferentially binds to a well-defined motif, the choice of this TF allowed us to validate our results through motif analysis and DNase-seq data; finally, we compared our findings with other state-of-art methods. The strong aspects of our method, besides the validity and relevance of the results that it provides, are its simplicity and flexibility, together with its efficiency (few minutes for 23 replicates with a few tens of thousands of peaks each).
MethodsHere, a brief description of the method and datasets used is given. For more details, see the Extended Methods section in the Supplementary Material.
Data collection and peak callingChIP-seq enriched regions are read from data files in standard Browser Extensible Data (BED) format; besides standard ER format specifications (columns 'chromosome', 'start', 'end', 'ID'), we require a P-value quantifying the significance of each ER, which is usually computed by the peak caller used to identify the ER. Binary Alignment/Map (BAM) files for the transcription factor Myc in human K562 cells (myelogenous leukaemia) were taken from the ENCODE project repository, for a total of 15 samples obtained in 7 different experiments as summarised in. Each experiment contained 2 or 3 biological replicates of the same ChIPseq. Technical replicates were artificially created to test our method, as they were not directly available in the ENCODE repository. Technical replicates were obtained by merging the ENCODE alignment files relative to biological replicates for each of the seven conditions considered above, and then by randomly splitting their reads in two new alignment files. Details about technical replicates, and the process used to generate them, are collected in the Supplementary Table S1.of the proposed method. First, with a permissive call, we divide peaks of a single individual sample in stringent and weak. Then, combining the evidence of multiple replicates, the peaks in each replicate are confirmed or discarded. Genome browser view of a result of the proposed method. Tracks for two ChIP-seq replicates are shown along with the position of the stringent peaks, the weak peaks confirmed by our method and the open chromatin regions (measured as DNase-seq enriched regions). Case 1 refers to a weak peak rescued by a stringent peak, while Case 2 refers to two weak peaks validating each other Peak calling was performed with the software package MACS2 () with the following parameters: 'auto-bimodal-p 0.0001-g hs' (thus setting a p-value threshold of 10 4 ), using alignment files available in the ENCODE repository, together with the corresponding background (standard input for all samples except for Myc2, for which the input signal from rabbit IgG ChIP-seq was used). In each sample-input pair, the total number of reads was made equal by randomly down-sampling the largest alignment file. The performed call determined between $15 k and $345 k peaks across the different samples (see).
DefinitionsGiven a set of J replicates, each sample j is associated with a set R j of I enriched regions r ji : R j  {r j1 , r j2 ,. .. , r ji ,. .. , r jI }. Each region r ji is defined by (chromosome ji , start ji , end ji , ID ji , p ji ), where p ji denotes a measure of the significance of r ji (i.e. its P-value). T s is a stringent threshold on P-values, defining a set R j s of stringent (highly enriched) ERs; R j s : r ji 2 R j s iff p ji < T s. Similarly, we define a set R j w of weak (moderately enriched) ERs, containing all regions whose Pvalue is between T s and a weak threshold T w , with T w > T s , i.e. R j w : r ji 2 R j w iff T s p ji < T w. Clearly, R j w \ R j s   and, if T w is the maximum P-value allowed for an ER to be associated with sample j,For each region i of each sample j, let r ji,k denote the region of sample k overlapping with r ji , if any. If sample k has multiple regions overlapping with r ji , we choose the most significant one, i.e. the one with the lowest p-value. Let R ji be the collection of r ji,k for k 2 {1,. .. , J}, including r ji itself. Let K  jR ji,* j be the cardinality of R ji,* , the set of the ERs intersecting with r ji , with 1 K J by definition. We distinguish between technical and biological replicates of an experiment. Technical replicates aim at controlling the variability of the experimental procedure used to obtain the data and should yield exactly the same results in absence of experimental noise. In a ChIPseq experiment, this corresponds to performing multiple times the same ChIP protocol on the same biological sample, followed by independent sequencing on the same platform; we expect to observe a significant overlap between ER lists in these samples. Conversely, biological replicates are obtained by applying the same protocol on biologically equivalent samples, what could give rise to different binding profiles of a transcription factor, as in the case of tumor samples; here, the variability in the data can also stem from the 'true' biological variation of the phenomenon of interest. Consequently, the lack of overlap between ERs in biological replicates does not necessarily correspond to a false positive result, as it could reflect a true biological interaction occurring only in some samples. With our method, the user is able to control for the required level of overlap and combined significance, according to the specificities of the dataset.
Algorithm: overall procedureThe main idea behind our method is that repeated evidence across replicates can compensate for a lower significance in a single sample, which is implemented through the Fisher's method. The Fisher's method combines the P-values of each test in a global test statistics that follows a chi-squared distribution with 2 k degrees of freedom (where k is the number of tests combined); therefore, it can be used to falsify the statement 'all null hypotheses are true', i.e. 'all overlapping ERs are due to background noise'. Comparing intersecting ERs from a set of J replicates is equivalent to test the same genomic region in independent experiments against the same null hypothesis H 0 , i.e. 'the number of reads in the region under study is sampled from the background distribution', and obtaining independent probabilities of rejecting H 0 (i.e. independent P-values). Here, we briefly outline the structure and motivation of our algorithm, following the flowchart given in, while we discuss its details in the Extended Methods (data structures, search algorithms and combining test statistics sections). We assign every ER r ji in a given sample j to either R j s or R j w according to its significance. For a given ER, we then determine R ji,* as the set of ERs in the replicates that overlap with r ji , including r ji itself (see Definitions subsection). The cardinality K of R ji,* represents a measure of the reproducibility of the signal in the region spanned by r ji , while the significance of r ji,k 2 R ji,* is a measure of the intensity of the signal in a specific replicate k, given the background. We rigorously combine the significance of the overlapping ERs in R ji,* with the Fisher's method, as described in the Extended Methods, and define a new score for their combined evidence p ji comb . Then, we compare this new score with an adjustable threshold c: if the desired stringency is obtained, we assign r ji to the set R j c of confirmed peaks for sample j; if the condition is not met, i.e. the combined evidence is not strong enough, we assign r ji to the set R j d of discarded peaks for sample j. All the ERs in R ji,* are assigned to the corresponding confirmed R k c or discarded R k d set, respectively.Peaks were called with the software package MACS2. R s : stringent ER set (ERs with P-value < T s ). R w : weak ER set (ERs with T s P-value < T w ). T s  10 8 , T w  10 4 .We leave the possibility to distrust a region r ji, regardless of its significance, when it is not backed up by the presence of overlapping ERs in a minimum number of samples C. C is an adjustable parameter ranging between 1 and J, with different default values for biological and technical replicates. In summary, for a given sample j, R j c  {r ji j p ji comb c V (K ! C)} and R j d  {r ji j (p ji comb > c) W (K < C)}. We repeat this procedure for each sample. We note that an ER can participate in different sets of overlapping regions, as we discuss in detail in the Extended Methods. As a consequence, it is possible that an ER is assigned to both the confirmed and discarded sets as a result of different tests. These peaks are assigned to the confirmed set if replicates are biological and to the discarded set if replicates are technical. In other words, as technical replicates are supposed to be very similar, for an ER it is enough to fail the test once to be removed from the confirmed set, while for biological replicates this condition is relaxed and it is enough to pass the test at least once for an ER to be confirmed. After applying the proposed method, each peak has two properties: its initial significance, which can be either stringent (s) or weak (w), and the result of the multiple replicate comparison, which can be either confirmed (c) or discarded (d). Then, for each sample we define four mutually exclusive sets on the basis of these property valThe final output set R j o of each sample j is obtained by applying the BenjaminiHochberg correction procedure to R j c , independently from the choice of the other parameters, in order to account for multiple testing (), and keeping only the ERs with false discovery rate smaller than an adjustable threshold a.
ValidationIn order to validate the peaks obtained after combining replicates, we first checked whether the peaks we rescued fell within open chromatin by intersecting their genomic coordinates with enriched regions in DNase-seq data obtained from ENCODE (see Extended Methods). Then, we looked for enriched motifs in the nucleotide sequences spanned by the sets of ERs that we obtained. To perform motif analysis, we used the software package DREME (Bailey, 2011) with parameters '-e 0.00001-m 10'. Results were scored against the JASPAR database () using the software package TOMTOM (). Myc strongly binds to one specific motif, called the canonical Enhancer-box or E-box, corresponding to the Position Weight Matrices (PWMs) MA0058 (MAX), MA0059 (MYC::MAX), MA0093 (USF1), MA0104 (Mycn) and MA0147 (Myc) in the Jaspar Core Vertebrata database (the corresponding sequence logos are shown in the Supplementary); thus, an ER set is validated when at least one of these PWMs is found significantly enriched in the ER set. We note that Myc has a weaker affinity for other versions of the E-box, but we chose to exclude these other motifs from the validation to achieve maximum stringency.
Comparison with other methodsIrreproducibility Discovery Rate (IDR) (). It is a metric quantifying the reproducibility of a peak across two ChIP-seq replicates by comparing the two lists of ERs, ranked according to their significance. In essence, after calling the peaks, the IDR pipeline uses a bivariate rank distribution to separate the signal (reproducible peaks) from noise (irreproducible peaks) in an experiment (or pairwise comparison). Each peak is associated with an IDR value, which quantifies the probability that the peak belongs to the irreproducible set. IDR was computed for our validation with the scripts provided by Anshul Kundaje at the URL https://sites.google. com/site/anshulkundaje/projects/idr jMOSAiCS (). It is a generic tool for joint analysis of multiple ChIP-seq samples, which can be also used to find common patterns of enrichment between ChIP-seq replicates. First, the MOSAiCS peak caller pre-processes replicates and corresponding control samples by binning the mapped read counts on the genome (default width of 200 bp), and applies the MOSAiCS model fit to each replicate-control pair individually. Afterwards, the jMOSAiCS model is applied to the data fitted with MOSAiCS: region-specific enrichment patterns are determined by posterior probabilities assigned to the internal variables, and a binary variable denotes the potential enrichment of a region based on dependencies among samples. jMOSAiCS was executed with default parameter values as described at http://www.bioconductor.org/packages/re lease/bioc/vignettes/jmosaics/inst/doc/jmosaics.R. The complete script is included in the Extended Methods.
ResultsIn this section, we report the results obtained by applying our method on either technical or biological ChIP-seq replicates. The method takes as input the genomic coordinates and a measure of significance (i.e. the P-value) of each of the ERs for each replicate considered. For each input sample j, it outputs the lists of confirmed (R j o ) and discarded (R j d) ERs, as well as the lists of stringent confirmed (R s,c ), weak confirmed (R w,c ), stringent discarded (R s,d ) and weak discarded (R w,d ) ERs. Adjustable parameters of the method are: T s (maximum P-value to consider a peak as 'stringent'), T w (maximum P-value to consider a peak as 'weak'), C (minimum number of samples with intersecting peaks needed to apply the combined evidence evaluation), c (maximum combined significance to confirm a peak), a (maximum false
discoveryrate after the Benjamini-Hochberg correction), together with the choice of 'technical replicate' versus 'biological replicate' mode. For our evaluations we used: T s  10 8 , T w  10 4 , c  10 8 , a  0.05 for all comparisons, C  1 for biological replicates and C  J for technical replicates. Required time was a few minutes for 2 samples with 100 000 peaks each on a standard desktop computer.
Technical replicatesTechnical replicates are used to evaluate and remove the noise introduced in the experimental procedure. In the case of ChIP-seq experiments, they are usually generated by performing the same ChIP protocol on the same biological sample, and then performing the sequencing independently. As the ENCODE datasets include only biological replicates, we tested our method on artificial technical replicates, simulated as described in the Methods section. Details about these samples can be found in the Supplementary. An alternative to our strategy to generate technical replicates would be to randomly split the reads in each original alignment file in replicates rather than merging biological replicates in ENCODE first. However, this procedure gives rise to a much poorer signal, preventing the identification of most ERs. The statistics of these alternative technical replicates are described in the Supplementary Table S2. Results for T s  10 8 , T w  10 4 , c  T s , a  0.05 and C  2 are shown in. For each replicate sample (panels AG), we show two bars: the left bar (SS) represents the peaks called in a singlesample analysis (R s in light gray and R w in dark grey), while the right bar (MS) classifies the same peaks, according to the output of our algorithm, in the four sets described above: R s,c (light gray), R w,c (medium-light grey), R s,d (medium-dark grey) and R w,d (dark grey). As expected, the number of R s stringent and R w weak peaks called in the same technical replicates is always very similar, even if the absolute numbers differ significantly across the different conditions considered. Each output set has a consistent fraction of R w,c weak confirmed ERs, which ranges from 20% to 98% (mean 46%, standard deviation 30%) of the starting number of stringent peaks (R w,c / R s , panel H); thus by combining evidence in replicates, our method 'rescues' (i.e. confirms) a large amount of weak co-localised peaks that would otherwise be discarded through a usual single sample evaluation. The percentage of stringent discarded peaks (R s,d / R s , panel H) is very low and varies from 0% in Myc2 to 12% in Myc3 (mean 5.6%, standard deviation 3.8%). The output set R o corresponds to the set of confirmed peaks R c  R s,c | R w,c , where the significance of each peak has been adjusted for multiple testing; combining the evidence present in replicates increases the number of obtained peaks up to almost the double of what obtained with a single sample at the same stringency (R o / R s , panel H). For technical replicates, we expect the output of each replicate to be similar, and therefore the parameter C was set to C  J  2 for all technical replicate comparisons. Setting C  1 would be instead equivalent to trust even isolated peaks, which are not present in the other replicate. With the latter choice, and c  T s , no stringent peaks would be discarded. As a preliminary evaluation of the results obtained, we considered the overlap of the peaks with the enriched regions in DNase-seq data. On average, 95.4% of the peaks in R o , 95.4% of peaks in R s and 94.6% of peaks in R w,c were in open chromatin regions, while this fraction was only 89.4% for R s,d and 93.0% for R w,d (Supplementary). The overlap with open chromatin, however, is not yet a validation of a specific binding event. We performed then motif analysis on the nucleotide sequences corresponding to the ERs in the four sets: R s , R o , R w,c and R s,d. Myc is known to bind a large number of sites on the DNA, particularly with high affinity to those with the 6-nucleotide motif called Enhancer-box or E-box. This protein-binding region has the generic consensus nucleotide sequence CANNTG (with N representing any nucleotide;). In particular, Myc binds with maximum strength to the CACGTG motif (also called the 'canonical' Myc E-box [). Therefore, we consider the enrichment of the Ebox in a set of peaks a sufficient condition to consider the set as containing 'true' binding sites. Panel I inshows that the E-box is always enriched in the R s stringent and R o output sets, as well as in the R w,c weak confirmed set. This result confirms that in the large majority of cases the weak peaks overlapping in replicates identify real binding sites, which are missed by a stringent single-sample call. In 4 out of 14 cases, the R s,d stringent discarded set is enriched for the E-box, although at much lower significance (Supplementary), while in the remaining cases the number of peaks in the R s,d set is low. This analysis suggests that the default value C  J used for our artificial technical replicates may be too conservative and still discards a small fraction of real binding sites.
Biological replicatesThe ENCODE data repository always includes one or more biological replicates for each ChIP-seq experiment. For the transcription factor Myc, multiple data sources are available, either obtained in independent experiments, or scored against different backgrounds (in Myc2, the input was derived from immuno-precipitating normal rabbit IgG, while in all the other samples the standard input for the K562 cell line was used). We applied our method to biological replicates obtained from each of the ENCODE experiments considered, and we also combined replicates from 2 experiments (Myc2 and Myc3). Parameters for the method were the same as for the technical replicate evaluation reported in the previous section (i.e. T s  10 8 , T w  10 4 , c  T s , a  0.05); for the additional parameter C, in the case of biological replicates we adopted the permissive choice of C  1 (default for the analysis of biological replicates). With these values (i.e. c  T s and C  1), our method never discards a stringent peak (we consider that a single strong evidence is enough for biological replicate evaluation). Results are shown in. The number of peaks in biological replicates of the same experiment can be very different (panels A-H), reflecting the different efficiency of the ChIP-seq protocol, and the number of weak peaks (R w ) is usually much larger than the number of stringent peaks (R s ). In the considered cases, the number of confirmed weak peaks (R w,c ) is often much bigger (up to $4 times) than the number of stringent peaks (R s ) (column R w,c /R s in panel I), confirming that the evidence in a 'good' replicate allows the rescue of many peaks in a 'bad' replicate. We observe a similar situation when we combine samples obtained with different inputs. For example, by combining together the four replicates of the Myc2 and Myc3 cases (panel D), we increase massively the number of peaks in the output set for the samples with lower peak counts (Myc3) by confirming a number of their weak peaks much larger than in the evaluation performed without Myc2. Therefore, the presence of high-quality replicates can be of great help in improving the call on many low-quality replicates. The average overlap with open chromatin regions of the R w,c weak confirmed sets is 91.0% (compared with the 51.6% for the weak discarded peaks), and motif analysis confirms that in all the samples the ERs contain the canonical Myc binding site (panel J and Supplementary Tables S6 and S8).
Combining replicate ChIP-seqsWe applied our method also using C  2 on all biological replicates considered: most of the times that the R s,d stringent discarded peak set had a substantial size, the E-box motif was present, although the average overlap with open chromatin was only 75.9% (Supplementaryand Tables S9 and S11). This further confirms that, in biological replicates, a lack of overlapping with peaks in other replicates does not necessarily correspond to an artifactual interaction.
Comparison with alternative strategies
Alignment read mergingAn intuitive way to combine evidence in replicates is to merge the alignment reads, and use a peak caller on the combined data. As the combined dataset corresponds to the sum of the two signals, weak, co-occurring peaks should increase their significance. We have merged alignment files from replicates for each considered experiment, using merged backgrounds when available (Myc3 only), and considered only peaks with P-value smaller than T s  10 8. In almost all the cases, the number of peaks called from the merged replicates was substantially lower than the number of peaks obtained by our algorithm (, third and fourth columns). Moreover, a large fraction of the peaks detected in the merged samples overlapped with at least one of the peaks obtained by our method (Table 2, fifth column). The only cases when this fraction was below 70% were those where the replicates exhibited a very large difference in the number of called peaks (Myc3, Ifng30, Ifng6h). In these cases, the output set of the replicate with the higher number of peaks always showed a very high overlap with the merged sample peaks. Merging the alignment files therefore 'averages' replicates with different sets of peaks, whereas our method 'rescues' a sample with few ERs with the help of a sample with many ERs. Besides, the merging strategy has no user-defined parameter to tune the results, whereas our method provides a rigorous way to weight co-occurrence and significance of ERs.
Irreproducibility discovery rateThe IDR () is a measure of the consistency of ERs identified in replicates, which has been systematically assessed in the ENCODE project. We computed the IDR for the ERs in our samples and used an IDR threshold of 0.05. The results are shown in theof the 7 experiments considered, two technical replicates were obtained by pooling reads from the biological replicates of the conditions and then randomly splitting the resulting alignment files in two equal parts. A-G: ER sets for the technical replicates considered. SS, single sample analysis; MS, multiple sample analysis. In each panel, the SS stacked bars represent R s (light gray) and R w (dark grey) in the two replicates, while the MS bars show the same peaks, confirmed or discarded according to the output of our method: R s,c (light gray), R w,c (medium-light gray), R s,d (medium-dark gray) and R w,d (dark grey). H, general statistics on the cardinality of the ER sets; I, validation of the sets with the Myc binding motif (Myc canonical E-box); 'Y', presence of the E-box; '-', set too small to find any enriched motif. See Supplementaryfor E-box enrichment P-values. Biological replicates. AH: ER sets in the biological replicates considered. SS, single sample analysis; MS, multiple sample analysis. In each panel, the SS stacked bars represent R s (light gray) and R w (dark grey) in the replicates, while the MS bars show the same peaks, confirmed or discarded according to the output of our method: R s,c (light gray), R w,c (medium-light gray), R s,d (medium-dark gray) and R w,d (dark grey). I, general statistics on the cardinality of the ER sets; J, validation of the sets with the Myc binding motif (Myc canonical E-box); 'Y', presence of the E-box. See Supplementaryfor E-box enrichment P-values. Comparison with merged alignment files and IDR sixth and seventh columns of. First of all, the IDR-validated peaks are few and often entirely contained in our output sets. This highlights that the IDR method is rather stringent and generates only a small set of validated (reproducible) peaks. We repeated our analysis for the Myc2 sample for a lower T w threshold and found similar results (see Supplementary Material). Our method does not score the reproducibility of a peak, but it rather combines evidence in replicates, and has the option to accept very stringent peaks even if they are not found in other replicates. We conclude that our method confirms weak peaks that are considered 'irreproducible' by IDR (with a 0.05 threshold), and are validated by motif analysis (Figs 4 and 5, Supplementary Tables S3S11). Finally, differently from our method, which accepts any number of replicates, the IDR can be directly computed only for pairs of replicates. required time is in the order of few minutes on a standard desktop computer and does not require special hardware. Comparing our method with two other common approaches (replicate merging and IDR) confirmed the stable identification of a core of stringent, reproducible peaks. Besides this, our tests demonstrated that less stringent evidence consistently present across replicates can be combined, leading to the 'rescue' of sets of ERs corresponding to real binding sites, e.g. of the transcription factor (TF) Myc. In particular, our results are compatible with those found with IDR, a method widely used in ENCODE to assess the consistency of each detected peak: IDR works by comparing peak rankings and inferring the proportion of reproducible and irreproducible signal in the replicates, while our algorithm provides complementary information by computing the combined significance of a number of overlapping peaks. Despite comparable running times, we differ from IDR as we do not automatically discard non-overlapping peaks and we can directly apply our method to more than two replicates without relying on multiple pairwise comparisons. We stress that our method should not be considered an alternative to IDR, but rather complementary to it. A further comparison with a tool designed for more complex analysis (identifying combinatorial patterns of enrichment across different ChIP-seq experiments performed over the same biological sample), jMOSAiCS, revealed that, in the specific task of comparing replicates of ChIP-seq experiments performed against the same target, this last tool confirms more peaks, which however do not always enrich for the E-box. Recently, JAMM (), a tool based on local multivariate Gaussian mixture models for directly finding ERs on ChIP-seq replicates, has been introduced. JAMM confirms that pooling replicates can blur the specific spatial resolution of singlesample peaks and lead to less accurate calls in terms of peak width and intensity. In summary, our strategy represents a promising trade-off between stringent techniques (IDR) and permissive techniques (jMOSAiCS).
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
V.Jalili et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.3.3 jMOSAiCS We compared our results also with those obtained with jMOSAiCS (Zeng et al., 2013), a tool designed to detect combinatorial patterns of enrichment in multiple ChIP-seq samples. Even if jMOSAiCS is conceived to integrate different ChIP-seq datasets that profile distinct features on the same biological sample, it can also be applied to replicates of the same ChIP-seq. Applying jMOSAiCS to our biological replicates (Table 3) resulted in a very large amount of ERs in each experiment, which were on average around 5 times larger than our peaks (ER average size data are not shown). These sets of peaks contained by far the majority of the ERs identified by our method. We checked for the enrichment of the Myc E-box in the peaks identified by our method, but not by jMOSAiCS and vice versa (peaks identified by jMOSAiCS, but not by our method). While in the former case the Myc binding motif was enriched in all the sets with an enough number of peaks to detect any enriched motif, the latter case showed the presence of the Myc canonical E-box only in half of the samples. Moreover, the running times of jMOSAiCS for two replicates were in the order of 3 hours, with about 40 GB of memory consumption, on a server with two Intel Xeon E5-2650 processors and 64 GB of RAM, as this tool starts from alignment files and finds ERs independently. On the same platform, our method ran in a few minutes; the preliminary peak calling step needed to obtain the sets of enriched regions required about 40 min for each of the replicates with MACS2 (Zhang et al., 2008). We conclude that jMOSAiCS, when applied to replicates of the same ChIP-seq experiment, has the tendency of introducing a large amount of extra peaks, which are not always validated by motif analysis, and it requires significant computational resources. On the other hand our method is much faster, as it allows to start from pre-determined ER lists, and at least equally specific.
