Motivation: Nuclear magnetic resonance (NMR) spectroscopy is widely used for high-throughput characterization of metabolites in complex biological mixtures. However, accurate interpretation of the spectra in terms of identities and abundances of metabolites can be challenging, in particular in crowded regions with heavy peak overlap. Although a number of computational approaches for this task have recently been proposed, they are not entirely satisfactory in either accuracy or extent of automation. Results: We introduce a probabilistic approach Bayesian Quantification (BQuant), for fully automated database-based identification and quantification of metabolites in local regions of 1 H NMR spectra. The approach represents the spectra as mixtures of reference profiles from a database, and infers the identities and the abundances of metabolites by Bayesian model selection. We show using a simulated dataset, a spike-in experiment and a metabolomic investigation of plasma samples that BQuant outperforms the available automated alternatives in accuracy for both identification and quantification.
INTRODUCTIONThe field of metabolomics studies small molecules such as amino acids, nucleic acids, lipids and carbohydrates, called metabolites, which are present in cells and extracellular fluids of biological organisms (). Metabolites are the end products of a variety of cellular processes and their high-throughput characterization and quantification can provide important insights into the functioning of living organisms. As a result, metabolomics is increasingly applied to the areas of system biology, drug discovery, pharmaceutical research, early disease detection, toxicology and food science (). * To whom correspondence should be addressed. Developments in high-throughput metabolomics are driven by advances in analytical methods (), such as nuclear magnetic resonance (NMR) spectroscopy and in mass spectrometry. In particular, 1 H NMR spectroscopy is non-destructive and highly reproducible, and is widely used for the identification and quantification of metabolites in biofluids such as plasma and urine (). The 1 H NMR signal is generated by the motion of magnetic moments of protons or other nuclei in a magnetic field after their excitement with a high-frequency pulse (). Fourier transformation of this time-dependent signal yields a chemical shift, a measure that expresses the dependence of nuclear magnetic energy on the electronic and chemical environment in the molecule. An 1 H NMR spectrum displays chemical shifts in parts per million (p.p.m., i.e. the difference in hertz between a resonance frequency and that of a reference substance, over frequency of magnet field in megahertz), versus intensities of the signals (). Typically, a metabolite detectable by 1 H NMR contains one or more protons, and each of the protons produces one or more peaks. The number of peaks generated by a metabolite, as well as their location and ratio of heights, are reproducible and uniquely determined by the chemical structure of the molecule.illustrates two 1 H NMR spectra with a dominant signal from metabolite taurine from the spike-in experiment in Section 4. All three predominant peaks in the spectra correspond to one proton in the taurine chemical structure. The expected ratio of heights of the three peaks is known and fixed to 1:2:1. Extensive information regarding NMR-specific characteristics of a variety of metabolites is currently available. Several public databases, such as human metabolome database (HMDB) () and BioMagResBank (BMRB) (), as well as commercial databases such as the one in the Chenomx NMR suite (), store reference NMR spectra of metabolites. The reference spectra can contain observed peak locations and ratios of heights of spectra from pure chemical compounds, or their simulated counterparts. Therefore, in principle, researchers can identify metabolites by matching the observed spectra to the reference spectra in the database. The area of the peaks from a metabolite is directly related to its abundance. As the abundance changes, the heights of peaks belonging to the same metabolite vary, as shown in the case of taurine in. This enables relative quantification of metabolites across samples ofregion from two 1 H NMR spectra from the spike-in experiment in Section 4. Solid line: spectral region from a sample containing the spiked metabolite taurine in the concentration of 3200 mols/l. Dashed line: spectral region from a sample containing taurine in the concentration of 1600 mols/l. The decrease in metabolite abundance results in a proportional decrease of all three peaks. various types, e.g. across samples from patients with various status of a disease in biomarker discovery investigations. However, inference of identity and abundance of metabolites from 1 H NMR spectra is fraught with difficulties. First, complex biological mixtures contain hundreds of metabolites, which vary in abundance substantially, and can produce highly overlapped peaks. Second, the number of candidate metabolites in a database typically exceeds the number of major sources of signals in the spectra, and one has to explore a combinatorially large space of candidate metabolites. Finally, due to numerous factors such as potential of pH and ionic interactions, peaks generated by a metabolite can deviate from their expected p.p.m. (), introducing 'positional uncertainty'. The combination of these factors makes the deconvolution and the interpretation of individual metabolite-specific signals very challenging in practice. Automated inferential approaches are needed in order to account for the noise and ambiguity of spectral interpretations, and to derive objective, accurate and reproducible identifications and quantifications of metabolites. This article develops a fully automated inferential approach, that we call BQuant, for identification and quantification of metabolites in regions of complex 1 H NMR spectra. It takes as input a set of NMR spectra, a range of p.p.m. of interest and a database of reference spectra for candidate compounds. It is based on a family of Bayesian hierarchical models for the spectra, where the models with the highest posterior probabilities are selected using a stochastic sampling technique. BQuant outputs a list of identified metabolites associated with their inclusion probability, and their measures of abundances in each spectrum on a continuous scale.
C.Zheng et al.
BACKGROUNDOnce NMR spectra are acquired, their analysis involves baseline correction, peak linewidth adjustment, normalization, spectral alignment, identification and quantification of metabolites, and univariate and multivariate statistical analysis. This manuscript focuses on the identification and quantification of metabolites. Methods for identification and quantification of metabolites can be classified into three broad categories: binning, curve-fitting without a database and curve-fitting with a database. For binning and curvefitting without a database, feature quantification is performed first and identification of the features is conducted subsequently as a separate step. For curve-fitting with a database, identification and quantification are performed simultaneously. Binning: this () processes one spectrum at a time, divides each spectrum into equally or variable-sized bins and integrates the intensities in each bin for quantification. The method is easy to implement, however it often lacks accuracy, in particular, in crowded regions of the spectra. Feature abundances can be inaccurately estimated by overlooking tail areas of peaks, or contaminated by signals from other sources. The bins are manually annotated with metabolite identities using a database; however, this requires a great degree of expertise. Since multiple peaks of a metabolites are highly correlated, statistical total correlation spectroscopy (STOCSY) () can be used to assist the identification (). Curve fitting without a database: after phase and baseline correction, many NMR spectra can be viewed as a combination of multiple non-negative source signals from individual metabolites, mixed linearly with non-negative but unknown proportions. Curve fitting attempts to recover these signals directly from the entire collection of spectra and a database. The general task of curve fitting can be performed by a class of non-negative matrix factorization (NMF) methods. One such algorithm, Bayesian spectrum decomposition (), sets specific forms of prior distributions for both source signals and mixing coefficients, and has been successfully applied to deconvolution of NMR spectra (). Another NMF algorithm, alternating least squares (), iteratively estimates source signals and mixing coefficients until convergence. Finally, 'constrained total-line-shape fitting' () utilizes detected peak locations, and models the peaks by a linear combination of Lorentzian and Gaussian lineshape functions. Similar settings appear in Alsmeyer and Marquardt (2004) and. As in the case of binning, identification of signals derived with curve-fitting methods occurs in a subsequent separate step. Unfortunately, the extracted curves are often not interpretable directly, and this undermines the practical utility of these methods. Curve-fitting with database: interpretation of 1 H NMR spectra as linear combinations of reference profiles from a database () allows us to simultaneously identify and quantify metabolites.utilize recorded pure compound spectra as signal templates and describe a least-squares strategy for fitting the templates to spectra.utilize the database while imposing non-negativity constraints on the relative abundance of metabolites, and show a promising constrained fitting scheme called least-squares deconvolution. However, the approaches have been demonstrated in limited experimental situations. Finally, the commercial Chenomx NMR suite provides a comprehensive database of metabolites, and their signal curves consisting of Lorentzian peaks, that can be used for manual deconvolution.provides an example of Chenomx analysis of an 1 H NMR spectrum from human plasma samples in Section 4. The raw spectrum (in black) is decomposed into multiple components and their summation is depicted by another black curve below the raw spectrum. The shaded area indicates four peaks, which are generated by a metabolite valine according to the database in Chenomx. Despite its manual nature, Chenomx suite is currently a popular tool for the interpretation of NMR metabolomic spectra.In summary, simple methods such as binning oversimplify the structure of the spectra and can produce inaccurate identification and quantification. Curve fitting without a database uses realistic models, but often fails to capture the true signals. Database-based approaches improve both the interpretability and the accuracy of spectral interpretation; however, they lack automation. This article proposes an automated probabilistic approach for curve fitting using a database of candidate metabolites. Similar to the existing methods, we model the observed spectra as a combination of reference signals in a database, mixed linearly with unknown proportions. However, unlike the existing methods, we specify a Bayesian probability model which jointly represents the full set of replicate spectra and views metabolites in the database as candidate variables. We then convert the problem of metabolite identification into a task of variable selection, and develop a stochastic variable searching scheme that explores the model space and identifies highly likely metabolites. Results are delivered in a format similar to Chenomx.
METHODS
PreprocessingWe apply the following processing steps to raw 1 H NMR spectra:(i) a simple linear baseline is estimated and subtracted from each spectrum (); (ii) reference deconvolution is applied to adjust the linewidth of the peaks (); (iii) the spectra are normalized by the total sum normalization (); (iv) the spectra are aligned by recursive segment-wise peak alignment in (). All other approaches for baseline correction, normalization, spectrum alignment and downstream statistical analysis can be used in conjunction with BQuant.
Database of candidate metabolitesFor experimental datasets, we use an in-house database of experimental spectra from 290 pure compounds. The spectra were acquired using a 600 MHz spectrometer, NOESY-presaturation sequence with a mixing time of 100 ms, prescan delay of 1.00 s, 4 s acquisition time and sample temperature 25 @BULLET C. Samples were prepared in H 2 O (with 10% D 2 O, at pH = 6.5). For each metabolite, the database specifies a reference 1 H NMR spectrum, the number of protons, the number of peaks derived from each proton and the information on locations, linewidths and relative heights of the peaks. Other databases, in particular the database available from Chenomx NMR suite, can be used directly with the proposed approach.
BQuant: estimation of peak shiftsLocations of peaks in the spectra can deviate from the expected p.p.m. in the database, even after the spectra are well aligned. This 'positional uncertainty' is experiment specific, and reference spectra need to be adjusted anew for each dataset. Patterns of 'positional uncertainty' are defined by the chemical structures of the metabolites, and follow specific rules. For example, the first two valine peaks inare generated by the same proton and form a doublet, and the last two valine peaks form another doublet. All peaks in a multiplet can shift to the left or to the right simultaneously by the same amount; however, the relative distances between multiplets vary. We view shifts between the expected and the observed peak locations as unknown parameters, and estimate them from the spectra separately for each metabolite. We then employ a straightforward heuristic searching scheme for estimating peak location shifts, which amounts to solving a series of restricted least-squares optimization problems by quadratic programming. A more formal description of the approach is provided in the Supplementary Materials.
BQuant: reduction of the observed spectraThe raw experimental spectra contain a large number of data points, stored in files of up to 32 000 points per spectrum. To reduce the computational burden, we select a local region of interest. We exclude from consideration the region surrounding 4.7 p.p.m., where signals from water dominate all other signals from metabolites. We then replace the full-resolution spectra with a list of fixed peak locations, derived using a peak picking approach such as in, as well as with the list of local minima between peaks, defined as the positions of bin edges determined by the Adaptive Intelligent Binning algorithm ().
BQuant: probability model for the spectraBayesian hierarchical model: suppose that we have observed n 1 H NMR spectra from n biological samples. We assume that all n samples are selected from the same homogeneous population, and do not contain systematic differences in abundances of metabolites, e.g. due to disease or treatment groups. When the study contains multiple groups, BQuant is applied separately to each group. Suppose that each spectrum records intensities at peak locations or bin edges at J positions in total. Let vector y i denote the intensities of spectrum i at these J positions and) denote the vector of length J n for all the spectra intensities from n spectra combined. Also suppose that we have a database with reference spectra of L metabolites, adjusted for 'positional uncertainty'. Let vector x l denote the intensities of the reference spectrum of metabolite l at the same J positions.be the J L design matrix formed by all the reference spectra combined. We model the spectra as a linear combination of signals from multiple sources. First, large molecules such as lipids can produce broad NMR peaks, which may be viewed as parts of the baseline but overlooked by the preprocessing steps. We model such non-specific signals using a penalized cubic B-spline. We denote as K the number of basis functions and as S the J K design matrix corresponding to the cubic B-spline basis () and set the knots of the B-splines at locations of bin edges. The remaining signals are generated by the metabolites in a database, and we distinguish signals of systematic and of stochastic nature. Each systematic source of signals represents the average relative strength of signal from a metabolite, as compared with the other metabolites in all samples. The stochastic source of signals reflects the biological variation of the metabolite abundance across samples and the measurement error. Therefore, the overall spectral signal y i from a sample i can be represented as a linear combination of signals from these sources:[i = 1,2,...,n. j = 1,2,...,J.where x  D indicates that the random variable x has the probability distribution D. The mixing parameters are the K-vector  of coefficients of the spline, the L-vector  of average relative abundances of the metabolites across all the samples and the L-vectors  i of deviations of abundances of the metabolites in sample i from the overall average levels. Parameter  is the same for all the samples, and  i are sample-specific random variables, and can be referred to, respectively, as fixed and random effects. In other words, the overall signal in a spectrum is represented by a linear mixed effects model.  i define a hierarchical structure of variation through their own probability distribution and covariance . Since we simultaneously consider the relative strength of the signal between different metabolites in all samples, and the relative abundance of a metabolite across samples, the design matrix is the same for both fixed and random effects. Only a subset of the metabolites in the database is present in the sample and can produce signals. Therefore, Equation (1) defines a family of models. Different instances of the family can be obtained by means of indicator variable  , which specifies the inclusion of individual metabolites.Prior distributions of model parameters: due to the necessary adjustments for 'positional uncertainty', columns of the design matrix X tend to be correlated. Consequently, the posterior distribution of the candidate models can be relatively flat. At the same time, we are not interested in all the candidate modes, but only in a subset of sparse models which explain the spectra with a minimal number of abundant metabolites. We reflect our preference for sparsity by a second indicator variable  = ( 1 ,, which determines the practically significant presence of the metabolites. The indicator controls the prior distributions of  and  i , helps obtain a more peaked posterior distribution of  and enables inference. The setting is motivated by the stochastic search variable selection for linear regression proposed byand extended by O'. Additional discussion on this setting is provided in Supplementary Materials. The priors for  and  arewhere B() denotes a Bernoulli distribution, and both hyperparameters p 1,l and p 2,l are predefined constants. p 1,l reflects our prior knowledge on the inclusion probability of metabolite l, and larger values of p 1,l yield more selected metabolites. p 2,l reflects our prior view of the practical significance of the average abundance of metabolite l. For reasons of computational tractability, we specify conjugate prior distributions of , components of the vector , submatrices of  and  2 as follows:Here p(x)  f (x) indicates that the density function for the probability distribution of x is proportional to f (x),(2) follows the proposal by, which views the baseline as an extension of the original penalized B-spline (). The exact form of matrix P is given in Supplementary Materials. The hyperparameter  in this distribution controls the smoothness of the baseline. We select  via an Empirical Bayes estimation step, where we fit the model in Equation (1) to the constructed spectrum with median intensities as the response, and estimate  automatically by generalized cross-validation (GCV) (Finally, the prior of  2 in Equation (5) is made non-informative by assigning a  and b  to small values such as 0.001. Choice of all the parameters is discussed in more details in Supplementary Materials. Metabolite identification as a variable selection task: the problem of metabolite identification is similar to Bayesian variable selection in linear regression (), and is complicated by the inclusion of subject-specific random effects. It is also similar to variable selection developed for Bayesian linear mixed models and generalized linear models (;), where we automatically identify subsets of predictors having non-zero coefficients of fixed effects or non-zero variances of random effects. However, such approaches are not directly applicable to the model in (1)(5), as they treat fixed and random effects separately, and do not allow a simultaneous selection of variables that are both fixed and random effects. An alternative variable selection approach has been proposed for automatic selection of knot locations for B-spline, where a linear mixed model restricts fixed and random effects to be the same set of variables representing knot locations (). Although this approach addresses a similar variable selection task, the model in (1)(5) is more comprehensive. It contains extra fixed effects for baseline, nonnegativity constraints on the parameter space and additional indicator variables for practical significance controlling both fixed and random effects. Therefore, we propose a Gibbs sampling scheme to explore the highdimensional variable space, to obtain joint posterior probabilities for sets of parameters, as well as marginal posterior probabilities for the statistical and practical significance of individual metabolites.
BQuant: Bayesian inferenceThe Gibbs sampling scheme iteratively samples from the following conditional distributions.
Page: 1641 16371644
H NMR spectra(1) Sample fixed effects (  ,) from their conditional distribution:where(3) Sample the variance of measurement errorwhere  , is the submatrix of  where only the rows corresponding to both  l = 1 and  l = 1 are retained.is given in Supplementary Materials. Only one component of  is updated at this step for the current iteration and a different component will be updated in the next iteration until every component of  is updated once. Then the entire vector of  will be sampled component-wise the second time.The details of this distribution are given in Supplementary Materials.Posterior inference: Gibbs sampling is continued N b +N s iterations with a burn-in period of N b. We focus on the posterior distributions of the parameters which are directly related to the identification and quantification of metabolites in (1). These parameters include  for indicating the subset of the metabolites in the database that are present with high probability,  l for average abundance of metabolite l and  l,i =  l + l,i for representing the abundance of metabolite l in sample i. The parameters can be estimated using two approaches. The first involves model averaging (), where the parameters are estimated by their posterior means and approximated by averaging over all draws of Gibbs sampling after the initial burn-in period:Alternatively, we can estimate  by the vector with largest posterior probability among all vectors visited by the Gibbs sampler ()
DATASETSAcquisition of NMR spectra: the experimental 1 H NMR spectra were obtained using the NOESYPR pulse sequence at 500 MHz on a Bruker Avance NMR spectrometer and utilizing a z-gradient HCN triple resonance cryoprobe. Extensive details are provided in Supplementary Materials. Simulated spectra: we simulate n = 20 spectra with J = 100 intensities per spectrum. The simulation follows the model in Equation (1); however, additional noise signals are introduced to test for robustness. The simulated spectra are constructed from four out of a total of eight candidate metabolites. Spike-in experiment: a urine sample was collected from a healthy male individual, according to a protocol approved by the Institutional Review Board at Purdue University. Five metabolites (taurine, hippuric acid, nicotinic acid, malic acid and oxoglutaric acid) were added to the urine sample in varying concentrations, according to a latin square design. These metabolites were chosen as they are potentially observable in urine with 1 H NMR; however, no noticeable abundance of these metabolites was detected in this specific urine sample. Therefore, the sample will have little interference on total abundances of these metabolites in the spiked mixtures. Three replicate 1 H NMR spectra were acquired from each mixture. For each of the five spiked metabolites, we manually select a local region containing pronounced peaks of the metabolite. The regions are listed in, and an example is shown in. Metabolomic investigation of plasma samples: we analyze plasma samples from 46 healthy individuals. The Institutional Review Board at Indiana University approved the study protocol, and written informed consent was obtained from all subjects before enrollment. Since the true identities and abundances of metabolites in these samples are unknown, we compare the ability of various methods to identify and quantify metabolites against a benchmark of manual identifications by NMR experts. Moreover, independent laboratory quantification of one metabolite in these samples (creatinine) was obtained as part of routine clinical care, and are available for all the 46 samples. Thus, we evaluate the performance of statistical methods in terms of agreement between the enzymatic (i.e. laboratory) and NMR-based quantifications of creatinine. We select two regions to demonstrate the application of BQuant, which include 0.88521.04 p.p.m. and 3.924.3 p.p.m. The first region contains a moderate degree of peak overlap and a non-zero baseline. Peak deconvolution is, therefore, particularly important for identifying these metabolites. The second region contains the best-resolved creatinine peak. Although the shape of the peak is well preserved, its signal is convoluted with other signals, in particular with a broad lipid peak. These two regions represent examples of typical real-life challenges in spectral interpretation.
RESULTSWe compared the performance of BQuant to representative instances of three classes of fully automated methods in Section 2. Binning is represented by the adaptive intelligent binning (AI binning) (). An instance of curve fitting without a database is the multiplicative update algorithm implemented in the R package 'Non-negative matrix factorization (nmf)' (), which we abbreviate as MU-NMF. Both AI binning and MU-NMF cannot automatically identify the metabolites, and cannot be compared to BQuant in terms of identification. Therefore, we attempted to identify the bins (or the components of the deconvoluted mixtures) manually whenever possible, to compare the performance of these methods in terms of quantification. Curve fitting with a database is represented by least-squares deconvolution (LD) (), and enables a simultaneous identification and quantification of metabolites. Since the original implementation of LD does not account for a baseline, this can negatively affect the performance of the method. Hence Page: 1642 16371644we also implemented a modified version of LD which, similarly to BQuant, incorporates a sample-specific baseline using penalized B-spline. This is accomplished by adding a term including the same design matrix S as specified in model (1), and a sample-specific coefficient  i , to the original formulation of LD. We refer to this modified version as LD with baseline (LDBL). We applied both LD and LDBL to the individual spectra in full resolution. Since the methods are only applicable to the individual spectra, we compared them to BQuant according to the list of most frequently identified metabolites. To reduce the computational complexity of BQuant, we used LDBL for reduction of the size of the database. We chose L max = 35, since local regions typically do not contain more than 35 significantly abundant metabolites.
C.Zheng et al.
Evaluation on the simulated spectraIdentification accuracy: our goal was to identify the four true metabolites out of the total of eight candidate metabolites. For LD and LDBL, the model was fit to each spectrum individually and we inspected the top four metabolites with the highest estimated abundance. For BQuant, according to, the model withEach row corresponds to one metabolite. The four columns list the R 2 values for a simple linear regression with no intercept, where the true abundance is used as the predictor, and the quantified abundance as the response variable. A higher value indicates better performance. the highest posterior probability was the true model with four out of eight metabolites selected.compares the accuracy of automated metabolite identification by LD, LDBL and BQuant and shows that identification by BQuant outperforms these methods in terms of accuracy of identification. Quantification accuracy: to evaluate the quantification accuracy of AI binning, we manually selected bins dominated by signals from the true simulated standard spectra. Supplementary Materials show an example of MU-NMF deconvolution of one simulated spectrum. It illustrates that the identified components are not immediately interpretable in terms of the metabolites in the database, and cannot be used for quantification. Successful quantifications should be linearly associated to the theoretical abundance of the metabolites, with a 45-degree slope and no intercept. The R 2 of this linear model, fitted separately for each method of metabolite quantification, are summarized in. Overall, BQuant showed the best performance. A closer case-bycase inspection revealed that metabolites with fewer peaks and lower relative abundance were more difficult to identify and quantify by all methods.
Evaluation on the spike-in datasetIdentification accuracy: LD, LDBL and BQuant could all identify the five spiked metabolites from the spectra. Quantification accuracy: as in the case of simulated dataset, we manually identified the bins resulting from the AI binning; however, no manual identification could be obtained for the output of MUNMF. After fitting a linear regression model with no intercept, the true abundance as the predictor and the quantified abundance as the response for each method, the R 2 s are summarized in. Overall, BQuant outperformed the other three methods. The suboptimal performance of AI Binning was primarily due to the contributions of tail areas from neighboring peaks to the abundance of the bins. Since LD decomposes the spectrum individually, and does not synthesize the information across samples, it underperformed BQuant in regions with heavy overlap.
Application to the investigation of plasma samplesIdentification accuracy: the goal of the investigation is to accurately identify and quantify metabolites in regions of 1 H NMR spectra from plasma samples of 46 subjects. The first region of interest in this dataset is 0.88521.04 p.p.m. Manual identification of metabolites, aided by Chenomx, reveals three major metabolites (leucine, isoleucine and valine), and a local baseline created by the lipid signal.illustrates the deconvolution of one of the spectra in the region by MU-NMF, LD, LDBL and BQuant. As can be seen in the figure, the components extracted by MUNMF were not immediately interpretable. They also conflicted with manual interpretations of the spectra. The results of LD are severely hampered by the presence of the baseline, which is not properly accounted for by the model. Although leucine and valine were identified as the two most abundant metabolites across all the samples, isoleucine was not among the top three most abundant metabolites in any of the 46 cases. The results of LDBL have a higher agreement with the manual identification; however, isoleucine remained excluded from the list of three most abundant metabolites in 15 out of 46 samples. This is due to a small peak near 0.98 p.p.m., which was falsely decomposed as a sum of peaks from two separate metabolites (butanone and isoleucine), instead of from isoleucine alone. As shown in, BQuant contains leucine, isoleucine and valine as components in the most probable a posteriori model, and assigns them the largest estimates of abundance. It is worth mentioning that manual identification of metabolites such as 2-aminobuyrate is challenging, as they typically have a weak signal in a region that is occupied by other metabolites. Similarly, imprecise results were obtained in the second region of 3.924.3 p.p.m. with MU-NMF, LD and LDBL.shows that BQuant automatically identified the metabolites, which were manually confirmed by NMR experts. Quantification accuracy: as in the previous cases, we manually identified the bins resulting from the AI binning, but could not identify the signals from the output of MU-NMF, to evaluate their accuracy of quantification.shows the coefficients of multiple determination of the abundance of creatinine obtained by enzymatic methodology , and derived by AI binning, LD, LDBL and BQuant from the NMR spectra. Since creatinine has two peaks, two bins are listed separately for AI binning, and the first bin contains signals from additional overlapped peaks. As can be seen, BQuant yields the best quantification result among all the methods.The table shows all the metabolites with the highest posterior probability, along with their posterior mean and 95% credible interval.
and  are frequencies of  l = 1 and  l =
CONCLUSION
Database-based identification and quantification of metabolites fromPage: 1644 16371644
C.Zheng et al.additional peaks. The second reason for the improved performance of BQuant is that, unlike many other approaches, it simultaneously models the entire collection of spectra. This allows us to incorporate the maximal amount of information into parameter estimation and inference. When the set of spectra is highly heterogeneous, BQuant could potentially produce less accurate results. However, such a case will be challenging for any automatic approach. Finally, the implementation of BQuant is practical and useful, and can be easily integrated with other automated data analysis pipelines.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [12:16 30/5/2011 Bioinformatics-btr118.tex]
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
after the burn-in period. In the second column, 2-ami * = 2-aminobutyrate; 3-hyd * = 3hydroxybutyrate; 2-deo * = 2-deoxyguanosine. The last column indicates whether the metabolite identification is manually confirmed by NMR experts.
H NMR spectra attracts growing attention. However, there is currently no fully automatic way of assisting this labor-intensive procedure. We developed a probabilistic approach BQuant, which combines linear mixed modeling and Bayesian model selection, and automatically identifies and quantifies metabolites in local regions of spectra. At the same time, the model used in BQuant is more complex than the standard linear mixed models, as it accounts for the specialized characteristics of NMR spectra. To the best of our knowledge, BQuant is the first application of linear mixed modeling to the database-based 1 H NMR spectra deconvolution. BQuant outperformed the existing automated approaches in terms of accuracy of both identification and quantification of metabolites. The improved performance is achieved for two reasons. First, the problems of identification and quantification of metabolites are interrelated, in particular in regions with heavy peak overlap. Unlike many other methods, which solve these problems sequentially, BQuant identifies and quantifies the metabolites simultaneously and iteratively, by means of Gibbs sampling. Therefore, accurate identification of peaks helps improve the accuracy of quantification, and well-quantified metabolites help identify the sources of the
