Motivation: Synthetic lethal sets are sets of reactions/genes where only the simultaneous removal of all reactions/genes in the set abolishes growth of an organism. Previous approaches to identify synthetic lethal genes in genome-scale metabolic networks have built on the framework of flux balance analysis (FBA), extending it either to exhaustively analyze all possible combinations of genes or formulate the problem as a bi-level mixed integer linear programming (MILP) problem. We here propose an algorithm, Fast-SL, which surmounts the computational complexity of previous approaches by iteratively reducing the search space for synthetic lethals, resulting in a substantial reduction in running time, even for higher order synthetic lethals. Results: We performed synthetic reaction and gene lethality analysis, using Fast-SL, for genome-scale metabolic networks of Escherichia coli, Salmonella enterica Typhimurium and Mycobacterium tuberculosis. Fast-SL also rigorously identifies synthetic lethal gene deletions, uncovering synthetic lethal triplets that were not reported previously. We confirm that the triple lethal gene sets obtained for the three organisms have a precise match with the results obtained through exhaustive enumer-ation of lethals performed on a computer cluster. We also parallelized our algorithm, enabling the identification of synthetic lethal gene quadruplets for all three organisms in under 6 h. Overall, Fast-SL enables an efficient enumeration of higher order synthetic lethals in metabolic networks, which may help uncover previously unknown genetic interactions and combinatorial drug targets. Availability and implementation: The MATLAB implementation of the algorithm, compatible with COBRA toolbox v2.0, is available at https://github.com/RamanLab/FastSL
IntroductionIn the recent years, genome-scale metabolic networks have been reconstructed for many organisms (). These networks have been studied using tools such as flux balance analysis (FBA) (), for the identification of drug targets (), targets for metabolic engineering () and to understand the robustness of organisms through systematic experimental evaluation of gene knockouts (). Another important aspect of analyzing these reconstructed metabolic networks is the identification of combinations of genes, which when simultaneously deleted, abolish growth in silico (). These sets, termed 'synthetic lethals', reveal complex interactions in metabolic networks. Synthetic lethals have been analyzed in the past for prediction of novel genetic interactions and analyzing the extent of robustness of biological networks (). Prediction of phenotypic behavior on genetic perturbationshas also been studied in many reconstructions () for model validation. FBA has been proven to accurately predict phenotypes following various genetic perturbations (); previous reports also suggest that FBA can reliably predict synthetic lethal genes in metabolic networks of organisms such as Saccharomyces cerevisiae (). The identification of synthetic lethal genes in metabolic networks also finds application in combinatorial therapy, as combinatorial deletion strategies are more difficult for the organism to resist (). Since the systematic evaluation of these targets in vivo is challenging, computational approaches have been of great interest to overcome this difficulty (). Exhaustive enumeration of synthetic lethals of higher orders was previously performed by parallelizing the deletions on a cluster of computers (). However, exhaustive enumeration is computationally very expensive, and even prohibitive, in case of larger metabolic networks. Another algorithm for identifying synthetic lethal reactions and genes is 'SL Finder', published by Maranas and co-workers (). SL Finder elegantly poses the identification of synthetic lethals as a bilevel Mixed Integer Linear Programming (MILP) problem; the algorithm has been applied for the identification of synthetic lethal doublets and triplets in Escherichia coli. Reaction essentiality has been previously inferred using elementary modes and minimal cut sets (). Even though there are efficient algorithms to analyze minimal cut sets in a metabolic network, the MILP formulation is fundamentally NP-hard () and is prohibitive in case of large networks. Other methods also suggest ways for reduction of metabolic networks and alternate formulations to enumerate minimal cut sets for the identification of synthetic lethal sets (). We here propose an alternative algorithm, Fast-SL, which circumvents the computational complexity of both exhaustive enumeration and bi-level MILP, through an iterative reduction of the search space for higher order synthetic lethal sets. We also present an efficient method to rigorously identify lethal gene sets, identifying upto quadruple lethal gene sets that were not previously identified. Fast-SL formulation for gene deletions also compares favorably with logical transformation of model (LTM) approach (), which transforms the stoichiometric matrix such that lethal gene deletion sets can be identified by merely identifying lethal reaction sets applying the Fast-SL algorithm on the transformed matrix (using the pre-print of an earlier version of this paper available at arXiv.org). Fast-SL provides a rapid way to gain insights into the genetic robustness of organisms by identifying synthetic lethal sets even up to the order of four.
Methods
OverviewFBA involves the formulation of a Linear Programming (LP) problem, whose objective function typically is to maximize flux through the biomass reaction (v bio ), subject to the constraints obtained from the stoichiometry of the metabolic network (represented by the stoichiometric matrix S). FBA has also been used to simulate the effects of the removal of one or more genes/reactions from a metabolic network. The phenotype obtained as a result of gene/reaction deletion is classified as a lethal phenotype, if the maximum growth-rate obtained by FBA is less than a specified cut-off, typically 1% of the in silico maximum wild-type growth rate (), denoted as v co. We here propose an alternative algorithm to identify synthetic lethals, using an iterative approach that greatly reduces the search space for the synthetic lethals. The standard FBA formulation to identify effects of reaction deletions is as given below: max: v bios:t: R j s ij v j  0 8i 2 M; 8j 2 J (2)LB j v j UB j 8j 2 JHere, J represents the set of all reactions in the metabolic model M represents the set of all metabolites in the metabolic model D represents the set of reactions whose fluxes are set to zero (for deletion) v j represents the flux through the j th reaction v bio represents the flux through the biomass reaction s ij represents the corresponding element in the stoichiometric matrix S LB j and UB j represent the lower and upper bounds of the fluxes through the j th reaction respectively The maximum v bio obtained here, using Equations (1)(3), for the wild-type strain, is designated as v bio;WT. Further details on the FBA formulation, such as the substrate uptake fluxes and the upper and lower bounds are given in Supplementary File S1.
Fast-SL algorithmThe objective of Fast-SL is to enumerate combinations of reactions, which when deleted, abolish growth. We achieve this by a combination of pruning the search space and exhaustively iterating through the remaining combinations. We successively compute: (i) J sl , the set of single lethal reactions, (ii) J dl (J dl & J 2 ), the set of synthetic lethal reaction pairs, and (iii) J tl & J 3 , the set of synthetic lethal reaction triplets. Initially, we use FBA to compute a flux distribution, corresponding to maximum growth rate, while minimizing the sum of absolute values of the fluxes, i.e. the ' 1-norm of the flux vector. We hereafter denote this flux distribution as the 'minimum norm' solution of the FBA LP problem. We denote the set of reactions that carry a non-zero flux in this minimum norm solution as J nz. Below, we outline the minimum norm FBA formulation, corresponding to maximum wild-type growth rate obtained earlier (v bio;WT ):s:t:R j s ij v j  0 8i 2 M; 8j 2 JLB j v j UB j 8j 2 J2.2.1 Identifying single lethal reactions (J sl ) If a reaction is essential (single lethal) in a given environment, constraining its flux to zero results in the abolishment of biomass flux.We argue that the set of all such single lethal reactions, J sl , is completely contained in J nz. Conversely, J  J nz does not contain any of the single lethal reactions, which are essential for growth in the medium under consideration. This is because, if it is possible to identify a flux distribution that admits maximum biomass flux (as enforced by the constraint in the Equation (6)), and at the same time zero flux through certain reactions (D & J  J nz ), obviously, those reactions cannot be essential for the growth of the organism. This can also be understood in light of the FBA formulation given by Equations(1)(4): the constraint in Equation (4) for the reactions in the set D & J  J nz will not have any impact on the biomass flux (setting v d  0 for reactions already carrying zero flux in the minimum norm solution will not affect the solution to FBA). Hence, for the lethality analyses of order one, we look only in the set of reactions with non-zero fluxes, J nz. We therefore compute single lethal reactions (J sl ) by performing exhaustive single reaction deletions only in J nz , instead of J.
Identifying double lethal reactions ( J dl )We posit that for every pair in the set J dl , at least one of the reactions will be in J nz. Consider any pair of reactions i and j 2 J. Only two types of such pairs exist:i. i and j 6 2 J nz ii. at least one of i or j 2 J nzFor pairs of type (i): Suppose, both reactions of a pair do not belong to J nz. This implies that both have zero flux through them under the minimum norm formulation and hence deleting them simultaneously does not produce a lethal phenotype and consequently, they do not form a lethal reaction pair. Our algorithm identifies and eliminates such pairs for consideration and hence reduces the search space substantially.illustrates the savings obtained in terms of the number of LPs solved in comparison to exhaustive enumeration. For pairs of type (ii): For all the other reaction pair combinations (i.e. at least one reaction of a pair 2 J nz  J sl ), we first obtain the minimum norm solution after removing a reaction, say, i 2 J nz  J sl , and obtain the set of non-zero fluxes J nz;i. It is important to note that, under this deletion, the v bio;WT of Equation (6) will be replaced by the corresponding maximum flux through the biomass reaction after removing the i th reaction, v bio;i. This is because removal of the i th reaction may not always result in the same maximum value of the wild-type biomass flux, v bio;WT , as it was obtained prior to the deletion and constraining so may result in an infeasible solution. Therefore, the RHS in Equation (6) is the maximum biomass obtainable under the deletion of reaction i, denoted as v bio;i and not v bio;WT. Similar to Fast-SL for single lethal reactions, we restrict our search space for potential synthetic double lethal deletions to the set J nz;i  J sl. Under this configuration, as the reaction i is already removed, a synthetic lethal reaction j 2 J nz;i  J sl , would actually correspond to a lethal reaction pair fi; jg. Algorithm 1 shows the Fast-SL implementation to identify lethal single and double reaction deletions as explained above. We illustrate the application of Fast-SL to identify single and double lethal reactions in the E.coli iAF1260 model, as well as the algorithm for identifying lethal reaction triplets, in Supplementary File S1. The algorithm can be further extended to quadruplets and higher orders using a similar approach.Algorithm 1: Algorithm to identify single and double lethal reaction sets. Input: SBML model of an organism Output: Set of single lethal reactions J sl Set of double lethal reactions J dl Do FBA to obtain the maximum biomass flux for wild-type, v bio;WT Do FBA to obtain minimum norm solution corresponding to v bio;WT Identify set of reactions J nz , having non-zero fluxes Set 0:01  v bio;WT as the cut-off for lethality, v co for each reaction i 2 J nz do Set the upper and lower bounds of v i to zero Do FBA to maximise growth rate, v bio;i if v bio;i v co then Add i to the set J sl end if Reset bounds on v i end for for each reaction i 2 J nz  J sl do Set the upper and lower bounds of v i to zero Do FBA to obtain minimum norm solution corresponding to v bio;i Identify set of reactions J nz;i , having non-zero fluxes for each reaction j 2 J nz;i  J sl do Set the upper and lower bounds of v j to zero Do FBA to maximise growth rate v bio;ij if v bio;ij v co then Add fi; jg to the set J dl end if Reset the bounds on v j end for Reset bounds on v i end for
Fast-SL algorithm for gene deletionsThe synthetic lethal gene deletions can be obtained using a similar approach to that of Fast-SL for lethal reaction deletions by additionally considering the GeneProteinReaction (GPR) associations in the model. As these associations are often 'many-to-many', it is nontrivial to identify all the lethal gene sets from lethal reaction sets of the same order. To account for this complexity, Fast-SL groups the reactions based on their GPR associations. Each time a reaction is deleted, other associated reactions are also removed, based on the underlying GPR rules. The lethal reaction sets obtained using this method are then analyzed for lethal gene deletions up to the order of four. Further details on the gene deletion algorithm are available in Supplementary File S1. We implemented Fast-SL for both reaction and gene deletions in MATLAB (R2013b, The Mathworks Inc.), interfacing with COBRA Toolbox v2.0 ().
Parallel Fast-SL algorithmTo further improve the time profile of the Fast-SL algorithm, we have developed a parallel version of our algorithm to identify both synthetic lethal reaction and gene sets, which enables us to even identify synthetic lethal quadruplets, within a few hours. Unlike the
A.Pratapa et al.exhaustive enumeration algorithm, the Fast-SL algorithm by itself is not embarrassingly parallel. However, the enumeration of a particular order of synthetic lethals can be easily parallelized. For example, in the case of single lethal reactions, once the minimized ' 1-norm solution is identified, the subsequent LPs to be solved for identifying J sl can be evaluated in parallel. A similar strategy can be applied to first identify the potential synthetic lethal sets (reaction sets with non-zero fluxes, obtained using the ' 1-norm solution) at each stage of a particular order and then perform the deletions in parallel to further reduce the time taken to identify synthetic lethal reaction and gene sets. This parallelization scheme ensures a superior utilization of computing resources available.
ResultsWe performed gene and reaction deletions up to the order of four using Fast-SL for the genome-scale metabolic networks of E.coli iAF1260 () and two important pathogenic organisms, Salmonella enterica Typhimurium LT2 STM_v1.0 () and Mycobacterium tuberculosis iNJ661 ().
Fast-SL massively prunes the search space for synthetic lethal reactionsThe Fast-SL formulation eliminates large sections of the search space for synthetic lethals, as described earlier, resulting in a massive speedup over exhaustive search. Fast-SL formulation results in more than a 4000-fold reduction in the search space for synthetic lethal triplets in E.coli; for a smaller model such as that of M.tuberculosis with 1028 reactions, the reduction is over 300-fold. In order to appreciate the speed-up offered by Fast-SL, consider the E.coli iAF1260 model that has 2 382 reactions. For aerobic growth under minimal glucose conditions, the maximum wild-type growth rate as obtained by FBA, v bio;WT , is 0.9290 mmol gDW 1 h 1. The minimum norm formulation, given by Equations (5)(8), results in a flux vector having 406 reactions with non-zero fluxes, and the same growth rate, v bio;WT. The set J nz comprises of these 406 reactions. As mentioned earlier, Fast-SL analyzes the effect of deletion of reactions in J nz to identify lethal reaction sets: we identified 278 single lethal reactions (J sl ) after solving only 379 LP problems instead of 2 051. Extending this formulation, Fast-SL identified 1.56 million reaction pairs whose deletion would not result in a lethal phenotype and solved only 6 084 LPs to identify lethal reaction pairs. We have identified 96 synthetic lethal reaction pairs and 247 synthetic lethal reaction triplets in E.coli, which match exactly with the results obtained through exhaustive enumeration of lethal reaction sets and also the MCSEnumerator Algorithm (von).is able to enumerate all synthetic lethal triple reaction sets in % 6:75 days, on a 3 GHz processor. We have been unable to perform a systematic comparison owing to the difference in platforms (General Algebraic Modelling System (GAMS) versus MATLAB), as well as processors used. However, we note that the savings obtained through a pruning of reaction space and the fact that we solve only a large number of small LPs instead of a bi-level MILP, render Fast-SL as a powerful alternative for metabolic networks of any size.enumerates the number of LPs solved by the proposed algorithm as compared to the exhaustive enumeration for all three organisms. For each of the three models under consideration, Fast-SL provides a significant reduction in the search-space for the enumeration of synthetic lethal reaction sets. A complete listing of lethal reaction sets for all three organisms is available in Supplementary File S2.
Fast-SL rigorously identifies synthetic lethal genesFast-SL carefully considers the GPR associations to rigorously identify synthetic lethal gene deletions up to order four for the organisms.shows the number of lethal gene deletions identified for the organisms under consideration. We corroborated these results byperforming exhaustive triple gene deletions on a computer cluster with 1000 nodes for all three organisms and we found an exact match. Fast-SL identified 285 lethal gene triplets under minimal glucose conditions in the E.coli iAF1260 model. The SL Finder algorithm () identified only 158 lethal gene triplets (in the same model under the same medium conditions). We thus identified 127 new lethal gene triplets in E.coli using Fast-SL. Perhaps, these triplets were not identified by SL Finder owing to the complexity in defining the binary variable for gene deletions using the bi-level MILP formulation. To accommodate the genereaction associations, the SL Finder approach introduces new binary variables (corresponding to genes) and imposes additional constraints on them (corresponding to genereaction rules). This introduction of new variables and constraints would increase the problem size significantly depending upon the number of genes present in the model as well as the gene-reaction rules, which may add to the difficulty in identification of all the lethal gene sets using the SL Finder approach. Among the newly identified triplets using Fast-SL, 121 belong to central carbon metabolism, four triplets belong to amino acid synthesis and the rest are involved in metal-ion transport reactions. More information on these 127 gene triplets obtained can be found in Supplementary File S3. Using the parallel Fast-SL algorithm we were able to identify lethal gene quadruple sets for all the three organisms in less than 6 h. A complete listing of lethal gene sets for all three organisms is available in Supplementary File S4.
Missing biomass precursors in lethal gene deletionsTo further demonstrate why certain deletions are lethal for the organism's survival, we identified the missing precursor metabolites for the synthetic lethal gene sets in E.coli using the method available from the COBRA Toolbox (). Under the FBA formulation, failure of an organism to produce any of the biomass precursors results in a zero growth-rate.summarizes our findings for the given biomass configuration in (). The biomass of E.coli comprises amino acids, cofactors, inorganic ions, lipids, lipopolysaccharides (LPS), metabolites required for maintenance (ATP), murein and nucleic acids. From the lethal single and double gene deletion sets obtained using Fast-SL, we identified that they predominantly involve non-production of essential metabolites such as tetrahydrofolates, Coenzyme A and S-Adenosyl methionine. Interestingly, more than 30% of the deletions in synthetic lethal triplets and quadruplets primarily affect mechanisms involved in ATP production required for maintenance. In 48 of the quadruple lethal gene sets, we observed that the organism is unableMissing biomass precursors under lethal gene deletions in Escherichia coli. The biomass constituents are classified into eight different groups as given in the model, namely, amino acids, cofactors, inorganic ions, lipids, lipopolysaccharides (LPS), metabolites required for maintenance (ATP), murein and nucleic acids. The figure illustrates the percentage of missing biomass precursors under single, double, triple and quadruple lethal gene deletions to produce more than 70% of the biomass precursors under consideration, belonging to all metabolite groups except the inorganic ions (as their exchanges are unaffected under these deletions). These observations reiterate the robustness of cellular metabolism and at the same time, the central and critical role played by co-factors and ATP. It is important to note that approximately 14% of all lethal deletions (up to order four) result in a non-zero, but severely hampered, growth rate (here it is less than 1% of the maximum wild-type growth rate, v bio;WT ) and therefore do not have any missing precursors under the optimal FBA configuration.
DiscussionIn this study, we describe a new algorithm to rapidly identify synthetic lethal reaction/gene sets in genome-scale metabolic networks. The identification of synthetic lethals in organisms can be used to understand complex genetic interactions between genes and identify drug targets for combinatorial therapy (). We build on the popular framework of FBA, extending it to identify synthetic lethals; our algorithm exploits the structure of the metabolic network better than previous algorithms, to eliminate combinations of reactions/genes that are guaranteed not to produce a lethal phenotype under the conditions considered. Importantly, our algorithm also identifies synthetic lethal gene sets rigorously, by carefully considering the GPR associations in the metabolic model. Fast-SL therefore manages to identify 127 new lethal gene triplets in E.coli, which were not identified by a previous study () (indicated in Supplementary File S3). Further, we confirmed that our algorithm does not miss out on any synthetic lethal gene sets, by cross-checking with an exhaustive analysis of triple gene deletions on a computer cluster. Our algorithm for finding synthetic lethal gene sets also outperforms the LTM method () which increases the problem size in the case of E.coli from 1668  2382 to 5372  7287. For the same model, our approach avoids this transformation and consequently solves far fewer LPs, thereby computing the lethal sets in much less time. Fast-SL utilizes the flux corresponding to ' 1-norm minimization, which can be easily formulated as an LP. It is important to note that there may be multiple J nz sets corresponding to the minimum sum of absolute values of fluxes (i.e. minimized ' 1-norm solution) and these J nz sets may also vary in terms of their sizes. It does not matter which J nz set one may begin the algorithm with, because in all the J nz sets, the arguments that J sl is completely contained in J nz and at least one of i or j of a lethal pair (i, j) belongs to J nz and so on, always hold true. However, smaller the size of the set J nz in each step, faster the algorithm would be. More importantly, minimization of the ' 1norm of the flux vector may not always converge to the sparsest possible solution, which is often denoted as the ' 0-norm solution. Here, it is also important to note that Fast-SL does not require the sparsest solution to work; a reasonably sparse solution already achieves a significant search space reduction, while circumventing the complexity of the ' 0-norm MILP formulation. Our work does have its limitations. As with any other metabolic network analysis technique, our method suffers from any inadequacies present in the model. Nevertheless, our algorithm can identify a list of lethal (and non-lethal) phenotypes, which can be used to refine the metabolic model, based on disagreements with experimental results. Further, the synthetic lethals predicted by our algorithm are valid only in a particular environment/growth medium; it is however straightforward to identify lethal sets for other environments, by altering the constraints suitably.In sum, we see three main contributions of our method. First, Fast-SL achieves a massive reduction in the search space and obviates the need for performing an exhaustive analysis of combinatorial gene/reaction deletions. This can facilitate the identification of combinatorial drug targets in organisms, even up to the order of four, which was previously nearly intractable (). Second, Fast-SL also compares favorably with the MCSEnumerator algorithm, eliminating the need to solve complex MILPs. Finally, FastSL also rigorously identifies lethal gene sets, uncovering lethal gene sets not previously identified by other algorithms. Overall, Fast-SL enables a rapid evaluation of combinatorial gene and reaction deletions in genome-scale metabolic networks, which may help identify previously unknown genetic interactions and combinatorial drug targets.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Fast-SL at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
