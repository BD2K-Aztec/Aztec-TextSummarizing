Motivation: A variety of hypotheses have been proposed for finding the missing heritability of complex diseases in genome-wide association studies. Studies have focused on the value of haplotype to improve the power of detecting associations with disease. To facilitate haplotype-based association analysis, it is necessary to accurately estimate haplotype frequencies of pooled samples. Results: Taking advantage of databases that contain prior haplotypes, we present Ehapp based on the algorithm for solving the system of linear equations to estimate the frequencies of haplotypes from pooled sequencing data. Effects of various factors in sequencing on the performance are evaluated using simulated data. Our method could estimate the frequencies of haplotypes with only about 3% average relative difference for pooled sequencing of the mixture of 10 haplotypes with total coverage of 50Ã‚. When unknown haplotypes exist, our method maintains excellent performance for haplotypes with actual frequencies 40.05. Comparisons with present method on simulated data in conjunction with publicly available Illumina sequencing data indicate that our method is state of the art for many sequencing study designs. We also demonstrate the feasibility of applying overlapping pool sequencing to identify rare haplotype carriers cost-effectively. Availability and implementation: Ehapp (in Perl) for the Linux platforms is available online
INTRODUCTIONGenome-wide association studies have identified numerous genetic variants associated with complex diseases and traits, and have provided valuable insights into their genetic architecture. However, most variants identified so far confer relatively small increments in risk, and explain only a small proportion of heritability (). A variety of hypotheses have been proposed to explain the missing heritability, including rare variants, genegene and geneenvironment interaction (). In addition, studies have focused on the values of haplotypes and genome-wide haplotype association (GWHA) studies have been presented to find the association between haplotypes and diseases (). The combination of genetic marker alleles such as single nucleotide polymorphisms (SNPs) on a single chromosome is called a haplotype, which provides valuable information on evolutionary history and may lead to the development of more efficient strategies to identify genetic variants that increase susceptibility to diseases (). Rather than examining variants independent of each other, simultaneously considering the values of multiple variants within haplotypes can improve the power of detecting associations with disease (). Up to now, numerous haplotypes have been found associated with several diseases (). To facilitate GWHA studies, it is necessary to estimate haplotype frequencies accurately from deoxyribonucleic acid (DNA) pools of case and control samples.presented PoolHap to estimate haplotype frequencies from pooled samples by next-generation sequencing. On the basis of an expectation maximization algorithm,put forward Harp to calculate the frequencies of haplotypes from pooled sequencing data. However, both PoolHap and Harp required that the haplotypes for pooled samples were known for inferring the frequency which may conflict with real situation. Taking advantage of haplotype database information has been proved feasible and helpful for haplotype frequency estimation (). Under the plausible assumption that few haplotypes actually possess the vast majority of proportion or haplotype database is large enough, compressed sensing (CS) () could be used for the rapid and accurate reconstruction of the haplotype composition of pooled samples.utilized techniques from CS to reconstruct the composition of a mixture of bacteria by utilizing databases that contain all the possible species.translated the haplotype frequencies estimation as a joint constrained sparse optimization problem which has been studied in the CS literature. With the development of sequencing technology, a large number of haplotypes are rapidly gathered into public databases such as HapMap (), DGRP (The Drosophila Genetic Reference Panel,), and 1001 genomes (). The number of samples used in HapMap allows the project to find *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 99% of haplotypes with frequencies of 5% or greater in a population (). Since CS was proposed to recover sparse signals from incomplete and inaccurate measurements (), suppose the haplotypes for the samples in pooled sequencing are included in the database which is large enough, it is viable to infer the frequencies of haplotypes contained in the prior database by utilizing techniques from CS. However, for low-frequency haplotypes not contained in the database, it is hard to recover the frequency. Once a haplotype is confirmed that it has association with diseases, similar to genomic variants, screening for the haplotype carriers is of great value in practical application. Borrowing ideas from group testing theory (Ding), overlapping pool sequencing was presented for the purpose of identifying rare variant carriers cost-effectively (). On the basis that the frequencies of haplotypes could be estimated precisely from pooled sequencing data, clearly, overlapping pool sequencing can also be applied in the identification of rare haplotype carriers. Here, by means of prior haplotype information contained in the database, we present a method to estimate the haplotype frequencies from pooled sequencing data. The proposed method uses as inputs a database of haplotypes and pooled sequencing results, and returns estimated frequency for each haplotype contained in the database. A mathematical framework is first presented to translate haplotype frequency estimation as solving a system of linear equations. NNREG algorithm () is employed to calculate the frequencies of haplotypes. Effects of various factors in sequencing on the performance of our method were evaluated using simulated data. The effects of unknown haplotypes contained in the pooled samples were also demonstrated. Comparison with Harp on both simulated data and publicly available Illumina sequencing data showed that our method may be more preferable for current massive parallel sequencing. Finally, on the basis of accurate estimation of haplotype frequency from pooled sequencing data, we revealed that it is feasible to identify rare haplotype carriers cost-effectively by applying overlapping pool sequencing. We have implemented the method in an open-source software tool Ehapp (estimate haplotype frequency from pooled sequencing data, http://bioinfo.seu.edu.cn/Ehapp/).
METHODS
Encode database information and pooled sequencing resultsFor haplotype consisting of SNPs, we first design a binary matrix to encode the database information. A binary vector with length 4 is defined to denote each kind of base (). A haplotype with L SNPs in the database can be converted into a vector with length 4L. For instance, the haplotype 'TGCA' is denoted as (0,1,0,0,0,0,1,0,0,0,0,1,1,0,0,0) T. Consequently, a database containing N haplotypes with L SNP loci can be translated into a 4L  N binary matrix M, in which columns are indexed by haplotypes and every four rows are indexed by an SNP. For the pooled sequencing experiment, the results are transformed as a numeric vector Y with length 4L, which consists of the proportions of A, T, C and G for each SNP in the sequencing data (). Let x = (f 1 , f 2 ,. .. , f N ) be the frequencies of all possible haplotypes, which are listed in the database, for the pooled samples. For each SNP, four equations for the proportions of bases A, T, C and G can be constructed (). As a consequence, the problem to estimate frequency for each haplotype can be translated as solving Equation (1) ().
Mx=Y 1The optimal solution of (1) can be considered as the inferred haplotype frequencies. Before solving Equation (1), pre-processing could be carried out to simplify M and accelerate the decoding. Rows in M that consist of zeros, which result from the situation that less than four alleles exist for an SNP site, should be deleted. Furthermore, since any one row can be inferred from the other three rows easily for each SNP, i.e. the information is redundant, one row can be deleted for each SNP. In our method, rows with most '1' are deleted for each SNP.
DecodingUnder the assumption that few haplotypes actually possess the vast majority of proportion or haplotype database is large enough which indicates that x is a sparse vector where few elements are non-zero, Equation (1) could be solved by using techniques from CS theory. Once M and Y are given, CS aims to find the sparsest possible x. This can be written as the following optimization problem: x  =arg min kxk l0 s:t: Mx=Y 2Problem (2) is a non-deterministic polynomial complete problem. Under certain conditions, one can relax the constraint to l 1 norm and still get a solution that is identical to the solution of Problem (2) (). Hence, Problem (2) is reformulated as (3) which can be solved by convex optimization techniques efficiently. x  =arg min kxk l1 s:t: Mx=Y 3 Under the situation that measurements are corrupted by noise, CS aims to recover x by solving the optimization problem as follows:x  =arg min kxk l1 s:t: kMx  Yk l2 " 4 where "40 is set to be the maximal level of noise we are able to tolerate. Furthermore, elements in x denote haplotype frequencies that are constrained to be non-negative; hence, we employ NNREG algorithm to recover x, which achieves sparse recovery by means of a conventional non-negative least squares algorithm (). NNREG recovers x by solving the optimization Problem (5) for some large 40.NNREG allows for sparsity promotion and constrains x to be nonnegative at the same time (). In general, NNREG reports a vector x 2 R + 0 4L. For estimating haplotype frequencies, a post-processing procedure should be performed to normalize x* to make the sum equal to 1. The relative difference (R diff ) between true frequency and estimated frequency is used to evaluate the accuracy.
Overlapping pool sequencingBorrowing ideas from group testing theory, overlapping pool sequencing was presented for the cost-effective identification of rare variant carriers among large-scale samples. Since a large number of samples are mixed into pools followed by a single sample preparation for each pool, overlapping pool sequencing could drastically reduce the cost for sample preparation as well as the cost for screening rare variant carriers. The foundation for overlapping pool sequencing is the design for pooling samples. A design for n samples and t pools is associated with a t  n binary matrix P = {m ij }, in which the rows are indexed by pools, the columns are indexed by samples and m ij = 1 if and only if the jth sample is contained in the ith pool. For a simple instance, to find a variant carrier among seven individuals, samples could be pooled according to the pooling matrix below: P=This pooling design matrix consists of three pools: {4, 5, 6, 7}, {2, 3, 6, 7} and {1, 3, 5, 7}. Suppose the variant was found only in the second and third pools, then we can infer that the third sample is a variant carrier. To apply overlapping pool sequencing for the identification of rare haplotype carriers, pools containing rare haplotypes should be distinguished correctly from those that are not. Based on the estimation of haplotype frequencies from pooled sequencing data, a pool is suggested to contain rare haplotypes if the estimated frequency is higher than a threshold, which can be set as 0.5 divided by the pool size that denotes the lowest possible frequency of haplotypes in the mixture of diploid samples. Currently, many pooling designs have been proposed for identifying rare variant carriers. Benefiting from the Chinese remainder theorem,presented the DNA Sudoku design and a pattern consistency decoding algorithm to find the carriers. Thierry-Mieg (2006) put forward shifted transversal design (STD) and provided a freely available tool called interpool (Thierry-Mieg and) which can be utilized to choose candidate STD designs and identify variant carriers. The optimal design should be chosen depending on the cost of the whole experiment (). As long as the haplotype frequencies can be estimated precisely, indicating that pools containing rare haplotypes can be recognized correctly, it is feasible to apply overlapping pool sequencing in screening for rare haplotype carriers cost-effectively.
Haplotype database and sequencing dataTwo haplotype databases were used in our simulation experiment. The first one consists of 158 haplotypes of Drosophila from DGRP () and the second is made up of 50 haplotypes of Arabidopsis thaliana from 1001 Genomes Data Center (). To evaluate the performance of our method, both simulated sequencing data and publicly available Illumina sequencing data are used. The simulated sequencing data were generated by using a program called simreads which was used in Harp and provided by. Real Illumina sequencing data for A.thaliana were downloaded from the GenBank Short Read Archive with accession number SRP012869 (). Because of the limited computing resource, sequencing data of only five strains were downloaded for simulating pooled sequencing data in silico. Next, we conducted 100 replicates for simulation experiment with all parameters set as default values and computed the relative differences between true and estimated frequencies (). The results showed that our method could estimate the haplotype frequency with only about 3% average relative difference for pooled sequencing of the mixture of 10 haplotypes with total coverage of 50.
Effect of unknown haplotypesAlthough the haplotype database increases rapidly with the development of sequencing technology, the available database information may be incomplete to provide a good coverage of the haplotypes of the population. Haplotypes not contained in the database (defined as unknown haplotypes) could introduce variations between Mx and Y, as the columns in M are indexed by known haplotypes in the database but reads from unknown haplotypes are taken into the calculation of Y. Therefore, we next evaluate the influence of unknown haplotypes on the estimation of frequencies for known haplotypes. We suppose that 40 of the 158 haplotypes of Drosophila from DGRP are unknown and delete them from the database. For database consisting of 118 haplotypes, we first did simulation to find the optimal value when all the parameters were held as default values (Supplementary). The results showed that equaling 10 5 performed best. Next, we used all the 158 haplotypes to produce pooled sequencing reads to simulate a mixture of known and unknown haplotypes. Only these 118 known haplotypes were employed to infer the haplotype frequencies. Two hundred replicates were conducted to evaluate the impact of unknown haplotypes where 20 random selected haplotypes were mixed for each replicate, the estimated versus true frequency was drawn in. From the results, we can infer that our method is able to estimate the frequencies of known haplotypes and maintain excellent performance for haplotypes with actual frequencies higher than 0.05 when unknown haplotypes exist. The performance decreased rapidly as the proportion of unknown haplotypes increased which was inconsistent with expectation (), since the unknown haplotypes imported variations between Mx and Y. We counted the differences between Mx and Y when unknown haplotypes exist (Supplementaryand Supplementary). The results showed that the unknown haplotypes only introduced variations in very few rows. In theory, each unknown haplotype should import variations in one row (A/T/C/ G) for each SNP. However, after the simplification of M, the number of rows that could be affected by unknown haplotypes decreased a lot. Because rows with the most 1 are deleted for each SNP, meaning that the allele with the highest frequency for an SNP is deleted in M, the differences between Mx and Y in these rows that are caused by unknown haplotypes will have no impacts on the accuracy of estimation for the frequency of known haplotypes. Accordingly, our method could maintain good performance when unknown haplotypes exist.
Comparisons with current methodsPoolHap and Harp were presented to infer haplotype frequencies from pooled samples by next-generation sequencing. Both required that the haplotypes for the pooled samples are known. Unfortunately, the current version of PoolHap relies on a Java library which is no longer publicly available, and could not run correctly on our workstation. Therefore, we compared only the performance of Harp with that of our method in inferring haplotype frequencies from pooled sequencing data. We first compared the performance by using the 158 haplotypes of Drosophila and simulated sequencing data. The read length for simulating pooled sequencing data ranged from 50 to 150 bp and the error rate ranged from 0.01 to 0.05. The other parameters were all set as default values (coverage 50, region width 2 Mb, 10 haplotypes). The SNP density for the selected region (first 2 Mb on chromosome X) was about 1/50 SNP/bp. Both our method and Harp were applied to calculate the frequency of haplotypes. Since Harp required that the haplotype for pooled samples were known, we ran Harp twiceall the haplotypes in the database (Harp all) or haplotypes of only pooled samples (Harp pooled) are taken as possible haplotypes(e). The effects of various factors on the performance of our method. The algorithm performed better with lower read error rate (a) and higher sequencing coverage (b). Our method is not sensitive to read length (c), but more robust for longer region and less haplotypes (d and e). Ten replicates were conducted for each scenario and non-varying parameters were set as default values. Haplotype with true frequency lower than 0.02 is neglected in the statistics of R difffor estimating the frequency (; scatter plots for error rate 0.01 were shown in Supplementary). When all the haplotypes in the database were used to infer the frequency, our method had better performance than Harp for short reads and low error rate. Since only the proportions of four bases for each SNP were used to recover haplotype frequencies, our method was not sensitive to reads length. However, Harp was better for long reads as haplotype information contained in single reads was employed to estimate haplotype frequency and long reads covered multiple SNPs which were sufficient for the estimation (). Besides, Harp was more robust for high error rate due to the advantage that base qualities were taken into account in Harp, especially when haplotypes of exact pooled samples were known and taken as possible haplotypes for estimating the frequency, as Harp searched the optimal solution in a much smaller space. These results also indicated that which method performs better depends both on read error rate and read length with respect to SNP density. And our method may be more preferable for current massive parallel sequencing which has short reads and possesses error rate at the level of 0.01 (). We also compared the performance of our method with that of Harp by using SNPs located in other two regions (57 Mb and 1012 Mb) on chromosome X. The SNP density was about 1/27 (57 Mb) and 1/31 SNP/bp (1012 Mb), respectively. Both verified that our method has better performance for short reads with respect to SNP density and Harp is preferable for long reads (Supplementary). When unknown haplotypes exist, Harp filters out reads whose maximum haplotype likelihood falls outside a specified range to accurately estimate the frequency of known haplotypes (). Hence, we also compared the performance of our method with Harp when unknown haplotypes exist. Forty of 158 haplotypes of Drosophila from DGRP were still supposed to be unknown and all the 158 haplotypes were utilized to produce pooled sequencing reads to simulate a mixture of known and unknown haplotypes. After using 118 known haplotypes to infer the frequency, results also showed that our method is better for short reads and Harp is superior for long reads (Supplementary). When known haplotypes for only pooled samples were employed, Harp yielded results with the sum of the inferred frequencies for these known haplotypes equal to 1 which was inconsistent with reality since unknown haplotypes existed, and this situation resulted in high R diff .
Simulation with Illumina sequencing dataWe investigated the performance of our method and Harp on real Illumina sequencing data by using haplotypes for 50 strains of A.thaliana. Sequencing data for five strains were downloaded from GenBank Short Read Archive with accession number SRP012869 and mixed in silico to simulate pooled sequencing. Details about the haplotypes and sequencing data are contained in Supplementary Tables S3 and S4. Quality control was first done to obtain haplotypes with high qualities. First, SNPs with intermediate coverage were selected by filtering SNPs with coverage lower than 0.5 times or higher than 1.5 times the average sequencing depth (). Because these Arabidopsis strains are inbred lines, most of the SNPs are homozygous. Therefore, SNPs with major base proportion lower than 0.8 were also filtered. Finally, 131 110 SNPs on chromosome 1 passed the filter procedure and were used in the following analysis and the SNP density is about 1/232 SNP/bp. Haplotype frequencies for five strains were drawn from a symmetric Dirichlet distribution, followed by taking reads randomly from the data set and mixing in silico. The coverage for pooled sequencing was set as 25. Bowtie 0.12.9 () was used to map pooled reads back to A.thaliana genome. On the basis of the mapping results (SAM format), both our method and Harp were utilized to infer haplotype frequencies. Experiments based on simulated reads showed that the optimal is 10 3 for the database consisting of 50 haplotypes of A.thaliana (Supplementary). After estimating haplotype frequency for 100 replicates, the results showed that our method is superior to Harp for this scenario no matter whether all the 50 haplotypes or these 5 haplotypes for pooled strains were employed in Harp to compute the frequency (and Supplementary). This situation may partly result from the low SNP density with respect to. Comparison of our method with Harp based on simulated sequencing data and haplotypes for Drosophila. Black box denotes the scenario that Harp is applied and all the haplotypes in the database are used to infer frequency (Harp all). Green box denotes the scenario that haplotypes for only pooled samples are used (Harp pooled). Red box denotes the performance of our method. Haplotype with true frequency lower than 0.02 is neglected in the statistics of R diff reads length (76 bp). Besides, inconformity between the sequencing quality for real sequencing data and quality model used in Harp could also introduce errors. To find the key factor that is responsible for the performance of Harp on real Illumina sequencing reads, we investigated the performance on simulated sequencing data where the sequencing coverage and read error rate were set as 25 and 0.01, respectively (and Supplementaryf). Harp showed similar performance for real and simulated sequencing data when the read lengths for both were 76 bp, which revealed that the mismatch between the true errors and the Harp error model had little effects. Accordingly, we can infer that Harp error model is consistent with real sequencing data. However, the accuracy of Harp increased rapidly with the reads length which could prove that the short read length for real sequencing data should be responsible for the performance of Harp. These also verified that our method is more preferable for current massive parallel sequencing which has short reads. We also conducted two experiments by using haplotypes for chromosomes 2 and 3; the SNP density was about 1/215 and 1/210 SNP/bp, respectively. Both showed similar results to previous simulations (Supplementary). When only five haplotypes for the pooled samples were used in Harp, these results verified the underestimation for haplotypes with high frequency (40.2) and overestimation for haplotypes with low frequency (50.2). This situation may result from the low SNP density with respect to short reads where substantial reads containing no SNPs will be fractionally assigned to all the haplotypes, leading to more uniform distribution of haplotype frequency, i.e. underestimation for high frequency and overestimation for low frequency. This could also explain the performance of Harp when all the haplotypes in the database were used. Furthermore, there were lots of points for Harp where the true frequency was 0 but the estimated frequency was non-zero (Supplementary Figs S8 and S9). When haplotypes for chromosome 1 were used, the vast majority of these points represented the estimated frequency for haplotype Had-2. After counting the different alleles between each pair of haplotypes, we found that haplotypes Had-1 and Had-2 were very similar which had different alleles at only 264 SNPs on chromosome 1 (131 110 SNPs in total). This pair of nearly identical haplotypes could hardly be separated by Harp. However, this was not an issue in our method.
Overlapping pool sequencing to identify rare haplotype carriersOverlapping pool sequencing was presented for the cost-effective identification of rare variant carriers. Since numerous rare haplotypes have been identified to have strong correlations with several diseases (), screening large-scale samples to find rare haplotype carriers becomes increasingly important. On the basis that the frequencies of haplotypes could be estimated precisely from pooled sequencing data, overlapping pool sequencing can be applied to identify rare haplotype carriers. We conducted a simulation experiment to identify 2 heterozygous carriers for an assigned haplotype (Aedal-1) among 100 simulated diploid individuals (). Pool size was constrained to be smaller than 10 individual samples to make sure the lowest frequency for a haplotype is higher than 0.05 (0.5/10) to guarantee accurate estimation of frequency. STD and DNA Sudoku required 33 and 34 pools to find 2 specified haplotype carriers among 100 samples, respectively (pooling matrixes are detailed in Supplementary). Pooled sequencing was simulated in silico by taking reads randomly from data sets and mixing them where the coverage was set as 25. Equal amount of reads from two strains were mixed together to simulate heterozygous haplotype carriers. With the same procedure described previously to infer haplotype frequency for pooled sequencing of A.thaliana, the proportion of the rare haplotype was then extracted (and Supplementary). Based on the inferred frequencies of haplotypes, pools containing rare haplotypes can be recognized clearly, and the rare haplotype carriers could be identified precisely by using corresponding decoding algorithms for STD and DNA Sudoku designs. Next, we calculated the least pools required for identifying haplotype carriers with various frequencies successfully when applying group testing algorithms STD and DNA Sudoku to design overlapping pool sequencing (Supplementary). Pool size was also constrained to be smaller than 10 individual samples to guarantee accuracy in frequency estimation. Ignoring the cost for sequencing data production, overlapping pool sequencing showed great potentiality in reducing the cost for screening rare haplotype carriers.
DISCUSSIONTaking advantage of prior haplotype information contained in the database, we present Ehapp for inferring haplotype frequencies from pooled sequencing data. NNREG algorithm is employed to calculate the frequency, which achieves sparse recovery by means of a conventional non-negative least squares algorithm. And the optimal for NNREG could be obtained by conducting substantial simulations.(b) Comparison on simulated sequencing data with read length ranging from 76 to 800 bp. '76r' denotes the results for real Illumina sequencing reads with length 76 bp and '76s' denotes the results for simulated sequencing reads with length 76 bp. Outliners for box plots are not shown. Haplotype with true frequency lower than 0.02 is neglected in the statistics of R diffResults of experiments on simulated sequencing data showed that higher depth of coverage and lower error rate could improve the performance of our method. With 0.01 sequencing error rate, our method could estimate the frequencies of haplotypes with only about 3% average relative errors for pooled sequencing of the mixture of 10 haplotypes with total coverage of 50. Thanks to the simplification for M; our method could maintain excellent performance for haplotypes with actual frequencies higher than 0.05 when unknown haplotypes exist. Comparisons with Harp on simulated data in conjunction with real sequencing data showed that our method is more outstanding for short reads with respect to SNP density and preferable for current massive parallel sequencing. Analysis for Arabidopsis data also revealed that our method performed better in distinguishing similar haplotypes. Since only the proportions of A, T, C and G for each SNP are used to recover haplotype frequencies, our method is much faster and requires fewer memories compared with Harp which takes all the reads into calculation. At last, we proved that overlapping pool sequencing could be applied in screening for rare haplotype carriers as long as haplotype frequencies can be inferred accurately from pooled sequencing data. The number of samples used in HapMap allows the project to find 99% of haplotypes with frequencies of 5% or greater in a population (). However, haplotypes with low frequencies (55%) can also be observed for many populations (). Although substantial errors happened for estimating the frequency of haplotype with proportion lower than 0.05 when unknown haplotype exists, this drawback could be addressed by completing the database to include haplotypes as much as possible. Alternatively, the number of pooled individuals could be constrained to be smaller than a threshold to make the lowest haplotype frequency higher than 0.05; therefore, the frequency for known haplotype could still be inferred accurately even when unknown haplotypes exist. One major application of our method is in casecontrol studies for finding diseases associated with haplotypes. After estimating frequencies for case and control samples independently, haplotype with frequencies that differ statistically significantly could be ascertained as disease-associated haplotypes. If the diseaseassociated haplotype is rare, overlapping pool sequencing could be applied to identify the carriers among large-scale samples precisely with much lower cost. We hope that our methods could be applied in the GWHA and screening for rare haplotype carriers. Besides, our method could also be applicable in non-pool situations, such as inferring the frequency of variants of duplicated regions (e.g. transposable elements) (). The software implementing the method, Ehapp, is open source and available for download and can be easily integrated into existing analysis pipelines.Note: Two haplotypes are identical for homozygous individuals. Aedal-1 is assigned as the rare haplotype. The 40th and 60th samples are simulated as heterozygous carriers for haplotype Aedal-1.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
C.-C.Cao and X.Sun at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
RESULTS 3.1 Effect of various factors in sequencing We first evaluated the effect of various factors in sequencing on the performance of our method. In the simulation, we generated pooled sequencing data by using simreads which produced mapped reads (SAM format) along with sequencing qualities. The frequency for each haplotype was drawn from a symmetric Dirichlet distribution. The symmetric Dirichlet distribution is parameterized with a single parameter that governs the uniformity of the randomly drawn frequency distributions. Following the study conducted by Kessner et al. (2013), was set as 0.2 to produce haplotype frequency distributions similar to reality. One hundred and fifty-eight haplotypes of Drosophila were downloaded from DGRP. SNPs that were identical among all the haplotypes were filtered first. 747 660 SNPs on chromosome X passed the filter procedure and were used in the following analysis. The SNP density was about 1/30 SNP/bp. Since the choice of in NNREG is very critical for the accuracy of estimation (Foucart and Koslicki, 2014), we first evaluated the effect of on the performance of our method under different situations where non-varying parameters were held as default values (coverage 50  , read error rate 0.01, 10 haplotypes, read length 100 bp, region width 2 Mb). To guarantee the accuracy, each pair of haplotypes that have different alleles at less than 50 non-degenerate SNP sites (defined as those containing no degenerate bases) were not used to simulate pooled sequencing. Perl scripts were used to encode the haplotype database information and sequencing results, following by utilizing NNREG to calculate the frequency of each haplotype in the database. Later, relative differences (R diff ) between true frequency and estimated frequency were calculated for 10 replicates of each scenario. The results indicated that the optimal that resulted in lowest R diff was closely related to coverage, number of haplotypes, and region width (Supplementary Fig. S1). Substantial simulations should be conducted for choosing the optimal. Using the optimal value of for each scenario (Supplementary Table S1), we next evaluated the effect of sequencing coverage, read error rate, read length, sequencing region width and number of haplotypes on the performance of our method. Non-varying parameters were held as default values. The results showed that the performance of our method decreased with high sequencing error and low coverage, as both imported noises in the measurements of four base frequencies for each SNP (Fig. 2). And our method was not sensitive to read length, but became more robust for less haplotypes and longer sequencing region.
Estimation of haplotype frequency at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
