Spatial Kappa is a simulator of models written in a variant of the rule-based stochastic modelling language Kappa, with spatial extensions. Availability: The spatial kappa simulator is an open-source project licensed under the LGPLv3, with Java source, binaries and manual available at
COMPARTMENTS AND VOXELSCompartments can be specified as single voxels (unit volumes) or as regular lattices of voxels. Once defined, compartments and voxels within a compartment can be referenced by rules. Most commonly used compartment shapes are predefined in 2D and 3D with both solid and hollow (open) modes. Examples include rectangles, circles, cuboids, spheres, cylinders, as well as custom shapes, e.g. dendritic spines (, lines 78). The result is a lattice approximation of the specified shape ready for simulation. For open compartment types, thickness (, line 8) should also be specified to constrain the reaction volume.
CHANNELS AND PATHSVoxels within and across compartments can be linked to each other via channels. Channels describe both static links between agents in neighbouring voxels and movement of agents along predefined routes during active or diffusive transport (, lines 1112). A channel definition, thus, connects a set of source locations to a set of target locations. Multiple source voxels can be assigned to the same channel simultaneously if needed. For example, to represent the lateral movement of a transmembrane protein complex along the surface of a membrane, the channel would include coordinated displacement spanning two compartments: cytosol and membrane. Commonly used intra-compartment channel types are predefined. These include nearest neighbours in 2D lattices (both Cartesian and hexagonal), nearest neighbours in 3D and directed nearest neighbours for radial or lateral diffusion within a compartment. The predefined channel types can also be used for intercompartment movement, subject to them having compatible geometries, free of overlapping voxel and gaps (, line 12).
AGENT LOCATIONS, LINKS AND MOVEMENTSpecies definitions from the original Kappa syntax can be partly or completely located within a defined geometry, at the onset of the simulation. Depending on the requirements, species can also be constrained to a single voxel or allowed to diffuse freely. Agents can move along the defined channels. Translocation rules can be defined using species, locations or both. Diffusion of complexes that span several voxels is also supported. Agents in neighbouring voxels can be linked together via channels (line 15 'domainLink'). These spatial links can be created or broken dynamically like other Kappa links via transition rules. Species with cross-compartmental or cross-voxel links can diffuse along channels with multiple sources (, line 11). In addition, the rate of a rule may contain an agent description. This allows one, for instance, to modulate the rate of a diffusion rule as a function of the size of the species being diffused.
SIMULATORThe simulator underpinning SK was developed to provide the functionality described while maintaining compatibility with the reference Kappa simulator KaSim v3 (). Thanks to this, one can develop a space-less version of a model (which is natural when exploiting some form of proteomic data), and, in a second step, embed the model by building ad hoc geometries, channels and translocation rules. The SK simulator uses a variant of the next subvolume method (), modifying the standard Gillespie stochastic simulation algorithm () to handle both reaction and diffusion transitions (see Manual for more details). The application outputs simulation results using a file format similar to KaSim, and also provides a simple timeseries plot view updated during a running simulation. Running the simple model in(see also https://github.com/lptolik/ SPKappaR/wiki/SuplementaryImages) can take from 30'' to 10' depending on the model parameters.
CONCLUSIONWe have presented in this note SK, a language and simulator to embed rule-based models in space. Although equivalent features exist in other simulation tools, the complete feature set below is currently unique: Flexible compartment definitions support arbitrary dimensions and connectivity between compartments.  Use of channels to simplify model construction: defined once, they can be used repeatedly within rules which involve a spatial element.  Complex composition-based diffusion rates that can vary with size and composition of a complex to represent, e.g. complexes diffusing more slowly as they grow larger.  Multicompartment complexes allowing for large aggregates or transmembrane arrangements.  Diffusion of multicompartment complexes via special multisource channels. The tool for the 3D/4D visualization of SK models (see) is available at https://github.com/lptolik/ SPKappaR.The formal description of the SK language, examples and the grammar can be found in the user manual distributed with the source code.
ACKNOWLEDGMENTSWe acknowledge the valuable contribution of Demon Soft Ltd (Edinburgh) for their help with programming and drafting the user manual.. A snippet of an SK model of lateral diffusion of AMPA receptors on the postsynaptic membrane (A) Transmembrane receptors diffuse from the spine neck and bind scaffold proteins in the post-synaptic density, on the top of the cytosol compartment. Channels are used for crosscompartmental linkage (lines 12, 16) and multicompartmental diffusion (lines 11, 16). Snapshot taken after 2' of simulation (B)
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
O.Sorokina et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
