FermiKit is a variant calling pipeline for Illumina whole-genome germline data. It de novo assembles short reads and then maps the assembly against a reference genome to call SNPs, short insertions/deletions and structural variations. FermiKit takes about one day to assemble 30-fold human whole-genome data on a modern 16-core server with 85 GB RAM at the peak, and calls variants in half an hour to an accuracy comparable to the current practice. FermiKit assembly is a reduced representation of raw data while retaining most of the original information. Availability and implementation: https://github.com/lh3/fermikit Contact: hengli@broadinstitute.org
IntroductionDeep resequencing of a human sample typically results in a BAM file of 60100 GB in size. Storing, distributing and processing many such huge files is becoming a burden for sequencing facilities and research labs. While better compression helps to alleviate this issue, it adds processing time and can barely halve the size, which does not keep up with the rapidly increasing sequencing throughput. Illumina and GATK use gVCF () as a reduced representation of raw data. However, gVCF is reference dependent and it is nontrivial to encode both large and small variants consistently. We still need to go back to raw data for long events and when upgrading the reference genome. Another idea from the past practice is to assemble sequence reads into contigs that ideally retains all information in the raw data, but whether this approach is practical to Illumina human resequencing remains to be confirmed.
MethodsFermiKit uses BFC () for error correction, ropeBWT2 () for BWT construction, Fermi () for de novo assembly, BWA-MEM () for mapping and HTSBox (http://bit.ly/ HTSBox) for variant calling. The caller simply parses edits in the 'pileup' output for small variant calling from one or multiple BAMs, and extracts alignment break points for SV calling, though it may misclassify some SV events (). FermiKit sets thresholds on mapping quality and the number of supporting reads without using sophisticated statistical models. In comparison to our earlier work (), FermiKit is faster, more sensitive (due to better error correction) and more complete as a pipeline. FermiKit does not use paired-end information for the time being, but this does not have a great impact on its power empirically. With longer upcoming Illumina reads, it will be actually preferred to merge overlapping ends and treat them as single-end reads.
ResultsWe have run FermiKit on multiple whole-genome datasets of sample NA12878 along with GATK-HaplotypeCaller (HC in brief) and FreeBayes (). We used Genome-In-ABottle (GIAB;) as truth data to evaluate the accuracy (). Recent Illumina data have excessive systematic errors around poly-A which HC does not handle well. It called over 4000 false INDELs from sample S1 and S4 with the vast majority around poly-A. We excluded these regions to avoid one simple error source greatly affecting the metrics. After this treatment, variant callers are broadly comparable when the same set of hard filters are applied. VQSR as is advised in GATK Best Practice does not work well with single-sample calling. GIAB was generated from multiple NA12878 call sets. It is potentially biased against new callers and biased towards easier regions that can be called by the existing callers. For example, the GATK, which is overly good and is worrying. We turned to the CHM1-NA12878 dataset () for an unbiased evaluation (). In this evaluation, FermiKit produces calls of higher specificity at the cost of sensitivity. This is probably because FermiKit is less powerful in repetitive or duplicated regions or regions affected by systematic artefacts. Nonetheless, in wellbehaved regions that are outside 'uniMask', the loss of sensitivity is minor. The gain in precision is significant if we consider that there may be 520 k real heterozygous SNPs in CHM1 (), which should not be counted as FPs. FermiKit performs well in calling long deletions (). While it does not use read pairs, it achieves comparable sensitivity and higher specificity in comparison to the popular tools. FermiKit also called 480 insertions over 100 bp and identified multiple kb-long contigs having poor alignments to GRCh37 but nearly perfect alignment to a PacBio assembly of CHM1 (AC:GCA_001007805.1). We also mapped the CHM1 FermiKit unitigs to the PacBio assembly and called 71 long deletions, 11 insertions and 262 other events. As PacBio assemblies are generally of higher quality, these numbers give a rough estimate on the number potential false positives of Fermi on a haploid dataset.
ConclusionsA FermiKit assembly is about 3 GB compressed. After assembly, single-sample variants can be obtained in half an hour to high accuracy through mapping against a reference genome. Jointly calling 261 aligned whole-genome samples only took 40 CPU hours. FermiKit is a viable option for aggressive data compression, greatly reducing the efforts and expense on data storage, distribution and re-analyses at an acceptable cost of information loss.). For FreeBayes and HC, BWA-MEM was used for mapping against GRCh37 plus decoy (http://bit.ly/GRCh37d5) with duplicates marked by Samblaster (). Short variant calls were hard filtered with hapdip (http://bit.ly/HapDip). GATK-VQSR was also applied to HC calls. The filtered calls were compared to GIAB-v2.18 excluding poly-A regions longer than 6 bp plus 10 bp flanking. A true variant is counted as an FN if there are no called variants within 10 bp around the truth, and a called variant is counted as an FP if it falls in GIAB trusted regions and there are no true variants within 10 bp around the called variant.SNP/INDELs were called from the CHM1 (AC:SRR642636 through SRR642641; 100 bp) and NA12878-PG-BWA-MEM alignments used by Li (2014b). On the assumption that CHM1 is haploid, (heterozygous) FP equals the number of CHM1 heterozygotes and (heterozygous) TP equals the number of NA12878 heterozygotes minus the number of CHM1 heterozygotes. Two sets of filters were applied for filtering. 'Hard-polyA' is the same as the filter used in. 'UniMask' filters out genomic regions that tend to be repetitive, low-complexity or susceptible to copy number changes or systematic artefacts (http://bit.ly/unimask). This filter is sample independent.FermiKit was used to call 100 bp100 kb deletions from the PG-, S7-and S1 datasets. DELLY () and LUMPY PG-calls were acquired from http://bit.ly/bcbsval (B. Chapman, personal communication). For all call sets, overlapping events were merged and deletions longer than 100 kb were discarded. The two numbers in a cell at row R and column C give the false negative rate and false positive rate of call set R, assuming truth set C is correct and complete. In the table, truth set '1000g pilot' consists of 3142 deletions by
FermiKit
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
