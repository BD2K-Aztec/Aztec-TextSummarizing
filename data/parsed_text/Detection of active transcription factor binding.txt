Motivation: The identification of active transcriptional regulatory elements is crucial to understand regulatory networks driving cellular processes such as cell development and the onset of diseases. It has recently been shown that chromatin structure information, such as DNase I hypersensitivity (DHS) or histone modifications, significantly improves cell-specific predictions of transcription factor binding sites. However, no method has so far successfully combined both DHS and histone modification data to perform active binding site prediction. Results: We propose here a method based on hidden Markov models to integrate DHS and histone modifications occupancy for the detection of open chromatin regions and active binding sites. We have created a framework that includes treatment of genomic signals, model training and genome-wide application. In a comparative analysis, our method obtained a good trade-off between sensitivity versus specificity and superior area under the curve statistics than competing methods. Moreover, our technique does not require further training or sequence information to generate binding location predictions. Therefore, the method can be easily applied on new cell types and allow flexible downstream analysis such as de novo motif finding.
INTRODUCTIONTranscriptional regulation orchestrates the proper temporal and spatial expression of genes (). The identification of transcriptional regulatory elements, such as transcription factor binding sites (TFBSs), is crucial to understand regulatory networks driving cellular processes such as cell development and the onset of diseases. The standard approach is the use of sequence-based bioinformatics methods, which search over the genome for motif-predicted binding sites (MPBSs) representing the DNA binding sequence of a transcription factor (TF;). This binding affinity is usually represented by models such as position weight matrices (PWMs). However, motifs are generally short and have low information content. Moreover, the presence of a sequence motif does not imply actual TF binding in that particular cell type. As a result, sequence-based methods return myriads of putative TFBSs, of which only a small fraction is functional in a particular context (). Chromatin immunoprecipitation followed by sequencing (ChIP-seq) allows the detection of TFBSs in vivo on a genomewide level (). However, success of ChIP-seq assays depends on the existence of a good antibody against the TFs of interest and on the availability of large numbers of cells. These two conditions are not always met in particular for primary cells. Therefore, ChIP-seq-based studies are restricted to the analysis of a small selection of TFs and cell types () or require the effort of large consortia (ENCODE Project). Another solution is to explore the fact that an 'open' chromatin structure is crucial and a prerequisite to the cell type-specific binding of a TF to DNA (). For example, regions with histone modification marks H3K4me3 and H3K4me1 highlight active promoter and enhancer elements (). More detailed studies have demonstrated that active TFBSs occur between two regions with high active histone marks (peak-dip-peak pattern;). A classical method to detect active regulatory elements, DNase I footprinting, has also been recently combined with sequencing to indicate open chromatin regions on a genome-wide scale (). DNase-seq allows the identification of putative active TFBSs at base pair level resolution, i.e. 520 bp regions within two DNase-seq peaks represent the so-called footprints, where TFs are likely to be bound. While DNase-seq returns the exact position where DNA was nicked by DNase I enzyme, ChIP-seq returns sequences centered on the protein *To whom correspondence should be addressed  The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com interacting with DNA. Therefore, DNase-seq gives a more precise estimate of open chromatin than histone modification ChIP-seq, as reflected in the sharpness of the signal of DNaseseq in comparison with H3K4me3 ChIP-seq signal (see). A recent evaluation of DNase-seq on 450 cell types indicated that DNase I digestion patterns describe the topology of protein DNA binding interfaces and allowed the finding of 394 novel motifs (). Several computational approaches explore open chromatin evidence from ChIP-seq data or DNase I hypersensitivity (DHS) sites to restrict the search space of sequence-based analysis (). They show a clear advantage in detecting active TFBSs, as indicated by ChIP-seq evidence, in comparison with pure sequence-based methods.
Previous approachesPrevious approaches can be categorized in two distinct classes: segmentation-based methods and site-centric methods. Segmentation-based methods such as, were based on the application of hidden Markov models (HMMs) or sliding window methods to segment the genome into open (and closed) chromatin region., for example, was based on the detection of typical peak-dip-peak profiles of H3K4me3 and H3K4me1 histone modifications indicative of active promoter and enhancer regions. Afterwards,proposed an HMM model to detect open chromatin/footprints in DHS signals on a base pair resolution. Lastly,applies a simple sliding window approach that finds small regions (640 bp) with low DHS counts in the middle of regions (310 bp) with high DHS counts. Site-centric methods, on the other hand, perform predictions around MPBSs. For example, Piquefirst detects MPBSs then it applies an unsupervised learning method that uses chromatin information to group sites as active or inactive. This Bayesian method combines DHS profiles and histone modification summary statistics around the TFBSs with priors derived from motif matching bit-score, sequence conservation and distance to the nearest transcription start site. Later,improved the methodology proposed into include the combination of DHS and distinct histone modification as priors in the detection of active MPBSs. They showed that DHS improves TFBS detection considerably. Nevertheless, no significant improvement was observed when DHS was combined with histone modifications. Interestingly, Piquealso could not observe advantages in using histone modifications. Note, however, that both Piqueuse simple window-based statistics for histone modification, which are unable to detect peak-dippeak shapes as in).
Our approachWe propose here an HMM-based approach to integrate both DHS (DNase-seq) and histone modifications (ChIP-seq) for the detection of open chromatin regions and active TFBSs. We and others have previously observed that the peak-dip-peak patterns of the DHS profile happen inside the dip of the histone modification profiles (; see). This indicates an underlying epigenetic grammar behind active TFBSs: open chromatin regions (high DHS) are flanked by high or moderate signals of active histone marks. These open chromatin regions consist of a sequence of one or more footprints indicative of active TFBSs (low histone modification and DHS signals). We have therefore devised an HMM () to model this epigenetic grammar by simultaneous analysis of DNase-seq and the ChIP-seq profiles of the histone marks H3K4me1, H3K4me3, H3K9ac, H3K27ac and H2A.Z, which are indicative of active regulatory regions, on a genomewide level. The HMM has as input a normalized and a slopecell type. The DNase-seq signal indicates three clear regions of DHS (HS1, HS2 and HS3), each of which fits dip regions within the H3K4me3 signal. Moreover, these regions consist of several putative footprints of varied sizes. (B) Eight state HMM proposed. The first state models background signal (BACK). From the background state, the only possible transition is to the histone-level states, which will model the increase (UP), high levels (TOP) and decrease (DOWN) of histone modifications. After visiting histone-level states, the HMM allows transitions to the DNase-level states, which again model the increase, high levels and decrease in the DHS signal. Only then, the FOOTPRINT state can be visited. After a footprint visit, the HMM has to go again to the DNase and histone-level states, emphasizing the peak-dip-peak pattern. We omit the self-transitions, which are present in all states, for simplicity signal of DHS and one histone mark. It can therefore detect the increase, top and decrease regions of both histone mark and DHS signals. The HMM has multivariate Gaussian density functions with full covariance matrices as emission functions to capture correlations between the DHS and histone marks signals. As in, we trained the HMM on the annotation of a single genomic region. Moreover, we devised a normalization procedure of the DHS/histone mark profiles to allow the application of an HMM trained in a particular cell type to be applied on any cell type of interest. This is the first approach combining local genomic profiles of histone modification and DHS for the detection of open chromatin and active TFBSs. We evaluate our and competing methods with public data from H1-hESC and K562 cell types. To validate our predictions, we created datasets by combining MPBSs with ChIP-seq from 83 TFs.
METHOD
Epigenetic signal processingLet the matrix X representing genomic signals be defined asThe first processing step consists on creating a base-pair resolution genomic coverage signal by counting the reads mapped to the genome. For DHS data, we consider only the first 5 0 position of the aligned reads (corresponding to the exact position at which DNase I enzyme has nicked the DNA). For histone modification ChIP-seq data, we extend all the aligned reads to be 200 bp long, as this is the expected length of immunoprecipitated fragments. Then, in both cases, the resulting genomic signal is created by counting how many reads overlapped at each genomic position. The signals are then normalized using an approach that addresses both within-and between-dataset variability. For that, the genome is partitioned into a set fb 1 ; :::; b M g of non-overlapping bins and a set fr 1 ; :::; r M g of overlapping bins. Each bin b m covers the genomic coordinate interval m  1  L+1; m  L, and r m represents b m extended by L/2 for both sides. By using L = 5000, we partition the genome in regions with total length 10 000. First, we apply a within-signal normalization by averaging non-zero read counts inside bins (). For a given position x ij , such that j 2 b m , we applywhere 1 denotes the indicator function. Next, we perform a betweendataset scaling procedure following () to force values inside the interval. Assuming j 2 b m , this is done by applying a logistic function to the first normalized values as follows:P t rm are, respectively, the SD, mean and the tth percentile of valuesTo estimate the slope of the signals, we apply a SavitzkyGolay smoothing filter. This method consists of fitting the data into a second order polynomial, performing a convolution (based on a specific window length) with a vector containing SavitzkyGolay coefficients (). The window length was set to 9 bp (including the central element) for DHS data () and 201 bp for histone modification ChIP-seq data, matching the read extension length. Next, the first derivative is applied to the smoothed signal. The resulting signal represents the slope of the normalized curve and assumes positive values when there is an increase and negative values when there is a decrease. The slope signal will help the delineation of the start and end of DHS and histone modification peaks (see Supplementaryfor examples of these signals).
Prediction of footprints with HMMsThe HMM structure was designed to recognize the epigenetic grammar described in Section 1.2. This segmentation task is performed based on four input signals: the normalized and slope versions of both DHS and a histone modification. The structure, depicted incan be interpreted as follows. The first state (BACK) corresponds to the 'background' regions with low concentration of DHS and histone marks. The histone level states represent a peak in the histone modification signal, recognizing an increase in the histone modification signal based on high positive slope values (UP), summit regions with slope values close to zero with high normalized values (TOP) and a decrease based on negative values of the slope signal (DOWN). From the histone level DOWN state, the model can either return to BACK (isolated histone modification peaks without further DHS) or continue to the DNase level UP state. The DNase level states are equivalent to the histone level states, with the exception that the DHS normalized and slope signals are being recognized instead. From the DNase level DOWN state, the model decides between returning to a region of higher histone modification signals (histone level UP state) and visiting the FOOTPRINT state, which represents the dip between two peaks of intense DHS. The regions of the genome where the HMM has recognized as FOOTPRINT are the ones reported by our method as likely TFBSs. See Supplementary Section 3.3 for alternative HMM topologies. More formally, for an observed multivariate sequence X and a hidden variable Q=fq 1 ; :::; q N g, we can describe an HMM by parameters =fA; B; g. A represents the state transition matrix
A=fa uv g SSwhere S is the number of states and a uv represents the probability of transition from state u to v. The initial state transition probabilities are represented asWe use a multivariate normal density function with full covariance matrix as emission probability of the states. For a given genomic position j and state u we havewhere u and S u are respectively the D-dimensional mean vector and full covariance matrix. Lastly, the emission parameters B are defined as f 1 ; S 1 ; :::;  S ; S S g.
Model training and decodingThe HMM is trained with maximum likelihood parameters on a supervised approach. For a given annotation sequence of the hidden data Q and sample data X, the parameters are estimated as; q i+1 =v represents the number of transitions from state u to state v observed in the training data. As we expect the HMM to always start at the BACK state, the initial transition vector 1 =1 and u =0 for u41. Finally, the emission parameters are estimated asThe final goal of our model is to find the most probable states visited for a given genomic signal. More formally, we want to find the most probable sequence of hidden states Q having observed X given a model , which can be written asThe solution to the above problem is given by the Viterbi algorithm (). In practical terms, we consider positions annotated with the FOOTPRINT state to be potential active TFBSs.
EXPERIMENTAL DESIGN
DatasetsBoth DNase-seq and ChIP-seq for TFs and histone modifications data were obtained in ENCODE repository (ENCODE Project). We used read alignments available for the embryonic stem cell (H1-hESC) and myelogenous leukemia (K562). DNase-seq and ChIP-seq for H3K4me1, H3K4me3, H3K9ac, H3K27ac and H2A.Z were downloaded for every cell type to generate the input for the HMMs (see Supplementaryfor details on input data). To create the evaluation dataset, we obtained all ChIP-seq enriched regions for TFs of these two cell types in ENCODE Analysis Working Group (AWG) data track. Also, we used PWMs from Jaspar (), Transfac () and Uniproble () repositories (see Supplementary Tables S23S25 for details on evaluation data). All experimental files and alignments are based on the human genome build 37 (hg19). Chromosome Y has been removed from all analyses.
HMM training and evaluationTo reduce the dimensionality of the data, we first applied a peak calling tool to find regions with evidence of DHS and histone modification signals. The enriched regions of histone modifications ChIP-seq data were defined using the peak-calling tool MACS (). We used a P-value of 10 5 and all default parameters from MACS 1.4. No further filtering, such as false discovery rate, was performed on the peaks, as we wanted a lenient selection of candidate regions. The enriched regions of the DHS data were defined as in. Briefly, a signal corresponding to the estimated density of the DHS is generated by applying F-seq software () to the DNase-seq mapped reads and background information based on alignability, copy number and karyotype correction. A threshold is then calculated by fitting the signal to a gamma distribution and considering the value that corresponds to a loose P-value of 0.01. We merge all enriched regions for a given cell type and extend them by 5000 bp in each direction. This step keeps only 36% of the genome with DHS or histone modification evidence for a given cell type (see Supplementary Table S5 for complete statistics). We selected a 10 000 bp region around the promoter of the gene RCOR3 and performed a cell type-specific manual annotation with one of the 8 HMM states according to the epigenetic grammar described in. As one of the histones marks H3K4me1is known to be associated to distal enhancers, we have additionally annotated an enhancer region. The selection of these regions was made randomly, but we checked ENCODE tracks for evidence that the gene RCOR3 was expressed in all cell types analyzed and that the enhancer region was far (4100 kb) from known genes and expressed regions. To help the annotation of the footprints, MPBSs with all PWMs from Jaspar, Transfac and Uniprobe datasets were detected inside the training regions. We consider (active) footprints all the signal depleted regions between two DHS peaks that overlap a MPBS. We trained five HMMs per cell type, one for each histone modification (H3K4me3, H3K9ac, H3K29ac and H2A.Z with the promoter region and H3K4me1 with the enhancer region). The regions used for training were excluded from all further predictions. We used the Viterbi algorithm to find the footprint regions throughout the genome for each trained HMM. Note that the evaluation of the HMM on the genomic signals was performed regardless of any evidence that the regions are distal/proximal to a gene. See Supplementary Section 3.1 for details on training and Supplementary Tables S2S4 for the set of parameters for the HMM trained using DHS+H3K4me3 on H1-hESC data.
Evaluation3.3.1 Binding evidence ChIP-seq experiments for the TFs being tested were used as experimental evidence of binding. These are simply the enriched regions (or peaks) based on the uniform processing of ENCODE AWG data track. Next, we used the de novo motif analysis from Factorbook () to select the PWMs associated with the TF ChIP-seq data. We considered only the TFs in which the top enriched motif was present in at least 300 of the 500 top-scored ChIP-seq peaks. We used PWMs from the Jaspar database matching those in Factorbook. Four PWMs (ATF1, BACH1, NR2F2 and SP4) not present in Jaspar were obtained from Transfac and Uniprobre. These PWMs were matched against the complete human genome using the motif matching tool available in Biopython (). Initially, a regularizing value of 0.05 was added for all nucleotides at all positions of the PWMs. We used a false-positive rate (FPR; 10 4 ) approach based on dynamic programming () to detect significant MPBSs. In this scenario, a different threshold is calculated for each PWM by defining the bit-score that corresponds to a specific FPR in the distribution of scores of that TF's PWM. Note that Piqueused a fixed bit-score cutoff of log 2 10000=13:288 for all PWMs. However, we observed that this criterion is strict, in the sense that only a few MPBSs coincide with regions enriched with experimental ChIP-seq data (see Supplementary Section 2.2 for discussion). Finally, we filtered out all TFs in which 510% of ChIP-seq peaks contained at least one MPBS associated. This resulted in a set of 56 TFs from K562 and 27 TFs for H1-hESC cell types (see Supplementary Tables S23S25 for the final selection of PWMs and TFs).
Gold standard and evaluation metricsTo evaluate all methods, a site-centric gold standard was proposed (). In this evaluation scheme, MPBSs with ChIP-seq evidence (i.e. lying within 100 bp from the peak summit) are considered 'true' TFBSs and all other MPBSs are considered 'false' TFBSs. Then, every footprint prediction that overlaps by at least 1 bp with a true TFBS is considered a correct prediction (true positiveTP), and every footprint that overlaps with a false TFBS is considered an incorrect prediction (false positiveFP). Consequently, true negatives (TN) and false negatives (FN) are, respectively, false and true TFBSs without overlapping footprint predictions. With such contingency table, we are able to calculate the sensitivity and specificity of each method. In Supplementary Tables S17S19, we show statistics on the number of MPBSs, ChIP-seq peaks and combinations of both. To access the sensitivity TP=TP+FN versus specificity TN= TN+FP trade-off, we created receiver operating characteristic (ROC-like) curves [with true-negative rate (specificity) on x-axis, instead of the traditional false-positive rate] and estimated the area under the ROC-like curves (AUCs) as follows. For each method, the MPBSs from the gold standard were divided into two groups: the ones that contain at least 1 bp overlap with the predicted sites and the ones that do not overlap. Both groups were sorted based on the motif matching bit-score. A single list is then obtained by combining the ranked list of predicted sites before the ranked list of the non-predicted sites. A ROC-like curve was evaluated based on this list, for all cell types and TFs.
Competing methodsWe compared our method with Boyle method (), Centipede (), Cuellar-Partida method () and Neph method () using the evaluation methodology defined previously. Boyle and Neph methods analyses were based on results/parameterization available in the original studies. As Cuellar-Partida used a distinct statistical framework for PWM detection, we performed experiments to select the cutoff criteria. Centipede presented poor results with default parameters. We have therefore performed a grid search strategy to detect the best parameterization in one cell type and applied to the other cell type. This leads to results close to an optimistic parameterization, where parameter tuning was performed for each TF and cell type combination. Note that this optimistic parameterization is possible only with ChIP-seq for every TF tested. Moreover, the estimated parameters from both cell types were similar (level of shrinkage of negative binomial's parameters was estimated as 0.0 for H1-hESC and 0.25 for K562 and level of shrinkage of multinomial's parameters was estimated as 0.75 for both cell types) and represent a better choice of default parameters than the ones provided by the tool. See Supplementary Section 4 for further details on parameterization experiments for the competing methods. As we could not succeed in running the HMM-based histone segmentation approach from, we adapted our approach to use only histone modification signals. For such, the DNase level states were replaced by a single FOOTPRINT state. All the steps described in Section 3.2 were performed again using new manually annotated regions based on the new HMM state configuration. This method will be referenced as Histone HMMs (H-HMM). All parameter tuning experiments were performed on chromosome 1 and these regions were excluded from the method comparison analysis. All annotations, predictions and evaluation data are available in our Web Supplementary Files for future benchmarking purposes.
HMM parameter selectionWe have performed a set of experiments to evaluate/justify methodological choices for our approach. For this, we used the genomic signals of chromosome 1, which was left out of any further analysis. First, we evaluated choices of scaling parameters: use of global or local statistics in Equation (2) and value of the percentile (96, 98 and 99%). Results indicate the advantage of local normalization and that 98% was a good trade-off between sensitivity and specificity. We have also compared the use of the Viterbi algorithm and posterior decoding to detect the footprints. Experimental results indicate a slight advantage of the Viterbi algorithm, while the posterior decoding had numerical problems, in particular genomic regions. We have also evaluated two distinct HMM topologies. The first alternative merges UP TOPDOWN states in one to obtain a simple HMM. This HMM has poor performance, as it does not take advantage of the slope of the DHS/histone modification signals. We have also extended the original HMM topology by including transitions from the background states directly to the DNase-level states. This modification allows the detection of DHS peaks between asymmetric histone modification signals, which were evidenced in. The HMM had smaller AUC values than the HMM model proposed here and was, therefore, not explored. See Supplementary Section 3 for further discussion regarding all empirical analyses on HMM parameter selection. All HMMs were implemented using Scikit (). All experiments were executed in 4 Xeon E7-4870 CPUs with 10 2.4GHz cores each.
RESULTS
Selection of histone modificationsGiven the predictions made by our method (referenced from this point as DH-HMM  DHS + histone HMMs) in which different histone modifications are used as input, it is possible to create combined footprints. Briefly, we take the union of all predictions from any number of models and merge all overlapping footprints. Then, an initial question would be the selection of the optimal set of histone marks to be combined. We are particularly interested in using as few marks as possible to minimize the necessity of high-throughput experiments. For such, we have evaluated the AUC values of all combinations (up to three) of the five histone marks on chromosome 1. Results indicate that combinations with more histone marks are better than single-histone models (see Supplementaryand Supplementary). Several combinations of three marks (H3K4me1 + H3K4me3 + H3K9ac, H3K4me1 + H3K4me3 + H3K27ac, H2A.Z + H3K4me1 + H3K4me3, H2A.Z + H3K4me3 + H3K9ac and H3K4me3 + H3K9ac + H3K27ac) were similarly good, i.e. their AUC are not significantly lower than any other combination). Similarly, if we consider only individual and pairs of histone marks, H3K4me1 + H3K4me3, H3K4me3 + H3K9ac, H3K4me3 + H3K27ac, H2A.Z + H3K4 me3 and H3K4me1 + H3K9ac have similar AUCs. This indicates that any combination of these histone marks, whenever available, would perform equally well. We have selected the combinations H3K4me1 + H3K4me3 + H3K9ac and H3K4me1 + H3K4me3, which we call DH-HMM(3) and DH-HMM(2), respectively, for further analysis. We also used the same histone modification selection for all competing methods that use histone modification evidence. Moreover, we have performed this analysis for H1-hESC and K562 cell types in separate. Despite small differences in rankings, a similar set of combinations resulted as equally good and both H3K4me1 + H3K4me3 + H3K9ac and H3K4me1 + H3K4me3 were among the top two combinations in either cell. See Supplementary Section 3.5 for further discussions.
Cell type specific versus non-cell type specific trainingNext, we have analyzed if the DH-HMM models are specific for the cell types they are trained on. In this particular test, we have extended our datasets to include two new cell types (HeLa-S3 and HepG2) with 20 and 21 TFs, respectively (more details on Supplementary Tables S20S21 and S26S27). We have compared the AUC values of the H3K4me1 + H3K4me3 DHHMM when it was trained in a particular cell type and executed in the same cell type versus the other three cell types. A statistical test (paired MannWhitneyWilcoxon with null hypothesis that the distributions are equal) was performed and showed that only in 1 of 12 comparisons the cell type-specific training had significantly superior AUC than a non-specific training (see Supplementary Section 3.6). This indicates that the DH-HMM models can be applied to any other cell type data with an insignificant loss of performance.
Method comparisonWe show inthe ROC-like curves for TFs GABPA, C-jun, SIX5 and YY1 and cell types H1-hESC and K562. All methods analyzed provided a list of active TFBSs given a particular parameterization (see Supplementary Section 4 for details). An exception is Centipede, in which we used the model's posterior probability to rank sites and the suggested probability (0.99) to select active TFBSs as performed in Pique. The curves were obtained by ranking the active TFBSs predictions in regard to the PWM bit-score. To obtain complete curves, we also included in the end of the ranking the inactive TFBSs (sorted by PWM bit-scores). Squares, circles and triangles in the curve indicate the location of the rank with TFBSspredicted to be active only. These points were used to obtain the sensitivity and specificity of a method. We tested the ranks of the methods for all 83 combinations of cell types and TFs regarding AUC, sensitivity and specificity. We used the FriedmannNemenyi test to evaluate the statistical significance of the method's ranks. As indicated inand Supplementary Table S1, HMMs based on histone modification only (H-HMM) had significantly lower values for all indices. This can be explained by the fact that the histone modification signal, measured by ChIP-seq, contains a much lower resolution than, for instance, the signal obtained with DNase-seq, which is used by all other competing methods. Boyle and Neph methods have significantly higher specificity values than competing methods (). We observed that, in general, Boyle makes few predictions, resulting in few false positives, but missing many of the true active TFBSs. For example, from the 3020 observed active GABPA binding sites in H1-hESC, only 2066 (68.41%) and 2207 (73.08%) were detected by Boyle and Neph, respectively; while Centipede and the DH-HMM(3) predicted 2765 (91.56%) and 2892 (95.76%), respectively. Indeed, Boyle and Neph methods' sensitivity is significantly lower than all other DHS-based methods. The Cuellar method with either two or three histone modifications presented the highest sensitivity values, which were statistically higher than all methods but Centipede and DH-HMM(3) (). On the other hand, Cuellar had poor specificity values being significantly lower values than all DHS-based methods. Because the number of false TFBSs is high, Cuellar usually predicts a great number of false positives. For instance, Cuellar(3) predicts 5.63% (10 051 sites) more false positives than DHHMM(3) on GABPA binding in H1-hESC. DH-HMM(2) and DH-HMM(3) significantly outperformed all other methods concerning AUC values () and were significantly better ranked than all other methods in Friedman ranking (Supplementary).
Spatial specificity and DHS coverage of segmentation approachesNext, we evaluated the spatial specificity (), i.e. the distance of all predicted regions to the center of their recognized active TFBSs. Note that this comparison is only made on segmentation-based methods (Boyle, Neph and HMM-based methods), as site-centric methods always have an 'ideal' spatial specificity because they use sequence information. Theshows the resulting distribution of distances for all evaluated TFs. Overall, DH-HMMs had better spatial specificity (lowest distance of footprints to the center of active TFBSs) than all other methods (MannWhitneyWilcoxon of equal distance distributions was rejected with P 10 5 ). On the other hand, the H-HMMs presented large distances than all other methods (P 10 5 ). This is again explained by the lower resolution of the ChIP-seq to indicate chromatin structure in comparison with the DHS signal. These results indicate that DH-HMMs improve Boyle and Neph methods on the detection of the exact location of TFBSs. Lastly, we evaluated footprints statistics inside DHS sites. Footprints from DH-HMM cover
DISCUSSIONMethods for detection of active TFBSs can be categorized in two main classes: site-centric (Cuellar and Centipede) and segmentation-based (Boyle, Neph and HMMs). Site-centric approaches require the identification of all MPBSs of a given TF to classify them as active or inactive. One advantage of the latter methods is that they have an ideal spatial specificity. On the other hand, they require sequence binding affinity information (PWM) of the TFs to be known a priori. On the other hand, segmentationbased approaches can be used for de novo motif detection. Previous studies have shown that footprints allowed the automatic creation of high-sensitivity TF models () and the discovery of hundreds of novel motifs (). Such studies would benefit from segmentation-based methods with good spatial specificity. Moreover, segmentationbased methods tend to reduce computational complexity, as they decrease drastically (12%) the genomic space used for motif detection. However, it is important to mention that the interpretation of such reduced genomic space would still require knowledge of proteins' binding sequence affinity. While Centipede obtained good AUC results, the method's performance was too dependent on regularization parameters. Moreover, for large input files (TFs with a large number of PWM hits) the method required up to 6 days/core of computing and 65 GB of memory on a single TF and cellular condition. The most computational expensive segmentation method, DHHMM, requires 9 days/core for predicting footprints and active binding sites over all 500 TFs from JASPAR in one cell type. Another important aspect is the proposed combined use of DHS and histone modifications shapes around the TFBSs. Cuellar method is based on obtaining read counts around the TFBSs. Clearly, such method cannot take the local shape profiles into account. For example, it cannot distinguish the DHS peaks with the footprint signals and would detect any TFBS inside a region with high DHS levels as the regions indicated in. Our experimental results confirm the poor specificity of the method. While Centipede used the local profiles of the DHS signal, it used simple read count statistics for the histone modification signals. Therefore, it is unable to detect the valley shapes indicated in. Not surprisingly, no improvements were possible with the use of histone modifications using Centipede, as indicated in Pique. The DHHMM model could show improved results by using the local profiles of DHS and histone modification signals. Moreover, DH-HMM footprints cover a higher percentage of DHS regions than other segmentation-based methods. Recent studies have also indicated that the histone modification profiles centered on DHS sites can be clustered and these clusters can also have asymmetric shapes, where there is lower evidence of histone marks downstream or upstream of the DHS. We have also tested variants of the DH-HMM to capture such asymmetric signals, but no significant improvement was obtained. As show in Supplementary, the slope signals have high values changes even on low histone modification values and are responsible for the correct characterization of such asymmetric peaks. Lastly, the HMMs displayed robustness in the training/evaluation on distinct cell types. This indicates that no further training of the HMMs and time intensive manual annotation of genomic regions are required. This is achieved by addressing both within-and between-dataset variability with our normalization pipeline.
FINAL REMARKSThis article presents a novel approach to combine the spatial profiles of DHS (DNase-seq) and histone modifications (ChIPseq) to predict cell type-specific active TFBSs. Moreover, we perform a large evaluation of all competing methods over two cell types and a large validation with 83 TF ChIP-seq datasets. We could show that the HMM model combining both DHS and histone modification data presents a good trade-off between sensitivity and specificity in relation to all compared methods. Furthermore, the method was robust when trained and evaluated in distinct cell types and has no further parameterization requirements. This study also provides all footprint predictions and validation data forming the first benchmarking dataset for footprinting analyses. The accumulation of further epigenetic data and more detailed biological experiments will pose new methodological challenges to the field. The analysis of a cell type after a differentiation steps or response stimuli would indicate detailed changes in transcriptional landscape.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
E.G.Gusmao et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Detection of active transcription factor binding sites at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
