Motivation: Compared with complementary DNA (cDNA) or messenger RNA (mRNA) microarray data, microRNA (miRNA) microarray data are harder to normalize due to the facts that the total number of miRNAs is small, and that the majority of miRNAs usually have low expression levels. In bead-based microarrays, the hybridization is completed in several pools. As a result, the number of miRNAs tested in each pool is even smaller, which poses extra difficulty to intrasample normalization and ultimately affects the quality of the final profiles assembled from various pools. In this article, we consider a measurement error model-based method for bead-based microarray intrasample normalization. Results: In this study, results from quantitative real-time PCR (qRT-PCR) assays are used as 'gold standards' for validation. The performance of the proposed measurement error model-based method is evaluated via a simulation study and real bead-based miRNA expression data. Simulation results show that the new method performs well to assemble complete profiles from subprofiles from various pools. Compared with two intrasample normalization methods recommended by the manufacturer, the proposed approach produces more robust final complete profiles and results in better agreement with the qRT-PCR results in identifying differentially expressed miRNAs, and hence improves the reproducibility between the two microarray platforms. Meaningful results are obtained by the proposed intrasample normalization method, together with quantile normalization as a subsequent complemental intersample normalization method. Availability: Datasets and R package are available at
INTRODUCTIONMiRNAs are short, non-coding RNA molecules that modulate gene expression by base pairing with the 3 untranslated region of their target mRNAs. It has been shown that miRNAs regulate about 30% of all transcripts in mammalian genomes. Each miRNA can regulate the expression level of hundreds of different mRNAs (). As regulators of gene expression, potential therapeutic targets * To whom correspondence should be addressed. and biomarkers, miRNAs were extensively studied in the past few years. As the number of annotated miRNAs continues to increase, several large-scale miRNA expression profiling microarrays have been developed, including quantitative PCR and sequencing. As an alternative arraying strategy to planar substrates that are widely used in microarrays, bead-based microarrays (beads arrays hereafter) have been developed either by impregnating beads with different concentrations of fluorescent dye or by some type of barcoding technology. The beads are addressable and used to identify specific binding events that occur on their surface. Bead-based arrays allow for the inclusion of many combinations of miRNA capture beads into a single pool, and provide greater flexibility over time as miRNAs are discovered and corresponding beads are created. In addition, beads arrays are expected to have increased specificity over the traditional glass-based microarrays (). Normalization is a crucial process of removing systematic bias as a result of the experimental artifacts from the data. Many existing normalization methods assume that the majority genes are not differentially expressed in the control and treated samples. Such an assumption might not hold true for miRNA arrays due to the facts that the total number of miRNAs is small (less than 1000), and the current miRNA microarray platforms possibly do not include enough miRNAs that are stably expressed (). As a result, methods such as normalizing by mean or median might not work well for miRNA microarray data analyses. In addition, because of the capacity limit of the pools in beads arrays, the miRNAs are divided into small subsets and the tests are finished in various pools separately. The subprofiles of the miRNAs from different pools need to be normalized to assemble a complete profile. Such a normalization procedure is called intrasample normalization. Because the miRNA sets in different pools are different, and the numbers of miRNAs in different pools are small, intrasample normalization is difficult. Furthermore, most of the existing normalization methods are not applicable. In this study, we investigate a measurement error model-based approach to improve beads array intrasample normalization.
MATERIALS AND METHODS
MiRNAs profiling analysis and beads array dataTen human osterosarcoma xenografts specimens are collected. For each specimen, four samples are prepared as follows: one sample is treated with saline and used as control (Ctrl); three samples are treated with each of the
Normalizing bead-based microRNA expression datathree chemotherapeutic treatments: cisplatin (Cis), doxorubicin (Dox) and ifosfamide (Ifo). Thus, a total of 40 samples are employed for this study. The total RNAs are isolated following the established protocols (). Luminex FlexmiR MicroRNA Human Panel (Luminex Corp., TX, USA) is employed for miRNA profiling analysis. All procedures are conducted by strictly following the manufacturer's instructions. In brief, 5 g of total RNA per sample is 3-biotinylated and hybridized to oligonucleotide-capture probes coupled to the carboxylated 5- polystyrene xMAP beads. The intensities are captured with a Luminex-200 instrument. For each sample, a total of 319 human miRNAs are tested by beads array in five human pools. The numbers of miRNAs in the five pools are 60, 64, 64, 65 and 66, respectively. In each human pool, four microspheres (regions 72, 73, 74 and 76) are included for the purpose of data normalization. Each normalization microsphere (normalizer hereafter) contains a unique capture probe designed to target specifically a ubiquitously expressed human small nucleolar RNA (snoRNA).
MiRNAs expression validationThe experimental results from beads array are validated using Taqman-based quantitative real-time polymerase chain reaction (qRT-PCR) miRNA assays. QRT-PCR is a prevalent molecular analysis technique for amplification and simultaneous quantification of a target molecule. In recent years, the development of novel chemistries and instrumentation platforms enabling detection of PCR products on a real-time basis have led to widespread adoption of qRT-PCR as a preferred validation method (). TaqMan Low Density Array (TLDA) Human MicroRNA Panel v2.0 (Applied Biosystems, CA, USA), containing pre-loaded PCR primer/probe set for 664 miRNAs and controls, is applied for miRNA expression validation by following the manufacturer's operating manual and instructions. After reverse transcription, the mixture is loaded onto TLDA cards and incubated on Applied Biosystems 7900 HT Real-Time PCR system. The data are collected and processed using the software endorsed by Applied Biosystems. Relative Quantification (RQ) values are calculated using the standard formula (). An RQ value shows the fold-change (FC) of a specific miRNA in two cell populations. RQ = 1 indicates that a specific miRNA is non-differentially expressed in the control and the treated samples. Otherwise, if the RQ value is significantly different from one, the miRNA is differentially expressed in the two samples. Among all 319 miRNAs being profiled by beads array, 231 of them are also profiled by TLDA. Throughout this study, the qRT-PCR results are used as 'gold standards' to assess the performances of normalization methods.
A measurement error model for miRNA dataJust as with other cDNA or oligonucleotide arrays, measurement errors exist in miRNA arrays. The measurement errors are usually produced from various sources including sample preparation, dying, image intensity and microarray hybridization, scanning and equipment errors among many others. In this study, we consider the following measurement error model for miRNA beads arrays, x = e  +,where x is the net median fluorescent intensity (nMFI), which is the background-subtracted response at concentration . In beads arrays, the background noise is estimated by a spare unit for each molecular unit. In model (1),  represents the multiplicative error that always exists but is noticeable at concentrations significantly above zero; represents the additive error that always exists but is noticeable mainly for near-zero concentrations. For gene expression arrays, the actual expression level in molecular units is hard to be discerned due to the lack of calibration data. In model (1),  is a relative expression level that can be adjusted to calibrate data from different pools or samples to close expression levels for direct comparisons. It is unpleasant to work with the gene expression data at the original scales due to the fact that the distributions of gene expression data areusually right-skewed.shows the intensity distributions of the four samples of a specimen. After the natural logarithmic transformation, the distributions become less skewed ().shows the intensity distributions of the five subprofiles for the sample used as a control, whilethroughshow the distributions of the subprofiles for the three treated samples, respectively. We find that the similarity among the distributions of the subprofiles for the same pool for different samples are higher than those across pools, which is reasonable because the miRNAs tested in the same pools for different samples are the same. Applying a Taylor expansion to the logarithm of x for the miRNAs that are highly expressed, we get the following measurement error model for log-scale expressions, logx  log()+log()++ e  .The last term to the right-hand-side of (2) is negligible for large 's (). For convenience, we assume the following model throughout this study,where the last term in (2) is absorbed in  * , which is assumed to be a heteroscedastic normal error term with mean zero and variance  2  * .
A maximum likelihood-based iterative normalization methodTo serve the purpose of data normalization, the four normalizers are supposed to be strongly expressed across pools and samples, and have no biological interactions with the assayed samples. Let x ijk be the nMFI of normalizer i in pool k for sample j, and  i be the corresponding true concentrations. We havefor i = 1,...,4; j = 1,...,4; and k = 1,...,5. Our objective is to estimate  jk 's to commit the intrasample normalization. Now we havewhere   * is normally distributed with mean zero and variancefor any two pools with i = i or j = j , or both. Without loss of generality, we take pool k for sample j as a reference pool and set  jk = 1. Then we can estimate the correction factor for pool k for sample j byTo normalize a subprofile, we simply divide all nMFIs in the subprofile in pool k for sample j byby by j k. Let x * ij k be the nMFI after the initial intrasample normalization. From (4) we haveWe can further refine the normalization by finding an estimate for the new correction factor  * j k , which can be found by maximizing the likelihood based on each pool. The log-likelihood for pool k for sample j can be expressed asBy equating the first derivative of the above log-likelihood to zero, and solving the equations with some algebra, we obtain the following estimatorThe refinement process can be iterated until the overall likelihood, = j k jk , is maximized.
RESULTS AND DISCUSSION
Performance comparisons of intrasample normalization methodsThe following two normalization methods are recommended by the manufacturer:
nmeanIn (5), the correction factor is computed by taking the geometric mean of the ratios of the nMFIs of the four normalizers in two different pools. The FlexmiR TM MicroRNA Human Panel Instruction Manual Version A-2 suggests to compute the correction factor by taking the arithmetic mean instead (BG-FMIR-H20-8.0A2, 2007),All the above three intrasample normalization methods work under the assumptions that (i) the normalization beads have intensities significantly different from the background noises; (ii) the normalizers have stable measurements: they have no biological interaction with the assayed samples. To select the qualified normalizers, we screen the normalization microsphereswith nMFI  k   , where  is estimated by using the probes that have intensities close to the mean background. Because the intensity measures for the normalization beads are usually large, the selection of k is not that crucial. The results based on the 40 samples show that k = 3 is sufficient. We also screen the normalization beads based on their stability by performing a  2-test: we first compute  2  by pooling the estimated variances for the various normalization beads under an assumption of homoscedastic multiplicative errors. Second, we perform a  2-test with a null hypothesis H 0 :  2 i =  2  to check whether the variance of normalizer-i equals to  2 . As an alternative, one can also perform pairwise F-tests to check the stability of the normalizers. By controlling the significance level, we can control the quality of the beads used for normalization. In this study, we choose  = 0.05. Based on the experiment results, the results are petty stable by varying the significance levels from 0.01 to 0.1.shows the profiles of the four normalizers for one specimen. We see that the profiles show similar pattern across samples and pools. Normalizers 2 and 3 have relatively higher expression levels, while the expression level of normalizer 1 is smaller than the others. By applying the three intrasample normalization methods, we estimate the correction factors for the different pools (). In, pool 1 for the control sample is used as the reference pool. We find that the estimated correction factors by the three methods for the same pool are very close for the same samples. The overall expression levels of the subprofiles for different pools and different samples are also close, except pool 3 for the control and pool 1 for the Ifo-treated sample. To compare the performance of nme, nmed and mean, a simulation study is performed as follows: first, based on the data after intranormalization (with any of the three methods, we choose nmed here), estimate ,  and of the four normalizers. Second, randomly choose  jk  Uniformfor j = 1,...,4 and k = 1,...,5, and generate data X as in model (1). Third, based on X, estimate Page: 1509 15061512with the three methods, respectively. Fourth, compute the distance between  and eacheach each as
Normalizing bead-based microRNA expression dataLast, repeat the above three steps for M times and compare the performances of the intrasample normalization methods based on the D's.shows the boxplot of the D's for nmean (left), nmed(middle) and nme (right), respectively. In this simulation, the following parameters are used,Results show that the mean of D by nme is smaller than that by nmed with P < 0.00001, and is smaller than that by nmean as well, with P= 0.00003. Meanwhile, nmean attains smaller mean of D than nmed (P < 0.00001). In the analysis of this study, the iterative procedure for nme converges within three steps for all samples for stopping criteria
GHz and 3 GB 667MHz RAM, so the speed of the algorithm shall not be a concern.
Performance comparisons of intersample normalization methodsAll three intrasample normalization methods can also be applied to normalize the subprofiles (or the assembled profiles) for different samples. However, the above three intrasample normalization methods are linear rescaling methods. Their uses could be very limited mainly due to the fact that the relationship between two profiles are usually non-linear, especially for miRNAs with very high or very low expression levels. Instead of using the information of the four normalizers alone, some global information can also be utilized to normalize the assembled complete profiles by considering the following non-linear normalization methods.
Loess Let Y and Xbe the nMFIs in the treated sample and in the control sample, respectively. The cyclic loess method is a method based on the idea of the M versus A plot, where M = log(Y /X) is the difference in log expression values, and A = log(Y * X)/2 is the average of the log expression values. A normalization curve is fitted to the M versus A plot using local regression. LetMLet LetM be the fitted values. Thus, we set D = exp((M   M)) and justify the fold change by multiplying D (). The cyclic loess normalization has been implemented in an R packages codelink and affy as well.
LoessMThis is a modification of the traditional loess normalization (). In loessM, the median of M on the microarray experiment is subtracted from the loess fit to the MA-plot D. In miRNA data analysis, such a modification could be important due to the possible violation of the following two assumptions (i) the majority of miRNAs are equally expressed and that (ii) the distribution of the log-intensity ratio of deregulated miRNAs is roughly symmetric about zero ().
QnormThe quantile normalization method is proposed firstly in (), which is based upon the concept of quantilequantile plot extended to n-dimensions. This method forces the distribution of all the replicate arrays to follow a common Page: 1510 15061512distribution by replacing the intensities with a certain quantile level with the average of all intensity measures with the same quantile level (). The quantile normalization method has been implemented in R package affy. In this study, there are no replicated samples tested, as a result some existing statistical test-based methods to identify the differentially expressed miRNAs (genes) are not applicable. We use the fold changes to identify whether the miRNAs are differentially expressed in the drug-treated sample compared with the untreated sample (control). The FC value of miRNA-i is computed by FC i = x i1 /x i0 , where x i1 and x i0 are the normalized nMFIs of miRNA-i in the drug-treated sample and control, respectively. If an miRNA has an FC value larger than the predetermined cutoff, we classify it as 'upregulated'; if its FC value is smaller than 1/cutoff, it is classified as downregulated; otherwise, it is classified as non-differentially expressed. The same rule is applied to the qRT-PCR results by using the RQ values instead of the FC values. Let (z 1 ,z 2 ) be a pair of classification results based on the beadbased array and qRT-PCR results, respectively. Each of z 1 and z 2 may have three possible results: 0 if non-differentially expressed, 1 if downregulated and 1 if upregulated.shows a threeway classification table to identify differentially expressed miRNAs. In Table 2, DR is referred as 'downregulated', NDE as 'nondifferentially expressed', UR as 'upregulated', n ij is the number of miRNAs classified as z 1 based on the beads array results and z 2 based on the qRT-PCR results. For illustration purposes,shows the identification results based on the experimental results for the control and Ifo-treated sample for specimen #8, by using nme, nmean and nmed for both intra-and intersample normalizations. The same cutoff 2.0 is used for both qRT-PCR results and computed FCs, and only the miRNAs that are not weakly expressed are used. In this study, we filter the weakly expressed miRNAs by choosing those with nMFI > 2  . We find that all three methods are too conservative: nmean claims all miRNAs are non-differentially expressed, while nme and nmed claim one as upregulated and the all
B.Wang et al.where TP= n 11 +n 33 is the number of true positives, FN = n 12 +n 32 is the number of false negatives, TN = n 22 is the number of true negatives and FP= n 13 +n 21 +n 23 +n 31 is the number of false positives. The sensitivity measures the proportion of actual positives which are correctly identified as such, and the specificity measures the proportion of negatives which are correctly identified. In, all three methods have specificity zero. The sensitivity for both nmean and nme is 0.980, and 1.0 for nmed. A more aggressive strategy can be taken by lowering the cutoff, so that more miRNAs will be classified as up-or downregulated based on the FC values.shows the results by choosing different cutoff values. We see that when the cutoff is 1.8, both the sensitivity and the specificity do not change much. When the cutoff is 1.5, the specificity is reduced by about 0.2, while the sensitivity is increased no more than 0.025. The sensitivities can be improved at a cost of dramatic drop of specificities. When the cutoff is reduced to 1.3, the specificity is decreased more than half, while the sensitivity is barely increased to about 0.1 (only 0.075 for nmed). In practice, a cutoff shall not be chosen to be too close to 1.00. Otherwise, the classification strategy will be too aggressive and the specificity will be sacrificed. As illustrated in, specificity and sensitivity are not good measures to assess the three-way classification. For binary classifications, a completely random classification strategy will result in an expected value 1/2 for both sensitivity and specificity, and a naive strategy by claiming all negative will result in sensitivity = 0.0 and specificity = 1.0. In three-way classifications as in this study, an miRNA could be classified as upregulated, downregulated or non-differentially expressed. When a strategy other than the naive classification is taken, the gain in sensitivity may not be able to compensate the loss in specificity, and vice versa. A completely random strategy will result in an expected value 1/3 for both sensitivity and specificity, which make the performance comparisons Page: 1511 15061512The second value 0.016 shows the p-value which is an indicator of the significance of the previous value 0.195. difficult. To address this issue, we adopt the following weighed kappa coefficient, which is a measure of agreement between two qualitative classification schemes:
Normalizing bead-based microRNA expression dataThe weights w ij are constructed so that 0  w ij < 1 for all i = j, w ii = 1 for all i, and w ij = w ji. We define a distance C ij =|z 1 z 2 | to quantify the relative difference between categories, and use the FleissCohen weighting scheme to compute w ij = 1C 2 ij /4 (). In, we compute the weighted kappa coefficients (column 5), and the P-values of testing a null hypothesis that the weight kappa equals zero (column 6). The results by all three methods indicate no agreement between the beads array and qRT-PCR results at significance level  = 0.05. From, we see that more than 50% of the miRNA are differentially expressed by the qRTPCR results, which also indicates that the cutoff for RQ is already reasonably large. By fixing the RQ cutoff, varying the FC cutoff does not improve the results. A non-linear normalization is needed for intersample normalization. Now we apply the three non-linear normalization methods to the profiles assembled by either of the three intrasample normalization methods. The results are shown in. We find that the combination of nme and Qnorm leads to a weighted kappa coefficient 0.195 with P-value of 0.016, which reveals slight-to-fair agreement according to the interpretation by (). The combination of nmed and Qnorm also produces a reasonably large weighted kappa coefficient of 0.144 with P = 0.075, which is not significant at level 0.05. It is also worth noting that when Qnorm is used for intersample normalization, the profiles assembled by nme for this specimen is very robust to the cutoff selection. In, the kappa coefficients are computed for different combinations of the FC cutoffs (shown in the x-axis in each small panel) and RQ cutoffs (for panels in different columns). For all panels, Qnorm is used for intersample normalization based on the complete profiles assembled by nmed (row 1), nmean (row 2) and nme (row 3). The y-values of the circles represent the values of the kappa coefficients. A plus sign ('+') at the bottom indicates that the corresponding kappa coefficient is significant at level  = 0.05, and not significant if the plus sign is on the top. We see that based on the profiles assembled by nmed, the coefficients are significant only when in the fifth panel (RQ cutoff is 2.0) and FC cutoff is 1.8, and in the sixth panel (RQ cutoff is 2.
2) andKappaFC cutoffs are 1.8, 2.0 and 2.2, respectively. All coefficients based on the profiles assembled by nmean are not significant at level 0.05. Meanwhile, most of the weighted kappa coefficients are significantly different from zero based on the profiles assembled by nme. Overall, the performances of the three intrasample normalization methods are similar. A study showed that although the intraplatform reproducibilities for beads array and TLDA arrays are high, the interplatform reproducibility between them is poor (). In terms of the Spearman's correlation coefficient between the beads array FCs and qRT-PCR RQs, the median coefficient is 0.1060 with a SD of 0.0391 based on all 40 samples. As a consequence, the three methods agree with each other most of the time, revealing weak agreement between the results from the two platforms.
CONCLUSIONSFor beads arrays, there are not many options for intrasample normalization due to the facts that the number of miRNAs in each pool is small, and the miRNA sets in different pools are different. The selection of reliable controls as normalizers is crucial. The ideal controls should be consistently stable and highly abundant despite tissue types or treatments. In one of our ongoing projects, we found that some ncRNAs were influenced by chemo drug treatments, such as 5-fluorouracil, cisplatin or doxorubicin. Thus, it is recommended that the stability of normalization beads should Page: 1512 15061512
B.Wang et al.be checked. We need to be aware of the stability of normalization controls across a relatively wide variety of tissues, cell lines and conditions. Although the common distribution assumption by Qnorm is of concern in miRNA data normalization, the literature showed that the quantile method is one of the best normalization methods compared with some existing one-color miRNA microarray normalization techniques (). In this study, results also show that the quantile method works well even when the number of usable miRNAs reduces to about 100. The selection of either the fold change cutoff or RQ cutoff is always a problem in practice. Even if the expression levels can be measured without any measurement errors, it is a concern about how to select an appropriate cutoff to classify the differentially expressed miRNAs. Another concern in miRNA data analysis is that the expression levels of the majority of miRNAs are much lower compared with mRNA or cDNA microarray expression data. Consequently, the measurement error can greatly affect the FC values. When the basal level is not high, the measurement error could even dominate an FC value. In this study, we proposed a measurement error model-based approach for intrasample normalization by taking the measurement errors in the measures of the normalizers into consideration. Advanced errorsin-variables smoothing or regression techniques can also be applied to improve the subsequent intersample normalization (). We will further investigate how to calibrate the measurement errors based on the model in (1) for intersample normalization, and develop a statistical test for identify the differentially expressed miRNAs.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
