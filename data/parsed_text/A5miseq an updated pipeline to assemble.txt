Motivation: Open-source bacterial genome assembly remains inaccessible to many biologists because of its complexity. Few software solutions exist that are capable of automating all steps in the process of de novo genome assembly from Illumina data. Results: A5-miseq can produce high-quality microbial genome assemblies on a laptop computer without any parameter tuning. A5-miseq does this by automating the process of adapter trimming, quality filtering, error correction, contig and scaffold generation and detection of misassemblies. Unlike the original A5 pipeline, A5-miseq can use long reads from the Illumina MiSeq, use read pairing information during contig generation and includes several improvements to read trimming. Together, these changes result in substantially improved assemblies that recover a more complete set of reference genes than previous methods. Availability: A5-miseq is licensed under the GPL open-source license. Source code and precompiled binaries for Mac OS X 10.6+ and Linux 2.6.15+ are available from http://sourceforge.net/projects/ngopt
INTRODUCTIONGenome assembly involves an entire data processing workflow starting with raw sequence data and ending with scaffolded contigs. The steps often consist of adapter trimming, quality filtering, error correction, creation of contigs, verification of contigs by mapping reads to the assembly and the creation/verification of scaffolds. We previously published A5, a pipeline that automated all the steps to generate bacterial genome assemblies from raw Illumina data (). The workflow included five steps, and the parameters for each step were optimized on assemblies of Halophilic archaea and tested on Escherichia coli. Since the publication of A5, Illumina's chemistry has advanced significantly and the MiSeq instruments are now capable of producing reads in excess of 400 nt long, which is 4-fold longer than what was previously possible on a HiSeq 2000. The original A5 could not process reads longer than 150 nt. The longer reads make it possible to assemble genomes from less data overall, but doing so required major revisions to the data processing algorithms in A5. We introduce a revised pipeline called A5-miseq, which replaces several components of the original A5 pipeline with new software modules and produces substantially improved assemblies.
METHODSThe A5-miseq pipeline consists of five steps: (i) Read cleaningsequence adapters and low-quality regions are removed by Trimmomatic (). Errors in the reads are then corrected using SGA's k-merbased error correction algorithm (). (ii) Contig assemblypaired and unpaired reads are used for assembly with the IDBA-UD algorithm (). (iii) Crude scaffoldingcontigs are scaffolded with any available large insert libraries using permissive parameters. (iv) Misassembly correctionmisassemblies are detected on the basis of read pairs that do not map within the expected distance. Contigs and scaffolds found to contain misassemblies are broken. (v) Final scaffoldinga final round of scaffolding with stringent parameters repairs any previously broken contigs. Assembly summary statistics and base-call quality estimates are also produced in stage 5. A5-miseq substantially revises steps (i) and (ii) relative to A5. In step (i), A5 would discard entire reads found to contain any amount of adapter readthrough. The standard Nextera XT protocol results in libraries where a large fraction of the reads (450% in extreme cases) contain adapter readthrough when sequenced with the currently standard paired-end 300 nt read chemistry. Instead of discarding such reads, only the contaminated portion of the read gets trimmed. In step (ii), A5-miseq uses a contig assembly algorithm (implemented in the IDBA-UD software) that exploits read pairing information during contig generation. This improvement reduces the frequency with which misassembled contigs are formed during the contig generation step. Thus, fewer misassemblies must be detected and corrected in step (iv) of the pipeline. IDBA-UD required extensive source code revision to operate on Mac OS X and reduce its memory usage for laptop hardware. These changes are available in the A5-miseq source code repository. We benchmarked A5-miseq 20140521 and A5 on the raw GAGE-B MiSeq datasets. GAGE-B includes paired-end 250 nt MiSeq reads at 100 coverage for four organisms. We ran A5-miseq and A5 assemblies and obtained results for other assemblers from the GAGE-B publication (). The original A5 cannot assemble 250 nt reads, so we used Trimmomatic to cut the reads down to 150 nt (discarding 100 nt) before assembly. Running time and peak memory were measured with/usr/bin/time-v on a 2012 MacBook Air running Ubuntu 13.10. To evaluate assembly accuracy, we ran QUAST v2.2 () with the following parameters: quast.py gage-u-G ref.gff-R ref.fa ass.fa, where ref.fa is the reference assembly *To whom correspondence should be addressed. from NCBI, ref.gff is the reference's annotated genes from NCBI and ass.fa is the assembly. The-u option causes the genome fraction to be calculated in the manner used by QUAST v1.3. This yields results that are comparable with those in the GAGE-B paper. In a separate experiment, we evaluated how the completeness of assemblies produced by A5 and A5-miseq changes in response to decreasing amounts of sequence data. To do so, we took the 100 coverage GAGEB datasets and randomly downsampled them to 50, 40, 30, 20, 10 and 5 coverage, assembled them and measured assembly accuracy with QUAST.
DISCUSSIONThe benchmarking results for A5-miseq on the GAGE-B data (shown in) indicate that it offers substantial improvements over the original A5 pipeline. A5-miseq assemblies contain more full-length reference genes than A5 or any of the GAGE-B assemblers. Relative to the original A5, the number of genes missing from A5-miseq assemblies is reduced by 1.63.8-fold on the GAGE-B datasets. In most cases, A5-miseq assemblies have higher NGA50 values, fewer misassemblies and fewer basecalling errors than the original A5 pipeline. A5-miseq produces results that are competitive with the best achieved by other assemblers on the GAGE-B data, but requires only minimal user-effort. A5-miseq can recover nearly complete genome assemblies with much less sequence data than its predecessor.shows that to recover a fixed fraction of the genome, e.g. 95%, A5-miseq requires about half as much sequence data. Relative to A5, A5-miseq achieves higher degrees of contiguity with less data. This permits deeper multiplexing of sequencing experiments. A5-miseq is computationally efficient. Assembly of the B.cereus GAGE-B data completed in 2.2 h with a peak memory usage of 4 GB and 5.7 GB disk usage on a laptop. Computational requirements for other bacterial genomes are similar. One limitation of the GAGE-B data is that following its publication, assembly pipelines might be inadvertently tuned to produce high scores specifically on that dataset. This could result in artificially high scores that do not accurately reflect the expected performance on other datasets. We assert that we have not tuned A5-miseq in any way to improve scores on the GAGE-B dataset, and to our knowledge, none of the component programs used by A5-miseq has been optimized for GAGE-B.
CONCLUSIONGenome assembly is a fast evolving field, and software has been advancing rapidly. Although A5-miseq produces assemblies that are competitive with results in a recently published assembler evaluation (), it is likely that versions of other software that are currently under peer review (e.g. SPAdes 3.0) might produce even better results. SPAdes 2.3 automates many of the same steps that A5-miseq automates (), and in general, produces excellentAssembly accuracy for the A5-miseq and A5 pipelines measured on raw 100 coverage MiSeq PE250 GAGE-B data. Accuracy was measured by QUAST. Frac is the fraction of the reference genome represented in assembly scaffolds. NGA50: the N50 after breaking contigs at misassemblies. MA: number of misassemblies, MM: number of nucleotide mismatches per 100 kbp, Genes: number of intact full-length genes recovered. For GAGE-B results, the single best assembly result for each metric and genome reported in Magoc et al. (2013) is shown, with the assembler producing the best result indicated as follows: S = SPAdes 2.3, sdn = SOAPdenovo, M = MaSuRCA, A = ABySS, sga = SGA.. Contiguity of assemblies of the B.cereus data from GAGE-B with increasing depths of coverage. A5 was run on reads cut down from 250nt to 150nt. A5-miseq was run on both the cut down reads (red) and the fulllength 250nt reads (black). A5-miseq assemblies become highly contiguous with 20 coverage, whereas A5 (blue) requires 50 coverage to achieve comparable contiguity assemblies (), with A5-miseq's main advantages being automated adapter trimming, more full-length genes assembled, NCBI-ready outputs and production of base-call quality scores. If possible, researchers interested in genome assembly should become acquainted with the various algorithms available before selecting a particular approach. A5-miseq should be particurlarly useful for researchers with limited bioinformatics experience or computing resources.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
D.Coil et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
A5-miseq at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
